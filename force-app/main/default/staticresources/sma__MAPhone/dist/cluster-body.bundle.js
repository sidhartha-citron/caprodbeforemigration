webpackJsonp([32],{218:function(t,e,a){var s=a(13)(a(225),a(226),function(t){a(223)},"data-v-4c583d7f",null);t.exports=s.exports},222:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=new(function(t){return t&&t.__esModule?t:{default:t}}(a(94)).default);function i(t,e,a){var i=function s(i){a.context._isDestroyed?document.removeEventListener("click",s):t.contains(i.target)||t===i.target||e(i)};s.set(t,i),setTimeout(function(){return document.addEventListener("click",i)},0)}function n(t){var e=s.get(t);document.removeEventListener("click",e),s.delete(t)}e.default={bind:function(t,e,a){var s=e.arg,n=s.active,o=s.handler;if("function"!=typeof o)throw new Error("v-click-outside: missing required handler argument.");!0===n&&i(t,o,a)},update:function(t,e,a){var o=e.arg,r=o.active,d=o.handler;r&&!s.has(t)?i(t,d,a):!r&&s.has(t)&&n(t)},unbind:function(t){n(t)}}},223:function(t,e,a){var s=a(224);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(198)("49b356e9",s,!0)},224:function(t,e,a){(t.exports=a(197)(void 0)).push([t.i,".action-sheet_wrap[data-v-4c583d7f]{background-color:#fff;overflow:hidden!important;position:relative;z-index:110}.action-sheet_content[data-v-4c583d7f]{overflow-y:auto}.slds-scope .slds-button.slds-button_neutral.action-sheet_close-button[data-v-4c583d7f]{border-radius:0;box-shadow:0 -2px 4px #f9f9fa;padding:1rem 0;text-align:center!important;background:none;border:0;border-top:1px solid #dddbda;line-height:inherit;width:100%;vertical-align:top}.action-sheet_item[data-v-4c583d7f]{min-width:150px;border-bottom:1px solid #dddbda}.action-sheet_item[data-v-4c583d7f]:last-child{border-bottom:0}.action-sheet_selected-icon[data-v-4c583d7f]{display:none}.slds-is-selected .action-sheet_selected-icon[data-v-4c583d7f]{display:block}.action-sheet_mask[data-v-4c583d7f]{background-color:rgba(8,7,7,.6);height:100%;left:0;position:fixed;top:0;z-index:100;width:100%}.ma-action-sheet-item.header[data-v-4c583d7f]{background-color:#3083d3;color:#fff}.ma-top-bar-row .slds-button[data-v-4c583d7f]{color:#fff;font-size:20px}@media screen and (max-width:769px){.ma-action-sheet-wrap .footer[data-v-4c583d7f]{padding:25px!important}.ma-action-sheet-item[data-v-4c583d7f]{padding:16px 16px 16px 40px!important}}.ma-action-sheet-wrap[data-v-4c583d7f]{position:fixed;width:100%;height:100%;left:0;top:0;visibility:hidden;z-index:6000}.ma-action-sheet-wrap .ma-action-sheet[data-v-4c583d7f]{position:absolute;left:0;margin:0;bottom:0;width:100%;transform:translateY(100%);background-color:#fff;z-index:200;box-shadow:0 2px 3px 0 rgba(0,0,0,.16);padding-top:16px;border-radius:0}@media screen and (max-width:768px){.ma-action-sheet-wrap .ma-action-sheet .maActionSheetClose[data-v-4c583d7f]{text-align:center;width:100%;display:block;padding:16px;font-size:16px;line-height:1.5;color:#1589ee}}.ma-action-sheet-wrap .ma-action-sheet .ma-action-sheet-item[data-v-4c583d7f]{padding:16px;color:#0070d2;font-size:16px;line-height:1;text-align:center}.ma-action-sheet-wrap .ma-action-sheet .ma-action-sheet-close[data-v-4c583d7f]{padding:20px 16px;border-top:2px solid #dddbda;color:#0070d2;font-size:16px;line-height:1;text-align:center}.ma-action-sheet-wrap .ma-action-sheet .ma-action-sheet-close .ma-icon[data-v-4c583d7f]{height:16px;display:inline-block;margin-right:4px;transform:translateY(2px)}.ma-action-sheet-wrap#longPressActionSheet[data-v-4c583d7f]{height:100%;width:100%}.ma-action-sheet-wrap#longPressActionSheet .ma-action-sheet[data-v-4c583d7f]{padding-top:0;width:100%;bottom:0}.ma-action-sheet-wrap#longPressActionSheet .ma-action-sheet .ma-action-sheet-item[data-v-4c583d7f]{text-align:left;color:#3e3e3c;display:flex;align-items:center;border-bottom:1px solid #dddbda}@media screen and (min-width:769px){.ma-action-sheet-wrap#longPressActionSheet .ma-action-sheet .ma-action-sheet-item[data-v-4c583d7f]{justify-content:center}}.ma-action-sheet-wrap#longPressActionSheet .ma-action-sheet .ma-action-sheet-item .ma-icon[data-v-4c583d7f]{color:#fff;background-color:#1589ee;border-radius:100%;height:34px;width:34px;display:flex;justify-content:center;align-items:center;margin-right:8px;font-size:22px}.ma-action-sheet-wrap.in[data-v-4c583d7f]{visibility:visible}.ma-action-sheet-wrap.in .action-sheet-mask[data-v-4c583d7f]{opacity:1}.ma-action-sheet-wrap.in .ma-action-sheet[data-v-4c583d7f]{transform:translate(0)}@media screen and (min-width:769px){.ma-action-sheet-wrap[data-v-4c583d7f]{position:absolute;width:auto;height:auto;background-color:transparent}.ma-action-sheet-wrap .ma-action-sheet[data-v-4c583d7f]{width:auto;left:auto;bottom:auto;border-radius:4px;transform:translate(0);opacity:0;text-align:left;min-width:250px;border:1px solid #dddbda}.ma-action-sheet-wrap .ma-action-sheet .ma-action-sheet-item[data-v-4c583d7f]{text-align:left}.ma-action-sheet-wrap .ma-action-sheet .ma-action-sheet-close[data-v-4c583d7f]{display:none}.ma-action-sheet-wrap.in .ma-action-sheet[data-v-4c583d7f]{opacity:1;transform:translate(0)}}",""])},225:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(222),i=a.n(s),n=window.$;e.default={name:"ActionSheet",directives:{"click-outside":i.a},props:{options:{type:Array,required:!0},doDetach:{type:Boolean,default:!0},labelKey:{type:String,default:"label"},buttonText:{type:String,default:""},buttonIcon:{type:String,default:""},hideOverride:{type:Boolean,default:!1},selectedItems:{type:Array,default:function(){return[]}},buttonType:{type:String,default:""}},data:function(){return{container:null,showOptions:!1,styleObject:{},window:{height:0,width:0},uid:"action-sheet"}},computed:{isPhone:function(){return this.window.width<769},computedIcon:function(){var t="";return""!==this.buttonIcon?t=this.buttonIcon:""===this.buttonText&&(t="ma-icon-threedots-vertical"),t},actionSheetClickOutsideOptions:function(){return{active:this.showOptions,handler:this.hideActionSheet}}},watch:{isPhone:function(){this.showOptions=!1}},created:function(){window.addEventListener("resize",this.handleResize),this.handleResize()},destroyed:function(){window.removeEventListener("resize",this.handleResize),this.hideActionSheet()},methods:{handleResize:function(){this.window.width=window.innerWidth,this.window.height=window.innerHeight},returnItem:function(t){t.isHeader||(this.$emit("select",t),this.hideActionSheet())},hideActionSheet:function(){this.showOptions=!1,this.container&&(this.container.remove(),this.container=null)},detach:function(){if(this.$refs.button){var t=document.querySelector(".slds-scope."+this.uid);try{t.remove()}catch(t){}var e=this.$refs.button.getBoundingClientRect();this.container=document.createElement("div"),this.container.className="slds-scope "+this.uid,this.container.appendChild(this.$refs.actions),document.body.appendChild(this.container),this.styleObject={top:e.top+this.$refs.button.clientHeight+n(window).scrollTop()+"px",left:e.left+n(window).scrollLeft()+"px","max-height":"300px"}}},adjustForClipping:function(){var t=this.$refs.actions.getBoundingClientRect(),e=void 0;if(e=document.documentElement.clientHeight-window.innerHeight<=0?document.documentElement.clientHeight:window.innerHeight-this.getScrollbarWidth(),t.x<0)this.styleObject.left=this.$refs.actions.offsetLeft+Math.abs(t.x)+"px";else if(t.left+t.width>document.documentElement.clientWidth){var a=t.left+t.width-document.documentElement.clientWidth-n(window).scrollLeft();this.styleObject.left=t.left-a+"px"}var s=this.$refs.actions.scrollHeight,i=n(window).scrollTop();if(this.styleObject["max-height"]="300px",t.top+s>e){var o=t.top+s-i-e;this.$bus.$emit("ma-modal-scroll-by",o),this.styleObject.top=t.top-o+"px"}},disableClick:function(t){t.stopPropagation(),t.preventDefault()},openActionSheet:function(){var t=this;this.showOptions=!0,this.doDetach&&this.detach(),this.$nextTick(function(){t.doDetach&&t.adjustForClipping(),t.options.forEach(function(e,a){var s=e,i=t.$refs.optionItem[a];s.isHeader&&i.addEventListener("click",t.disableClick,!0)})})}}}},226:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"click-outside",rawName:"v-click-outside:[actionSheetClickOutsideOptions]",arg:t.actionSheetClickOutsideOptions}],staticClass:"action-sheet-wrapper slds-scope"},[a("div",{ref:"button",staticClass:"slds-grid slds-grid_vertical-align-center",on:{click:t.openActionSheet}},[a("div",{staticClass:"slds-button slds-col slds-truncate"},[t._v(t._s(t._f("decode")(t.buttonText)))]),t._v(" "),""!==t.computedIcon?a("div",[a("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",class:[t.buttonType]},[a("span",{staticClass:"slds-button__icon ma-icon",class:[t.computedIcon]})])]):t._e()]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showOptions,expression:"showOptions"}],ref:"actions",staticClass:"ma-action-sheet-wrap in slds-grid slds-grid_vertical slds-grid_align-end",style:t.isPhone?{}:t.styleObject},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.isPhone,expression:"isPhone"}],staticClass:"action-sheet_mask",on:{click:t.hideActionSheet}}),t._v(" "),a("div",{staticClass:"action-sheet_wrap slds-grid slds-grid_vertical"},[a("div",{staticClass:"action-sheet_content slds-scrollable"},t._l(t.options,function(e,s){return a("div",{key:s,ref:"optionItem",refInFor:!0,staticClass:"action-sheet_item slds-grid slds-p-around_medium",class:{"header slds-text-title_caps slds-section__title slds-theme--shade":e.isHeader,"slds-is-selected":t.selectedItems.includes(e.id)},on:{click:function(a){return t.returnItem(e)}}},[t._m(0,!0),t._v(" "),a("div",{staticClass:"slds-col"},[a("span",{staticStyle:{"word-break":"break-word"}},[t._v(t._s(t._f("decode")(e[t.labelKey])))])])])}),0),t._v(" "),a("div",{staticClass:"slds-button slds-button_neutral action-sheet_close-button",on:{click:t.hideActionSheet}},[t._v("\n                "+t._s(t._f("decode")(t.$Labels.MA_Close))+"\n            ")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"action-sheet_selected-icon slds-p-right_medium"},[e("span",{staticClass:"slds-icon slds-icon_x-small ma-icon ma-icon-check"})])}]}},793:function(t,e,a){var s=a(13)(a(796),a(802),function(t){a(794)},"data-v-03a0efd8",null);t.exports=s.exports},794:function(t,e,a){var s=a(795);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(198)("21f245f9",s,!0)},795:function(t,e,a){(t.exports=a(197)(void 0)).push([t.i,"#clusterBody[data-v-03a0efd8]{height:calc(100% - 93px)}@media screen and (max-width:768px){#clusterBody[data-v-03a0efd8]{height:calc(100% - 56px)}}.action-button[data-v-03a0efd8]{padding:8px}.action-button_text[data-v-03a0efd8]{font-family:AvenirNextCondensed,HelveticaNeue-Condensed,Ubuntu Condensed,Liberation Sans Narrow,Franklin Gothic Cond,Arial Narrow,sans-serif-condensed,Arial,Trebuchet MS,Lucida Grande,Tahoma,Verdana,sans-serif;text-align:center;line-height:1;font-size:12px;color:#fff;background-color:transparent;outline:0;border:0;min-width:52px;letter-spacing:.5px;font-weight:300}.action-button-wrapper[data-v-03a0efd8]{width:100%}.action-button_icon[data-v-03a0efd8]{color:#fff;font-size:24px;line-height:1}[data-v-03a0efd8].action-sheet-wrapper .ma-icon{color:#fff}",""])},796:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(61),i=a.n(s),n=a(14),o=a.n(n),r=a(17),d=a.n(r),c=a(218),l=a.n(c),u=a(797),h=a.n(u),p=window,f=p.getProperty,m=p.google,g=p.$,v=p.MA;e.default={components:{ActionSheet:l.a,ClusterCard:h.a},props:{clickOptions:{type:Object,default:function(){}},totalRecordCount:{type:String|Number,default:"0"},isLoading:{type:Boolean,default:!1}},data:function(){return{totalRecords:0,actionButtons:[],actionButtonsExtended:[],massActionInfo:{},clickedShape:null,shapeLabel:"",dataBounds:new m.maps.LatLngBounds,shapeMgr:null,markerLayersInfo:[],layerSelector:"#PlottedQueriesTable .PlottedRowUnit",showActionSheet:!1,zoomedOnMarkers:!1}},computed:{buttonSetSettings:function(){return f(window,"userSettings.ButtonSetSettings",!1)||{}}},created:function(){var t=this;this.buildActionButtons(),this.$nextTick(function(){t.$emit("update:isLoading",!0),t.getMarkersInsideShapeCluster().finally(function(){t.$emit("update:isLoading",!1)})})},methods:{buildActionButtons:function(){var t=this,e=0;this.buttonSetSettings.massActionLayout&&this.buttonSetSettings.massActionLayout.length>0&&this.buttonSetSettings.massActionLayout.forEach(function(a){a.Buttons.forEach(function(a){var s={};"Custom Action"===a.Type&&window.MAActionFramework.customActions[a.Label]?s=window.MAActionFramework.customActions[a.Label]:window.MAActionFramework.standardActions[a.Action||a.Label]&&(s=window.MAActionFramework.standardActions[a.Action||a.Label]);var i={type:s.Type,action:a.Label,label:s.Label,icon:s.defaultIcon};e<4?t.actionButtons.push(i):t.actionButtonsExtended.push(i),e++})})},handleTooltipAction:function(t){if("shape"===this.clickOptions.type){var e={shape:{geometry:this.massActionInfo.geometry}};window.massActionShapeClick(this.clickedShape,t.action,t.type,e)}else window.massActionClick(t.action,t.type,this.massActionInfo)},zoomToMarkers:function(){window.MA.map.fitBounds(this.clickOptions.cluster.getBounds()),this.zoomedOnMarkers=!0},createPolygon:function(){var t=new v.Map.ShapeManager,e=new m.maps.LatLngBounds;this.markerLayersInfo[0].markers.forEach(function(a){t.addLayer(a.getPosition()),e.extend(a.getPosition())}),window.addProximityLayer().then(function(a){var s=a,i=s.data("qid");s.attr("data-id",i),s.find(".proximitytype").val("Polygon").change(),s.data("proxObject",new m.maps.Polygon({map:v.map,paths:t.getConvexHull(),strokeColor:"#000000",strokeWeight:4,fillColor:"#22CC22",fillOpacity:.6,layerType:"prox",qid:i})),window.MA.map.fitBounds(e),m.maps.event.addListener(s.data("proxObject"),"click",function(t){window.proximityLayer_Click({position:t.latLng,type:"polygon",shape:s.data("proxObject")})})})},getMarkersInsideShapeCluster:function(){var t=this;return new d.a(function(e){var a=o()({type:"",cluster:{}},t.clickOptions);t.buildShapeClusterInfo(a),t.processLayerMarkers(a).then(function(){e()})})},buildShapeClusterInfo:function(t){var e=this;if("shape"===t.type)if(this.clickedShape=t.feature||t.shape,this.massActionInfo={target:this.clickedShape,latlng:v.map.getCenter(),type:"shape"},this.shapeMgr=(new v.Map.ShapeManager).addLayer(this.clickedShape),t.feature)this.shapeLabel=t.feature.label||"";else{try{t.shape instanceof m.maps.Polygon?t.shape.getPath().forEach(function(t){e.dataBounds.extend(t)}):this.dataBounds.union(t.shape.getBounds())}catch(t){this.dataBounds=v.map.getBounds()}this.shapeLabel=t.shape.label||""}else if("cluster"===t.type){var a=f(t||{},"cluster.markerClusterer_.qid",!1)||"";this.layerSelector='#PlottedQueriesTable .PlottedRowUnit[qid="'+a+'"]',this.massActionInfo={target:t.cluster,latlng:v.map.getCenter(),type:"cluster"}}},processLayerMarkers:function(t){var e=this,a=this;return new d.a(function(s){var i=g(e.layerSelector),n=0;setTimeout(function e(){if(n<i.length){var o=i.eq(n),r={},d=!1;o.hasClass("savedQuery")?r=a.processSFDCLayer(t,o):"marker"===o.attr("plot-type")||"point"===o.attr("plot-type")?r=a.processDataLayer(t,o):o.hasClass("ArcGISLayer")&&(d=!0,a.processArcGISLayer(t,o)),r.totalRecords>0&&!d&&a.markerLayersInfo.push(r),n++,setTimeout(e,1)}else s()},1)})},processSFDCLayer:function(t,e){var a=this,s={layerId:e.data("qid"),dataType:e.attr("data-type"),type:"marker",name:""!==e.data("savedQueryName")?e.data("savedQueryName"):e.find(".basicinfo-name").text(),markers:[],tooltips:[],totalRecords:0,fieldList:[],advancedOptions:g(this).data("advancedOptions"),legendInfo:e.data("legendInfo"),legendCounts:{},records:[],hasAggregates:!1,qid:e.attr("qid")};if((e.data("tooltips")||[]).forEach(function(t){"ToolTip"!==t.TooltipType&&!/color/i.test(t.TooltipType)||-1!==g.inArray(s.fieldList,t.ActualFieldName)||"currency"!==t.describe.type&&"double"!==t.describe.type&&"integer"!==t.describe.type&&"int"!==t.describe.type||(s.hasAggregates=!0,s.tooltips.push(g.extend({sum:0,avg:0,min:void 0,max:void 0},t)),s.fieldList.push(t.ActualFieldName))}),"cluster"===t.type){var n=e.data("records");t.cluster.getMarkers().forEach(function(t){var e=n[t.record.Id];(e.isVisible||e.isClustered||e.isScattered)&&(s.records.push(e),s.totalRecords++,s.markers.push(e.marker),s.legendCounts[e.legendId]||(s.legendCounts[e.legendId]={count:0}),s.legendCounts[e.legendId].count++,a.totalRecords++,a.$emit("update:totalRecordCount",a.totalRecords),s.hasAggregates&&s.tooltips.forEach(function(t){var a=f(e,t.FieldName);if(void 0!==a){var i=parseFloat(a);t.sum+=i,(void 0===t.min||t.min>i)&&(t.min=i),(void 0===t.max||t.max<i)&&(t.max=i),t.avg=t.sum/s.markers.length}}))})}else if("shape"===t.type){var o=e.data("records")||{},r={};i()(o).forEach(function(t){var e=o[t];if(e.isVisible||e.isClustered||e.isScattered){var i=e.marker.getPosition();if(r[t]=[i.lat(),i.lng()],a.shapeMgr.containsLatLng(i))if(s.totalRecords++,s.records.push(e),s.markers.push(e.marker),s.legendCounts[e.legendId]||(s.legendCounts[e.legendId]={count:0}),s.legendCounts[e.legendId].count++,a.totalRecords++,a.$emit("update:totalRecordCount",a.totalRecords),s.hasAggregates)s.tooltips.forEach(function(t){var a=f(e,t.FieldName);if(void 0!==a){var i=parseFloat(a);t.sum+=i,(void 0===t.min||t.min>i)&&(t.min=i),(void 0===t.max||t.max<i)&&(t.max=i),t.avg=t.sum/s.markers.length}})}})}return s},processDataLayer:function(t,e){var a=this,s=this,n={layerId:e.data("id"),dataType:e.attr("data-type"),type:"data",name:e.data("name"),markers:[],tooltips:[],totalRecords:0,legend:e.data("legend"),key:e.data("key"),uids:[],tables:[],legendCounts:{},timestamp:(new Date).getTime(),qid:e.attr("qid")};if("cluster"===t.type)(t.cluster||{}).getMarkers().forEach(function(t){var e=f(t,"data.rowid",!1);n.legendCounts[e]||(n.legendCounts[e]={count:0}),n.legendCounts[e].count++,a.dataBounds.extend(t.getPosition()),n.uids.push(t.data.uid),n.markers.push(t),n.totalRecords++,a.totalRecords++,a.$emit("update:totalRecordCount",a.totalRecords)});else if("shape"===t.type){var o=e.data("records")||{},r={};i()(o).forEach(function(t){var e=o[t];if(e.isVisible||e.isClustered){var i=e.clusterMarker,d=f(i,"data.rowid",!1);n.legendCounts[d]||(n.legendCounts[d]={count:0}),n.legendCounts[d].count++;var c=i.getPosition();r[t]=[c.lat(),c.lng()],i&&s.shapeMgr.containsLatLng(c)&&(n.uids.push(i.data.uid),n.markers.push(i),n.totalRecords++,s.totalRecords++,s.$emit("update:totalRecordCount",a.totalRecords))}})}return n},processArcGISLayer:function(t,e){var a=this,s=this;Array.prototype.push.apply([],window.ArcGIS.featureLayerHelpers.searchByShape(e,s.markerLayersInfo,s.clickedShape,s.shapeMgr,function(){s.totalRecords++,s.$emit("update:totalRecordCount",a.totalRecords)},function(){},function(){}))}}}},797:function(t,e,a){var s=a(13)(a(800),a(801),function(t){a(798)},null,null);t.exports=s.exports},798:function(t,e,a){var s=a(799);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(198)("d8f5f546",s,!0)},799:function(t,e,a){(t.exports=a(197)(void 0)).push([t.i,".cluster-card .legend-row{font-size:14px}.cluster-card .slds-section__title-action{background:none!important}.cluster-card .slds-dl_horizontal__detail,.cluster-card .slds-dl_horizontal__label{width:50%!important}.shape-cluster-popup-message-firstXXmarkers{font-size:12px;text-align:center;color:#a7b8d1;background-color:#d9edf7;border:1px solid #bce8f1;padding:5px}",""])},800:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(65),i=a.n(s),n=a(17),o=a.n(n),r=a(14),d=a.n(r),c=a(61),l=a.n(c),u=a(100),h=a.n(u),p=a(101),f=a.n(p),m=a(39),g=a.n(m),v=a(7),_=a.n(v),b=window,y=b.MA,w=b.async,x=b.google,k=b.$;e.default={components:{MATabs:h.a,MATab:f.a},props:{layerData:{type:Object,required:!0}},data:function(){return{isOpen:!1,legendInfo:[],aggregateData:[],aggregatesLoading:!0}},computed:{limitedMarkers:function(){var t=this.layerData.markers;return(void 0===t?[]:t).slice(0,100)},showTooManyMarkersNotification:function(){var t=this.layerData.markers;return(void 0===t?[]:t).length>100},clusterId:function(){return this.getTabId()}},created:function(){this.normalizeLegendData(),this.getAggregates()},methods:{toggleCard:function(){this.isOpen=!this.isOpen},getTabId:function(){return g()()},normalizeLegendData:function(){var t=this.layerData.type,e=void 0===t?"":t,a=[];if("data"===e){var s=this.layerData,i=s.legendCounts,n=void 0===i?{}:i,o=s.legend,r=(void 0===o?{}:o).rows,c=void 0===r?{}:r;l()(n).forEach(function(t){var e=c[t];a.push(d()({},e,n[t]))})}else if("marker"===e){var u=this.layerData,h=u.legendCounts,p=void 0===h?{}:h,f=u.legendInfo,m=void 0===f?{}:f;l()(p).forEach(function(t){var e=m[t];a.push(d()({},e,p[t]))})}a=this.sortByProperty(a,"rowId"),this.legendInfo=a},sortByProperty:function(t,e){return t.sort(function(t,a){return t[e]<a[e]?-1:t[e]>a[e]?1:0}),t},toggletooltip:function(t){t.isOpen||(t.isOpen=!1),t.isOpen=!t.isOpen},formatNumberString:function(t){var e=Math.round(100*t)/100;return y.Util.formatNumberString(e||"0")},getMarkerIcon:function(t){var e="";try{e=t.getIcon().url}catch(t){}return e},navigateToRecord:function(t){window.MAPlotting.marker_Click.call(t)},getAggregates:function(){var t=this,e=this.layerData.type,a=void 0===e?"":e;this.aggregatesLoading=!0,"data"===a?this.getDataLayerAggregateInfo().then(function(e){t.aggregatesLoading=!1,t.aggregateData=e}):(this.aggregatesLoading=!1,this.aggregateData=this.layerData.tooltips)},getDataLayerAggregateInfo:function(){var t=this;return new o.a(function(e){var a=new x.maps.LatLngBounds,s=k('#PlottedQueriesTable .DataLayer[qid="'+t.layerData.qid+'"]').data().SFLayerParams||{},n=t.layerData.uids,o=void 0===n?[]:n,r=y.Util.createBatchable(o,500),d={method:"post",action:"markers",subType:"data",version:"2"},c={},u=a.getCenter(),h=a.getNorthEast(),p=a.getSouthWest(),f={data:s,mapinfo:{nelat:h.lat(),nelng:h.lng(),swlat:p.lat(),swlng:p.lng(),celat:u.lat(),celng:u.lng(),limit:0},ids:[],aggregates:"true",details:"false"},m=w.queue(function(e,a){var s=e.recs.length;f.ids=e.recs,f.mapinfo.limit=s;var n=i()(f);(new _.a).setAction(t.$Remoting.MapAnythingIORequestPOST).setErrorHandler(function(t,e){y.isUserLoggedIn(t,e,!0)||a()}).invoke([d,n],function(e){if(e.success){var s=e.data,i=(void 0===s?{}:s).aggregates,n=void 0===i?[]:i;n.length>0&&(t.layerData.hasAggregates=!0,n.forEach(function(t){var e=c[t.label]||{max:void 0,sum:0,min:void 0,avg:0};void 0!==t.max&&(void 0===e.max||t.max>e.max)&&(e.max=t.max),void 0!==t.sum&&(e.sum+=t.sum),void 0!==t.min&&(void 0===e.min||t.min<e.min)&&(e.min=t.min),void 0!==t.avg&&(e.avg=(e.avg+t.avg)/2),c[t.label]=e}))}a()},{escape:!1,buffer:!1})});m.concurrency=5,r.forEach(function(t){m.push({recs:t},function(){})}),m.drain=function(){var t=[];l()(c).forEach(function(e){var a=c[e];t.push({FieldLabel:e,sum:a.sum,max:a.max,avg:a.avg,min:a.min})}),e(t)}})}}}},801:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cluster-card slds-card"},[a("div",{staticClass:"slds-section",class:[t.isOpen?"slds-is-open":""]},[a("h3",{staticClass:"slds-section__title"},[a("div",{staticClass:"slds-button slds-section__title-action",on:{click:t.toggleCard}},[a("span",{staticClass:"ma-icon ma-icon-chevrondown",class:[t.isOpen?"ma-icon-chevrondown":"ma-icon-chevronright"],staticStyle:{height:"25px"}}),t._v(" "),a("span",{staticClass:"slds-truncate slds-p-right_x-small",staticStyle:{"font-weight":"700",padding:"0px 60px 0 10px"},attrs:{title:t.layerData.name}},[t._v(t._s(t._f("decode")(t.layerData.name)))]),t._v(" "),a("span",{staticStyle:{position:"absolute",right:"8px"}},[t._v(t._s(t._f("decode")(t.layerData.totalRecords)))])])]),t._v(" "),a("div",{staticClass:"slds-section__content slds-p-horizontal_small",staticStyle:{"padding-top":"0","border-top":"2px solid rgb(216, 221, 230)"}},[a("MATabs",{attrs:{activeTabId:t.clusterId}},[a("MATab",{staticClass:"slds-p-around_none",attrs:{title:t._f("decode")(t.$Labels.MA_Aggregates),id:t.getTabId()}},[t.aggregatesLoading?a("div",[t._v("\n                        "+t._s(t._f("decode")(t.$Labels.MA_Loading))+"\n                    ")]):a("div",t._l(t.aggregateData,function(e,s){return a("div",{key:s,staticClass:"slds-section"},[a("h3",{staticClass:"slds-section__title"},[a("div",{staticClass:"slds-button slds-section__title-action"},[a("span",{staticClass:"slds-truncate slds-p-right_x-small",attrs:{title:t._f("decode")(e.FieldLabel)}},[t._v(t._s(e.FieldLabel))])])]),t._v(" "),a("div",{staticClass:"slds-section__content slds-p-around_small",staticStyle:{"border-top":"2px solid rgb(216, 221, 230)"}},[a("dl",{staticClass:"slds-dl_horizontal"},[a("dt",{staticClass:"slds-dl_horizontal__label"},[t._v(t._s(t._f("decode")(t.$Labels.MA_Sum))+":")]),t._v(" "),a("dd",{staticClass:"slds-dl_horizontal__detail"},[t._v(t._s(t.formatNumberString(e.sum)))]),t._v(" "),a("dt",{staticClass:"slds-dl_horizontal__label"},[t._v(t._s(t._f("decode")(t.$Labels.MA_Average))+":")]),t._v(" "),a("dd",{staticClass:"slds-dl_horizontal__detail"},[t._v(t._s(t.formatNumberString(e.avg)))]),t._v(" "),a("dt",{staticClass:"slds-dl_horizontal__label"},[t._v(t._s(t._f("decode")(t.$Labels.MA_Minimum_value))+":")]),t._v(" "),a("dd",{staticClass:"slds-dl_horizontal__detail"},[t._v(t._s(t.formatNumberString(e.min)))]),t._v(" "),a("dt",{staticClass:"slds-dl_horizontal__label"},[t._v(t._s(t._f("decode")(t.$Labels.MA_Maximum_value))+":")]),t._v(" "),a("dd",{staticClass:"slds-dl_horizontal__detail"},[t._v(t._s(t.formatNumberString(e.max)))])])])])}),0)]),t._v(" "),"feature"!==t.layerData.type?a("MATab",{attrs:{title:t._f("decode")(t.$Labels.MA_Legend),id:t.getTabId()}},[a("table",{staticClass:"slds-table slds-table_cell-buffer slds-table_bordered slds-p-top_x-small"},[a("tbody",t._l(t.legendInfo,function(e,s){return a("tr",{key:s,staticClass:"legend-row"},[a("td",{staticClass:"slds-truncate",staticStyle:{"min-width":"100px"}},[t._v(t._s(t._f("decode")(e.label)))]),t._v(" "),a("td",{staticClass:"slds-truncate"},[t._v(t._s(t._f("decode")(e.count)))]),t._v(" "),a("td",{staticClass:"slds-truncate"},[t._v(t._s(t._f("decode")(t.$Labels.MA_of)))]),t._v(" "),a("td",{staticClass:"slds-truncate"},[t._v(t._s(t._f("decode")(e.totalmarkers)))]),t._v(" "),a("td",{staticClass:"legend-color"},[e.icon.indexOf("/services/images/marker")>-1||e.icon.indexOf("servlet.FileDownload")>-1?a("img",{staticStyle:{height:"18px"},attrs:{src:e.icon}}):a("span",{domProps:{innerHTML:t._s(e.icon)}})])])}),0)])]):t._e(),t._v(" "),"feature"!==t.layerData.type?a("MATab",{attrs:{title:t._f("decode")(t.$Labels.MA_Markers),id:t.clusterId}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showTooManyMarkersNotification,expression:"showTooManyMarkersNotification"}],staticClass:"shape-cluster-popup-message-firstXXmarkers"},[t._v("First 100 Markers Displayed")]),t._v(" "),a("table",{staticClass:"slds-table slds-table_cell-buffer slds-table_bordered slds-p-top_x-small"},[a("tbody",t._l(t.limitedMarkers,function(e,s){return a("tr",{key:s,staticClass:"legend-row",on:{click:function(a){return t.navigateToRecord(e)}}},[a("td",{staticStyle:{width:"60px"}},[a("img",{staticStyle:{height:"20px","max-width":"30px"},attrs:{src:t.getMarkerIcon(e)}})]),t._v(" "),a("td",{staticStyle:{"word-wrap":"break-word","white-space":"normal"}},[t._v(t._s(t._f("decode")(e.title)))])])}),0)])]):t._e()],1)],1)])])},staticRenderFns:[]}},802:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tooltip-body flex-grow-1 qidLocation ma-view-body",attrs:{id:"clusterBodyWrapper"}},[a("div",{attrs:{id:"shapeActionsWrapper"}},[a("div",[a("div",{staticClass:"action-bar-wrap"},[a("div",{staticClass:"slds-grid slds-grid_vertical-align-center",staticStyle:{width:"100%"}},[t._l(t.actionButtons,function(e,s){return a("button",{key:s,staticClass:"action-button slds-col action-bar-button actionbutton",attrs:{"data-type":e.type,"data-action":e.action},on:{click:function(a){return t.handleTooltipAction(e)}}},[a("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-grid_horizontal-align-center"},[a("div",{staticClass:"action-button_icon ma-icon",class:e.icon}),t._v(" "),a("div",{staticClass:"action-button_text action-bar-button-text"},[t._v(t._s(t._f("decode")(e.label)))])])])}),t._v(" "),t.actionButtonsExtended.length>0?a("ActionSheet",{attrs:{doDetach:!0,options:t.actionButtonsExtended},on:{select:t.handleTooltipAction,hide:function(e){t.showActionSheet=!1}}}):t._e()],2)])])]),t._v(" "),a("div",{staticClass:"slds-scope momentum-scrolling-y slds-scrollable",staticStyle:{padding:"0.5rem 0.75rem 0.75rem"},attrs:{id:"clusterBody"}},[t.clickOptions.cluster?a("div",{staticClass:"slds-button-group slds-align_absolute-center",staticStyle:{margin:"0.5rem 0 1rem 0"}},[a("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.zoomedOnMarkers},on:{click:t.zoomToMarkers}},[t._v("\n                Zoom To Markers\n            ")]),t._v(" "),a("button",{staticClass:"slds-button slds-button_neutral",on:{click:t.createPolygon}},[t._v("\n                Draw Polygon\n            ")])]):t._e(),t._v(" "),t._l(t.markerLayersInfo,function(t,e){return a("ClusterCard",{key:e,attrs:{layerData:t}})})],2)])},staticRenderFns:[]}}});