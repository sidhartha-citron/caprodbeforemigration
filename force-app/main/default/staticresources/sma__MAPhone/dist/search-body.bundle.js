webpackJsonp([75],{663:function(e,t,s){var a=s(13)(s(664),s(665),null,null,null);e.exports=a.exports},664:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(17),i=s.n(a),r=s(14),n=s.n(r),o=s(35),l=(s.n(o),window),c=l.$,u=l.MAPlotting,m=l.MAToastMessages,d=l.google,h=l.MA;t.default={props:{poiResults:{type:Array,default:function(){return[]}},markerResults:{type:Array,default:function(){return[]}},poiLoading:{type:Boolean,default:!1},markersLoading:{type:Boolean,default:!1},searchTerm:{type:String,default:""}},data:function(){return{poiMarkerCount:0,showPoiSearchResults:!1,localPoiResults:[]}},computed:n()({},Object(o.mapGetters)("mainNavBar",{layers__activeTab:"activeTab"}),{hasResults:function(){return this.poiResults.length>0||this.markerResults.length>0},showResults:function(){return this.searchTerm.length>2},poiMarkers:function(){return window.MA.Map.Search.markers}}),watch:{poiResults:function(e){this.localPoiResults=e}},methods:{showPoiResult:function(e){var t=m.showLoading({message:this.$Labels.MA_Loading+"...",timeOut:0,extendedTimeOut:0});if(e.place_id){var s=e.place_id;this.getPoiInfo(s).then(function(){m.hideMessage(t)})}else{var a=e.structured_formatting.main_text;this.getPoiSuggestionInfo(a).then(function(){m.hideMessage(t)})}},removePOI:function(){try{h.Map.Search.markers.forEach(function(e){e.setMap(null)}),h.Map.Search.markers=[],this.poiMarkerCount=0}catch(e){}},showMarkerResult:function(e){var t=e.qid,s=e.Id,a=(c('#PlottedQueriesTable .savedQuery[qid="'+t+'"]').data()||{}).records,i=(void 0===a?{}:a)[s];if(i){var r=i.marker;r?u.marker_Click.call(r,{markerType:"Marker"}):m.showError({message:"Oh Snap!",subMessage:"Unable to find this record."})}else m.showError({message:"Oh Snap!",subMessage:"Unable to find this record."})},getPoiInfo:function(e){var t=this;return new i.a(function(s,a){var i=h.Map.Search.markers;t.poiMarkerCount=i.length;for(var r=!1,n=0,o=i.length;n<o;n++){var l=i[n],c=l.maData,m=(void 0===c?{}:c).place;if((void 0===m?{}:m).place_id===e){u.mobile.poiClick.call(l,{markerType:"POI"}),r=!0;break}}r?s():new d.maps.places.PlacesService(h.map).getDetails({placeId:e},function(e,i){if(i===d.maps.places.PlacesServiceStatus.OK){var r=new d.maps.Marker({map:h.map,position:e.geometry.location,title:e.name,maData:{place:e},icon:{url:e.icon,size:new d.maps.Size(71,71),origin:new d.maps.Point(0,0),anchor:new d.maps.Point(12,25),scaledSize:new d.maps.Size(25,25)},zIndex:-2});h.Map.Search.markers.push(r),t.poiMarkerCount=h.Map.Search.markers.length,d.maps.event.addListener(r,"click",function(){u.mobile.poiClick.call(r)}),u.mobile.poiClick.call(r,{markerType:"POI"}),s()}else a()})})},getPoiSuggestionInfo:function(e){var t=this;return new i.a(function(s){window.placesSearch(e,{type:"place"}).then(function(e){c.each(h.Map.Search.markers,function(e,t){t.setMap(null)});var a=[];c.each(e,function(e,t){if(t.geometry){var s=new d.maps.Marker({map:h.map,position:t.geometry.location,title:t.name,maData:{place:t},icon:{url:t.icon,size:new d.maps.Size(71,71),origin:new d.maps.Point(0,0),anchor:new d.maps.Point(12,25),scaledSize:new d.maps.Size(25,25)},zIndex:-2});a.push({place_id:t.place_id,structured_formatting:{main_text:t.name,secondary_text:t.formatted_address}}),d.maps.event.addListener(s,"click",function(){u.mobile.poiClick.call(s)}),h.Map.Search.markers.push(s)}}),t.poiMarkerCount=h.Map.Search.markers.length,t.$emit("set-results",{poi:a,markers:t.markerResults}),s()})})}}}},665:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ma-search-body main-panel",class:{in:"search"===e.layers__activeTab},attrs:{id:"searchBody"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.showResults,expression:"!showResults"}],staticClass:"search-empty-state"},[e._m(0),e._v(" "),s("div",[s("p",{staticClass:"text-center"},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_SEARCH_FOR_MARKERS_FROM_ACTIVE_LAYERS_OR_GOOGLE_PLACES_AND))+"\n            ")])])]),e._v(" "),s("div",{staticClass:"search-result-wrap momentum-scrolling-y slds-scrollable",class:{in:e.showResults},attrs:{id:"searchResults"}},[e.showPoiSearchResults?e._e():s("ul",{staticClass:"markerResults"},[s("li",{staticClass:"ma-section-title"},[e._v(e._s(e._f("decode")(e.$Labels.MA_Records_ML)))]),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:e.markersLoading,expression:"markersLoading"}],staticClass:"ma-section-title",staticStyle:{"padding-top":"5px"}},[e._v(e._s(e._f("decode")(e.$Labels.MA_Loading))+"...")]),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:!e.markersLoading&&0===e.markerResults.length,expression:"!markersLoading && markerResults.length === 0"}],staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item"},[e._m(1),e._v(" "),e._m(2)]),e._v(" "),e._l(e.markerResults,function(t,a){return s("li",{directives:[{name:"show",rawName:"v-show",value:!e.markersLoading,expression:"!markersLoading"}],key:a,staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item",on:{click:function(s){return e.showMarkerResult(t)}}},[e._m(3,!0),e._v(" "),s("div",{staticClass:"search-result-content flex-grow-1"},[s("div",{staticClass:"search-result-text"},[e._v("\n                        "+e._s(e._f("decode")(t.tooltip1))+"\n                        "),s("div",{staticClass:"search-result-subtext"},[e._v("\n                            "+e._s(e._f("decode")(t.savedQueryName))+"\n                        ")])])])])})],2),e._v(" "),s("ul",{staticClass:"poiResults"},[s("li",{staticClass:"ma-section-title",staticStyle:{position:"relative"}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Places_POI))+"\n                "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.poiMarkerCount>0,expression:"poiMarkerCount > 0"}],staticStyle:{position:"absolute",top:"2px",right:"10px"}},[s("button",{staticClass:"ma-button ma-button-sm ma-button--red icon-left",staticStyle:{padding:"0 .5rem","line-height":"1.75rem"},attrs:{id:"removePOI"},on:{click:e.removePOI}},[s("div",{staticClass:"ma-icon icon-left ma-icon-clear",staticStyle:{margin:".3rem .5rem 0 0"}}),e._v("\n                        Clear\n                    ")])])]),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:e.poiLoading,expression:"poiLoading"}],staticClass:"ma-section-title",staticStyle:{"padding-top":"5px"}},[e._v(e._s(e._f("decode")(e.$Labels.MA_Loading))+"...")]),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:!e.poiLoading&&0===e.localPoiResults.length,expression:"!poiLoading && localPoiResults.length === 0"}],staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item"},[e._m(4),e._v(" "),e._m(5)]),e._v(" "),e._l(e.localPoiResults,function(t,a){return s("li",{directives:[{name:"show",rawName:"v-show",value:!e.poiLoading,expression:"!poiLoading"}],key:a,staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item",on:{click:function(s){return e.showPoiResult(t)}}},[s("div",{staticClass:"search-result-icon"},[t.place_id?s("div",{staticClass:"ma-icon-checkin"}):s("div",{staticClass:"ma-icon-search"})]),e._v(" "),s("div",{staticClass:"search-result-content flex-grow-1"},[s("div",{staticClass:"search-result-text"},[e._v("\n                        "+e._s(e._f("decode")(t.structured_formatting.main_text))+"\n                        "),t.structured_formatting.secondary_text?s("div",{staticClass:"search-result-subtext"},[e._v("\n                            "+e._s(e._f("decode")(t.structured_formatting.secondary_text))+"\n                        ")]):e._e()])])])})],2)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"text-center"},[t("span",{staticClass:"ma-icon ma-icon-info ma-icon--large"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"search-result-icon"},[t("div",{staticClass:"ma-icon-warning"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"search-result-content flex-grow-1"},[t("div",{staticClass:"search-result-text"},[this._v("No Results Found")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"search-result-icon"},[t("div",{staticClass:"ma-icon-checkin"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"search-result-icon"},[t("div",{staticClass:"ma-icon-warning"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"search-result-content flex-grow-1"},[t("div",{staticClass:"search-result-text"},[this._v("No Results Found")])])}]}}});