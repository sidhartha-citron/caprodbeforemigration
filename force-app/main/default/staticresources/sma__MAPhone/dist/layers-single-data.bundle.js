webpackJsonp([66],{390:function(e,t,s){var a=s(13)(s(391),s(392),null,null,null);e.exports=a.exports},391:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(17),i=s.n(a),n=s(61),l=s.n(n),o=window,r=o.$,d=o.MA;t.default={props:{layerData:{type:Object,required:!0},isLoading:{type:Boolean,default:!1}},data:function(){return{totalMarkers:0,visibleMarkers:0,legendRowSelections:{},legendRowTimeout:null,showAllLegendData:!1,legendHeader:"",legendSubText:""}},computed:{layerType:function(){return this.layerData.type},layerQID:function(){return this.layerData.qid},plottedLayer:function(){return r('#PlottedQueriesTable .DataLayer[qid="'+this.layerQID+'"]')},plottedInfo:function(){return this.plottedLayer.data()||{}},isPolygonLayer:function(){var e=!1;return this.plottedInfo.censusLayer&&(e=!0),e},legendInfo:{get:function(){return this.plottedInfo.legend||{}},set:function(e){this.plottedInfo.legend=e}},legendRows:function(){return this.legendInfo.rows},legendShowText:function(){var e=this.$Labels.MA_Show_All;return this.showAllLegendData&&(e=this.$Labels.MA_Show_Less),e}},mounted:function(){this.build()},methods:{build:function(){this.updateLegend()},toggleVisibleLegend:function(){this.showAllLegendData=!this.showAllLegendData},updateLegend:function(){var e=0,t=0,s=l()(this.legendRows)||[];if(this.isPolygonLayer)this.showAllLegendData=!0,this.legendHeader=this.legendInfo.title||"",this.legendSubText=this.legendInfo.subTitle||"";else{for(var a=0;a<s.length;a++){var i=s[a],n=this.legendRows[i];e+=n.totalmarkers,t+=n.count}this.visibleMarkers=t,this.totalMarkers=e}},toggleRow:function(e){var t=this;clearTimeout(this.legendRowTimeout),this.legendRowTimeout=null,this.legendRowSelections[e.legendId]=e.active,this.legendRowTimeout=setTimeout(function(){t.toggleRows().then(function(){t.build()})},250)},toggleRows:function(){var e=this;return new i.a(function(t){e.updateDomInfo(),e.resetLegendCounts();var s=window.MADemographicLayer.getRenderModes(r(".DataLayer")),a=e.plottedInfo,i=e.plottedLayer,n=e.legendRowSelections,o=1e3;d.Map.hitTestShapeMgr.hasShapes()&&d.Util.isIE()?o=20:d.Map.hitTestShapeMgr.hasShapes()&&(o=500);var c=a.records||{},u=l()(c),g=u.length,h=[],p=e.legendRows,v=s.filter(function(e){return"Cluster"===e}).length>0,f=window.getProperty(window.userSettings||{},"InvertProximity",!1)||!1;setTimeout(function e(){if(u.length>0){i.find(".status").text("Processing... "+u.length+" remaining");for(var s=0;s<o&&u.length>0;){s++;var l=u.pop(),r=c[l],_=r.data.rowid,m=void 0;try{(m=p[_]).totalmarkers++}catch(e){m={count:0,totalmarkers:0}}if(void 0===n[_]&&m.active)r.isVisible&&(m.count++,h.push(r.clusterMarker));else if(n[_])if(v){if(d.Map.hitTestShapeMgr.hasShapes()){var w=d.Map.hitTestShapeMgr.containsLatLng(r.markerCoordinate);f&&w||!f&&!w?r.isVisible=!1:(r.isVisible=!0,h.push(r.clusterMarker))}else r.isVisible=!0,h.push(r.clusterMarker);m.count++}else r.isVisible=!1}setTimeout(e,1)}else a.clusterGroup.setMap(d.map),a.clusterGroup.clearMarkers(),a.clusterGroup.addMarkers(h),a.clusterGroup.repaint(),i.find(".status").html("Records: "+d.Util.formatNumberString(g)),t()},1)})},updateDomInfo:function(){for(var e=this.legendRowSelections,t=l()(e),s=0;s<t.length;s++){var a=t[s],i=e[a];this.legendInfo.rows[a].active=i}this.plottedLayer.data("legend",this.legendInfo)},resetLegendCounts:function(){for(var e=this.legendRows,t=l()(e),s=0;s<t.length;s++){var a=e[t[s]];a.totalmarkers=0,a.count=0}}}}},392:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"layers-individual-filter-wrap"},[s("div",{staticClass:"ma-section-title ma-section-title",staticStyle:{padding:"18px 16px 16px"}},[s("span",{staticClass:"legend-title"},[e._v(e._s(e._f("decode")(e.$Labels.MA_MARKER_LEGEND)))]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:!e.isPolygonLayer,expression:"!isPolygonLayer"}],staticClass:"legend-moreless-text",staticStyle:{position:"absolute",right:"0px",top:"2px",height:"45px","line-height":"45px",padding:"0 15px"},on:{click:e.toggleVisibleLegend}},[s("span",{staticClass:"moreless-text"},[e._v(e._s(e._f("decode")(e.legendShowText)))])])]),e._v(" "),s("div",{staticClass:"pad-16-16-8 background--white"},[s("div",{staticClass:"margin-0 text--dark-blue legendField"},[s("div",{staticClass:"ma-item-name-subtitle plottinginfo-wrapper",staticStyle:{"font-size":"16px"}},[e.isPolygonLayer?s("div",[s("div",{staticClass:"margin-0 text--dark-blue legendField"},[s("strong",[e._v(e._s(e._f("decode")(e.legendHeader)))]),e._v(" "),s("div",{staticClass:"ma-item-name-subtitle plottinginfo-wrapper"},[e._v("\n                            "+e._s(e._f("decode")(e.legendSubText))+"\n                        ")])])]):s("div",[s("div",{staticClass:"status"},[e._v(e._s(e._f("decode")(e.$Labels.MA_RECORDS))+": "+e._s(e._f("decode")(e.totalMarkers)))]),e._v(" "),s("div",{staticClass:"status"},[e._v(e._s(e._f("decode")(e.totalMarkers))+" "+e._s(e._f("decode")(e.$Labels.MA_Markers_Created))+", "+e._s(e._f("decode")(e.visibleMarkers))+" "+e._s(e._f("decode")(e.$Labels.MA_Visible)))])])])])]),e._v(" "),s("div",{staticClass:"legend-wrap background--white"},e._l(e.legendRows,function(t,a,i){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.totalmarkers>0||e.showAllLegendData,expression:"row.totalmarkers > 0 || showAllLegendData"}],key:a,staticClass:"legend-item legend-row ma-form-control-wrap ma-checkbox-wrap flex-horizontal",attrs:{"data-id":a,uid:i}},[s("div",{staticClass:"flex-grow-1"},[e.isPolygonLayer?s("div",{staticClass:"ma-checkbox-label"},[e._v("\n                    "+e._s(e._f("decode")(t.label))+"\n                ")]):s("label",{staticClass:"ma-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.active,expression:"row.active"}],staticClass:"legend-checkbox",attrs:{id:"legend-checkbox13","data-rule":i,uid:i,checked:"checked",name:"checkbox",type:"checkbox"},domProps:{checked:Array.isArray(t.active)?e._i(t.active,null)>-1:t.active},on:{change:[function(s){var a=t.active,i=s.target,n=!!i.checked;if(Array.isArray(a)){var l=e._i(a,null);i.checked?l<0&&e.$set(t,"active",a.concat([null])):l>-1&&e.$set(t,"active",a.slice(0,l).concat(a.slice(l+1)))}else e.$set(t,"active",n)},function(s){return e.toggleRow(t)}]}}),e._v(" "),s("span",{staticClass:"ma-checkbox-faux"}),e._v(" "),s("span",{staticClass:"ma-checkbox-label"},[e._v(e._s(e._f("decode")(t.label)))])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isPolygonLayer,expression:"!isPolygonLayer"}],staticClass:"legend-count"},[s("span",{staticClass:"visiblemarkers"},[e._v(e._s(e._f("decode")(t.count)))]),e._v(" "),s("span",{staticClass:"of"},[e._v(e._s(e._f("decode")(e.$Labels.MA_of)))]),e._v(" "),s("span",{staticClass:"totalmarkers"},[e._v(e._s(e._f("decode")(t.totalmarkers)))])]),e._v(" "),s("div",{staticClass:"legend-marker"},[e.isPolygonLayer?s("div",{staticStyle:{border:"1px solid silver",width:"20px",height:"20px"},style:{background:"#"+t.markerValue}}):s("img",{staticClass:"legend-image",staticStyle:{height:"20px","max-width":"30px"},attrs:{src:t.icon,"data-id":t.markerValue}})])])}),0)])},staticRenderFns:[]}}});