webpackJsonp([26],{219:function(e,t,i){"use strict";t.__esModule=!0;var s=a(i(231)),n=a(i(234));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,s.default)(Object(e)))return function(e,t){var i=[],s=!0,a=!1,r=void 0;try{for(var o,l=(0,n.default)(e);!(s=(o=l.next()).done)&&(i.push(o.value),!t||i.length!==t);s=!0);}catch(e){a=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw r}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},231:function(e,t,i){e.exports={default:i(232),__esModule:!0}},232:function(e,t,i){i(28),i(18),e.exports=i(233)},233:function(e,t,i){var s=i(36),n=i(3)("iterator"),a=i(19);e.exports=i(0).isIterable=function(e){var t=Object(e);return void 0!==t[n]||"@@iterator"in t||a.hasOwnProperty(s(t))}},234:function(e,t,i){e.exports={default:i(235),__esModule:!0}},235:function(e,t,i){i(28),i(18),e.exports=i(236)},236:function(e,t,i){var s=i(8),n=i(64);e.exports=i(0).getIterator=function(e){var t=n(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return s(t.call(e))}},260:function(e,t,i){var s=i(13)(i(264),i(265),function(e){i(262)},null,null);e.exports=s.exports},262:function(e,t,i){var s=i(263);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i(198)("324f9978",s,!0)},263:function(e,t,i){(e.exports=i(197)(void 0)).push([e.i,".slds-select{-moz-appearance:none;-webkit-appearance:none;appearance:none;padding-right:30px}.slds-select,.slds-select option{padding-left:12px}.select-icon{color:#706e6b;font-size:12px;line-height:1;position:absolute;top:11px;right:12px}",""])},264:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(219),n=i.n(s);t.default={name:"MASelect",props:{label:{type:String,default:""},options:{type:Object|Array,required:!0},keyString:{type:String,default:"key"},valueString:{type:String,default:"value"},hasNoneOption:{type:Boolean,default:!0},value:{type:String|Number,default:""},default:{type:String|Number,default:""},isRequired:{type:Boolean,default:!1},isInvalid:{type:Boolean,default:!1},placeholder:{type:String,default:""},isMultiSelect:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{defaultValue:this.default}},computed:{showLabel:function(){return this.label}},watch:{value:function(){var e={};e[this.keyString]=this.value,e[this.valueString]=this.getSelectedValue(),this.$emit("change",e)}},methods:{decodeHtml:function(e){if(!e)return e;var t=window.document.createElement("textarea");return t.innerHTML=e,t.value},getKey:function(e){return"string"==typeof e||"number"==typeof e?e:e[this.keyString]},getValue:function(e){return"string"==typeof e||"number"==typeof e?e:e[this.valueString]},isSelected:function(e){var t=!1;return t=Array.isArray(this.value)?-1!==this.value.indexOf(this.getKey(e)):this.getKey(e)===this.value,t},change:function(e){e||(e=null);for(var t=[],i=0;i<e.length;i++){var s=e[i];t.push(s.value)}if(1===t.length){var a=t;t=n()(a,1)[0]}this.$emit("input",t)},getSelectedValue:function(){var e=this;if(!this.options||!this.options.length)return"";var t=this.options.find(function(t){return e.getKey(t)===e.value});return t?this.decodeHtml(this.getValue(t)):null},remove:function(){this.$emit("input",""),this.doHide()}}}},265:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"slds-form-element",class:{"slds-has-error":e.isInvalid}},[e.showLabel?i("label",{staticClass:"slds-form-element__label"},[e.isRequired?i("abbr",{staticClass:"slds-required",attrs:{title:"required"}},[e._v("*")]):e._e(),e._v("\n        "+e._s(e.decodeHtml(e.label))+"\n    ")]):e._e(),e._v(" "),i("div",{staticClass:"slds-is-relative"},[i("select",e._b({staticClass:"slds-select",staticStyle:{overflow:"auto"},attrs:{placeholder:e.placeholder,disabled:e.disabled},on:{change:function(t){return e.change(t.target.selectedOptions)}}},"select",{multiple:e.isMultiSelect},!1),[e.hasNoneOption?i("option",{attrs:{value:""}},[e._v("-- None --")]):e._e(),e._v(" "),e._l(e.options,function(t,s){return i("option",{key:s,domProps:{value:e.getKey(t),selected:e.isSelected(t)}},[e._v(e._s(e.getValue(t)))])})],2),e._v(" "),e._m(0)]),e._v(" "),e.isInvalid?i("div",{staticClass:"slds-form-element__help"},[e._t("errors",[e._v("This field is required.")])],2):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"select-icon"},[t("span",{staticClass:"ma-icon ma-icon-down"})])}]}},279:function(e,t,i){var s=i(13)(i(280),i(281),null,null,null);e.exports=s.exports},280:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(217),n=i.n(s),a=window.getProperty;t.default={components:{MAModal:n.a},props:{searchFunction:{type:Function,required:!0},searchKey:{type:String,required:!0},searchLabel:{type:String,required:!0},minimumSearchLength:{type:Number,required:!1,default:2}},data:function(){return{searchResults:[],styleObject:{position:"relative",padding:0,background:"#fff",border:"1px solid #dddbda","border-radius":".25rem","background-clip":"padding-box","box-shadow":"0 2px 2px 0 rgba(0,0,0,.1)"},searchTerm:"",isLoading:!1,searchTimeout:null}},computed:{showEmptyState:function(){var e=0===this.searchResults.length,t=this.searchTerm.length<=this.minimumSearchLength;return t||e||t}},watch:{searchTerm:function(e){e.length>this.minimumSearchLength&&this.debounceSearch(e)}},mounted:function(){var e=this;this.$nextTick(function(){e.$refs.mobileSearchInput.focus()})},methods:{returnResult:function(e){this.$emit("result",e),this.close()},close:function(){this.$emit("close-search-modal")},clearInput:function(){this.returnResult({id:"",label:""})},debounceSearch:function(e){var t=this;clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){t.isLoading=!0,t.searchResults=[],t.searchFunction(e).then(function(e){t.processResults(e)}).catch(function(e){console.warn(e)}).finally(function(){t.isLoading=!1})},250)},processResults:function(e){var t=this;e.forEach(function(e){t.searchResults.push({label:a(e,t.searchLabel,!1),id:a(e,t.searchKey,!1),result:e})})}}}},281:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("MAModal",{staticClass:"slds-modal_large",attrs:{doDetach:!0,title:e.$Labels.MA_Search,closeLabel:e.$Labels.MA_Close},on:{close:e.close}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("div",{staticClass:"ma-form-control has-inset-icon--right"},[i("div",{staticClass:"slds-form-element"},[i("div",{staticClass:"slds-form-element__control slds-input-has-icon slds-input-has-icon_right"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],staticClass:"slds-input__icon-group slds-input__icon-group_right"},[i("div",{staticClass:"slds-spinner slds-spinner_brand slds-spinner_x-small slds-input__spinner",staticStyle:{right:"5px"},attrs:{role:"status"}},[i("span",{staticClass:"slds-assistive-text"},[e._v("Loading")]),e._v(" "),i("div",{staticClass:"slds-spinner__dot-a"}),e._v(" "),i("div",{staticClass:"slds-spinner__dot-b"})])]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"slds-icon slds-input__icon slds-input__icon_left slds-icon-text-default ma-icon ma-icon-search"}),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],ref:"mobileSearchInput",staticClass:"slds-input",attrs:{placeholder:e.$Labels.MA_Search+"...",type:"text"},domProps:{value:e.searchTerm},on:{input:function(t){t.target.composing||(e.searchTerm=t.target.value)}}})])])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showEmptyState,expression:"showEmptyState"}],staticClass:"search-empty-state"},[i("div",{staticClass:"text-center"},[i("span",{staticClass:"ma-icon ma-icon-info ma-icon--large"})]),e._v(" "),i("div",[i("p",{staticClass:"text-center"},[e._v("Search above for available options")])])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.showEmptyState,expression:"!showEmptyState"}],staticClass:"slds-m-top_medium"},e._l(e.searchResults,function(t,s){return i("article",{key:s,staticClass:"slds-card",style:e.styleObject,on:{click:function(i){return e.returnResult(t)}}},[i("div",{staticClass:"slds-card__header slds-grid"},[i("header",{staticClass:"slds-media slds-media_center slds-has-flexi-truncate"},[i("div",{staticClass:"slds-media__body"},[i("h2",{staticClass:"slds-card__header-title"},[i("div",{staticClass:"slds-card__header-link slds-truncate"},[i("span",[e._v(e._s(e._f("decode")(t.label)))])])])])])])])}),0)]),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"float-right"},[i("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.close}},[e._v("\n                "+e._s(e.$Labels.MA_Cancel)+"\n            ")]),e._v(" "),i("button",{staticClass:"slds-button slds-button_brand",on:{click:e.clearInput}},[e._v("\n                "+e._s(e.$Labels.MA_Clear)+"\n            ")])])])])},staticRenderFns:[]}},282:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),n=function(e){return e&&e.__esModule?e:{default:e}}(i(7));var a=window.MARemoting,r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,null,[{key:"getLiveSummaryAndHistory",value:function(e){var t=this;return new Promise(function(i,s){(new n.default).setAction(a.MapAnythingIORequest).setErrorHandler(t.handleRemoteActionError.bind(t)).invoke([{method:"get",action:"devices/summary",subType:"live/client",version:"v5"},e],function(e){if(e.success)i(e);else try{var t=JSON.parse(e.errInfo).error.message;s(t)}catch(t){s(e)}},{escape:!1,buffer:!1})})}},{key:"handleRemoteActionError",value:function(e,t,i){e(new Error(i.message))}},{key:"sortByProperty",value:function(e,t){return e.sort(function(e,i){return e[t]<i[t]?-1:e[t]>i[t]?1:0}),e}},{key:"getLiveConfigs",value:function(e){return new Promise(function(t){var i={speedLimitUnits:"mph",speedLimitDurationTimeUnits:"Minutes",speedLimitDuration:null,speedLimit:250,configName:"MapAnything Default Configuration",configId:"ma_defaultConfig",allowedTimeUnits:"Minutes",allowedTime:6e4,allowedDistanceUnits:"feet",allowedDistance:7e5};(new n.default).setAction(a.getLiveConfigs).setErrorHandler(function(e){console.warn(e),t([i])}).invoke([e],function(e){var s=e.success,n=void 0!==s&&s,a=e.data,r=void 0===a?[]:a;if(n){var o=[];if("string"==typeof r)try{o=JSON.parse(r)}catch(e){o=[]}else Array.isArray(r)&&(o=r);o.length<1&&o.push(i),o.sort(function(e,t){return e.configName<t.configName?-1:e.configName>t.configName?1:0}),t(o)}else t([{speedLimitUnits:"mph",speedLimitDurationTimeUnits:"Minutes",speedLimitDuration:5,speedLimit:65,configName:"Teddy Summary Test",configId:"a3129000000AISqAAO",allowedTimeUnits:null,allowedTime:2,allowedDistanceUnits:"Feet",allowedDistance:15},{speedLimitUnits:"mph",speedLimitDurationTimeUnits:"Minutes",speedLimitDuration:1,speedLimit:5,configName:"All Live",configId:"a3129000000JSQOAA4",allowedTimeUnits:null,allowedTime:1,allowedDistanceUnits:null,allowedDistance:200}])},{escape:!1,buffer:!1})})}}]),e}();t.default=r},295:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),n=l(i(29)),a=l(i(282)),r=l(i(66)),o=l(i(20));function l(e){return e&&e.__esModule?e:{default:e}}var c=window,d=c.moment,u=c.getProperty,m=c.MASystem,v=c.MADevice,p=c.google,f=c.MAPlotting,h=c.MA,g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=new window.OverlappingMarkerSpiderfier(window.MA.map,{keepSpiderfied:!0});t.addListener("spiderfy",function(e){e.forEach(function(e){e.spiderfied=!0})}),t.addListener("unspiderfy",function(e){e.forEach(function(e){e.spiderfied=!1})}),this.summaryOptions={},this.timeZone=m.User.timezoneId,this.id=(0,n.default)(),this.showIcons=!1,this.routeData={tileKey:null,events:[],summaryEvents:t,startVertice:null,endVertice:null}}return s(e,[{key:"setSummaryOptions",value:function(e){return this.summaryOptions=e,this}},{key:"setTimeZone",value:function(e){this.timeZone=e}},{key:"getSummaryEvents",value:function(){return this.summaryEvents}},{key:"getEventTypes",value:function(){return this.eventTypes}},{key:"getSummaryOptions",value:function(){return this.summaryOptions}},{key:"build",value:function(){var e=this;return new Promise(function(t,i){a.default.getLiveSummaryAndHistory(e.summaryOptions).then(function(s){var n=s.data,a=void 0===n?{}:n,r=s.success;void 0!==r&&r?e.plotLiveHistory(a).then(function(){t()}).catch(function(e){i(e)}):i(new Error("Unable to get Live Events History"))}).catch(function(e){i(e)})})}},{key:"updateEventTypes",value:function(){var e=this;this.eventTypes=this.eventTypes.map(function(t){var i=0;return e.summaryEvents.forEach(function(e){t===e.formattedEventType&&i++}),{value:t,show:"Location Update"!==t,eventCount:i}})}},{key:"prepareSummaryEvents",value:function(e,t){var i=this,s=[];e.forEach(function(e){var t={};"Location Update"===e.eventType&&(t.formattedTime=d(e.timestamp).tz(i.timeZone).format("h:mm A"),t.timestamp=new Date(e.timestamp).getTime(),t.position={address:{address:u(e,"position.address.address",!1)||""},lat:u(e,"position.lat",!1),lng:u(e,"position.lng",!1)},t.formattedEventType="Location Update",t.eventType=u(e,"eventType",!1),s.push(t))});var n=0;return t.events.forEach(function(e){var t={stop:"Stop",speeding:"Speeding",fastAcceleration:"Hard Acceleration",hardBrake:"Hard Braking",buttonPress:e.translation||"Button Press"},a={};a.formattedTime=d(e.start).tz(i.timeZone).format("h:mm A"),a.timestamp=new Date(e.start).getTime(),a.position={address:{address:u(e,"position.address.address",!1)||""},lat:u(e,"position.lat",!1),lng:u(e,"position.lng",!1)},a.formattedEventType=t[u(e,"eventType",!1)]||"Location Update",a.eventType=u(e,"eventType",!1)||"Location Update",a.duration=u(e,"duration",!1),a.postedSpeed=u(e,"speedLimit",!1),a.actualSpeed=u(e,"maxSpeed",!1),a.amountOverLimit=u(e,"maxSpeed",!1)-u(e,"speedLimit",!1)||void 0,"mi"===o.default.units&&(a.postedSpeed=.621371*Number(a.postedSpeed)||void 0,a.actualSpeed=.621371*Number(a.actualSpeed)||void 0,a.amountOverLimit=.621371*Number(a.amountOverLimit)||void 0),"stop"===e.eventType?(n++,a.stopOrder=n,a.stopStartTime=e.start,a.stopEndTime=e.end):a.stopOrder=null,s.push(a)}),this.eventTypes=[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(new Set(s.map(function(e){return e.formattedEventType})))),this.summaryEvents=a.default.sortByProperty(s,"timestamp"),this}},{key:"plotLiveHistory",value:function(e){var t=this;return new Promise(function(i,s){var n=e.positions,a=void 0===n?[]:n,r=e.summary,o=void 0===r?{}:r;if(0===a.length){s(new Error("No events found"))}else t.tileKey=e.key,t.prepareSummaryEvents(a,o),t.updateEventTypes(),t.removeDeviceHistory(),t.plotStarEndVertices(),t.plotHistoryRouterOverlay(),t.plotSummaryEvents(),i()})}},{key:"plotStarEndVertices",value:function(){var e=new v(this.summaryEvents[0]),t=new v(this.summaryEvents[this.summaryEvents.length-1]),i=new p.maps.Marker({position:e.getPosition(),icon:f.getFirstIcon(),device:e,timezoneId:this.timeZone}),s=new p.maps.Marker({position:t.getPosition(),icon:f.getLastIcon(),device:t,timezoneId:this.timeZone});i.setMap(h.map),s.setMap(h.map),this.routeData.startVertice=i,this.routeData.endVertice=s}},{key:"plotHistoryRouterOverlay",value:function(){r.default.addRouteTileOverlay(m.Organization.MAIO_URL,this.id,this.tileKey)}},{key:"plotSummaryEvents",value:function(){var e=this;try{var t=m.Organization.MAIO_URL+"/services/images/marker?color=d50000",i={stop:"&icon=markerWaypoint&text=",speeding:"&forlegend=false&icon=live_event_speeding_begin",fastAcceleration:"&forlegend=false&icon=live_event_quick_acceleration",hardBrake:"&forlegend=false&icon=live_event_hard_braking",buttonPress:"&forlegend=false&icon=live_event_touch","Location Update":"&forlegend=false&icon=LiveTrackingDot"};this.routeData.summaryEvents.getMarkers().forEach(function(e){e.setMap(null)}),this.routeData.summaryEvents.clearMarkers();var s=new p.maps.LatLngBounds;this.routeData.pathBounds=s;var n=0;return this.summaryEvents.forEach(function(s){if(e.eventTypes.find(function(e){return e.value===s.formattedEventType}).show){n++;var a={url:e.showIcons?t+i[s.eventType]:t+i["Location Update"]};"stop"===s.eventType&&e.showIcons&&(a.url+=s.stopOrder,a.scaledSize={height:38,width:31});var r=new p.maps.Marker({position:{lat:s.position.lat,lng:s.position.lng},icon:a,map:h.map,optimized:!0,zIndex:1});e.routeData.pathBounds.extend({lat:s.position.lat,lng:s.position.lng}),s.marker=r,e.routeData.summaryEvents.addMarker(r)}}),this.routeData.startVertice&&this.routeData.pathBounds.extend(this.routeData.startVertice.getPosition()),this.routeData.endVertice&&this.routeData.pathBounds.extend(this.routeData.endVertice.getPosition()),void(n>0&&h.map.fitBounds(this.routeData.pathBounds))}catch(e){throw e}}},{key:"removeDeviceHistory",value:function(){this.routeData.startVertice&&this.routeData.endVertice&&(this.routeData.startVertice.setMap(null),this.routeData.endVertice.setMap(null)),r.default.removeTileOverlay(this.id),this.routeData.summaryEvents.getMarkers().forEach(function(e){e.setMap(null)}),this.routeData.summaryEvents.clearMarkers(),h.Map.InfoBubble.hide()}}]),e}();t.default=g},402:function(e,t,i){var s=i(13)(i(403),i(427),null,null,null);e.exports=s.exports},403:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(61),n=i.n(s),a=i(17),r=i.n(a),o=i(14),l=i.n(o),c=i(260),d=i.n(c),u=i(282),m=i.n(u),v=i(279),p=i.n(v),f=i(404),h=i.n(f),g=i(35),y=(i.n(g),i(295)),_=i.n(y),b=window,w=b.$,T=b.moment;t.default={components:{MobileSelect:d.a,MobileSearch:p.a,DateSelectionModal:function(){return i.e(17).then(i.bind(null,283))},LiveTrackingEventList:h.a},props:{layerData:{type:Object,required:!0}},data:function(){return{liveConfigs:[],liveConfig:"",config:{},showSearch:!1,searchResult:null,assetName:"",assedId:"",showDateModal:!1,dateString:"",formattedDate:"",date:null,timeZoneList:[],timeZoneId:"",startTime:"",endTime:"",selectedColor:""}},computed:l()({layerId:function(){return this.layerData.layerId},qid:function(){return this.layerData.qid},record:function(){return this.layerData.record},device:function(){return this.record.device}},Object(g.mapGetters)("layers",{layers__liveTrackingLayers:"liveTrackingLayers"}),{summaryOptions:function(){return{deviceid:this.assedId,from:1e3*T.tz(this.formattedDate+" "+this.startTime,"YYYY-MM-DD HH:mm a",this.timeZoneId).unix(),to:1e3*T.tz(this.formattedDate+" "+this.endTime,"YYYY-MM-DD HH:mm a",this.timeZoneId).unix(),stoppriority:"distance",speedlimitduration:this.getSelectedConfigValue("speedLimitDuration"),speedlimitabove:this.getSelectedConfigValue("speedLimit"),allowedmins:this.getSelectedConfigValue("allowedTime"),allowedfeet:this.getSelectedConfigValue("allowedDistance"),history:!0,color:this.layerData.color,opacity:1,snap:!0}}}),created:function(){var e=this;m.a.getLiveConfigs(this.layerId).then(function(t){e.liveConfigs=t,e.config=e.layerData.config||{},e.liveConfig=e.config.configId,e.assetName=e.layerData.name,e.assedId=e.layerData.selectedDeviceId,e.date=e.layerData.date.clone(),e.dateString=e.date.format(e.$User.dateFormat.toUpperCase()),e.formattedDate=e.date.format("YYYY-MM-DD"),e.buildTimeZones(),e.timeZoneId=e.layerData.timeZone,e.startTime=e.layerData.startTime,e.endTime=e.layerData.endTime})},methods:l()({},Object(g.mapMutations)("layers",{layers__updateLayerInfo:"updateLayerInfo"}),{toggleSearch:function(e){this.showSearch=e},toggleDateModal:function(e){this.showDateModal=e},setDate:function(e){this.date.set({date:e.get("date"),month:e.get("month"),year:e.get("year")}),this.dateString=this.date.format(this.$User.dateFormat.toUpperCase()),this.formattedDate=this.date.format("YYYY-MM-DD")},buildTimeZones:function(){var e=window.getProperty(window.MASystem,"Organization.timeZoneList",!1);this.timeZoneId=this.$User.timezoneId,Array.isArray(e)?this.timeZoneList=e:(this.timeZoneId="GMT",this.timeZoneList=[{label:"(GMT+00:00) Greenwich Mean Time (GMT)",value:"GMT"}])},updateSearchValue:function(e){this.assetName=e.label,this.searchResult=e.result,this.assedId=e.id},assetSearch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new r.a(function(i,s){t&&""!==t||s(new Error("Missing Required Param: searchTerm"));var a=w('#PlottedQueriesTable .PlottedRowUnit[qid="'+e.layerData.liveLayerQid+'"]');if(a){for(var r=(a.data()||{}).records,o=void 0===r?{}:r,l=n()(o),c=[],d=0;d<l.length&&6!==c.length;d++){var u=o[l[d]],m=u.tooltip1;if((u.isVisible||u.isClustered)&&-1!==m.toLowerCase().indexOf(t.toLowerCase())){var v=u.device,p=void 0===v?{}:v;c.push({label:m,deviceId:p.deviceId,device:p,record:u})}}i(c)}else s(new Error("Search not available for this layer: layer not found"))})},applyChanges:function(){var e=this;this.updateLayerSettings();var t=this.layers__liveTrackingLayers[this.qid];t&&t.removeDeviceHistory(),this.layers__liveTrackingLayers[this.qid]=null;var i=new _.a;i.setSummaryOptions(this.summaryOptions),i.setTimeZone(this.timeZoneId),i.build().then(function(){e.layers__liveTrackingLayers[e.qid]=i}).catch(function(e){console.warn(e)})},updateLayerSettings:function(){var e=this,t=l()({},this.layerData,{config:this.liveConfigs.find(function(t){return t.configId===e.liveConfig}),date:this.date,startTime:this.startTime,endTime:this.endTime,name:this.assetName,selectedDeviceId:this.assedId,timeZone:this.timeZoneId});this.layers__updateLayerInfo(t)},getSelectedConfigValue:function(e){var t=this,i=this.liveConfigs.find(function(e){return e.configId===t.liveConfig}),s=void 0;return i&&(s=i[e])&&("allowedDistance"===e&&"meters"===i.allowedDistanceUnits&&(s/=.3048),"allowedTime"===e&&"hours"===i.allowedTimeUnits&&(s*=60),"speedLimit"===e&&"kph"===i.speedLimitUnits&&(s*=.62137119),"speedLimitDuration"===e&&"hours"===i.speedLimitDurationTimeUnits&&(s*=60)),s}})}},404:function(e,t,i){var s=i(13)(i(405),i(406),null,null,null);e.exports=s.exports},405:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(14),n=i.n(s),a=i(35);i.n(a);t.default={props:{qid:{type:String,required:!0}},data:function(){return{eventTypes:[],showEventList:!1,hasError:!1,errorMessage:"",showDots:!0,showIcons:!1,events:[]}},computed:n()({},Object(a.mapGetters)("layers",{layers__liveTrackingLayers:"liveTrackingLayers"}),{liveTrackingLayer:function(){return this.layers__liveTrackingLayers[this.qid]},numEventsDisplayed:function(){var e=this.events.length;return 0!==e&&this.eventTypes.forEach(function(t){t.show||(e-=t.eventCount)}),e}}),created:function(){this.events=this.liveTrackingLayer.getSummaryEvents(),this.eventTypes=this.liveTrackingLayer.getEventTypes()},methods:{toggleFilterPopover:function(){},toggleEventList:function(){this.showEventList=!this.showEventList},showEventTooltip:function(){}}}},406:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"slds-p-left_small slds-p-right_xx-small slds-p-vertical_xx-small",attrs:{id:"liveTrackingHistoryEventListHeader"}},[s("div",{staticClass:"slds-grid slds-grid_vertical-align-center"},[s("div",{staticClass:"slds-col"},[e._v("\n                "+e._s(e.numEventsDisplayed)+" "+e._s(e.$Labels.EVENTS)+"\n            ")]),e._v(" "),s("div",{staticClass:"slds-is-relative has-popover"},[e.eventTypes.length>0?s("button",{staticClass:"slds-button slds-button_subtle popover-trigger",on:{click:e.toggleFilterPopover}},[e._v("Filter"),s("span",{staticClass:"slds-button__icon slds-button__icon_right ma-icon ma-icon-filter"})]):e._e()]),e._v(" "),s("div",{staticClass:"slds-hint-parent slds-m-left_small"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:e.toggleEventList}},[e.showEventList?s("span",{staticClass:"slds-button__icon slds-button__icon_hint ma-icon ma-icon-contract-alt"}):s("span",{staticClass:"slds-button__icon slds-button__icon_hint ma-icon ma-icon-expand-alt"})])])])]),e._v(" "),e.showEventList?s("div",{attrs:{id:"liveTrackingHistoryEventListBody"}},[e.hasError?s("div",[s("div",{staticClass:"events-list-error"},[e._m(0),e._v(" "),s("div",[e._v("\n                    "+e._s(e.errorMessage)+"\n                ")])])]):e._e(),e._v(" "),e._l(e.events,function(t,n){return e.eventTypes.find(function(e){return e.value===t.formattedEventType}).show?s("div",{key:n,staticClass:"live-tracking-history-list-item slds-grid slds-grid_vertical-align-center",on:{click:function(i){return e.showEventTooltip(t)}}},[s("div",{staticClass:"live-tracking-history-list-item_icon"},[e.showIcons&&["speeding"].includes(t.eventType)?s("img",{attrs:{src:i(407)}}):e._e(),e._v(" "),e.showIcons&&["hardBrake"].includes(t.eventType)?s("img",{attrs:{src:i(408)}}):e._e(),e._v(" "),e.showIcons&&["fastAcceleration"].includes(t.eventType)?s("img",{attrs:{src:i(409)}}):e._e(),e._v(" "),e.showIcons&&["buttonPress"].includes(t.eventType)?s("img",{attrs:{src:i(410)}}):e._e(),e._v(" "),e.showIcons&&["stop"].includes(t.eventType)?s("img",{attrs:{src:i(411)}}):e._e(),e._v(" "),e.showDots||e.showIcons&&["Location Update"].includes(t.eventType)?s("img",{attrs:{src:i(412)}}):e._e(),e._v(" "),e.showIcons&&t.stopOrder?s("span",{staticClass:"live-tracking-history-list-item_icon-stop-association-number"},[e._v("\n                    "+e._s(t.stopOrder)+"\n                ")]):e._e()]),e._v(" "),s("div",{staticClass:"slds-col slds-p-right_medium"},[s("div",[e._v(e._s(t.formattedEventType||t.stopAssociationTitle))])]),e._v(" "),s("div",{staticClass:"slds-text-body_small slds-text-color_weak"},[e._v("\n                "+e._s(t.formattedTime)+"\n            ")])]):e._e()})],2):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",{staticClass:"ma-icon ma-icon-error"})])}]}},407:function(e,t,i){e.exports=i.p+"images/d25bb702b886d7456ce27c7ceacb990d.svg"},408:function(e,t,i){e.exports=i.p+"images/97320d8939a531f2b5f62602cddb4abf.svg"},409:function(e,t,i){e.exports=i.p+"images/9b600a9c597c5bb1614c8eccea5bc38b.svg"},410:function(e,t,i){e.exports=i.p+"images/f15267bad1ab128e8cb85161c0413075.svg"},411:function(e,t,i){e.exports=i.p+"images/97eb1e90098da0a37aca822320fdbbc8.svg"},412:function(e,t,i){e.exports=i.p+"images/b1d1475da95754325472d5d3182d9ca5.svg"},427:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"slds-p-around_small"},[i("MobileSelect",{attrs:{options:e.liveConfigs,doDetach:!0,isRequired:!0,hasNoneOption:!1,label:e.$Labels.SUMMARY_CONFIGURATION,keyString:"configId",valueString:"configName"},model:{value:e.liveConfig,callback:function(t){e.liveConfig=t},expression:"liveConfig"}}),e._v(" "),i("div",{staticClass:"slds-form-element"},[i("label",{staticClass:"slds-form-element__label"},[e._v("\n                "+e._s(e.$Labels.ASSET)+"\n            ")]),e._v(" "),i("div",{staticClass:"slds-form-element__control",staticStyle:{position:"relative"},on:{click:function(t){return e.toggleSearch(!0)}}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.assetName,expression:"assetName"}],staticClass:"slds-input",staticStyle:{background:"white",cursor:"pointer"},attrs:{type:"text",placeholder:"",disabled:""},domProps:{value:e.assetName},on:{input:function(t){t.target.composing||(e.assetName=t.target.value)}}})])]),e._v(" "),i("div",{staticClass:"ma-form-control-wrap",on:{click:function(t){return e.toggleDateModal(!0)}}},[i("label",{staticClass:"ma-input-label"},[e._v(e._s(e.$Labels.MA_Date))]),e._v(" "),i("div",{staticClass:"ma-form-control icon-right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.dateString,expression:"dateString"}],staticClass:"ma-datepicker live-input ma-input date-input",attrs:{type:"text",placeholder:"Select a date",disabled:""},domProps:{value:e.dateString},on:{input:function(t){t.target.composing||(e.dateString=t.target.value)}}}),e._v(" "),i("i",{staticClass:"ma-icon ma-icon-event icon-right"})])]),e._v(" "),i("MobileSelect",{attrs:{options:e.timeZoneList,doDetach:!0,isRequired:!0,hasNoneOption:!1,label:e.$Labels.TIMEZONE,keyString:"value",valueString:"label"},model:{value:e.timeZoneId,callback:function(t){e.timeZoneId=t},expression:"timeZoneId"}}),e._v(" "),i("div",{staticClass:"ma-form-control-wrap"},[i("label",{staticClass:"ma-input-label"},[e._v("Start Time")]),e._v(" "),i("div",{staticClass:"ma-form-control icon-right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.startTime,expression:"startTime"}],staticClass:"live-starttime time-input ma-input live-starttime",attrs:{type:"time"},domProps:{value:e.startTime},on:{input:function(t){t.target.composing||(e.startTime=t.target.value)}}}),e._v(" "),i("i",{staticClass:"ma-icon ma-icon-clock icon-right"})])]),e._v(" "),i("div",{staticClass:"ma-form-control-wrap"},[i("label",{staticClass:"ma-input-label"},[e._v("End Time")]),e._v(" "),i("div",{staticClass:"ma-form-control icon-right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.endTime,expression:"endTime"}],staticClass:"live-endtime time-input ma-input live-endtim",attrs:{type:"time"},domProps:{value:e.endTime},on:{input:function(t){t.target.composing||(e.endTime=t.target.value)}}}),e._v(" "),i("i",{staticClass:"ma-icon ma-icon-clock icon-right"})])]),e._v(" "),i("button",{staticClass:"apply-changes-button slds-m-top_small slds-button slds-button_neutral",on:{click:e.applyChanges}},[e._v("\n            Apply Changes\n        ")]),e._v(" "),i("LiveTrackingEventList",{attrs:{qid:e.qid}})],1),e._v(" "),e.showSearch?i("MobileSearch",{attrs:{searchFunction:e.assetSearch,minimumSearchLength:1,searchKey:"deviceId",searchLabel:"label"},on:{"close-search-modal":function(t){return e.toggleSearch(!1)},result:e.updateSearchValue}}):e._e(),e._v(" "),e.showDateModal?i("DateSelectionModal",{attrs:{date:e.date},on:{close:function(t){return e.toggleDateModal(!1)},update:e.setDate}}):e._e()],1)},staticRenderFns:[]}}});