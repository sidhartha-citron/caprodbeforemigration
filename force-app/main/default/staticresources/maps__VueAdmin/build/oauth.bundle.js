"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[2199],{6116:(t,s,e)=>{e.r(s),e.d(s,{default:()=>u});var r=e(2766),i=e(257);class o{static handleRemoteActionError(t){Error(`Remote action exception: ${t}`)}static getOrgAuthorization(){return new Promise(((t,s)=>{(new i.Z).setAction("maps.OAuth.getAuthorizationInfo").setErrorHandler(((t,e)=>{let r="Uknown Error";e&&e.message&&(r=e.message),s(new Error(`Remote action exception: ${r}`))})).invoke([],(e=>{e?t(e):s(new Error("Error authorizing user"))}),{buffer:!1})}))}static getAuthRedirectURL(){return new Promise(((t,s)=>{(new i.Z).setAction("maps.OAuth.getAuthRedirectURL").setErrorHandler(((t,e)=>{let r="Uknown Error";e&&e.message&&(r=e.message),s(new Error(`Remote action exception: ${r}`))})).invoke([],(e=>{e?t(e):s(new Error("Error authorizing user"))}),{buffer:!1})}))}static deleteOrgAuthorization(){return new Promise(((t,s)=>{(new i.Z).setAction("maps.OAuth.revokeOrgAuthorization").setErrorHandler(((t,e)=>{let r="Uknown Error";e&&e.message&&(r=e.message),s(new Error(`Remote action exception: ${r}`))})).invoke([],(e=>{e?t(e):s(new Error("Error removing user authorization"))}),{buffer:!1})}))}}const{MAToastMessages:a}=window,n={components:{Spinner:r.$j,SetupAssistantItem:r.P6},data:()=>({authExists:!1,authorizedTerritoryUser:"",isLoading:!1,hasError:!1}),computed:{isAuthorized:{get(){return this.authExists},set(t){this.authExists=t,this.authExists||(this.authorizedTerritoryUser="")}}},created(){this.loadAuthorizationInformation()},methods:{authorize(){this.isLoading=!0,o.getAuthRedirectURL().then((t=>{const s=window.htmlDecode(t.authUrl);window.open(s),setTimeout((()=>{this.loadAuthorizationInformation()}),5e3)}))},deauthorize(){this.isLoading=!0,o.deleteOrgAuthorization().then((t=>{t.success?(a.showSuccess({message:"Deauthorization Successful."}),this.loadAuthorizationInformation()):a.showError({message:this.$Labels.MA_Error,subMessage:"Unauthorization request failed.",timeOut:0,extendedTimeOut:0,closeButton:!0})})).finally((()=>{this.isLoading=!1}))},loadAuthorizationInformation(){this.isLoading=!0,o.getOrgAuthorization().then((t=>{this.isAuthorized=t.authExists,this.isAuthorized&&(this.authorizedTerritoryUser=t.data.user.username),this.isLoading=!1})).catch((t=>{console.warn(t),this.isLoading=!1,this.hasError=!0,window.MAToastMessages.showError({message:t.message,closeButton:!0,timeOut:0})}))}}},u=(0,e(1900).Z)(n,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[t.isLoading?e("Spinner"):t._e(),t._v(" "),e("div",{staticClass:"slds-section slds-is-open"},[e("div",{staticClass:"slds-section__content"},[e("ol",{staticClass:"slds-setup-assistant"},[e("SetupAssistantItem",{attrs:{stepProgress:!1,heading:t.$Labels.OAuth_SF_Maps_Authorization,description:t.$Labels.OAuth_SF_Maps_Authorization_Description}},[e("div",{attrs:{slot:"content"},slot:"content"},[t.isAuthorized?e("div",{staticClass:"slds-grid slds-grid_vertical-align-end slds-grid_vertical",attrs:{id:"currentAuthInfo"}},[e("div",[e("button",{staticClass:"slds-button slds-button_text-destructive",attrs:{id:"deauthorizeTerritoryUser"},on:{click:t.deauthorize}},[t._v("\n                                    "+t._s(t.$Labels.OAuth_Deauthorize_Button)+"\n                                ")])]),t._v(" "),e("div",{staticClass:"slds-text-align_right slds-text-color_weak slds-p-top_medium"},[e("div",[t._v("\n                                    "+t._s(t.$Labels.OAuth_Current_Authorized_User)+"\n                                ")]),t._v(" "),e("div",{staticClass:"slds-m-bottom_small",attrs:{id:"currentAuthName"}},[t._v("\n                                    "+t._s(t.authorizedTerritoryUser)+"\n                                ")])])]):e("div",[e("div",{attrs:{id:"authorizeTerritory"}},[e("button",{staticClass:"slds-button slds-button_neutral",attrs:{id:"authorizeTerritoryIO",disabled:t.hasError},on:{click:t.authorize}},[t._v("\n                                    "+t._s(t.$Labels.OAuth_Authorize_Button)+"\n                                ")])])])])])],1)])])],1)}),[],!1,null,null,null).exports}}]);