(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[9091],{5315:(t,e,s)=>{t.exports=s.p+"images/a02b9e20627d0dd9fe017c3cde8967d6.png"},1529:(t,e,s)=>{t.exports=s.p+"images/88d1127b4c58ab379c488c164b84da8e.png"},59:(t,e,s)=>{t.exports=s.p+"images/537b7f6336828ad9944ec4fd0f2f42d8.png"},4650:(t,e,s)=>{t.exports=s.p+"images/b916732291aeb7af7c40739c0a195596.png"},9601:(t,e,s)=>{t.exports=s.p+"images/adeea203b49c28a1cfbe8829ba9edf8f.svg"},3234:(t,e,s)=>{t.exports=s.p+"images/386433b5175f3ff0e92df9c210ee30b9.svg"},539:(t,e,s)=>{t.exports=s.p+"images/fe923447706e7b1dec4427d9d5631360.svg"},4853:(t,e,s)=>{t.exports=s.p+"images/9cacf20688e535e397f62c621c65eeea.svg"},3180:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>I});var a=s(5908),o=s.n(a),r=s(2766);const i={state:{toggle:{showRegistrationModal:!1,showCredentialsModal:!1,showVisualPicker:!0,showVendorDashboard:!1,hasLiveKey:!0,credentialsFound:!0,showErrorNotification:!1,refresh:!1,dashboardLoading:!1,modalLoading:!1},registrationModal:{action:"register",emailRecipient:null,vins:[],fanId:null},credentialsModal:{username:null,password:null,database:null},visualPickerOptions:{selectedOption:null,options:[{id:"ford",caption:"Ford",selected:!1},{id:"gm",caption:"GM's OnStar",selected:!1},{id:"geotab",caption:"GeoTab",selected:!1},{id:"liveapp",caption:"Salesforce Maps Mobile",selected:!1}]},devicesTable:{tableRows:[],unprocessedRows:[],processFromFilter:[],tableColumns:{gm:["VIN","Status","Message","Last Report Date & Time","Record Created"],ford:["VIN","Status","Message","Last Report Date & Time","Record Created"],geotab:["Device ID","Last Report Date & Time","Record Created"],liveapp:["Device ID","Name","Last Report Date & Time","Record Created"]},sortTableBy:null,sortDirection:null,selectAllRows:!1,selectedRowCount:0,tableLoading:!1,processingComplete:!1},tableFilters:{filtersAvailable:{registered:{label:"Registered",value:"registered"},failure:{label:"Failure",value:"failure"},inProgress:{label:"In Progress",value:"inProgress"},deregistered:{label:"Deregistered",value:"deregistered"},canceled:{label:"Canceled",value:"canceled"}},filtersSelected:[],filterTerm:null,showFilter:!1}},actions:{selectAll({commit:t,getters:e},s){t("toggleSelectAll",{value:s,getters:e})}},mutations:{toggleSelectAll(t,{value:e,getters:s}){Object.values(s.filteredRows).forEach((t=>{t.checked=e}))}},getters:{vendor:t=>t.visualPickerOptions.selectedOption,unprocessedGroup:t=>t.devicesTable.unprocessedRows.length>0&&t.tableFilters.filterTerm&&t.tableFilters.filterTerm.length>=2?t.devicesTable.unprocessedRows.filter((e=>!e.processed&&e.deviceId.toLowerCase().includes(t.tableFilters.filterTerm.toLowerCase()))):[],filteredRows(t){let e=[];const s=()=>{t.tableFilters.filterTerm&&t.tableFilters.filterTerm.length>=2&&(e=e.filter((e=>e.deviceId.toLowerCase().includes(t.tableFilters.filterTerm.toLowerCase()))))};return t.tableFilters.filtersSelected.length>0?(t.tableFilters.filtersSelected.forEach((s=>{"In Progress"===s&&(s="InProgress");const a=t.devicesTable.tableRows.filter((t=>t.activationStatus.toLowerCase()===s.toLowerCase()));e=[...e,...a]})),s()):(e=t.devicesTable.tableRows,s()),e.sort(((e,s)=>{let a=t.devicesTable.sortTableBy;switch(a){case"deviceid":case"vin":a="deviceId";break;case"lastreportdate&time":a="lastReport";break;case"status":a="activationStatus";break;case"recordcreated":a="recordExists"}return e=e[a],s=s[a],"ascending"===t.devicesTable.sortDirection?e<s?-1:e>s?1:0:"descending"===t.devicesTable.sortDirection?e>s?-1:e<s?1:0:null})),e.reduce(((t,e)=>(t[e.deviceId]=e,t)),{})}}},l={name:"App",components:{},data:()=>({title:"Select a Vendor"}),methods:{setOption(t,e){this.$store.state.visualPickerOptions.options.forEach((t=>{t.selected=!1})),this.$store.state.visualPickerOptions.options[e].selected=!0,this.$store.state.visualPickerOptions.selectedOption=t.id}}};var n=s(1900);const d=(0,n.Z)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"slds-is-relative slds-p-vertical_medium"},[a("fieldset",{staticClass:"slds-form-element"},[a("div",{staticClass:"slds-form-element__control"},t._l(t.$store.state.visualPickerOptions.options,(function(e,o){return a("div",{key:o,staticClass:"slds-visual-picker slds-visual-picker_medium"},[a("input",{attrs:{id:"visual-picker-"+o,type:"radio",value:"null",name:"options"}}),t._v(" "),a("label",{attrs:{for:"visual-picker-"+o},on:{click:function(s){return t.setOption(e,o)}}},[a("span",{staticClass:"slds-visual-picker__figure slds-visual-picker__text slds-align_absolute-center"},[a("span",[t._t("content_"+(o+1))],2)]),t._v(" "),a("span",{staticClass:"slds-visual-picker__body"},[a("span",[t._v(t._s(e.caption))])]),t._v(" "),a("Icon",{staticClass:"slds-visual-picker__text-check",attrs:{src:s(9601),iconClass:["slds-icon","slds-icon-text-check","slds-icon_x-small"]}})],1)])})),0)])])}),[],!1,null,null,null).exports;var c=s(3088);const{MAToastMessages:g}=window,u=t=>{throw g.showError({position:"toast-top-right",message:"Remoting Error",subMessage:t,timeOut:6e3}),console.error(t),t},v=async(t,e)=>{try{"liveapp"===e&&(e="mapanything");const{success:s,message:a,records:o}=await(0,c.wX)("maps.LiveControllerHelper.createDeviceRecords",[t,e]);if(s)return o;throw g.showError({position:"toast-top-right",message:"Error",subMessage:a,timeOut:8e3}),new Error(`Issue invoking remote action maps.LiveControllerHelper.createDeviceRecords: ${a}`)}catch(t){return u(t)}},h={methods:{returnCapitalized:t=>(t&&"gm"===t.toLowerCase()&&(t="GM"),t&&"liveapp"===t.toLowerCase()&&(t="Salesforce Maps Mobile"),t?t.charAt(0).toUpperCase()+t.slice(1):null),showRegistrationModal(t){this.$store.state.registrationModal.vins=Object.values(this.$store.getters.filteredRows).filter((t=>t.checked)).map((t=>t.vin)).join("\n"),this.$store.state.registrationModal.action=t,this.$store.state.toggle.showRegistrationModal=!0},showCredentialsModal(){this.$store.state.toggle.showCredentialsModal=!0},navigateToURL(t){window.ma_navigateToUrl(`/apex/maps__Settings?tabId=${t}`,"","blank")}}},p=(0,n.Z)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("article",{staticClass:"slds-col slds-p-top_xx-large"},[a("div",{staticClass:"slds-illustration slds-illustration_small slds-p-top_medium"},[a("svg",{staticClass:"slds-illustration__svg",attrs:{viewBox:"0 0 454 272","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[a("g",{attrs:{fill:"none","fill-rule":"evenodd",transform:"translate(-65 -74)"}},[a("g",{attrs:{transform:"translate(77 180)"}},[a("polyline",{staticClass:"slds-illustration__stroke-secondary",attrs:{"vector-effect":"non-scaling-stroke","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",points:"21 74 111.5 0 177.5 54"}}),t._v(" "),a("polyline",{staticClass:"slds-illustration__stroke-secondary",attrs:{"vector-effect":"non-scaling-stroke","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",points:"160 37 181.5 19 249 74"}}),t._v(" "),a("path",{staticClass:"slds-illustration__fill-secondary",attrs:{"vector-effect":"non-scaling-stroke",d:"M5.83623454,54.8238008 C6.47896445,52.7119739 7.52041887,52.7099477 8.16376546,54.8238008 L14,74 L0,74 L5.83623454,54.8238008 Z"}}),t._v(" "),a("path",{staticClass:"slds-illustration__fill-secondary",attrs:{"vector-effect":"non-scaling-stroke",d:"M14.9699006 61.8628727C15.5388088 59.729467 16.4627585 59.7353443 17.0300994 61.8628727L20 73 12 73 14.9699006 61.8628727zM239.734375 56.5589921C240.43336 54.4620359 241.506942 54.4857215 242.128332 56.5984458L246 69.7621171 237 64.7621171 239.734375 56.5589921z"}}),t._v(" "),a("path",{staticClass:"slds-illustration__fill-secondary",attrs:{"vector-effect":"non-scaling-stroke",d:"M247.921591,53.8514618 C248.51718,51.7243582 249.484912,51.7318303 250.077772,53.8491859 L254.357732,69.1347569 L242,75 L247.921591,53.8514618 Z",transform:"matrix(-1 0 0 1 496.358 0)"}})]),t._v(" "),a("g",{attrs:{transform:"matrix(-1 0 0 1 496 216)"}},[a("path",{staticClass:"slds-illustration__fill-secondary",attrs:{"vector-effect":"non-scaling-stroke",d:"M5.9215907,18.8514618 C6.51717971,16.7243582 7.48113835,16.7183512 8.0784093,18.8514618 L14,40 L0,40 L5.9215907,18.8514618 Z",transform:"matrix(-1 0 0 1 14 0)"}}),t._v(" "),a("path",{staticClass:"slds-illustration__fill-secondary",attrs:{"vector-effect":"non-scaling-stroke",d:"M123.136984,25.2363093 C123.613615,23.448945 124.38595,23.4473111 124.863437,25.237887 L126.693756,32.1015868 L120,37 L123.136984,25.2363093 Z",transform:"matrix(-1 0 0 1 246.694 0)"}}),t._v(" "),a("polyline",{staticClass:"slds-illustration__stroke-secondary",attrs:{"vector-effect":"non-scaling-stroke","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",points:"13 37 59.5 0 92.5 27"}}),t._v(" "),a("polyline",{staticClass:"slds-illustration__stroke-secondary",attrs:{"vector-effect":"non-scaling-stroke","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",points:"83 17 92.5 9 127 38"}})]),t._v(" "),a("g",{staticClass:"slds-illustration__stroke-primary",attrs:{"stroke-linecap":"round","stroke-width":"3",transform:"translate(67 253)"}},[a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M0 1.5L450 1.5M284 2L419 61M282 2L65 91M443 1.5L449 1.5"}})]),t._v(" "),a("g",{attrs:{transform:"translate(73 163)"}},[a("polygon",{attrs:{"vector-effect":"non-scaling-stroke",fill:"#FFF",points:"20.906 .73 24.63 2.34 27.093 9.155 11.046 19.877 .131 19.877",transform:"translate(80 22)"}}),t._v(" "),a("g",{staticClass:"slds-illustration__stroke-secondary",attrs:{"stroke-linecap":"round","stroke-width":"3"}},[a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"}}),t._v(" "),a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M83 20.5C84.0558268 16.8461914 86.2227376 14.4572754 89.5007324 13.333252 94.4177246 11.6472168 99.0800781 13.8925781 100.942383 16.1518555 102.804687 18.4111328 103.39502 20.2260742 103.746582 22.1201172 103.980957 23.3828125 104.06543 24.8427734 104 26.5 108.141764 26.3313802 110.918945 27.1647135 112.331543 29 114.040039 31.1936035 114.215332 33.817627 113.593018 35.75 112.970703 37.682373 110.894531 40.5 107 40.5L28 40.5M18 27.5L83.0004985 27.5M0 27.5L8 27.5"}})])]),t._v(" "),a("g",{staticClass:"slds-illustration__stroke-secondary",attrs:{"stroke-linecap":"round","stroke-width":"3",transform:"translate(292 139)"}},[a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"}}),t._v(" "),a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M83 20.5C84.0558268 16.8461914 86.2227376 14.4572754 89.5007324 13.333252 94.4177246 11.6472168 99.0800781 13.8925781 100.942383 16.1518555 102.804687 18.4111328 103.39502 20.2260742 103.746582 22.1201172 103.980957 23.3828125 104.06543 24.8427734 104 26.5 108.141764 26.3313802 110.918945 27.1647135 112.331543 29 114.040039 31.1936035 114.215332 33.817627 113.593018 35.75 112.970703 37.682373 110.894531 40.5 107 40.5L28 40.5M18 27.5L83.0004985 27.5M0 27.5L8 27.5"}})]),t._v(" "),a("g",{attrs:{transform:"translate(204.5 228.5)"}},[a("path",{staticClass:"slds-illustration__fill-secondary",attrs:{"vector-effect":"non-scaling-stroke",d:"M18.9209988,1.95433401 L33.259296,51.443436 C33.5666778,52.5043744 32.9557995,53.613617 31.8948612,53.9209988 C31.7139843,53.9734036 31.5266126,54 31.3382972,54 L2.6617028,54 C1.5571333,54 0.661702805,53.1045695 0.661702805,52 C0.661702805,51.8116846 0.688299176,51.6243129 0.74070397,51.443436 L15.0790012,1.95433401 C15.386383,0.893395645 16.4956256,0.282517358 17.556564,0.589899164 C18.2152102,0.780726338 18.7301717,1.29568777 18.9209988,1.95433401 Z"}}),t._v(" "),a("g",{staticClass:"slds-illustration__stroke-primary",attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3"}},[a("polygon",{attrs:{points:"17 .324 34 54 0 54"}}),t._v(" "),a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M17,6.32394366 C17,42.1378022 17,60.4711356 17,61.3239437 C17,60.4711356 17,42.1378022 17,6.32394366 Z"}}),t._v(" "),a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M17,29.3239437 C22.3333333,35.7851611 25,39.1184944 25,39.3239437 C25,39.1184944 22.3333333,35.7851611 17,29.3239437 Z",transform:"matrix(-1 0 0 1 42 0)"}})])]),t._v(" "),a("g",{attrs:{transform:"translate(439.5 227.5)"}},[a("path",{staticClass:"slds-illustration__fill-secondary",attrs:{"vector-effect":"non-scaling-stroke",d:"M18.9209988,1.95433401 L33.259296,51.443436 C33.5666778,52.5043744 32.9557995,53.613617 31.8948612,53.9209988 C31.7139843,53.9734036 31.5266126,54 31.3382972,54 L2.6617028,54 C1.5571333,54 0.661702805,53.1045695 0.661702805,52 C0.661702805,51.8116846 0.688299176,51.6243129 0.74070397,51.443436 L15.0790012,1.95433401 C15.386383,0.893395645 16.4956256,0.282517358 17.556564,0.589899164 C18.2152102,0.780726338 18.7301717,1.29568777 18.9209988,1.95433401 Z"}}),t._v(" "),a("g",{staticClass:"slds-illustration__stroke-primary",attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3"}},[a("polygon",{attrs:{"vector-effect":"non-scaling-stroke",points:"17 -4.676 34 54 0 54"}}),t._v(" "),a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M17,1.32394366 C17,40.3936076 17,60.3936076 17,61.3239437 C17,60.3936076 17,40.3936076 17,1.32394366 Z"}}),t._v(" "),a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M17,29.3239437 C22.3333333,35.7851611 25,39.1184944 25,39.3239437 C25,39.1184944 22.3333333,35.7851611 17,29.3239437 Z",transform:"matrix(-1 0 0 1 42 0)"}})])]),t._v(" "),a("g",{attrs:{transform:"translate(141.852 213.5)"}},[a("path",{staticClass:"slds-illustration__fill-secondary",attrs:{"vector-effect":"non-scaling-stroke",d:"M25.6478873,0 L50.8997802,86.4391718 C51.2095171,87.4994249 50.6011034,88.6100213 49.5408502,88.9197582 C49.3586621,88.9729817 49.1698252,89 48.980022,89 L2.31575269,89 C1.21118319,89 0.315752686,88.1045695 0.315752686,87 C0.315752686,86.8101968 0.342770948,86.6213599 0.395994453,86.4391718 L25.6478873,0 Z",transform:"translate(1)"}}),t._v(" "),a("g",{staticClass:"slds-illustration__stroke-primary",attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",transform:"translate(0 2)"}},[a("polygon",{attrs:{"vector-effect":"non-scaling-stroke",points:"26.648 0 52.648 87 .648 87"}}),t._v(" "),a("path",{attrs:{"vector-effect":"non-scaling-stroke",d:"M26.6478873 6C26.6478873 64.4972948 26.6478873 94.4972948 26.6478873 96 26.6478873 94.4972948 26.6478873 64.4972948 26.6478873 6zM15.6478873 42C22.9812207 49.078692 26.6478873 52.7453587 26.6478873 53 26.6478873 52.7453587 22.9812207 49.078692 15.6478873 42zM27.6478873 68C36.9812207 57.078692 41.6478873 51.7453587 41.6478873 52 41.6478873 51.7453587 36.9812207 57.078692 27.6478873 68z"}})])]),t._v(" "),a("g",{attrs:{transform:"translate(168 57)"}},[a("circle",{staticClass:"slds-illustration__fill-secondary",attrs:{"vector-effect":"non-scaling-stroke",cx:"64",cy:"64",r:"23"}}),t._v(" "),a("path",{staticClass:"slds-illustration__stroke-secondary",attrs:{"vector-effect":"non-scaling-stroke","stroke-dasharray":"135 1 1 18","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M64,109 C88.8528137,109 109,88.8528137 109,64 C109,39.1471863 88.8528137,19 64,19 C39.1471863,19 19,39.1471863 19,64 C19,88.8528137 39.1471863,109 64,109 Z",transform:"rotate(-130 64 64)"}}),t._v(" "),a("path",{staticClass:"slds-illustration__stroke-secondary",attrs:{"vector-effect":"non-scaling-stroke","stroke-dasharray":"107 10","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M64,97 C82.2253967,97 97,82.2253967 97,64 C97,45.7746033 82.2253967,31 64,31 C45.7746033,31 31,45.7746033 31,64 C31,82.2253967 45.7746033,97 64,97 Z",transform:"rotate(150 64 64)"}}),t._v(" "),a("g",{staticClass:"slds-illustration__stroke-primary",attrs:{"stroke-width":"3",transform:"translate(41 41)"}},[a("circle",{attrs:{"vector-effect":"non-scaling-stroke",cx:"23",cy:"23",r:"23"}})])])])]),t._v(" "),t.$store.state.toggle.hasLiveKey?a("div",{staticClass:"slds-text-longform"},[a("h3",{staticClass:"slds-text-heading_large"},[t._v("\n                    "+t._s(["ford","gm"].includes(t.$store.state.visualPickerOptions.selectedOption)?"Register Vehicles":"geotab"===t.$store.state.visualPickerOptions.selectedOption?"Authenticate with Geotab Credentials":"Enable Live Mobile Tracking")+"\n                ")]),t._v(" "),a("p",{staticClass:"slds-text-body_regular"},[t._v("\n                    "+t._s(["ford","gm"].includes(t.$store.state.visualPickerOptions.selectedOption)?'Click "Register Vehicles" to add your fleet of '+t.returnCapitalized(t.$store.state.visualPickerOptions.selectedOption)+" vehicles.":"geotab"===t.$store.state.visualPickerOptions.selectedOption?"Supply your Geotab credentials to access your organization's list of devices.":"Create a Permission Group with the “Enable Live Mobile Tracking” permission, then assign Users and Profiles that you want to enable tracking for in the Salesforce Maps Mobile app.")+"\n                ")]),t._v(" "),a("button",{staticClass:"slds-button slds-button_brand",attrs:{"aria-live":"assertive"},on:{click:function(e){["ford","gm"].includes(t.$store.getters.vendor)?t.showRegistrationModal("register"):"geotab"===t.$store.getters.vendor?t.showCredentialsModal():t.navigateToURL("PermissionGroups")}}},[["ford","gm"].includes(t.$store.state.visualPickerOptions.selectedOption)?a("Icon",{attrs:{src:s(3234),iconClass:["slds-button__icon","slds-button__icon_small","slds-button__icon_left"]}}):t._e(),t._v("\n                    "+t._s(["ford","gm"].includes(t.$store.state.visualPickerOptions.selectedOption)?"Register Vehicles":"geotab"===t.$store.state.visualPickerOptions.selectedOption?"Enter Credentials":"Enable Permissions")+"\n                ")],1)]):a("div",[t._m(0),t._v(" "),a("p",{staticClass:"slds-p-top--small"},[a("a",{on:{click:function(e){return t.navigateToURL("LiveKeySettings")}}},[t._v("\n                        Click here to set it in "),a("strong",[t._v("Maps Live Tracking -> Settings")])])])])])])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("You have not provided a "),s("strong",[t._v("Live API Key")])])}],!1,null,null,null).exports,_={components:{Checkbox:r.XZ,Button:r.zx},data:()=>({numEmptyTableRows:15}),computed:{showEmptyTable(){return!this.$store.state.toggle.dashboardLoading&&"geotab"===this.$store.getters.vendor&&0===this.$store.state.devicesTable.tableRows.length}},mounted(){window.addEventListener("resize",this.getTableHeight),this.getTableHeight()},beforeDestroy(){window.removeEventListener("resize",this.getTableHeight)},methods:{handleScroll(t){document.querySelector("#table-header").clientHeight-t.target.scrollTop===t.target.clientHeight&&this.loadMoreDevices()},loadMoreDevices(){this.$store.state.devicesTable.processingComplete||(this.$store.state.devicesTable.tableLoading=!0)},returnCapitalized:t=>(t&&"gm"===t.toLowerCase()&&(t="GM"),t&&"liveapp"===t.toLowerCase()&&(t="LiveApp"),t?t.charAt(0).toUpperCase()+t.slice(1):null),sortClick(t){t=t.replace(/\s/g,""),this.$store.state.devicesTable.sortTableBy!==t.toLowerCase()&&(this.$store.state.devicesTable.sortTableBy=t.toLowerCase(),this.$store.state.devicesTable.sortDirection="ascending"),"ascending"===this.$store.state.devicesTable.sortDirection?this.$store.state.devicesTable.sortDirection="descending":"descending"===this.$store.state.devicesTable.sortDirection&&(this.$store.state.devicesTable.sortDirection="ascending")},async createRecord(t){try{this.$store.state.toggle.dashboardLoading=!0,(await v(t,this.$store.getters.vendor)).forEach((t=>{const e=this.$store.state.devicesTable.tableRows.find((e=>e.deviceId===t.maps__DeviceId__c));e.recordExists=!0,e.recordId=t.Id}))}catch(t){u(t)}finally{this.$store.state.toggle.dashboardLoading=!1,this.$store.state.toggle.refresh=!1}},formatTime(t){let e=null;return t&&(e=this.$moment(t).format("MM/DD/YYYY h:mm A")),e},canCreateRecord(t){return["ford","gm"].includes(this.$store.getters.vendor)?t.createRecord&&"registered"===t.activationStatus:!!t.createRecord},navigateToRecord(t){window.ma_navigateToUrl(`/${t}`,"","blank")},getTableHeight(){const t=this.$refs.tableContainer.getBoundingClientRect(),e=window.innerHeight-t.y-16;this.$refs.tableContainer.style.height=`${e}px`}}},m=(0,n.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"tableContainer",staticClass:"slds-table_header-fixed_scroller",class:{"slds-scrollable":Object.values(t.$store.getters.filteredRows).length},on:{"&scroll":function(e){return t.handleScroll(e)}}},[s("table",{staticClass:"slds-table slds-table_fixed-layout slds-table_header-fixed slds-table_resizable-cols slds-table_bordered",class:{"slds-no-row-hover":t.showEmptyTable},attrs:{id:"table-header","aria-multiselectable":"true",role:"grid"}},[s("thead",[s("tr",{staticClass:"slds-line-height_reset"},[s("th",{staticClass:"slds-text-align_right",staticStyle:{height:"0px","line-height":"0",width:"3.25rem"},attrs:{scope:"col"}},[s("div",{staticClass:"slds-cell-fixed",staticStyle:{display:"flex","flex-flow":"row nowrap",left:"0px",width:"52px"}},[s("div",{staticClass:"slds-th__action slds-th__action_form",staticStyle:{"line-height":"1",width:"100%"}},[s("Checkbox",{attrs:{id:"select-all",disabled:t.showEmptyTable,hideLabel:""},on:{changed:function(e){return t.$store.dispatch("selectAll",t.$store.state.devicesTable.selectAllRows)}},model:{value:t.$store.state.devicesTable.selectAllRows,callback:function(e){t.$set(t.$store.state.devicesTable,"selectAllRows",e)},expression:"$store.state.devicesTable.selectAllRows"}})],1)])]),t._v(" "),t._l(t.$store.state.devicesTable.tableColumns[t.$store.getters.vendor],(function(e,a){return s("th",{key:a,staticClass:"slds-is-sortable",class:{"slds-is-sorted":t.$store.state.devicesTable.sortTableBy==e.toLowerCase(),"slds-is-sorted_asc":"ascending"==t.$store.state.devicesTable.sortDirection},staticStyle:{height:"0px","line-height":"0"},attrs:{"aria-label":e,"aria-sort":t.$store.state.devicesTable.sortDirection,scope:"col"},on:{click:function(s){return t.sortClick(e)}}},[["ford","gm"].includes(t.$store.getters.vendor)?s("a",{staticClass:"slds-th__action slds-text-link_reset",staticStyle:{display:"flex",height:"0px",overflow:"hidden","padding-bottom":"0px","padding-top":"0px",visibility:"hidden",border:"1px solid blue"},attrs:{href:"javascript:void(0)",role:"button",tabindex:"0"}},[s("Icon",{attrs:{category:"utility",name:"arrowdown",iconClass:["slds-is-sortable__icon","slds-icon","slds-icon_x-small","slds-icon-text-default"],"aria-hidden":"true"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text",attrs:{"aria-live":"assertive","aria-atomic":"true"}},[t._v("\n                            "+t._s(t.$Labels.Sort_By)+"\n                        ")])],1):t._e(),t._v(" "),s("div",{staticClass:"slds-cell-fixed",staticStyle:{display:"flex","flex-flow":"row nowrap"}},[s("a",{staticClass:"slds-th__action slds-text-link_reset",staticStyle:{"align-items":"center",display:"flex",flex:"1 1 auto","line-height":"1.25",width:"100%"},attrs:{href:"javascript:void(0)",role:"button",tabindex:"0"}},[s("span",{staticClass:"slds-assistive-text"},[t._v("sort this column ")]),t._v(" "),s("span",{staticClass:"slds-truncate",attrs:{title:e}},[t._v("\n                                "+t._s("Device ID"===e&&["ford","gm"].includes(t.$store.getters.vendor)?"VIN":e)+"\n                            ")]),t._v(" "),s("Icon",{attrs:{category:"utility",name:"arrowdown",iconClass:["slds-is-sortable__icon","slds-icon","slds-icon_x-small","slds-icon-text-default"],"aria-hidden":"true"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text",attrs:{"aria-live":"assertive","aria-atomic":"true"}},[t._v("\n                                desc\n                            ")])],1)])])}))],2)]),t._v(" "),t.showEmptyTable?s("tbody",t._l(t.numEmptyTableRows,(function(e,a){return s("tr",{key:a},[s("td",{staticStyle:{width:"3.25rem"},attrs:{role:"gridcell"}}),t._v(" "),t._m(0,!0),t._v(" "),t._m(1,!0),t._v(" "),t._m(2,!0)])})),0):t._e(),t._v(" "),s("tbody",t._l(Object.values(t.$store.getters.filteredRows),(function(e,a){return s("tr",{key:a,staticClass:"slds-hint-parent"},[s("td",{staticStyle:{width:"3.25rem"},attrs:{role:"gridcell"}},[s("Checkbox",{attrs:{id:"select-row-"+a,hideLabel:""},model:{value:e.checked,callback:function(s){t.$set(e,"checked",s)},expression:"row.checked"}})],1),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.deviceId}},[t._v("\n                        "+t._s(e.deviceId)+"\n                    ")])]),t._v(" "),["ford","gm"].includes(t.$store.getters.vendor)?s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",class:"failure"===e.activationStatus?"is-error":null},[t._v("\n                        "+t._s(t.returnCapitalized("inProgress"===e.activationStatus?"In Progress":e.activationStatus))+"\n                    ")])]):t._e(),t._v(" "),["ford","gm"].includes(t.$store.getters.vendor)?s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[t._v("\n                        "+t._s(e.message||"")+"\n                    ")])]):t._e(),t._v(" "),"liveapp"===t.$store.getters.vendor?s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",class:e.name?null:"not-available"},[t._v("\n                        "+t._s(e.name||"User not in this org")+"\n                    ")])]):t._e(),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",class:e.lastReport?null:"not-available"},[t._v("\n                        "+t._s(t.formatTime(e.lastReport)||"Has not reported")+"\n                    ")])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[s("Button",{directives:[{name:"show",rawName:"v-show",value:!e.recordExists,expression:"!row.recordExists"}],attrs:{label:"Create Record",title:"Create Record",iconCategory:"utility",iconName:"insert_template",iconPosition:"right",variant:"base",disabled:!t.canCreateRecord(e)},on:{click:function(s){return t.createRecord([e.deviceId])}}}),t._v(" "),s("Button",{directives:[{name:"show",rawName:"v-show",value:e.recordExists,expression:"row.recordExists"}],attrs:{label:"View Record",title:"View Record",iconCategory:"utility",iconName:"new_window",iconPosition:"right",variant:"base"},on:{click:function(s){return t.navigateToRecord(e.recordId)}}})],1)])])})),0)]),t._v(" "),!Object.values(t.$store.getters.filteredRows).length>0?s("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-grid_align-center empty-content"},[t.$store.state.toggle.dashboardLoading?t._e():s("div",{staticClass:"empty-content-inner"},[s("p",[t._v("No items to display.")])])]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("td",{staticClass:"empty-cell"},[e("div")])},function(){var t=this.$createElement,e=this._self._c||t;return e("td",{staticClass:"empty-cell"},[e("div")])},function(){var t=this.$createElement,e=this._self._c||t;return e("td",{staticClass:"empty-cell"},[e("div")])}],!1,null,"5c989016",null).exports,{MAToastMessages:f}=window,b={components:{Spinner:r.$j,Tooltip:r.u,EmptyState:p,DevicesTable:m,Button:r.zx,ButtonIcon:r.Ei},computed:{selectedRows(){return Object.values(this.$store.getters.filteredRows).filter((t=>t.checked))},qualifiedForRecordCreation(){return this.selectedRows.filter((t=>t.createRecord&&!t.recordId))}},watch:{"$store.state.devicesTable.tableRows":{handler(){this.$store.state.devicesTable.selectedRowCount=Object.values(this.$store.getters.filteredRows).filter((t=>!0===t.checked)).length},deep:!0},"$store.state.tableFilters.filtersSelected":{handler(){this.$store.state.devicesTable.selectedRowCount=Object.values(this.$store.getters.filteredRows).filter((t=>!0===t.checked)).length},deep:!0},"$store.state.toggle.showRegistrationModal":{async handler(t){!t&&this.$store.state.toggle.refresh&&await this.getDevicesData()},deep:!0},"$store.state.toggle.showCredentialsModal":{async handler(t){!t&&this.$store.state.toggle.refresh&&await this.getDevicesData()},deep:!0},"$store.state.devicesTable.tableLoading":{async handler(t){if(t){const t=this.getNextBatch();if(t&&t.length>0){const e=await this.getLatestData(t);this.$store.state.devicesTable.tableRows=this.$store.state.devicesTable.tableRows.concat(e)}this.$store.state.devicesTable.tableLoading=!1}},deep:!0},"$store.getters.unprocessedGroup":{async handler(t){if(t.length>0){this.$store.state.toggle.dashboardLoading=!0;let e=[];if((t=t.filter((t=>!t.processed))).length>50){const s=this.makeArrayChunks(t,50);for(let t=0;t<s.length;t++){const a=await this.getLatestData(s[t]);e.concat(a)}}else e=await this.getLatestData(t);this.$store.state.devicesTable.tableRows=this.$store.state.devicesTable.tableRows.concat(e),this.$store.state.devicesTable.processFromFilter=[],this.$store.state.toggle.dashboardLoading=!1}},deep:!0}},async created(){this.resetState(),await this.getDevicesData()},methods:{returnCapitalized:t=>(t&&"gm"===t.toLowerCase()&&(t="GM"),t&&"liveapp"===t.toLowerCase()&&(t="Salesforce Maps Mobile"),t?t.charAt(0).toUpperCase()+t.slice(1):null),showRegistrationModal(t){this.$store.state.registrationModal.vins=this.selectedRows.map((t=>t.deviceId)).join("\n"),this.$store.state.registrationModal.action=t,this.$store.state.toggle.showRegistrationModal=!0},showCredentialsModal(){this.$store.state.toggle.showCredentialsModal=!0},async getDevicesData(){try{this.$store.state.toggle.dashboardLoading=!0,this.$store.state.devicesTable.processingComplete=!1,this.$store.state.toggle.showErrorNotification=!1;const t=await this.getDevicesList();let e=[];if(t.length>0){t.forEach((t=>{t.checked=!1,t.lastReport=null,t.processed=!1,t.recordExists=!!t.recordExists&&t.recordExists,t.recordId=t.recordId?t.recordId:null,t.error&&(t.message=t.error)}));const s=t.slice(0,50);e=await this.getLatestData(s)}this.$store.state.devicesTable.unprocessedRows=t,this.$store.state.devicesTable.tableRows=e}catch(t){u(t)}finally{this.$store.state.toggle.dashboardLoading=!1,this.$store.state.toggle.refresh=!1}},async getDevicesList(){this.$store.state.devicesTable.selectAllRows=!1,this.$store.dispatch("selectAll",!1);try{const{devices:t,success:e,message:s}=await(0,c.wX)("maps.LiveRemoteFunctions.GetDevicesList",[{vendor:this.$store.getters.vendor}]);return e?(this.$store.state.tableFilters.filtersSelected=[],t.forEach((t=>{"success"===t.activationStatus&&(t.activationStatus="registered"),"unsubscribed"===t.activationStatus&&(t.activationStatus="deregistered"),"failed"===t.activationStatus&&(t.activationStatus="failure"),["processing","submitted"].includes(t.activationStatus)&&(t.activationStatus="inProgress")})),"geotab"===this.$store.getters.vendor&&(this.$store.state.toggle.credentialsFound=!0),t):(s.includes("Incorrect login credentials")?(this.$store.state.toggle.showErrorNotification=!0,this.$store.state.toggle.credentialsFound=!1):(f.showError({position:"toast-top-right",message:"Error",subMessage:s,timeOut:8e3}),"You have not provided a Live API Key."===s&&(this.$store.state.toggle.hasLiveKey=!1),"No credentials found for this Live key"===s&&(this.$store.state.toggle.credentialsFound=!1)),[])}catch(t){return u(t)}finally{this.$store.state.toggle.refresh=!1}},async getLatestData(t){let{vendor:e}=this.$store.getters;"liveapp"===e&&(e="mapanything");const s=t.map((t=>`${e}-${t.deviceId}`));try{const{success:e,message:a,positions:o}=await(0,c.wX)("maps.LiveRemoteFunctions.GetDevicesLatestData",[s]);if(e)return this.appendLatestData(t,o);throw this.$store.state.devicesTable.tableRows=[],f.showError({position:"toast-top-right",message:"Error",subMessage:a,timeOut:8e3}),"You have not provided a Live API Key."===a&&(this.$store.state.toggle.hasLiveKey=!1),new Error("Issue invoking remote action maps.LiveRemoteFunctions.GetDevicesLatestData")}catch(t){return u(t)}finally{this.$store.state.toggle.refresh=!1}},async createRecords(t){try{this.$store.state.toggle.dashboardLoading=!0,(await v(t.map((t=>t.deviceId)),this.$store.getters.vendor)).forEach((t=>{const e=this.$store.state.devicesTable.tableRows.find((e=>e.deviceId===t.maps__DeviceId__c));e.recordExists=!0,e.recordId=t.Id}))}catch(t){u(t)}finally{this.$store.state.toggle.dashboardLoading=!1,this.$store.state.toggle.refresh=!1}},appendLatestData:(t,e)=>(t.forEach((t=>{e.forEach((e=>{t.processed=!0,t.deviceId===e.deviceId&&(t.lastReport=e.lastEventTime.value)}))})),t),getNextBatch(){const t=this.$store.state.devicesTable.unprocessedRows.filter((t=>!t.processed)).slice(0,50);return 0===t.length&&(this.$store.state.devicesTable.processingComplete=!0),t},makeArrayChunks(t,e){const s=[];let a=0;for(a=0;a<t.length;a+=e)s.push(t.slice(a,a+e));return s},navigateToURL(t){window.ma_navigateToUrl(`/apex/maps__Settings?tabId=${t}`,"","blank")},resetState(){this.$store.state.devicesTable.tableRows=[],this.$store.state.devicesTable.unprocessedRows=[],this.$store.state.devicesTable.tableLoading=!1,this.$store.state.devicesTable.processingComplete=!1,this.$store.state.tableFilters.filterTerm=null,this.$store.state.registrationModal.action="register",this.$store.state.registrationModal.emailRecipient=null,this.$store.state.registrationModal.vins=[],this.$store.state.registrationModal.fanId=null,this.$store.state.toggle.hasLiveKey=!0,this.$store.state.toggle.credentialsFound=!0}}},C=(0,n.Z)(b,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"slds-card slds-grid slds-grid_vertical",staticStyle:{height:"100%"}},[a("div",{staticClass:"slds-grid slds-grid_vertical dashboard-header"},[a("div",{staticClass:"slds-grid slds-wrap slds-m-around--medium"},[a("div",{staticClass:"slds-form-element slds-col slds-size_1-of-1 slds-large-size_4-of-12"},[a("div",{staticClass:"slds-media__body"},[a("h2",{staticClass:"slds-card__header-title slds-text-heading_medium"},[a("span",[t._v(t._s(t.returnCapitalized(t.$store.getters.vendor)||"Live")+" "+t._s(["ford","gm"].includes(t.$store.getters.vendor)?"Vehicles":"Devices")+" Management")])])])]),t._v(" "),t.$store.getters.vendor?a("div",{staticClass:"slds-col_bump-left"},[a("button",{staticClass:"slds-button slds-button_brand",attrs:{"aria-live":"assertive"},on:{click:function(e){["ford","gm"].includes(t.$store.getters.vendor)?t.showRegistrationModal("register"):"geotab"===t.$store.getters.vendor?t.showCredentialsModal():t.navigateToURL("PermissionGroups")}}},[["ford","gm"].includes(t.$store.getters.vendor)?a("Icon",{attrs:{src:s(3234),iconClass:["slds-button__icon","slds-button__icon_small","slds-button__icon_left"]}}):t._e(),t._v("\n                        "+t._s(["ford","gm"].includes(t.$store.getters.vendor)?"Register Vehicles":"geotab"===t.$store.getters.vendor?"Edit Credentials":"Edit Permissions")+"\n                    ")],1)]):t._e()]),t._v(" "),a("div",{staticClass:"slds-grid slds-m-right_medium slds-m-left_medium slds-m-bottom_medium"},[a("div",{staticClass:"slds-grid slds-grid_vertical"},[a("div",[t._v(" ")]),t._v(" "),a("div",[t._v("\n                        "+t._s(t.$store.state.devicesTable.selectedRowCount)+" Selected of "+t._s(t.$store.state.devicesTable.unprocessedRows.length)+"\n                        "),t.$store.state.tableFilters.filtersSelected.length>0?a("span",[t._v("\n                            • Filtered by\n                            "),t._l(t.$store.state.tableFilters.filtersSelected,(function(e,s){return a("span",{key:s,staticClass:"slds-p-left_xxx-small"},[s>0?a("span",[t._v("-")]):t._e(),t._v(" "+t._s(t.$store.state.tableFilters.filtersAvailable[e].label))])}))],2):t._e()])]),t._v(" "),a("div",{staticClass:"slds-col_bump-left slds-grid slds-grid_align_end slds-shrink-none"},[["ford","gm"].includes(t.$store.getters.vendor)?a("Tooltip",{staticClass:"slds-p-right_x-small",attrs:{text:'Click to perform bulk "Register" action'}},[a("Button",{attrs:{slot:"source",title:"Register",label:"Register",disabled:!(t.$store.state.devicesTable.selectedRowCount>0)},on:{click:function(e){return t.showRegistrationModal("register")}},slot:"source"})],1):t._e(),t._v(" "),["ford","gm"].includes(t.$store.getters.vendor)?a("Tooltip",{staticClass:"slds-p-right_x-small",attrs:{text:'Click to perform bulk "Deregister" action'}},[a("Button",{attrs:{slot:"source",title:"Deregister",label:"Deregister",disabled:!(t.$store.state.devicesTable.selectedRowCount>0)},on:{click:function(e){return t.showRegistrationModal("deregister")}},slot:"source"})],1):t._e(),t._v(" "),a("Tooltip",{staticClass:"slds-p-right_x-small",attrs:{text:'Click to perform bulk "Create Records" action'}},[a("Button",{attrs:{slot:"source",title:"Create Records",label:"Create Records",disabled:!(t.$store.state.devicesTable.selectedRowCount>0&&t.qualifiedForRecordCreation.length>0)},on:{click:function(e){return t.createRecords(t.selectedRows)}},slot:"source"})],1),t._v(" "),a("div",{staticClass:"slds-form-element"},[a("div",{staticClass:"slds-form-element__control slds-input-has-icon slds-input-has-icon_left-right slds-m-left_xx-small slds-m-right_xx-small"},[a("Icon",{attrs:{category:"utility",name:"search",iconClass:["slds-input__icon","slds-input__icon_left"]}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.$store.state.tableFilters.filterTerm,expression:"$store.state.tableFilters.filterTerm"}],staticClass:"slds-input",attrs:{id:"list-search",type:"text",placeholder:"Search "+(["ford","gm"].includes(t.$store.getters.vendor)?"VINs":"device IDs")+"..."},domProps:{value:t.$store.state.tableFilters.filterTerm},on:{input:function(e){e.target.composing||t.$set(t.$store.state.tableFilters,"filterTerm",e.target.value)}}}),t._v(" "),a("ButtonIcon",{staticClass:"slds-button slds-button_icon slds-input__icon slds-input__icon_right",attrs:{iconCategory:"utility",title:"Clear",assistiveText:"Clear",iconName:"clear"},on:{click:function(e){t.$store.state.tableFilters.filterTerm=null}}})],1)]),t._v(" "),a("ButtonIcon",{attrs:{id:"refresh-table",iconCategory:"utility",iconName:"refresh",title:"Refresh",assistiveText:"Refresh",variant:"border-filled"},on:{click:t.getDevicesData}}),t._v(" "),["ford","gm"].includes(t.$store.getters.vendor)?a("ButtonIcon",{attrs:{id:"filter-button",iconCategory:"utility",iconName:"filterList",title:"Filter",assistiveText:"Filter",variant:"border-filled",disabled:0===t.$store.state.devicesTable.tableRows.length||!["gm","ford"].includes(t.$store.getters.vendor)},on:{click:function(e){t.$store.state.tableFilters.showFilter=!t.$store.state.tableFilters.showFilter}}}):t._e()],1)])]),t._v(" "),a("div",{staticClass:"slds-grid slds-align-middle"},[t.$store.state.toggle.dashboardLoading?a("Spinner",{attrs:{theme:"brand"}}):t._e(),t._v(" "),!t.$store.state.toggle.dashboardLoading&&!t.$store.state.toggle.showErrorNotification&&0===Object.values(t.$store.getters.filteredRows).length&&!t.$store.state.devicesTable.tableRows.length>0&&!t.$store.state.tableFilters.filterTerm?a("div",{staticClass:"slds-p-around_x-large empty-state-wrapper"},[a("EmptyState")],1):a("div",{staticClass:"slds-table_header-fixed_container slds-grid slds-grid_vertical slds-border_top"},[a("DevicesTable"),t._v(" "),t.$store.state.devicesTable.tableLoading?a("div",{staticClass:"table-loader slds-p-around_medium slds-is-absolute slds-border_top"},[a("Spinner",{attrs:{size:"x-small",theme:"brand"}})],1):t._e()],1),t._v(" "),["ford","gm"].includes(t.$store.getters.vendor)?a("transition",{attrs:{name:"slide"}},[t.$store.state.tableFilters.showFilter?a("div",[a("div",{staticClass:"slds-panel slds-size_small slds-panel_docked slds-panel_docked-right slds-is-open",attrs:{id:"filter-vehicles-container","aria-hidden":"false"}},[a("div",{staticClass:"slds-panel__header"},[a("h2",{staticClass:"slds-panel__header-title slds-text-heading_small slds-truncate",attrs:{title:"Filter Devices"}},[t._v("\n                                Filter Devices\n                            ")]),t._v(" "),a("Tooltip",{attrs:{text:"Close Filter Panel"}},[a("ButtonIcon",{attrs:{slot:"source",iconCategory:"utility",title:"Close Filter",assistiveText:"Close Filter",iconName:"forward"},on:{click:function(e){t.$store.state.tableFilters.showFilter=!1}},slot:"source"})],1)],1),t._v(" "),a("div",{staticClass:"slds-panel__body"},[a("div",{staticClass:"slds-form-element slds-p-around_xx-small"},[a("div",{staticClass:"slds-form-element__control slds-p-around_xx-small"},t._l(t.$store.state.tableFilters.filtersAvailable,(function(e,s){return a("div",{key:s,staticClass:"slds-checkbox slds-m-bottom_xx-small"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.$store.state.tableFilters.filtersSelected,expression:"$store.state.tableFilters.filtersSelected"}],attrs:{id:e.value,type:"checkbox",name:"options",checked:""},domProps:{value:e.value,checked:Array.isArray(t.$store.state.tableFilters.filtersSelected)?t._i(t.$store.state.tableFilters.filtersSelected,e.value)>-1:t.$store.state.tableFilters.filtersSelected},on:{change:function(s){var a=t.$store.state.tableFilters.filtersSelected,o=s.target,r=!!o.checked;if(Array.isArray(a)){var i=e.value,l=t._i(a,i);o.checked?l<0&&t.$set(t.$store.state.tableFilters,"filtersSelected",a.concat([i])):l>-1&&t.$set(t.$store.state.tableFilters,"filtersSelected",a.slice(0,l).concat(a.slice(l+1)))}else t.$set(t.$store.state.tableFilters,"filtersSelected",r)}}}),t._v(" "),a("label",{staticClass:"slds-checkbox__label",attrs:{for:e.value}},[a("span",{staticClass:"slds-checkbox_faux"}),t._v(" "),a("span",{staticClass:"slds-form-element__label"},[t._v(t._s(e.label))])])])})),0)])])])]):t._e()]):t._e()],1)])])}),[],!1,null,null,null).exports,{MAToastMessages:$}=window,w={components:{Modal:r.u_,TextInput:r.oi},computed:{fanIdLabel(){let t;return"gm"===this.$store.getters.vendor&&(t="GM Fleet Account Number (FAN)"),"ford"===this.$store.getters.vendor&&(t="Ford Fleet Identification Number (FIN)"),t},fanIdPlaceHolder(){let t;return"gm"===this.$store.getters.vendor&&(t="Enter FAN"),"ford"===this.$store.getters.vendor&&(t="Enter FIN"),t}},methods:{closeModal(t){this.$store.state.toggle.showRegistrationModal=!1,t&&(this.$store.state.toggle.refresh=!0)},returnCapitalized:t=>t.charAt(0).toUpperCase()+t.slice(1),async doBulkVehicleAction(){const t=this.checkParams(this.$store.state.registrationModal);if(t)try{this.$store.state.toggle.modalLoading=!0;const{success:e,error:s}=await(0,c.wX)("maps.LiveRemoteFunctions.InitVehiclesJob",[t]);if(e){let t;"register"===this.$store.state.registrationModal.action?t="You will receive an email when the registration job has completed.":"deregister"===this.$store.state.registrationModal.action&&(t="The vehicles submitted have been marked for deregistration."),$.showSuccess({position:"toast-top-right",message:"Success",subMessage:t,timeOut:8e3}),this.closeModal(!0)}else $.showError({position:"toast-top-right",message:"Error",subMessage:JSON.stringify(s.message),timeOut:8e3})}catch(t){u(t)}finally{this.$store.state.toggle.modalLoading=!1}return null},checkParams(t){const{action:e,fanId:s,emailRecipient:a,vins:o}=t;let r=0;if(o){const t=o.split("\n").map((t=>t.trim().replace(/<(\/?script)>/gi,"&lt;$1&gt;")));for(const e of t)this.checkVinValidity(e)||($.showError({position:"toast-top-right",message:"Error",subMessage:`VIN ${e} is not valid.`,timeOut:8e3}),r+=1)}else $.showError({position:"toast-top-right",message:"Error",subMessage:`You must enter at least one VIN to start a ${e} job.`,timeOut:8e3}),r+=1;if(s?("gm"===this.$store.getters.vendor&&6!==s.toString().length&&($.showError({position:"toast-top-right",message:"Error",subMessage:"FAN ID should be exactly 6 digits.",timeOut:8e3}),r+=1),"ford"===this.$store.getters.vendor&&5!==s.toString().length&&($.showError({position:"toast-top-right",message:"Error",subMessage:"FAN ID should be exactly 5 digits.",timeOut:8e3}),r+=1)):($.showError({position:"toast-top-right",message:"Error",subMessage:`FAN ID is required to start a ${e} job.`,timeOut:8e3}),r+=1),"register"===e&&(a?/\S+@\S+\.\S+/.test(a)||($.showError({position:"toast-top-right",message:"Enter a valid email address.",timeOut:8e3}),r+=1):($.showError({position:"toast-top-right",message:`A recipient email is required to start a ${e} job.`,timeOut:8e3}),r+=1)),0===r){const t={vendor:this.$store.getters.vendor,job_type:e,fan_id:"gm"===this.$store.getters.vendor?Number(s):s,vins:o.split("\n").map((t=>t.trim())),email_recipient:a};return JSON.stringify(t)}return null},checkVinValidity(t){if(t=t.toLowerCase(),!/^[a-hj-npr-z0-9]{8}[0-9xX][a-hj-npr-z0-9]{8}$/.test(t))return!1;const e={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8,j:1,k:2,l:3,m:4,n:5,p:7,r:9,s:2,t:3,u:4,v:5,w:6,x:7,y:8,z:9},s=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2];let a=0;for(let o=0;o<t.length;++o)a+=e[t.charAt(o)]*s[o];const o=a%11;return 10===o?"x"===t.charAt(8):t.charAt(8)==o}}},k=(0,n.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{title:t.returnCapitalized(t.$store.state.registrationModal.action)+" Vehicles",isLoading:t.$store.state.toggle.modalLoading,hideCloseButton:t.$store.state.toggle.modalLoading},on:{close:function(e){return t.closeModal(!1)}}},[s("div",{staticClass:"slds-p-horizontal_xx-large slds-p-vertical_large",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-text-heading_small slds-p-bottom_small"},[t._v("Instructions:")]),t._v(" "),s("div",{staticClass:"slds-text-body_regular slds-p-bottom_large"},["register"===t.$store.state.registrationModal.action?s("div",[t._v("\n                Complete this form to authorize Salesforce Maps to track fleet vehicle location data.\n            ")]):s("div",[t._v("\n                Complete this form to stop Salesforce Maps from tracking fleet vehicle location data.\n            ")]),t._v(" "),"ford"===t.$store.getters.vendor?s("div",{staticClass:"slds-p-top_small"},[t._v("\n                If you do not know your Ford Fleet Identification Number (FIN), please contact Ford at "),s("strong",[t._v("1-833-811-FORD")]),t._v(" or through their "),s("a",{attrs:{href:"https://www.commercialsolutions.ford.com/contact-us",target:"blank"}},[t._v("contact form")]),t._v(".\n            ")]):t._e(),t._v(" "),"gm"===t.$store.getters.vendor?s("div",{staticClass:"slds-p-top_small"},[t._v("\n                If you do not know your GM Fleet Account Number (FAN), please contact GM at "),s("strong",[t._v("fleetoperations@gm.com")]),t._v(".\n            ")]):t._e()]),t._v(" "),s("TextInput",{attrs:{id:"text-input-fan",required:!0,type:"text",labels:{name:t.fanIdLabel,placeholder:t.fanIdPlaceHolder},placeholder:t.fanIdPlaceHolder},model:{value:t.$store.state.registrationModal.fanId,callback:function(e){t.$set(t.$store.state.registrationModal,"fanId",e)},expression:"$store.state.registrationModal.fanId"}}),t._v(" "),"register"===t.$store.state.registrationModal.action?s("TextInput",{attrs:{id:"text-input-email",required:!0,type:"text",labels:{name:"Email recipient for job completion",placeholder:"Enter Email"}},model:{value:t.$store.state.registrationModal.emailRecipient,callback:function(e){t.$set(t.$store.state.registrationModal,"emailRecipient",e)},expression:"$store.state.registrationModal.emailRecipient"}}):t._e(),t._v(" "),s("TextInput",{attrs:{id:"text-input-VINs",required:!0,useTextArea:!0,type:"text",labels:{name:"VINs (Separated by line break)",placeholder:"Enter VINs"}},model:{value:t.$store.state.registrationModal.vins,callback:function(e){t.$set(t.$store.state.registrationModal,"vins",e)},expression:"$store.state.registrationModal.vins"}})],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.closeModal(!1)}}},[t._v("\n            "+t._s(t.$Labels.MA_Cancel)+"\n        ")]),t._v(" "),s("button",{staticClass:"slds-button",class:"deregister"===t.$store.state.registrationModal.action?"slds-button_destructive":"slds-button_brand",on:{click:t.doBulkVehicleAction}},[t._v("\n            "+t._s("deregister"===t.$store.state.registrationModal.action?"Deregister":"Register")+"\n        ")])])])}),[],!1,null,"48233e11",null).exports,{MAToastMessages:y}=window,x={components:{Modal:r.u_,TextInput:r.oi},async created(){this.$store.state.credentialsModal.username=null,this.$store.state.credentialsModal.password=null,this.$store.state.credentialsModal.database=null,this.$store.state.toggle.credentialsFound&&await this.getCredentials()},methods:{closeModal(t){this.$store.state.toggle.showCredentialsModal=!1,t&&(this.$store.state.toggle.refresh=!0)},async getCredentials(){this.$store.state.toggle.modalLoading=!0;try{const{code:t,data:e,message:s}=await(0,c.wX)("maps.LiveRemoteFunctions.getIngestionCredentials",[]);200===t&&e.credentials?(this.$store.state.toggle.credentialsFound=!0,this.$store.state.credentialsModal.username=e.credentials.username,this.$store.state.credentialsModal.database=e.credentials.database):s.includes("Incorrect login credentials")?this.$store.state.toggle.credentialsFound=!1:s.includes("No credentials found for this Live key")||(y.showError({position:"toast-top-right",message:"Error",subMessage:s,timeOut:8e3}),"You have not provided a Live API Key."===s&&(this.hasLiveKey=!1))}catch(t){u(t)}finally{this.$store.state.toggle.modalLoading=!1}},async saveCredentials(){this.$store.state.toggle.modalLoading=!0;try{const t=this.$store.state.credentialsModal;let e=0;if(Object.keys(t).forEach((t=>{this.$store.state.credentialsModal[t]?this.$store.state.credentialsModal[t]=this.$store.state.credentialsModal[t].trim():(e++,y.showError({position:"toast-top-right",message:"Error",subMessage:`Missing required input for: ${t}`,timeOut:8e3}))})),0===e){const{code:e,message:s}=await(0,c.wX)("maps.LiveRemoteFunctions.saveIngestionCredentials",[t]);200===e?(y.showSuccess({position:"toast-top-right",message:"Success",subMessage:"Ingestion credentials updated for Geotab",timeOut:8e3}),this.closeModal(!0)):y.showError({position:"toast-top-right",message:"Error",subMessage:s,timeOut:8e3})}}catch(t){u(t)}finally{this.$store.state.toggle.modalLoading=!1}}}},M=(0,n.Z)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{title:"Enter Geotab Credentials",isLoading:t.$store.state.toggle.modalLoading,hideCloseButton:t.$store.state.toggle.modalLoading},on:{close:function(e){return t.closeModal(!1)}}},[s("div",{staticClass:"slds-p-horizontal_xx-large slds-p-vertical_large",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-text-heading_small slds-p-bottom_small"},[t._v("Instructions:")]),t._v(" "),s("div",{staticClass:"slds-text-body_regular slds-p-bottom_large"},[s("div",{staticClass:"slds-p-bottom_small"},[t._v("\n                Supply your Geotab credentials to authorize Salesforce Maps to track your devices' location data.\n            ")]),t._v(" "),s("div",[t._v("\n                If you do not know your Geotab Username, Password, or Database, please reach out to your Geotab device partner.\n            ")])]),t._v(" "),s("TextInput",{attrs:{id:"text-input-username",required:!0,type:"text",labels:{name:"Username",placeholder:"Enter Username"}},model:{value:t.$store.state.credentialsModal.username,callback:function(e){t.$set(t.$store.state.credentialsModal,"username",e)},expression:"$store.state.credentialsModal.username"}}),t._v(" "),s("TextInput",{attrs:{id:"text-input-password",required:!0,type:"password",labels:{name:"Password",placeholder:"Enter Password"}},model:{value:t.$store.state.credentialsModal.password,callback:function(e){t.$set(t.$store.state.credentialsModal,"password",e)},expression:"$store.state.credentialsModal.password"}}),t._v(" "),s("TextInput",{attrs:{id:"text-input-database",required:!0,type:"text",labels:{name:"Database",placeholder:"Enter Database"}},model:{value:t.$store.state.credentialsModal.database,callback:function(e){t.$set(t.$store.state.credentialsModal,"database",e)},expression:"$store.state.credentialsModal.database"}})],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.closeModal(!1)}}},[t._v("\n            "+t._s(t.$Labels.MA_Cancel)+"\n        ")]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:function(e){return t.saveCredentials()}}},[t._v("\n            Save\n        ")])])])}),[],!1,null,"6bb6ba04",null).exports,T={methods:{showCredentialsModal(){this.$store.state.toggle.showCredentialsModal=!0}}},L=(0,n.Z)(T,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"slds-notify_container slds-is-relative slds-m-bottom_x-small"},[a("div",{staticClass:"slds-notify slds-notify_toast slds-theme_error",attrs:{role:"status"}},[a("span",{staticClass:"slds-assistive-text"},[t._v("Invalid GeoTab credentials detected, update to continue.")]),t._v(" "),a("span",{staticClass:"slds-icon_container slds-icon-utility-error slds-m-right_small slds-no-flex slds-align-top",attrs:{title:"Description of icon when needed"}},[a("Icon",{attrs:{src:s(4853),iconClass:["slds-icon","slds-icon_small"]}})],1),t._v(" "),a("div",{staticClass:"slds-notify__content"},[a("h2",{staticClass:"slds-text-heading_small "},[t._v("\n                Invalid GeoTab credentials detected, update to continue.\n                "),a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.showCredentialsModal()}}},[t._v("\n                    Update Credentials\n                ")])])]),t._v(" "),a("div",{staticClass:"slds-notify__close"},[a("button",{staticClass:"slds-button slds-button_icon slds-button_icon-inverse",attrs:{title:"Close"},on:{click:function(e){t.$store.state.toggle.showErrorNotification=!1}}},[a("Icon",{attrs:{src:s(539),iconClass:["slds-button__icon","slds-button__icon_large"]}}),t._v(" "),a("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1)])])])}),[],!1,null,"37f69fe6",null).exports,R={components:{PageHeader:r.mr,VisualPicker:d,VendorDashboard:C,RegistrationModal:k,CredentialsModal:M,ErrorNotification:L},data:()=>({title:"Devices Management"}),created(){this.goBackToVisualPicker()},beforeCreate(){this.$store=new(o().Store)(i)},methods:{goBackToVisualPicker(){this.$store.state.visualPickerOptions.selectedOption=null,this.$store.state.toggle.showVisualPicker=!0,this.$store.state.toggle.showVendorDashboard=!1,this.$store.state.toggle.showErrorNotification=!1},goToDashboard(){this.$store.state.visualPickerOptions.selectedOption&&(this.$store.state.toggle.showVendorDashboard=!0,this.$store.state.toggle.showVisualPicker=!1,this.$store.state.toggle.refresh=!0)}}},I=(0,n.Z)(R,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%"},attrs:{id:"app"}},[a("div",{staticClass:"slds-is-relative slds-p-vertical_medium"},[a("PageHeader",{attrs:{label:"Salesforce Maps Live Tracking",title:t._f("decode")(t.title)}},[a("span",{staticClass:"slds-icon_container",attrs:{slot:"icon"},slot:"icon"},[a("img",{staticClass:"slds-icon slds-page-header__icon",attrs:{src:s(792)}})]),t._v(" "),a("div",{attrs:{slot:"actions"},slot:"actions"},[t.$store.state.toggle.showVendorDashboard?a("button",{staticClass:"slds-button slds-button_neutral",attrs:{type:"button"},on:{click:function(e){return t.goBackToVisualPicker()}}},[t._v("\n                    Back\n                ")]):t._e()])])],1),t._v(" "),t.$store.state.toggle.showVisualPicker?a("div",[a("div",{staticClass:"slds-card slds-box slds-has-bottom-magnet"},[a("div",{staticClass:"slds-text-heading_large slds-m-bottom--medium"},[t._v("Select a Vendor")]),t._v(" "),a("div",{staticClass:"slds-text-body_regular"},[t._v("\n                Choose a vendor from the following options to manage your organization's fleet of devices.\n            ")]),t._v(" "),a("VisualPicker",[a("span",{attrs:{slot:"content_1"},slot:"content_1"},[a("img",{staticStyle:{width:"75%"},attrs:{src:s(5315),alt:""}})]),t._v(" "),a("span",{attrs:{slot:"content_2"},slot:"content_2"},[a("img",{staticStyle:{width:"55%"},attrs:{src:s(1529),alt:""}})]),t._v(" "),a("span",{attrs:{slot:"content_3"},slot:"content_3"},[a("img",{staticStyle:{width:"70%"},attrs:{src:s(59),alt:""}})]),t._v(" "),a("span",{attrs:{slot:"content_4"},slot:"content_4"},[a("img",{staticStyle:{width:"65%"},attrs:{src:s(4650),alt:""}})])])],1),t._v(" "),a("div",{staticClass:"slds-modal__footer"},[a("button",{staticClass:"slds-button slds-button_brand",attrs:{type:"button",disabled:!t.$store.state.visualPickerOptions.selectedOption},on:{click:function(e){return t.goToDashboard()}}},[t._v("\n                Next\n            ")])])]):t._e(),t._v(" "),t.$store.state.toggle.showErrorNotification?a("ErrorNotification"):t._e(),t._v(" "),t.$store.state.toggle.showVendorDashboard?a("VendorDashboard"):t._e(),t._v(" "),t.$store.state.toggle.showRegistrationModal?a("RegistrationModal"):t._e(),t._v(" "),t.$store.state.toggle.showCredentialsModal?a("CredentialsModal"):t._e()],1)}),[],!1,null,null,null).exports}}]);