"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[4485],{8719:(e,t,a)=>{a.d(t,{K:()=>r,x:()=>c});var s=a(5735),l=a.n(s),i=a(2423),o=a(5658);const r=async({sobject:e="",permissionsToCheck:t={isAccessible:!0},updateProgress:a=(()=>{}),includeDedicatedLookupOptions:s=!1})=>(async({sobject:e="",permissionsToCheck:t={isAccessible:!0},fieldIndex:a,progressCallback:s=(()=>{}),includeDedicatedLookupOptions:r=!1})=>{const{success:c=!1,data:n={},message:d}=await(0,o.wX)("RemoteFunctions.GetGlobalDescribeFields",[e,t,a,r],{escape:!1,buffer:!1});if(c){const{hasMore:a=!1,index:o,availableFields:r=[],totalSize:c=0}=n;if(a){let a=r;return await(async(e="",t={isAccessible:!0},a,s=(()=>{}))=>new Promise((o=>{let r=[];const c={status:"Running Batch",total:0,complete:0,success:0,failure:0},n=l()(((e,t)=>{const{object:a,limits:l,index:o}=e;((e="",t={isAccessible:!0},a)=>new Promise(((s,l)=>{(new i.Z).setAction("maps.RemoteFunctions.GetGlobalDescribeFields").setErrorHandler((e=>{l(new Error(e))})).invoke([e,t,a],(e=>{const{success:t=!1,data:a=[]}=e;t?s(a):(console.warn("Unable to get data from Salesforce."),l(new Error("Unable to get data from Salesforce (SFDC fields).")))}),{escape:!1,buffer:!1,timeout:45e3})})))(a,l,o).then((e=>{const{hasMore:t=!1,availableFields:s=[]}=e,i=e.index;t&&n.push({object:a,limits:l,index:i}),r=[...r,...s],c.success+=s.length})).catch((e=>{console.warn("schema error",e),c.failure++})).finally((()=>{c.complete++,s(c),t()}))}),1);n.push({object:e,limits:t,index:a}),n.drain=()=>{const e=r.sort(((e,t)=>e.label>t.label?1:-1));o(e)}})))(e,t,o,(e=>{e.total=c,s(e)})).then((e=>{a=[...a,...e]})),a}return r}throw console.warn("Unable to get data from Salesforce."),new Error(d)})({sobject:e,permissionsToCheck:t,fieldIndex:0,updateProgress:e=>{a(e)},includeDedicatedLookupOptions:s}),c=async(e={},t=!1,a=(()=>{}))=>{const s=e.hideExtraObjects||!1;let o;return await(async(e=!1,t=!0,a={},s=0,o=(()=>{}))=>new Promise(((r,c)=>{const n=s;(new i.Z).setAction("maps.RemoteFunctions.GetGlobalDescribeObjects").setErrorHandler((e=>{c(new Error(e))})).invoke([e,a,t,n],(async s=>{const{success:n=!1,data:d={}}=s;if(n){const{hasMore:s=!1,index:c,availableObjects:n=[],totalSize:u=0}=d;if(s){let s=n;await((e=!1,t=!0,a={},s=0,o=(()=>{}))=>new Promise((r=>{const c={status:"Running Batch",total:0,complete:0,success:0,failure:0};let n=[];const d=l()(((e,t)=>{const{removeExtra:a,limitedSet:s,limits:l,index:r}=e;((e=!1,t=!0,a={},s=0)=>new Promise(((l,o)=>{(new i.Z).setAction("maps.RemoteFunctions.GetGlobalDescribeObjects").setErrorHandler((e=>{o(new Error(e))})).invoke([e,a,t,s],(e=>{const{success:t=!1,data:a={}}=e;t?l(a):(console.warn("Unable to get data from Salesforce."),o(new Error("Unable to get data from Salesforce (SFDC objects).")))}),{escape:!1,buffer:!1})})))(a,s,l,r).then((e=>{const{hasMore:t=!1,availableObjects:i=[]}=e,o=e.index;t&&d.push({removeExtra:a,limitedSet:s,limits:l,index:o}),n=[...n,...i],c.success+=i.length})).catch((e=>{c.failure++,console.warn("schema error",e)})).finally((()=>{c.complete++,o(c),t()}))}),1);d.push({removeExtra:e,limitedSet:t,limits:a,index:s}),d.drain=()=>{const e=n.sort(((e,t)=>e.name>t.name?1:-1));r(e)}})))(e,t,a,c,(e=>{e.total=u,o(e)})).then((e=>{s=[...s,...e]})),r(s)}else r(n)}else console.warn("Unable to get data from Salesforce."),c(new Error("Unable to get data from Salesforce (SFDC objects)."))}),{escape:!1,buffer:!1})})))(s,t,e,0,(e=>{a(e)})).then((e=>{o=e})),o}},1788:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var s=a(2766),l=a(8719),i=a(257),o=a(5908);const r={components:{Picklist:s.Gp},data:()=>({allSFDCObjects:!1,localBaseObjectApi:""}),computed:{...(0,o.mapState)(["availableSFDCObject","baseObject"])},watch:{allSFDCObjects(){this.getAvailableObjects()},localBaseObjectApi(e){e||this.store__updateBaseObject({name:"",label:""})}},async created(){await this.getAvailableObjects(),this.localBaseObjectApi="Lead",this.setBaseObject({name:"Lead",label:"Lead"})},methods:{...(0,o.mapMutations)({store__updateAvailableObjects:"updateAvailableObjects",store__updateBaseObject:"updateBaseObject",store__updateSFDCMetaData:"updateSFDCMetaData",store__loadingToggle:"loadingToggle"}),async getAvailableObjects(){this.store__loadingToggle(!0);try{const e={isAccessible:!0,isQueryable:!0,hideExtraObjects:!0},t=!this.allSFDCObjects,a=await(0,l.x)(e,t);this.store__updateAvailableObjects(a),this.store__loadingToggle(!1)}catch(e){this.$emit("udpateToast",{type:"error",message:"Unable to retrieve Salesfoce Objects."}),this.store__loadingToggle(!1)}},setBaseObject(e){this.store__updateBaseObject(e),this.store__loadingToggle(!0),this.getBaseObjectMetaData().then((e=>{this.store__updateSFDCMetaData(e)})).catch((()=>{this.$emit("udpateToast",{type:"error",message:`Unable to retrieve ${e.label} meta data from Salesforce.`})})).finally((()=>{this.store__loadingToggle(!1)}))},getBaseObjectMetaData(){return new Promise(((e,t)=>{const a={action:"get_object_metadata",objectAPIName:this.localBaseObjectApi};(new i.Z).setAction("maps.AdminAJAXResources.AdminStartUpAction").setErrorHandler((e=>{console.warn(e),t(new Error("Unable to get data from Salesforce. (SFDC object meta data)"))})).invoke([a],(a=>{const{success:s=!1,data:l={}}=a;s?e(l):(console.warn("Unable to get data from Salesforce."),t(new Error("Unable to get data from Salesforce. (SFDC object meta data)")))}),{escape:!1,buffer:!1})}))}}},c=(0,a(1900).Z)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-p-bottom_x-small"},[a("div",{staticClass:"slds-box graybox"},[a("div",{staticClass:"sectionTitle"},[e._v("\n            "+e._s(e.$Labels.MapsSetting_Select_Salesforce_Object)+"\n        ")]),e._v(" "),a("Picklist",{staticClass:"selectWrapper slds-p-vertical_x-small",attrs:{options:e.availableSFDCObject,detach:!0,hasNoneOption:!1,labels:{name:e.$Labels.MA_OBJECT},idKey:"label",titleKey:"name",filterable:""},on:{"selected-option":e.setBaseObject},model:{value:e.localBaseObjectApi,callback:function(t){e.localBaseObjectApi=t},expression:"localBaseObjectApi"}}),e._v(" "),a("div",{staticClass:"slds-form-element__control"},[a("span",{staticClass:"slds-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.allSFDCObjects,expression:"allSFDCObjects"}],attrs:{id:"viewAll-2",type:"checkbox",name:"options"},domProps:{checked:Array.isArray(e.allSFDCObjects)?e._i(e.allSFDCObjects,null)>-1:e.allSFDCObjects},on:{change:function(t){var a=e.allSFDCObjects,s=t.target,l=!!s.checked;if(Array.isArray(a)){var i=e._i(a,null);s.checked?i<0&&(e.allSFDCObjects=a.concat([null])):i>-1&&(e.allSFDCObjects=a.slice(0,i).concat(a.slice(i+1)))}else e.allSFDCObjects=l}}}),e._v(" "),a("label",{staticClass:"slds-checkbox__label",attrs:{for:"viewAll-2"}},[a("span",{staticClass:"slds-checkbox_faux"}),e._v(" "),a("span",{staticClass:"slds-form-element__label"},[e._v(e._s(e.$Labels.MapsSetting_View_All_Salesforce_Objects))])])])])],1)])}),[],!1,null,null,null).exports},5882:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var s=a(2766),l=a(257),i=a(5908);const o={components:{Picklist:s.Gp},data:()=>({sourceError:!1,previousSource:"",localDataSource:""}),computed:{...(0,i.mapState)(["dataSources","dataLayerMap","dataSource"])},watch:{localDataSource(e){e||(this.previousSource="",this.store__resetDataLayerSetup())}},created(){this.getDataLayerSources()},methods:{...(0,i.mapActions)({store__getDataLayerSourceData:"getDataLayerSourceData"}),...(0,i.mapMutations)({store__updateDataSource:"updateDataSource",store__updateDataSources:"updateDataSources",store__updateDataSourceFields:"updateDataSourceFields",store__resetDataLayerSetup:"resetDataLayerSetup",store__setSavedC2CData:"setSavedC2CData",store__loadingToggle:"loadingToggle"}),getDataLayerSources(){this.sourceError=!1,this.store__loadingToggle(!0),this.store__getDataLayerSourceData({layer:null,fields:!1}).then((e=>{const{sources:t=[]}=e;this.store__updateDataSources(t)})).catch((()=>{this.$emit("udpateToast",{type:"error",message:"Unable to get source information for data layers."}),this.sourceError=!0})).finally((()=>{this.store__loadingToggle(!1)}))},setDataSource(e){const{previousSource:t}=this,a=e.id;t!==a&&(this.store__resetDataLayerSetup(),this.$nextTick((()=>{this.store__updateDataSource(e),this.store__loadingToggle(!0),this.getSavedSFDCData(a).finally((()=>{this.getSelectedDataLayerSourceData(a),this.store__loadingToggle(!1)})),this.previousSource=a||""})))},getSelectedDataLayerSourceData(e){this.store__loadingToggle(!0),this.store__getDataLayerSourceData({source:e,fields:!0}).then((e=>{const{sources:t=[]}=e,[a={}]=t,{fields:s=[]}=a;this.store__updateDataSourceFields(s)})).catch((()=>{this.$emit("udpateToast",{type:"error",message:"Unable to get source information for data layers."}),this.sourceError=!0})).finally((()=>{this.store__loadingToggle(!1)}))},getSavedSFDCData(e){return new Promise(((t,a)=>{(new l.Z).setAction("maps.DataLayers.getDataV2").setErrorHandler((()=>{a(new Error("Unable to get data from Salesforce, please reload this page and try again. Continuing may result in a loss of data."))})).invoke([e],(e=>{const{success:s=!1,data:l=[]}=e;if(s){const[e={}]=l,a=this.updateDataInformation(e);this.store__setSavedC2CData(a),t()}else a(new Error("Unable to get data from Salesforce, please reload this page and try again. Continuing may result in a loss of data."))}),{escape:!1,buffer:!1})}))},updateDataInformation(e){const t=e.maps__Type__c||"";e.maps__Type__c="dbusa-v1"===t?"business":"dmp-v1"===t?"property":t;const a=e.maps__Settings__c||"{}";let s={};try{s=JSON.parse(a)}catch(e){console.warn("Unable to parse saved settings",a)}return e.maps__Settings__c=s,e.ready=!0,e}}},r=(0,a(1900).Z)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-p-bottom_x-small"},[a("div",{staticClass:"slds-box graybox"},[a("div",{staticClass:"sectionTitle"},[e._v("\n            "+e._s(e.$Labels.MapsSetting_Select_Data_Layer)+"\n        ")]),e._v(" "),a("Picklist",{staticClass:"selectWrapper slds-p-vertical_x-small",attrs:{options:e.dataSources,doDetach:!0,idKey:"id",titleKey:"label",filterable:""},on:{"selected-option":e.setDataSource},model:{value:e.localDataSource,callback:function(t){e.localDataSource=t},expression:"localDataSource"}}),e._v(" "),e.sourceError?a("div",[a("button",{staticClass:"slds-button slds-button_icon slds-button_icon-brand",on:{click:e.getDataLayerSources}},[a("span",{staticClass:"slds-button__icon ma-icon ma-icon-refresh"})])]):e._e()],1)])}),[],!1,null,null,null).exports},9456:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var s=a(2766),l=a(5908);const i={components:{Picklist:s.Gp},data:()=>({dataFields:[],fieldOptions:{string:[],number:[],decimal:[],date:[],currency:[],boolean:[]},fieldMap:{}}),computed:{...(0,l.mapState)(["sfdcMetaData","dataSource","baseObject","savedSFDCRecord"]),savedC2CData(){const e=this.savedSFDCRecord.maps__Settings__c||{},{C2C:t={}}=e;return t},dataLayerFields(){const{fields:e=[]}=this.dataSource;return e}},watch:{fieldMap(e){this.store__updateFieldMapData(e)}},created(){this.buildFieldMappings(),this.setFieldTypeOptions()},methods:{...(0,l.mapMutations)({store__updateFieldMapData:"updateFieldMapData"}),buildFieldMappings(){const{apiName:e=""}=this.baseObject;let t={};const a=Object.keys(this.savedC2CData);for(let s=0;s<a.length;s++){const l=String(a[s]);if(l.toLowerCase()===e.toLowerCase()){t=this.savedC2CData[l];break}}const{fields:s={}}=t;this.fieldMap=s;const l=[];for(let e=0;e<this.dataLayerFields.length;e++){const t=this.dataLayerFields[e],a={id:t.id,label:t.label,type:t.filter_as,value:""};s[t.id]&&(a.value=s[t.id]),l.push(a)}this.dataFields=l},setFieldTypeOptions(){const{fields:e={}}=this.sfdcMetaData;let t=[];const a=Object.keys(e);for(let s=0;s<a.length;s++){const l=a[s],i=e[l];"numberFields"===l?(this.fieldOptions.number=i,this.fieldOptions.decimal=i):"dateFields"===l?this.fieldOptions.date=i:"currencyFields"===l?this.fieldOptions.currency=i:"booleanFields"===l?this.fieldOptions.boolean=i:"emailFields"!==l&&"phoneFields"!==l&&"websiteFields"!==l&&"textFields"!==l||(t=[...t,...i])}this.fieldOptions.string=t.sort(this.compareStrings)},compareStrings(e,t){const a=e.label.toLowerCase(),s=t.label.toLowerCase();let l=0;return a<s?l=-1:a>s&&(l=1),l},updateFieldMap(e){const{id:t,value:a}=e;a?this.fieldMap[t]=a:delete this.fieldMap[t]}}},o=(0,a(1900).Z)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-p-bottom_x-small"},[a("div",{staticClass:"slds-box graybox"},[a("div",[a("div",{staticClass:"sectionTitle"},[e._v("\n                "+e._s(e.$Labels.MapsSetting_Field_Mappings)+"\n            ")]),e._v(" "),a("div",{staticClass:"scrollArea"},e._l(e.dataFields,(function(t,s){return a("div",{key:s},[a("div",{staticClass:"selectWrapper slds-p-vertical_x-small",attrs:{datatype:t.type}},[a("Picklist",{attrs:{options:e.fieldOptions[t.type],labels:{name:t.label},detach:!0,idKey:"value",titleKey:"label",filterable:""},on:{changed:function(a){return e.updateFieldMap(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}})],1)])})),0)])])])}),[],!1,null,null,null).exports},5656:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var s=a(5908);const l={components:{Picklist:a(2766).Gp},props:{rowKey:{type:String,default:""},fieldSet:{type:Object,default:()=>{}}},data:()=>({sfdcFieldSets:[]}),computed:{...(0,s.mapState)(["sfdcMetaData"])},created(){const e=this.sfdcMetaData||{};this.sfdcFieldSets=e.fieldSets||[];try{const[e]=this.sfdcFieldSets;""===this.localVal&&(this.localVal=e.value,this.fieldSet.value=e.value)}catch(e){}}};var i=a(1900);const o={components:{FieldSetRow:(0,i.Z)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-p-top_xx-small selectWrapper"},[a("Picklist",{attrs:{options:e.sfdcFieldSets,labels:{name:e.fieldSet.name},hasNoneOption:!1,detach:!0,idKey:"value",titleKey:"label",filterable:""},model:{value:e.fieldSet.value,callback:function(t){e.$set(e.fieldSet,"value",t)},expression:"fieldSet.value"}})],1)}),[],!1,null,null,null).exports},props:{fieldSetValid:{type:Boolean,default:!1}},data:()=>({currentC2CData:{fields:{},objAPIName:"",objLabel:"",recordTypes:[]},localFieldSetInfo:[]}),computed:{...(0,s.mapState)(["sfdcMetaData","baseObject","savedSFDCRecord","fieldSetData"]),recordTypes(){const{recordTypes:e=[]}=this.sfdcMetaData;return e},fieldSets(){const{fieldSets:e=[]}=this.sfdcMetaData;return e},savedC2CData(){const e=this.savedSFDCRecord.maps__Settings__c||{},{C2C:t={}}=e;return t},hasFieldSets(){return this.fieldSets.length>0}},watch:{hasFieldSets(e){this.$emit("update:fieldSetValid",e)},localFieldSetInfo(e){this.store__updateFieldSetData(e)}},created(){this.buildFieldSetData(),this.$emit("update:fieldSetValid",this.hasFieldSets)},methods:{...(0,s.mapMutations)({store__updateFieldSetData:"updateFieldSetData"}),buildFieldSetData(){const{apiName:e=""}=this.baseObject;let t={fieldSetOptions:[],fields:{},objAPIName:"",objLabel:"",recordTypes:[]};const a=Object.keys(this.savedC2CData);for(let s=0;s<a.length;s++){const l=String(a[s]);if(l.toLowerCase()===e.toLowerCase()){t=this.savedC2CData[l];break}}this.currentC2CData=t;const{fieldSetOptions:s=[]}=t,l=s.reduce(((e,t)=>(e[t.RecordTypeId]=t,e)),{}),i=[];for(let e=0;e<this.recordTypes.length;e++){const t=this.recordTypes[e],a={id:t.id,name:t.name,value:"",systemDefault:t.systemDefault||!1};l[t.id]&&(a.value=l[t.id].FieldSetAPIName),i.push(a)}this.localFieldSetInfo=i}}},r=(0,i.Z)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-p-bottom_x-small"},[e.hasFieldSets?a("div",{staticClass:"slds-box graybox"},[a("div",{staticClass:"sectionTitle"},[e._v("\n            "+e._s(e.$Labels.MapsSetting_Field_Set_Mapping)+"\n        ")]),e._v(" "),e._l(e.localFieldSetInfo,(function(e){return a("FieldSetRow",{key:e.id,attrs:{rowKey:e.id,fieldSet:e}})}))],2):a("div",[a("div",{staticClass:"slds-notify_container slds-is-relative"},[a("div",{staticClass:"slds-notify slds-notify_toast slds-theme_warning"},[a("span",{staticClass:"slds-assistive-text"},[e._v(e._s(e.$Labels.MapsSetting_warning))]),e._v(" "),a("span",{staticClass:"slds-icon_container ma-icon ma-icon-warning slds-m-right_small slds-no-flex",staticStyle:{"font-size":"24px"}}),e._v(" "),a("div",{staticClass:"slds-notify__content"},[a("h2",{staticClass:"slds-text-heading_small"},[e._v("\n                        "+e._s(e.$Labels.MapsSetting_No_Field_Sets_Warning)+"\n                    ")]),e._v(" "),a("p",[e._v(e._s(e.$Labels.MapsSetting_No_Field_Sets_Assistance)+" "),a("a",{attrs:{href:"http://mapanything.com/support"}},[e._v("http://mapanything.com/support")])])])])])])])}),[],!1,null,null,null).exports}}]);