"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[9517],{1558:(e,a,t)=>{t.r(a),t.d(a,{default:()=>r});var s=t(5908),o=t(257);const n={computed:{...(0,s.mapState)(["fieldMapData","fieldSetData","savedSFDCRecord","baseObject","dataSource"])},methods:{...(0,s.mapMutations)(["loadingToggle","setSavedC2CData"]),sendSaveInfoSFDC:e=>new Promise(((a,t)=>{let s;try{s=JSON.stringify(e)}catch(a){return console.warn("Can't parse json settings for save",e),void t(new Error("Unable to create save data. Please reload this page and try again."))}(new o.Z).setAction("maps.DataLayers.doSaveV2").setErrorHandler((e=>{console.warn(e),t(new Error("Unable to save Salesforce data."))})).invoke([s],(e=>{const{success:s=!1,data:o={}}=e;s?a(o):(console.warn("Unable to get data from Salesforce."),t(new Error("Unable to get data from Salesforce.")))}),{escape:!1})})),saveDataLayer(){this.loadingToggle(!0);const e=this.buildSaveInfo();this.sendSaveInfoSFDC(e).then((e=>{e.maps__Settings__c=JSON.parse(e.maps__Settings__c),e.ready=!0,this.$emit("udpateToast",{type:"success",message:"Save Successful"}),this.setSavedC2CData(e)})).catch((e=>{let a="Unknown Error.";a="string"==typeof e?e:e.message||"Unable to get Salesforce data. Reloading this page may fix this issue.",this.$emit("udpateToast",{type:"error",message:a})})).finally((()=>{this.loadingToggle(!1)}))},buildSaveInfo(){const e={...this.savedSFDCRecord},{apiName:a,label:t}=this.baseObject,s={objAPIName:t,objLabel:a,fields:this.fieldMapData,recordTypes:[],fieldSetOptions:[]},o=this.fieldSetData||[];for(let e=0;e<o.length;e++){const a=o[e];a.value&&(s.fieldSetOptions.push({FieldSetAPIName:a.value,IsSystemDefault:a.systemDefault||!1,RecordTypeId:a.id,RecordTypeName:a.name}),s.recordTypes.push({id:a.id,label:a.name}))}const n={...e.maps__Settings__c}||{};n.C2C||(n.C2C={});const{C2C:r}=n;r[t]=s;const l={maps__Type__c:this.dataSource.id,maps__Settings__c:JSON.stringify(n)};return e.Id&&(l.Id=e.Id),l}}},r=(0,t(1900).Z)(n,(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("button",{staticClass:"slds-button slds-button_brand",on:{click:e.saveDataLayer}},[e._v("\n        "+e._s(e.$Labels.MA_Save)+"\n    ")])])}),[],!1,null,null,null).exports}}]);