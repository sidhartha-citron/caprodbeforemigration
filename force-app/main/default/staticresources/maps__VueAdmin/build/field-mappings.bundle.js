"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[9413],{8213:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var i=s(5908),l=s(5602),a=s(257);const{MARemoting:o,MAToastMessages:n}=window,r={components:{MAHeader:()=>Promise.resolve().then(s.bind(s,5868)),MAWarning:()=>({...(0,l.YH)(),component:s.e(2455).then(s.bind(s,7396))}),FieldSelectRow:()=>s.e(487).then(s.bind(s,3977)),FieldSetSelectRow:()=>s.e(2305).then(s.bind(s,2561)),FieldCheckboxRow:()=>s.e(6449).then(s.bind(s,2041)),DefaultValuesRow:()=>s.e(1667).then(s.bind(s,2223))},data(){return{noFieldSets:this.$Labels.MapsSetting_No_Field_Sets_Warning,allowSave:!0}},computed:{...(0,i.mapState)({store__isLoading:"isLoading",store__selectedObject:"selectedObject",store__fieldMappings:"fieldMappings",store__MAClick2CreateObj:"MAClick2CreateObj",store__fieldSetRecords:"fieldSetRecords"}),showMappingFields(){return this.store__hasFieldSets()},poiEnabled(){return this.store__MAClick2CreateObj.POIEnabled__c},myPositionEnabled(){return this.store__MAClick2CreateObj.MyPositionEnabled__c},mapEnabled(){return this.store__MAClick2CreateObj.MapClickEnabled__c},nothingEnabled(){return!this.poiEnabled&&!this.myPositionEnabled&&!this.mapEnabled},fields(){return[{fieldName:this.$Labels.MA_Street,selectOptions:this.store__fieldMappings.textFields,show:{POIPicklist:"POIStreet__c",MyPositionPicklist:"MyPositionStreet__c",MapClickPicklist:"MapClickStreet__c"}},{fieldName:this.$Labels.MA_City,selectOptions:this.store__fieldMappings.textFields,show:{POIPicklist:"POICity__c",MyPositionPicklist:"MyPositionCity__c",MapClickPicklist:"MapClickCity__c"}},{fieldName:this.$Labels.MA_State_Long,selectOptions:this.integrationPicklists("statecode"),show:{POIPicklist:"POIState__c",MyPositionPicklist:"MyPositionState__c",MapClickPicklist:"MapClickState__c"}},{fieldName:this.$Labels.MA_State_Short,selectOptions:this.integrationPicklists("statecode"),show:{POIPicklist:"POIStateShort__c"}},{fieldName:this.$Labels.MA_Postal_Code,selectOptions:this.store__fieldMappings.textFields,show:{POIPicklist:"POIPostalCode__c",MyPositionPicklist:"MyPositionPostalCode__c",MapClickPicklist:"MapClickPostalCode__c"}},{fieldName:this.$Labels.MA_Country_Long,selectOptions:this.integrationPicklists("countrycode"),show:{POIPicklist:"POICountry__c",MyPositionPicklist:"MyPositionCountry__c",MapClickPicklist:"MapClickCountry__c"}},{fieldName:this.$Labels.MA_Country_Short,selectOptions:this.integrationPicklists("countrycode"),show:{POIPicklist:"POICountryShort__c"}},{fieldName:this.$Labels.MA_Latitude,selectOptions:this.store__fieldMappings.numberFields,show:{POIPicklist:"POILatitude__c",MyPositionPicklist:"MyPositionLatitude__c",MapClickPicklist:"MapClickLatitude__c"}},{fieldName:this.$Labels.MA_Longitude,selectOptions:this.store__fieldMappings.numberFields,show:{POIPicklist:"POILongitude__c",MyPositionPicklist:"MyPositionLongitude__c",MapClickPicklist:"MapClickLongitude__c"}},{fieldName:this.$Labels.MA_Name,selectOptions:this.store__fieldMappings.textFields,show:{POIPicklist:"POIName__c",MyPositionPicklist:"MyPositionName__c",MapClickPicklist:"MapClickName__c"}},{fieldName:this.$Labels.MA_Phone,selectOptions:this.store__fieldMappings.phoneFields,show:{POIPicklist:"POIPhone__c"}},{fieldName:this.$Labels.MA_Website,selectOptions:this.store__fieldMappings.websiteFields,show:{POIPicklist:"POIWebsite__c"}}]}},watch:{store__selectedObject:{immediate:!0,handler(e){this.store__loadingToggle(!0),this.getAvailableFieldSets(e).then((e=>{const{success:t=!1,data:s={}}=e;if(t){const{recordTypes:t=[],fieldSets:i=[]}=s,l=[];t.forEach((e=>{if(!e.isPersonRecordType){const t={RecordTypeName:e.name,RecordTypeId:e.id,POIFieldSetAPIName:null,MyPositionFieldSetAPIName:null,MapClickFieldSetAPIName:null,IsSystemDefault:"012000000000000AAA"===e.id};l.push(t)}})),this.store__updateFieldSetRecords(l),i.length>0?(this.getC2CObject(this.store__selectedObject).then(this.store__populateMAClick2CreateObj).catch((e=>{throw console.warn("Error populating fields"),e})),this.displayMappingFields(e)):this.displayMissingFieldSetsError()}else console.error(e),this.displayMissingFieldSetsError();this.store__loadingToggle(!1)})).catch((e=>{throw e}))}}},created(){this.$bus.$on("set-allow-save",this.setAllowSave)},destroyed(){this.$bus.$off("set-allow-save")},methods:{...(0,i.mapMutations)({store__loadingToggle:"loadingToggle",store__updateFieldMappings:"updateFieldMappings",store__updateMAClick2CreateObj:"updateMAClick2CreateObj",store__populateMAClick2CreateObj:"populateMAClick2CreateObj",store__updateFieldSetRecords:"updateFieldSetRecords"}),...(0,i.mapGetters)({store__hasFieldSets:"hasFieldSets"}),...(0,i.mapActions)({store__suggestFields:"suggestFields"}),integrationPicklists(e){const{textFields:t}=this.store__fieldMappings;return[...t,...this.store__fieldMappings.picklistFields.filter((t=>t.value.toLowerCase().endsWith(e)))||""].sort(((e,t)=>e.label.toUpperCase()>t.label.toUpperCase()?1:e.label.toUpperCase()<t.label.toUpperCase()?-1:0))},setAllowSave(e){return this.allowSave=e,this.allowSave},displayMappingFields(e){const t=e.data.fields,s=[].concat(...Object.values(e.data.fields));t.allFields=s,t.fieldSets=e.data.fieldSets,t.recordTypes=e.data.recordTypes,this.store__updateFieldMappings(t)},displayMissingFieldSetsError(){this.store__populateMAClick2CreateObj({}),this.store__updateFieldMappings({allFields:[]})},getAvailableFieldSets:e=>new Promise(((t,s)=>{const i={action:"get_object_metadata",objectAPIName:e};(new a.Z).setAction(o.AdminStartUpAction).setErrorHandler((e=>{console.warn(e),s(new Error(e))})).invoke([i],(e=>{e&&e.success?t(e):(n.showError({message:"Unable to get data from Salesforce."}),s(new Error("Unable to get data from Salesforce (SFDC objects).")))}),{escape:!1,buffer:!1})})),getC2CObject:e=>new Promise(((t,s)=>{(new a.Z).setAction(o.Click2Create.getC2CSettings).setErrorHandler((e=>{console.warn(e),s(new Error(e))})).invoke([e],(e=>{e?t(e):(n.showError({message:"Unable to get data from Salesforce."}),s(new Error("Unable to get data from Salesforce (SFDC objects).")))}),{escape:!1,buffer:!1})})),saveC2CObject(e){return new Promise(((t,s)=>{this.store__updateMAClick2CreateObj({field:"ObjectAPIName__c",value:this.store__selectedObject}),this.store__updateMAClick2CreateObj({field:"FieldSetOptions__c",value:JSON.stringify(this.store__fieldSetRecords)});const i={serializedObject:JSON.stringify(this.addNamespace(e)),selectedObjectAPIName:this.store__selectedObject};(new a.Z).setAction(o.Click2Create.saveC2CSettings).setErrorHandler((e=>{console.warn(e),s(new Error(e))})).invoke([i],(e=>{e&&e.success?(n.showSuccess({message:"Settings saved"}),t(e)):(n.showError({message:"Unable to save data"}),s(new Error("Unable to get data from Salesforce (SFDC objects).")))}),{escape:!1,buffer:!1})}))},addNamespace(e){const t={};return t.Id=e.Id,Object.keys(e).forEach((s=>{"Id"!==s&&(t[`maps__${s}`]=e[s])})),t},localSuggestFields(){this.nothingEnabled?n.showWarning({message:"Please enable a field mapping.",timeOut:6e3}):this.store__suggestFields()}}},d=(0,s(1900).Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.showMappingFields?s("div",[s("div",{staticClass:"slds-section slds-m-bottom_large slds-is-open"},[s("MAHeader",{attrs:{title:e.$Labels.MapsSetting_Field_Mappings}})],1),e._v(" "),s("table",{staticClass:"slds-table slds-no-row-hover"},[s("FieldCheckboxRow"),e._v(" "),e._l(e.fields,(function(e,t){return s("FieldSelectRow",{key:t,attrs:{fieldName:e.fieldName,selectOptions:e.selectOptions,show:e.show}})}))],2),e._v(" "),s("div",{staticClass:"slds-section slds-m-bottom_large slds-is-open"},[s("MAHeader",{attrs:{title:e.$Labels.MapsSetting_Field_Set_Mappings}})],1),e._v(" "),s("table",{staticClass:"slds-table slds-no-row-hover"},[s("thead",[s("tr",[s("th"),e._v(" "),s("th",[s("div",[e._v("\n                            "+e._s(e.$Labels.MapsSetting_Point_Of_Interest)+"\n                        ")])]),e._v(" "),s("th",[s("div",[e._v("\n                            "+e._s(e.$Labels.MapsSetting_MyPosition)+"\n                        ")])]),e._v(" "),s("th",[s("div",[e._v("\n                            "+e._s(e.$Labels.MapsSetting_Map_Click)+"\n                        ")])])])]),e._v(" "),e._l(e.store__fieldSetRecords,(function(t){return s("FieldSetSelectRow",{key:t.RecordTypeId,attrs:{fieldName:t.RecordTypeName,selectOptions:e.store__fieldMappings.fieldSets,record:t}})}))],2),e._v(" "),s("div",{staticClass:"slds-section slds-m-bottom_large slds-is-open"},[s("MAHeader",{attrs:{title:e.$Labels.defaultValues}})],1),e._v(" "),s("table",{staticClass:"slds-table slds-no-row-hover"},[s("thead",[s("tr",[s("th"),e._v(" "),s("th",[s("div",[e._v("\n                            "+e._s(e.$Labels.MapsSetting_Point_Of_Interest)+"\n                        ")])]),e._v(" "),s("th",[s("div",[e._v("\n                            "+e._s(e.$Labels.MapsSetting_MyPosition)+"\n                        ")])]),e._v(" "),s("th",[s("div",[e._v("\n                            "+e._s(e.$Labels.MapsSetting_Map_Click)+"\n                        ")])])])]),e._v(" "),s("DefaultValuesRow")],1),e._v(" "),s("br"),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!e.allowSave},on:{click:function(t){return e.saveC2CObject(e.store__MAClick2CreateObj)}}},[e._v("\n                "+e._s(e.$Labels.MA_Save)+"\n            ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.localSuggestFields}},[e._v("\n                "+e._s(e.$Labels.MA_Suggest)+"\n            ")])])]):s("div",[s("MAWarning",{attrs:{warningMessage:e.noFieldSets}})],1)])}),[],!1,null,null,null).exports}}]);