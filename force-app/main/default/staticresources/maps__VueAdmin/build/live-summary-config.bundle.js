(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[7295],{7097:(e,t,s)=>{e.exports=s.p+"images/53b9b138946fee58b1ad8d319015d444.svg"},6425:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var a=s(5908),i=s.n(a);const r={state:{toggle:{showSummaryConfig:!1,showGenerateSummaries:!1,showUserPrompt:!1,showDeleteConfig:!1,refresh:!1},summaryConfig:{activeTab:"details",action:"create",configData:{summaryname:"",summarydesc:"",livelayerid:"",livelayername:"",associations:{},anyduration:!1,distval:null,distmeas:"feet",disttime:null,drivetripoptim:"Vehicle Tracking",speedlimitover:null,speedlimittime:null,speedlimitunits:"mph",speedthreshval:null,speedthreshunits:"mph",threshtime:null,createstoprec:!0,createspeedrec:!0,createspeedthreshrec:!0,stoptoggle:!0,speedingtoggle:!0,speedthreshtoggle:!0}},summaryErrors:{selectedErrors:0,ignoreErrors:!1,reRunSummaries:!1}},mutations:{resetSummaryConfig(e){e.summaryConfig.action="create",e.summaryConfig.configData={summaryname:"",summarydesc:"",livelayerid:"",livelayername:"",associations:{},anyduration:!1,distval:null,distmeas:"feet",disttime:null,drivetripoptim:"Vehicle Tracking",speedlimitover:null,speedlimittime:null,speedlimitunits:"mph",speedthreshval:null,speedthreshunits:"mph",threshtime:null,createstoprec:!0,createspeedrec:!0,createspeedthreshrec:!0,stoptoggle:!0,speedingtoggle:!0,speedthreshtoggle:!0}}}};var o=s(3088),l=s(2766);const{MAToastMessages:n}=window,d={components:{Spinner:l.$j,Checkbox:l.XZ,ActionMenu:l.PC,ActionMenuItem:l.F9,ButtonIcon:l.Ei},data:()=>({isLoading:!1,summaries:[]}),computed:{...(0,a.mapState)({store__toggle:"toggle",store__summaryConfig:"summaryConfig"})},watch:{"store__toggle.showSummaryConfig":{async handler(e){!e&&this.store__toggle.refresh&&await this.getSummaries()},deep:!0},"store__toggle.showDeleteConfig":{async handler(e){!e&&this.store__toggle.refresh&&await this.getSummaries()},deep:!0}},async created(){await this.getSummaries()},methods:{...(0,a.mapMutations)({store__resetSummaryConfig:"resetSummaryConfig"}),showSummaryDetails(e){e.toggle=!e.toggle},showSummaryConfig(e,t){const s=this.store__summaryConfig;s.action=e,"create"===e?(this.store__resetSummaryConfig(),s.activeTab="details"):(t&&(s.configData=t),"clone"===e&&(s.configData.summaryname=`Copy of ${s.configData.summaryname}`,s.configData.id=void 0),["edit","clone"].includes(e)&&(s.activeTab="details"),"errors"===e&&(s.activeTab="errors")),this.store__toggle.showSummaryConfig=!0},showGenerateSummaries(e){this.store__summaryConfig.configData=e,this.store__toggle.showGenerateSummaries=!0},showDeleteConfig(e){this.store__summaryConfig.configData=e,this.store__toggle.showDeleteConfig=!0},async getSummaries(){this.isLoading=!0;try{const{success:e,summaries:t}=await(0,o.wX)("maps.LiveRemoteFunctions.RetrieveAllSummaries",[]);e?(t.length>0&&t.forEach((e=>{e.toggle=!1,e.drivetripoptim=e.drivetripoptim?e.drivetripoptim:"Vehicle Tracking"})),this.summaries=t):n.showError({position:"toast-top-right",message:"Error",subMessage:"Could not retrieve stored Summary Configurations",timeOut:8e3})}catch(e){n.showError({position:"toast-top-right",message:"Remoting Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1,this.store__toggle.refresh=!1}},async setSummaryActiveState(e,t,s){this.isLoading=!0;const a=[t,s,e];try{const{success:e,message:t}=await(0,o.wX)("maps.LiveRemoteFunctions.SaveSummaryActiveState",a);e?n.showLoading({position:"toast-top-right",message:"Notice",subMessage:t.replace(/<(\/?script)>/gi,"&lt;$1&gt;"),timeOut:8e3}):n.showError({position:"toast-top-right",message:"Remoting Error",subMessage:t.replace(/<(\/?script)>/gi,"&lt;$1&gt;"),timeOut:8e3})}catch(e){n.showError({position:"toast-top-right",message:"Remoting Error",subMessage:e,timeOut:8e3})}finally{this.getSummaries(),this.isLoading=!1,this.store__toggle.refresh=!1}}}};var c=s(1900);const m=(0,c.Z)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Spinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),e._v(" "),s("div",{staticClass:"slds-grid slds-p-top_large slds-p-bottom_small slds-p-horizontal_small"},[s("div",{staticClass:"slds-col slds-grid"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(t){return e.showSummaryConfig("create")}}},[s("span",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-add"}),e._v("\n                Add New\n            ")])])]),e._v(" "),e._l(e.summaries,(function(t,a){return s("div",{key:a,attrs:{id:"card-section"}},[s("div",{staticClass:"slds-card slds-container_medium slds-m-bottom_medium"},[s("ul",{staticClass:"slds-accordion"},[s("li",{staticClass:"slds-accordion__list-item"},[s("section",{staticClass:"slds-accordion__section",class:t.toggle?"slds-is-open":null},[s("div",{staticClass:"slds-accordion__summary"},[s("h3",{staticClass:"slds-text-heading_small slds-accordion__summary-heading slds-grid slds-grid_vertical-align-center slds-p-around_x-small",staticStyle:{"background-color":"whitesmoke"}},[s("button",{staticClass:"slds-button accordian-switch",attrs:{"aria-controls":"accordion-details-02","aria-expanded":"true"},on:{click:function(s){return e.showSummaryDetails(t)}}},[s("span",{staticClass:"slds-icon_container",attrs:{title:"show config details"}},[s("svg",{staticClass:"slds-accordion__summary-action-icon slds-button__icon_large slds-button__icon_left",staticStyle:{fill:"darkgray"},attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#switch"}})])])]),e._v(" "),s("div",{staticClass:"slds-col slds-text-heading_small"},[s("strong",[e._v(e._s(e._f("decode")(t.summaryname)))])]),e._v(" "),s("Checkbox",{attrs:{id:"checkbox",labels:t.isactive?{name:"Active"}:{name:"Inactive"},slide:""},on:{changed:function(s){return e.setSummaryActiveState(t.isactive,t.id,t.summaryname)}},model:{value:t.isactive,callback:function(s){e.$set(t,"isactive",s)},expression:"summary.isactive"}}),e._v(" "),s("ActionMenu",[s("ButtonIcon",{staticClass:"slds-m-left_small",attrs:{slot:"button",variant:"border-filled",size:"x-small",iconCategory:"utility",iconName:"down"},slot:"button"}),e._v(" "),s("ActionMenuItem",{attrs:{label:"Generate Historical Summaries"},on:{click:function(s){return e.showGenerateSummaries(t)}}}),e._v(" "),s("ActionMenuItem",{attrs:{label:"Edit"},on:{click:function(s){return e.showSummaryConfig("edit",t)}}}),e._v(" "),s("ActionMenuItem",{attrs:{label:"Clone"},on:{click:function(s){e.showSummaryConfig("clone",JSON.parse(JSON.stringify(t)))}}}),e._v(" "),t.openErrorCount>0?s("ActionMenuItem",{attrs:{label:"View Errors"},on:{click:function(s){return e.showSummaryConfig("errors",t)}}}):e._e(),e._v(" "),s("li",{staticClass:"slds-has-divider_top-space",attrs:{role:"separator"}}),e._v(" "),s("ActionMenuItem",{staticClass:"red-text",attrs:{label:"Delete"},on:{click:function(s){return e.showDeleteConfig(t)}}})],1)],1)]),e._v(" "),s("div",{staticClass:"slds-accordion__content",attrs:{id:"accordion-details-01","aria-hidden":"false"}},[s("div",{staticClass:"slds-card__body slds-card__body_inner slds-m-around_xx-small"},[s("div",{staticClass:"slds-grid slds-gutters"},[s("div",{staticClass:"slds-col"},[s("div",{staticClass:"slds-form-element slds-m-bottom_small"},[s("label",{staticClass:"slds-form-element__label",attrs:{for:"select-01"}},[e._v("Live Layer")]),e._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{staticClass:"slds-input",attrs:{id:"text-input-id-"+a,type:"text",readonly:""},domProps:{value:t.livelayername}})])]),e._v(" "),s("div",{staticClass:"slds-form-element slds-m-bottom_small"},[s("label",{staticClass:"slds-form-element__label",attrs:{for:"select-01"}},[e._v("Device Count")]),e._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{staticClass:"slds-input",attrs:{id:"text-input-id-"+a+"-1",type:"text",readonly:""},domProps:{value:t.devicecount}})])]),e._v(" "),s("div",{staticClass:"slds-form-element slds-m-bottom_small"},[s("label",{staticClass:"slds-form-element__label",attrs:{for:"select-01"}},[e._v("Description")]),e._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{staticClass:"slds-input",attrs:{id:"text-input-id-"+a+"-2",type:"text",readonly:""},domProps:{value:t.summarydesc}})])])]),e._v(" "),s("div",{staticClass:"slds-col"},[s("div",{staticClass:"slds-form-element slds-m-bottom_small"},[s("label",{staticClass:"slds-form-element__label",attrs:{for:"select-01"}},[e._v("Created Date")]),e._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{staticClass:"slds-input",attrs:{id:"text-input-id-"+a+"-3",type:"text",readonly:""},domProps:{value:e.$moment(t.createddate).format("MM/DD/YYYY")}})])]),e._v(" "),s("div",{staticClass:"slds-form-element slds-m-bottom_small"},[s("label",{staticClass:"slds-form-element__label",attrs:{for:"select-01"}},[e._v("Created By")]),e._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{staticClass:"slds-input",attrs:{id:"text-input-id-"+a+"-4",type:"text",readonly:""},domProps:{value:t.createdby}})])])])])])])])])])])])}))],2)}),[],!1,null,null,null).exports,{MAToastMessages:u}=window,g={components:{Checkbox:l.XZ,Spinner:l.$j},data:()=>({isLoading:!1,tableRows:[],tableColumns:["DEVICE ID","ERROR TYPE","REPORT DATE","TIMESTAMP","DETAILS","ADDITIONAL INFO"],sortTableBy:null,sortDirection:null,selectAllRows:!1,selectedRowCount:0}),computed:{...(0,a.mapState)({store__summaryConfig:"summaryConfig",store__summaryErrors:"summaryErrors"}),sortedRows(){const e=this.tableRows;return e.sort(((e,t)=>(e=e[this.sortTableBy]||"",t=t[this.sortTableBy]||"","ascending"===this.sortDirection?e<t?-1:e>t?1:0:"descending"===this.sortDirection?e>t?-1:e<t?1:0:null))),e},selectedErrors(){const e=[];return this.sortedRows.forEach((t=>{t.checked&&e.push(t.Id)})),e}},watch:{"store__summaryErrors.ignoreErrors":{async handler(e){e&&(await this.ignoreErrors(),this.store__summaryErrors.ignoreErrors=!1)},deep:!0},"store__summaryErrors.reRunSummaries":{async handler(e){e&&(await this.reRunSummaries(),this.store__summaryErrors.reRunSummaries=!1)},deep:!0},selectedErrors:{handler(e){e&&(this.store__summaryErrors.selectedErrors=e.length)}}},async created(){this.store__summaryConfig.configData.id&&await this.getSummaryErrors()},methods:{selectAll(e){this.sortedRows.forEach((t=>{t.checked=e}))},sortClick(e){const t={"DEVICE ID":"DeviceId__c","ERROR TYPE":"ErrorType__c","REPORT DATE":"ReportDate__c",TIMESTAMP:"CreatedDate",DETAILS:"Message__c","ADDITIONAL INFO":"StackTrace__c"};this.sortTableBy!==t[e]&&(this.sortTableBy=t[e],this.sortDirection="ascending"),"ascending"===this.sortDirection?this.sortDirection="descending":"descending"===this.sortDirection&&(this.sortDirection="ascending")},async getSummaryErrors(){try{this.isLoading=!0;const{success:e,errors:t}=await(0,o.wX)("maps.LiveRemoteFunctions.GetSummaryErrors",[this.store__summaryConfig.configData.id]);e||u.showError({position:"toast-top-right",message:"Error",subMessage:"Could not retrieve summary errors.",timeOut:8e3}),t.forEach((e=>{e.checked=!1})),this.tableRows=t}catch(e){u.showError({position:"toast-top-right",message:"Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}return null},async ignoreErrors(){if(this.selectedErrors&&this.selectedErrors.length>0)try{this.isLoading=!0;const{success:e,message:t}=await(0,o.wX)("maps.LiveRemoteFunctions.complete",[this.selectedErrors]);e||u.showError({position:"toast-top-right",message:"Error",subMessage:"Could not mark errors as complete.",timeOut:8e3}),u.showSuccess({position:"toast-top-right",message:"Success",subMessage:t,timeOut:8e3}),await this.getSummaryErrors()}catch(e){u.showError({position:"toast-top-right",message:"Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}else u.showWarning({position:"toast-top-right",message:"Notice",subMessage:"Select at least one error to mark completed.",timeOut:8e3});return null},async reRunSummaries(){if(this.selectedErrors&&this.selectedErrors.length>0){for(const e of this.selectedErrors)await this.reRunSummary(e);u.showSuccess({position:"toast-top-right",message:"Success",subMessage:"Summary re-run in progress.",timeOut:8e3}),await this.getSummaryErrors()}else u.showWarning({position:"toast-top-right",message:"Notice",subMessage:"Please select at least one error to re-run a summary for.",timeOut:8e3});return null},async reRunSummary(e){try{this.isLoading=!0;const{success:t}=await(0,o.wX)("maps.LiveRemoteFunctions.ReRunSummaryBasedOnLiveAsyncErrorId",[e]);t||u.showError({position:"toast-top-right",message:"Error",subMessage:`Could not mark error ${e} as complete.`,timeOut:8e3})}catch(e){u.showError({position:"toast-top-right",message:"Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}}}},_=(0,c.Z)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.isLoading?a("Spinner"):e._e(),e._v(" "),a("div",{staticClass:"slds-p-around--medium"},[a("div",{staticClass:"slds-table_header-fixed_container",staticStyle:{"border-top":"1px solid rgb(221, 219, 218)",height:"100%"}},[a("div",{staticClass:"slds-table_header-fixed_scroller",staticStyle:{height:"100%",overflow:"auto"}},[a("table",{staticClass:"slds-table slds-table_fixed-layout slds-table_header-fixed slds-table_resizable-cols slds-table_bordered slds-table_striped",attrs:{id:"TABLEHEADER","aria-multiselectable":"true",role:"grid"}},[a("thead",[a("tr",{staticClass:"slds-line-height_reset"},[a("th",{staticClass:"slds-text-align_right",staticStyle:{height:"0px","line-height":"0",width:"3.25rem"},attrs:{scope:"col"}},[a("div",{staticClass:"slds-cell-fixed",staticStyle:{display:"flex","flex-flow":"row nowrap",left:"0px",width:"52px"}},[a("div",{staticClass:"slds-th__action slds-th__action_form",staticStyle:{"line-height":"1",width:"100%"}},[a("Checkbox",{attrs:{id:"select-all",hideLabel:""},on:{changed:e.selectAll},model:{value:e.selectAllRows,callback:function(t){e.selectAllRows=t},expression:"selectAllRows"}})],1)])]),e._v(" "),e._l(e.tableColumns,(function(t,i){return a("th",{key:i,staticClass:"slds-is-sortable",class:{"slds-is-sorted":e.sortTableBy==t.toLowerCase(),"slds-is-sorted_asc":"ascending"==e.sortDirection},staticStyle:{height:"0px","line-height":"0"},attrs:{"aria-label":t,"aria-sort":e.sortDirection,scope:"col"},on:{click:function(s){return e.sortClick(t)}}},[a("a",{staticClass:"slds-th__action slds-text-link_reset",staticStyle:{display:"flex",height:"0px",overflow:"hidden","padding-bottom":"0px","padding-top":"0px",visibility:"hidden",border:"1px solid blue"},attrs:{href:"javascript:void(0)",role:"button",tabindex:"0"}},[a("span",{staticClass:"slds-assistive-text"},[e._v("sort this column ")]),e._v(" "),a("span",{staticClass:"slds-truncate",attrs:{title:"Name"}},[e._v("\n                                        Status\n                                    ")]),e._v(" "),a("Icon",{attrs:{src:s(7097),iconClass:["slds-is-sortable__icon","slds-icon","slds-icon_x-small","slds-icon-text-default"],"aria-hidden":"true"}}),e._v(" "),a("span",{staticClass:"slds-assistive-text",attrs:{"aria-live":"assertive","aria-atomic":"true"}},[e._v("\n                                        "+e._s(e.$Labels.Sort_By)+"\n                                    ")])],1),e._v(" "),a("div",{staticClass:"slds-cell-fixed",staticStyle:{display:"flex","flex-flow":"row nowrap"}},[a("a",{staticClass:"slds-th__action slds-text-link_reset",staticStyle:{"align-items":"center",display:"flex",flex:"1 1 auto","line-height":"1.25",width:"100%"},attrs:{href:"javascript:void(0)",role:"button",tabindex:"0"}},[a("span",{staticClass:"slds-assistive-text"},[e._v("sort this column ")]),e._v(" "),a("span",{staticClass:"slds-truncate",attrs:{title:t}},[e._v("\n                                            "+e._s(t)+"\n                                        ")]),e._v(" "),a("Icon",{attrs:{src:s(7097),iconClass:["slds-is-sortable__icon","slds-icon","slds-icon_x-small","slds-icon-text-default"],"aria-hidden":"true"}}),e._v(" "),a("span",{staticClass:"slds-assistive-text",attrs:{"aria-live":"assertive","aria-atomic":"true"}},[e._v("\n                                            desc\n                                        ")])],1)])])}))],2)]),e._v(" "),a("tbody",e._l(e.sortedRows,(function(t,s){return a("tr",{key:s,staticClass:"slds-hint-parent"},[a("td",{staticStyle:{width:"3.25rem"},attrs:{role:"gridcell"}},[a("Checkbox",{attrs:{id:"select-row-"+s,hideLabel:""},model:{value:t.checked,callback:function(s){e.$set(t,"checked",s)},expression:"row.checked"}})],1),e._v(" "),a("td",{attrs:{role:"gridcell"}},[a("div",{staticClass:"slds-truncate"},[a("a",{attrs:{href:"/"+t.Id,target:"_blank"}},[e._v(e._s(t.DeviceId__c))])])]),e._v(" "),a("td",{attrs:{role:"gridcell"}},[a("div",{staticClass:"slds-truncate"},[e._v("\n                                    "+e._s(t.ErrorType__c)+"\n                                ")])]),e._v(" "),a("td",{staticClass:"slds-cell-wrap",attrs:{role:"gridcell"}},[a("div",[e._v("\n                                    "+e._s(e.$moment(t.ReportDate__c).format("MM/DD/YYYY"))+"\n                                ")])]),e._v(" "),a("td",{staticClass:"slds-cell-wrap",attrs:{role:"gridcell"}},[a("div",[e._v("\n                                    "+e._s(e.$moment(t.CreatedDate).format("MM/DD/YYYY h:mm a"))+"\n                                ")])]),e._v(" "),a("td",{staticClass:"slds-cell-wrap",attrs:{role:"gridcell"}},[a("div",[e._v("\n                                    "+e._s(t.Message__c)+"\n                                ")])]),e._v(" "),a("td",{staticClass:"slds-cell-wrap",attrs:{role:"gridcell"}},[a("div",[e._v("\n                                    "+e._s(t.StackTrace__c)+"\n                                ")])])])})),0)])])])])],1)}),[],!1,null,null,null).exports,{MAToastMessages:h}=window,p={components:{Modal:l.u_,TextInput:l.oi,Tabs:l.mQ,Tab:l.OK,Picklist:l.Gp,Tooltip:l.u,Checkbox:l.XZ,SummaryErrors:_},data(){return{isLoading:!1,objectType:"",fieldName:"",queryLiveLayer:{selectedResult:"",selectedType:null,searchTerm:"",searches:[{options:e=>this.getLayers(e)}],setObjectType:()=>{this.objectType="",this.clearInvalidInput("queryLiveLayer.selectedResult")}},queryAssociatedLayer:{},lookupFields:{},simpleEvents:[],invalidInputs:[]}},computed:{...(0,a.mapState)({store__toggle:"toggle",store__summaryConfig:"summaryConfig",store__summaryErrors:"summaryErrors"})},async created(){await this.prepareAssociationLookupFields(),this.prepareSimpleEvents(),["edit","clone"].includes(this.store__summaryConfig.action)&&this.store__summaryConfig.configData&&this.populateModal(this.store__summaryConfig.configData)},methods:{getGUID:o.x$,closeModal(e){this.store__toggle.showSummaryConfig=!1,e&&(this.store__toggle.refresh=!0)},populateModal(e){if(e.livelayername&&(this.queryLiveLayer={...this.queryLiveLayer,searchTerm:e.livelayername,selectedResult:e.livelayername}),e.associations){const t=Object.keys(e.associations);t.length>0&&t.forEach((t=>{this.queryAssociatedLayer[t]={...this.queryAssociatedLayer[t],configid:e.associations[t].configid,searchTerm:e.associations[t].markerLayerName,layerId:e.associations[t].markerLayerid,selectedResult:e.associations[t].markerLayerName,distance:e.associations[t].maxdistance,distanceUnits:e.associations[t].maxdistunits}}))}},prepareSimpleEvents(){this.simpleEvents=[{sectionLabel:"Hard Braking",id:"createbrakingrec",isSelected:void 0===this.store__summaryConfig.configData.createbrakingrec||null===this.store__summaryConfig.configData.createbrakingrec||this.store__summaryConfig.configData.createbrakingrec,checkboxLabel:"Create Records for Hard Braking",checkboxTooltip:"Select this box to have a record created each time a Hard Braking event is captured."},{sectionLabel:"Hard Acceleration",id:"createaccelrec",isSelected:void 0===this.store__summaryConfig.configData.createaccelrec||null===this.store__summaryConfig.configData.createaccelrec||this.store__summaryConfig.configData.createaccelrec,checkboxLabel:"Create Records for Hard Acceleration",checkboxTooltip:"Select this box to have a record created each time a Hard Acceleration event is captured."},{sectionLabel:"Device Battery On",id:"createbattrec",isSelected:void 0===this.store__summaryConfig.configData.createbattrec||null===this.store__summaryConfig.configData.createbattrec||this.store__summaryConfig.configData.createbattrec,checkboxLabel:"Create Records for Device Battery On",checkboxTooltip:"Select this box to have a record created each time a Device Battery event is captured."},{sectionLabel:"Mileage By State",id:"createmilerec",isSelected:void 0===this.store__summaryConfig.configData.createmilerec||null===this.store__summaryConfig.configData.createmilerec||this.store__summaryConfig.configData.createmilerec,checkboxLabel:"Create Records for Mileage By State",checkboxTooltip:"Check this box to create a related record for mileage in each state."}]},getSimpleEventOption(e){let t=!1;return this.simpleEvents&&this.simpleEvents.forEach((s=>{s.id===e&&(t=s.isSelected)})),t},buildAssociations(e){const t={};return Object.keys(e).forEach((s=>{const a=e[s];t[s]={configid:a.configid?a.configid:void 0,markerlayerid:a.markerlayerid||a.markerLayerid?a.markerlayerid||a.markerLayerid:void 0,maxdistance:this.queryAssociatedLayer[s].distance?this.queryAssociatedLayer[s].distance.toString():void 0,maxdistunits:this.queryAssociatedLayer[s].distance&&""!==this.queryAssociatedLayer[s].distance.toString().trim()&&this.queryAssociatedLayer[s].distanceUnits?this.queryAssociatedLayer[s].distanceUnits:"miles"}})),t},async prepareAssociationLookupFields(){this.lookupFields=await this.getLookupFieldsMap(),this.lookupFields&&Object.keys(this.lookupFields).length>0&&Object.keys(this.lookupFields).forEach((e=>{this.queryAssociatedLayer[e]={...this.queryAssociatedLayer[e],configid:"",selectedResult:"",selectedType:null,layerId:null,distance:null,distanceUnits:"miles",searchTerm:"",searches:[{options:e=>this.getLayers(e)}],setObjectType:()=>{this.fieldName=e,this.objectType=this.lookupFields[e].objectType,this.clearInvalidInput(`queryAssociatedLayer[${e}].selectedResult`)}}}))},async getLookupFieldsMap(){try{this.isLoading=!0;const{success:e,data:t,error:s}=await(0,o.wX)("maps.LiveRemoteFunctions.getLookupFieldsMap",[]);return e?t.lookupFields:(h.showError({position:"toast-top-right",message:"Error",subMessage:s,timeOut:8e3}),null)}catch(e){h.showError({position:"toast-top-right",message:"Remoting Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}return null},async saveSummary(){try{this.isLoading=!0;const e=this.checkParams(this.store__summaryConfig.configData);if(e){const{success:t,message:s}=await(0,o.wX)("maps.LiveRemoteFunctions.saveSummary",[e]);return t?(h.showSuccess({position:"toast-top-right",message:"Success",subMessage:s,timeOut:8e3}),this.closeModal(!0),null):(h.showError({position:"toast-top-right",message:"Error",subMessage:s,timeOut:8e3}),null)}}catch(e){h.showError({position:"toast-top-right",message:"Remoting Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}return null},async getLayers(e){try{if(!e||""===e)throw new Error("Missing Required Param: searchTerm");return await this.searchLayers("marker",this.objectType,e)}catch(e){h.showError({position:"toast-top-right",message:`Error: ${e}.`,timeOut:8e3})}return null},async searchLayers(e,t,s){try{const a={ajaxResource:"TreeAJAXResources",action:"layer_search_by_type",searchterm:s,layerType:e},i=[],{success:r,data:l,error:n}=await(0,o.wX)("maps.RemoteFunctions.processAJAXRequest",[a]);return r||l.contents||h.showError({position:"toast-top-right",message:"Error",subMessage:n,timeOut:8e3}),l.contents.forEach((({properties:{record:s,nodetype:a,type:r}})=>{const o={label:s.Name,Id:s.Id,parentFolder:this.setFolderName(a,s),type:r};"shape"===e&&i.push(o),"marker"===e&&"live"===r&&i.push(o),s.maps__BaseObject__r&&"marker"===e&&s.maps__BaseObject__r.Name===t&&i.push(o)})),i}catch(e){h.showError({message:`Error: ${e}.`,timeOut:8e3})}return null},setFolderName(e,t){let s="";return t.maps__Folder__r?s=t.maps__Folder__r.Name:t.maps__ParentFolder__r?s=t.maps__ParentFolder__r.Name:t.maps__Folder__r?s=t.maps__Folder__r.Name:/(Personal)/.test(e)?s="Personal":/(Corporate)/.test(e)&&(s="Corporate"),s},clearSearch(e){e?(this.queryAssociatedLayer[e]={...this.queryAssociatedLayer[e],configid:"",selectedResult:"",selectedType:null,layerId:null,distance:null,distanceUnits:"miles",searchTerm:""},this.store__summaryConfig.configData.associations[e]={...this.store__summaryConfig.configData.associations[e],markerlayerid:"",markerLayerid:"",markerLayerName:"",maxdistance:null,maxdistunits:"miles"}):(this.queryLiveLayer={...this.queryLiveLayer,searchTerm:"",selectedResult:""},this.store__summaryConfig.configData={...this.store__summaryConfig.configData,livelayerid:"",livelayername:""})},selectedLayer(e){e&&e.Id&&(""!==this.fieldName?(this.queryAssociatedLayer[this.fieldName]={...this.queryAssociatedLayer[this.fieldName],selectedResult:e.label,selectedType:e.type,layerId:e.Id},this.store__summaryConfig.configData.associations[this.fieldName]||(this.store__summaryConfig.configData.associations[this.fieldName]={...this.store__summaryConfig.configData.associations[this.fieldName]}),this.$set(this.store__summaryConfig.configData.associations[this.fieldName],"markerlayerid",e.Id),this.$set(this.store__summaryConfig.configData.associations[this.fieldName],"markerLayerName",e.label)):"live"===e.type&&(this.$set(this.queryLiveLayer,"selectedResult",e.label),this.$set(this.queryLiveLayer,"selectedType",e.type),this.$set(this.store__summaryConfig.configData,"livelayerid",e.Id),this.$set(this.store__summaryConfig.configData,"livelayername",e.label)))},showValidationError(e,t,s){return h.showError({position:"toast-top-right",message:"Validation Error",subMessage:e.message,timeOut:8e3}),t&&this.invalidInputs.push(t),s&&(this.store__summaryConfig.activeTab=s),null},isNumber:e=>null!=e&&("string"!=typeof e||""!==e.trim())&&!Number.isNaN(Number(e.toString().replace(/[,.$]/g,""))),checkValidity(e){return this.invalidInputs.includes(e)},clearInvalidInput(e){return this.invalidInputs.splice(this.invalidInputs.indexOf(e),1)},checkParams(e){const t={id:e.id?e.id:void 0,anyduration:!!e.anyduration&&e.anyduration,associations:e.associations?this.buildAssociations(e.associations):{},distmeas:e.distmeas?e.distmeas.toString():"",disttime:e.disttime?e.disttime.toString():"",distval:e.distval?e.distval.toString():"",drivetripoptim:e.drivetripoptim?e.drivetripoptim.toString():"Vehicle Tracking",isactive:!!e.isactive&&e.isactive,livelayerid:e.livelayerid?e.livelayerid:"",livelayername:e.livelayername?e.livelayername:"",speedingtoggle:!!e.speedingtoggle&&e.speedingtoggle,speedlimitover:e.speedlimitover?e.speedlimitover.toString():"",speedlimittime:e.speedlimittime?e.speedlimittime.toString():"",speedlimitunits:e.speedlimitunits?e.speedlimitunits:"",speedthreshtoggle:!!e.speedthreshtoggle&&e.speedthreshtoggle,speedthreshunits:e.speedthreshunits?e.speedthreshunits:"",speedthreshval:e.speedthreshval?e.speedthreshval.toString():"",stoptoggle:!!e.stoptoggle&&e.stoptoggle,summarydesc:e.summarydesc?e.summarydesc:"",summaryname:e.summaryname?e.summaryname:"",threshtime:e.threshtime?e.threshtime.toString():"",createspeedrec:!!e.createspeedrec&&e.createspeedrec,createspeedthreshrec:!!e.createspeedthreshrec&&e.createspeedthreshrec,createstoprec:!!e.createstoprec&&e.createstoprec,createbrakingrec:this.getSimpleEventOption("createbrakingrec"),createaccelrec:this.getSimpleEventOption("createaccelrec"),createbattrec:this.getSimpleEventOption("createbattrec"),createmilerec:this.getSimpleEventOption("createmilerec")},s={};if(""===t.summaryname)return s.message="You have not entered a name for this Summary. Please enter a name in the 'Details' tab.",this.showValidationError(s,"summaryname","details"),!1;if(""===t.livelayerid)return s.message="You must choose a Live Layer. Please select one in the 'Live Layer' tab.",this.showValidationError(s,"queryLiveLayer.selectedResult","liveLayer"),!1;if(t.stoptoggle){if(""===t.distval)return s.message="The 'Distance' field for 'Stop' definition cannot be empty.",this.showValidationError(s,"distval","events"),!1;if(!this.isNumber(t.distval))return s.message="The 'Distance' field for 'Stop' definition must be a number.",this.showValidationError(s,"distval","events"),!1;if(Number(t.distval)<=0)return s.message="The 'Distance' field for 'Stop' definition must be greater than 0.",this.showValidationError(s,"distval","events"),!1;if(""===t.disttime)return s.message="The 'Duration' field for 'Stop' definition cannot be empty.",this.showValidationError(s,"disttime","events"),!1;if(!this.isNumber(t.disttime))return s.message="The 'Duration' field for 'Stop' definition must be a number.",this.showValidationError(s,"disttime","events"),!1;if(Number(t.disttime)<=0)return s.message="The 'Duration' field for 'Stop' definition must be greater than 0.",this.showValidationError(s,"disttime","events"),!1;if(this.queryAssociatedLayer&&Object.keys(this.queryAssociatedLayer).length>0)for(const e of Object.keys(this.queryAssociatedLayer)){const t=this.queryAssociatedLayer[e];if(t){if(t.layerId&&(""!==t.layerId||null!=t.layerId)){if(""===t.distance||null==t.distance)return s.message=`Since you selected a 'Marker Layer' for the '${e}' record Stop Associations, the 'Distance' field for your definition cannot be empty.`,this.showValidationError(s,`association[${e}].maxdistance`,"events"),!1;if(!this.isNumber(t.distance))return s.message=`The 'Distance' field for the '${e}' record Stop Associations definition must be a number.`,this.showValidationError(s,`association[${e}].maxdistance`,"events"),!1;if(Number(t.distance)<=0)return s.message=`The 'Distance' field for the '${e}' record Stop Associations definition must be greater than 0.`,this.showValidationError(s,`association[${e}].maxdistance`,"events"),!1;if(t.distanceUnits){if("feet"===t.distanceUnits&&Number(t.distance)<100)return s.message=`The 'Distance' field for the '${e}' record Stop Associations is limited to a minimun of 100 feet.`,this.showValidationError(s,`association[${e}].maxdistance`,"events"),!1;if("meters"===t.distanceUnits&&Number(t.distance)<30)return s.message=`The 'Distance' field for the '${e}' record Stop Associations is limited to a minimun of 30 meters.`,this.showValidationError(s,`association[${e}].maxdistance`,"events"),!1;if("miles"===t.distanceUnits&&Number(t.distance)<.02)return s.message=`The 'Distance' field for the '${e}' record Stop Associations is limited to a minimun of 0.02 miles.`,this.showValidationError(s,`association[${e}].maxdistance`,"events"),!1;if("kilometers"===t.distanceUnits&&Number(t.distance)<.03)return s.message=`The 'Distance' field for the '${e}' record Stop Associations is limited to a minimun of 0.03 kilometers.`,this.showValidationError(s,`association[${e}].maxdistance`,"events"),!1}}if(t.distance&&(""!==t.distance||null!=t.distance)&&(""===t.layerId||null==t.layerId))return s.message=`Since you entered a 'Distance' value for the '${e}' record Stop Associations, the 'Marker Layer' for your definition cannot be empty.`,this.showValidationError(s,`queryLiveLayer[${e}].selectedResult`,"events"),!1}}}if(t.speedingtoggle){if(""===t.speedlimitover)return s.message="The 'Amount Over Speed Limit' field for the 'Speeding' definition cannot be empty.",this.showValidationError(s,"speedlimitover","events"),!1;if(!this.isNumber(t.speedlimitover))return s.message="The 'Amount Over Speed Limit' field for the 'Speeding' definition must be a number.",this.showValidationError(s,"speedlimitover","events"),!1;if(Number(t.speedlimitover)<=0)return s.message="The 'Amount Over Speed Limit' field for 'Speeding' definition must be greater than 0.",this.showValidationError(s,"speedlimitover","events"),!1;if(!t.anyduration&&""===t.speedlimittime)return s.message="The 'Amount Of Time' field for 'Speeding' definition cannot be empty.",this.showValidationError(s,"speedlimittime","events"),!1;if(!t.anyduration&&!this.isNumber(t.speedlimittime))return s.message="The 'Amount Of Time' field for 'Speeding' definition must be a number.",this.showValidationError(s,"speedlimittime","events"),!1;if(!t.anyduration&&Number(t.speedlimittime)<=0)return s.message="The 'Amount Of Time' field for 'Speeding' definition must be greater than 0.",this.showValidationError(s,"speedlimittime","events"),!1}if(t.speedthreshtoggle){if(""===t.speedthreshval)return s.message="The 'Speed Meets or Exceeds' amount field for 'Speed Threshold' definition cannot be empty.",this.showValidationError(s,"speedthreshval","events"),!1;if(!this.isNumber(t.speedthreshval))return s.message="The 'Speed Meets or Exceeds' amount field for 'Speed Threshold' definition must be a number.",this.showValidationError(s,"speedthreshval","events"),!1;if(Number(t.speedthreshval)<=0)return s.message="The 'Speed Meets or Exceeds' amount field for 'Speed Threshold' definition must be greater than 0.",this.showValidationError(s,"speedthreshval","events"),!1;if(""===t.threshtime)return s.message="The 'Duration' field for 'Speed Threshold' definition cannot be empty.",this.showValidationError(s,"threshtime","events"),!1;if(!this.isNumber(t.threshtime))return s.message="The 'Duration' field for 'Speed Threshold' definition must be a number.",this.showValidationError(s,"threshtime","events"),!1;if(Number(t.threshtime)<=0)return s.message="The 'Duration' field for 'Speed Threshold' definition must be greater than 0.",this.showValidationError(s,"threshtime","events"),!1}return JSON.stringify(t)}}},v=(0,c.Z)(p,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{staticClass:"daily-summary-modal",attrs:{title:"errors"!==e.store__summaryConfig.activeTab?"Summary Configuration":"Summary Errors",isLoading:e.isLoading,isLarge:""},on:{close:function(t){return e.closeModal(!1)}}},["errors"===e.store__summaryConfig.activeTab?s("div",{attrs:{slot:"tagline"},slot:"tagline"},[e._v("\n        "+e._s(e.store__summaryConfig.configData.summaryname)+"\n    ")]):e._e(),e._v(" "),"errors"!==e.store__summaryConfig.activeTab?s("div",{staticClass:"daily-summary-content",attrs:{slot:"content"},slot:"content"},[s("Tabs",{staticClass:"content",attrs:{activeTabId:e.store__summaryConfig.activeTab,isVertical:!0,defaultTabId:"details"},on:{"update:activeTabId":function(t){return e.$set(e.store__summaryConfig,"activeTab",t)},"update:active-tab-id":function(t){return e.$set(e.store__summaryConfig,"activeTab",t)}}},["errors"!==e.store__summaryConfig.activeTab?s("Tab",{attrs:{id:"details",title:"Details"}},[s("div",[s("div",{staticClass:"slds-container_small slds-m-bottom_medium",staticStyle:{width:"100%"}},[s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"slds-form--compound"},[s("TextInput",{attrs:{id:"summary_name",type:"text",labels:{name:"Summary Name",placeholder:"Enter Summary Name"},required:!0,isInvalid:e.checkValidity("summaryname")},on:{changed:function(t){return e.clearInvalidInput("summaryname")}},model:{value:e.store__summaryConfig.configData.summaryname,callback:function(t){e.$set(e.store__summaryConfig.configData,"summaryname",t)},expression:"store__summaryConfig.configData.summaryname"}}),e._v(" "),s("TextInput",{attrs:{id:"summary_description",useTextArea:!0,type:"text",labels:{name:"Summary Description"}},model:{value:e.store__summaryConfig.configData.summarydesc,callback:function(t){e.$set(e.store__summaryConfig.configData,"summarydesc",t)},expression:"store__summaryConfig.configData.summarydesc"}})],1)])]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:function(t){e.store__summaryConfig.activeTab="liveLayer"}}},[e._v("\n                        Next\n                    ")])])]):e._e(),e._v(" "),"errors"!==e.store__summaryConfig.activeTab?s("Tab",{attrs:{id:"liveLayer",title:"Live Layer"}},[s("div",[s("div",[s("h3",{staticClass:"slds-text-heading--small slds-m-bottom_small"},[e._v("Select the Maps Live Layer you want to apply this summary to.")]),e._v(" "),s("p",{staticClass:"slds-m-bottom_medium"},[e._v("\n                            Don't have a Maps Live Layer? "),s("a",{attrs:{href:"/apex/Maps",target:"_blank"}},[e._v("Open Maps and create one.")])])]),e._v(" "),s("div",{staticClass:"slds-container_small slds-m-bottom_medium",staticStyle:{width:"100%"}},[s("div",{staticClass:"slds-grid slds-grid_vertical-align-end"},[s("Picklist",{ref:"treeLayerSearch",staticClass:"slds-col slds-size_1-of-2",class:{"slds-has-error":e.checkValidity("queryLiveLayer.selectedResult")},attrs:{options:e.queryLiveLayer.searches,filterable:"",labels:{name:"Maps Live layer",search:e.$Labels.MA_Search_for+"...",noSearchResults:e.$Labels.MA_NO_RESULTS_FOUND,placeholder:"Search for Live Layers"},required:"",idKey:"Id",titleKey:"label",helpText:"The Maps Live Layer contains the devices your events will apply to. You can set up Maps Live Layers in Maps."},on:{changed:function(t){return e.queryLiveLayer.setObjectType()},clear:e.clearSearch,"selected-option":e.selectedLayer},scopedSlots:e._u([{key:"result",fn:function(t){return s("span",{staticClass:"slds-listbox__option-text_entity slds-listbox__option slds-listbox__option_plain slds-grid",attrs:{id:"listbox-option-unique-id-01"}},[s("div",[s("div",{staticClass:"slds-text-body_small"},[e._v(e._s(e._f("decode")(t.result.label)))]),e._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical-align-center"},[s("Icon",{attrs:{category:"doctype",name:"folder"}}),e._v(" "),s("span",{staticClass:"slds-text-color_weak slds-text-body_small"},[e._v(e._s(t.result.parentFolder))])],1)])])}}],null,!1,3006367235),model:{value:e.queryLiveLayer.searchTerm,callback:function(t){e.$set(e.queryLiveLayer,"searchTerm",t)},expression:"queryLiveLayer.searchTerm"}}),e._v(" "),e.queryLiveLayer.selectedResult?s("div",{staticClass:"slds-m-left_small",attrs:{id:"devicelayer_malink"}},[s("a",{staticClass:"slds-button slds-button_icon slds-button_icon-border-filled slds-align--absolute-center",attrs:{href:"/apex/maps__Maps?layerid="+e.store__summaryConfig.configData.livelayerid,target:"_blank"}},[s("Icon",{attrs:{category:"utility",name:"location",iconClass:["slds-button__icon"],size:"x-small"}}),e._v(" "),s("Tooltip",{attrs:{text:"Open in Maps",assitiveText:"Open in Maps"}})],1)]):s("div",{staticStyle:{display:"inline",width:"32px"}})],1)]),e._v(" "),s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(t){e.store__summaryConfig.activeTab="details"}}},[e._v("\n                        Previous\n                    ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:function(t){e.store__summaryConfig.activeTab="events"}}},[e._v("\n                        Next\n                    ")])])]):e._e(),e._v(" "),"errors"!==e.store__summaryConfig.activeTab?s("Tab",{attrs:{id:"events",title:"Events"}},[s("div",[s("div",{staticClass:"slds-grid slds-grid_vertical",staticStyle:{width:"100%"}},[s("h3",{staticClass:"slds-text-heading--small slds-m-bottom_medium"},[e._v("\n                            Configure the events that will be included in this summary.\n                        ")]),e._v(" "),s("div",[s("div",{staticClass:"slds-section__title slds-grid slds-grid_vertical-align-center slds-theme--shade"},[s("span",{staticClass:"section-header-title slds-truncate slds-p-horizontal_small"},[e._v("Stops")]),e._v(" "),s("Checkbox",{staticClass:"slds-col--bump-left centered",attrs:{id:"checkbox",slide:"",labels:{name:e.store__summaryConfig.configData.stoptoggle?"Active":"Inactive"}},model:{value:e.store__summaryConfig.configData.stoptoggle,callback:function(t){e.$set(e.store__summaryConfig.configData,"stoptoggle",t)},expression:"store__summaryConfig.configData.stoptoggle"}})],1),e._v(" "),s("div",{staticClass:"slds-p-around--medium"},[s("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-gutters_direct-xxx-small slds-m-top--small"},[s("div",[e._v("Distance moved is less than")]),e._v(" "),s("TextInput",{staticClass:"slds-m-left--x-small short-input",attrs:{id:e.getGUID(),type:"number",disabled:!e.store__summaryConfig.configData.stoptoggle,isInvalid:e.checkValidity("distval")},on:{changed:function(t){return e.clearInvalidInput("distval")}},model:{value:e.store__summaryConfig.configData.distval,callback:function(t){e.$set(e.store__summaryConfig.configData,"distval",t)},expression:"store__summaryConfig.configData.distval"}}),e._v(" "),s("div",{staticClass:"slds-form-element slds-m-left--x-small"},[s("div",{staticClass:"slds-form-element__control"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.store__summaryConfig.configData.distmeas,expression:"store__summaryConfig.configData.distmeas"}],staticClass:"slds-select",attrs:{id:"unitSelector",name:"units",disabled:!e.store__summaryConfig.configData.stoptoggle},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.store__summaryConfig.configData,"distmeas",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"feet"}},[e._v("Feet")]),e._v(" "),s("option",{attrs:{value:"meters"}},[e._v("Meters")])])])]),e._v(" "),s("div",{staticClass:"slds-m-left--x-small"},[e._v("for more than")]),e._v(" "),s("TextInput",{staticClass:"slds-m-left--x-small short-input",attrs:{id:e.getGUID(),type:"number",disabled:!e.store__summaryConfig.configData.stoptoggle,isInvalid:e.checkValidity("disttime")},on:{changed:function(t){return e.clearInvalidInput("disttime")}},model:{value:e.store__summaryConfig.configData.disttime,callback:function(t){e.$set(e.store__summaryConfig.configData,"disttime",t)},expression:"store__summaryConfig.configData.disttime"}}),e._v(" "),s("div",{staticClass:"slds-m-left--x-small"},[e._v("minute(s)")]),e._v(" "),s("div",{staticClass:"slds-grid slds-m-left--x-small"},[s("Checkbox",{staticClass:"slds-col--bump-left centered",attrs:{id:e.getGUID(),disabled:!e.store__summaryConfig.configData.stoptoggle,labels:{name:"Create a record"}},model:{value:e.store__summaryConfig.configData.createstoprec,callback:function(t){e.$set(e.store__summaryConfig.configData,"createstoprec",t)},expression:"store__summaryConfig.configData.createstoprec"}}),e._v(" "),s("Tooltip",{attrs:{text:"Check this box to have a record created each time your stop definition is met.",assistiveText:"Check this box to have a record created each time your stop definition is met."}})],1)],1)]),e._v(" "),s("div",{staticClass:"slds-box slds-p-around--medium slds-m-top--small slds-m-bottom--large"},[s("div",{staticClass:"slds-grid slds-m-bottom--small"},[s("div",[e._v("Associate the closest record(s) to the stops using the following fields and marker layers")]),e._v(" "),s("div",{staticClass:"slds-grid slds-m-left--x-small"},[s("Tooltip",{attrs:{text:e.$Labels.SummaryConfig_Storing_GeoCoordinates_Tooltip,assistiveText:e.$Labels.SummaryConfig_Storing_GeoCoordinates_Tooltip}})],1)]),e._v(" "),e._l(Object.keys(e.lookupFields),(function(t,a){return s("div",{key:a,staticClass:"slds-grid slds-m-bottom--small"},[s("div",{staticClass:"slds-grid slds-col slds-grid_vertical-align-center"},[s("div",{staticClass:"slds-grid",staticStyle:{"min-width":"235px"}},[s("div",[e._v(e._s(e.lookupFields[t].label)+" Field using the ")])]),e._v(" "),e.store__summaryConfig.configData.stoptoggle?s("div",{staticClass:"slds-grid slds-m-left--x-small"},[s("Picklist",{ref:"treeLayerSearch",refInFor:!0,staticClass:"slds-col",class:{"slds-has-error":e.checkValidity("queryLiveLayer["+t+"].selectedResult")},attrs:{options:e.queryAssociatedLayer[t].searches,titleKey:"label",idKey:"Id",labels:{name:"",noSearchResults:"No Results Found",placeholder:"Search Marker Layers"},inputClasses:"slds-combobox__input",filterable:""},on:{clear:function(s){return e.clearSearch(t)},changed:function(s){return e.queryAssociatedLayer[t].setObjectType()},"selected-option":e.selectedLayer},scopedSlots:e._u([{key:"result",fn:function(t){return s("span",{staticClass:"slds-listbox__option-text_entity slds-listbox__option slds-listbox__option_plain slds-grid",attrs:{id:"listbox-option-unique-id-01"}},[s("div",[s("div",{staticClass:"slds-text-body_small"},[e._v(e._s(e._f("decode")(t.result.label)))]),e._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical-align-center"},[s("Icon",{attrs:{category:"doctype",name:"folder",iconClass:["slds-button__icon","slds-icon-text-light","slds-input__icon","slds-input__icon_right"]}}),e._v(" "),s("span",{staticClass:"slds-text-color_weak slds-text-body_small"},[e._v(" "+e._s(t.result.parentFolder))])],1)])])}}],null,!0),model:{value:e.queryAssociatedLayer[t].selectedResult,callback:function(s){e.$set(e.queryAssociatedLayer[t],"selectedResult",s)},expression:"queryAssociatedLayer[lookupFieldName].selectedResult"}}),e._v(" "),""!==e.queryAssociatedLayer[t].selectedResult?s("div",{staticStyle:{display:"inline"},attrs:{id:"devicelayer_malink"}},[s("a",{staticClass:"slds-button slds-button_icon slds-button_icon-border-filled slds-align--absolute-center",attrs:{href:"/apex/maps__Maps?layerid="+e.queryAssociatedLayer[t].layerId,target:"_blank"}},[s("Icon",{attrs:{category:"utility",name:"location",iconClass:["slds-button__icon"]}}),e._v(" "),s("Tooltip",{attrs:{text:"Open in Maps",assistiveText:"Open in Maps"}})],1)]):s("div",{staticStyle:{display:"inline",width:"32px"}})],1):s("div",{staticClass:"slds-grid slds-m-left--x-small"},[s("div",{staticClass:"slds-form-element__control slds-combobox__form-element slds-input-has-icon slds-input-has-icon_left-right"},[s("Icon",{attrs:{category:"utility",name:"search",iconClass:["slds-input__icon","slds-input__icon_left","slds-icon-text-default"]}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.queryAssociatedLayer[t].searchTerm,expression:"queryAssociatedLayer[lookupFieldName].searchTerm"}],staticClass:"slds-col slds-input",attrs:{type:"text",placeholder:"Search Marker Layers",disabled:""},domProps:{value:e.queryAssociatedLayer[t].searchTerm},on:{input:function(s){s.target.composing||e.$set(e.queryAssociatedLayer[t],"searchTerm",s.target.value)}}})],1),e._v(" "),""!==e.queryAssociatedLayer[t].selectedResult?s("div",{staticStyle:{display:"inline"},attrs:{id:"devicelayer_malink"}},[s("a",{staticClass:"slds-button slds-button_icon slds-button_icon-border-filled slds-align--absolute-center",attrs:{href:"/apex/maps__Maps?layerid="+e.queryAssociatedLayer[t].layerId,target:"_blank",disabled:""}},[s("Icon",{attrs:{category:"utility",name:"location",iconClass:["slds-button__icon"]}}),e._v(" "),s("Tooltip",{attrs:{text:"Open in Maps",assistiveText:"Open in Maps"}})],1)]):s("div",{staticStyle:{display:"inline",width:"32px"}})]),e._v(" "),s("div",{staticClass:"slds-grid slds-m-left--x-small"},[s("div",[e._v("layer within")])]),e._v(" "),s("TextInput",{staticClass:"slds-m-left--x-small short-input",attrs:{id:e.getGUID(),type:"number",disabled:!e.store__summaryConfig.configData.stoptoggle,isInvalid:e.checkValidity("association["+t+"].maxdistance")},on:{changed:function(s){return e.clearInvalidInput("association["+t+"].maxdistance")}},model:{value:e.queryAssociatedLayer[t].distance,callback:function(s){e.$set(e.queryAssociatedLayer[t],"distance",s)},expression:"queryAssociatedLayer[lookupFieldName].distance"}}),e._v(" "),s("div",{staticClass:"slds-form-element slds-m-left--x-small"},[s("div",{staticClass:"slds-form-element__control"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.queryAssociatedLayer[t].distanceUnits,expression:"queryAssociatedLayer[lookupFieldName].distanceUnits"}],staticClass:"slds-select",attrs:{id:"unitSelector",disabled:!e.store__summaryConfig.configData.stoptoggle,name:"units"},on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.queryAssociatedLayer[t],"distanceUnits",s.target.multiple?a:a[0])}}},[s("option",{attrs:{value:"miles"}},[e._v("Miles")]),e._v(" "),s("option",{attrs:{value:"kilometers"}},[e._v("Kilometers")]),e._v(" "),s("option",{attrs:{value:"feet"}},[e._v("Feet")]),e._v(" "),s("option",{attrs:{value:"meters"}},[e._v("Meters")])])])])],1)])}))],2)]),e._v(" "),s("div",[s("div",{staticClass:"slds-section__title slds-grid slds-grid_vertical-align-center slds-theme--shade"},[s("span",{staticClass:"section-header-title slds-truncate slds-p-horizontal--small"},[e._v(e._s(e.$Labels.LiveDriveTrips))])]),e._v(" "),s("div",{staticClass:"slds-box slds-box_xx-small slds-grid slds-grid_vertical-align-center slds-m-top--small"},[s("Icon",{attrs:{category:"utility",name:"info_alt",size:"small",iconClass:["slds-button__icon","slds-icon-text-light","slds-input__icon","slds-input__icon_right","slds-m-right_x-small"]}}),e._v(" "),s("p",[e._v(e._s(e.$Labels.LiveDriveTripHelp))])],1),e._v(" "),s("fieldset",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-p-around--small slds-p-bottom--small"},[s("div",{staticClass:"slds-form-element__control slds-grid"},[s("div",{staticClass:"slds-visual-picker slds-size_1-of-3"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.store__summaryConfig.configData.drivetripoptim,expression:"store__summaryConfig.configData.drivetripoptim"}],attrs:{id:"track-picker-1",type:"radio",value:"Vehicle Tracking",name:"Vehicle Tracking"},domProps:{checked:e._q(e.store__summaryConfig.configData.drivetripoptim,"Vehicle Tracking")},on:{change:function(t){return e.$set(e.store__summaryConfig.configData,"drivetripoptim","Vehicle Tracking")}}}),e._v(" "),s("label",{attrs:{for:"track-picker-1"}},[s("span",{staticClass:"slds-p-around--small slds-visual-picker__figure slds-visual-picker__text slds-align_absolute-center"},[s("span",{staticClass:"slds-m-right_small"},[s("Icon",{attrs:{category:"utility",name:"travel_and_places",size:"small",iconClass:["slds-input__icon","slds-icon-text-light"]}})],1),e._v(" "),s("span",{staticClass:"slds-border_left slds-text-align_left"},[s("span",{staticClass:"slds-text-heading_medium slds-m-bottom_x-small slds-m-left_x-small"},[e._v(e._s(e.$Labels.LiveTrackUsingOnBoard))]),e._v(" "),s("span",{staticClass:"slds-text-title slds-p-bottom--medium slds-m-left_x-small"},[e._v(e._s(e.$Labels.LiveTrackOnBoardHelp))])])]),e._v(" "),s("span",{staticClass:"slds-icon_container slds-visual-picker__text-check"},[s("svg",{staticClass:"slds-icon slds-icon-text-check slds-icon_x-small",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#check"}})])])])]),e._v(" "),s("div",{staticClass:"slds-visual-picker slds-size_1-of-3"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.store__summaryConfig.configData.drivetripoptim,expression:"store__summaryConfig.configData.drivetripoptim"}],attrs:{id:"track-picker-2",type:"radio",value:"Mobile Tracking",name:"Mobile Tracking"},domProps:{checked:e._q(e.store__summaryConfig.configData.drivetripoptim,"Mobile Tracking")},on:{change:function(t){return e.$set(e.store__summaryConfig.configData,"drivetripoptim","Mobile Tracking")}}}),e._v(" "),s("label",{attrs:{for:"track-picker-2"}},[s("span",{staticClass:"slds-p-around--small slds-visual-picker__figure slds-visual-picker__text slds-align_absolute-center"},[s("span",{staticClass:"slds-m-right_x-small"},[s("Icon",{attrs:{category:"utility",name:"phone_portrait",size:"small",iconClass:["slds-input__icon","slds-icon-text-light"]}})],1),e._v(" "),s("span",{staticClass:"slds-border_left slds-text-align_left"},[s("span",{staticClass:"slds-text-heading_medium slds-m-bottom_x-small slds-m-left_x-small"},[e._v(e._s(e.$Labels.LiveTrackUsingMobile))]),e._v(" "),s("span",{staticClass:"slds-text-title slds-m-left_x-small"},[e._v(e._s(e.$Labels.LiveTrackMobileHelp))])])]),e._v(" "),s("span",{staticClass:"slds-icon_container slds-visual-picker__text-check"},[s("svg",{staticClass:"slds-icon slds-icon-text-check slds-icon_x-small",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#check"}})])])])])])])])]),e._v(" "),s("div",[s("div",{staticClass:"slds-section__title slds-grid slds-grid_vertical-align-center slds-theme--shade"},[s("span",{staticClass:"section-header-title slds-truncate slds-p-horizontal_small"},[e._v("Speeding")]),e._v(" "),s("Checkbox",{staticClass:"slds-col--bump-left centered",attrs:{id:"checkbox",slide:"",labels:{name:e.store__summaryConfig.configData.speedingtoggle?"Active":"Inactive"}},model:{value:e.store__summaryConfig.configData.speedingtoggle,callback:function(t){e.$set(e.store__summaryConfig.configData,"speedingtoggle",t)},expression:"store__summaryConfig.configData.speedingtoggle"}})],1),e._v(" "),s("div",{staticClass:"slds-grid slds-p-around--medium"},[s("div",{staticClass:"slds-grid slds-grid_vertical-align-center"},[s("div",[e._v("Speed is greater than the posted speed limit by")]),e._v(" "),s("TextInput",{staticClass:"slds-m-left--x-small short-input",attrs:{id:e.getGUID(),type:"number",disabled:!e.store__summaryConfig.configData.speedingtoggle,isInvalid:e.checkValidity("speedlimitover")},on:{changed:function(t){return e.clearInvalidInput("speedlimitover")}},model:{value:e.store__summaryConfig.configData.speedlimitover,callback:function(t){e.$set(e.store__summaryConfig.configData,"speedlimitover",t)},expression:"store__summaryConfig.configData.speedlimitover"}}),e._v(" "),s("div",{staticClass:"slds-form-element slds-m-left--x-small"},[s("div",{staticClass:"slds-form-element__control"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.store__summaryConfig.configData.speedlimitunits,expression:"store__summaryConfig.configData.speedlimitunits"}],staticClass:"slds-select",attrs:{id:e.getGUID(),name:"units",disabled:!e.store__summaryConfig.configData.speedingtoggle},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.store__summaryConfig.configData,"speedlimitunits",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"mph"}},[e._v("MPH")]),e._v(" "),s("option",{attrs:{value:"kph"}},[e._v("KPH")])])])]),e._v(" "),s("div",{staticClass:"slds-form-element slds-m-left--x-small"},[s("div",{staticClass:"slds-form-element__control"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.store__summaryConfig.configData.anyduration,expression:"store__summaryConfig.configData.anyduration"}],staticClass:"slds-select",attrs:{id:e.getGUID(),disabled:!e.store__summaryConfig.configData.speedingtoggle,name:"units"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.store__summaryConfig.configData,"anyduration",t.target.multiple?s:s[0])}}},[s("option",{domProps:{value:!1}},[e._v("for more than")]),e._v(" "),s("option",{domProps:{value:!0}},[e._v("for any duration")])])])]),e._v(" "),e.store__summaryConfig.configData.anyduration?e._e():[s("TextInput",{staticClass:"slds-m-left--x-small short-input",attrs:{id:e.getGUID(),type:"number",disabled:!e.store__summaryConfig.configData.speedingtoggle,isInvalid:e.checkValidity("speedlimittime")},on:{changed:function(t){return e.clearInvalidInput("speedlimittime")}},model:{value:e.store__summaryConfig.configData.speedlimittime,callback:function(t){e.$set(e.store__summaryConfig.configData,"speedlimittime",t)},expression:"store__summaryConfig.configData.speedlimittime"}}),e._v(" "),s("div",{staticClass:"slds-m-left--x-small"},[e._v("minute(s)")])],e._v(" "),s("div",{staticClass:"slds-grid slds-m-left--x-small"},[s("Checkbox",{staticClass:"slds-col--bump-left centered",attrs:{id:e.getGUID(),disabled:!e.store__summaryConfig.configData.speedingtoggle,labels:{name:"Create a record"}},model:{value:e.store__summaryConfig.configData.createspeedrec,callback:function(t){e.$set(e.store__summaryConfig.configData,"createspeedrec",t)},expression:"store__summaryConfig.configData.createspeedrec"}}),e._v(" "),s("Tooltip",{attrs:{text:"Check this box to have a record created each time your speeding definition is met.",assistiveText:"Check this box to have a record created each time your speeding definition is met."}})],1)],2)])]),e._v(" "),s("div",[s("div",{staticClass:"slds-section__title slds-grid slds-grid_vertical-align-center slds-theme--shade"},[s("span",{staticClass:"section-header-title slds-truncate slds-p-horizontal--small"},[e._v("Speed Threshold")]),e._v(" "),s("Checkbox",{staticClass:"slds-col--bump-left centered",attrs:{id:"checkbox",slide:"",labels:{name:e.store__summaryConfig.configData.speedthreshtoggle?"Active":"Inactive"}},model:{value:e.store__summaryConfig.configData.speedthreshtoggle,callback:function(t){e.$set(e.store__summaryConfig.configData,"speedthreshtoggle",t)},expression:"store__summaryConfig.configData.speedthreshtoggle"}})],1),e._v(" "),s("div",{staticClass:"slds-grid slds-p-around--medium"},[s("div",{staticClass:"slds-grid slds-grid_vertical-align-center"},[s("div",[e._v("Speed meets or exceeds")]),e._v(" "),s("TextInput",{staticClass:"slds-m-left--x-small short-input",attrs:{id:e.getGUID(),type:"number",disabled:!e.store__summaryConfig.configData.speedthreshtoggle,isInvalid:e.checkValidity("speedthreshval")},on:{changed:function(t){return e.clearInvalidInput("speedthreshval")}},model:{value:e.store__summaryConfig.configData.speedthreshval,callback:function(t){e.$set(e.store__summaryConfig.configData,"speedthreshval",t)},expression:"store__summaryConfig.configData.speedthreshval"}}),e._v(" "),s("div",{staticClass:"slds-form-element slds-m-left--x-small"},[s("div",{staticClass:"slds-form-element__control"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.store__summaryConfig.configData.speedthreshunits,expression:"store__summaryConfig.configData.speedthreshunits"}],staticClass:"slds-select",attrs:{id:e.getGUID(),disabled:!e.store__summaryConfig.configData.speedthreshtoggle,name:"units"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.store__summaryConfig.configData,"speedthreshunits",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"mph"}},[e._v("MPH")]),e._v(" "),s("option",{attrs:{value:"kph"}},[e._v("KPH")])])])]),e._v(" "),s("div",{staticClass:"slds-m-left--x-small"},[e._v("for more than")]),e._v(" "),s("TextInput",{staticClass:"slds-m-left--x-small short-input",attrs:{id:e.getGUID(),type:"number",disabled:!e.store__summaryConfig.configData.speedthreshtoggle,isInvalid:e.checkValidity("threshtime")},on:{changed:function(t){return e.clearInvalidInput("threshtime")}},model:{value:e.store__summaryConfig.configData.threshtime,callback:function(t){e.$set(e.store__summaryConfig.configData,"threshtime",t)},expression:"store__summaryConfig.configData.threshtime"}}),e._v(" "),s("div",{staticClass:"slds-m-left--x-small"},[e._v("minute(s)")]),e._v(" "),s("div",{staticClass:"slds-grid slds-m-left--x-small"},[s("Checkbox",{staticClass:"slds-col--bump-left centered",attrs:{id:e.getGUID(),disabled:!e.store__summaryConfig.configData.speedthreshtoggle,labels:{name:"Create a record"}},model:{value:e.store__summaryConfig.configData.createspeedthreshrec,callback:function(t){e.$set(e.store__summaryConfig.configData,"createspeedthreshrec",t)},expression:"store__summaryConfig.configData.createspeedthreshrec"}}),e._v(" "),s("Tooltip",{attrs:{text:"Check this box to have a record created each time your speed treshold definition is met.",assistiveText:"Check this box to have a record created each time your speed treshold definition is met."}})],1)],1)]),e._v(" "),s("div",{staticClass:"slds-grid"},[s("p",{staticClass:"slds-p-left--medium slds-p-bottom--medium"},[e._v("This is a global value that is set on each record when saved.")])])]),e._v(" "),e._l(e.simpleEvents,(function(t,a){return s("div",{key:a},[s("div",{staticClass:"slds-section__title slds-grid slds-grid_vertical-align-center slds-theme--shade slds-m-top--medium"},[s("span",{staticClass:"section-header-title slds-truncate slds-p-horizontal_small"},[e._v(e._s(t.sectionLabel))])]),e._v(" "),s("div",{staticClass:"slds-grid slds-p-around_medium"},[s("Checkbox",{staticClass:"centered",attrs:{id:e.getGUID(),labels:{name:t.checkboxLabel}},model:{value:t.isSelected,callback:function(s){e.$set(t,"isSelected",s)},expression:"simpleEvent.isSelected"}}),e._v(" "),s("Tooltip",{attrs:{text:t.checkboxTooltip,assistiveText:t.checkboxTooltip}})],1)])}))],2),e._v(" "),s("button",{staticClass:"slds-button slds-button_neutral slds-m-top--large",on:{click:function(t){e.store__summaryConfig.activeTab="liveLayer"}}},[e._v("\n                        Previous\n                    ")])])]):e._e()],1)],1):s("div",{staticClass:"daily-summary-content",attrs:{slot:"content"},slot:"content"},[s("SummaryErrors")],1),e._v(" "),"errors"!==e.store__summaryConfig.activeTab?s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(t){return e.closeModal(!1)}}},[e._v("\n            Cancel\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.saveSummary}},[e._v("\n            Save\n        ")])]):s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(t){return e.closeModal(!1)}}},[e._v("\n            Cancel\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button--destructive",on:{click:function(t){e.store__summaryErrors.ignoreErrors=!0}}},[e._v("\n            Ignore "+e._s(e.store__summaryErrors.selectedErrors>0?"("+e.store__summaryErrors.selectedErrors+")":"")+"\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button--brand",on:{click:function(t){e.store__summaryErrors.reRunSummaries=!0}}},[e._v("\n            Re-Run Summary "+e._s(e.store__summaryErrors.selectedErrors>0?"("+e.store__summaryErrors.selectedErrors+")":"")+"\n        ")])])])}),[],!1,null,"c0064dac",null).exports,{MAToastMessages:f}=window,y={components:{Modal:l.u_,DatePicker:l.Mt},data(){return{isLoading:!1,startingDate:this.getCurrentDate(),endingDate:this.getCurrentDate(),lastValidStartingDate:null,lastValidEndingDate:null}},computed:{...(0,a.mapState)({store__toggle:"toggle",store__summaryConfig:"summaryConfig"})},methods:{closeModal(e){this.store__toggle.showGenerateSummaries=!1,e&&(this.store__toggle.refresh=!0)},async generateSummaries(){const e=this.checkParams();if(e){if(!confirm("Are you sure you want to re-run historical summaries? Re-running the summaries will delete these days existing summaries and associated records. Recalculation could cause triggers, process builders or flows to re-run at this time."))return this.closeModal(),null;try{this.isLoading=!0;const{success:t,message:s}=await(0,o.wX)("maps.LiveRemoteFunctions.genHistoricalSummary",[e]);t?(f.showSuccess({position:"toast-top-right",message:"Success",subMessage:"Your historical summaries are being generated.",timeOut:8e3}),this.closeModal(!0)):f.showError({position:"toast-top-right",message:"Error",subMessage:s,timeOut:8e3})}catch(e){f.showError({position:"toast-top-right",message:"Remoting Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}}return null},checkParams(){const e=this.startingDate,t=this.endingDate;return e?!!this.validateDateSelected(e,"start")&&(t?!!this.validateDateSelected(t,"end")&&[this.store__summaryConfig.configData.id,this.startingDate.format("YYYY,M,D"),this.endingDate.format("YYYY,M,D")]:(f.showError({position:"toast-top-right",message:"Missing Input",subMessage:"You must enter an end date.",timeOut:8e3}),!1)):(f.showError({position:"toast-top-right",message:"Missing Input",subMessage:"You must enter a start date.",timeOut:8e3}),!1)},validateDateSelected(e,t){e=e.startOf("day");const s=this.getCurrentDate().startOf("day"),a=this.getCurrentDate().subtract(60,"days").startOf("day");return e>s?(f.showError({position:"toast-top-right",message:"Validation Error",subMessage:"Cannot select a date in the future. Please adjust your starting and ending dates.",timeOut:8e3}),t&&"start"===t&&(null!=this.lastValidStartingDate?this.startingDate=this.lastValidStartingDate:this.startingDate=this.getCurrentDate()),t&&"end"===t&&(null!=this.lastValidEndingDate?this.endingDate=this.lastValidEndingDate:this.endingDate=this.getCurrentDate()),!1):a>e?(f.showError({position:"toast-top-right",message:"Validation Error",subMessage:"Cannot select a date older than 60 days in the past. Please adjust your starting and ending dates.",timeOut:8e3}),t&&"start"===t&&(null!=this.lastValidStartingDate?this.startingDate=this.lastValidStartingDate:this.startingDate=this.getCurrentDate()),t&&"end"===t&&(null!=this.lastValidEndingDate?this.endingDate=this.lastValidEndingDate:this.endingDate=this.getCurrentDate()),!1):("start"===t&&(this.lastValidStartingDate=e),"end"===t&&(this.lastValidEndingDate=e),!(null!=this.lastValidStartingDate&&null!=this.lastValidEndingDate&&this.lastValidStartingDate.valueOf()>this.lastValidEndingDate.valueOf()&&(f.showError({position:"toast-top-right",message:"Validation Error",subMessage:"Your end date cannot be before your start date. Please adjust your starting and ending dates.",timeOut:8e3}),1)))},getCurrentDate(){return this.$moment().tz(this.$User.timezoneId).locale(this.$User.UserLocale)}}},b=(0,c.Z)(y,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{staticClass:"generate",attrs:{title:"Generate Historical Summaries",isLoading:e.isLoading,hideCloseButton:e.isLoading},on:{close:function(t){return e.closeModal(!1)}}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-grid",staticStyle:{"min-height":"400px"}},[s("DatePicker",{staticClass:"slds-col",attrs:{dateFormat:e.$User.dateFormat.toUpperCase(),showInputField:!0,locale:e.$User.UserLocale,timezone:e.$User.timezoneId,labels:{name:"Starting Date"}},on:{changed:function(t){return e.validateDateSelected(t,"start")}},model:{value:e.startingDate,callback:function(t){e.startingDate=t},expression:"startingDate"}}),e._v(" "),s("DatePicker",{staticClass:"slds-col",attrs:{dateFormat:e.$User.dateFormat.toUpperCase(),showInputField:!0,locale:e.$User.UserLocale,timezone:e.$User.timezoneId,alignRight:!0,labels:{name:"Ending Date"}},on:{changed:function(t){return e.validateDateSelected(t,"end")}},model:{value:e.endingDate,callback:function(t){e.endingDate=t},expression:"endingDate"}})],1)]),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(t){return e.closeModal(!1)}}},[e._v("\n            Cancel\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.generateSummaries}},[e._v("\n            Generate\n        ")])])])}),[],!1,null,null,null).exports,{MAToastMessages:C}=window,x={components:{Modal:l.u_},data:()=>({isLoading:!1}),computed:{...(0,a.mapState)({store__toggle:"toggle",store__summaryConfig:"summaryConfig"})},methods:{closeModal(e){this.store__toggle.showDeleteConfig=!1,e&&(this.store__toggle.refresh=!0)},async deleteSummary(){try{const e=this.store__summaryConfig.configData.id;this.isLoading=!0;const{success:t,message:s}=await(0,o.wX)("maps.LiveRemoteFunctions.DeleteSummary",[e]);t?(C.showSuccess({position:"toast-top-right",message:"Success",subMessage:"Summary configuration deleted.",timeOut:8e3}),this.closeModal(!0)):C.showError({position:"toast-top-right",message:"Error",subMessage:s,timeOut:8e3})}catch(e){C.showError({position:"toast-top-right",message:"Remoting Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}return null}}},D={components:{Dashboard:m,SummaryConfig:v,GenerateSummaries:b,DeleteConfig:(0,c.Z)(x,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.store__toggle.showDeleteConfig?s("Modal",{attrs:{title:"Delete Summary Configuration",isLoading:e.isLoading,hideCloseButton:e.isLoading},on:{close:e.closeModal}},[s("div",{staticClass:"slds-text-body_regular slds-var-p-around_small",attrs:{slot:"content"},slot:"content"},[s("p",{staticStyle:{"text-align":"center"}},[e._v("\n            Are you sure you want to delete the summary configuration "),s("strong",[e._v(e._s(e.store__summaryConfig.configData.summaryname))]),e._v("?\n        ")])]),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.closeModal}},[e._v("\n            Cancel\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_destructive",on:{click:function(t){return e.deleteSummary()}}},[e._v("\n            Delete\n        ")])])]):e._e()}),[],!1,null,null,null).exports},computed:{...(0,a.mapState)({store__toggle:"toggle"})},beforeCreate(){this.$store=new(i().Store)(r)}},k=(0,c.Z)(D,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("Dashboard"),e._v(" "),e.store__toggle.showSummaryConfig?s("SummaryConfig"):e._e(),e._v(" "),e.store__toggle.showGenerateSummaries?s("GenerateSummaries"):e._e(),e._v(" "),e.store__toggle.showDeleteConfig?s("DeleteConfig"):e._e()],1)}),[],!1,null,null,null).exports}}]);