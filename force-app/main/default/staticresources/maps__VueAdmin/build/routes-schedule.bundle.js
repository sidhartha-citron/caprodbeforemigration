(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[8154],{9048:(e,t,s)=>{"use strict";s.d(t,{_:()=>i,a:()=>a});const i=(e,t)=>{if(e&&"object"==typeof e&&Array.isArray(t)){for(;t.length&&e;)e=e[t.shift()];return e}},a=(e,t="maps__")=>{try{const s=new Set(["marker","scatterMarker","clusterMarker","clusterGroup","workers","DeviceHistory","orderedPolyline","distanceLimitCircle","heatmapLayer"]);Object.entries(e).forEach((([i,o])=>{if(!s.has(i))if(i.startsWith(t)){const s=i.replace(t,"");e[s]=o,delete e[i],null!=e[s]&&"object"==typeof e[s]&&a(e[s],t)}else"object"==typeof o&&a(o,t)}))}catch(e){}return e}},553:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(8620);const a=e=>(0,i.RP)({type:"not"},((...t)=>!e(...t)))},8719:(e,t,s)=>{"use strict";s.d(t,{K:()=>r,x:()=>l});var i=s(5735),a=s.n(i),o=s(2423),n=s(5658);const r=async({sobject:e="",permissionsToCheck:t={isAccessible:!0},updateProgress:s=(()=>{}),includeDedicatedLookupOptions:i=!1})=>(async({sobject:e="",permissionsToCheck:t={isAccessible:!0},fieldIndex:s,progressCallback:i=(()=>{}),includeDedicatedLookupOptions:r=!1})=>{const{success:l=!1,data:d={},message:c}=await(0,n.wX)("RemoteFunctions.GetGlobalDescribeFields",[e,t,s,r],{escape:!1,buffer:!1});if(l){const{hasMore:s=!1,index:n,availableFields:r=[],totalSize:l=0}=d;if(s){let s=r;return await(async(e="",t={isAccessible:!0},s,i=(()=>{}))=>new Promise((n=>{let r=[];const l={status:"Running Batch",total:0,complete:0,success:0,failure:0},d=a()(((e,t)=>{const{object:s,limits:a,index:n}=e;((e="",t={isAccessible:!0},s)=>new Promise(((i,a)=>{(new o.Z).setAction("maps.RemoteFunctions.GetGlobalDescribeFields").setErrorHandler((e=>{a(new Error(e))})).invoke([e,t,s],(e=>{const{success:t=!1,data:s=[]}=e;t?i(s):(console.warn("Unable to get data from Salesforce."),a(new Error("Unable to get data from Salesforce (SFDC fields).")))}),{escape:!1,buffer:!1,timeout:45e3})})))(s,a,n).then((e=>{const{hasMore:t=!1,availableFields:i=[]}=e,o=e.index;t&&d.push({object:s,limits:a,index:o}),r=[...r,...i],l.success+=i.length})).catch((e=>{console.warn("schema error",e),l.failure++})).finally((()=>{l.complete++,i(l),t()}))}),1);d.push({object:e,limits:t,index:s}),d.drain=()=>{const e=r.sort(((e,t)=>e.label>t.label?1:-1));n(e)}})))(e,t,n,(e=>{e.total=l,i(e)})).then((e=>{s=[...s,...e]})),s}return r}throw console.warn("Unable to get data from Salesforce."),new Error(c)})({sobject:e,permissionsToCheck:t,fieldIndex:0,updateProgress:e=>{s(e)},includeDedicatedLookupOptions:i}),l=async(e={},t=!1,s=(()=>{}))=>{const i=e.hideExtraObjects||!1;let n;return await(async(e=!1,t=!0,s={},i=0,n=(()=>{}))=>new Promise(((r,l)=>{const d=i;(new o.Z).setAction("maps.RemoteFunctions.GetGlobalDescribeObjects").setErrorHandler((e=>{l(new Error(e))})).invoke([e,s,t,d],(async i=>{const{success:d=!1,data:c={}}=i;if(d){const{hasMore:i=!1,index:l,availableObjects:d=[],totalSize:u=0}=c;if(i){let i=d;await((e=!1,t=!0,s={},i=0,n=(()=>{}))=>new Promise((r=>{const l={status:"Running Batch",total:0,complete:0,success:0,failure:0};let d=[];const c=a()(((e,t)=>{const{removeExtra:s,limitedSet:i,limits:a,index:r}=e;((e=!1,t=!0,s={},i=0)=>new Promise(((a,n)=>{(new o.Z).setAction("maps.RemoteFunctions.GetGlobalDescribeObjects").setErrorHandler((e=>{n(new Error(e))})).invoke([e,s,t,i],(e=>{const{success:t=!1,data:s={}}=e;t?a(s):(console.warn("Unable to get data from Salesforce."),n(new Error("Unable to get data from Salesforce (SFDC objects).")))}),{escape:!1,buffer:!1})})))(s,i,a,r).then((e=>{const{hasMore:t=!1,availableObjects:o=[]}=e,n=e.index;t&&c.push({removeExtra:s,limitedSet:i,limits:a,index:n}),d=[...d,...o],l.success+=o.length})).catch((e=>{l.failure++,console.warn("schema error",e)})).finally((()=>{l.complete++,n(l),t()}))}),1);c.push({removeExtra:e,limitedSet:t,limits:s,index:i}),c.drain=()=>{const e=d.sort(((e,t)=>e.name>t.name?1:-1));r(e)}})))(e,t,s,l,(e=>{e.total=u,n(e)})).then((e=>{i=[...i,...e]})),r(i)}else r(d)}else console.warn("Unable to get data from Salesforce."),l(new Error("Unable to get data from Salesforce (SFDC objects)."))}),{escape:!1,buffer:!1})})))(i,t,e,0,(e=>{s(e)})).then((e=>{n=e})),n}},8137:e=>{e.exports='<svg xmlns=http://www.w3.org/2000/svg x=0px y=0px width=52px height=52px viewBox="0 0 52 52" enable-background="new 0 0 52 52" xml:space=preserve> <path fill=#FFFFFF d="M31,25.4L44,12.3c0.6-0.6,0.6-1.5,0-2.1L42,8.1c-0.6-0.6-1.5-0.6-2.1,0L26.8,21.2c-0.4,0.4-1,0.4-1.4,0\r\n\tL12.3,8c-0.6-0.6-1.5-0.6-2.1,0l-2.1,2.1c-0.6,0.6-0.6,1.5,0,2.1l13.1,13.1c0.4,0.4,0.4,1,0,1.4L8,39.9c-0.6,0.6-0.6,1.5,0,2.1\r\n\tl2.1,2.1c0.6,0.6,1.5,0.6,2.1,0L25.3,31c0.4-0.4,1-0.4,1.4,0l13.1,13.1c0.6,0.6,1.5,0.6,2.1,0l2.1-2.1c0.6-0.6,0.6-1.5,0-2.1\r\n\tL31,26.8C30.6,26.4,30.6,25.8,31,25.4z"/> </svg> '},6413:e=>{e.exports='<svg xmlns=http://www.w3.org/2000/svg x=0px y=0px width=52px height=52px viewBox="0 0 52 52" enable-background="new 0 0 52 52" xml:space=preserve> <path fill=#FFFFFF d="M26,2C12.8,2,2,12.8,2,26s10.8,24,24,24s24-10.8,24-24S39.2,2,26,2z M8,26c0-9.9,8.1-18,18-18\r\n\tc3.9,0,7.5,1.2,10.4,3.3L11.3,36.4C9.2,33.5,8,29.9,8,26z M26,44c-3.9,0-7.5-1.2-10.4-3.3c5.1-5.1,19.3-19.3,25.1-25.1\r\n\tC42.8,18.5,44,22.1,44,26C44,35.9,35.9,44,26,44z"/> </svg> '},8186:e=>{e.exports='<svg xmlns=http://www.w3.org/2000/svg x=0px y=0px width=52px height=52px viewBox="0 0 52 52" enable-background="new 0 0 52 52" xml:space=preserve> <path fill=#FFFFFF d="M26,2C12.7,2,2,12.7,2,26s10.7,24,24,24s24-10.7,24-24S39.3,2,26,2z M26,14.1c1.7,0,3,1.3,3,3s-1.3,3-3,3\r\n\ts-3-1.3-3-3S24.3,14.1,26,14.1z M31,35.1c0,0.5-0.4,0.9-1,0.9h-3c-0.4,0-3,0-3,0h-2c-0.5,0-1-0.3-1-0.9v-2c0-0.5,0.4-1.1,1-1.1l0,0\r\n\tc0.5,0,1-0.3,1-0.9v-4c0-0.5-0.4-1.1-1-1.1l0,0c-0.5,0-1-0.3-1-0.9v-2c0-0.5,0.4-1.1,1-1.1h6c0.5,0,1,0.5,1,1.1v8\r\n\tc0,0.5,0.4,0.9,1,0.9l0,0c0.5,0,1,0.5,1,1.1V35.1z"/> </svg> '},9718:e=>{e.exports='<svg xmlns=http://www.w3.org/2000/svg x=0px y=0px width=52px height=52px viewBox="0 0 52 52" enable-background="new 0 0 52 52" xml:space=preserve> <path fill=#FFFFFF d="M26,2C12.7,2,2,12.7,2,26s10.7,24,24,24s24-10.7,24-24S39.3,2,26,2z M39.4,20L24.1,35.5\r\n\tc-0.6,0.6-1.6,0.6-2.2,0L13.5,27c-0.6-0.6-0.6-1.6,0-2.2l2.2-2.2c0.6-0.6,1.6-0.6,2.2,0l4.4,4.5c0.4,0.4,1.1,0.4,1.5,0L35,15.5\r\n\tc0.6-0.6,1.6-0.6,2.2,0l2.2,2.2C40.1,18.3,40.1,19.3,39.4,20z"/> </svg> '},5953:e=>{e.exports='<svg xmlns=http://www.w3.org/2000/svg width=52 height=52 viewBox="0 0 52 52"><path fill=#fff d="m51.4 42.5l-22.9-37c-1.2-2-3.8-2-5 0l-22.9 37c-1.4 2.3 0 5.5 2.5 5.5h45.8c2.5 0 4-3.2 2.5-5.5z m-25.4-2.5c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z m3-9c0 0.6-0.4 1-1 1h-4c-0.6 0-1-0.4-1-1v-13c0-0.6 0.4-1 1-1h4c0.6 0 1 0.4 1 1v13z"></path></svg>'},6820:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>L});var i=s(3088),a=s(257),o=s(945),n=s(2766);const r={components:{Modal:n.u_},props:{doShow:{type:Boolean,required:!0}},data:()=>({error:null,isLoading:!1}),methods:{no(){this.$emit("update:doShow",!1)},yes(){this.isLoading=!0,(new a.Z).setAction("maps.CustomEventConfigController.setEventDefaults").setErrorHandler(this.handleRemoteActionError.bind(this)).invoke([],(e=>{e.success?(this.$emit("refresh"),this.no()):this.$root.$emit("toast",{message:e.error,state:"error"}),this.isLoading=!1}))},handleRemoteActionError(e,t){this.$root.$emit("toast",{message:t.message,state:"error"}),this.isLoading&&(this.isLoading=!1)}}};var l=s(1900);const d=(0,l.Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.doShow?s("Modal",{staticClass:"ma-standard-config-modal",attrs:{errorMsg:e.error,isLoading:e.isLoading,doDetach:!0,title:e.$Labels.Routes_Settings_Install_Standard_Config},on:{"update:errorMsg":function(t){e.error=t},"update:error-msg":function(t){e.error=t},"update:isLoading":function(t){e.isLoading=t},"update:is-loading":function(t){e.isLoading=t},close:e.no}},[s("div",{attrs:{slot:"content"},slot:"content"},[e.isLoading?e._e():s("div",[e._v("\n            "+e._s(e.$Labels.Routes_Settings_Create_Standard_Config)+"\n        ")])]),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.no}},[e._v("\n            "+e._s(e.$Labels.MA_No)+"\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.yes}},[e._v("\n            "+e._s(e.$Labels.MA_Yes)+"\n        ")])])]):e._e()}),[],!1,null,"5566f86c",null).exports;var c=s(9486),u=s(8719);class b{static getConfigById(e,t=(()=>{})){return new Promise(((s,i)=>{(new a.Z).setAction("maps.CustomEventConfigController.getConfigById").setErrorHandler((e=>{i(new Error(`Remote action exception: ${e.message}`))})).invoke([e],(async a=>{const{success:o=!1,config:n={}}=a;if(o){const{eventObjectAPI:o="",metadata:r={}}=n;try{const e=await b.getFieldsForConfig(o,(e=>{t(e)}));e.eventTypes=r.eventTypes||[],n.metadata=e,s(a)}catch(t){i(new Error(a.error||`Failed to load config record (${e}).`))}}else i(new Error(a.error||`Failed to load config record (${e}).`))}),{escape:!1,buffer:!1})}))}static getAllLookupsWithBaseObjects(e="",t=[]){return new Promise(((s,i)=>{(new a.Z).setAction("maps.CustomEventConfigController.getAllLookupsWithBaseObjects").setErrorHandler((e=>{i(new Error(`Remote action exception: ${e.message}`))})).invoke([e,t],(async t=>{const{success:a=!1,lookups:o=[]}=t;a?s(o):i(new Error(`Failed to load config lookups (${e}).`))}),{escape:!1,buffer:!1})}))}static async getFieldsForConfig(e,t=(()=>{})){return new Promise((async(s,i)=>{try{const i=await(0,u.K)({sobject:e,permissionsToCheck:{isAccessible:!0,isUpdateable:!0,isCreateable:!0},progressCallback:e=>t(e)}),a=await(0,u.K)({sobject:e,permissionsToCheck:{isAccessible:!0,isCreateable:!0},progressCallback:e=>t(e)}),o={booleanFields:[],dateTimeFields:[],numericFields:[],eventNameFields:[],resources:[],lookupAssociations:[]},n="event"===String(e).toLowerCase();for(let e=0;e<i.length;e++){const t=i[e],{apiName:s,label:a,isNameField:r,isAutoNumber:l,displayType:d=""}=t,c={api:s,label:a};switch(d){case"boolean":o.booleanFields.push(c);break;case"datetime":o.dateTimeFields.push(c);break;case"integer":case"double":o.numericFields.push(c);break;case"string":r&&l&&(c.label+=" (auto-number)"),o.eventNameFields.push(c);break;case"reference":o.resources.push(c)}if(n){const e=String(t.apiName).toLowerCase();"enddatetime"===e?o.endFieldLabel=t.label:"startdatetime"===e?o.startFieldLabel=t.label:"subject"===e?o.eventNameFieldLabel=t.label:"ownerid"===e&&(o.resourceFieldLabel=t.label)}}for(let e=0;e<a.length;e++){const t=a[e],{displayType:s=""}=t,i={api:t.apiName,label:t.label};"reference"===s&&o.lookupAssociations.push(i)}s(o)}catch(t){console.warn("Unable to get fields",t),i(new Error(`Unable to get fields for object: ${e}`))}}))}static getConfigMetadata(e,t=(()=>{})){return new Promise((async(s,i)=>{try{const i=await b.getFieldsForConfig(e,(e=>{e.total++,t(e)})),a=i.lookupAssociations.map((e=>e.api)),o=await b.getAllLookupsWithBaseObjects(e,a);t({complete:1,total:1}),i.lookups=o,s(i)}catch(t){i(new Error(`Failed to load config metadata (${e}).`))}}))}static getAllowableSObjectsWithActivities(e=!1,t=(()=>{})){return new Promise((async(s,i)=>{try{const i=await(0,u.x)({isAccessible:!0,isCustomSetting:!1,supportsActivities:!0,hideExtraObjects:!0},e,(e=>{t(e)})),a=[];for(let e=0;e<i.length;e++){const t=i[e];a.push({api:t.label,label:t.name,isStandard:t.isStandard})}s(a)}catch(e){i(new Error("Failed to load sObjects with activities."))}}))}static getAvailableSObjects(e=!1,t=(()=>{})){return new Promise((async(s,i)=>{try{const i=await(0,u.x)({isAccessible:!0,isCustomSetting:!1,hideExtraObjects:!0},e,(e=>{t(e)})),a=[];for(let e=0;e<i.length;e++){const t=i[e];a.push({api:t.label,label:t.name,isStandard:t.isStandard})}s(a)}catch(e){i(new Error("Failed to load sObjects."))}}))}static save(e){return new Promise(((t,s)=>{(new a.Z).setAction("maps.CustomEventConfigController.save").setErrorHandler((e=>{s(new Error(`Remote action exception: ${e.message}`))})).invoke([e],(e=>{e&&e.success?t(e.Id):s(new Error(e.error))}))}))}}const h={components:{Checkbox:n.XZ,Modal:n.u_,Picklist:n.Gp,Toasts:n.F1,Spinner:n.$j},validations:{sobject:{required:c.required}},data:()=>({doShow:!1,sobject:null,sobjectLabel:null,isLoading:!1,showAllSObjects:!1,metadata:{sobjects:[]},objectLoadingProgress:0,toasts:[]}),computed:{filteredSObjects(){return this.metadata.sobjects},progressStyle(){return{width:`${this.objectLoadingProgress}%`}}},watch:{showAllSObjects(){this.isLoading=!0,this.getAvailableSObjects().then((e=>{this.metadata.sobjects=e})).catch((e=>{console.warn(e)})).finally((()=>{this.isLoading=!1}))}},created(){this.$bus.$on("show-new-config-modal",this.showModal)},destroyed(){this.$bus.$off("show-new-config-modal")},methods:{objectSelected(e){this.sobjectLabel=e.label},showModal(){this.doShow=!0,this.isLoading=!0,this.getAvailableSObjects().then((e=>{this.metadata.sobjects=e,this.doShow=!0})).catch((e=>{console.warn(e)})).finally((()=>{this.isLoading=!1}))},confirm(){this.$v.$touch(),this.$v.$invalid?this.toasts.push({message:"All fields are required",state:"error"}):(this.$emit("confirm",{name:this.sobject,label:this.sobjectLabel}),this.close())},close(){this.$v.$reset(),Object.assign(this.$data,this.$options.data.apply(this))},getAvailableSObjects(){return new Promise(((e,t)=>{this.objectLoadingProgress=0,b.getAvailableSObjects(!this.showAllSObjects,(e=>{const{complete:t=0,total:s=0}=e,i=Math.round(t/s*100);this.objectLoadingProgress=i})).then((s=>{Array.isArray(s)?(s=s.filter((e=>"Event"!==e.api)),e(s)):t(new Error("Error loading sobjects."))})).catch((()=>{t(new Error("Error loading sobjects."))}))}))}}},p=(0,l.Z)(h,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.doShow?s("Modal",{attrs:{isLoading:e.isLoading,detach:!0,title:e.$Labels.Routes_Settings_Create_Custom_Config,size:"small"},on:{"update:isLoading":function(t){e.isLoading=t},"update:is-loading":function(t){e.isLoading=t},close:e.close}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("Toasts",{attrs:{toasts:e.toasts}}),e._v(" "),s("Spinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],staticClass:"slds-progress-bar slds-progress-bar_small",staticStyle:{position:"absolute",top:"0",left:"0"},attrs:{"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"25",role:"progressbar"}},[s("span",{staticClass:"slds-progress-bar__value",style:e.progressStyle},[s("span",{staticClass:"slds-assistive-text"},[e._v("Progress: 25%")])])]),e._v(" "),s("div",{attrs:{role:"listitem"}},[s("Picklist",{staticClass:"slds-p-vertical_xx-small",attrs:{options:e.filteredSObjects,isInvalid:e.$v.sobject.$error,required:!0,detach:!0,idKey:"api",titleKey:"label",labels:{name:e.$Labels.Salesforce_Object},filterable:""},on:{changed:e.$v.sobject.$touch,"selected-option":e.objectSelected},model:{value:e.sobject,callback:function(t){e.sobject=t},expression:"sobject"}})],1),e._v(" "),s("div",{staticClass:"slds-grid"},[s("div",[s("Checkbox",{attrs:{toggleBuffer:100,labels:{name:e.$Labels.MA_View_All_SF_Objects},slide:""},model:{value:e.showAllSObjects,callback:function(t){e.showAllSObjects=t},expression:"showAllSObjects"}})],1)])],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.close}},[e._v("\n            "+e._s(e.$Labels.MA_Cancel)+"\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.confirm}},[e._v("\n            "+e._s(e.$Labels.MA_Confirm)+"\n        ")])])]):e._e()}),[],!1,null,null,null).exports;var m=s(553),_=s(9048);const f={components:{Modal:n.u_},props:{recordId:{type:String,required:!0},isOpen:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},title:{type:String,default:"Delete"}},data:()=>({toast:""}),methods:{deleteRecord(){this.recordId?(this.$emit("update:isLoading",!0),this.close(),(new a.Z).setAction("maps.CustomEventConfigController.deleteRecord").setErrorHandler(this.handleRemoteActionError.bind(this)).invoke([this.recordId],(e=>{e&&!e.success&&(this.toast=e.error||`Failed to delete config (${this.recordId}).`),this.$emit("update:isLoading",!1),this.$emit("remove")}))):this.$emit("remove")},close(){this.$emit("update:isOpen",!1)},handleRemoteActionError(e,t,s){e?e(s.message):(this.isLoading&&this.$emit("update:isLoading",!1),this.toast=t.message||s.message)}}},v=(0,l.Z)(f,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isOpen?s("Modal",{attrs:{detach:!0,size:"small",title:e.title},on:{close:e.close}},[s("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n        "+e._s(e.$Labels.MA_Are_You_Sure)+"\n    ")]),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{ref:"closeButton",staticClass:"slds-button slds-button_neutral",on:{click:e.close}},[e._v("\n            "+e._s(e.$Labels.MA_Cancel)+"\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.deleteRecord}},[e._v("\n            "+e._s(e.$Labels.MA_Delete)+"\n        ")])])]):e._e()}),[],!1,null,null,null).exports,g={STANDARD:"standard",CUSTOM:"custom"},y={components:{Picklist:n.Gp,Checkbox:n.XZ,ConfigDeleteModal:v},props:{lookup:{type:Object,required:!0,validator:e=>e.metadata&&e.record&&Object.keys(e.record).length},sobjects:{type:Array,default:()=>[]},baseObjects:{type:Array,required:!0,default:()=>[]},isStandardBaseConfig:{type:Boolean,required:!0},isLoading:{type:Boolean,default:!1},guid:{type:String,required:!0},eventTypes:{type:Array,required:!1,default:()=>[]}},data(){return{storedBaseObjects:this.baseObjects,type:null,showDeleteModal:!1,record:{Id:"",Name:"",BaseObjectId__c:"",Enabled__c:!0,LookupFieldAPI__c:"",CalEventBaseObj__c:"",LocationSource__c:!1,TypeAPI__c:"Type",TypeDefaultValue__c:"",ObjectAPI__c:""}}},validations(){const e={record:{ObjectAPI__c:{},BaseObjectId__c:{}}};return this.disableInputs&&!this.lookup.isRelatedObject||(e.record.ObjectAPI__c={required:c.required},e.record.BaseObjectId__c={required:c.required},this.record.Enabled__c||(e.record.BaseObjectId__c={})),e},computed:{disableInputs(){return!this.storedBaseObjects.length},isStandard(){return this.type===g.STANDARD},isCustom(){return this.type===g.CUSTOM},_isLoading:{get(){return this.isLoading},set(e){this.$emit("update:isLoading",e)}}},watch:{"record.LocationSource__c"(e){e&&this.$bus.$emit("set-primary-location-to-false",this.guid)}},created(){this.$bus.$on("set-primary-location-to-false",this.setPrimaryToFalse),this.init()},destroyed(){this.$bus.$off("set-primary-location-to-false",this.setPrimaryToFalse)},methods:{init(){Object.keys(this.lookup.record||{}).forEach((e=>{this.record[e]=this.lookup.record[e]})),this.type=g[this.lookup.type.toUpperCase()]},deleteLookup(){this.showDeleteModal=!0},removeLookup(){this.$emit("remove-lookup",this.guid)},baseObjectChangeHandler(e){this.record.ObjectAPI__c=e.api},getMABaseObjects(e){this.record.Enabled__c=!1,this.record.TypeDefaultValue__c=null,e&&e.api?(this.$emit("update:isLoading",!0),(new a.Z).setAction("maps.CustomEventConfigController.getBaseObjectsBySObjectAPIs").setErrorHandler(this.handleRemoteActionError.bind(this)).invoke([e.api,this.lookup.eventObject],(t=>{t?this.storedBaseObjects=t.baseObjects:this.toast=t.error||`Failed to retrieve ma base objects. ${e.api}`,this.$emit("update:isLoading",!1)}))):this.storedBaseObjects=[]},setPrimaryToFalse(e){e!==this.guid&&(this.record.LocationSource__c=!1)},getRecord(){return this.record},handleRemoteActionError(e,t){this.isLoading&&this.$emit("update:isLoading",!1),this.toast=e.message||t.message}}},C=(0,l.Z)(y,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",[s("ConfigDeleteModal",{attrs:{recordId:e.record.Id||"",isOpen:e.showDeleteModal,isLoading:e._isLoading,title:e.$Labels.Delete_Custom_Event_Lookup},on:{"update:isOpen":function(t){e.showDeleteModal=t},"update:is-open":function(t){e.showDeleteModal=t},"update:isLoading":function(t){e._isLoading=t},"update:is-loading":function(t){e._isLoading=t},remove:e.removeLookup}}),e._v(" "),s("td",{staticClass:"events-enabled-column"},[s("Checkbox",{class:{"slds-m-bottom_x-small":e.disableInputs},attrs:{isDisabled:e.disableInputs,slide:"",hideLabel:""},model:{value:e.record.Enabled__c,callback:function(t){e.$set(e.record,"Enabled__c",t)},expression:"record.Enabled__c"}})],1),e._v(" "),e.lookup.isRelatedObject?s("td",[s("Picklist",{staticClass:"sobject-picklist",attrs:{showLabel:!1,options:e.sobjects,detach:!0,isInvalid:e.$v.record.ObjectAPI__c.$error,idKey:"api",titleKey:"label",filterable:""},on:{"selected-option":e.getMABaseObjects,changed:e.$v.record.ObjectAPI__c.$touch},model:{value:e.record.ObjectAPI__c,callback:function(t){e.$set(e.record,"ObjectAPI__c",t)},expression:"record.ObjectAPI__c"}})],1):s("td",[e._v("\n        "+e._s(e._f("decode")(e.lookup.label))+"\n    ")]),e._v(" "),s("td",{staticClass:"events-form-input-column"},[e.storedBaseObjects.length?s("Picklist",{attrs:{showLabel:!1,options:e.storedBaseObjects,detach:!0,isInvalid:e.$v.record.BaseObjectId__c.$error,idKey:"value",titleKey:"label",filterable:""},on:{changed:e.$v.record.BaseObjectId__c.$touch,"selected-option":e.baseObjectChangeHandler},model:{value:e.record.BaseObjectId__c,callback:function(t){e.$set(e.record,"BaseObjectId__c",t)},expression:"record.BaseObjectId__c"}}):s("div",[e._v("\n            "+e._s(e.$Labels.MA_No_Base_Objects)+"\n            "),e.$v.record.BaseObjectId__c.$error?s("div",{staticClass:"generic-error"},[e._v("\n                "+e._s(e.$Labels.MA_Field_Is_Required)+"\n            ")]):e._e()])],1),e._v(" "),e.isStandardBaseConfig?s("td",{staticClass:"events-form-input-column"},[s("Picklist",{attrs:{showLabel:!1,options:e.eventTypes,detach:!0,idKey:"value",titleKey:"label",filterable:""},model:{value:e.record.TypeDefaultValue__c,callback:function(t){e.$set(e.record,"TypeDefaultValue__c",t)},expression:"record.TypeDefaultValue__c"}})],1):e._e(),e._v(" "),e.isStandardBaseConfig||e.disableInputs?e._e():s("td",{staticClass:"events-primary-column slds-text-align_center"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-radio"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.record.LocationSource__c,expression:"record.LocationSource__c"}],attrs:{id:"radio-"+e.guid,type:"radio",name:"options"},domProps:{value:!0,checked:e._q(e.record.LocationSource__c,!0)},on:{change:function(t){return e.$set(e.record,"LocationSource__c",!0)}}}),e._v(" "),s("label",{staticClass:"slds-radio__label",attrs:{for:"radio-"+e.guid}},[s("span",{staticClass:"slds-radio_faux"}),e._v(" "),s("span",{staticClass:"slds-form-element__label"})])])])]),e._v(" "),e.isStandardBaseConfig?s("td",[e.isCustom?s("button",{staticClass:"slds-button slds-button_icon-container has-hover-tooltip",on:{click:e.deleteLookup}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-close"})]):s("div")]):e._e()],1)}),[],!1,null,"6b6988df",null).exports,$={components:{TextInput:n.oi,Checkbox:n.XZ,Picklist:n.Gp,Spinner:n.$j,Tooltip:n.u,RadioGroup:n.Ee,ConfigLookup:C,ConfigDeleteModal:v},props:{bootstrap:{type:Object,required:!0},index:{type:Number,required:!0}},data(){return{initialName:this.bootstrap.name,isLoading:!1,showDeleteModal:!1,options:{eventNameField:"",startField:"",endField:"",useDuration:null,durationField:"",durationUnit:"",resourceField:"",trackingField:"",exclusionField:""},record:{Id:null,Name:"",EventObject__c:null,Options__c:null,Type__c:null,Enabled__c:!0},type:null,eventObjectLabel:null,lookups:[],metadata:{resources:[],eventNameFields:[],dateTimeFields:[],numericFields:[],booleanFields:[],durationUnits:[this.$Labels.MA_seconds,this.$Labels.MA_minutes,this.$Labels.MA_hours],timeFieldOptions:[{label:this.$Labels.MA_Use_DateTime,value:!1},{label:this.$Labels.MA_Use_Duration,value:!0}],eventTypes:[],resourceFieldLabel:null,eventNameFieldLabel:null,startFieldLabel:null,endFieldLabel:null,availableObjects:[]},relatedObjectProgress:{loading:!1,style:{width:"0%"}},mainProgressStyle:{loading:!1,style:{width:"0%"}}}},validations(){const e={record:{Name:{required:c.required,maxLength:(0,c.maxLength)(80)},EventObject__c:{required:c.required}},options:{eventNameField:{required:c.required},startField:{required:c.required},resourceField:{required:c.required}}};return this.options.useDuration?(e.options.durationField={required:c.required},e.options.durationUnit={required:c.required}):(e.options.endField={required:c.required,notSameAsStart:(0,m.Z)((0,c.sameAs)("startField"))},e.options.startField.notSameAsEnd=(0,m.Z)((0,c.sameAs)("endField"))),e},computed:{isStandard(){return this.type===g.STANDARD},isCustom(){return this.type===g.CUSTOM},isNew(){return this.bootstrap.isNew}},watch:{"record.Name"(e){e||(e=this.initialName),this.$emit("update:bootstrap",Object.assign(this.bootstrap,{name:e}))}},created(){this.init()},methods:{init(){this.bootstrap.isNew&&this.bootstrap.sobject?(this.record.Name=this.bootstrap.name,this.record.EventObject__c=this.bootstrap.sobject,this.eventObjectLabel=this.bootstrap.label,this.type=g.CUSTOM,this.loadMetadata(this.bootstrap.sobject)):this.bootstrap.id?(this.record.Id=this.bootstrap.id,this.loadRecord(this.bootstrap.id)):this.$root.$emit("toast",{message:"Missing bootstrap data. Contact your administrator.",state:"error"})},loadMetadata(e){this.isLoading=!0,this.mainProgressStyle.style.width="0%",this.mainProgressStyle.loading=!0,b.getConfigMetadata(e,(e=>{const{complete:t=0,total:s=0}=e,i=Math.round(t/s*100);this.mainProgressStyle.style.width=`${i}%`})).then((t=>{this.type=g.CUSTOM,Object.keys(t).forEach((e=>{this.metadata[e]=t[e]}));let s=!1;t.lookups.forEach((t=>{const a=2===t.objects.length?"User":t.objects[0],o={metadata:{baseObjects:t.baseObjects},type:g.CUSTOM,guid:(0,i.x$)(),record:{LookupFieldAPI__c:t.api,ObjectAPI__c:a,Enabled__c:!1},label:t.label};e===a&&(o.metadata.baseObjects=t.CalEventBaseObjects),!s&&t.baseObjects.length&&(o.record.LocationSource__c=!0,s=!0),this.lookups.push(o)})),this.sortLookups(this.lookups)})).catch((e=>{console.warn(e)})).finally((()=>{this.isLoading=!1,this.mainProgressStyle.loading=!1}))},loadRecord(e){this.isLoading=!0,this.mainProgressStyle.style.width="0%",this.mainProgressStyle.loading=!0,b.getConfigById(e,(e=>{const{complete:t=0,total:s=0}=e,i=Math.round(t/s*100);this.mainProgressStyle.style.width=`${i}%`})).then((t=>{if(!t.success)return this.type=g.CUSTOM,void this.$root.$emit("toast",{message:t.error||`An error occured while fetching config for ${e}.`,state:"error"});const s=(0,_.a)(t.config,"maps__");if(s.record){Object.keys(s.record).forEach((e=>{this.record[e]=s.record[e]}));const e=JSON.parse(this.record.Options__c)||{};Object.keys(e).forEach((t=>{this.options[t]=e[t]}))}Object.keys(s.metadata).forEach((e=>{this.metadata[e]=s.metadata[e]})),this.type=g[s.type.toUpperCase()],this.eventObjectLabel=s.eventObjectLabel,s.lookups=s.lookups.map((e=>{const{baseObjects:t=[],CalEventBaseObjects:a=[]}=e.metadata;return e.metadata.baseObjects=t,e.record.ObjectAPI__c===s.record.EventObject__c&&(e.metadata.baseObjects=a),e.guid=(0,i.x$)(),e})),this.sortLookups(s.lookups),this.lookups=s.lookups})).catch((e=>{console.warn(e.message),this.type=g.CUSTOM,this.$root.$emit("toast",{message:"An error occurred while fetching and processing the config record.",state:"error"})})).finally((()=>{this.isLoading=!1,this.mainProgressStyle.loading=!1}))},sortLookups(e){e.sort(((e,t)=>e.label===this.$Labels.MA_This_Object?-1:t.label===this.$Labels.MA_This_Object?1:e.metadata&&e.metadata.baseObjects&&e.metadata.baseObjects.length?t.metadata.baseObjects.length?1:-1:1))},removeConfig(){this.$emit("deleteConfig",this.index)},openDeleteModal(){this.showDeleteModal=!0},save(){this.$v.$touch();let e=this.$v.$invalid;if(this.$children.forEach((t=>{t.$v&&"object"==typeof t.$v&&"function"==typeof t.$v.$touch&&(t.$v.$touch(),!e&&t.$v.$invalid&&(e=!0))})),e)this.$root.$emit("toast",{message:"Please fix validation issues before saving.",state:"error"});else{this.isLoading=!0,this.options.useDuration?this.options.endField=null:(this.options.durationField=null,this.options.durationUnit=null);try{this.record.Options__c=JSON.stringify(this.options);const e=[];this.$children.forEach((t=>{if("function"==typeof t.getRecord){const s=t.getRecord();""===s.Id&&delete s.Id,e.push({record:s})}}));const t={record:this.record,lookups:e};b.save(t).then((e=>{this.lookups=[],e&&(e!==this.bootstrap.id?(this.$emit("update:bootstrap",Object.assign(this.bootstrap,{id:e,isNew:!1})),this.$bus.$emit("update-tabid",e)):this.init())})).catch((e=>{this.$root.$emit("toast",{message:e.error||`Failed to save config (${this.id}).`,state:"error"})})).finally((()=>{this.isLoading=!1}))}catch(e){console.warn(e),this.isLoading=!1}}},removeLookup(e){this.lookups=this.lookups.filter((t=>t.guid!==e))},addRelatedObject(){this.isLoading=!0,this.relatedObjectProgress.loading=!0,this.relatedObjectProgress.style.width="0%",b.getAllowableSObjectsWithActivities(!1,(e=>{const{complete:t=0,total:s=0}=e,i=Math.round(t/s*100);this.relatedObjectProgress.style.width=`${i}%`})).then((e=>{Array.isArray(e)?this.lookups.push({metadata:{sobjects:this.filterUsedRelatedObjects(e),baseObjects:[]},type:g.CUSTOM,guid:(0,i.x$)(),eventObject:this.record.EventObject__c,isRelatedObject:!0,record:this.record}):this.$root.$emit("toast",{message:e.error||"Failed to retrieve objects with activity support.",state:"error"})})).finally((()=>{this.isLoading=!1,this.relatedObjectProgress.loading=!1}))},filterUsedRelatedObjects(e){const t=[];return e.forEach((e=>{let s=!1;this.lookups.forEach((t=>{t.record&&t.record.ObjectAPI__c===e.api&&(s=!0)})),s||t.push(e)})),t},handleRemoteActionError(e,t,s){e?e(s.message):(this.isLoading&&(this.isLoading=!1),this.$root.$emit("toast",{message:t.message||s.message,state:"error"}))}}},w=(0,l.Z)($,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-is-relative"},[e.isLoading?s("Spinner"):e._e(),e._v(" "),s("ConfigDeleteModal",{attrs:{recordId:e.record.Id||"",isOpen:e.showDeleteModal,isLoading:e.isLoading,title:e.$Labels.MA_Delete_Custom_Event},on:{"update:isOpen":function(t){e.showDeleteModal=t},"update:is-open":function(t){e.showDeleteModal=t},"update:isLoading":function(t){e.isLoading=t},"update:is-loading":function(t){e.isLoading=t},remove:e.removeConfig}}),e._v(" "),e.mainProgressStyle.loading?s("div",{staticClass:"slds-progress-bar slds-progress-bar_small",staticStyle:{position:"absolute",top:"-16px",left:"0"},attrs:{"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"25",role:"progressbar"}},[s("span",{staticClass:"slds-progress-bar__value",style:e.mainProgressStyle.style},[s("span",{staticClass:"slds-assistive-text"},[e._v("Progress: 25%")])])]):e._e(),e._v(" "),s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"slds-text-heading_medium"},[e._v("\n            "+e._s(e.$Labels.MA_Event_Obj_Config)+"\n        ")]),e._v(" "),s("div",{staticClass:"slds-col"}),e._v(" "),e.isCustom?s("div",{staticClass:"slds-m-right_small"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:e.openDeleteModal}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-delete"})])]):e._e(),e._v(" "),s("div",{staticClass:"slds-form-element slds-m-right_small"},[s("Checkbox",{attrs:{showStateLabels:!0,labels:{stateOn:e.$Labels.enabled,stateOff:e.$Labels.disabled},slide:"",hideLabel:""},model:{value:e.record.Enabled__c,callback:function(t){e.$set(e.record,"Enabled__c",t)},expression:"record.Enabled__c"}})],1),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_success",on:{click:e.save}},[e._v("\n                "+e._s(e.$Labels.MA_Save)+"\n            ")])])]),e._v(" "),s("div",{staticClass:"slds-grid slds-wrap slds-container_medium slds-m-bottom_large"},[s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-2",attrs:{role:"listitem"}},[s("TextInput",{staticClass:"slds-p-vertical_xx-small",attrs:{required:!0,isInvalid:e.$v.record.Name.$error,labels:{name:e.$Labels.MA_Name}},on:{changed:e.$v.record.Name.$touch},model:{value:e.record.Name,callback:function(t){e.$set(e.record,"Name",t)},expression:"record.Name"}},[s("div",{attrs:{slot:"errors"},slot:"errors"},[e.$v.record.Name.maxLength?e._e():s("div",[e._v("\n                        Maximum length of 80 characters allowed.\n                    ")]),e._v(" "),e.$v.record.Name.required?e._e():s("div",[e._v("\n                        "+e._s(e.$Labels.MA_Field_Is_Required)+"\n                    ")])])])],1),e._v(" "),s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-2",attrs:{role:"listitem"}},[s("div",{staticClass:"slds-form-element slds-p-vertical_xx-small"},[s("label",{staticClass:"slds-form-element__label"},[e._v(e._s(e.$Labels.Salesforce_Object))]),e._v(" "),s("div",[e._v(e._s(e.eventObjectLabel))])])]),e._v(" "),s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-2",attrs:{role:"listitem"}},[e.isCustom?s("Picklist",{attrs:{options:e.metadata.resources,detach:!0,required:!0,isInvalid:e.$v.options.resourceField.$error,labels:{name:e.$Labels.MA_Sched_Resource},idKey:"api",titleKey:"label",filterable:""},on:{changed:e.$v.options.resourceField.$touch},model:{value:e.options.resourceField,callback:function(t){e.$set(e.options,"resourceField",t)},expression:"options.resourceField"}}):e._e(),e._v(" "),e.isStandard?s("div",{staticClass:"slds-form-element slds-p-vertical_xx-small"},[s("label",{staticClass:"slds-form-element__label"},[e._v(e._s(e.$Labels.MA_Sched_Resource))]),e._v(" "),s("div",[e._v(e._s(e.metadata.resourceFieldLabel))])]):e._e()],1),e._v(" "),s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-2",attrs:{role:"listitem"}},[e.isCustom?s("Picklist",{attrs:{options:e.metadata.eventNameFields,detach:!0,required:!0,isInvalid:e.$v.options.eventNameField.$error,labels:{name:e.$Labels.MA_Event_Name_Field},idKey:"api",titleKey:"label",filterable:""},on:{changed:e.$v.options.eventNameField.$touch},model:{value:e.options.eventNameField,callback:function(t){e.$set(e.options,"eventNameField",t)},expression:"options.eventNameField"}}):e._e(),e._v(" "),e.isStandard?s("div",{staticClass:"slds-form-element slds-p-vertical_xx-small"},[s("label",{staticClass:"slds-form-element__label"},[e._v(e._s(e.$Labels.MA_Event_Name_Field))]),e._v(" "),s("div",[e._v(e._s(e.metadata.eventNameFieldLabel))])]):e._e()],1),e._v(" "),e.isCustom?s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-1",attrs:{role:"listitem"}},[s("RadioGroup",{attrs:{name:"time-options",options:e.metadata.timeFieldOptions,label:e.$Labels.MA_Time_Fields},model:{value:e.options.useDuration,callback:function(t){e.$set(e.options,"useDuration",t)},expression:"options.useDuration"}})],1):e._e(),e._v(" "),s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-2",attrs:{role:"listitem"}},[e.isCustom?s("Picklist",{attrs:{options:e.metadata.dateTimeFields,detach:!0,required:!0,isInvalid:e.$v.options.startField.$error,labels:{name:e.$Labels.MA_Start_DateTime_Field},idKey:"api",titleKey:"label",filterable:""},on:{changed:e.$v.options.startField.$touch},model:{value:e.options.startField,callback:function(t){e.$set(e.options,"startField",t)},expression:"options.startField"}},[s("div",{attrs:{slot:"errors"},slot:"errors"},[e.$v.options.startField.required?e._e():s("div",[e._v("\n                        "+e._s(e.$Labels.MA_Field_Is_Required)+"\n                    ")]),e._v(" "),e.$v.options.startField.notSameAsStart?e._e():s("div",[e._v("\n                        This field must be different than the End DateTime Field.\n                    ")])])]):e._e(),e._v(" "),e.isStandard?s("div",{staticClass:"slds-form-element slds-p-vertical_xx-small"},[s("label",{staticClass:"slds-form-element__label"},[e._v(e._s(e.$Labels.MA_Start_DateTime_Field))]),e._v(" "),s("div",[e._v(e._s(e.metadata.startFieldLabel))])]):e._e()],1),e._v(" "),e.isStandard||!e.options.useDuration?s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-2",attrs:{role:"listitem"}},[e.isCustom?s("Picklist",{attrs:{options:e.metadata.dateTimeFields,detach:!0,required:!0,isInvalid:e.$v.options.endField.$error,labels:{name:e.$Labels.MA_End_DateTime_Field},idKey:"api",titleKey:"label",filterable:""},on:{changed:e.$v.options.endField.$touch},model:{value:e.options.endField,callback:function(t){e.$set(e.options,"endField",t)},expression:"options.endField"}},[s("div",{attrs:{slot:"errors"},slot:"errors"},[e.$v.options.endField.required?e._e():s("div",[e._v("\n                        "+e._s(e.$Labels.MA_Field_Is_Required)+"\n                    ")]),e._v(" "),e.$v.options.endField.notSameAsStart?e._e():s("div",[e._v("\n                        This field must be different than the Start DateTime Field.\n                    ")])])]):e._e(),e._v(" "),e.isStandard?s("div",{staticClass:"slds-form-element slds-p-vertical_xx-small"},[s("label",{staticClass:"slds-form-element__label"},[e._v(e._s(e.$Labels.MA_End_DateTime_Field))]),e._v(" "),s("div",[e._v(e._s(e.metadata.endFieldLabel))])]):e._e()],1):e._e(),e._v(" "),e.isCustom&&e.options.useDuration?s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-4",attrs:{role:"listitem"}},[s("Picklist",{attrs:{options:e.metadata.numericFields,detach:!0,required:!0,isInvalid:e.$v.options.durationField.$error,labels:{name:e.$Labels.MA_Duration_Field},idKey:"api",titleKey:"label",filterable:""},on:{changed:e.$v.options.durationField.$touch},model:{value:e.options.durationField,callback:function(t){e.$set(e.options,"durationField",t)},expression:"options.durationField"}})],1):e._e(),e._v(" "),e.isCustom&&e.options.useDuration?s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-4",attrs:{role:"listitem"}},[s("Picklist",{attrs:{options:e.metadata.durationUnits,detach:!0,required:!0,isInvalid:e.$v.options.durationUnit.$error,labels:{name:e.$Labels.MA_UNITS},filterable:""},on:{changed:e.$v.options.durationUnit.$touch},model:{value:e.options.durationUnit,callback:function(t){e.$set(e.options,"durationUnit",t)},expression:"options.durationUnit"}})],1):e._e(),e._v(" "),s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-2",attrs:{role:"listitem"}},[s("Picklist",{attrs:{options:e.metadata.booleanFields,detach:!0,labels:{name:e.$Labels.Routes_Settings_Track_Usage},idKey:"api",titleKey:"label",filterable:""},model:{value:e.options.trackingField,callback:function(t){e.$set(e.options,"trackingField",t)},expression:"options.trackingField"}})],1),e._v(" "),s("div",{staticClass:"slds-has-flexi-truncate slds-p-horizontal_medium slds-size_1-of-2",attrs:{role:"listitem"}},[s("label",{staticClass:"slds-form-element__label slds-align-middle"},[e._v("\n                "+e._s(e.$Labels.Routes_Settings_Exclude_Specific_Records)+"\n                "),s("a",{staticClass:"inline-block",attrs:{href:"https://help.salesforce.com/articleView?id=salesforce_maps_intro.htm&type=5",target:"_blank"}},[s("Tooltip",{staticClass:"slds-p-left_x-small",attrs:{showIcon:!0,text:e.$Labels.Routes_Settings_Exclude_Specific_Records_Tooltip,assistiveText:e.$Labels.Routes_Settings_Exclude_Specific_Records_Tooltip}})],1)]),e._v(" "),s("Picklist",{attrs:{options:e.metadata.booleanFields,detach:!0,idKey:"api",titleKey:"label",filterable:""},model:{value:e.options.exclusionField,callback:function(t){e.$set(e.options,"exclusionField",t)},expression:"options.exclusionField"}})],1)]),e._v(" "),s("div",{staticClass:"slds-grid slds-m-horizontal_medium"},[s("div",{staticClass:"slds-box slds-theme_shade"},[s("div",{staticClass:"slds-p-bottom_medium slds-text-heading_medium"},[e._v("\n                "+e._s(e.$Labels.MA_Related_Object_Config)+"\n            ")]),e._v(" "),s("div",[s("table",{staticClass:"custom-events-mapping-table"},[s("thead",[s("tr",[s("th",{staticClass:"events-enabled-column custom-event-table-header"},[e._v("\n                                "+e._s(e.$Labels.enabled)+"\n                            ")]),e._v(" "),s("th",{staticClass:"custom-event-table-header"},[e._v(e._s(e.isStandard?e.$Labels.MA_OBJECT:e.$Labels.MA_Field))]),e._v(" "),s("th",{staticClass:"events-form-input-column custom-event-table-header"},[e._v("\n                                "+e._s(e.$Labels.MA_Get_Location_From)+"\n                            ")]),e._v(" "),e.isStandard?s("th",{staticClass:"events-form-input-column custom-event-table-header"},[e._v("\n                                "+e._s(e.$Labels.MA_Event_Type)+"\n                            ")]):e._e(),e._v(" "),e.isCustom?s("th",{staticClass:"events-primary-column"},[s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"custom-event-table-header"},[e._v("\n                                        "+e._s(e.$Labels.MA_Primary)+"\n                                    ")]),e._v(" "),s("Tooltip",{attrs:{text:e.$Labels.MA_lookup_source_help,assistiveText:e.$Labels.MA_lookup_source_help}})],1)]):e._e(),e._v(" "),e.isStandard?s("th"):e._e()])]),e._v(" "),s("tbody",[e._l(e.lookups,(function(t){return s("ConfigLookup",{key:t.guid,attrs:{isLoading:e.isLoading,lookup:t,sobjects:t.metadata.sobjects,baseObjects:t.metadata.baseObjects,eventTypes:e.metadata.eventTypes,isStandardBaseConfig:e.isStandard,guid:t.guid},on:{"update:isLoading":function(t){e.isLoading=t},"update:is-loading":function(t){e.isLoading=t},"remove-lookup":e.removeLookup}})})),e._v(" "),s("tr",{directives:[{name:"show",rawName:"v-show",value:e.relatedObjectProgress.loading,expression:"relatedObjectProgress.loading"}]},[s("td",{attrs:{colspan:"4"}},[s("div",{staticClass:"slds-progress-bar slds-progress-bar_small",attrs:{"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"25",role:"progressbar"}},[s("span",{staticClass:"slds-progress-bar__value",style:e.relatedObjectProgress.style},[s("span",{staticClass:"slds-assistive-text"},[e._v("Progress: 25%")])])])])])],2)])]),e._v(" "),"standard"===e.type?s("div",[s("button",{staticClass:"slds-button slds-button_neutral slds-grid slds-grid_align-center",on:{click:e.addRelatedObject}},[e._v("\n                    "+e._s(e.$Labels.MA_Add_Related_Object)+"\n                ")])]):e._e()])])],1)}),[],!1,null,null,null).exports,x={name:"RoutesScheduleRoot",components:{NewConfigModal:p,InstallStandardConfigModal:d,Spinner:n.$j,MAToast:o.Z,Tabs:n.mQ,Tab:n.OK,Config:w},data:()=>({isLoading:!1,eventsTabError:null,configs:[],defaultTabId:null,doShowInstallStandardConfigModal:!1}),created(){this.$bus.$on("update-tabid",this.updateTabIdFromEvent)},mounted(){this.init()},destroyed(){this.$bus.$off("update-tabid")},methods:{refresh(){this.configs=[],this.init()},deleteConfig(e){this.configs.splice(e,1),this.defaultTabId=this.configs[0].id},init(){this.isLoading=!0,this.getAllConfigs().then((e=>{this.configs=e.map((e=>({id:e.Id,name:e.Name}))),e.find((e=>"Standard"===e.maps__Type__c))||(this.doShowInstallStandardConfigModal=!0),this.defaultTabId=this.configs.length?this.configs[0].id:null})).catch((e=>{console.warn(e)})).finally((()=>{this.isLoading=!1}))},getAllConfigs(){return new Promise(((e,t)=>{(new a.Z).setAction("maps.CustomEventConfigController.getAllConfigs").setErrorHandler(this.handleRemoteActionError.bind(this)).invoke([],(s=>{Array.isArray(s)?e(s):t(new Error("Error loading records."))}))}))},confirmCustomEventObject(e){this.defaultTabId=this.getTabId(),this.configs.push({id:this.defaultTabId,name:this.$Labels.Routes_Settings_New_Custom_Event,isNew:!0,sobject:e.name,label:e.label})},newCustomEventClick(){this.$bus.$emit("show-new-config-modal")},getTabId:()=>(0,i.x$)(),closeEventsTabError(){this.eventsTabError=null},handleRemoteActionError(e,t,s){e?e(s.message):(this.isLoading&&(this.isLoading=!1),this.toast=t.message||s.message)},updateTabIdFromEvent(e){let t,s;this.configs.forEach(((i,a)=>{i.id===e&&(t=a,s=i)})),this.configs.splice(t,1),this.$nextTick((()=>{this.configs.splice(t,0,s),this.defaultTabId=e}))}}},L=(0,l.Z)(x,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Tabs",{staticClass:"slds-m-bottom_medium"},[s("Tab",{staticClass:"slds-m-around_medium",attrs:{id:e.getTabId(),title:e.$Labels.Routes_Settings_Events}},[s("div",{staticClass:"events-tab-content"},[e.isLoading?s("Spinner"):e._e(),e._v(" "),null!=e.eventsTabError?s("MAToast",{attrs:{msg:e.eventsTabError},on:{close:e.closeEventsTabError}}):e._e(),e._v(" "),s("Tabs",{staticClass:"slds-m-bottom_medium",attrs:{isVertical:!0,activeTabId:e.defaultTabId,defaultTabId:e.defaultTabId}},[e._l(e.configs,(function(t,i){return s("Tab",{key:t.id,attrs:{id:t.id,title:t.name}},[s("Config",{attrs:{bootstrap:t,index:i},on:{"update:bootstrap":function(e){t=e},deleteConfig:e.deleteConfig}})],1)})),e._v(" "),s("li",{staticClass:"slds-p-around_small",attrs:{slot:"content",role:"presentation"},slot:"content"},[s("button",{staticClass:"slds-button slds-button_neutral slds-grid slds-grid_align-center ma-new-custom-event",on:{click:e.newCustomEventClick}},[e._v("\n                            "+e._s(e.$Labels.MA_Add_Custom_Event)+"\n                        ")])])],2)],1)])],1),e._v(" "),s("NewConfigModal",{on:{confirm:e.confirmCustomEventObject}}),e._v(" "),s("InstallStandardConfigModal",{attrs:{doShow:e.doShowInstallStandardConfigModal},on:{"update:doShow":function(t){e.doShowInstallStandardConfigModal=t},"update:do-show":function(t){e.doShowInstallStandardConfigModal=t},refresh:e.refresh}})],1)}),[],!1,null,"0abf9da2",null).exports},945:(e,t,s)=>{"use strict";function i(e){if(e.setAttribute("aria-hidden",!0),Array.isArray(this.iconClass)?this.iconClass.forEach((t=>e.classList.add(t))):e.classList.add(this.iconClass),this.inheritFillFromParent){const t=e=>{e.forEach((e=>{"path"!==e.nodeName&&"g"!==e.nodeName||(e.style.fill="inherit"),e.childNodes.length&&t(e.childNodes)}))};t(e.childNodes||[])}if(this.$el.appendChild(e),this.assistiveText){const e=document.createElement("span");e.classList.add("slds-assistive-text"),e.textContent=this.assistiveText,this.$el.appendChild(e)}}s.d(t,{Z:()=>r});const a={render:e=>e("span"),props:{svg:{required:!0,validator(e){const t="string"==typeof e,s="object"==typeof e&&!0===e.__esModule;return t||s}},inheritFillFromParent:{type:Boolean,default:!0},assistiveText:{type:String},iconClass:{type:[Array,String]}},mounted(){const e="object"==typeof this.svg&&!0===this.svg.__esModule?this.svg.default:this.svg,t=document.createRange().createContextualFragment(e),s=Array.from(t.childNodes).find((e=>"svg"===e.nodeName));s?i.call(this,s):console.error("Could not build SVG.")}},o=new Map;o.set("info",{divClass:"slds-theme_info"}),o.set("success",{divClass:"slds-theme_success"}),o.set("warning",{divClass:"slds-theme_warning"}),o.set("error",{divClass:"slds-theme_error"});const n={name:"MAToast",components:{MAIconInline:a},props:{msg:{type:String,required:!1,default:""},state:{type:String,default:"error",validate:e=>e&&(void 0).stateMap.has(e)},closeLabel:{type:String,default:"Close"}},data:()=>({stateMap:o}),methods:{close(){this.$emit("close")}}},r=(0,s(1900).Z)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"slds-grid slds-grid_vertical-align-center ma-wrapper"},[i("div",{staticClass:"slds-spinner_container"}),e._v(" "),i("div",{staticClass:"slds-notify_container slds-is-relative"},[i("div",{staticClass:"slds-notify slds-notify_toast ma-toast",class:e.stateMap.get(e.state).divClass,attrs:{role:"alert"}},[i("span",{staticClass:"slds-assistive-text"},[e._v(e._s(e.state))]),e._v(" "),i("MAIconInline",{directives:[{name:"show",rawName:"v-show",value:"error"===e.state,expression:"state === 'error'"}],staticClass:"slds-icon_container slds-m-right_small slds-no-flex slds-align-top",attrs:{svg:s(6413),iconClass:["slds-button__icon","slds-button__icon_large"]}}),e._v(" "),i("MAIconInline",{directives:[{name:"show",rawName:"v-show",value:"success"===e.state,expression:"state === 'success'"}],staticClass:"slds-icon_container slds-m-right_small slds-no-flex slds-align-top",attrs:{svg:s(9718),iconClass:["slds-button__icon","slds-button__icon_large"]}}),e._v(" "),i("MAIconInline",{directives:[{name:"show",rawName:"v-show",value:"info"===e.state,expression:"state === 'info'"}],staticClass:"slds-icon_container slds-m-right_small slds-no-flex slds-align-top",attrs:{svg:s(8186),iconClass:["slds-button__icon","slds-button__icon_large"]}}),e._v(" "),i("MAIconInline",{directives:[{name:"show",rawName:"v-show",value:"warning"===e.state,expression:"state === 'warning'"}],staticClass:"slds-icon_container slds-m-right_small slds-no-flex slds-align-top",attrs:{svg:s(5953),iconClass:["slds-button__icon","slds-button__icon_large"]}}),e._v(" "),i("div",{staticClass:"slds-notify__content"},[e._t("default",(function(){return[i("div",[e._v(e._s(e.msg))])]}))],2),e._v(" "),i("button",{staticClass:"slds-button slds-button_icon slds-notify__close slds-button_icon-inverse",attrs:{title:e.closeLabel},on:{click:e.close}},[i("MAIconInline",{staticClass:"slds-icon_container",attrs:{svg:s(8137),iconClass:["slds-button__icon","slds-button__icon_large"]}}),e._v(" "),i("span",{staticClass:"slds-assistive-text"},[e._v(e._s(e.closeLabel))])],1)],1)])])}),[],!1,null,"2d0cadea",null).exports},9486:e=>{window,e.exports=function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s(s.s=2)}([function(e,t,s){"use strict";s.r(t),function(e){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}s.d(t,"withParams",(function(){return o}));var a="undefined"!=typeof window?window:void 0!==e?e:{},o=a.vuelidate?a.vuelidate.withParams:function(e,t){return"object"===i(e)&&void 0!==t?t:e((function(){}))}}.call(this,s(1))},function(e,t){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(e){"object"==typeof window&&(s=window)}e.exports=s},function(e,t,s){"use strict";s.r(t),s.d(t,"alpha",(function(){return c})),s.d(t,"alphaNum",(function(){return u})),s.d(t,"numeric",(function(){return b})),s.d(t,"between",(function(){return h})),s.d(t,"email",(function(){return p})),s.d(t,"ipAddress",(function(){return m})),s.d(t,"macAddress",(function(){return f})),s.d(t,"maxLength",(function(){return g})),s.d(t,"minLength",(function(){return y})),s.d(t,"required",(function(){return C})),s.d(t,"requiredIf",(function(){return $})),s.d(t,"requiredUnless",(function(){return w})),s.d(t,"sameAs",(function(){return x})),s.d(t,"url",(function(){return L})),s.d(t,"or",(function(){return j})),s.d(t,"and",(function(){return S})),s.d(t,"not",(function(){return A})),s.d(t,"minValue",(function(){return O})),s.d(t,"maxValue",(function(){return F})),s.d(t,"integer",(function(){return k})),s.d(t,"decimal",(function(){return M})),s.d(t,"helpers",(function(){return i}));var i={};s.r(i),s.d(i,"withParams",(function(){return a})),s.d(i,"req",(function(){return n})),s.d(i,"len",(function(){return r})),s.d(i,"ref",(function(){return l})),s.d(i,"regex",(function(){return d}));var a=s(0).withParams;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=function(e){if(Array.isArray(e))return!!e.length;if(null==e)return!1;if(!1===e)return!0;if(e instanceof Date)return!isNaN(e.getTime());if("object"===o(e)){for(var t in e)return!0;return!1}return!!String(e).length},r=function(e){return Array.isArray(e)?e.length:"object"===o(e)?Object.keys(e).length:String(e).length},l=function(e,t,s){return"function"==typeof e?e.call(t,s):s[e]},d=function(e,t){return a({type:e},(function(e){return!n(e)||t.test(e)}))},c=d("alpha",/^[a-zA-Z]*$/),u=d("alphaNum",/^[a-zA-Z0-9]*$/),b=d("numeric",/^[0-9]*$/),h=function(e,t){return a({type:"between",min:e,max:t},(function(s){return!n(s)||(!/\s/.test(s)||s instanceof Date)&&+e<=+s&&+t>=+s}))},p=d("email",/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i),m=a({type:"ipAddress"},(function(e){if(!n(e))return!0;if("string"!=typeof e)return!1;var t=e.split(".");return 4===t.length&&t.every(_)})),_=function(e){if(e.length>3||0===e.length)return!1;if("0"===e[0]&&"0"!==e)return!1;if(!e.match(/^\d+$/))return!1;var t=0|+e;return t>=0&&t<=255},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:":";return a({type:"macAddress"},(function(t){if(!n(t))return!0;if("string"!=typeof t)return!1;var s="string"==typeof e&&""!==e?t.split(e):12===t.length||16===t.length?t.match(/.{2}/g):null;return null!==s&&(6===s.length||8===s.length)&&s.every(v)}))},v=function(e){return e.toLowerCase().match(/^[0-9a-f]{2}$/)},g=function(e){return a({type:"maxLength",max:e},(function(t){return!n(t)||r(t)<=e}))},y=function(e){return a({type:"minLength",min:e},(function(t){return!n(t)||r(t)>=e}))},C=a({type:"required"},(function(e){return n("string"==typeof e?e.trim():e)})),$=function(e){return a({type:"requiredIf",prop:e},(function(t,s){return!l(e,this,s)||n(t)}))},w=function(e){return a({type:"requiredUnless",prop:e},(function(t,s){return!!l(e,this,s)||n(t)}))},x=function(e){return a({type:"sameAs",eq:e},(function(t,s){return t===l(e,this,s)}))},L=d("url",/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i),j=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return a({type:"or"},(function(){for(var e=this,s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return t.length>0&&t.reduce((function(t,s){return t||s.apply(e,i)}),!1)}))},S=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return a({type:"and"},(function(){for(var e=this,s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return t.length>0&&t.reduce((function(t,s){return t&&s.apply(e,i)}),!0)}))},A=function(e){return a({type:"not"},(function(t,s){return!n(t)||!e.call(this,t,s)}))},O=function(e){return a({type:"minValue",min:e},(function(t){return!n(t)||(!/\s/.test(t)||t instanceof Date)&&+t>=+e}))},F=function(e){return a({type:"maxValue",max:e},(function(t){return!n(t)||(!/\s/.test(t)||t instanceof Date)&&+t<=+e}))},k=d("integer",/(^[0-9]*$)|(^-[0-9]+$)/),M=d("decimal",/^[-]?\d*(\.\d+)?$/)}])}}]);