var showFooterPanel=true;var NewBtnHandler=function(a,b){var c=new Array(1);if(isRequestCatalog=="true"){c[0]="OpenCategoryPageFromRequestDef"}else{c[0]="OpenCategoryPage"}window.parent.setPopUpVar(c);parent.window.closePopup()};function changeGrouping(){var a=Ext.getCmp("groupoptions");var b=Ext.getCmp("groupoptions").getValue();document.getElementById("selectedCategory").value=Ext.getCmp("groupoptions").getValue();renderTree()}function SendValueToParent(b){window.parent.setPopUpVar(b);parent.window.closePopup()}function pageRefresh(){window.location.reload()}function createIFrame(d,c){var a=document.createElement("iframe");while(d.firstChild){d.removeChild(d.firstChild)}if(c!=undefined){for(var b in c){if(c.hasOwnProperty(b)){a.setAttribute(b,c[b])}}}d.appendChild(a)}Ext.onReady(function(){Ext.QuickTips.init();var s=new Date();var p=s.getTime();Nwlatency=p-getServerendtime();clookupdata+=labelPMServerTime;clookupdata+=servertime;clookupdata+="<br>";clookupdata+=labelNwLatency;clookupdata+=Nwlatency;clookupdata+="<br>";showCategoryList=getshowCategoryList();if(showCategoryList){var h={id:"categoryListFrameId",name:"categoryListFrame",frameborder:"0",scrolling:"no",style:"width:100%;height:100%;border:none;"};if(isRequestCatalog){h.src="/apex/SearchPage?popupId=Category&pgheight=750&wid=1&isLookup=true&disableFirstColLink=true&hideIncidentCat=true&filterClause="+escape("inactive__c = false")}else{if(popupId!=null&&popupId!="null"&&popupId.toLowerCase()=="incident"){h.src="/apex/SearchPage?popupId=Category&pgheight=750&wid=1&isLookup=true&disableFirstColLink=true&showFilterMenu=true&pId=incident&filterClause="+escape("inactive__c = false")}else{h.src="/apex/SearchPage?popupId=Category&pgheight=750&wid=1&isLookup=true&disableFirstColLink=true&filterClause="+escape("inactive__c = false")}}createIFrame(document.getElementById("categoryListPage"),h)}else{document.getElementById("categoryListPage").style.display="none";var m=function(v,u){if(u.getKey()==u.RETURN||u.getKey()==u.ENTER){if(document.getElementById(cancelBtnId)!=null){document.getElementById(cancelBtnId).disabled=true}txtSearch()}};srchTxtFld.on("specialkey",m);var o=193;if(isRequestCatalog=="true"){o=395}}function n(v,u,w){categoryId=v;categoryName=u;catUrgency=w}if(isRequestCatalog!="true"){var l=new Ext.data.ArrayStore({fields:[{name:"StandardDescription"},{name:"DescriptionID"},{name:"ID"}],data:descriptionData});var k=new Ext.data.ArrayStore({fields:[{name:"StandardResolution"},{name:"ResolutionID"},{name:"ID"}],data:resolutionData});var r=new Array(3);r[0]={id:"StandardDescription",header:labelStandardDescription,dataIndex:"StandardDescription"};r[1]={id:"DescriptionID",header:"DescriptionID",hidden:true,dataIndex:"DescriptionID"};r[2]={id:"ID",header:"ID",hidden:true,dataIndex:"ID"};var f=new Array(3);f[0]={id:"StandardResolution",header:labelStandardResolution,dataIndex:"StandardResolution"};f[1]={id:"ResolutionID",header:"ResolutionID",hidden:true,dataIndex:"ResolutionID"};f[2]={id:"ID",header:"ID",hidden:true,dataIndex:"ID"};var d=new Array(3);d[0]={id:"StandardDescription",header:labelStandardDescriptionAndResolution,dataIndex:"StandardDescription"};d[1]={id:"DescriptionID",header:"DescriptionID",hidden:true,dataIndex:"DescriptionID"};d[2]={id:"ResolutionID",header:"ResolutionID",hidden:true,dataIndex:"ResolutionID"};desGridEmpty=new Ext.grid.GridPanel({store:l,border:true,cm:new Ext.grid.ColumnModel({defaults:{sortable:true},columns:d}),viewConfig:{scrollOffset:0,forceFit:true,emptyText:labelMsgNoRecordFoundSearchPage,deferEmptyText:false},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),trackMouseOver:false,loadMask:true,height:200,frame:false,stripeRows:true,enableColumnMove:false,enableHdMenu:false,id:"decsriptionGrid",layout:"fit",listeners:{rowClick:function(u,y,v){descriptionString="";resolutionString="";var w=u.store.getAt(y);var x=w.get("DescriptionID");descriptionString=w.get("ID");handleRowClick(x)}}});desGrid=new Ext.grid.GridPanel({store:l,border:true,cm:new Ext.grid.ColumnModel({defaults:{sortable:true},columns:r}),viewConfig:{scrollOffset:0,forceFit:true,emptyText:labelMsgNoRecordFoundSearchPage,deferEmptyText:false},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),trackMouseOver:false,loadMask:true,height:145,frame:true,stripeRows:true,enableColumnMove:false,enableHdMenu:false,id:"decsriptionGrid",layout:"fit",listeners:{rowClick:function(u,y,v){descriptionString="";resolutionString="";var w=u.store.getAt(y);var x=w.get("DescriptionID");descriptionString=w.get("ID");handleRowClick(x)}}});var b=new Ext.Panel({defaults:{height:33},items:[{id:"desCheckBox",xtype:"checkbox",width:37,checked:false}]});var t=new Ext.Panel({defaults:{height:33},items:[{id:"resCheckBox",xtype:"checkbox",width:37,checked:false}]});resGrid=new Ext.grid.GridPanel({store:k,cm:new Ext.grid.ColumnModel({defaults:{sortable:true},columns:f}),viewConfig:{scrollOffset:0,forceFit:true},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),trackMouseOver:false,loadMask:true,layout:"fit",height:145,frame:true,stripeRows:true,enableColumnMove:false,enableHdMenu:false,id:"resolutionGrid",listeners:{rowClick:function(u,y,w){resolutionString="";var x=u.store.getAt(y);var v=x.get("ResolutionID");resolutionString=x.get("ResolutionID")}}});var i=new Ext.Panel({height:175,layout:"vbox",layoutConfig:{align:"stretch"},items:[desGridEmpty]});var e=new Ext.Panel({height:175,layout:"vbox",layoutConfig:{align:"stretch"},items:[b,desGrid]});var c=new Ext.Panel({height:175,layout:"vbox",layoutConfig:{align:"stretch"},items:[t,resGrid]});if(getIsStandardDescription()=="true"){if(descriptionData!=""){var a=new Ext.Panel({border:false,height:200,layout:"hbox",collapsible:false,title:labelStandardDescriptionAndResolution,renderTo:"div1",disabled:isShowFooterDisabled(),defaults:{flex:1},items:[e,c]})}else{var a=new Ext.Panel({border:false,height:200,layout:"hbox",collapsible:false,renderTo:"div1",disabled:isShowFooterDisabled(),defaults:{flex:1},items:i});document.getElementById("OKButton").style.visibility="hidden";document.getElementById("cancelButton").value=OkButton}}}var j=new Date();var q=j.getTime();var g=q-p;clookupdata+=pageLoad;clookupdata+=g;document.getElementById("lookupdataval").value=clookupdata});function saveCategory(){if(!availableForSR&&isRequestCatalog){showMessage(labelSRDCategorySelectionErrorMsg);return}var a=categoryName+":"+descriptionString+":"+resolutionString;var b=new Array(5);b[0]=decodeSpecialChar(categoryName);if(isRequestCatalog!="true"){if(Ext.getCmp("desCheckBox").getValue()){b[1]=decodeSpecialChar(descriptionString)}else{b[1]=null}if(Ext.getCmp("resCheckBox").getValue()){b[2]=decodeSpecialChar(resolutionString)}else{b[2]=null}}else{b[1]=null;b[2]=null}b[3]=categoryId;b[4]=decodeSpecialChar(catUrgency);window.parent.setPopUpVar(b);setTimeout("window.parent.closePopup()",1000)}function changeTitle(b,c,a){}function activateWindow(){}function addTab(){}function selectedCatDBClk(c,b,d){var a=frames.categoryListFrame.grid.store.getAt(b).get("Name");catUrgency=frames.categoryListFrame.grid.store.getAt(b).get("FkUrgency__c");categoryId=d;categoryName=a;saveCategory()}function selectedCatSingleClk(c,b,d){var a=frames.categoryListFrame.grid.store.getAt(b).get("Name");catUrgency=frames.categoryListFrame.grid.store.getAt(b).get("FkUrgency__c");categoryId=d;categoryName=a;if(showFooterPanel!=null&&typeof(showFooterPanel)!="undefined"&&(showFooterPanel==true||showFooterPanel=="")){nodeClicked(d)}}function saveCategory1(){var b=document.getElementById("desCheckBox").checked;var a=document.getElementById("resCheckBox").checked;if(b&&a){if(descriptionString!=""&&resolutionString!=""){saveResolutionDescription(descriptionString,resolutionString)}else{if(descriptionString==""&&resolutionString==""){Ext.MessageBox.show({msg:labelValidateDescriptionResolution,title:labelWarningTitleSearchPage,buttons:Ext.MessageBox.OK,width:300,icon:Ext.MessageBox.WARNING})}else{if(descriptionString==""){Ext.MessageBox.show({msg:labelValidateDescription,title:labelWarningTitleSearchPage,buttons:Ext.MessageBox.OK,width:300,icon:Ext.MessageBox.WARNING})}else{if(resolutionString==""){Ext.MessageBox.show({msg:labelValidateResolution,title:labelWarningTitleSearchPage,buttons:Ext.MessageBox.OK,width:300,icon:Ext.MessageBox.WARNING})}}}}}if(b&&!a){resolutionString="";if(descriptionString!=""){saveResolutionDescription(descriptionString,resolutionString)}else{Ext.MessageBox.show({msg:labelValidateDescription,title:labelWarningTitleSearchPage,buttons:Ext.MessageBox.OK,width:300,icon:Ext.MessageBox.WARNING})}}if(!b&&a){descriptionString="";if(resolutionString!=""){saveResolutionDescription(descriptionString,resolutionString)}else{Ext.MessageBox.show({msg:labelValidateResolution,title:labelWarningTitleSearchPage,buttons:Ext.MessageBox.OK,width:300,icon:Ext.MessageBox.WARNING})}}if(!b&&!a){window.close()}}function refresh(){window.opener.location.href="/"+objId;window.close()};