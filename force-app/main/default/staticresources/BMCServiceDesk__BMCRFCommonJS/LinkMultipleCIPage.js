var NONPRINT="ф";var NONPRINT1="¬";var waitingMask;var selectedClass=[];var selectedInstanceTypes;var WinMsg;var filterWindowOpened=false;var AdvancedFilterPopUp;var selectedClsType="";var AdvancedFilterName="";var fromAdvancedFilter=false;var classRecord;var comboboxdisabled=false;var selectedTab="All";var incidentMatching;var advancedFilterApplied=false;var url;var lastAdvancedSearchedString;var lastClassIdinCriteria;var lastChecked;var isNotified=false;var filterMenuHandler=function(b,a){setOptions(b,a)};var filterMenuHandlerCI=function(b,a){setOptionsCI(b,a)};var filterMenuHandlerProblem=function(b,a){setOptionsProblem(b,a)};var filteredFieldsForMatching="";var filterFlags="";var childFoundForReMerge;var isParentInc;var allIDSelected;var SelectedNormRuleID;var selectedNormName;var searchstring;var isCIChild=false;var advSearch;Ext.onReady(function(){if(childObjectName.toLowerCase()=="businesshours"){var b=document.getElementById("currPage");if(b){b.disabled=true}}var a=document.getElementById("advancedSearch");if(a){a.setAttribute("title",AdvancedSearch)}if(childObjectName=="BMC_BusinessService__c"){classRecord="BMC_BusinessService"}if(parentName=="Matching"){prepareToolbar();incidentMatching="Matching";RenderSearchComponent();setResetButtons()}else{if((parentName=="Incident__c"&&childObjectName=="BMC_BaseElement__c"&&!isFromSS)||(parentName=="Problem__c"&&childObjectName=="BMC_BaseElement__c")||(parentName=="Change_Request__c"&&childObjectName=="BMC_BaseElement__c")||(parentName=="Task__c"&&childObjectName=="BMC_BaseElement__c")||(parentName=="AdminLocation"&&childObjectName=="BMC_BaseElement__c")||(parentName=="Release__c"&&childObjectName=="BMC_BaseElement__c")||(lookUpType=="FulfillReqLookup"&&childObjectName=="BMC_BaseElement__c")||(parentName=="KM_KnowledgeArticle__c"&&childObjectName=="BMC_BaseElement__c")){if(window.document.title==""&&parentName=="Incident__c"){document.title=ConfigurationItems}prepareToolbarForCi();RenderSearchComponent(false);isCIChild=true}else{if((parentName=="Problem__c"&&childObjectName=="Incident__c")||(parentName=="Broadcasts__c"&&childObjectName=="Incident__c")||(parentName=="Incident__c"&&childObjectName=="Problem__c")||(parentName=="Problem__c"&&childObjectName=="Change_Request__c")||(parentName=="Change_Request__c"&&childObjectName=="Problem__c")||(parentName=="Incident__c"&&childObjectName=="Change_Request__c")||(parentName=="Change_Request__c"&&childObjectName=="Incident__c")||(parentName=="Release__c"&&childObjectName=="Change_Request__c")||(parentName=="Change_Request__c"&&childObjectName=="Release__c")||(parentName=="Release__c"&&childObjectName=="Incident__c")||(parentName=="Incident__c"&&childObjectName=="Release__c")||(parentName=="Release__c"&&childObjectName=="Problem__c")||(parentName=="Problem__c"&&childObjectName=="Release__c")||(parentName=="BMC_BaseElement__c"&&childObjectName=="BusinessHours")||((parentName=="Incident__c"||parentName=="Change_Request__c"||parentName=="Release__c"||parentName=="Problem__c")&&childObjectName=="Task__c")||(parentName=="BMC_BaseElement__c"&&(childObjectName=="Incident__c"||childObjectName=="User"||childObjectName=="Account"||childObjectName=="Change_Request__c"||childObjectName=="Problem__c"||childObjectName=="Release__c"||childObjectName=="Task__c"))){prepareToolbarForJunctionObjects();RenderSearchComponent(true)}else{if((parentName=="Incident__c"||parentName=="Problem__c"||parentName=="Change_Request__c"||parentName=="BMC_BaseElement__c")&&childObjectName=="KM_KnowledgeArticle__c"){prepareToolbarForIncKAJunction();RenderSearchComponent(true)}else{if(parentName=="Task__c"&&childObjectName=="Status__c"&&lightningUI=="true"){prepateToolbarForStatus();RenderSearchComponent(true)}}}}}if(isNewLookup){addCustomObjectIdentifier()}enableClearBtn()});function prepateToolbarForStatus(){var k=new Array(3);var d=new Array(12);j=0;filterFlags="active";var e='[{"value1":"active","label":"'+lblActiveItems+'"},{"value1":"inactive","label":"'+lblInActiveItems+'"}]';var b=JSON.parse(e);Ext.define("ScheduleModel",{extend:"Ext.data.Model",fields:[{name:"value1",type:"string"},{name:"label",type:"string"}]});var g=Ext.create("Ext.data.Store",{model:"ScheduleModel",data:b});var a=Ext.create("Ext.form.ComboBox",{id:"filterDiv",store:g,queryMode:"local",displayField:"label",valueField:"value1",value:"active",editable:false,forceSelection:true,width:200,listConfig:{cls:(userLanguage=="iw")?"filterStatusCls":"rf-filter-status"},listeners:{select:function(n,l,m){filterFlags=n.getValue();applyFilterProblem()}}});d[j++]={xtype:"tbspacer",width:10};d[j++]=a;d[j++]={xtype:"tbspacer",width:10};d[j++]="-";d[j++]={xtype:"tbspacer",width:10};var h=new Ext.Component({html:'<span class="searchTextLightning"><a title="'+lblSearch+'"class="rf-icon-search" style="margin-top: 5px !important;" onclick="applySearchProblem();" ></a><input type="text" id="searchTextId" name="searchTxt" class="searchClassLightning" autocomplete="off" size="26" placeholder="'+lblSearch+'" /><a title="'+lblClear+'"  class="rf-icon-cross" ></a></span>'});d[j++]=h;d[j++]={xtype:"tbspacer",};d[j++]="-";d[j++]={xtype:"tbspacer",width:5};var c={scale:"medium",id:"goBtns",baseCls:"slds-button",focusCls:"slds-button-hover",overCls:"slds-button-hover",text:lblGoBtn,handler:applySearchProblem};d[j++]=c;d[j++]={xtype:"tbspacer",width:5};createMenuBar(d)}function prepareToolbarForIncKAJunction(){var a=new Array(12);j=0;a[j++]={xtype:"tbspacer",width:10};a[j++]=toolbarSearchCmp("applySearchProblem();");a[j++]={xtype:"tbspacer",width:5};a[j++]="-";a[j++]={xtype:"tbspacer",width:5};a[j++]=createGoBtn(applySearchProblem);a[j++]={xtype:"tbspacer",width:5};a[j++]="-";a[j++]={xtype:"tbspacer",width:10};a[j++]=createLinkOkBtn();createMenuBar(a)}function prepareToolbarForJunctionObjects(){var a=new Array(12);j=0;var c=new Array(3);if(parentName=="BMC_BaseElement__c"&&childObjectName=="User"){c[0]={xtype:"menucheckitem",name:"filterField",checked:true,baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",text:lblActiveItems,inputValue:"active",handler:filterMenuHandlerProblem};c[1]={xtype:"menucheckitem",name:"filterField",baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",text:lblInActiveItems,inputValue:"inactive",handler:filterMenuHandlerProblem};filterFlags="active";c[2]={xtype:"menuseparator"};c[3]={xtype:"tbspacer",height:3};c[4]={xtype:"button",text:lblApply,id:"applyBtn",tooltipType:"title",tooltip:lblApply,iconAlign:"top",style:"padding: 0px 14px !important;",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",handler:applyFilterProblem};c[5]={xtype:"tbspacer",height:5}}else{if(parentName=="BMC_BaseElement__c"&&(childObjectName=="Account"||childObjectName=="BusinessHours")){c[0]={xtype:"menucheckitem",name:"filterField",checked:true,baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",text:lblActiveItems,inputValue:"active",disabled:true,handler:filterMenuHandlerProblem};c[1]={xtype:"menucheckitem",name:"filterField",baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",text:lblInActiveItems,inputValue:"inactive",disabled:true,handler:filterMenuHandlerProblem};if(childObjectName!="BusinessHours"){c[2]={xtype:"menucheckitem",name:"filterField",baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",text:lblRemedyforceAccounts,inputValue:"remedyAccOption",handler:filterMenuHandlerProblem}}filterFlags="active";c[3]={xtype:"menuseparator"};c[4]={xtype:"tbspacer",height:3};c[5]={xtype:"button",text:lblApply,id:"applyBtn",tooltipType:"title",tooltip:lblApply,iconAlign:"top",style:"padding: 0px 14px !important;",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",handler:applyFilterProblem};c[6]={xtype:"tbspacer",height:5}}else{c[0]={xtype:"menucheckitem",name:"filterField",checked:true,baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",text:lblOpenItems,inputValue:"open",handler:filterMenuHandlerProblem};c[1]={xtype:"menucheckitem",name:"filterField",baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",text:lblClosedItems,inputValue:"closed",handler:filterMenuHandlerProblem};c[2]={xtype:"menuseparator"};c[3]={xtype:"tbspacer",height:3};filterFlags="open";c[4]={xtype:"button",text:lblApply,id:"applyBtn",tooltipType:"title",tooltip:lblApply,iconAlign:"top",style:"padding: 0px 14px !important;",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",handler:applyFilterProblem};c[5]={xtype:"tbspacer",height:5}}}a[j++]={xtype:"tbspacer",width:10};var b=new Ext.menu.Menu({autoWidth:true,showSeparator:false,plain:true,baseCls:"bmc-menu",id:"viewsDropDown",items:c});a[j++]={id:"actionButton",text:lblfilterBy,height:30,iconCls:"",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",tooltip:"test tooltip",autoWidth:true,showSeparator:false,plain:true,menu:b};a[j++]={xtype:"tbspacer",width:10};a[j++]="-";a[j++]={xtype:"tbspacer",width:10};a[j++]=toolbarSearchCmp("applySearchProblem();");a[j++]={xtype:"tbspacer",};a[j++]="-";a[j++]={xtype:"tbspacer",width:5};a[j++]=createGoBtn(applySearchProblem);a[j++]={xtype:"tbspacer",width:5};if(displayLinkBtn||displayFulfillRequestBtn){a[j++]="-";a[j++]={xtype:"tbspacer",width:10}}a[j++]=createLinkOkBtn();a[j++]=createFulfillButton();createMenuBar(a)}function getErrorAdvancedSearch(){if(ExceptionMsg!="None"){GetMessageBox("bmc-message").show({title:error,msg:ExceptionMsg,buttons:Ext.Msg.OK,width:300,icon:Ext.MessageBox.ERROR,frame:false});return}}function beforeSearchCI(){if(isAnyRecordSelected()){showRfConfirmationBoxToClearOfSelection("beforeSearchCI","")}else{if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon()}searchCI()}}function prepareToolbarForCi(){var c=new Array(15);j=0;var b=new Array(2);var g=false;if((parentName=="Incident__c"&&childObjectName=="BMC_BaseElement__c"&&!isFromSS)){g=true}b[0]={xtype:"menucheckitem",hideOnClick:false,text:Account,group:"filtermenu",checked:isCheckedAccount,inputValue:"FKAccount__c",baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",handler:filterMenuHandlerCI};b[1]={xtype:"menucheckitem",hideOnClick:false,text:Client,group:"filtermenu",checked:isCheckedClient,inputValue:"FKClient__c",baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",handler:filterMenuHandlerCI};b[2]={xtype:"menucheckitem",hideOnClick:false,text:All,group:"filtermenu",checked:isCheckedAll,inputValue:"All",baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",handler:filterMenuHandlerCI};b[3]={xtype:"menuseparator"};b[4]={xtype:"tbspacer",height:3};b[5]={xtype:"button",text:lblApply,id:"applyBtn",tooltipType:"title",tooltip:lblApply,iconAlign:"top",style:"padding: 0px 14px !important;",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",handler:applyFilterCI};b[6]={xtype:"tbspacer",height:5};var a=Ext.create("Ext.data.Store",{fields:["abbr","name"],data:[{abbr:"AllClasses",name:lblAllClasses},{abbr:"AssetClasses",name:lblAssetClasses},{abbr:"CIClasses",name:lblCIClasses}]});selectedInstanceTypeFilter=getSelectedInstanceFilter();var e=Ext.create("Ext.form.ComboBox",{store:a,queryMode:"local",displayField:"name",valueField:"abbr",value:selectedInstanceTypeFilter,selectOnFocus:true,editable:false,typeAhead:false,hidden:displayFulfillRequestBtn,width:160,triggerCls:"d-icon-triangle_down",id:"instanceTypeFilter"});e.on("select",appplyInstanceTypeFilter);e.on("change",appplyInstanceTypeFilter);if(isInstanceTypeFilterShown){c[j++]={xtype:"tbspacer",width:10};c[j++]=new Ext.form.Label({html:'<div class="lblFilterBy"> '+lblFilterBy+"</div>",hidden:displayFulfillRequestBtn,tooltipType:"title",tooltip:"k",id:"Filterby"});c[j++]=e;if(displayFulfillRequestBtn){c[j++]={xtype:"tbspacer",width:5}}else{c[j++]={xtype:"tbspacer",width:10};c[j++]="-"}}if(g){c[j++]={xtype:"tbspacer",width:10};var d=new Ext.menu.Menu({autoWidth:true,showSeparator:false,plain:true,baseCls:"bmc-menu",id:"viewsDropDown",items:b});c[j++]={id:"actionButton",text:lblfilterBy,height:29,iconCls:"",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",tooltip:"test tooltip",autoWidth:true,showSeparator:false,plain:true,menu:d};c[j++]={xtype:"tbspacer",width:10};c[j++]="-";c[j++]={xtype:"tbspacer",width:10}}c[j++]=toolbarSearchCmp("beforeapplySearchCI();");c[j++]={xtype:"tbspacer",width:5};c[j++]="-";c[j++]={xtype:"tbspacer",width:5};c[j++]=createGoBtn(beforeapplySearchCI);c[j++]={xtype:"tbspacer",width:10};if(displayLinkBtn||displayFulfillRequestBtn){c[j++]="-";c[j++]={xtype:"tbspacer",width:10}}c[j++]=createLinkOkBtn();c[j++]=createFulfillButton();c[j++]="->";c[j++]=createAdvancedSearch();c[j++]={xtype:"tbspacer",width:10};createMenuBar(c)}function prepareButtons(){var b=Ext.getCmp("detailLinkToolbarId");if(b){b.destroy()}var a=[{id:"linkParentBtnId",text:lblLinkasParent,handler:callMergeJSParent},{xtype:"tbspacer",width:10},{id:"linkChildBtnId",text:lblLinkasChild,menu:{cls:"menuColour",items:[{xtype:"tbtext",text:lblUpdatestatusoflinkedrecords,cls:"commonClsWithPaddingAndColour",margin:"0 10 0 0"},{xtype:"form",layout:{type:"hbox",align:"middle",pack:"start"},border:false,height:35,items:[{xtype:"textfield",id:"statusLookUpId",name:"lookupvalue",cls:"commonCls",value:statusValue},{xtype:"tbspacer",width:2},{xtype:"box",autoEl:{tag:"img",src:SDEFStyles+"/SDEFbuttons/b_darrow_D.gif",width:19},name:"statusLookUpBtn",id:"statusLookUpButtonId",cls:"top8pxPadding",margin:"0 10 0 0",listeners:{render:function(d){d.getEl().on("click",function(){var c="SearchAndLink?txt=statusLookUpId-inputEl&frm=linkingPage:theForm&filterObjectId="+filterObjectId+"&parentName=Incident__c&childName=Status__c&isLookUp=Status__c&filterId=active_custom&addlFilterId=status_in";var e=1000;var g=600;window.open("/apex/"+c,"_blank","status = 1,height ="+g+",width ="+e+",left="+screenLeft(e)+",top="+screenTop(g)+", resizable = yes, scrollbars=no")})}}}]},{xtype:"form",layout:{type:"vbox",align:"start",pack:"center"},margins:"5 0 0 4",cls:"menuColour",border:false,height:35,items:[{xtype:"button",cls:"linkAndUpdateButton",text:lblLinkandupdatestatus,width:"150",handler:callMergeJS}]}]}},"->"];if(userLanguage&&userLanguage=="iw"){a.reverse()}Ext.create("Ext.toolbar.Toolbar",{renderTo:"link",id:"detailLinkToolbarId",items:a});if(recordCount==1&&enableMerge){Ext.getCmp("linkParentBtnId").setDisabled(false);if((lblParentLabel!=""||typeof(lblParentLabel)!="undefined"||hidMergedIncidents!=null)&&(hasParent==null||hasParent=="")){lblParentLabel=lblParentLabel.replace("{0}",title);Ext.getCmp("linkParentBtnId").setText(lblParentLabel)}}else{Ext.getCmp("linkParentBtnId").setDisabled(true)}if(allIDSelected&&enableMerge&&(hasParent==null||hasParent=="")){Ext.getCmp("linkChildBtnId").setDisabled(false);if(lblChildLabel!=""||typeof(lblChildLabel)!="undefined"||hidMergedIncidents!=null){lblChildLabel=lblChildLabel.replace("{0}",title);Ext.getCmp("linkChildBtnId").setText(lblChildLabel)}}else{Ext.getCmp("linkChildBtnId").setDisabled(true)}}function screenLeft(a){return parseInt((screen.availWidth/2)-(a/2))}function screenTop(b){if(Ext.isChrome){var a=parseInt((screen.availHeight/2)-(b/2));return(a-25)}else{return parseInt((screen.availHeight/2)-(b/2))}}function prepareToolbar(){var a="";if(hasParentName!=""&&hasParentName!=null&&hasParentName!=undefined){lblParentMsg=lblParentMsg.replace("{0}",title);lblParentMsg=lblParentMsg.replace("{1}",hasParentName);a+=lblParentMsg}if(childCount!=""&&childCount!=null&&childCount!=undefined&&childCount!=0){lblChildMsg=lblChildMsg.replace("{0}",title);lblChildMsg=lblChildMsg.replace("{1}",childCount);a+=lblChildMsg}var d=document.getElementById("headerMessage");if(d!=null&&d!=undefined&&d!=""&&a!=""){while(d.firstChild){d.removeChild(x.firstChild)}d.appendChild(document.createTextNode(a));d.setAttribute("style","display:block")}prepareButtons();var b=new Array(12);j=0;for(f=0;f<filterItemLabel.length;f++){filterMenus[f]={xtype:"menucheckitem",name:"filterField",checked:true,baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",text:filterItemLabel[f],inputValue:filterItemValue[f],handler:filterMenuHandler};filteredFieldsForMatching+=filterItemValue[f]+NONPRINT}filteredFieldsForMatching=filteredFieldsForMatching.substring(0,filteredFieldsForMatching.length-1);filterMenus[f]={xtype:"menuseparator"};filterMenus[++f]={xtype:"tbspacer",height:3};filterMenus[++f]={xtype:"button",text:lblApply,id:"applyBtn",tooltipType:"title",tooltip:lblApply,iconAlign:"top",style:"padding: 0px 14px !important;",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",handler:applyFilter};filterMenus[++f]={xtype:"tbspacer",height:5};b[j++]={xtype:"tbspacer",width:5};var c=new Ext.menu.Menu({autoWidth:true,showSeparator:false,plain:true,baseCls:"bmc-menu",id:"viewsDropDown",items:filterMenus});b[j++]={id:"actionButton",height:29,text:lblMatchBy,iconCls:"",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",tooltip:"test tooltip",autoWidth:true,showSeparator:false,plain:true,menu:c};b[j++]={xtype:"tbspacer",width:5};b[j++]="-";b[j++]={xtype:"tbspacer",width:5};b[j++]=toolbarSearchCmp("applySearch();");b[j++]={xtype:"tbspacer",width:5};b[j++]="-";b[j++]={xtype:"tbspacer",width:5};b[j++]=createGoBtn(applySearch);b[j++]="->";createMenuBar(b)}function specialKey(b,a){if(a.getKey()==a.RETURN||a.getKey()==a.ENTER){applySearch()}}function specialKeyProblem(b,a){if(a.getKey()==a.RETURN||a.getKey()==a.ENTER){applySearchProblem()}}function specialKeyCI(b,a){if(a.getKey()==a.RETURN||a.getKey()==a.ENTER){applySearchCI()}}function setOptions(b,a){if(b.checked){if(filteredFieldsForMatching!=""){filteredFieldsForMatching+=NONPRINT}filteredFieldsForMatching+=b.inputValue}else{while(filteredFieldsForMatching.indexOf(NONPRINT+b.inputValue+NONPRINT)!=-1){filteredFieldsForMatching=filteredFieldsForMatching.replace(NONPRINT+b.inputValue+NONPRINT,NONPRINT)}while(filteredFieldsForMatching.indexOf(NONPRINT+b.inputValue)!=-1){filteredFieldsForMatching=filteredFieldsForMatching.replace(NONPRINT+b.inputValue,"")}while(filteredFieldsForMatching.indexOf(b.inputValue+NONPRINT)!=-1){filteredFieldsForMatching=filteredFieldsForMatching.replace(b.inputValue+NONPRINT,"")}while(filteredFieldsForMatching.indexOf(b.inputValue)!=-1){filteredFieldsForMatching=filteredFieldsForMatching.replace(b.inputValue,"")}}}function setOptionsProblem(b,a){if(b.checked){if(filterFlags!=""){filterFlags+=NONPRINT}filterFlags+=b.inputValue}else{while(filterFlags.indexOf(NONPRINT+b.inputValue+NONPRINT)!=-1){filterFlags=filterFlags.replace(NONPRINT+b.inputValue+NONPRINT,NONPRINT)}while(filterFlags.indexOf(NONPRINT+b.inputValue)!=-1){filterFlags=filterFlags.replace(NONPRINT+b.inputValue,"")}while(filterFlags.indexOf(b.inputValue+NONPRINT)!=-1){filterFlags=filterFlags.replace(b.inputValue+NONPRINT,"")}while(filterFlags==b.inputValue){filterFlags=""}}}function setOptionsCI(b,a){if(b.checked){filteredFiledForMatchingCI=b.inputValue;isCheckedAccount=false;isCheckedClient=false;isCheckedAll=false;if(filteredFiledForMatchingCI=="FKAccount__c"){isCheckedAccount=true}else{if(filteredFiledForMatchingCI=="FKClient__c"){isCheckedClient=true}else{if(filteredFiledForMatchingCI=="All"){isCheckedAll=true}}}}}function applyFilter(){hideAllErrorMessage();Ext.getCmp("viewsDropDown").hide();document.getElementById("searchTextId").value="";searchRecordsFor="";document.getElementById("hidMergedIncidents").value="";selectedIdsForMerge=[];clearLists();applyFilterOnMaching(filteredFieldsForMatching,"")}function applyFilterCI(){hideAllErrorMessage();if((parentName=="Incident__c"&&childObjectName=="BMC_BaseElement__c")){document.getElementById("hidMergedIncidents").value="";if(isAnyRecordSelected()){if(isFromRefresh){document.getElementById("searchTextId").value="";if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon()}isFromRefresh=false;var a=document.getElementById(pageSizePerPageList).value;searchCIsOnRefresh("",a,selectedCIids,unSelectedCIids,false,"","",filteredFiledForMatchingCI,"","","clear")}else{if(!isFromRefresh){showRfConfirmationBoxToClearOfSelection("applyFilterCIForIncident","")}}}else{document.getElementById("searchTextId").value="";if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon()}applyCIFilterOnMaching(filteredFiledForMatchingCI,"")}}else{if((childObjectName=="BMC_BaseElement__c")&&(parentName=="Problem__c"||parentName=="Change_Request__c"||parentName=="Task__c"||parentName=="AdminLocation"||parentName=="Release__c"||parentName=="KM_KnowledgeArticle__c"||lookUpType=="FulfillReqLookup")){if(isAnyRecordSelected()&&!isFromRefresh){showRfConfirmationBoxToClearOfSelection("applyFilterCI","")}else{if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon()}document.getElementById("searchTextId").value="";searchCI("")}}}if(Ext.getCmp("actionButton")){Ext.getCmp("actionButton").hideMenu()}}function applyFilterProblem(){hideAllErrorMessage();if(lightningUI){showLoadingMask()}else{var b=Ext.getCmp("viewsDropDown");if(b){b.hide()}}var d=document.getElementById("searchTextId");var c=document.getElementById(searchFieldNew);if(c){c.value=""}if(isAnyRecordSelected()){if(isFromRefresh){if(d){d.value=""}isFromRefresh=false;var a=document.getElementById(pageSizePerPageList).value;searchCIsOnRefresh("",a,selectedCIids,unSelectedCIids,false,"","","","",filterFlags,"clear")}else{if(!isFromRefresh){showRfConfirmationBoxToClearOfSelection("applyFilterProblem")}}}else{if(d){d.value=""}applyFilterProblemAF(filterFlags,"")}}function appplyInstanceTypeFilter(){hideAllErrorMessage();var k=document.getElementById("searchTextId");var c=k.value;var a=c.replace(/[*"]/gi,"");var e=document.getElementById("advSearchFrame");var g=Ext.getCmp("instanceTypeFilter");var b=g.getValue();var d="All";if(isCheckedAccount){d="FKAccount__c"}else{if(isCheckedClient){d="FKClient__c"}else{if(isCheckedAll){d="All"}}}if(isAnyRecordSelected()){var h={};h.newSelect=b;h.filteredFieldsForMatching=d;h.searchTextId=k;h.combo=g;showRfConfirmationBoxToClearOfSelection("appplyInstanceTypeFilter",h)}else{selectedFilter(b);if(b!=selectedInstanceTypeFilter){selectedInstanceTypeFilter=b;isApplyInstanceFilter=true;if(k&&k.value.length>0){if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon()}}applyInstanceTypeFilter(b,d,k.value,lastAdvancedSearchedString,lastClassIdinCriteria)}}}function selectedFilter(a){if(a=="AllClasses"){selectedTab="All"}else{if(a=="AssetClasses"){selectedTab="Asset"}else{if(a=="CIClasses"){selectedTab="CI"}}}}function applySearch(){hideAllErrorMessage();var c=document.getElementById("searchTextId");var b=c.value.trim();var a=b.replace(/[*"]/gi,"");if(a.trim().length<2&&!isCJKChar(a)){document.getElementById("minTwoChar").style.display="block";return}else{document.getElementById("hidMergedIncidents").value="";selectedIdsForMerge=[];clearLists();applyFilterOnMaching(filteredFieldsForMatching,c.value);searchRecordsFor=b}}function applySearchProblem(){hideAllErrorMessage();var c=document.getElementById("searchTextId");searchstring=c.value.trim();var a=searchstring.replace(/[*"]/gi,"");if(a.trim().length<2&&!isCJKChar(a)){document.getElementById("minTwoChar").style.display="block";return}else{if(lightningUI){showLoadingMask()}if(isAnyRecordSelected()){var b={};b.searchstring=searchstring;showRfConfirmationBoxToClearOfSelection("applySearchProblem",b)}else{document.getElementById("hidMergedIncidents").value="";selectedIdsForMerge=[];applyFilterProblemAF(filterFlags,searchstring)}}}function GetMessageBox(a){if(WinMsg==null){WinMsg=Ext.create("Ext.window.MessageBox")}WinMsg.baseCls=a;return WinMsg}function resetAdvancedSearchFilterIcon(){var a=document.getElementById("advancedSearch");lastAdvancedSearchedString="";lastClassIdinCriteria="";if(a){a.src=BMCRFSDEFStylesPath+"/Images/cmdb_icon-advanced-filter.svg";a.setAttribute("title",AdvancedSearch)}else{var b=Ext.getCmp("FilterBtn");if(b){b.setIconCls("filterBtn");b.setTooltip(AdvancedSearch)}}}function beforeapplySearchCI(){hideAllErrorMessage();if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon();applySearchCI()}else{applySearchCI()}}function applySearchCI(g,d){lastAdvancedSearchedString=g;lastClassIdinCriteria=d;var k=document.getElementById("searchTextId");var e="";var b="";var h={};if(k){e=k.value.trim();b=e.replace(/[*"]/gi,"");h.searchTextId=k}h.advancedSearchedString=g;h.ClassIdinCriteria=d;if((parentName=="Incident__c"&&childObjectName=="BMC_BaseElement__c"&&!isFromSS)){if((b.trim().length<2&&!isCJKChar(b))&&!fromAdvancedFilter){document.getElementById("minTwoChar").style.display="block";return}else{document.getElementById("hidMergedIncidents").value="";var c=k.nextSibling;h.clearBtn=c;if(isAnyRecordSelected()){showRfConfirmationBoxToClearOfSelection("applySearchCIForIncident",h)}else{if(fromAdvancedFilter){k.value="";if(typeof(c)!="undefined"){c.style.visibility="hidden"}}fromAdvancedFilter=false;selectedIdsForMerge=[];applyCIFilterOnMaching(filteredFiledForMatchingCI,k.value,g,d)}}}else{var a=h.clrBtn=document.getElementById("clearLink");if(k){var c=h.clearBtn=k.nextSibling}if(k==null){h.searchTextId=k=document.getElementById(searchFieldNew);h.strWithoutSplChars=b=k.value.replace(/[*"]/gi,"")}if(isAnyRecordSelected()&&k.value.length!=1){showRfConfirmationBoxToClearOfSelection("applySearchCI",h)}else{if(fromAdvancedFilter){k.value=b="";if(a){a.style.visibility="hidden"}if(typeof(c)!="undefined"){c.style.visibility="hidden"}}fromAdvancedFilter=false;searchCI(b,g,d)}}}var selectedIdsForMerge=[];function setIdsForLink(a){if(a==null){var b=document.getElementsByTagName("input");for(i=0;i<b.length;i++){if(b[i].type=="checkbox"&&b[i].checked&&b[i].id!="selectAllcheckBox"&&selectedIdsForMerge.indexOf(b[i].name)==-1){selectedIdsForMerge.push(b[i].name)}if(b[i].type=="checkbox"&&!b[i].checked&&selectedIdsForMerge.indexOf(b[i].name)>-1){selectedIdsForMerge.splice(selectedIdsForMerge.indexOf(b[i].name),1)}}}else{if(a.checked){if(selectedIdsForMerge.indexOf(a.name)==-1){selectedIdsForMerge.push(a.name)}}else{if(!a.checked){selectedIdsForMerge.splice(selectedIdsForMerge.indexOf(a.name),1)}}}}function callMergeJS(){var e=Ext.getCmp("statusLookUpId");if(e.getValue()==""){mergeStatus=""}var g="";var l="";var a="";var h="";var n=false;childFoundForReMerge=false;var b=document.getElementById("hidMergedIncidents").value.split(",");if(b!=null&&typeof(b)!="undefined"&&b!=""){for(i=0;i<b.length;i++){if(selectedIdsForMerge.indexOf(b[i])>-1){childFoundForReMerge=true;g+=b[i]+","}}}isParentInc=false;var o=document.getElementById("hideParentInc").value.split(",");if(o!=null&&typeof(o)!="undefined"&&o!=""){for(i=0;i<o.length;i++){if(selectedIdsForMerge.indexOf(o[i])>-1){isParentInc=true;l+=o[i]+","}}}g=g.split(",");for(i=0;i<g.length;i++){var m=g[i].split(":");if(m[1]!=undefined){a+=m[1]+","}}a=a.substring(0,a.length-1);l=l.split(",");for(i=0;i<l.length;i++){var c=l[i].split(":");if(c[1]!=undefined&&h.indexOf(c[1])==-1){h+=c[1]+","}}h=h.substring(0,h.length-1);var d=g.length-1+l.length-1;if(selectedIdsForMerge.length>d){n=true}if(n&&isParentInc){var p=lblParentChildError+" <br/>"+h+" ";GetMessageBox("bmc-message").show({title:lblLinkasChild,msg:p,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR})}else{if(childFoundForReMerge&&isParentInc){var p=lblParentChildError+" <br/>"+h+" ";GetMessageBox("bmc-message").show({title:lblLinkasChild,msg:p,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR})}else{if(childFoundForReMerge){GetMessageBox("bmc-message").confirm(lblLinkasChild,lblReMergeValidationErrorMsg,function(q){if(q==="yes"){mergeIncidents(selectedCIids,unSelectedCIids,mergeStatus,lblChild)}})}else{if(isParentInc){var k=lblParentChildError+" <br/>"+h+" ";GetMessageBox("bmc-message").show({title:lblLinkasChild,msg:k,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR})}else{mergeIncidents(selectedCIids,unSelectedCIids,mergeStatus,lblChild)}}}}}function callMergeJSParent(){var e="";var b="";childFoundForReMerge=false;var d=document.getElementById("hidMergedIncidents").value.split(",");if(d!=null&&typeof(d)!="undefined"&&d!=""){for(i=0;i<d.length;i++){if(selectedIdsForMerge.indexOf(d[i])>-1){childFoundForReMerge=true;e+=d[i]+","}}}e=e.split(",");for(i=0;i<e.length;i++){var c=e[i].split(":");if(c[1]!=undefined){b+=c[1]+","}}b=b.substring(0,b.length-1);if(childFoundForReMerge){var a=lblThe+" "+b+" "+lblLinkParentError;GetMessageBox("bmc-message").show({title:lblLinkasParent,msg:a,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR})}else{mergeIncidents(selectedCIids,unSelectedCIids,mergeStatus,lblParent)}}function callLinkJS(){document.getElementById("linkButton").disabled=true;link(selectedCIids,unSelectedCIids)}function onSelect(a){try{if(parentName=="BMC_BaseElement__c"&&objAPINm=="Change_Request__c"){if(lastChecked&&lastChecked.name!=a.name){if(!isNotified&&lastChecked.checked){GetMessageBox("bmc-message").show({title:infoLbl,msg:MultipleCRLinkingInfo,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.WARNING});isNotified=true;a.checked=false;return}var c=document.getElementsByName(lastChecked.name)[0];if(c){document.getElementsByName(lastChecked.name)[0].checked=false}else{if(lastChecked&&typeof(lastChecked.checked)!="undefined"){lastChecked.checked=false}}unSelectedCIids=unSelectedCIids+lastChecked.name+NONPRINT1}lastChecked=a}}catch(b){}checkone(a)}function checkone(k){var q=0;var p=0;var n=k.checked;var t="¬";var o=Ext.getCmp("linkButton");var l=Ext.getCmp("fulfillButton");if(n==true){if(selectedCIids!=null&&selectedCIids!=undefined){selectedCIids=selectedCIids+k.name+t;if(o){o.setDisabled(false)}if(l){l.setDisabled(false)}}else{selectedCIids=k.name+t}if(unSelectedCIids!=null&&unSelectedCIids!=undefined&&unSelectedCIids.length>=1){var g=unSelectedCIids.split(t);var d="";for(var m=0;m<g.length;m++){if(g[m]!=k.name&&g[m]!=""){d=d+g[m]+t}}unSelectedCIids=d}setIdsForLink(k)}if(n==false){unSelectedCIids=unSelectedCIids+k.name+t;if((selectedCIids.length)>=1){var g=selectedCIids.split(t);var d="";for(var m=0;m<g.length;m++){if(g[m]!=k.name&&g[m]!=""){d=d+g[m]+t}}selectedCIids=d}setIdsForLink(k)}var r=document.getElementsByTagName("input");var s="";if(isFromSR){s="checkedFulfill"}else{s="checkedone"}selectedCIids="";for(var m=0;m<r.length;m++){if(r[m].id==s){q=q+1}if(r[m].id==s&&r[m].checked==true){p=p+1;selectedCIids=selectedCIids+r[m].name+t}}if(p==q){document.getElementById("selectAllcheckBox").checked=true}else{document.getElementById("selectAllcheckBox").checked=false}var b=selectedCIids.split(t);var c=Ext.getCmp("linkParentBtnId");var e=Ext.getCmp("linkChildBtnId");if(selectedCIids.length==0){if(o){o.setDisabled(true)}if(l){l.setDisabled(true)}}if((b.length)==2&&(hasParent==null||hasParent=="")&&childCount==0&&enableMerge){var a=b[0];var h=a.split(":");if(c){c.setDisabled(false)}if(lblParentLabel!=""||typeof(lblParentLabel)!="undefined"||hidMergedIncidents!=null){lblParentLabel=lblParentLabel.replace("{0}",title);if(c){c.setText(lblParentLabel)}}}else{if((b.length)>2||(b.length)<2){if(c){c.setDisabled(true);c.setText(lblLinkasParent)}}}if((b.length)>=2&&(hasParent==null||hasParent=="")&&enableMerge){if(e){e.setDisabled(false)}if(lblChildLabel!=""||typeof(lblChildLabel)!="undefined"||hidMergedIncidents!=null){lblChildLabel=lblChildLabel.replace("{0}",title);if(e){e.setText(lblChildLabel)}}}else{if((b.length)<2){if(e){e.setDisabled(true);e.setText(lblLinkasChild)}}}}function openMultiInstanceEditor(){selectedIds="";selectedClass=[];selectedInstanceTypes=[];var c="¬";var b=[];if(selectedIdsForMerge!=null){for(var a=0;a<selectedIdsForMerge.length;a++){b=selectedIdsForMerge[a].split(":");if(b!=null){if(b.length>1){selectedIds=selectedIds+b[0]+c;selectedClass.push(b[1])}if(b.length>2){selectedInstanceTypes.push(b[2])}}}}if(selectedIds!=""){window.open("/apex/CMDBManager","MultiInstanceWindowFulfill")}else{GetMessageBox("bmc-message").show({msg:atleastOneRecord,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.WARNING})}}function searchOnKeyPress(h){var n;if(window.event){n=h.keyCode}else{if(typeof(h.which)!="undefined"){n=h.which}else{n=h.getKey()}}var b=document.getElementById(searchField);var a=document.getElementById("clearLink");if(b&&a){if(b.value.length>0){a.style.visibility="visible"}else{a.style.visibility="hidden";clearText()}}if(n==13){var g=document.getElementById("searchTextId");var d=document.getElementById("minTwoChar");var m=document.getElementById(noRecordFound);if(typeof(g)!="undefined"&&g!=null){var k=g.value.trim();var l=k.replace(/[*"]/gi,"");if(l.trim().length<2){if(m.style.display==""){m.style.display="none"}d.style.display="block";return false}else{d.style.display="none"}if(isAnyRecordSelected()){var c={};c.strWithoutSplChars=l;showRfConfirmationBoxToClearOfSelection("searchCIonKeyPress",c)}else{searchCI(l)}}else{beforeSearchCI()}}else{return true}return false}function goOnKeyPress(c,b){var g;var a=/^[0-9]+$/;if(window.event){g=c.keyCode}else{if(c.which){g=c.which}}if(!(b.match(a))){b="1"}else{if(!isNaN(b)&&!isNaN(totalNumberOfPages)&&parseInt(b)>totalNumberOfPages){b=totalNumberOfPages;var d=document.getElementById("pageSizeInputId")}}if(g==13){goToPage(b)}else{return true}return false}function setResultListHeightJS(){if(lightningUI){hideLoadingMask()}showPageMsg();if(childObjectName.toLowerCase()=="businesshours"){var b=document.getElementById("currPage");if(b){b.setAttribute("disabled","disabled")}}var a=Ext.isIE?document.documentElement.offsetHeight:window.innerHeight;if(a>180){var d=0;if(typeof(isForNormalizationExcep)!="undefined"&&isForNormalizationExcep){d=15}else{if((parentName&&parentName=="Matching")||isOptionalFilter){d=30;if(hasParentName&&hasParentName!=""){d=75}}}a=a-(180+d);var h=document.getElementById(param);var c=document.getElementById(param1);var e;if(typeof(c)!="undefined"&&c!=null){e=RemedyForceHTMLProcessor.getText(c)}var g=e.indexOf(atleastOneRecord);if(h!=null&&h!=undefined&&h!=""){if(lightningUI){h.style.height=(a+70)+"px"}else{h.style.height=(a+35)+"px"}}if(g!=-1){a=a-45;h.style.height=(a+85)+"px"}}}function clearLists(){selectedCIids="";unSelectedCIids=""}function first(){if(lightningUI){showLoadingMask()}firstPage(selectedCIids,unSelectedCIids);clearLists()}function next(){if(lightningUI){showLoadingMask()}nextPage(selectedCIids,unSelectedCIids);clearLists()}function previous(){if(lightningUI){showLoadingMask()}previousPage(selectedCIids,unSelectedCIids);clearLists()}function last(){if(lightningUI){showLoadingMask()}lastPage(selectedCIids,unSelectedCIids);clearLists()}function fetchPageJS(a){if(lightningUI){showLoadingMask()}fetchPage(a,selectedCIids,unSelectedCIids)}function goToPage(a){if(lightningUI){showLoadingMask()}goToPageJS(a,selectedCIids,unSelectedCIids);clearLists()}function setResetSelectAllJS(a){hideAllErrorMessage();allIDSelected=a;var b=Ext.getCmp("linkButton");var e=Ext.getCmp("fulfillButton");if(a){var d=document.getElementsByTagName("input");if(b){b.setDisabled(false)}if(e){e.setDisabled(false)}for(var c=0;c<d.length;c++){if(d[c].type=="checkbox"&&d[c].checked){if(document.getElementById("hidMergedIncidents").value.indexOf(d[c].name)>0){childFoundForReMerge=true;break}}}}else{childFoundForReMerge=false;if(b){b.setDisabled(true)}if(e){e.setDisabled(true)}}clearLists();setResetSelectAll(a)}function toggleFilter(a){hideAllErrorMessage();lastAdvancedSearchedString="";lastClassIdinCriteria="";advancedFilterApplied=false;resetAdvancedSearchFilterIcon();searchTextId=document.getElementById("searchTextId");var b;if(searchTextId){if(searchTextId.nextSibling){b=searchTextId.nextSibling}}else{searchTextId=document.getElementById(searchFieldNew);b=document.getElementById("clearLink")}if(b){b.style.visibility="hidden"}searchTextId.value="";if(a){showAllRecords(filteredFiledForMatchingCI,"")}else{reApplyLKFilter(filteredFiledForMatchingCI,"")}}function isCJKChar(c){var b=/[\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/;var a=b.test(c);return(a)}function getSelectedInstanceFilter(){var a="CIClasses";a=Ext.util.Cookies.get("apex__InstanceFilter");selectedFilter(a);if(a!=null&&typeof(a)!="undefined"){if(a=="CIClasses"){selectedInstanceTypeFilter=lblCIClasses}else{if(a=="AssetClasses"){selectedInstanceTypeFilter=lblAssetClasses}else{if(a=="AllClasses"){selectedInstanceTypeFilter=lblAllClasses}else{selectedInstanceTypeFilter=lblCIClasses}}}}return selectedInstanceTypeFilter}var selectedRow;function addVariationToExistingNormRule(){updateNormRule(SelectedNormRuleID)}var windowOpner;if(typeof(isForNormalizationExcep)!="undefined"&&isForNormalizationExcep==true&&typeof(window.opener)!="undefined"){windowOpner=window.opener.NormAssignWindow}function openNormalizationRule(){if(typeof(window.opener)!="undefined"){window.opener.openNormRuleForExcep(SelectedNormRuleID,selectedNormName,MapAndOpenRule)}else{windowOpner.close()}}var MapAndOpenRule;function MapAndOpenRule(a){MapAndOpenRule=a;addVariationToExistingNormRule()}function enableNormBtn(e,d,b){var a=["MapNormRule","MapAndOpenNormRule"];if(SelectedNormRuleID!="NoSelection"){var c=document.getElementById(SelectedNormRuleID);if(c!=undefined){c.checked=false}}if(SelectedNormRuleID==d){SelectedNormRuleID="NoSelection";HighlightSelection(e,false);enableDisableBtn(a,true)}else{SelectedNormRuleID=d;selectedNormName=b;HighlightSelection(e,true);enableDisableBtn(a,false)}}function HighlightSelection(c,a){var b=c.parentNode;if(b!=undefined){b=b.parentNode}if(b!=undefined&&a==true){b.className=b.className+" highlight1 "}if(selectedRow!=undefined&&(a==false||selectedRow!=b)){if(selectedRow.className.indexOf("highlight1")!=-1){selectedRow.className=selectedRow.className.replace("highlight1","")}}selectedRow=b}function enableDisableBtn(a,b){var d=0;for(d=0;d<a.length;d++){var c=document.getElementById(a[d]);if(c!=undefined){c.disabled=b}}}function hideWaitMsgBar(){if(typeof(waitingMask)!="undefined"&&waitingMask!=null&&waitingMask!=""){waitingMask.hide()}}function showWaitMsgBar(){waitingMask=new Ext.LoadMask(Ext.getBody(),{msg:pleaseWaitMsg});if(typeof(waitingMask)!="undefined"&&waitingMask!=null&&waitingMask!=""){waitingMask.show()}}function createMenuBar(c){if(userLanguage&&userLanguage=="iw"){c.reverse()}var b=Ext.extend(Ext.Panel,{renderTo:"toolbarPanel",border:false,defaults:{bodyStyle:"padding:0px;margin:0px;zoom:0px;"}});mnuBar=new b({border:true,bodyStyle:"padding:0px;margin:0px;zoom:0px;",tbar:c,id:"mnuBarId"});if(isFromNewCMDBExplorer){var a=Ext.getCmp("actionButton");if(a){a.disable()}}}function createLinkOkBtn(){var a={scale:"medium",tooltipType:"title",tooltip:isLkp?Ok:lblLink,id:"linkButton",disabled:"true",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:isLkp?Ok:lblLink,hidden:!displayLinkBtn,listeners:{mouseover:function(){this.setIconCls("bmcEditCIOn")},mouseout:function(){this.setIconCls("bmcEditCI")},disable:function(){this.setIconCls("bmcEditCIDisable")},enable:function(){this.setIconCls("bmcEditCI")}},handler:callLinkJS1};return a}function createGoBtn(a){var b={scale:"medium",id:"goBtns",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:lblGoBtn,handler:a};return b}function openAdvancedSearch(){if(AdvancedFilterPopUp){AdvancedFilterPopUp.show();if(userLanguage=="iw"){if(advSearch){AdvancedFilterPopUp.alignTo("advancedSearch","tl-bl",[1,0])}else{AdvancedFilterPopUp.alignTo("FilterBtn","tl-bl",[1,0])}}else{if(advSearch){AdvancedFilterPopUp.alignTo("advancedSearch","tr-br",[0,1])}else{AdvancedFilterPopUp.alignTo("FilterBtn","tr-br",[1,0])}}}else{openWindow()}filterWindowOpened=true}function createAdvancedSearch(){var a={id:"FilterBtn",scale:"medium",iconCls:"filterBtn",cls:"bmc-btn-search",tooltip:AdvancedSearch,tooltipType:"title",handler:openAdvancedSearch,overflowText:AdvancedSearch,style:{top:"5px",left:"5px"}};return a}function createFulfillButton(){var a={scale:"medium",tooltipType:"title",tooltip:Fulfill_Service_Request,id:"fulfillButton",disabled:true,baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:Fulfill_Service_Request,hidden:!displayFulfillRequestBtn,listeners:{mouseover:function(){this.setIconCls("bmcEditCIOn")},mouseout:function(){this.setIconCls("bmcEditCI")},disable:function(){this.setIconCls("bmcEditCIDisable")},enable:function(){this.setIconCls("bmcEditCI")}},handler:openMultiInstanceEditor};return a}function toolbarSearchCmp(a){var b=new Ext.Component({html:'<span class="searchtext-input-wrapper"><a title="'+lblSearch+'"class="rf-icon-search" onclick="'+a+'" ></a> <input type="text" id="searchTextId" name="searchTxt" class="searchfield-input" autocomplete="off" size="26" placeholder="'+lblSearch+'" /><a title="'+lblClear+'"  class="rf-icon-cross" ></a></span>'});return b}function RenderSearchComponent(d){var c=document.getElementById("searchTextId");var b=document.getElementById(searchField);var a=c.nextSibling;if(SearchStringVal){c.value=SearchStringVal;a.style.visibility="visible"}c.onkeyup=function(g){a.style.visibility=(this.value.length)?"visible":"hidden";if(g.keyCode===13){if(incidentMatching=="Matching"){applySearch()}else{if(d){applySearchProblem()}else{beforeapplySearchCI()}}}if(this.value==""&&searchstring!=""){if(incidentMatching=="Matching"){applyFilter()}else{if(d){applyFilterProblem()}else{if(!advancedFilterApplied){applyFilterCI()}}}}};a.onclick=function(){c.value="";isFromRefresh=true;if(b){b.value=""}this.style.visibility="hidden";if(incidentMatching=="Matching"){applyFilter()}else{if(d){applyFilterProblem()}else{if(!advancedFilterApplied){applyFilterCI()}}}}}function applyRefresh(){if(lightningUI){showLoadingMask()}if(incidentMatching=="Matching"){applyRefreshMatching()}else{if(isCIChild){applyRefreshCI()}else{isFromRefresh=true;var b=document.getElementById("searchTextId");var a="";if(b){a=b.value}searchCI(a,lastAdvancedSearchedString,lastClassIdinCriteria)}}}function applyRefreshMatching(){var c=document.getElementById("searchTextId");var b=c.value;var a=b.replace(/[*"]/gi,"");applyFilterOnMaching(filteredFieldsForMatching,c.value)}function applyRefreshCI(){if((parentName=="Incident__c"&&childObjectName=="BMC_BaseElement__c")){var d=document.getElementById("searchTextId").value;var b=document.getElementById(pageSizePerPageList).value;searchCIsOnRefresh("",b,selectedCIids,unSelectedCIids,false,lastAdvancedSearchedString,lastClassIdinCriteria,filteredFiledForMatchingCI,d,"","refresh")}else{if((childObjectName=="BMC_BaseElement__c")&&(parentName=="Problem__c"||parentName=="Change_Request__c"||parentName=="Task__c"||parentName=="AdminLocation"||parentName=="Release__c"||parentName=="KM_KnowledgeArticle__c"||lookUpType=="FulfillReqLookup")){isFromRefresh=true;var e=document.getElementById("searchTextId");if(e==null){e=document.getElementById(searchFieldNew)}var c=e.value;var a=c.replace(/[*"]/gi,"");searchCI(a,lastAdvancedSearchedString,lastClassIdinCriteria)}}}var Xin,Yin;function openWindow(){var c;if(typeof(classRecord)=="undefined"||classRecord==null){classRecord="BMC_BaseElement"}var a=document.getElementById("mnuBarId");if(typeof("MainPanel")!="undefined"&&a!=null){var b=a.getBoundingClientRect();Xin=b.right-100}else{Xin=735}Yin=40;if(uiTheme=="Theme4d"){Yin=50}url="AdvancedSearchFilter?className="+urlencode(classRecord)+"&classType=&tabName="+urlencode(selectedTab)+"&IsSearchAndLink=true&addFilterName="+addFilterName;AdvancedFilterPopUp=new Ext.Window({width:595,height:Ext.isGecko?297:292,closable:false,shadow:false,header:false,id:"win",closeAction:"hide",resizable:false,bodyStyle:"background-color:#FFFFFF;",style:"padding: 0; border-width: 0;",constrain:true,viewConfig:{forceFit:true},frame:false,html:'<iframe id="advSearchFrame" frameborder="0" src ="/apex/'+url+'" style="width:100%;height:100%;"/>'});AdvancedFilterPopUp.show();advSearch=document.getElementById("advancedSearch");if(userLanguage=="iw"){if(advSearch){AdvancedFilterPopUp.alignTo("advancedSearch","tl-bl",[1,0])}else{AdvancedFilterPopUp.alignTo("FilterBtn","tl-bl",[1,0])}}else{if(advSearch){AdvancedFilterPopUp.alignTo("advancedSearch","tr-br",[0,1])}else{AdvancedFilterPopUp.alignTo("FilterBtn","tr-br",[1,0])}}}Ext.EventManager.onWindowResize(function(){var a=Ext.getCmp("mnuBarId");if(a){mnuBar.setWidth(window.innerWidth)}if(AdvancedFilterPopUp!=undefined&&AdvancedFilterPopUp!=null&&filterWindowOpened){AdvancedFilterPopUp.setPosition(window.innerWidth-610,Yin,true)}});document.onclick=closePopUp;function closePopUp(a){a=a||window.event;a=a.target||a.srcElement;if(a.id&&a.id.indexOf("FilterBtn-btn")&&a.id!="advancedSearch"){if(filterWindowOpened){AdvancedFilterPopUp.hide();filterWindowOpened=false}}}function callAdvancedSearch(d,c){var a=document.getElementById("advancedSearch");var b=Ext.getCmp("FilterBtn");if(AdvancedFilterName!=null&&AdvancedFilterName!=""){if(a){a.src=BMCRFSDEFStylesPath+"/Images/cmdb_icon-advanced-filter-applied.svg";a.setAttribute("title",FilterIconTooltip)}else{if(b){b.setIconCls("filterBtn-applied");b.setTooltip(FilterIconTooltip)}}}else{if(a){a.src=BMCRFSDEFStylesPath+"/Images/cmdb_icon-advanced-filter.svg";a.setAttribute("title",AdvancedSearch)}else{if(b){b.setIconCls("filterBtn");b.setTooltip(AdvancedSearch)}}}fromAdvancedFilter=true;applySearchCI(d,c)}function urlencode(a){return encodeURIComponent(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function showPageMsg(){try{var a=document.getElementById(pageMessageId);var e;if(a!=null&&a!="undefined"&&a.hasChildNodes()){a.style.display="none";e=a.textContent}else{if(isFromNewCMDBExplorer&&cmdbExplorerErrorMsg!=""){e=cmdbExplorerErrorMsg;cmdbExplorerErrorMsg=""}}if(e){var d=document.getElementById("errorDescId");var b=document.getElementById("jsscripterrorId");if(b){b.setAttribute("style","display:block");RemedyForceHTMLProcessor.parseHTML(d,"<label>"+e+"</label>")}}}catch(c){}}function hideAllErrorMessage(){var c=document.getElementById("minTwoChar");if(c){c.style.display="none"}var b=document.getElementById("jsscripterrorId");if(b){b.style.display="none"}var a=document.getElementById(noRecordFound);if(a){a.style.display="none"}}function showWarningMSG(a){showLightningPopup("toast","Warning",a,"","","","","warning")}function isAnyRecordSelected(){if(selectedCIids.length>0){return true}else{if(typeof(selectedIdMap)=="object"&&Object.keys(selectedIdMap).length>0){if(unSelectedCIids.length>0){var a=unSelectedCIids.split(NONPRINT1);for(var b=0;b<a.length-1;b++){if(selectedIdMap[a[b].split(":")[0]]){delete selectedIdMap[a[b].split(":")[0]]}}if(Object.keys(selectedIdMap).length>0){return true}else{return false}}else{if(unSelectedCIids.length==0){return true}else{return false}}}else{return false}}}function showRfConfirmationBoxToClearOfSelection(a,b){GetMessageBox("bmc-message").show({title:warning,msg:SelectedValuesWillNotBeRetained,icon:Ext.MessageBox.WARNING,buttons:Ext.Msg.OKCANCEL,fn:function(c){if(c=="ok"){applyFilterPostOkClickOnMsgBox(a,b)}else{if(a=="appplyInstanceTypeFilter"){selectedFilter(selectedInstanceTypeFilter);document.getElementById(b.combo.inputId).value=selectedInstanceTypeFilter}return}}})}function applyFilterPostOkClickOnMsgBox(a,b){if(a=="beforeSearchCI"){if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon();searchCI()}}else{if(a=="applyFilterCIForIncident"){document.getElementById("searchTextId").value="";if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon()}applyCIFilterOnMaching(filteredFiledForMatchingCI,"");clearLists()}else{if(a=="applyFilterCI"){if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon()}document.getElementById("searchTextId").value="";clearLists();searchCI()}else{if(a=="appplyInstanceTypeFilter"){selectedFilter(b.newSelect);if(b.newSelect!=selectedInstanceTypeFilter){selectedInstanceTypeFilter=b.newSelect;isApplyInstanceFilter=true;if(b.searchTextId&&b.searchTextId.value.length>0){if(advancedFilterApplied){advancedFilterApplied=false;resetAdvancedSearchFilterIcon()}}applyInstanceTypeFilter(b.newSelect,b.filteredFieldsForMatching,b.searchTextId.value,lastAdvancedSearchedString,lastClassIdinCriteria)}clearLists()}else{if(a=="applySearchCIForIncident"){if(fromAdvancedFilter){b.searchTextId.value="";if(typeof(b.clearBtn)!="undefined"){b.clearBtn.style.visibility="hidden"}}fromAdvancedFilter=false;selectedIdsForMerge=[];applyCIFilterOnMaching(filteredFiledForMatchingCI,b.searchTextId.value,b.advancedSearchedString,b.ClassIdinCriteria);clearLists()}else{if(a=="applySearchCI"){if(fromAdvancedFilter){b.searchTextId.value="";if(typeof(b.clrBtn)!="undefined"){b.clrBtn.style.visibility="hidden"}if(typeof(b.clearBtn)!="undefined"){b.clearBtn.style.visibility="hidden"}}fromAdvancedFilter=false;searchCI(b.strWithoutSplChars,b.advancedSearchedString,b.ClassIdinCriteria)}else{if(a=="searchCIonKeyPress"){searchCI(b.strWithoutSplChars)}else{if(a=="applyFilterProblem"){var c=document.getElementById("searchTextId");if(c){c.value=""}clearLists();applyFilterProblemAF(filterFlags,"")}else{if(a=="applySearchProblem"){document.getElementById("hidMergedIncidents").value="";selectedIdsForMerge=[];clearLists();lastChecked="";applyFilterProblemAF(filterFlags,b.searchstring)}}}}}}}}}};