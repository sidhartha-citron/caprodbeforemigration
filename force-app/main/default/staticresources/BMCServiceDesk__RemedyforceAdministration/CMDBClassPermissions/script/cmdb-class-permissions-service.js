angular.module("CMDBClassPermissionsModule").service("cmdbClassPermissionsService",["$q","rfModal",function(a,b){this.rfModal=b;self={};self.showMask=function(){$("#sideBarloader").css("display","block");$("#sideBarActionMask").css("display","block")};self.hideMask=function(){$("#sideBarloader").css("display","none");$("#sideBarActionMask").css("display","none")};this.getCMDBClassPermissions=function(f,c){var d=a.defer();self.showMask();var e={permissionSetId:f,isImport:c};Visualforce.remoting.Manager.invokeAction(_RemotingActions.getCMDBClassPermissions,e,function(g,h){if(h.status){if(g.indexOf("Error::: ")==0){g=g.replace("Error::: ","");b.openInfoMessage(null,"error",g,2000,"[id=messageDiv]")}else{d.resolve(g)}}else{b.openInfoMessage(null,"error",h.message,2000,"[id=messageDiv]");d.reject()}self.hideMask()},{escape:false});return d.promise};this.save=function(c,e){var d=a.defer();self.showMask();Visualforce.remoting.Manager.invokeAction(_RemotingActions.save,c,e,function(f,g){self.hideMask();if(g.status){b.openInfoMessage(null,"success",f,2000,"[id=messageDiv]");d.resolve(f)}else{b.openInfoMessage(null,"error",g.message,2000,"[id=messageDiv]");d.reject()}},{escape:false});return d.promise};this.saveFeatureEnablement=function(d){var c=a.defer();self.showMask();var e={isCMDBClassPermissionEnable:d};Visualforce.remoting.Manager.invokeAction(_RemotingActions.saveFeatureEnablement,e,function(f,g){if(g.status){b.openInfoMessage(null,"success",f,2000,"[id=messageDiv]");c.resolve(f)}else{b.openInfoMessage(null,"error",g.message,2000,"[id=messageDiv]");c.reject()}self.hideMask()},{escape:false});return c.promise};this.findPS=function(d){var c=a.defer();self.showMask();Visualforce.remoting.Manager.invokeAction(_RemotingActions.getPermissionSets,"search",d,function(e,f){if(f.status){c.resolve(e)}else{b.openInfoMessage(null,"error",f.message,2000,"[id=messageDiv]");c.reject()}self.hideMask()},{escape:false});return c.promise};this.clonePermissions=function(e,d){var c=a.defer();self.showMask();Visualforce.remoting.Manager.invokeAction(_RemotingActions.clonePermissions,e,d,function(f,g){if(g.status){c.resolve(f)}else{b.openInfoMessage(null,"error",g.message,2000,"[id=messageDiv]");c.reject()}self.hideMask()},{escape:false});return c.promise};this.getSavedPSRecsForCloning=function(e,d){var c=a.defer();self.showMask();var d={selectedPSId:e};Visualforce.remoting.Manager.invokeAction(_RemotingActions.getPermissionSets,"clone",d,function(f,g){if(g.status){c.resolve(f)}else{b.openInfoMessage(null,"error",g.message,undefined,"[id=messageDiv]");c.reject()}self.hideMask()},{escape:false});return c.promise}}]);