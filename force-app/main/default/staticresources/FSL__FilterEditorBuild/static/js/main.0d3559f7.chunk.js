(this["webpackJsonpfilter-editor"]=this["webpackJsonpfilter-editor"]||[]).push([[0],[,,,,,,,,function(e,t,i){},,,,,,,,,,,,,function(e,t,i){},,function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t);var a=i(1),s=i(9),l=i.n(s),n=(i(8),i(2)),r=i(3),o=i(5),d=i(4),c=(i(21),i(0)),h=function(e){Object(o.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(n.a)(this,i),(a=t.call(this,e)).state={},a.state[window.FilterEditor.fieldNames.Name]=e.object[window.FilterEditor.fieldNames.Name],a.state[window.FilterEditor.fieldNames.Description__c]=e.object[window.FilterEditor.fieldNames.Description__c],a.state[window.FilterEditor.fieldNames.Description__c]?a.state.charactersLeft=255-a.state[window.FilterEditor.fieldNames.Description__c].length:a.state.charactersLeft=255,a}return Object(r.a)(i,[{key:"render",value:function(){return Object(c.jsxs)("div",{className:"fe-details-container section-container",children:[Object(c.jsx)("h1",{className:"section-title",children:window.FilterEditor.labels.Details}),Object(c.jsxs)("div",{className:"fe-general-input-container",children:[Object(c.jsx)("label",{className:"fe-general-input-label",children:window.FilterEditor.labels.Name}),Object(c.jsx)("input",{type:"text",maxlength:"100",className:"fe-general-input-text",placeholder:window.FilterEditor.labels.NamePlaceholder,value:this.state[window.FilterEditor.fieldNames.Name],onChange:this.__fieldChanged.bind(this,window.FilterEditor.fieldNames.Name)})]}),Object(c.jsxs)("div",{className:"fe-general-input-container",children:[Object(c.jsx)("label",{className:"fe-general-input-label",children:window.FilterEditor.labels.Description}),Object(c.jsx)("textarea",{className:"fe-general-input-textarea",maxlength:"255",placeholder:window.FilterEditor.labels.DescriptionPlaceholder,value:this.state[window.FilterEditor.fieldNames.Description__c],onChange:this.__fieldChanged.bind(this,window.FilterEditor.fieldNames.Description__c)}),Object(c.jsx)("div",{children:window.FilterEditor.labels.CharactersLeft.replace("$0",this.state.charactersLeft)})]})]})}},{key:"componentWillReceiveProps",value:function(e){if(e.object){var t={};t[window.FilterEditor.fieldNames.Name]=e.object[window.FilterEditor.fieldNames.Name],t[window.FilterEditor.fieldNames.Description__c]=e.object[window.FilterEditor.fieldNames.Description__c],this.state[window.FilterEditor.fieldNames.Description__c]?t.charactersLeft=255-t[window.FilterEditor.fieldNames.Description__c].length:t.charactersLeft=255,this.setState(t)}}},{key:"__fieldChanged",value:function(e,t){var i={};i[e]=t.target.value,this.props.update(i)}}]),i}(a.Component),u=(i(23),function(e){Object(o.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(n.a)(this,i),(a=t.call(this,e)).state={minDays:e.object[window.FilterEditor.fieldNames.Days_after_horizon__c]||7,maxDays:e.object[window.FilterEditor.fieldNames.Days_before_horizon__c]||7,onlyGanttAppointments:e.object[window.FilterEditor.fieldNames.List_only_appointments_on_the_gantt__c]||!1},a}return Object(r.a)(i,[{key:"render",value:function(){return Object(c.jsxs)("div",{className:"fe-date-selection section-container",children:[Object(c.jsx)("h1",{className:"section-title",children:window.FilterEditor.labels.DateSelection}),Object(c.jsxs)("span",{children:[Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{type:"radio",value:"dates",name:"ganttapps",id:"fe-check-days",checked:!this.state.onlyGanttAppointments,onChange:this.onlyGanttChanged.bind(this)}),Object(c.jsxs)("label",{for:"fe-check-days",children:[window.FilterEditor.labels.ShowSAFromLast,Object(c.jsx)("input",{className:"fe-general-input-text fe-date-input",type:"number",min:"0",max:"31",value:this.state.minDays,onChange:this.valueChanged.bind(this,"minDays"),onKeyPress:this.disableManualInput}),window.FilterEditor.labels.DaysAndNext,Object(c.jsx)("input",{className:"fe-general-input-text fe-date-input",type:"number",min:"0",max:"31",value:this.state.maxDays,onChange:this.valueChanged.bind(this,"maxDays"),onKeyPress:this.disableManualInput}),window.FilterEditor.labels.daysPastIt]})]}),Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{type:"radio",value:"gantt",name:"ganttapps",id:"fe-check-gantt",checked:this.state.onlyGanttAppointments,onChange:this.onlyGanttChanged.bind(this)}),Object(c.jsx)("label",{for:"fe-check-gantt",children:window.FilterEditor.labels.ShowOnlySaOnGantt})]})]})]})}},{key:"disableManualInput",value:function(e){e.preventDefault()}},{key:"onlyGanttChanged",value:function(e){var t={};t[window.FilterEditor.fieldNames.List_only_appointments_on_the_gantt__c]="gantt"===e.target.value,this.props.update(t)}},{key:"valueChanged",value:function(e,t){var i={},a={};a[e]=t.target.value,"minDays"===e?i[window.FilterEditor.fieldNames.Days_before_horizon__c]=t.target.value:i[window.FilterEditor.fieldNames.Days_after_horizon__c]=t.target.value,this.props.update(i),this.setState(a)}},{key:"componentWillReceiveProps",value:function(e){var t={};t.onlyGanttAppointments=e.object[window.FilterEditor.fieldNames.List_only_appointments_on_the_gantt__c],t.maxDays=e.object[window.FilterEditor.fieldNames.Days_after_horizon__c],t.minDays=e.object[window.FilterEditor.fieldNames.Days_before_horizon__c],this.setState(t)}}]),i}(a.Component)),p=i(6),f="BOOLEAN",v="DATE",b="DATETIME",w="DOUBLE",m="EMAIL",j="ID",_="INTEGER",g="PICKLIST",F="REFERENCE",E="STRING",O="TEXTAREA",y="CURRENCY",x="PERCENT",N={equals:{label:window.FilterEditor.labels.equals,availability:[f,v,b,w,m,j,_,F,E,O,y,x]},"not equal to":{label:window.FilterEditor.labels.not_equal_to,availability:[f,v,b,w,m,j,_,F,E,O,y,x]},"less than":{label:window.FilterEditor.labels.less_than,availability:[v,b,_,w,E,O,y,x]},"greater than":{label:window.FilterEditor.labels.greater_than,availability:[v,b,_,w,E,O,y,x]},"less or equal":{label:window.FilterEditor.labels.less_or_equal,availability:[v,b,_,w,E,O,y,x]},"greater or equal":{label:window.FilterEditor.labels.greater_or_equal,availability:[v,b,_,w,E,O,y,x]},contains:{label:window.FilterEditor.labels.contains,availability:[g,E,O,F]},"does not contain":{label:window.FilterEditor.labels.does_not_contain,availability:[g,E,O,F]},"start with":{label:window.FilterEditor.labels.start_with,availability:[E,O,F]}},C=(i(24),function(e){Object(o.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(n.a)(this,i),(a=t.call(this,e)).state={values:{}},e.picklist.forEach((function(t){a.state.values[t]=e.value.indexOf(t)>-1})),a}return Object(r.a)(i,[{key:"render",value:function(){var e=this;if(!this.props.showPicklist)return null;var t=[];for(var i in this.state.values)t.push(Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{type:"checkbox",id:"picklist_value_checkbox_"+t.length,checked:this.state.values[i],onChange:this.checkboxClicked.bind(this,i)}),Object(c.jsx)("label",{for:"picklist_value_checkbox_"+t.length,children:i})]}));return[Object(c.jsx)("div",{className:"fe-blocker",onClick:function(t){t.stopPropagation(),e.props.hide()}}),Object(c.jsx)("div",{className:"fe-picklist-background",children:Object(c.jsx)("div",{className:"fe-picklist-select",children:t})})]}},{key:"componentWillReceiveProps",value:function(e){var t={values:{}};e.picklist.forEach((function(i){t.values[i]=e.value.indexOf(i)>-1})),this.setState(t)}},{key:"checkboxClicked",value:function(e,t){t.stopPropagation(),this.props.updateValue(e)}}]),i}(a.Component)),D=function(e){Object(o.a)(i,e);var t=Object(d.a)(i);function i(e){var a;if(Object(n.a)(this,i),(a=t.call(this,e)).valueHtmlElement=null,a.dhtmlxCalendar=null,a.state={property:e.condition&&e.condition.property||null,operator:e.condition&&e.condition.operator||null,value:e.condition&&e.condition.value||null,valueDateDisplay:null,showPicklist:!1,picklistValueDisplay:null,isValid:!1,isEmpty:!0,errorMessage:null},a.state.value&&(a.state.isEmpty=!1,a.state.isValid=!0,Array.isArray(a.state.value)&&(a.state.picklistValueDisplay=a.state.value.join(", "))),a.state.property){var s=e.fields[a.state.property][1];"DATETIME"===s&&a.state.value?a.state.valueDateDisplay=new Date(a.state.value).toLocaleString():"DATE"===s&&a.state.value?a.state.valueDateDisplay=new Date(a.state.value).toLocaleDateString():"BOOLEAN"===s&&("false"===a.state.value?a.state.value=!1:a.state.value=!0)}return a}return Object(r.a)(i,[{key:"componentDidMount",value:function(){if(this.state.property){var e=this.props.fields[this.state.property][1];"DATE"===e?(this.dhtmlxCalendar=new window.dhtmlXCalendarObject("value_field_"+this.props.index),this.dhtmlxCalendar.hideTime(),this.attachDhtmlxEvents()):"DATETIME"===e&&(this.dhtmlxCalendar=new window.dhtmlXCalendarObject("value_field_"+this.props.index),this.attachDhtmlxEvents())}}},{key:"componentDidUpdate",value:function(e,t){if(this.state.property){var i=this.props.fields[this.state.property][1];if(t.property&&t.property)if(this.props.fields[t.property][1]===i)return;"DATE"===i?(this.dhtmlxCalendar=new window.dhtmlXCalendarObject("value_field_"+this.props.index),this.dhtmlxCalendar.hideTime(),this.attachDhtmlxEvents()):"DATETIME"===i&&(this.dhtmlxCalendar=new window.dhtmlXCalendarObject("value_field_"+this.props.index),this.attachDhtmlxEvents())}}},{key:"render",value:function(){var e=this.state.isValid||this.state.isEmpty?null:Object(c.jsx)("div",{className:"fe-condition-error",children:this.state.errorMessage});return Object(c.jsxs)("div",{className:"fe-condition",children:[Object(c.jsxs)("span",{class:"fe-condition-index",children:[this.props.index,"."]}),Object(c.jsx)("select",{className:"fe-select fe-select-field",onChange:this.propertyChanged.bind(this),value:this.state.property,children:this.generateFieldOptions()}),Object(c.jsxs)("select",{className:"fe-select fe-select-operator",onChange:this.operatorChanged.bind(this),value:this.state.operator,children:["disabled=",!this.state.operator,">",this.generateOperatorOptions()]}),this.generateValueInput(),e]})}},{key:"generateValueInput",value:function(){var e=this,t=null;return this.state.property&&(t=this.props.fields[this.state.property][1]),"BOOLEAN"===t?Object(c.jsxs)("select",{className:"fe-select fe-select-value",onChange:this.valueChanged.bind(this),value:this.state.value,children:[Object(c.jsx)("option",{value:!0,children:"true"}),Object(c.jsx)("option",{value:!1,children:"false"})]}):"PICKLIST"===t?[Object(c.jsx)("input",{type:"text",value:this.state.picklistValueDisplay,title:this.state.picklistValueDisplay,readOnly:!0,className:"fe-general-input-text",onClick:function(){return e.setState({showPicklist:!0})}}),Object(c.jsx)(C,{value:this.state.value,updateValue:this.updatePicklistValues.bind(this),showPicklist:this.state.showPicklist,picklist:this.props.fields[this.state.property][2],hide:function(){return e.setState({showPicklist:!1})}})]:Object(c.jsx)("input",{type:"text",id:"value_field_"+this.props.index,onChange:this.valueChanged.bind(this),className:"fe-general-input-text",disabled:!this.state.property,ref:function(t){return e.valueHtmlElement=t},readOnly:this.state.property&&("DATE"===this.props.fields[this.state.property][1]||"DATETIME"===this.props.fields[this.state.property][1]),value:this.state.valueDateDisplay||this.state.value})}},{key:"generateFieldOptions",value:function(){var e=[],t=this.props.fields;e.push(Object(c.jsx)("option",{value:"",children:"-- None --"}));var i=[];for(var a in t){var s=void 0;s="REFERENCE"===t[a][1]&&t[a][0].indexOf(" ID")>-1?t[a][0].substr(0,t[a][0].indexOf(" ID")):t[a][0],i.push([a,s])}return i.sort((function(e,t){return e[1].localeCompare(t[1])})),i.forEach((function(t){e.push(Object(c.jsx)("option",{value:t[0],children:t[1]}))})),e}},{key:"generateOperatorOptions",value:function(){if(!this.props.fields||!this.state.property)return null;var e=[],t=[];for(var i in N){var a=this.props.fields[this.state.property][1];N[i].availability.indexOf(a)>-1&&(e.push(Object(c.jsx)("option",{value:i,children:N[i].label})),t.push(i))}return-1===t.indexOf(this.state.operator)&&this.setState({operator:t[0]}),e}},{key:"attachDhtmlxEvents",value:function(){var e=this;this.dhtmlxCalendar.attachEvent("onChange",(function(t,i){var a="DATETIME"===e.props.fields[e.state.property][1]?t.toLocaleString():t.toLocaleDateString();e.setState({value:t.getTime(),valueDateDisplay:a});var s={};s[e.props.index]={property:e.state.property,operator:e.state.operator,value:t.getTime(),isValid:!0,isEmpty:!1},e.props.updateCondition(s)})),this.dhtmlxCalendar.attachEvent("onShow",(function(){e.state.value&&e.dhtmlxCalendar.setDate(new Date(e.state.value))}))}},{key:"propertyChanged",value:function(e){var t=this,i={property:e.target.value},a=""!==e.target.value?this.props.fields[e.target.value][1]:null;a||(i.operator=null,i.property=null,i.valueDateDisplay=null),this.valueHtmlElement&&(this.valueHtmlElement.value=null),i.value=null,"DATETIME"!==a&&"DATE"!==a&&this.dhtmlxCalendar&&this.dhtmlxCalendar.unload&&(this.dhtmlxCalendar.unload(),i.valueDateDisplay=null),"PICKLIST"===a?(i.value=[],i.picklistValueDisplay=null):"DATE"===a||"DATETIME"===a||"BOOLEAN"===a&&(i.value=!0),this.setState(i,(function(){t.addConditionToFilterObject()}))}},{key:"operatorChanged",value:function(e){var t=this;this.setState({operator:e.target.value},(function(){t.addConditionToFilterObject()}))}},{key:"valueChanged",value:function(e,t){var i=this;if(2===arguments.length)return"true"===e&&(e=!0),"false"===e&&(e=!1),void this.setState({value:e},(function(){"true"===e&&(e=!0),"false"===e&&(e=!1),i.addConditionToFilterObject()}));this.setState({value:e.target.value},(function(){i.addConditionToFilterObject()}))}},{key:"updatePicklistValues",value:function(e){var t,i=this,a=this.state.value.indexOf(e);-1===a?t=[].concat(Object(p.a)(this.state.value),[e]).sort():(t=Object(p.a)(this.state.value)).splice(a,1),this.setState({value:t,picklistValueDisplay:t.join(", ")},(function(){i.addConditionToFilterObject()}))}},{key:"checkIfHaveNull",value:function(){return!this.state.property||!this.state.operator||!this.state.value}},{key:"addConditionToFilterObject",value:function(){var e=this;if(this.state.property){var t={};this.checkIfValid((function(){t[e.props.index]={property:e.state.property,operator:e.state.operator,value:e.state.value,isValid:e.state.isValid},e.props.updateCondition(t)}))}else this.props.updateCondition(this.props.index,!0)}},{key:"checkIfValid",value:function(e){var t={},i=this.state.property,a=this.state.value;if(!i)return t.isEmpty=!0,t.isValid=!0,void this.setState({isValid:t.isValid,errorMessage:null,isEmpty:t.isEmpty});t.isEmpty=!1;var s=this.props.fields[this.state.property][1],l=!0;if(a)switch(s){case"DATETIME":var n=new Date(a);"Invalid Date"===n.toString()&&(t.isValid=!1,t.errorMessage=window.FilterEditor.labels.InvalidDateFormat,l=!1);break;case"DATE":"Invalid Date"===(n=new Date(a)).toString()&&(t.isValid=!1,t.errorMessage=window.FilterEditor.labels.InvalidDateFormat,l=!1);break;case"INTEGER":/^\d+$/.test(a)||(t.isValid=!1,t.errorMessage=window.FilterEditor.labels.InvalidNumber,l=!1);break;case"DOUBLE":isNaN(parseFloat(a))&&(t.isValid=!1,t.errorMessage=window.FilterEditor.labels.InvalidNumber,l=!1)}else t.isValid=!0,l=!1;l&&(t.isValid=!0,t.errorMessage=null),this.setState({isValid:t.isValid,errorMessage:t.errorMessage,isEmpty:t.isEmpty},e)}}]),i}(a.Component),k=(i(25),function(e){Object(o.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(n.a)(this,i),(a=t.call(this,e)).MAX_CRITERIAS=10,a.state={numberOfConditions:0,operators:[],logic:null},a}return Object(r.a)(i,[{key:"render",value:function(){return Object(c.jsxs)("div",{className:"fe-critera-container section-container",children:[Object(c.jsx)("h1",{className:"section-title",children:window.FilterEditor.labels.AdditionalCriteria}),Object(c.jsxs)("div",{children:[Object(c.jsx)("span",{className:"fe-select-critera-title fe-title-field",children:window.FilterEditor.labels.Field}),Object(c.jsx)("span",{className:"fe-select-critera-title fe-title-operator",children:window.FilterEditor.labels.Operator}),Object(c.jsx)("span",{className:"fe-select-critera-title fe-title-value",children:window.FilterEditor.labels.Value})]}),Object(c.jsx)("div",{className:"fe-general-input-container",children:this.state.operators}),Object(c.jsxs)("div",{className:"fe-add-remove-rows",children:[Object(c.jsx)("span",{onClick:this.addRow.bind(this),children:window.FilterEditor.labels.AddRow}),Object(c.jsx)("span",{onClick:this.removeRow.bind(this),children:window.FilterEditor.labels.RemoveRow})]}),Object(c.jsxs)("div",{className:"fe-general-input-container",children:[Object(c.jsx)("label",{className:"fe-general-input-label",children:window.FilterEditor.labels.LogicFilter}),Object(c.jsx)("input",{type:"text",value:this.state.logic,onChange:this.updateLogicFilter.bind(this),className:"fe-general-input-text fe-logic-input",placeholder:window.FilterEditor.labels.LogicFilterExample})]})]})}},{key:"componentWillReceiveProps",value:function(e){var t={},i=!1;if(this.state.logic!==e.object[window.FilterEditor.fieldNames.Logic__c]&&(i=!0,t.logic=e.object[window.FilterEditor.fieldNames.Logic__c]),e.fields&&Object.keys(e.fields).length>0){var a=[],s=0;for(var l in e.conditions)s=s>Number.parseInt(l)?s:Number.parseInt(l);var n=s>this.state.operators.length?s:this.state.operators.length;n<5&&(n=5);for(var r=1;r<n+1;r++)e.conditions[r]?a.push(Object(c.jsx)(D,{index:r,fields:e.fields,updateCondition:this.props.updateCondition,condition:e.conditions[r]})):a.push(Object(c.jsx)(D,{index:r,fields:e.fields,updateCondition:this.props.updateCondition}));t.operators=a,i=!0}i&&this.setState(t)}},{key:"addRow",value:function(){if(this.state.operators.length<this.MAX_CRITERIAS){var e=[].concat(Object(p.a)(this.state.operators),[Object(c.jsx)(D,{index:this.state.operators.length+1,fields:this.props.fields,updateCondition:this.props.updateCondition})]);this.setState({operators:e})}}},{key:"removeRow",value:function(){if(this.state.operators.length>5){var e=Object(p.a)(this.state.operators);e.pop(),this.props.updateCondition(e.length+1,!0),this.setState({operators:e})}}},{key:"updateLogicFilter",value:function(e){var t={};t[window.FilterEditor.fieldNames.Logic__c]=e.target.value,this.props.update(t)}}]),i}(a.Component)),S=(i(26),function(e){Object(o.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(n.a)(this,i),(a=t.call(this,e)).state={public:e.object[window.FilterEditor.fieldNames.Public__c]||!1},a}return Object(r.a)(i,[{key:"render",value:function(){var e=null,t=null;return window.FilterEditor.customPermissions.Create_custom_Gantt_filters&&window.FilterEditor.customPermissions.Publish_custom_Gantt_filters&&(e=Object(c.jsxs)("div",{className:"fe-checkbox-save",children:[Object(c.jsx)("input",{type:"checkbox",id:"fe-save-for",checked:this.state.public,onChange:this.publicChanged.bind(this)}),Object(c.jsx)("label",{for:"fe-save-for",children:window.FilterEditor.labels.AvailableForAllUsers})]})),this.props.object.Id&&(t=Object(c.jsx)("div",{class:"fe-save-as-button",onClick:this.saveAs.bind(this),children:window.FilterEditor.labels.SaveAs})),Object(c.jsxs)("div",{className:"fe-save-area",children:[e,Object(c.jsx)("div",{class:"fe-save-button",onClick:this.props.save.bind(this,!1),children:window.FilterEditor.labels.Save}),t]})}},{key:"publicChanged",value:function(e){var t={};t[window.FilterEditor.fieldNames.Public__c]=e.target.checked,this.props.update(t)}},{key:"componentWillReceiveProps",value:function(e){this.setState({public:e.object[window.FilterEditor.fieldNames.Public__c]||!1})}},{key:"saveAs",value:function(){var e=window.prompt(window.FilterEditor.labels.EnterFilterName,this.props.object[window.FilterEditor.fieldNames.Name]);null!==e&&(""!=e?this.props.save(e):window.alert(window.FilterEditor.labels.MustHaveName))}}]),i}(a.Component)),A=(i(27),function(e){Object(o.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(n.a)(this,i),(a=t.call(this,e)).state={selectedFieldsArray:[],availableFieldsArray:[]},a.seletedSelectElement=null,a.availableSelectElement=null,a}return Object(r.a)(i,[{key:"render",value:function(){var e=this,t=[],i=[];this.state.selectedFieldsArray.forEach((function(t){e.props.fields[t]&&i.push(Object(c.jsx)("option",{value:t,children:e.props.fields[t].Label.replace(" ID","")}))}));var a=this.props.fields,s=this.state.availableFieldsArray;s.sort((function(e,t){return a[e].Label.localeCompare(a[t].Label)})),s.forEach((function(i){e.props.fields[i]&&t.push(Object(c.jsx)("option",{value:i,children:e.props.fields[i].Label.replace(" ID","")}))}));var l=Object(c.jsxs)("div",{className:"df-FieldsContainer",children:[Object(c.jsx)("select",{multiple:!0,className:"df-select",ref:function(t){return e.availableSelectElement=t},children:t}),Object(c.jsxs)("div",{className:"df-actions-container",children:[Object(c.jsx)("div",{className:"df-action-button",onClick:this.__swapLists.bind(this,!0),children:">"}),Object(c.jsx)("div",{className:"df-action-button",onClick:this.__swapLists.bind(this,!1),children:"<"})]}),Object(c.jsx)("select",{multiple:!0,className:"df-select",ref:function(t){return e.seletedSelectElement=t},children:i}),Object(c.jsxs)("div",{className:"df-actions-container",children:[Object(c.jsx)("div",{className:"df-action-button",onClick:this.__changeOrderUp.bind(this),children:Object(c.jsx)("div",{className:"rotate-up",children:"<"})}),Object(c.jsx)("div",{className:"df-action-button",onClick:this.__changeOrderDown.bind(this),children:Object(c.jsx)("div",{className:"rotate-down",children:"<"})})]})]});return Object(c.jsxs)("div",{className:"fe-details-container section-container",children:[Object(c.jsx)("h1",{className:"section-title",children:window.FilterEditor.labels.DisplayFieldsFE}),Object(c.jsx)("div",{className:"df-explain",children:window.FilterEditor.labels.ExplainFE}),l]})}},{key:"componentWillReceiveProps",value:function(e){var t={},i=e.object[window.FilterEditor.fieldNames.Displayed_Fields__c],a=null,s=[],l=[];for(var n in i&&(a=JSON.parse(e.object[window.FilterEditor.fieldNames.Displayed_Fields__c])),e.fields)a&&a.indexOf(n)>-1?s.push(n):l.push(n);t.selectedFieldsArray=a||s,t.availableFieldsArray=l.sort(),t.showFields=a,this.setState(t)}},{key:"__swapLists",value:function(e){for(var t,i,a,s,l=[],n=e?this.availableSelectElement.selectedOptions:this.seletedSelectElement.selectedOptions,r=[],o=[],d=0;d<n.length;d++)l.push(n[d].value);e?((t=r=Object(p.a)(this.state.selectedFieldsArray)).push.apply(t,l),(i=o).push.apply(i,Object(p.a)(this.state.availableFieldsArray.filter((function(e){return-1===l.indexOf(e)}))))):((a=o=Object(p.a)(this.state.availableFieldsArray)).push.apply(a,l),(s=r).push.apply(s,Object(p.a)(this.state.selectedFieldsArray.filter((function(e){return-1===l.indexOf(e)})))));var c=Object.assign({},this.state);c.selectedFieldsArray=r,c.availableFieldsArray=o,this.setState(c),this.props.updateSelectedFields(r)}},{key:"__changeOrderUp",value:function(){var e=Object(p.a)(this.state.selectedFieldsArray),t=this.seletedSelectElement.selectedOptions,i=[];if(0!==t.length){for(var a=0;a<t.length;a++)i.push(t[a].value);for(var s=0;s<e.length;s++)if(0!==s&&i.indexOf(e[s])>-1){var l=s-1,n=e[s];e[s]=e[l],e[l]=n}var r=Object.assign({},this.state);r.selectedFieldsArray=e,this.seletedSelectElement.selectedIndex=-1,this.setState(r,(function(){for(var e=0;e<this.seletedSelectElement.length;e++)i.includes(this.seletedSelectElement[e].value)&&(this.seletedSelectElement[e].selected=!0)})),this.props.updateSelectedFields(e)}}},{key:"__changeOrderDown",value:function(){var e=Object(p.a)(this.state.selectedFieldsArray),t=this.seletedSelectElement.selectedOptions,i=[];if(0!==t.length){for(var a=0;a<t.length;a++)i.push(t[a].value);for(var s=e.length-2;s>=0;s--)if(i.indexOf(e[s])>-1){var l=s+1,n=e[s];e[s]=e[l],e[l]=n}var r=Object.assign({},this.state);r.selectedFieldsArray=e,this.seletedSelectElement.selectedIndex=-1,this.setState(r,(function(){for(var e=0;e<this.seletedSelectElement.length;e++)i.includes(this.seletedSelectElement[e].value)&&(this.seletedSelectElement[e].selected=!0)})),this.props.updateSelectedFields(e)}}}]),i}(a.Component)),I=function(e){Object(o.a)(i,e);var t=Object(d.a)(i);function i(){var e;Object(n.a)(this,i),e=t.call(this);var a={Id:window.FilterEditor.id};return a[window.FilterEditor.fieldNames.Name]=null,a[window.FilterEditor.fieldNames.Description__c]=null,a[window.FilterEditor.fieldNames.Days_after_horizon__c]=3,a[window.FilterEditor.fieldNames.Days_before_horizon__c]=3,a[window.FilterEditor.fieldNames.Criterias__c]=!1,a[window.FilterEditor.fieldNames.List_only_appointments_on_the_gantt__c]=null,a[window.FilterEditor.fieldNames.Logic__c]=null,a[window.FilterEditor.fieldNames.Public__c]=!1,e.selectedFieldsJson=null,e.state={ganttFilter:a,conditions:{},fields:null,allFields:{}},e.getData(),e.saving=!1,e}return Object(r.a)(i,[{key:"render",value:function(){return Object(c.jsxs)("div",{children:[Object(c.jsx)(h,{object:this.state.ganttFilter,update:this.updateObject.bind(this)}),Object(c.jsx)(u,{object:this.state.ganttFilter,update:this.updateObject.bind(this)}),Object(c.jsx)(k,{object:this.state.ganttFilter,fields:this.state.fields,conditions:this.state.conditions,update:this.updateObject.bind(this),updateCondition:this.updateCondition.bind(this)}),Object(c.jsx)(A,{fields:this.state.allFields,object:this.state.ganttFilter,updateSelectedFields:this.updateSelectedFields.bind(this)}),Object(c.jsx)(S,{object:this.state.ganttFilter,update:this.updateObject.bind(this),save:this.save.bind(this)})]})}},{key:"getData",value:function(){var e=this;window.Visualforce.remoting.Manager.invokeAction(window.FilterEditor.remoteActions.getData,this.state.ganttFilter.Id,(function(t,i){i.status&&function(){var i={};if(t.ganttFilter&&t.ganttFilter[window.FilterEditor.fieldNames.Criterias__c])try{i.conditions=JSON.parse(t.ganttFilter[window.FilterEditor.fieldNames.Criterias__c])}catch(n){console.warn("CAN NOT PARSE CRITERIA JSON"),alert(window.FilterEditor.labels.CustomFilterInvalidCriteria.replace("{0}",t.ganttFilter[window.FilterEditor.fieldNames.Name]))}for(var a in i.ganttFilter=t.ganttFilter||e.state.ganttFilter,i.ganttFilter[window.FilterEditor.fieldNames.List_only_appointments_on_the_gantt__c]=i.ganttFilter[window.FilterEditor.fieldNames.List_only_appointments_on_the_gantt__c]||!1,i.fields={},t.fields)-1===a.indexOf(".")&&(i.fields[a]=t.fields[a]);i.fields.FSL__RULE_VIOLATIONS__FSL=["Rule Violations","BOOLEAN"],e.selectedFieldsJson=i.ganttFilter[window.FilterEditor.fieldNames.Displayed_Fields__c]?i.ganttFilter[window.FilterEditor.fieldNames.Displayed_Fields__c]:null;var s={};for(var l in t.allFields)t.allFields[l].forEach((function(e){return s[e.FullAPIName]=e}));i.allFields=s,e.setState(i)}()}),{buffer:!0,escape:!1,timeout:12e4})}},{key:"updateObject",value:function(e){this.setState({ganttFilter:Object.assign(this.state.ganttFilter,e)})}},{key:"updateCondition",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={};i?this.state.conditions[e]&&(delete(t=Object.assign({},this.state.conditions))[e],a.ganttFilter=Object.assign({},this.state.ganttFilter),a.ganttFilter[window.FilterEditor.fieldNames.Criterias__c]=JSON.stringify(t),a.conditions=t,this.setState(a)):(t=Object.assign({},this.state.conditions,e),a.conditions=t,a.ganttFilter=Object.assign({},this.state.ganttFilter),a.ganttFilter[window.FilterEditor.fieldNames.Criterias__c]=JSON.stringify(t),this.setState(a))}},{key:"validateLogicFilter",value:function(){var e=this.state.ganttFilter[window.FilterEditor.fieldNames.Logic__c];if(!e)return!0;e=(e=(e=e.split("AND").join("&&")).split("OR").join("||")).split("NOT").join("!");for(var t=2;t<=10;t++)e=e.split(t).join("true");e=e.split(1).join("true");var i=!1;try{window.eval(e),i=!0}catch(a){console.log("bad format")}return i&&this.checkIfAllConditionsInLogic(this.state.ganttFilter[window.FilterEditor.fieldNames.Logic__c])&&this.checkIfLogicPadded(e)}},{key:"checkIfLogicPadded",value:function(e){if(!e)return!0;var t=["&&","!","||"];if(e.replace(/\s\s+/g," ")!=e)return!1;for(var i=0;i<t.length;i++)for(var a=t[i],s=e.indexOf(a);s>-1;){if(" "!==e[s-1]||" "!==e[s+a.length])return!1;s=e.indexOf(a,s+1)}return!0}},{key:"checkIfAllConditionsInLogic",value:function(e){if(!e)return!0;var t,i=e.match(/\d/g),a={};for(var s in this.state.conditions)a[s]=!1,t=!0;if(!t&&""!==e)return!1;for(var l=0;l<i.length;l++){var n=i[l];if("1"!==n)if("0"!==n){if(void 0===a[n])return!1;a[n]=!0}else{if(void 0===a[10])return!1;a[10]=!0}else if(e.split(10).join("").indexOf("1")>-1){if(void 0===a[1])return!1;a[1]=!0;continue}}for(var r in a)if(!a[r])return!1;return!0}},{key:"updateSelectedFields",value:function(e){this.selectedFieldsJson=JSON.stringify(e);var t=Object.assign({},this.state.ganttFilter);t[window.FilterEditor.fieldNames.Displayed_Fields__c]=this.selectedFieldsJson,this.setState({ganttFilter:t})}},{key:"save",value:function(e){if(!this.saving)if(this.state.ganttFilter[window.FilterEditor.fieldNames.Name]){for(var t in this.state.conditions)if(!this.state.conditions[t].isValid)return void window.alert(window.FilterEditor.labels.invalidCriterias);if(!this.validateLogicFilter())return console.log("BAD LOGIC"),void window.alert(window.FilterEditor.labels.invalidLogic);var i=e?null:this.state.ganttFilter.Id;this.saving=!0,window.Visualforce.remoting.Manager.invokeAction(window.FilterEditor.remoteActions.saveData,i,{Name:e||this.state.ganttFilter[window.FilterEditor.fieldNames.Name],Description:this.state.ganttFilter[window.FilterEditor.fieldNames.Description__c],Days_after_horizon:this.state.ganttFilter[window.FilterEditor.fieldNames.Days_after_horizon__c],Days_before_horizon:this.state.ganttFilter[window.FilterEditor.fieldNames.Days_before_horizon__c],Criterias:this.state.ganttFilter[window.FilterEditor.fieldNames.Criterias__c],List_only_appointments_on_the_gantt:this.state.ganttFilter[window.FilterEditor.fieldNames.List_only_appointments_on_the_gantt__c]||!1,Logic:this.state.ganttFilter[window.FilterEditor.fieldNames.Logic__c],Public:this.state.ganttFilter[window.FilterEditor.fieldNames.Public__c],Displayed_Fields:this.selectedFieldsJson||null},(function(t,i){if(i.status){if(window.parent&&window.parent.filterEditorPage)return t||alert(window.FilterEditor.labels.SomethingWentWrong),void window.parent.__closeFilterLightbox(t);if(!e&&window.location.href.toLocaleLowerCase().indexOf("?id")>-1)window.location.reload();else{var a=window.encodeURI(window.location.href.substr(0,window.location.href.indexOf("?")));window.location.href=window.encodeURI(a+"?id="+t)}}}),{buffer:!0,escape:!0,timeout:12e4})}else window.alert(window.FilterEditor.labels.MustHaveName)}}]),i}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(Object(c.jsx)(I,{}),document.getElementById("FilterAppRoot"))}],[[28,1,2]]]);
//# sourceMappingURL=main.0d3559f7.chunk.js.map