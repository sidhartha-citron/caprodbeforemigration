(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{164:function(e,t,a){"use strict";var s=a(3),n=a(16),r=a(0),o=a(101),i=a(102);s(s.P+s.R,"Promise",{finally:function(e){var t=o(this,n.Promise||r.Promise),a="function"==typeof e;return this.then(a?function(a){return i(t,e()).then((function(){return a}))}:e,a?function(a){return i(t,e()).then((function(){throw a}))}:e)}})},166:function(e,t,a){"use strict";a(103),a(35),a(33),a(21),a(36);var s=new Map;s.set("info",{divClass:"slds-theme_info",iconClass:"ma-icon-info"}),s.set("success",{divClass:"slds-theme_success",iconClass:"ma-icon-success"}),s.set("warning",{divClass:"slds-theme_warning",iconClass:"ma-icon-warning"}),s.set("error",{divClass:"slds-theme_error",iconClass:"ma-icon-error"});var n={name:"MAToast",props:{msg:{type:String,required:!1,default:""},state:{type:String,default:"error",validate:function(e){return e&&(void 0).stateMap.has(e)}},closeLabel:{type:String,default:"Close"}},data:function(){return{stateMap:s}},methods:{close:function(){this.$emit("close")}}},r=(a(188),a(9)),o=Object(r.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-grid slds-grid_vertical-align-center ma-wrapper"},[a("div",{staticClass:"slds-spinner_container"}),e._v(" "),a("div",{staticClass:"slds-notify_container slds-is-relative"},[a("div",{staticClass:"slds-notify slds-notify_toast ma-toast",class:e.stateMap.get(e.state).divClass,attrs:{role:"alert"}},[a("span",{staticClass:"slds-assistive-text"},[e._v("Error")]),e._v(" "),a("span",{staticClass:"slds-icon_container slds-m-right_small slds-no-flex slds-align-top ma-icon",class:e.stateMap.get(e.state).iconClass}),e._v(" "),a("div",{staticClass:"slds-notify__content"},[e._t("default",(function(){return[a("div",{domProps:{innerHTML:e._s(e.msg)}})]}))],2),e._v(" "),a("button",{staticClass:"slds-button slds-button_icon slds-notify__close slds-button_icon-inverse",attrs:{title:e.closeLabel},on:{click:e.close}},[a("span",{staticClass:"slds-button__icon slds-button__icon_large ma-icon ma-icon-close"}),e._v(" "),a("span",{staticClass:"slds-assistive-text"},[e._v(e._s(e.closeLabel))])])])])])}),[],!1,null,"172c04a4",null);t.a=o.exports},168:function(e,t,a){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a(175),a(172),a(99),a(17),a(35),a(33),a(21),a(36);var n=function(e,t){if(e&&"object"===s(e)&&Array.isArray(t)){for(;t.length&&e;)e=e[t.shift()];return e}},r=function e(t,a){try{var n=a||"sma__";Object.entries(t).forEach((function(a){var r=a[0],o=a[1];"marker"!==r&&"scatterMarker"!==r&&"clusterMarker"!==r&&"clusterGroup"!==r&&"workers"!==r&&"DeviceHistory"!==r&&"orderedPolyline"!==r&&"distanceLimitCircle"!==r&&"heatmapLayer"!==r&&(r.startsWith(n)?(t[r.replace(n,"")]=o,delete t[r],null!=t[r.replace(n,"")]&&"object"===s(t[r.replace(n,"")])&&e(t[r.replace(n,"")])):"object"===s(o)&&e(o))}))}catch(e){}return t}},172:function(e,t,a){"use strict";var s=a(3),n=a(18),r=a(182),o="".startsWith;s(s.P+s.F*a(183)("startsWith"),"String",{startsWith:function(e){var t=r(this,e,"startsWith"),a=n(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),s=String(e);return o?o.call(t,s,a):t.slice(a,a+s.length)===s}})},175:function(e,t,a){var s=a(3),n=a(174)(!0);s(s.S,"Object",{entries:function(e){return n(e)}})},178:function(e,t,a){var s=a(189);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),(0,a(32).default)("5e634584",s,!0,{})},180:function(e,t,a){var s=a(3),n=a(174)(!1);s(s.S,"Object",{values:function(e){return n(e)}})},188:function(e,t,a){"use strict";a(178)},189:function(e,t,a){(e.exports=a(31)(!1)).push([e.i,".slds-theme_warning button[data-v-172c04a4]:not(.slds-button--neutral){color:#3e3e3c;text-decoration:none}.slds-theme_warning[data-v-172c04a4]{color:#3e3e3c}.ma-icon[data-v-172c04a4]{font-size:24px}.ma-wrapper[data-v-172c04a4]{justify-content:center;position:absolute;left:0;top:0;height:100%;width:100%;z-index:9999}.slds-notify_container .slds-notify[data-v-172c04a4]{z-index:9999;min-width:20rem}\n",""])},248:function(e,t,a){var s=a(462);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),(0,a(32).default)("bbfe0050",s,!0,{})},249:function(e,t,a){var s=a(464);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),(0,a(32).default)("e89b0220",s,!0,{})},461:function(e,t,a){"use strict";a(248)},462:function(e,t,a){(e.exports=a(31)(!1)).push([e.i,".scrollArea{overflow-y:auto;max-height:400px}\n",""])},463:function(e,t,a){"use strict";a(249)},464:function(e,t,a){(e.exports=a(31)(!1)).push([e.i,"#dataLayerWrapper .ma-select-dropdown{width:100%}#dataLayerWrapper .selectWrapper{width:350px}#dataLayerWrapper .sectionTitle{font-size:16px;border-bottom:1px solid #cccccc}#dataLayerWrapper .graybox{background:#efefef}\n",""])},617:function(e,t,a){"use strict";a.r(t),a(45),a(17),a(34),a(46),a(47),a(164),a(33),a(97);var s=a(163),n=a(62),r=a(168),o=a(60),i=a.n(o);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){u(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var d=window,p=d.MARemoting,f=d.MASystem,b={components:{MAPicklist:s.a},data:function(){return{}},computed:l({},Object(o.mapState)(["dataLayer","isLoading","dataLayerMap","savedSFDCRecord","dataSources"])),watch:{dataLayer:function(){var e=this;""!==this.dataLayer&&(this.store__loadingToggle(!0),this.getSavedSFDCData().then((function(){})).catch((function(t){var a;a="string"==typeof t?t:t.message||"Unable to get Salesforce data. Reloading this page may fix this issue.",e.store__updateToastMsg(a)})).finally((function(){e.store__loadingToggle(!1)})))}},created:function(){var e=this;this.store__loadingToggle(!0),this.setDataSources().catch((function(t){var a;a="string"==typeof t?t:t.message||"Unable to get MAIO data. Reloading this page may fix this issue.",e.store__updateToastMsg(a)})).finally((function(){e.store__loadingToggle(!1)}))},methods:l(l({},Object(o.mapMutations)({store__updateDataLayer:"updateDataLayer",store__updateDataLayerFields:"updateDataLayerFields",store__updateDataLayerMap:"updateDataLayerMap",store__loadingToggle:"loadingToggle",store__updateSFDCRecord:"updateSFDCRecord",store__updateToastMsg:"updateToastMsg",store__updateBaseObject:"updateBaseObject",store__updateDataSource:"updateDataSource"})),{},{selectChange:function(e){var t=this,a=this.dataLayer;this.store__updateDataLayer(e),e!==a&&""!==e&&null!=e&&(this.store__loadingToggle(!0),this.getDataLayerInfoFromMAIO(this.dataLayer).then((function(e){var a=Object(r.a)(e||{},["data","sources"])||[];t.populateDataMap(a),t.store__updateBaseObject({apiName:"Lead",label:"Lead"})})).catch((function(e){var a;a="string"==typeof e?e:e.message||"Unable to get Salesforce data. Reloading this page may fix this issue.",t.updateErrorMsg(a)})).finally((function(){t.store__loadingToggle(!1)})))},getDataLayerInfoFromMAIO:function(e,t){var a=this;return new Promise((function(s,r){if(t=t||"true",void 0!==(a.dataLayerMap||{})[a.dataLayer]&&void 0!==e)a.store__updateDataLayerFields(),s();else{var o={fields:t,source:e||void 0,orgId:f.MergeFields.OrganizationId};(new n.a).setAction(p.MapAnythingIORequest).setErrorHandler(a.handleRemoteActionError.bind(a,r)).invoke([{method:"get",action:"sources",subType:"data",version:"1"},o],(function(e){e&&e.success?s(e):r(new Error("Unable to get latest data for this data layer."))}),{buffer:!1,escape:!1})}}))},handleRemoteActionError:function(e,t,a){console.warn("ERROR",t,a),e&&e(a.message)},populateDataMap:function(e){e=e||[];for(var t=0;t<e.length;t++){var a=(e[t]||{}).fields||[];this.store__updateDataLayerMap(a);break}this.store__updateDataLayerFields()},getSavedSFDCData:function(){var e=this;return new Promise((function(t,a){(new n.a).setAction(p.getSavedData).setErrorHandler(e.handleRemoteActionError.bind(e,a)).invoke([e.dataLayer],(function(s){s&&s.success?(e.storeSavedDataOptions(s.data||[]),t()):a(new Error("Unable to get data from Salesforce, please reload this page and try again. Continuing may result in a loss of data."))}),{escape:!1,buffer:!1})}))},storeSavedDataOptions:function(e){e=e||[];for(var t=0;t<e.length;t++){var a=e[t];this.store__updateSFDCRecord(a);break}},setDataSources:function(){var e=this;return new Promise((function(t,a){e.getDataLayerInfoFromMAIO(null,"false").then((function(a){for(var s=[],n=0;n<a.data.sources.length;n++)if(!0===a.data.sources[n].levels[0].markers){var r={label:a.data.sources[n].label,value:a.data.sources[n].id};s.push(r)}e.store__updateDataSource(s),t()})).catch((function(e){a(e)}))}))}})},g=a(9),v=Object(g.a)(b,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"slds-box graybox"},[a("div",{staticClass:"sectionTitle"},[e._v("\n            Select a Data Layer\n        ")]),e._v(" "),a("MAPicklist",{staticClass:"selectWrapper slds-p-vertical_x-small",attrs:{options:e.dataSources,doDetach:!0,keyString:"value",valueString:"label"},on:{input:e.selectChange},model:{value:e.dataLayer,callback:function(t){e.dataLayer=t},expression:"dataLayer"}})],1)])}),[],!1,null,null,null).exports;function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a(63);var O=window.MARemoting,S={components:{MAPicklist:s.a},computed:h({},Object(o.mapState)(["isLoading","sfdcObjects","baseObject","sfdcRecordTypes","currentC2CSetting"])),watch:{baseObject:function(){var e=this,t=this.getBaseObjectAPI();""!==t&&(this.loadingToggle(!0),this.getSFDCObjectMetaData().then((function(a){e.updateSFDCMetaData(a),e.updateCurrentC2CSetting(t),e.buildFieldSetOptions(),e.buildFieldSetMap()})).catch((function(t){var a;a="string"==typeof t?t:t.message||"Unable to get Salesforce data. Reloading this page may fix this issue.",e.updateToastMsg(a)})).finally((function(){e.loadingToggle(!1)})))}},created:function(){var e=this;this.loadingToggle(!0),this.getSFDCObjects().catch((function(t){var a;a="string"==typeof t?t:t.message||"Unable to get Salesforce data. Reloading this page may fix this issue.",e.updateToastMsg(a)})).finally((function(){e.loadingToggle(!1)}))},methods:h(h(h({},Object(o.mapMutations)(["loadingToggle","updateCurrentC2CSetting","buildFieldSetOptions","updateBaseObject","updatesfdcObjects","updateSFDCMetaData","buildFieldSetMap","updateToastMsg"])),Object(o.mapGetters)(["getBaseObjectAPI"])),{},{getSFDCObjects:function(){var e=this;return new Promise((function(t,a){(new n.a).setAction(O.AdminStartUpAction).setErrorHandler(e.handleRemoteActionError.bind(e,a)).invoke([{action:"populate_base_objects"}],(function(s){if(s&&s.success){var n=s.available||[];e.populateBaseObjects(n||[]),t()}else console.warn("Unable to get data from Salesforce."),a(new Error("Unable to get data from Salesforce (SFDC objects)."))}),{escape:!1,buffer:!1})}))},getSFDCObjectMetaData:function(){var e=this;return new Promise((function(t,a){var s={action:"get_object_metadata",objectAPIName:e.getBaseObjectAPI()};(new n.a).setAction(O.AdminStartUpAction).setErrorHandler(e.handleRemoteActionError.bind(e,a)).invoke([s],(function(e){if(e&&e.success){var s=e.data||{};t(s)}else console.warn("Unable to get data from Salesforce."),a(new Error("Unable to get data from Salesforce. (SFDC object meta data)"))}),{escape:!1,buffer:!1})}))},handleRemoteActionError:function(e,t,a){console.warn("ERROR",t,a),e&&e(a.message)},populateBaseObjects:function(e){e=e||{},this.updatesfdcObjects(e)},selectChange:function(e){var t=e.label;this.updateBaseObject({apiName:t,label:e.name})}})},j=Object(g.a)(S,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-box graybox"},[a("div",{staticClass:"sectionTitle"},[e._v("\n        Select a Salesforce Object\n    ")]),e._v(" "),a("MAPicklist",{staticClass:"selectWrapper slds-p-vertical_x-small",attrs:{options:e.sfdcObjects,doDetach:!0,hasNoneOption:!1,label:"Object",keyString:"label",valueString:"name"},on:{change:e.selectChange},model:{value:e.baseObject.apiName,callback:function(t){e.$set(e.baseObject,"apiName",t)},expression:"baseObject.apiName"}})],1)}),[],!1,null,null,null).exports;function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function w(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var D={components:{MAPicklist:s.a},props:{rowKey:{type:String,default:""},fieldSet:{type:Object,default:function(){}}},data:function(){return{localVal:this.fieldSet.value||"",sfdcFieldSets:[]}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){w(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(o.mapState)(["sfdcMetaData"])),created:function(){var e=this.sfdcMetaData||{};this.sfdcFieldSets=e.fieldSets||[];try{var t=this.sfdcFieldSets[0];""===this.localVal&&(this.localVal=t.value,this.fieldSet.value=t.value)}catch(e){}},methods:{udpateValue:function(e){this.fieldSet.value=e}}};function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){C(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var L={components:{FieldSetRow:Object(g.a)(D,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-p-top_xx-small selectWrapper"},[a("MAPicklist",{attrs:{options:e.sfdcFieldSets,label:e.fieldSet.name,hasNoneOption:!1,doDetach:!0,keyString:"value",valueString:"label"},on:{input:e.udpateValue},model:{value:e.localVal,callback:function(t){e.localVal=t},expression:"localVal"}})],1)}),[],!1,null,null,null).exports},computed:M(M({},Object(o.mapState)(["fieldSetData","sfdcFieldSets","isLoading"])),{},{showFieldSets:function(){return this.getRecordTypeLength()>0}}),methods:M({},Object(o.mapGetters)(["getRecordTypeLength"]))},F=Object(g.a)(L,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[this.isLoading?t("div"):this.showFieldSets?t("div",{staticClass:"slds-box graybox"},[t("div",{staticClass:"sectionTitle"},[this._v("\n            Field Set Mapping\n        ")]),this._v(" "),this._l(this.fieldSetData,(function(e){return t("FieldSetRow",{key:e.id,attrs:{rowKey:e.id,fieldSet:e,value:e.value,name:e.name}})}))],2):t("div",[this._m(0)])])}),[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-notify_container slds-is-relative"},[a("div",{staticClass:"slds-notify slds-notify_toast slds-theme_warning"},[a("span",{staticClass:"slds-assistive-text"},[e._v("warning")]),e._v(" "),a("span",{staticClass:"slds-icon_container ma-icon ma-icon-warning slds-m-right_small slds-no-flex",staticStyle:{"font-size":"24px"}}),e._v(" "),a("div",{staticClass:"slds-notify__content"},[a("h2",{staticClass:"slds-text-heading_small"},[e._v("\n                        Looks like the object you selected doesn't have any Field Sets. Please create one or more field sets or select a different object.\n                    ")]),e._v(" "),a("p",[e._v("If you need assistance please reach out to our support team at "),a("a",{attrs:{href:"http://mapanything.com/support"}},[e._v("http://mapanything.com/support")]),e._v(".")])])])])}],!1,null,null,null).exports;function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function x(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var A={components:{MAPicklist:s.a},props:{field:{type:Object,default:function(){}}},data:function(){return{fieldPicklistOption:[],localVal:this.field.value||"",dataType:""}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){x(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(o.mapState)(["sfdcMetaData"])),watch:{},created:function(){this.init()},methods:{init:function(){var e=(this.sfdcMetaData||{}).fields||{},t=this.field.filter_as,a=[];if(this.dataType=t,"string"===t){var s=e.emailFields||[],n=e.phoneFields||[],r=e.websiteFields||[];a=(a=(a=(a=(a=e.textFields||[]).concat(s)).concat(n)).concat(r)).sort(this.compareStrings)}else"number"===t||"decimal"===t?a=e.numberFields||[]:"date"===t?a=e.dateFields||[]:"currency"===t?a=e.currencyFields||[]:"boolean"===t&&(a=e.booleanFields||[]);this.fieldPicklistOption=a},udpateValue:function(e){this.field.value=e},compareStrings:function(e,t){var a=e.label.toLowerCase(),s=t.label.toLowerCase(),n=0;return a<s?n=-1:a>s&&(n=1),n}}};function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){E(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function E(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var I={components:{FieldSelectionRow:Object(g.a)(A,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"selectWrapper slds-p-vertical_x-small",attrs:{datatype:e.dataType}},[a("MAPicklist",{attrs:{options:e.fieldPicklistOption,label:e.field.label,doDetach:!0,keyString:"value",valueString:"label"},on:{input:e.udpateValue},model:{value:e.localVal,callback:function(t){e.localVal=t},expression:"localVal"}})],1)])}),[],!1,null,null,null).exports},data:function(){return{}},computed:k(k({},Object(o.mapState)(["dataLayerFields"])),{},{isValid:function(){return this.showFieldMappings()}}),methods:k({},Object(o.mapGetters)(["getRecordTypeLength","showFieldMappings"]))},N=(a(461),Object(g.a)(I,(function(){var e=this.$createElement,t=this._self._c||e;return this.isValid?t("div",{staticClass:"slds-box graybox"},[t("div",[t("div",{staticClass:"sectionTitle"},[this._v("\n            Field Mappings\n        ")]),this._v(" "),t("div",{staticClass:"scrollArea"},this._l(this.dataLayerFields,(function(e){return t("FieldSelectionRow",{key:e.id,attrs:{field:e,value:e.value}})})),1)])]):this._e()}),[],!1,null,null,null).exports);function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){U(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function U(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var W=window,$=W.MARemoting,H=W.MAToastMessages,z={components:{},data:function(){return{currentId:null}},computed:V({isValid:function(){return this.showFieldMappings()}},Object(o.mapState)(["fieldMappings","fieldSetData","c2cSettingsMap","savedSFDCRecord","toastMsg"])),updated:function(){this.currentId=null},methods:V(V(V({},Object(o.mapGetters)(["showFieldMappings","getBaseObjectAPI","getBaseObjectName"])),Object(o.mapMutations)(["updateToastMsg","loadingToggle"])),{},{sendSaveInfoSFDC:function(){var e=this,t=this.buildSaveInfo();return new Promise((function(a,s){var r;try{r=JSON.stringify(t)}catch(e){return console.warn("Can't parse json settings for save",t),void s(new Error("Unable to create save data. Please reload this page and try again."))}(new n.a).setAction($.saveDataLayer).setErrorHandler(e.handleRemoteActionError.bind(e,s)).invoke([r],(function(t){t&&t.success?(e.currentId=t.data.Id,a("Save Successful.")):(console.warn("Unable to get data from Salesforce."),s(new Error("Unable to get data from Salesforce.")))}),{escape:!1})}))},saveDataLayer:function(){var e=this;this.loadingToggle(!0),this.sendSaveInfoSFDC().then((function(){H.showSuccess({message:"Save Successful",timeOut:7e3})})).catch((function(t){var a;a="string"==typeof t?t:t.message||"Unable to get Salesforce data. Reloading this page may fix this issue.",e.updateToastMsg(a)})).finally((function(){e.loadingToggle(!1)}))},handleRemoteActionError:function(e,t,a){console.warn("ERROR",t,a),e&&e(a.message)},buildSaveInfo:function(){for(var e=this.savedSFDCRecord,t=this.getBaseObjectAPI(),a={objAPIName:t,objLabel:this.getBaseObjectName(),recordTypes:[],fieldSetOptions:[]},s={},n=(this.fieldMappings||[]).filter((function(e){return""!==e.value})),r=0;r<n.length;r++){var o=n[r];s[o.id]=o.value}a.fields=s;for(var i=this.fieldSetData||[],c=0;c<i.length;c++){var l=i[c];null!=l.value&&void 0!==l.value&&""!==l.value&&(a.fieldSetOptions.push({FieldSetAPIName:l.value,IsSystemDefault:l.systemDefault||!1,RecordTypeId:l.id,RecordTypeName:l.name}),a.recordTypes.push({id:l.id,label:l.name}))}var u=this.c2cSettingsMap||{};u[t]=a;var d='{"C2C":{}}';try{var p={C2C:u};d=JSON.stringify(p)}catch(e){console.warn("Unable to stringify settings!",u)}return e.sma__Settings__c=d,""!==e.Id&&void 0!==e.Id||(null===this.currentId?delete e.Id:e.Id=this.currentId),e}})},G=Object(g.a)(z,(function(){var e=this.$createElement,t=this._self._c||e;return this.isValid?t("div",[t("button",{staticClass:"slds-button slds-button_brand",on:{click:this.saveDataLayer}},[this._v("\n        Save\n    ")])]):this._e()}),[],!1,null,null,null).exports,J=a(64),q=a(166);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a(180),a(35),a(21),a(36);var Q={state:function(){return{callouts:0,isLoading:!1,baseObject:{apiName:"",label:""},savedSFDCRecord:{sma__Type__c:"",Id:"",sma__Settings__c:"{}"},dataLayer:"",c2cSettingsMap:{},currentC2CSetting:{fieldSetOptions:[],fields:{},objAPIName:"",objLabel:"",recordTypes:[]},sfdcObjects:[],sfdcMetaData:{fieldSets:[],fields:{},objectAPIName:"",recordTypes:[]},fieldSetData:[],dataLayerMap:{},dataLayerFields:[],fieldMappings:[],toastMsg:null,toastType:"error",dataSources:[]}},actions:{reset:function(e){(0,e.commit)("reset")}},mutations:{loadingToggle:function(e,t){"boolean"==typeof t?t?(e.callouts+=1,e.isLoading=!0):(e.callouts-=1,e.callouts<=0&&(e.isLoading=!1,e.callouts=0)):(e.callouts-=1,e.isLoading=!1)},updateToastMsg:function(e,t,a){e.toastType=a,a=a||"error",e.toastMsg=""===t||void 0===t?null:t},updateDataLayerMap:function(e,t){t=t||[];var a=e.dataLayer;e.dataLayerMap[a]=t},updateDataLayerFields:function(e){e.dataLayerFields=e.dataLayerMap[e.dataLayer]},updateBaseObject:function(e,t){e.fieldSetData=[],e.fieldMappings=[],"object"===K(t)?e.baseObject={apiName:t.apiName||"",label:t.label||""}:e.baseObject={apiName:"",label:""},e.currentC2CSetting={fieldSetOptions:[],fields:{},objAPIName:e.baseObject.apiName,objLabel:e.baseObject.label,recordTypes:[]},e.sfdcMetaData={fieldSets:[],fields:{},objectAPIName:e.baseObject.apiName,recordTypes:[]}},updateCurrentC2CSetting:function(e,t){return new Promise((function(a){var s=e.c2cSettingsMap,n={};void 0!==s&&"object"===K(s)&&(n=s[t]||{}),e.currentC2CSetting=n,a()}))},updateDataLayer:function(e,t){t=t||"",e.c2cSettingsMap={},e.fieldSetData=[],e.fieldMappings=[],e.dataLayer=t,e.sfdcMetaData={fieldSets:[],fields:{},objectAPIName:"",recordTypes:[]},e.baseObject={apiName:"",label:""},e.savedSFDCRecord={sma__Type__c:t,Id:"",sma__Settings__c:"{}"}},updatesfdcObjects:function(e,t){var a=[];"object"===K(t)&&(a=Object.values(t)),e.sfdcObjects=a},updateDataSource:function(e,t){var a=[];"object"===K(t)&&(a=t),e.dataSources=a},updateSFDCMetaData:function(e,t){return new Promise((function(a){"object"===K(t)&&(e.sfdcMetaData={fields:t.fields||{},fieldSets:t.fieldSets||[],objectAPIName:e.baseObject.apiName,recordTypes:t.recordTypes||[]}),a()}))},buildFieldSetOptions:function(e){return new Promise((function(t){for(var a=e.sfdcMetaData.recordTypes||[],s=(e.currentC2CSetting||{fieldSetOptions:[],fields:{},objAPIName:"",objLabel:"",recordTypes:[]}).fieldSetOptions||[],n=[],r=0;r<a.length;r++){var o=a[r];o.value="";for(var i=0;i<s.length;i++){var c=s[i];if(c.RecordTypeId===o.id){o.value=c.FieldSetAPIName;break}}o.systemDefault?n.unshift(o):n.push(o)}e.fieldSetData=n,t()}))},buildFieldSetMap:function(e){return new Promise((function(t){for(var a=e.currentC2CSetting||{fieldSetOptions:[],fields:{},objAPIName:"",objLabel:"",recordTypes:[]},s=e.dataLayerFields||[],n=a.fields||{},r=Object.keys(n)||[],o=[],i=0;i<s.length;i++){var c=s[i],l=c.id;c.value="";for(var u=0;u<r.length;u++){var d=r[u],p=n[d];if(d.indexOf(l)>=0){c.value=p;break}}o.push(c)}e.fieldMappings=o,t()}))},updateSFDCRecord:function(e,t){if("object"===K(t)){var a=t.sma__Type__c||"";t.sma__Type__c="dbusa-v1"===a?"business":"dmp-v1"===a?"property":a,e.savedSFDCRecord=t;var s=t.sma__Settings__c||"{}",n={};try{n=JSON.parse(s)}catch(e){console.warn("Unable to parse saved settings",s)}var r=n.C2C||{};e.c2cSettingsMap=r}}},getters:{getDataLayerFields:function(e){return(e.dataLayerMap||{})[e.dataLayer||""]},getSFDCFieldSetData:function(e){var t=e.sfdcMetaData,a=[];return"object"===K(t)&&(a=t.fieldSets||[]),a},getSFDCFields:function(e){var t=e.sfdcMetaData,a={};return"object"===K(t)&&(a=t.fields||{}),a},getValidFieldMappings:function(e){return(e.fieldMappings||[]).filter((function(e){return""!==e.value}))},getRecordTypeLength:function(e){return(e.sfdcMetaData.fieldSets||[]).length},getSFDCRecordTypes:function(e){var t=e.sfdcMetaData,a=[];return"object"===K(t)&&(a=t.recordTypes||[]),a},getC2CSettings:function(e,t){var a={};if("object"===K(e.c2cSettingsMap)){var s=t.getBaseObjectAPI;a=e.c2cSettingsMap[s]||{}}return a},getBaseObjectAPI:function(e){var t=e.baseObject.apiName;return void 0===t&&(t=""),t},getBaseObjectName:function(e){var t=e.baseObject.label;return void 0===t&&(t=""),t},getLegacyDataLayerValue:function(e){var t=e.dataLayer;return"property"===e.dataLayer?t="dmp-v1":"business"===e.dataLayer&&(t="dbusa-v1"),t},showFieldMappings:function(e,t){var a=t.getRecordTypeLength>0,s=e.dataLayerFields.length>0,n=e.sfdcMetaData.fields||{},r=Object.keys(n).length>0;return a&&r&&s}}};function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(Object(a),!0).forEach((function(t){Z(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Z(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ee={components:{DataLayerSelection:v,BaseObjectSelection:j,FieldSetSelection:F,FieldMapSelection:N,SaveDataLayer:G,MASpinner:J.a,MAToast:q.a},data:function(){return{showSelectMessage:!1,toast:null}},computed:Y(Y({},Object(o.mapState)(["isLoading","dataLayer","baseObject","fieldSetData","sfdcRecordTypes","fieldMappings","toastMsg","toastType"])),{},{showRecordTypeWarning:function(){return 0===this.sfdcRecordTypes.length},showStep1:function(){return""!==this.dataLayer},showStep2:function(){var e=this.getBaseObjectAPI();return""!==e&&void 0!==e}}),beforeCreate:function(){this.$store=new i.a.Store(Q)},methods:Y(Y(Y({},Object(o.mapGetters)(["getBaseObjectAPI"])),Object(o.mapMutations)(["updateToastMsg"])),{},{closeToast:function(){this.updateToastMsg()}})},te=(a(463),Object(g.a)(ee,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-p-around_medium",staticStyle:{position:"relative"},attrs:{id:"dataLayerWrapper"}},[a("MASpinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),e._v(" "),null!=e.toastMsg?a("MAToast",{attrs:{msg:e.toastMsg,state:e.toastType},on:{close:e.closeToast}}):e._e(),e._v(" "),a("div",{staticClass:"slds-p-bottom_x-small"},[a("DataLayerSelection")],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showStep1,expression:"showStep1"}],staticClass:"slds-p-bottom_x-small"},[a("BaseObjectSelection")],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showStep2,expression:"showStep2"}],staticClass:"slds-p-bottom_x-small"},[a("FieldSetSelection")],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showStep2,expression:"showStep2"}],staticClass:"slds-p-bottom_x-small"},[a("FieldMapSelection")],1),e._v(" "),a("SaveDataLayer",{directives:[{name:"show",rawName:"v-show",value:e.showStep2,expression:"showStep2"}]})],1)}),[],!1,null,null,null));t.default=te.exports}}]);