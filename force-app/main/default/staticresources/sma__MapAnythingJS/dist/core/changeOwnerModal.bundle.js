(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{635:function(e,t,s){"use strict";s.r(t);var a=s(63),n=s(19),i=s(4),l=s(85),r={components:{MAModal:a.a,MASpinner:n.a,MACheckbox:l.a},props:{records:{type:Array,required:!0}},data:function(){return{isLoading:!1,recordsAreValid:!1,isStep1:!0,defaultSubordinates:!1,futureEvents:!0,notes:!0,tasks:!0,attachments:!0,searchTerm:"",foundUsers:[],selectedUser:null}},computed:{recordIdList:function(){return this.records.map((function(e){return e.Id}))}},watch:{searchTerm:function(e,t){this.searchIsLoading=!0,e!==t&&this.debounceSearch()}},created:function(){var e=this;0===this.records.length?(window.MAToastMessages.showWarning({message:"Change Owner Warning",subMessage:"No records found",timeOut:1e4}),this.$nextTick((function(){e.close()}))):(this.recordsAreValid=!0,this.getUsers(),this.defaultSubordinates=window.getProperty(window.MASystem,"Organization.ShowOnlySubordinates",!1)||!1)},methods:{close:function(){this.$emit("close")},getUsers:function(){var e=this;this.foundUsers=[],this.isLoading=!0;var t={ajaxResource:"MATooltipAJAXResources",subordinatesOnly:this.defaultSubordinates,action:"get_users",searchTerm:this.searchTerm};(new i.a).setAction(this.$Remoting.processAJAXRequest).setErrorHandler(this.handleRemoteActionError.bind(this)).invoke([t],(function(t){var s=t.success,a=void 0!==s&&s,n=t.users,i=void 0===n?[]:n;e.isLoading=!1,a&&(e.foundUsers=i)}))},updateOwner:function(){this.isLoading=!0;var e={ajaxResource:"MATooltipAJAXResources",ownerId:this.selectedUser.Id,action:"change_owner",transferAttachments:this.attachments,transferEvents:this.futureEvents,transferNotes:this.notes,transferTasks:this.tasks,records:this.records};window.ChangeOwner_Finish(e),this.close()},debounceSearch:function(){var e=this;null!==this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){e.searchTimeout=null,e.getUsers()}),500)},handleRemoteActionError:function(){this.isLoading=!1},showStep2:function(e){this.selectedUser=e,this.isStep1=!1},showStep1:function(){this.selectedUser=null,this.isStep1=!0}}},o=s(1),c=Object(o.a)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.recordsAreValid?s("MAModal",{attrs:{doDetach:!0,title:e.$Labels.MAActionFramework_Change_Owner,closeLabel:e.$Labels.MA_Close},on:{close:e.close}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("MASpinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],attrs:{loadingLabel:e.$Labels.MA_Loading}}),e._v(" "),e.isStep1?s("div",[s("div",{staticClass:"slds-p-around_medium"},[s("h4",{staticClass:"slds-text-title_caps"},[e._v(e._s(e.$Labels.MA_Step_1_Select_New_Owner))]),e._v(" "),s("div",{staticClass:"grid-wrapper slds-m-top_small"},[s("table",{staticStyle:{width:"100%"}},[s("tr",[s("td",{staticStyle:{"vertical-align":"center"}},[s("table",[s("tr",[s("td",{staticClass:"data"},[s("label",{staticClass:"slds-form-element__label label",attrs:{for:"changeownder-filter-name"}},[e._v(e._s(e.$Labels.MA_Name))]),e._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],staticClass:"filter-text slds-input",attrs:{id:"changeowner-filter-name",type:"text","data-field":"Name"},domProps:{value:e.searchTerm},on:{input:function(t){t.target.composing||(e.searchTerm=t.target.value)}}})])])])])]),e._v(" "),s("td",{staticStyle:{"vertical-align":"center"}},[s("div",{staticClass:"slds-form-element slds-m-left_medium"},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("MACheckbox",{attrs:{noSlide:!0,title:e.$Labels.MA_Show_Only_Subordinates},on:{input:function(t){return e.getUsers()}},model:{value:e.defaultSubordinates,callback:function(t){e.defaultSubordinates=t},expression:"defaultSubordinates"}})],1)])])])])]),e._v(" "),s("div",{staticStyle:{height:"15px"}},[e._v(" ")]),e._v(" "),s("div",{staticClass:"loadmask-wrapper",attrs:{id:"changeowner-select-grid-wrapper"}},[s("table",{staticClass:"slds-table slds-table_bordered slds-table_cell-buffer slds-table_striped",attrs:{id:"changeowner-select-grid"}},[s("thead",[s("tr",{staticClass:"slds-text-title_caps"},[s("th",[e._v(e._s(e.$Labels.MA_Name))])])]),e._v(" "),s("tbody",e._l(e.foundUsers,(function(t,a){return s("tr",{key:a,on:{click:function(s){return e.showStep2(t)}}},[s("td",[e._v(e._s(t.Name))])])})),0)])])])])]):s("div",[s("div",{staticStyle:{height:"15px"}},[e._v(" ")]),e._v(" "),s("div",{staticClass:"slds-p-around_medium"},[s("h4",{staticClass:"slds-text-title_caps"},[e._v(e._s(e.$Labels.MA_Step_2_Transfer_Options))]),e._v(" "),s("div",{staticStyle:{height:"15px"}},[e._v(" ")]),e._v(" "),s("div",[s("h4",{staticClass:"slds-form-element__legend slds-form-element__label"},[e._v(e._s(e.$Labels.MA_Related_items_transfer))]),e._v(" "),s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("MACheckbox",{attrs:{noSlide:!0,title:e.$Labels.MA_Notes},model:{value:e.notes,callback:function(t){e.notes=t},expression:"notes"}})],1)]),e._v(" "),s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("MACheckbox",{attrs:{noSlide:!0,title:e.$Labels.MA_Attachments},model:{value:e.attachments,callback:function(t){e.attachments=t},expression:"attachments"}})],1)]),e._v(" "),s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("MACheckbox",{attrs:{noSlide:!0,title:e.$Labels.MA_Open_Tasks},model:{value:e.tasks,callback:function(t){e.tasks=t},expression:"tasks"}})],1)]),e._v(" "),s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("MACheckbox",{attrs:{noSlide:!0,title:e.$Labels.MA_Future_Events},model:{value:e.futureEvents,callback:function(t){e.futureEvents=t},expression:"futureEvents"}})],1)])])])])],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[e.isStep1?e._e():s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.showStep1}},[e._v(e._s(e.$Labels.MA_Back))]),e._v(" "),s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.close}},[e._v(e._s(e.$Labels.MA_Cancel))]),e._v(" "),e.isStep1?e._e():s("button",{staticClass:"slds-button slds-button_brand",on:{click:function(t){return e.updateOwner()}}},[e._v(e._s(e.$Labels.MA_Save_Close))])])]):e._e()}),[],!1,null,null,null);t.default=c.exports}}]);