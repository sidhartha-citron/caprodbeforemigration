(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{559:function(e,t,s){},560:function(e,t,s){},561:function(e,t,s){},562:function(e,t,s){},563:function(e,t,s){},564:function(e,t,s){},565:function(e,t,s){},566:function(e,t,s){},567:function(e,t,s){},568:function(e,t,s){},569:function(e,t,s){},570:function(e,t,s){},571:function(e,t,s){},572:function(e,t,s){},573:function(e,t,s){},574:function(e,t,s){},603:function(e,t,s){e.exports=s.p+"images/1d3bfa0323ffcf7b1482b8b087ba041d.svg"},604:function(e,t,s){"use strict";s(559)},605:function(e,t,s){"use strict";s(560)},606:function(e,t,s){e.exports=s.p+"images/27ef26a59ce0829f5213e87ce8024c4a.svg"},607:function(e,t,s){e.exports=s.p+"images/67eb8aa0687137e2ae66c70243c22c5d.svg"},608:function(e,t,s){"use strict";s(561)},609:function(e,t,s){"use strict";s(562)},610:function(e,t,s){e.exports=s.p+"images/0a98987d34e9383071ab89b6e5e1e9a0.png"},611:function(e,t,s){"use strict";s(563)},612:function(e,t,s){"use strict";s(564)},613:function(e,t,s){"use strict";s(565)},614:function(e,t,s){"use strict";s(566)},615:function(e,t,s){"use strict";s(567)},616:function(e,t,s){"use strict";s(568)},617:function(e,t,s){"use strict";s(569)},618:function(e,t,s){"use strict";s(570)},619:function(e,t,s){e.exports=s.p+"images/b22688a6ab99991f2d9ec52ef5b5e918.svg"},620:function(e,t,s){"use strict";s(571)},621:function(e,t,s){"use strict";s(572)},622:function(e,t,s){"use strict";s(573)},623:function(e,t,s){"use strict";s(574)},630:function(e,t,s){"use strict";s.r(t);var a=s(5),n=s(13),i=s(43),o=window,r=o.$,c=o.moment;function l(e){var t=this.counter++;this.base__columnIdToDayInstance[t].calendarDate=c(e).tz(this.$User.timezoneId,!0),0===t&&this.store__calendarView===a.a.AGENDA_WEEK&&(this.base__columnIdToDayInstance[-1].calendarDate=c(e).tz(this.$User.timezoneId,!0).add(-1,"d"));var s="dddd";return this.store__isAgendaWeek&&("-"!==(s=this.$User.dateFormat.toUpperCase().replace(/Y/g,"")).charAt(0)&&"/"!==s.charAt(0)||(s=s.substring(1)),"/"!==s.charAt(s.length-1)&&"-"!==s.charAt(s.length-1)||(s=s.slice(0,-1)),s=s.length>=9?"ddd M/D":"ddd ".concat(s)),'<div data-column-id="'.concat(t,'">').concat(e.format(s),"</div>")}var d=function(){var e=this;return{allDaySlot:!1,header:!1,handleWindowResize:!1,height:"auto",views:{agendaWeek:{columnHeaderHtml:l.bind(this)},agendaDay:{columnHeaderHtml:l.bind(this)},month:{editable:!1}},schedulerLicenseKey:"0947007917-fcs-1462891368",eventLimit:2,now:this.store__staticTime,timezone:this.$User.timezoneId,locale:this.$User.UserLocale,timeFormat:this.$User.timeFormat,slotDuration:"00:15:00",forceEventDuration:!0,defaultView:this.store__calendarView,editable:!0,lazyFetching:!1,nowIndicator:!0,droppable:!0,navLinks:!0,navLinkDayClick:function(t){e.base__navigationAction(e.setCalendarToDayView,t)},eventClick:function(t){if(e.store__isMonth)e.base__navigationAction(e.setCalendarToDayView,t.start);else{var s=e.base__columnIdToDayInstance[t.columnId]||{};e.base__showEventOnMap(t,s.routing)}},dayClick:function(t){e.store__isMonth&&e.base__navigationAction(e.setCalendarToDayView,t)},eventResize:function(t){e.base__hasModifiedEvents=!0,e.base__updatedEventsSet.add(t.id),e.resetRouteDataByShiftId(t.shiftId)},eventDrop:function(t){e.base__hasModifiedEvents=!0,e.base__updatedEventsSet.add(t.id),e.base__adjustToUserTimezone(t.end).add(-1*t.end.utcOffset(),"m"),e.base__adjustToUserTimezone(t.start).add(-1*t.start.utcOffset(),"m");var s=e.base__events.findIndex((function(e){return e.id===t.id}));e.base__events[s].end=t.end,e.base__events[s].start=t.start,e.base__setShiftIdOnEvents([t]),e.resetRouteDataByShiftId(t.shiftId),e.base__$calendar.fullCalendar("updateEvent",t)},eventDragStart:function(t){e.base__events.find((function(e){return e.id===t.id})).hasError=!1},eventDragStop:function(t){e.base__hasModifiedEvents=!0,e.base__updatedEventsSet.add(t.id),e.resetRouteDataByShiftId(t.shiftId),e.base__$calendar.fullCalendar("rerenderEvents")},eventResizeStop:function(){e.base__$calendar.fullCalendar("rerenderEvents")},dayNames:this.base__getDayNames(),dayNamesShort:this.base__getDayNamesShort(),eventMouseover:this.base__eventMouseoverHandler,eventMouseout:this.base__eventMouseoutHandler,eventRender:function(t,s){var a="inverse-background"===t.rendering;e.store__isMonth||a||e.$nextTick((function(){var a=s.find(".fc-time").detach(),n=s.find(".fc-bg").detach(),o=s.find(".fc-resizer").detach();s.empty();var c=r(e.$refs[t.id]);c.find(".fc-time").remove(),a.insertAfter(c.find(".fc-title")),c.appendTo(s),n.appendTo(s),o.appendTo(s),t.hasError&&s.addClass("has-error");var l=e.base__events.find((function(e){return e.id===t.id}));if(l&&l.bgColorClass){s.addClass(l.bgColorClass);var d=r(".".concat(l.bgColorClass)).css("color");d&&s.css("color",Object(i.c)(d))}}))},eventAfterAllRender:function(t){var s=t.name===a.a.AGENDA_DAY,n=t.name===a.a.AGENDA_WEEK,i=!s&&!n||e.base__performedScrollToLogic;if(e.duplicationCheck(),!i){if(r(".fc-time-grid-event").length){var o=r("div.fc-event-container a"),c=o&&o.length>0?o[0].offsetTop:0;n&&o.each((function(e,t){t.offsetTop<c&&(c=t.offsetTop)})),r("div.fc-scroller").animate({scrollTop:c-20},250),e.base__performedScrollToLogic=!0}if(s)e.base__$calendar.fullCalendar("getView").stopNowIndicator(),window.setTimeout((function(){try{for(;r("#schedulePanelBody").next().length>0;)r("#schedulePanelBody").next().remove()}catch(e){console.log(e)}}),100)}},eventReceive:function(t){e.routeDefaults.duration>=15?(e.base__adjustToUserTimezone(t.end).add(-1*t.end.utcOffset(),"m"),e.base__adjustToUserTimezone(t.start).add(-1*t.start.utcOffset(),"m"),e.base__updatedEventsSet.add(t.id),e.base__hasModifiedEvents=!0,e.base__numEventsReceived++,e.store__removeItemFromQueueById(t.id),e.base__events.push(t),e.base__setShiftIdOnEvents([t]),e.resetRouteDataByShiftId(t.shiftId),e.base__$calendar.fullCalendar("updateEvent",t)):e.base__$calendar.fullCalendar("removeEvents",t.id)},viewRender:function(){e.store__isMonth||(e.appendCustomColumnHeaderMarkup(),e.resizeWeekHeader(),window.addEventListener("resize",e.resizeWeekHeader)),e.store__isMonth||r(".fc-time-grid-container").scroll((function(){e.base__isActionMenuShown&&(e.$bus.$emit("ma-hide-action-menu"),e.base__isActionMenuShown=!1)})),e.$nextTick((function(){r(".ma-calendar .fc-axis.fc-widget-header").css("text-align","center").html('<span style="font-size: 10px; font-weight: 100;">GMT'.concat(Object(a.e)(c.tz(e.base__getCorrectTimezone()).format("Z")),"</span>"))}))},viewDestroy:function(){e.resetComponentState(),e.actionMenu.doRender=!1,window.removeEventListener("resize",e.resizeWeekHeader)},events:this.getEvents.bind(this)}},u=s(20),_=s(86),h=s(61),f=s(4),v=s(541);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}function g(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function y(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?g(Object(s),!0).forEach((function(t){S(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function S(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var C=window,E=C.moment,w=C.MASystem,T=C.MAToastMessages,A={props:{base__showFullScreenToggleControl:{type:Boolean,required:!0},base__storedIsLoading:{type:Boolean,required:!0}},data:function(){return{locationCache:new Map,base__$calendar:{},base__events:[],base__shifts:[],base__searchTerm:this.$User.FullName,base__calendarId:this.$User.Id,base__isLoading:this.base__storedIsLoading,base__callouts:0,base__performedScrollToLogic:!1,base__isActionMenuShown:!1,base__configErrors:{},base__hasModifiedEvents:!1,base__showPendingChangeModal:!1,base__storedNavigationAction:null,base__numEventsReceived:0,base__columnIdToDayInstance:{},base__updatedEventsSet:new Set,base__eventIdsForDelete:[],base__locationIdsForDelete:[],base__hasModifiedLocations:!1,base__hasModifiedShifts:!1,base__skipTimeAxisCheck:!1,queueUnwatch:null}},computed:y(y({},Object(n.mapGetters)("scheduling",{store__isAgendaDay:"isAgendaDay",store__isAgendaWeek:"isAgendaWeek",store__isMonth:"isMonth",store__isTimelineDay:"isTimelineDay",store__isDayView:"isDayView",store__calendarView:"calendarView",store__calendarDate:"calendarDate",store__queue:"queue",store__staticTime:"staticTime"})),{},{base__laborLawNotify:function(){return window.getProperty(w||{},"Organization.LaborLawsNotify",!1)||!1},base__doDisableSaveBtn:function(){return!(this.base__eventIdsForDelete.length||this.base__hasModifiedEvents||this.base__locationIdsForDelete.length||this.base__hasModifiedShifts)},base__showControls:function(){return!this.store__isMonth},base__showSaveErrorModal:function(){return Object.keys(this.base__configErrors).length},base__hasPendingChanges:function(){return this.base__hasModifiedEvents||this.base__hasModifiedShifts||this.base__locationIdsForDelete.length},queueLength:function(){return this.store__queue.length}}),watch:{base__isLoading:function(e){!e&&this.base__callouts>0||this.$emit("update:base__storedIsLoading",e)},base__callouts:function(e){this.base__isLoading=e>0},queueLength:function(e,t){e!==t&&this.base__calculateEventPriorityIndex()},base__events:function(e,t){if(e.length!==t.length)this.base__calculateEventPriorityIndex();else for(var s=0;s<e.length;s++)if(!e[s].start.isSame(t[s].start)||0===e[s].priority)return void this.base__calculateEventPriorityIndex()}},created:function(){this.store__staticTime||this.store__updateStaticTime(E().tz(this.$User.timezoneId))},methods:y(y(y({},Object(n.mapActions)("scheduling",{store__removeItemFromQueueById:"removeItemFromQueueById",store__addItemToQueue:"addItemToQueue"})),Object(n.mapMutations)("scheduling",{store__sortQueue:"sortQueue",store__updateStaticTime:"updateStaticTime"})),{},{base__getDayNames:function(){return[this.$Labels.MA_Sunday,this.$Labels.MA_Monday,this.$Labels.MA_Tuesday,this.$Labels.MA_Wednesday,this.$Labels.MA_Thursday,this.$Labels.MA_Friday,this.$Labels.MA_Saturday]},base__calculateEventPriorityIndex:function(){var e=[],t=this.base__events.concat(this.store__queue).filter((function(e){return e.spatial}));t.forEach((function(t){return e.push({priority:t.priorityValue||0,id:t.id})}));var s=e.length;e.sort((function(e,t){return t.priority-e.priority})).forEach((function(e,a){var n=t.find((function(t){return t.id===e.id}));n.priority=a+1,n.priorityIndex=s--})),this.store__sortQueue()},base__getDayNamesShort:function(){return[this.$Labels.MA_Sunday.slice(0,3),this.$Labels.MA_Monday.slice(0,3),this.$Labels.MA_Tuesday.slice(0,3),this.$Labels.MA_Wednesday.slice(0,3),this.$Labels.MA_Thursday.slice(0,3),this.$Labels.MA_Friday.slice(0,3),this.$Labels.MA_Saturday.slice(0,3)]},base__changeCalendarView:function(e){this.base__clearRoutes(),this.$store.commit("scheduling/setView",e)},base__changeCalendarDate:function(e){this.base__clearRoutes(),this.$store.commit("scheduling/setDate",e)},base__today:function(){this.base__clearRoutes(),this.base__$calendar.fullCalendar("today"),this.$store.commit("scheduling/setDate",this.base__getCalendarDate())},base__previous:function(){var e=this;this.base__clearRoutes(),this.$nextTick((function(){e.base__$calendar.fullCalendar("prev"),e.$store.commit("scheduling/setDate",e.base__getCalendarDate())}))},base__next:function(){var e=this;this.base__clearRoutes(),this.$nextTick((function(){e.base__$calendar.fullCalendar("next"),e.$store.commit("scheduling/setDate",e.base__getCalendarDate())}))},base__clearRoutes:function(){var e=this;this.store__calendarView===a.a.TIMELINE_DAY?this.unrenderRoutesFromMap():this.base__shifts.forEach((function(t){e.resetRouteDataByShiftId(t.id)}))},base__navigationAction:function(e){for(var t=this,s=arguments.length,a=new Array(s>1?s-1:0),n=1;n<s;n++)a[n-1]=arguments[n];var i=function(){t.$nextTick((function(){e.apply(t,a)}))};if(this.base__hasPendingChanges)return this.base__showPendingChangeModal=!0,void(this.base__storedNavigationAction=i);i()},base__hideSaveErrorModal:function(){this.base__configErrors={}},base__setConfigId:function(e){var t=this,s=[];e.eventIds.forEach((function(a){var n=t.base__$calendar.fullCalendar("clientEvents").find((function(e){return e.id===a}));n&&(n.configId=e.configId,s.push(n))})),s.length&&this.base__$calendar.fullCalendar("updateEvents",s)},base__completeNavigationRequest:function(){this.base__storedNavigationAction()},base__saveAndCompleteNavigationRequest:function(){var e=this;this.base__save().then((function(){e.$parent.base__showSaveErrorModal||e.base__storedNavigationAction()}))},base__save:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.doClone,a=void 0!==s&&s,n=t.cloneSourceDate,i=void 0===n?null:n,o=t.cloneTargetDate,r=void 0===o?null:o,c=t.doCloneStartEndLocations,l=void 0!==c&&c;return new Promise((function(t){e.base__checkScheduleQueue().then((function(){try{var s=0,n=0;e.base__callouts+=1;var o=[];if(a){e.base__adjustToUserTimezone(E(i)).isDST()!==e.base__adjustToUserTimezone(E(r)).isDST()&&(n=e.base__adjustToUserTimezone(E(r)).isDST()?-1:1);var c=E(r).diff(E(e.store__calendarDate),"days");c=c<0?Math.floor(c)-1:Math.ceil(c),s=864e5*c}var d=window.getProperty(w||{},"Organization.isMAGuideEnabled",!1)||!1;e.base__$calendar.fullCalendar("clientEvents").forEach((function(t){var i=t.start.add(n,"hours"),r=t.end.add(n,"hours"),c=6e4*e.base__adjustToUserTimezone(E(t.start)).utcOffset(),l=e.base__adjustToUserTimezone(E(i)).valueOf()-(c+s),u=e.base__adjustToUserTimezone(E(r)).valueOf()-(c+s),_={startTime:t.start.utcOffset()?t.start.valueOf()+s:l,endTime:t.end.utcOffset()?t.end.valueOf()+s:u,recordId:t.recordId,doClone:a,relationshipId:t.relationshipId,subject:t.title,layerId:t.MASavedQry__c,baseObjectId:t.baseObjectId,configId:t.configId,ownerId:t.resourceId||e.base__calendarId,uid:t.id,location:{latLng:{lat:t.lat,lng:t.lng},address:t.Address__c||t.address},isMALocation:t.isMALocation||!1};if(d){var h=t.guideWaypoint,f=void 0===h?{}:h;f.hasWaypoint&&(_.guideWaypoint=f)}(a||e.base__updatedEventsSet.has(_.uid))&&o.push(_)})),e.store__queue.forEach((function(t){t.recordId&&(e.base__eventIdsForDelete.push(t.recordId),t.recordId=null)}));var u={events:o,eventIdsForDelete:e.base__eventIdsForDelete,shiftsForUpsert:e.store__isTimelineDay?[]:e.prepareShiftRecordsForUpsert(s,l),calendarId:e.base__calendarId};(new f.a).setAction(e.$Remoting.saveCalendarEvents).setErrorHandler(e.base__handleRemoteActionError.bind(e)).invoke([JSON.stringify(u)],(function(s){if(s.success)s.configMissing&&s.multipleConfigs?0!==Object.keys(s.multipleConfigs).length?e.base__configErrors=Object.assign({},s.multipleConfigs):e.base__configErrors=Object.assign({},s.configMissing):(e.base__hasModifiedEvents=!1,e.base__updatedEventsSet.clear(),t());else{var a=s.message;a.includes("FIELD_INTEGRITY_EXCEPTION")&&(a="Oops! Looks like this event is associated with an object that no longer has activities enabled. Please re-enable activities. <br /><br />".concat(a)),e.$emit("error",a)}e.base__callouts-=1}),{timeout:12e4})}catch(t){e.base__callouts-=1,e.$emit("error",t.stack)}})).catch((function(){}))}))},base__checkScheduleQueue:function(){var e=this;return new Promise((function(t,s){var a=!1;(e.store__queue.forEach((function(e){e.recordId&&(a=!0)})),window.getProperty(window,"userSettings.hideQueueWarningModal",!1)||!1||!a)?t():window.MA.Popup.showMAConfirm({popupId:"queueConfirmModal",template:'<div><div style="font-size: 13px;" class="slds-form-element__label">You have items in the "Unscheduled" column related to Salesforce data. Continuing to save will keep these items in the queue, but the underlying Salesforce information will be removed.</div><div style="font-size: 13px;" class="slds-p-top_small slds-form-element__label">Are you sure you wish to continue?</div><div class="slds-form-element slds-p-top_large slds-float_right"><div class="slds-form-element__control"><div class="slds-checkbox"><input type="checkbox" name="options" id="confirmqueue-2" value="confirmqueue-2" /><label class="slds-checkbox__label" for="confirmqueue-2"><span class="slds-checkbox_faux"></span><span class="slds-form-element__label">Hide this message on future updates?</span></label></div></div></div></div>',buttons:[{text:"Cancel",type:"slds-button_neutral",onTap:function(){return{hideModal:document.querySelector("#queueConfirmModal #confirmqueue-2").checked,success:!1}}},{text:"Confirm",type:"slds-button_brand",onTap:function(){return{hideModal:document.querySelector("#queueConfirmModal #confirmqueue-2").checked,success:!0}}}]}).then((function(a){if(a.success){if(a.hideModal){var n={userIds:JSON.stringify([e.$User.Id]),field:"sma__MapAnythingSettings__c",type:"setting",value:"true",action:"save_permissions_mass",setting:"hideQueueWarningModal"};(new f.a).setAction(e.$Remoting.AdminStartUpAction).setErrorHandler((function(e){console.warn("unable to save setting",e)})).invoke([n],(function(){console.log("modal will no longer appear."),window.userSettings.hideQueueWarningModal=!0}),{escape:!1,buffer:!1})}t()}else s()}))}))},prepareShiftRecordsForUpsert:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(a,n){var i=e.base__columnIdToDayInstance[n],o=i.shifts,r=i.calendarDate;return o.forEach((function(e){s&&(e.record.Id=null),(e.doUpsert||s)&&(e.record.Date__c=E(r.add(t,"ms")).format("YYYY-MM-DD"),a.push(e.record))})),a},n=function(e){return/__c|__s$/.test(e)?"sma__".concat(e):e};return this.columnIds.reduce(a,[]).map((function(e){return Object.assign.apply(Object,[{}].concat(b(Object.keys(e).map((function(t){return S({},n(t),e[t])})))))}))},base__processResponseErrors:function(e,t){var s=this,a=[];_.b.showErrorMessage(e.maioCode,_.a.SCHEDULE);var n=_.b.getWaypointErrorMessage(e.maioCode,_.a.SCHEDULE);if(e.details){Array.isArray(e.details)||(e.details=[e.details]);var i=t.startLocation,o=t.endLocation;e.details.forEach((function(e){if(e.erroramount||e.errormessage){var t=s.base__events.find((function(t){return t.id===e.id})),r=null!=t;if(!r)if(i.id===e.id)t=i;else{if(o.id!==e.id)return;t=o}if(s.$set(t,"hasError",!0),s.$set(t,"errorMessage",n),e.erroramount&&s.$set(t,"errorTimeString",function(e){var t=parseInt(e/3600,10);e-=3600*t;var s=parseInt(e/60,10);return e-=60*s,"".concat(t,"h ").concat(s,"m ").concat(e,"s")}(e.erroramount)),r){var c=s.base__$calendar.fullCalendar("clientEvents").find((function(t){return t.id===e.id}));if(!c)return;c.hasError=!0,a.push(c)}}})),a.length&&this.base__$calendar.fullCalendar("updateEvents",a)}},base__fetchCalendarShifts:function(e){var t=this,s=e.startLocationId,a=e.endLocationId,n=e.resource.id,i=void 0===n?this.base__calendarId:n;return new Promise((function(e,n){t.base__callouts+=1;var o=t.base__$calendar.fullCalendar("getView"),r=o.start,c=o.end,l=1===c.diff(r,"d"),d=l?r.format("YYYY-MM-DD"):r.add(-1,"d").format("YYYY-MM-DD"),u=l?d:c.format("YYYY-MM-DD"),_={resourceId:i,startDate:d,endDate:u,defaultStartLocationId:s,defaultEndLocationId:a};(new f.a).setAction(t.$Remoting.getCalendarShifts).setErrorHandler(t.base__handleRemoteActionError.bind(t)).invoke([JSON.stringify(_)],(function(s){t.base__callouts-=1,s.success?e(s.data||[]):n(new Error(s.message))}),{escape:!1,buffer:!1})}))},base__fetchRouteDefaultsByResource:function(e){var t=this;return new Promise((function(s,a){var n=e.id;if(t.$User.Id!==n){var i={ajaxResource:"MAUserAJAXResources",action:"get_user_prefs",id:n};(new f.a).setAction(t.$Remoting.processAJAXRequest).setErrorHandler(t.base__handleRemoteActionError.bind(t)).invoke([i],(function(t){if(t&&t.success&&t.record){var n={};try{n=JSON.parse(t.record.sma__MapAnythingSettings__c)}catch(e){n={RouteDefaults:u.a.actualRouteDefaults}}var i=y(y(y(y({},n.RouteDefaults||u.a.actualRouteDefaults),{workingHours:n.workingHours||{}}),{name:t.record.Name}),{timezone:t.record.TimeZoneSidKey});"string"==typeof i.displayTrafficTime&&(i.displayTrafficTime=!0),s(y(y({},i),{},{resource:e}))}else a(new Error("Failed to fetch route defaults for {0}.".format(e.name)))}),{escape:!1,buffer:!1})}else s(y(y({},u.a.routeDefaults),{},{resource:e}))}))},base__setShiftIdOnEvents:function(e){var t=this;e.forEach((function(e){var s=e.start,a=!1,n=t.base__events.findIndex((function(t){return t.id===e.id})),i=t.base__events[n];t.base__shifts.forEach((function(t){var n=t.startTime,o=t.endTime;t.resourceId&&e.resourceId!==t.resourceId||s.isBetween(n,o,null,"[]")&&(i.shiftId=e.shiftId=t.id,i.columnId=e.columnId=t.columnId,i.resourceId=t.resourceId,a=!0)})),a||(i.shiftId=e.shiftId=null)}))},base__getWorkingHours:function(e){var t,s=e.calendarDate,a=e.workingHours;switch(s.format("dd")){case"Su":t="sunday";break;case"Mo":t="monday";break;case"Tu":t="tuesday";break;case"We":t="wednesday";break;case"Th":t="thursday";break;case"Fr":t="friday";break;case"Sa":t="saturday"}return a?a[t]:u.a.getWorkingHoursByDayString(t)},base__setShiftsOnInstance:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.base__getWorkingHours(e);e.hasOvernightShift=!1,null==n&&(n={startHour:9,startMinute:0,endHour:17,endMinute:0});var o=s.startLocation,r=void 0===o?{}:o,c=s.endLocation,l=void 0===c?{}:c;Object(i.d)(r,"sma__"),Object(i.d)(l,"sma__");var d={id:Object(a.f)(),columnId:e.columnId,resourceId:e.resourceId,startLocation:y(y({},this.base__getDefaultLocationSettings()),{isSpatial:null!=r.Latitude__c&&null!=r.Longitude__c}),endLocation:y(y({},this.base__getDefaultLocationSettings()),{isSpatial:null!=l.Latitude__c&&null!=l.Latitude__c}),record:{Date__c:e.calendarDate.format("YYYY-MM-DD"),ResourceId__c:this.base__calendarId,StartAddress__c:r.Address__c,StartLocation__Latitude__s:r.Latitude__c,StartLocation__Longitude__s:r.Longitude__c,StartHour__c:n.startHour,StartMinute__c:n.startMinute,EndAddress__c:l.Address__c,EndLocation__Latitude__s:l.Latitude__c,EndLocation__Longitude__s:l.Longitude__c,EndHour__c:n.endHour,EndMinute__c:n.endMinute},onMap:!1,route:{},routing:null,doUpsert:!1,isOvernight:!1,startTime:E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(n.startHour,"h").add(n.startMinute,"m"),endTime:E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(n.endHour,"h").add(n.endMinute,"m")};e.earliestShiftTime=d.startTime,e.latestShiftTime=d.endTime,d.startTime>d.endTime&&(d.endTime.add(1,"d"),d.isOvernight=e.hasOvernightShift=!0),e.shifts=[d];var u,_,h=e.calendarDate.format("YYYY-MM-DD"),f=s.shiftMap[h];f&&f.length&&(e.shifts=[],f.forEach((function(s){Object(i.d)(s,"sma__");var n={id:Object(a.f)(),startLocation:Object.assign(d.startLocation,{isSpatial:null!=s.StartLocation__Latitude__s}),endLocation:Object.assign(d.endLocation,{isSpatial:null!=s.EndLocation__Latitude__s}),record:{Id:s.Id,StartAddress__c:s.StartAddress__c,StartLocation__Latitude__s:s.StartLocation__Latitude__s,StartLocation__Longitude__s:s.StartLocation__Longitude__s,EndAddress__c:s.EndAddress__c,EndLocation__Latitude__s:s.EndLocation__Latitude__s,EndLocation__Longitude__s:s.EndLocation__Longitude__s}},o=s.StartHour__c,r=s.StartMinute__c,c=s.EndHour__c,l=s.EndMinute__c;o>=0&&r>=0?(n.record.StartHour__c=o,n.record.StartMinute__c=r,n.startTime=E.tz(e.calendarDate.format("YYYY-MM-DD"),t.base__getCorrectTimezone()).add(o,"h").add(r,"m")):n.startTime=d.startTime,c>=0&&l>=0?(n.record.EndHour__c=c,n.record.EndMinute__c=l,n.endTime=E.tz(e.calendarDate.format("YYYY-MM-DD"),t.base__getCorrectTimezone()).add(c,"h").add(l,"m")):n.endTime=d.endTime,n.startTime>n.endTime&&(n.endTime.add(1,"d"),n.isOvernight=e.hasOvernightShift=!0),n.earliestShiftTime&&!n.startTime.isBefore(e.earliestShiftTime)||(e.earliestShiftTime=n.startTime),n.latestShiftTime&&!n.endTime.isAfter(e.latestShiftTime)||(e.latestShiftTime=n.endTime),u=null==u||n.startTime.isBefore(u)?n.startTime:u,_=null==_||n.endTime.isBefore(_)?n.endTime:_,e.shifts.push(y(y({},d),n))})),e.hasOvernightShift&&u.isBefore(e.earliestShiftTime)&&(e.earliestShiftTime=u),e.hasOvernightShift&&_.isBefore(e.latestShiftTime)&&(e.latestShiftTime=_))},base__adjustToUserTimezone:function(e,t){return t?e.tz(t):this.routeDefaults&&this.routeDefaults.timezone?e.tz(this.routeDefaults.timezone):e.tz(this.$User.timezoneId),e},base__getCorrectTimezone:function(){var e=this.$User.timezoneId;return this.routeDefaults&&this.routeDefaults.timezone&&(e=this.routeDefaults.timezone),e},base__forceMapResize:function(){window.setTimeout((function(){window.google.maps.event.trigger(window.MA.map,"resize")}),200)},base__getExcludeIncludeActionLabel:function(e){return e.excludeFromRoute?this.$Labels.MA_INCLUDE_IN_OPTIMIZATION:this.$Labels.MA_EXCLUDE_FROM_OPTIMIZATION},base__eventHasRecord:function(e){return void 0!==e.recordId&&null!==e.recordId},base__hasGuideWaypoint:function(e){var t=e.guideWaypoint,s=void 0===t?{}:t;return!!s.hasWaypoint&&s.hasWaypoint},base__getGuideWaypointLockIcon:function(e){var t=e.guideWaypoint;return(void 0===t?{}:t).isLocked?"ma-icon-lock-closed":"ma-icon-lock-open"},base__setGuideLockStatus:function(e){var t=this;return new Promise((function(s){var a=t.base__$calendar.fullCalendar("clientEvents").filter((function(t){return t.id===e.id}))[0],n=a.guideWaypoint,i=void 0===n?{}:n;i.isLocked=!e.guideWaypoint.isLocked,i&&i.hasWaypoint&&(t.base__hasModifiedEvents=!0,t.base__updatedEventsSet.add(e.id)),t.$nextTick((function(){t.base__$calendar.fullCalendar("updateEvent",a),s()}))}))},base__setExcludeInclude:function(e){var t=this;return new Promise((function(s){var a=t.base__$calendar.fullCalendar("clientEvents").filter((function(t){return t.id===e.id}))[0];a.excludeFromRoute=!e.excludeFromRoute,a.className=a.excludeFromRoute?["non-spatial-cell"]:["eventCell"];var n=t.base__events.findIndex((function(t){return t.id===e.id}));t.base__events[n].excludeFromRoute=!e.excludeFromRoute,t.$nextTick((function(){t.base__$calendar.fullCalendar("updateEvent",a),s()}))}))},base__setDefaultDuration:function(e){this.base__$calendar.fullCalendar("getView").calendar.defaultTimedEventDuration=E.duration({minutes:e})},base__setTimeAxisRange:function(e,t){this.base__$calendar.fullCalendar("option",{minTime:e,maxTime:t})},base__buildTimeAxisString:function(e,t){var s=e.hours()+t;return"".concat(s,":00:00")},base__convertStringToMinutes:function(e){var t=0;try{var s=(e||"0 hr, 0 min").split(","),a=s[0]||"0 hr",n=s[1]||"0 min";t=60*(a=parseInt(a.replace(/\D/g,""),10))+(n=parseInt(n.replace(/\D/g,""),10))}catch(e){t=0}return t||15},base__emitViewModeChangeEvent:function(e){switch(e){case a.a.AGENDA_WEEK:case a.a.TIMELINE_DAY:case a.a.MONTH:this.$bus.$emit("set-calendar-view-mode",a.d.FULLWIDTH_HALFHEIGHT);break;case a.a.AGENDAY_DAY:default:this.$bus.$emit("set-calendar-view-mode",a.d.DEFAULT)}},base__getCalendarDate:function(){return this.base__$calendar.fullCalendar("getDate")},base__fetchEvents:function(e,t,s,a){var n=this;return new Promise((function(i,o){a||i([]);var r={startTime:e.valueOf()-6e4*e.tz(s).utcOffset(),endTime:t.valueOf()-6e4*t.tz(s).utcOffset()-1e3,resourceId:a};n.base__callouts+=1,(new f.a).setAction(n.$Remoting.getCalendarEvents).setErrorHandler(n.base__handleRemoteActionError.bind(n)).invoke([JSON.stringify(r)],(function(e){if(n.base__callouts-=1,e.success){var t=n.buildFloatingBreakEvents(e.floatingBreaks,a),s=n.buildCalendarEvents(e.events||[],a);i(s.concat(t))}else o(new Error(e.message))}),{escape:!1,buffer:!1})}))},buildFloatingBreakEvents:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1?arguments[1]:void 0,n=[],i=0===t.length?null:t[0],o=null!==i;if(!o||this.store__isMonth)return[];if(this.store__calendarView===a.a.TIMELINE_DAY){var r=o?E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(i.startHour,"h").add(i.startMinute,"m"):null,c=o?E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(i.endHour,"h").add(i.endMinute,"m"):null,l=o?E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(1,"d").add(i.startHour,"h").add(i.startMinute,"m"):null,d=o?E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(1,"d").add(i.endHour,"h").add(i.endMinute,"m"):null,u={id:Object(a.f)(),resourceId:s,title:"Break",isBreak:!0,start:r,end:c,className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showControls:!1};n.push(u);var _={id:Object(a.f)(),resourceId:s,title:"Break",isBreak:!0,start:l,end:d,className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showControls:!1};n.push(_)}else Object.values(this.base__columnIdToDayInstance).forEach((function(t){if(-1!==t.columnId){var r=o?E.tz(t.calendarDate.format("YYYY-MM-DD"),e.base__getCorrectTimezone()).add(i.startHour,"h").add(i.startMinute,"m"):null,c=o?E.tz(t.calendarDate.format("YYYY-MM-DD"),e.base__getCorrectTimezone()).add(i.endHour,"h").add(i.endMinute,"m"):null,l=o?E.tz(t.calendarDate.format("YYYY-MM-DD"),e.base__getCorrectTimezone()).add(1,"d").add(i.startHour,"h").add(i.startMinute,"m"):null,d=o?E.tz(t.calendarDate.format("YYYY-MM-DD"),e.base__getCorrectTimezone()).add(1,"d").add(i.endHour,"h").add(i.endMinute,"m"):null,u={id:Object(a.f)(),resourceId:s,title:"Break",isBreak:!0,start:r,end:c,className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showControls:!1};if(n.push(u),e.store__isDayView){var _={id:Object(a.f)(),resourceId:s,title:"Break",isBreak:!0,start:l,end:d,className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showControls:!1};n.push(_)}}}));return n},buildCalendarEvents:function(e,t){var s=this,n=[];function i(e){var t=e.location,s=t.street,a=t.city,n=t.state,i=t.postalCode,o=t.country,r="";return s&&(r+="".concat(s,", ")),a&&(r+=a),n&&(r+=", ".concat(n)),i&&(r+=" ".concat(i)),o&&(r+=" ".concat(o)),r}var o=!1;return e.forEach((function(e){var r=e.priority||{},c=r.value,l=void 0===c?0:c,d=r.type,u=void 0===d?"":d,_=r.label,h=void 0===_?"":_,f=r.sfdcFieldType,v=void 0===f?"number":f,m=r.sfdcFieldValue,b=void 0===m?0:m,p=e.GuideWaypoint,g=void 0===p?{}:p,S={id:Object(a.f)(),resourceId:t,title:e.Subject,start:s.base__adjustToUserTimezone(E(e.StartDateTime)),end:s.base__adjustToUserTimezone(E(e.EndDateTime)),className:"non-spatial-cell",spatial:!1,excludeFromRoute:!0,showControls:!1,recordId:e.RecordId,relationshipId:e.RelationshipId,LinkId__c:e.LinkId__c,MASavedQry__c:e.LayerId,baseObjectId:e.BaseObjectId,configId:e.ConfigId,priority:l,priorityType:u,priorityLabel:h,priorityValue:b,priorityFieldType:v,guideWaypoint:{hasWaypoint:g.hasWaypoint||!1,isLocked:g.isLocked||!1,id:g.id||""}};if(e.location){var C=e.location.lat&&e.location.lng||e.location.verifiedLat&&e.location.verifiedLng,w=e.location,T=w.geocodeError,A=w.geocodeErrorMessage;if(C){var I={className:"eventCell",spatial:!0,excludeFromRoute:!1,verifiedLat:e.location.verifiedLat,verifiedLng:e.location.verifiedLng,lat:e.location.lat,lng:e.location.lng,address:i(e)};S=y(y({},S),I)}S.start.isSame(S.end)&&S.end.add(1,"seconds"),T&&A&&(o=!0,S.hasError=!0,S.errorMessage=A)}o&&s.base__showMapToastError("There was a problem geocoding some of your events. They have been marked as non-spatial. Please review your schedule.","Geocoding Error"),S.start.isSame(S.end)&&S.end.add(1,"seconds"),n.push(S)})),n},base__instantiateRoute:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.base__getRouteTimes(e),n=a.routeDepartureTime,i=a.routeEndTime,o=a.routeStartTime,r=!0,c=(new v.a).setRouteStart(o.unix()).setRouteEnd(i.unix()).setWaypoints(t.spatial,r).setHardBreaks(t.hardBreaks).setSoftBreaks(t.softBreaks).setOptimized(s).setTimeBased(!0).setDirections(!1),l=e.startLocation,d=e.endLocation;return l.isSpatial&&c.setFirst({id:l.id,lat:e.record.StartLocation__Latitude__s,lng:e.record.StartLocation__Longitude__s,flexible:!1,Name:e.record.StartAddress__c,Address__c:e.record.StartAddress__c,duration:0,start:n.unix()}),d.isSpatial&&c.setLast({id:d.id,lat:e.record.EndLocation__Latitude__s,lng:e.record.EndLocation__Longitude__s,flexible:!1,Name:e.record.EndAddress__c,Address__c:e.record.EndAddress__c,duration:0,start:i.unix()}),c},base__getRouteTimes:function(e){var t=this.base__adjustToUserTimezone(E(e.startTime)),s=this.base__adjustToUserTimezone(E(e.endTime)),a=e.startTime.isSame(E(),"d"),n=E(t);if(a){var i=this.base__adjustToUserTimezone(this.store__staticTime);i.isAfter(n)&&(n=i)}return{routeDepartureTime:t,routeEndTime:s,routeStartTime:n}},base__eventSorter:function(e,t){var s=60*E.tz(this.$User.timezoneId).utcOffset();return(e.start.utcOffset()?e.start.unix():E(e.start).tz(this.$User.timezoneId).unix()-s)-(t.start.utcOffset()?t.start.unix():E(t.start).tz(this.$User.timezoneId).unix()-s)},base__buildWaypointsFromEvents:function(e){var t=this,s={spatial:[],softBreaks:[],hardBreaks:[]};return e.forEach((function(e){if(e.flexible)s.spatial.push(y(y({},e),{priority:e.priorityIndex}));else{var a=e.start.isUTC()?e.start.unix()-60*t.base__adjustToUserTimezone(E(e.start)).utcOffset():e.start.unix(),n=e.end.isUTC()?e.end.unix()-60*t.base__adjustToUserTimezone(E(e.end)).utcOffset():e.end.unix();e.excludeFromRoute?e.isBreak?s.hardBreaks.push({start:a,end:n}):s.softBreaks.push({start:a,end:n}):s.spatial.push({id:e.id,Name:e.title,LinkId__c:e.LinkId__c||e.relationshipId,Address__c:e.address,MASavedQry__c:e.MASavedQry__c,baseObjectId:e.baseObjectId,lat:e.verifiedLat||e.lat,lng:e.verifiedLng||e.lng,start:a,priority:e.priorityIndex,duration:Math.floor(e.end.unix()-e.start.unix())})}})),s},base__handleRemoteActionError:function(e,t,s){if(e)e(s.message);else{this.base__callouts&&(this.base__callouts-=1);var a=s?s.message:t.message;this.$emit("error",a)}},getTranslatedErrorMessage:function(e){switch(e.maioCode){case 82004:case 82011:return"There is not enough time to add events to your schedule today. Please add items on a day in the future.";default:return e.message||"Error"}},base__genericPromiseErrorHandler:function(e){this.base__callouts&&(this.base__callouts-=1),"object"===m(e)?(console.warn(e),this.$emit("error",this.getTranslatedErrorMessage(e))):"string"==typeof e&&this.$emit("error",e)},base__genericPromiseFinallyHandler:function(){this.base__callouts&&(this.base__callouts-=1)},base__showMapToastError:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Scheduling Error";T.showError({message:t,subMessage:e,timeOut:1e4,extendedTimeOut:0,closeButton:!0})},base__showEventOnMap:function(e,t){if(e.spatial&&t){var s=t.getWaypointById(e.id),a=t.getWaypointMarker(s);a&&window.google.maps.event.trigger(a,"click")}},base__deleteEvent:function(e){this.base__$calendar.fullCalendar("removeEvents",e.id),e.recordId?(this.base__eventIdsForDelete.push(e.recordId),this.base__updatedEventsSet.delete(e.id),this.base__hasModifiedEvents=!0):this.base__numEventsReceived--,this.base__events=this.base__events.filter((function(t){return t.id!==e.id})),this.base__numEventsReceived||this.base__eventIdsForDelete.length||(this.base__hasModifiedEvents=!1,this.base__updatedEventsSet.clear())},base__eventMouseoverHandler:function(e,t){if(Object.keys(t).length&&!this.store__isMonth){var s=this.base__events.findIndex((function(t){return t.id===e.id}));-1!==s&&(this.base__events[s].showControls=!0)}},base__eventMouseoutHandler:function(e,t){if(Object.keys(t).length&&!this.store__isMonth){var s=t.toElement||t.relatedTarget;if(!s||!s.classList.contains("slds-dropdown_actions")){var a=this.base__events.findIndex((function(t){return t.id===e.id}));-1!==a&&(this.base__events[a].showControls=!1)}}},base__returnAllEventsToQueue:function(){var e=this,t=window.getProperty(w||{},"Organization.isMAGuideEnabled",!1)||!1;this.base__$calendar.fullCalendar("clientEvents").forEach((function(s){var a=s.guideWaypoint,n=(void 0===a?{}:a).isLocked,i=t&&(void 0!==n&&n);s.spatial&&!i&&e.returnEventToQueue(s)}))},base__resetComponentState:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.base__storedNavigationAction=null,this.base__performedScrollToLogic=!1,this.base__events=[],e||(this.base__shifts=[]),this.base__eventIdsForDelete=[],this.base__locationIdsForDelete=[],this.base__numEventsReceived=0,this.base__hasModifiedEvents=!1,this.base__hasModifiedShifts=!1,this.base__updatedEventsSet.clear()},base__getBaseDefaultLocationSettings:function(){return{distance:0,totaltraveltime:0,skipWatcherLogic:!1,hasError:!1,errorMessage:null,errorTimeString:null}},base__getDefaultLocationSettings:function(){return y(y({},{doShow:!1,isSpatial:!1,id:Object(a.f)(),dragStartFn:null}),this.base__getBaseDefaultLocationSettings())},resetComponentState:function(){console.warn("resetComponentState not implemented in subcomponent")},save:function(){console.warn("save not implemented in subcomponent")},returnEventToQueue:function(){console.warn("returnEventToQueue not implemented in subcomponent")},setExcludeInclude:function(){console.warn("setExcludeInclude not implemented in subcomponent")}})},I=s(1),M=Object(I.a)(A,void 0,void 0,!1,null,null,null).exports,L=s(84),D=s(106),O=s(44),k={FAVORITE:Symbol("favorite"),POI:Symbol("poi")},$={components:{MAPopover:D.a,MASearch:O.a},props:{locationRef:{type:HTMLElement,required:!0},locationRect:{type:Object,default:null},label:{type:String,required:!0},selectedHandler:{type:Function,required:!0}},data:function(){return{isLoading:!1,searchTerm:"",searchResultsRef:null,searches:[{id:Object(i.b)(),header:"Favorites",type:k.FAVORITE,onSearch:function(e,t){return L.a.searchFavorites(e,t)},label:"Name"},{id:Object(i.b)(),header:this.$Labels.MA_Places,type:k.POI,onSearch:function(e,t){return L.a.searchGoogle(e,t)},label:"label",filter:function(e){return"place"===e.type}}],Search:k}},methods:{closeHandler:function(){this.isLoading||this.$emit("close")},clearSearch:function(){this.searchTerm=""},selected:function(e){var t=this;if("place"===e.type){this.isLoading=!0;var s=window.google.maps.places;new s.PlacesService(window.MA.map).getDetails({placeId:e.placeId},(function(e,a){if(t.isLoading=!1,a!==s.PlacesServiceStatus.OK)throw new Error("failed to load new destination");t.selectedHandler({Name:e.name,Address__c:e.formatted_address,Latitude__c:e.geometry.location.lat(),Longitude__c:e.geometry.location.lng()})}))}else this.selectedHandler({Name:e.Name,Address__c:e.sma__Address__c,Latitude__c:e.sma__Latitude__c,Longitude__c:e.sma__Longitude__c})},detached:function(e){this.searchResultsRef=e}}},R=Object(I.a)($,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("MAPopover",{attrs:{bindTo:e.locationRef,bindToRect:e.locationRect,scrollElementsToIgnore:[e.searchResultsRef],showLoader:e.isLoading},on:{close:e.closeHandler}},[s("div",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.label))]),e._v(" "),s("div",{attrs:{slot:"content"},slot:"content"},[s("MASearch",{attrs:{searches:e.searches,placeholder:e.$Labels.MA_Search_for+"...",loadingLabel:e.$Labels.MA_Loading,noSearchResultsLabel:e.$Labels.MA_NO_RESULTS_FOUND},on:{clear:e.clearSearch,selected:e.selected,detached:e.detached},scopedSlots:e._u([{key:"result",fn:function(t){return s("span",{staticClass:"slds-listbox__option-text_entity slds-listbox__option slds-listbox__option_plain"},[t.type===e.Search.FAVORITE?s("span",[e._v(e._s(e._f("decode")(t.result.Name)))]):t.type===e.Search.POI?s("span",[e._v(e._s(e._f("decode")(t.result.label)))]):e._e()])}}]),model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}})],1)])}),[],!1,null,null,null).exports,x=s(535),P=s(578),F=s(139),j=s(140),H=s(45);function z(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function N(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var B={name:"RouteSelector",components:{MAActionMenu:F.a,MAActionMenuItem:j.a,MATooltip:H.a},props:{shifts:{type:Array,required:!0}},data:function(){return{showSingleButton:!0}},computed:function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?z(Object(s),!0).forEach((function(t){N(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):z(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},Object(n.mapGetters)("scheduling",{store__isAgendaDay:"isAgendaDay",store__isAgendaWeek:"isAgendaWeek"})),created:function(){this.$bus.$on("route-created",this.showButton)},mounted:function(){this.showButton()},updated:function(){this.showButton()},methods:{showButton:function(){var e=this;this.$nextTick((function(){e.showSingleButton=1===e.shifts.length&&!e.shifts[0].routing}))},hideTooltip:function(){this.$nextTick((function(){var e=document.querySelector("div.slds-scope.route-selector-tooltip");"none"!==window.getComputedStyle(e)&&e.parentNode.removeChild(e)}))},getRouteLabel:function(e){return e.routing?"Remove":"Route"},getVisibilityLabel:function(e){return e.onMap?"Hide":"Show"},getShiftTitle:function(e){var t="".concat(e.startTime.format("hh:mmA")," - ").concat(e.endTime.format("hh:mmA"));return e.isOvernight&&(t+=" (Next Day)"),t},renderVisibilityToggle:function(e){return e.routing&&Object.keys(e.routing).length}}},U=(s(604),Object(I.a)(B,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("MATooltip",{staticClass:"route-selector-tooltip",attrs:{showIcon:!0,hideOnClick:!0}},[s("div",{attrs:{slot:"icon"},slot:"icon"},[e.showSingleButton?s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container-more",class:{"slds-button_brand":e.store__isAgendaDay},on:{click:function(t){e.$emit("toggle-route",e.shifts[0]),e.showButton(),e.hideTooltip()}}},[s("span",{staticClass:"slds-button__icon slds-button_icon-small ma-icon ma-icon-map"})]):s("MAActionMenu",[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container-more",class:{"slds-button_brand":e.store__isAgendaDay},attrs:{slot:"button"},slot:"button"},[s("span",{staticClass:"slds-button__icon slds-button_icon-small ma-icon ma-icon-map"}),e._v(" "),s("span",{staticClass:"slds-button__icon ma-icon ma-icon-down"})]),e._v(" "),e._l(e.shifts,(function(t,a){return[s("li",{key:t.id,staticClass:"slds-dropdown__header slds-truncate",attrs:{title:"Menu Sub Heading",role:"separator"}},[s("span",[e._v(e._s(e.getShiftTitle(t)))])]),e._v(" "),s("MAActionMenuItem",{key:t.id+1,attrs:{label:e.getRouteLabel(t)},on:{click:function(s){return e.$emit("toggle-route",t)}}},[s("span",{staticClass:"slds-truncate"},[s("span",{staticClass:"ma-icon ma-icon-route slds-m-right_x-small"}),e._v("\n                            "+e._s(e.getRouteLabel(t))+"\n                        ")])]),e._v(" "),e.renderVisibilityToggle(t)?s("MAActionMenuItem",{key:t.id+2,attrs:{label:e.getVisibilityLabel(t)},on:{click:function(s){return e.$emit("toggle-visibility",t)}}},[s("span",{staticClass:"slds-truncate"},[s("span",{staticClass:"ma-icon ma-icon-preview slds-m-right_x-small"}),e._v("\n                            "+e._s(e.getVisibilityLabel(t))+"\n                        ")])]):e._e(),e._v(" "),a<e.shifts.length-1?s("li",{key:t.id+3,staticClass:"slds-has-divider_top-space",attrs:{role:"separator"}}):e._e()]}))],2)],1),e._v(" "),s("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            Map My Schedule\n        ")])])],1)}),[],!1,null,"2a25a212",null).exports),W={name:"ShiftColor",props:{shiftColor:{type:String,required:!0}}},Y=Object(I.a)(W,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container-more",attrs:{disabled:!0}},[t("span",{staticClass:"slds-button__icon slds-button_icon-small ma-icon-rectangle",style:"background-color: "+this.shiftColor+"; color: "+this.shiftColor+";"})])])}),[],!1,null,null,null).exports,V={props:{event:{type:Object,default:function(){}}}},q=Object(I.a)(V,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"waypoint-error slds-grid slds-grid_vertical"},[s("p",{staticClass:"slds-p-bottom_xx-small"},[e._v(e._s(e._f("decode")(e.event.errorMessage)))]),e._v(" "),e.event.errorTimeString?s("p",[e._v("Additional time needed: "+e._s(e.event.errorTimeString))]):e._e()])}),[],!1,null,null,null).exports,Q=window.MARemoting,G={components:{MASearch:O.a},props:{storedSearchTerm:{type:String,default:""}},data:function(){return{searchTerm:this.storedSearchTerm,searches:[{id:Object(i.b)(),onSearch:this.getSchedulingResources,label:"name"}]}},watch:{storedSearchTerm:function(){this.searchTerm!==this.storedSearchTerm&&(this.searchTerm=this.storedSearchTerm)}},methods:{getSchedulingResources:function(e,t){var s=this;return new Promise((function(a,n){(new f.a).setAction(Q.getSchedulingResourcesBySearchTerm).setErrorHandler(s.handleRemoteActionError.bind(s,n)).invoke([e],(function(e){var s={searchIndex:t};e.success?(s.results=e.data,a(s)):(console.warn(e),n(new Error(e.error)))}))}))},selected:function(e){console.log("data",e),this.$emit("selected",e)},errorHandler:function(e){console.warn("error in MASearch cmp: ",e)},handleRemoteActionError:function(e,t,s){e(new Error(s.message))}}},K=Object(I.a)(G,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"slds-form-element__control slds-input-has-icon slds-input-has-icon_right",attrs:{id:"scheduleUserSelectWrap"}},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("div",{staticClass:"slds-combobox_container"},[s("div",{staticClass:"slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click has-option-selected",attrs:{id:"scheduleUserSelectInputWrap","aria-expanded":"true","aria-haspopup":"listbox",role:"combobox"}},[s("div",{staticClass:"slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"},[s("MASearch",{attrs:{doDetach:!0,searches:e.searches,loadingLabel:e.$Labels.MA_Loading,noSearchResultsLabel:e.$Labels.MA_NO_RESULTS_FOUND,placeholder:"Search resources"},on:{clear:function(t){return e.$emit("clear")},selected:e.selected,error:e.errorHandler},scopedSlots:e._u([{key:"result",fn:function(t){return s("span",{staticClass:"slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta",attrs:{id:"listbox-option-unique-id-01",role:"option"}},[s("span",{staticClass:"slds-media__body"},[s("span",{staticClass:"slds-listbox__option-text slds-listbox__option-text_entity"},[e._v(e._s(e._f("decode")(t.result.name)))]),e._v(" "),s("span",{staticClass:"slds-listbox__option-meta slds-listbox__option-meta_entity"},[e._v(e._s(e._f("decode")(t.result.type||"")))])])])}}]),model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}})],1)])])])])])])}),[],!1,null,null,null).exports,J={props:{label:{type:String,required:!0},isSelected:{type:Boolean,required:!0},iconClass:{type:String,required:!0}}},Z=Object(I.a)(J,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",{staticClass:"slds-dropdown__item",class:{"slds-is-selected":e.isSelected},on:{click:function(t){return e.$emit("click")}}},[s("a",{attrs:{href:"javascript:void(0);",tabindex:"0"}},[s("span",{staticClass:"slds-truncate"},[s("span",{staticClass:"slds-icon slds-icon_selected slds-icon_x-small slds-icon-text-default slds-m-right_x-small ma-icon ma-icon-check"}),e._v("\n            "+e._s(e.label)+"\n        ")]),e._v(" "),s("span",{staticClass:"slds-icon slds-icon_x-small slds-icon-text-default slds-m-left_small slds-shrink-none ma-icon",class:e.iconClass})])])}),[],!1,null,null,null).exports,X=s(142),ee=s(18);function te(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function se(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?te(Object(s),!0).forEach((function(t){ae(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):te(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ae(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var ne=window.moment,ie={components:{MADatetimePicker:X.a,CalendarViewItem:Z},directives:{"click-outside":ee.a},data:function(){return{date:ne(),currentFormattedFCDate:"",doShowDatetimePicker:!1,showCalendarViewDropdown:!1,CalendarViews:a.a}},computed:se(se({},Object(n.mapGetters)("scheduling",["isAgendaDay","isAgendaWeek","isMonth","isDayView","isTimelineDay","calendarView","calendarDate"])),{},{iconClass:function(){switch(this.calendarView){case a.a.AGENDA_DAY:return"ma-icon-dayview";case a.a.AGENDA_WEEK:return"ma-icon-weeklyview";case a.a.MONTH:return"ma-icon-monthlyview";case a.a.TIMELINE_DAY:return"ma-icon-kanban";default:return"ma-icon-event"}},clickOutsideOptions:function(){return{active:this.showCalendarViewDropdown,handler:this.hideCalendarViewDropdown}}}),watch:{date:function(e,t){!e.doEmit&&"boolean"==typeof e.doEmit||e._fullCalendar&&!t._fullCalendar||this.$emit("date-change",e)},calendarDate:function(e){e&&(this.currentFormattedFCDate=this.getCurrentFormattedFCDate(e),this.date=Object.assign(e,{doEmit:!1}))},calendarView:function(){this.currentFormattedFCDate=this.getCurrentFormattedFCDate(this.calendarDate)}},created:function(){var e=this;this.$bus.$on("render-date-string",(function(t){e.currentFormattedFCDate=e.getCurrentFormattedFCDate(t)}))},destroyed:function(){this.$bus.$off("render-date-string")},methods:{getCurrentFormattedFCDate:function(e){var t,s=this.$User.dateFormat.toUpperCase();if(this.isDayView)t=e.format(s);else if(this.isMonth)t=ne(e).format("MMMM YYYY");else if(this.isAgendaWeek){var a=ne(e),n=ne(e).add(6,"days"),i=e.isoWeekday();7!==i&&(a=ne(e).subtract(i,"days"),n=ne(e).add(6-i,"days")),t="".concat(a.format(s)," - ").concat(n.format(s))}return t},calendarViewBtnClick:function(){this.showCalendarViewDropdown=!this.showCalendarViewDropdown},showDatetimePicker:function(){this.doShowDatetimePicker=!0},hideCalendarViewDropdown:function(){this.showCalendarViewDropdown=!1},today:function(){this.$emit("today")},previous:function(){this.$emit("previous")},next:function(){this.$emit("next")},changeCalendarView:function(e){this.hideCalendarViewDropdown(),this.$emit("view-change",e),this.$bus.$emit("resize-map")}}},oe=(s(605),Object(I.a)(ie,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-col slds-col",attrs:{id:"scheduleHeaderTimeControls"}},[s("div",{staticClass:"slds-p-right_xx-small"},[s("div",{directives:[{name:"click-outside",rawName:"v-click-outside:[clickOutsideOptions]",arg:e.clickOutsideOptions}],staticClass:"slds-dropdown-trigger slds-dropdown-trigger_click",class:{"slds-is-open":e.showCalendarViewDropdown}},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container slds-button_icon-more-flex",on:{click:e.calendarViewBtnClick}},[s("span",{staticClass:"slds-button__icon_large ma-icon",class:e.iconClass}),e._v(" "),s("span",{staticClass:"slds-button__icon_x-small ma-icon ma-icon-down"})]),e._v(" "),s("div",{staticClass:"slds-dropdown slds-dropdown_left slds-dropdown_x-small"},[s("ul",{staticClass:"slds-dropdown__list"},[s("CalendarViewItem",{attrs:{label:e.$Labels.MA_Day,isSelected:e.isAgendaDay,iconClass:"ma-icon-dayview"},on:{click:function(t){return e.changeCalendarView(e.CalendarViews.AGENDA_DAY)}}}),e._v(" "),s("CalendarViewItem",{attrs:{label:e.$Labels.MA_WEEK,isSelected:e.isAgendaWeek,iconClass:"ma-icon-weeklyview"},on:{click:function(t){return e.changeCalendarView(e.CalendarViews.AGENDA_WEEK)}}}),e._v(" "),s("CalendarViewItem",{attrs:{label:e.$Labels.MA_MONTH,isSelected:e.isMonth,iconClass:"ma-icon-monthlyview"},on:{click:function(t){return e.changeCalendarView(e.CalendarViews.MONTH)}}}),e._v(" "),s("CalendarViewItem",{attrs:{label:e.$Labels.MA_RESOURCE,isSelected:e.isTimelineDay,iconClass:"ma-icon-kanban"},on:{click:function(t){return e.changeCalendarView(e.CalendarViews.TIMELINE_DAY)}}})],1)])])]),e._v(" "),s("div",{staticClass:"slds-p-right_xx-small"},[s("button",{staticClass:"slds-button slds-button_neutral slds-button_compact",on:{click:e.today}},[e._v(e._s(e.$Labels.MA_TODAY))])]),e._v(" "),s("div",{staticClass:"slds-button-group slds-p-right_xx-small prev-next-button-group"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:e.previous}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-chevronleft"})]),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:e.next}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-chevronright"})])]),e._v(" "),s("div",[s("button",{ref:"currentDateBtn",staticClass:"slds-button",on:{click:e.showDatetimePicker}},[e._v(e._s(e.currentFormattedFCDate))]),e._v(" "),s("MADatetimePicker",{attrs:{locale:e.$User.UserLocale,timezone:e.$User.timezoneId,dateFormat:e.$User.dateFormat.toUpperCase(),showInputField:!1,refToIgnoreClickOutside:e.$refs.currentDateBtn,showCalendarSync:e.doShowDatetimePicker,previousMonthLabel:e.$Labels.MA_Previous_Month,nextMonthLabel:e.$Labels.MA_Next_Month,selectDateLabel:e.$Labels.MA_Select_A_Date,pickAYearLabel:e.$Labels.MA_Pick_A_Year,todayLabel:e.$Labels.MA_TODAY},on:{"update:showCalendarSync":function(t){e.doShowDatetimePicker=t},"update:show-calendar-sync":function(t){e.doShowDatetimePicker=t}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)])}),[],!1,null,"58285735",null).exports),re=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"slds-grid slds-grid_align-center"},[t("div",[t("span",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-new-custom95",staticStyle:{marginTop:"4px"}})]),this._v(" "),t("div",[this._v("\n                            Add to Schedule\n                        ")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"slds-grid slds-grid_align-center"},[t("div",[t("span",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-new-custom95",staticStyle:{marginTop:"4px"}})]),this._v(" "),t("div",[this._v("\n                            Add to Schedule\n                        ")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",{staticClass:"ma-icon ma-icon-move"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("figure",{staticClass:"slds-m-bottom_small"},[t("img",{attrs:{src:s(606)}})])}],ce={props:{percent:{type:Number,default:0,validate:function(){return(void 0).percent<=100}},large:{type:Boolean,default:!1},theme:{type:String,default:""},showPercent:{type:Boolean,default:!1},showStep:{type:Boolean,default:!1},step:{type:Number,default:0},isComplete:{type:Boolean,default:!1}},data:function(){return{percentStored:0}},computed:{progress:function(){var e=Math.cos(2*Math.PI*(this.percentStored/100)),t=Math.sin(2*Math.PI*(this.percentStored/100)),s=this.percentStored<50?0:1;return"M 1 0 A 1 1 0 ".concat(s," 1 ").concat(e," ").concat(t," L 0 0")},themeClass:function(){return{"slds-progress-ring_large":this.large,"slds-progress-ring_complete":this.isComplete,"slds-progress-ring_warning":"warning"===this.theme,"slds-progress-ring_expired":"expired"===this.theme,"slds-progress-ring_active-step":"active"===this.theme}}},watch:{percent:{handler:function(e){e>100?e=100:e<0&&(e=0),this.percentStored=e},immediate:!0}}},le=(s(608),Object(I.a)(ce,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-progress-ring",class:e.themeClass},[s("div",{staticClass:"slds-progress-ring__progress",attrs:{"aria-valuenow":e.percentStored,role:"progressbar","aria-valuemin":"0","aria-valuemax":"100"}},[s("svg",{attrs:{viewBox:"-1 -1 2 2"}},[s("path",{staticClass:"slds-progress-ring__path",attrs:{id:"slds-progress-ring-path-2",d:e.progress}})])]),e._v(" "),s("div",{staticClass:"slds-progress-ring__content"},[e._t("default",(function(){return[e.showPercent?[e._v("\n                "+e._s(Math.floor(e.percentStored))+"\n            ")]:e.showStep?[e.isComplete?s("span",{staticClass:"ma-icon ma-icon-check"}):s("span",[e._v(e._s(e.step))])]:e._e()]}))],2)])}),[],!1,null,"1e6f79fd",null).exports),de={components:{MATooltip:H.a,MAProgressRing:le},props:{value:{type:[Number,String],required:!0},fieldLabel:{type:String,required:!0},priorityIndex:{type:[Number,String],required:!0}}},ue=(s(609),Object(I.a)(de,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("MATooltip",{staticClass:"slds-popover_tooltip_einstein",attrs:{bindToParent:!0,helpLabel:e.$Labels.MA_HELP}},[a("div",{staticClass:"slds-popover__body slds-grid slds-grid_vertical-align-center",attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"slds-p-right_small"},[a("MAProgressRing",{attrs:{percent:e.value,large:!1,showPercent:!0,theme:100==e.value?"complete":"none"}})],1),e._v(" "),a("div",{staticClass:"slds-col"},[a("div",{staticClass:"einstein-field-name"},[e._v(e._s(e._f("decode")(e.fieldLabel)))]),e._v(" "),a("div",{staticClass:"einstein-tooltip_field"},[e._v("Priority "+e._s(e._f("decode")(e.priorityIndex)))])]),e._v(" "),a("div",{staticClass:"einstein-figure"},[a("img",{attrs:{src:s(607),alt:"Einstein"}})])])])}),[],!1,null,"3895d14c",null).exports),_e=window,he=_e.MA,fe=_e.MASystem,ve={components:{MATooltip:H.a},props:{value:{type:[Number,String],required:!0},fieldLabel:{type:String,required:!0},sfdcFieldType:{type:String,default:"number"},priorityIndex:{type:[Number,String],required:!0}},computed:{formattedValue:function(){var e=this.value;try{e=he.Util.formatNumberString(e)}catch(e){}if("currency"===this.sfdcFieldType){var t=window.getProperty(fe,"User.CurrencySymbol",!1)||"$";e="".concat(t).concat(e)}return e}}},me=(s(611),Object(I.a)(ve,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("MATooltip",{staticClass:"slds-popover_tooltip_pardot",attrs:{bindToParent:!0,helpLabel:e.$Labels.MA_HELP}},[a("div",{staticClass:"slds-popover__body slds-grid",attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"slds-col slds-p-right_x-large"},[a("div",{staticClass:"pardot-tooltip_value"},[e._v(e._s(e._f("decode")(e.formattedValue)))]),e._v(" "),a("div",{staticClass:"pardot-tooltip_field"},[e._v(e._s(e._f("decode")(e.fieldLabel)))]),e._v(" "),a("div",{staticClass:"pardot-tooltip_priority-field slds-p-bottom_small"},[e._v("Priority "+e._s(e._f("decode")(e.priorityIndex)))])]),e._v(" "),a("div",{staticClass:"pardot-figure"},[a("img",{attrs:{src:s(610),alt:"Pardot"}})])])])}),[],!1,null,"70dd4b21",null).exports),be=window,pe=be.MA,ge=be.MASystem,ye={components:{MATooltip:H.a},props:{value:{type:[Number,String],required:!0},fieldLabel:{type:String,required:!0},sfdcFieldType:{type:String,default:"number"},priorityIndex:{type:[Number,String],required:!0}},computed:{formattedValue:function(){var e=this.value;try{e=pe.Util.formatNumberString(e)}catch(e){}if("currency"===this.sfdcFieldType){var t=window.getProperty(ge,"User.CurrencySymbol",!1)||"$";e="".concat(t).concat(e)}return e}}},Se=(s(612),Object(I.a)(ye,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("MATooltip",{staticClass:"slds-popover_tooltip_priority",attrs:{bindToParent:!0,helpLabel:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-popover__body slds-grid slds-grid_vertical-align-center",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-p-right_small"},[s("div",{staticClass:"priority-tooltip_icon"},[s("span",{staticClass:"ma-icon ma-icon-arrowup"})])]),e._v(" "),s("div",{staticClass:"slds-col"},[s("div",{staticClass:"priority-tooltip_value"},[e._v(e._s(e._f("decode")(e.formattedValue)))]),e._v(" "),s("div",{staticClass:"priority-tooltip_field"},[e._v(e._s(e._f("decode")(e.fieldLabel)))]),e._v(" "),s("div",{staticClass:"priority-tooltip_priority-field"},[e._v("Priority "+e._s(e._f("decode")(e.priorityIndex)))])])])])}),[],!1,null,"4e44f748",null).exports);function Ce(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function Ee(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(s),!0).forEach((function(t){we(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ce(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function we(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Te=window,Ae=Te.$,Ie=Te.moment,Me={components:{MAActionMenu:F.a,MAActionMenuItem:j.a,MATooltip:H.a,Einstein:ue,Pardot:me,Priority:Se},props:{allowOptimization:{type:Boolean,required:!0},shifts:{type:Array,required:!1,default:function(){return[]}}},data:function(){return{CalendarViews:a.a,optimizationDays:[]}},computed:Ee(Ee(Ee({},Object(n.mapGetters)("tabs",{tabs__isTabActive:"isTabActive"})),Object(n.mapGetters)("scheduling",{store__queue:"queue",store__isQueueCollapsed:"isQueueCollapsed",store__calendarView:"calendarView",store__isTimelineDay:"isTimelineDay",store__calendarDate:"calendarDate",store__isAgendaWeek:"isAgendaWeek",store__columnIdsForOptimization:"columnIdsForOptimization",store__hasOverlappingShifts:"hasOverlappingShifts"})),{},{queueLength:function(){return this.store__queue.length},doDisableOptimizationDueToInvalidDuration:function(){return this.$parent.routeDefaults&&this.$parent.routeDefaults.duration<15},multipleShifts:function(){return this.shifts.length>1}}),watch:{queueLength:function(e,t){e!==t&&this.$nextTick(this.addDraggableStateToQueueItems)},store__calendarView:{handler:function(){var e=this;this.$nextTick((function(){e.store__isAgendaWeek&&(e.store__clearColumnIdsForOptimization(),e.optimizationDays=e.getOptimizationDays()),e.addDraggableStateToQueueItems()}))},immediate:!0},store__calendarDate:function(){this.store__isAgendaWeek&&(this.store__clearColumnIdsForOptimization(),this.optimizationDays=this.getOptimizationDays())}},mounted:function(){this.$nextTick(this.addDraggableStateToQueueItems)},created:function(){this.$bus.$on("add-to-schedule",this.addItemsToQueue)},destroyed:function(){this.$bus.$off("add-to-schedule",this.addItemsToQueue)},methods:Ee(Ee(Ee(Ee({daySelected:function(e,t){t.currentTarget.checked?this.store__columnIdsForOptimization[e]=null:delete this.store__columnIdsForOptimization[e]}},Object(n.mapActions)("scheduling",{store__removeItemFromQueueById:"removeItemFromQueueById",store__clearQueue:"clearQueue",store__addItemToQueue:"addItemToQueue",store__toggleScheduleQueue:"toggleScheduleQueue",store__clearColumnIdsForOptimization:"clearColumnIdsForOptimization"})),Object(n.mapMutations)("scheduling",{store__setUnsupportedItems:"setUnsupportedItems"})),Object(n.mapMutations)("tabs",{tabs__setTab:"setTab"})),{},{getOptimizationDays:function(){var e,t=this,s=Ie.localeData(this.locale),a=s.weekdaysMin(),n=Object.entries(this.$parent.base__columnIdToDayInstance).map((function(e){var s=e[0],n=e[1],i=Ie.tz(t.$User.timezoneId);return{columnId:s,label:a["-1"===s?6:s].charAt(0),checked:!1,disabled:void 0===n.calendarDate.isBefore||n.calendarDate.isBefore(i,"d")}}));return(n=n.concat(n.splice(0,s.firstDayOfWeek()))).forEach((function(t,s){"-1"===t.columnId&&(e=s)})),null!=e&&n.splice(e),n},getPriorityComponent:function(e){switch(e){case"Einstein":case"Pardot":return e;default:return"Priority"}},addDraggableStateToQueueItems:function(){var e=this,t=Ae("#schedulePanelBody");this.store__queue.forEach((function(s,a){var n=e.$refs["item".concat(a)];Ae(n).data("event",Object.assign(s,{stick:!1,className:s.excludeFromRoute?"non-spatial-cell":"eventCell"})).draggable({appendTo:t,containment:t,scroll:!0,helper:"clone",revert:!0,revertDuration:0,zIndex:999,start:function(){e.doDisableOptimizationDueToInvalidDuration&&window.MAToastMessages.showError({message:"Events must have a default duration of at least 15 minutes to use the Add to Schedule feature. You can edit the default event duration in your global settings."})}})}))},optimizeRoute:function(e){this.$emit("optimize",e)},addItemsToQueue:function(e){var t=this;function s(e,t){return e.isMALocation?e.placeId===t.placeId:e.relationshipId===t.relationshipId}this.tabs__isTabActive(a.b.SCHEDULING)||this.tabs__setTab(a.b.SCHEDULING);var n=[];this.store__calendarView===a.a.MONTH&&this.$store.commit("setView",a.a.AGENDA_DAY);var i=!1;e.forEach((function(e){if(700!==t.store__queue.length)if(void 0===e.isSupported||e.isSupported){e.LinkId__c&&(e.relationshipId=e.LinkId__c);var o=null!=e.lat&&null!=e.lng;e.spatial=o,e.showControls=!1,e.excludeFromRoute=!o,o||(e.className="non-spatial-cell"),e.id=Object(a.f)(),e.Name=e.title,e.baseObjectId=e.baseObjectId;var r=e.marker,c=void 0===r?{}:r;e.Address__c=c.address||c.FormattedAddress_MA||e.Address__c;var l=e.marker.prioritySettings,d=(l=void 0===l?{}:l).type,u=void 0===d?"":d,_=l.label,h=void 0===_?"":_,f=l.sfdcFieldType,v=void 0===f?"number":f,m=l.sfdcFieldValue,b=void 0===m?0:m;e.priorityValue=b,e.priority=0,e.priorityType=u,e.priorityLabel=h,e.priorityFieldType=v,delete e.marker,delete e.supportsActivities,delete e.baseObjectLabel,t.store__queue.find(s.bind(t,e))||t.store__addItemToQueue(e)}else n.push({title:e.marker.title,baseObjectLabel:e.baseObjectLabel});else i=!0})),n.length&&this.store__setUnsupportedItems(n),this.store__isQueueCollapsed&&this.store__toggleScheduleQueue(),i&&_.b.showErrorMessage(82700,_.a.SCHEDULE)},getShiftTitle:function(e){var t="".concat(e.startTime.format("hh:mmA")," - ").concat(e.endTime.format("hh:mmA"));return e.isOvernight&&(t+=" (Next Day)"),t}})},Le=(s(613),Object(I.a)(Me,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"schedulePanelQueueWrap"}},[s("div",{staticClass:"ma-schedule-queue"},[s("div",{attrs:{id:"schedulePanelQueueHeader"}},[s("div",{staticClass:"slds-grid slds-p-left_small slds-p-right_x-small slds-p-top_x-small"},[s("div",{staticClass:"slds-col queue-header-label",attrs:{title:e.store__queue.length+" "+e.$Labels.MA_STOPS+" "+e.$Labels.MA_SCHEDULE_TO_BE_SCHEDULED}},[s("h3",[e._v(e._s(e.$Labels.MA_SCHEDULE_TO_BE_SCHEDULED))])]),e._v(" "),s("MAActionMenu",{attrs:{showMoreLabel:e.$Labels.MA_SHOW_MORE}},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",attrs:{slot:"button"},slot:"button"},[s("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),s("MAActionMenuItem",{attrs:{label:e.$Labels.MA_REMOVE_ALL},on:{click:e.store__clearQueue}})],1)],1),e._v(" "),e.store__queue.length&&e.allowOptimization&&e.store__isAgendaWeek?s("div",{staticClass:"schedule-week_optimize-day-checkboxes"},e._l(e.optimizationDays,(function(t,a){return s("div",{key:a,staticClass:"optimize-checkbox"},[s("label",{attrs:{for:"checkbox"+a}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"day.checked"}],attrs:{disabled:t.disabled,id:"checkbox"+a,type:"checkbox"},domProps:{checked:Array.isArray(t.checked)?e._i(t.checked,null)>-1:t.checked},on:{click:function(t){return e.daySelected(a,t)},change:function(s){var a=t.checked,n=s.target,i=!!n.checked;if(Array.isArray(a)){var o=e._i(a,null);n.checked?o<0&&e.$set(t,"checked",a.concat([null])):o>-1&&e.$set(t,"checked",a.slice(0,o).concat(a.slice(o+1)))}else e.$set(t,"checked",i)}}}),e._v(" "),s("div",{staticClass:"faux-checkbox"},[e._v(e._s(t.label))])])])})),0):e._e(),e._v(" "),e.store__queue.length&&e.allowOptimization?s("div",{staticClass:"schedule-queue-header-action-wrap slds-p-horizontal_small"},[e.multipleShifts?s("button",{staticClass:"slds-button slds-button_brand slds-grid slds-grid_align-center",attrs:{slot:"button",disabled:e.doDisableOptimizationDueToInvalidDuration||e.store__hasOverlappingShifts||e.store__isAgendaWeek&&!Object.keys(e.store__columnIdsForOptimization).length,forceLeft:!0,"data-pendo":"schedule-queue_add-to-schedule"},on:{click:function(t){return e.optimizeRoute()}},slot:"button"},[e._m(1)]):s("button",{staticClass:"slds-button slds-button_brand slds-grid slds-grid_align-center",attrs:{disabled:e.doDisableOptimizationDueToInvalidDuration||e.store__hasOverlappingShifts||e.store__isAgendaWeek&&!Object.keys(e.store__columnIdsForOptimization).length,"data-pendo":"schedule-queue_add-to-schedule"},on:{click:function(t){return e.optimizeRoute(e.shifts[0].id)}}},[e._m(0)]),e._v(" "),e.doDisableOptimizationDueToInvalidDuration?s("MATooltip",{attrs:{bindToParent:!0,helpLabel:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-popover__body",staticStyle:{"white-space":"normal"},attrs:{slot:"content"},slot:"content"},[e._v("\n                        Events must have a default duration of at least 15 minutes to use the Add to Schedule feature. You can edit the default event duration in your global settings.\n                    ")])]):e._e()],1):e._e()]),e._v(" "),s("div",{attrs:{id:"schedulePanelQueueBody"}},[s("div",{attrs:{id:"schedulePanelQueueListWrap"}},[e.store__queue.length?s("ul",e._l(e.store__queue,(function(t,a){return s("li",{key:a,ref:"item"+a,refInFor:!0,staticClass:"schedule-queue-list-item"},[e._m(2,!0),e._v(" "),s("div",{staticClass:"schedule-queue-item-text"},[e._v(e._s(e._f("decode")(t.title)))]),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_icon remove-queue-item",on:{click:function(s){return e.store__removeItemFromQueueById(t.id)}}},[s("span",{staticClass:"ma-icon ma-icon-remove"})])]),e._v(" "),t.priorityType?s("div",{directives:[{name:"show",rawName:"v-show",value:!e.store__isTimelineDay,expression:"!store__isTimelineDay"}]},[s("span",{staticClass:"slds-button slds-button_icon priority-queue-item"},[s(e.getPriorityComponent(t.priorityType),{tag:"component",attrs:{value:t.priorityValue,fieldLabel:t.priorityLabel||"",sfdcFieldType:t.priorityFieldType||"number",priorityIndex:t.priority}}),e._v(" "),s("span",{staticClass:"ma-icon"},[e._v(e._s(e._f("decode")(t.priority)))])],1)]):e._e()])})),0):e._e(),e._v(" "),e.store__queue.length?e._e():s("div",{staticClass:"scheduleQueueEmptyState slds-grid slds-grid_vertical-align-center"},[s("div",{staticClass:"slds-notify_container--inline slds-p-around--large slds-text-align--center"},[e._m(3),e._v(" "),s("h4",[e._v(e._s(e.$Labels.MA_SCHEDULE_NOTHING_TO_ADD_TO_YOUR_SCHEDULE))]),e._v(" "),s("p",[e._v(e._s(e.$Labels.MA_SCHEDULE_USE_ADD_TO_SCHEDULE_TO_ADD_MARKERS_TO_THIS_AREA_TEXT))])])])]),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-split-view__toggle-button has-hover-tooltip hover-tooltip-750-delay",on:{click:e.store__toggleScheduleQueue}},[s("span",{staticClass:"slds-button__icon js-transition-fix slds-button__icon_x-small ma-icon ma-icon-left"}),e._v(" "),s("div",{staticStyle:{position:"relative"}},[s("div",{staticClass:"slds-popover slds-popover_tooltip slds-nubbin_left",staticStyle:{position:"absolute",top:"-20px",left:"calc(100% + 16px)"}},[s("div",{staticClass:"slds-popover__body",staticStyle:{"white-space":"nowrap"}},[e._v(e._s(e.$Labels.MA_COLLAPSE_EXPAND_QUEUE))])])])])])])])}),re,!1,null,"0c2efdc0",null).exports),De=(s(614),Object(I.a)({},(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"labor-law-notification slds-notify_container slds-notify_container--inline"},[t("div",{staticClass:"slds-notify slds-notify--alert slds-theme--warning slds-theme--alert-texture slds-banner"},[t("h2",[this._v(this._s(this.$Labels.MA_Labor_Laws))])])])}),[],!1,null,"4f4527c0",null).exports),Oe=s(63),ke=s(85),$e=window.moment,Re={components:{MAModal:Oe.a,MACheckbox:ke.a,MADatetimePicker:X.a},data:function(){return{doCloneStartEndLocations:!1,cloneTargetDate:$e()}},computed:{disableStartEndLocationToggle:function(){var e=!0,t=document.querySelector('#schedulePanelCalendarWrap .ma-calendar-location-start:not([style*="display:none"]):not([style*="display: none"])'),s=document.querySelector('#schedulePanelCalendarWrap .ma-calendar-location-end:not([style*="display:none"]):not([style*="display: none"])');return null===t&&null===s||(e=!1),e}}},xe=(s(615),Object(I.a)(Re,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("MAModal",{staticClass:"ma-import-events-modal",attrs:{doDetach:!0,title:e.$Labels.MA_Clone_Schedule,closeLabel:e.$Labels.MA_Close},on:{close:function(t){return e.$emit("cancel")}}},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_align-center slds-grid_vertical-align-center",attrs:{slot:"content"},slot:"content"},[s("MADatetimePicker",{attrs:{locale:e.$User.UserLocale,timezone:e.$User.timezoneId,dateFormat:e.$User.dateFormat.toUpperCase(),showInputField:!1,displayAsStatic:!0,previousMonthLabel:e.$Labels.MA_Previous_Month,nextMonthLabel:e.$Labels.MA_Next_Month,selectDateLabel:e.$Labels.MA_Select_A_Date,pickAYearLabel:e.$Labels.MA_Pick_A_Year,todayLabel:e.$Labels.MA_TODAY},model:{value:e.cloneTargetDate,callback:function(t){e.cloneTargetDate=t},expression:"cloneTargetDate"}}),e._v(" "),s("MACheckbox",{staticClass:"slds-grid_align-center slds-p-top_x-small",attrs:{isDisabled:e.disableStartEndLocationToggle,title:"Clone Start and End Locations"},model:{value:e.doCloneStartEndLocations,callback:function(t){e.doCloneStartEndLocations=t},expression:"doCloneStartEndLocations"}})],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(t){return e.$emit("cancel")}}},[e._v(e._s(e.$Labels.MA_Cancel))]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:function(t){return e.$emit("clone",e.cloneTargetDate,e.doCloneStartEndLocations)}}},[e._v("Clone")])])])}),[],!1,null,"5202be80",null).exports),Pe={components:{MAModal:Oe.a},props:{showModal:{type:Boolean,required:!0}},methods:{hidePendingChangeModal:function(){this.$emit("update:showModal",!1)},completeNavigationRequest:function(){this.hidePendingChangeModal(),this.$emit("discard")},saveAndCompleteNavigationRequest:function(){this.hidePendingChangeModal(),this.$emit("save")}}},Fe=(s(616),Object(I.a)(Pe,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.showModal?s("MAModal",{staticClass:"schedule-discard-changes-modal",attrs:{title:e.$Labels.MA_SCHEDULE_SAVE_SCHEDULE_CHANGES_PROMPT,closeLabel:e.$Labels.MA_Close,doDetach:!0},on:{close:e.hidePendingChangeModal}},[s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.hidePendingChangeModal}},[e._v(e._s(e._f("decode")(e.$Labels.MA_Cancel)))]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.completeNavigationRequest}},[e._v(e._s(e._f("decode")(e.$Labels.MA_Close_Discard)))])])]):e._e()}),[],!1,null,"d897e1d8",null).exports),je={components:{MAModal:Oe.a},props:{errors:{type:Object,required:!0}},data:function(){return{saveEnabled:!1,selectedConfigId:""}},computed:{showConfigChoices:function(){return this.errors&&"none"!==this.errors.type&&0!==Object.keys(this.errors).length},title:function(){return this.showConfigChoices?"Save Schedule":"Cannot Save Events to Schedule"},cancelLabel:function(){return this.showConfigChoices?this.$Labels.MA_Cancel:"Got it"},cancelClass:function(){return this.showConfigChoices?"slds-button_neutral":"slds-button_brand"},firstKey:function(){return this.showConfigChoices?Object.keys(this.errors)[0]:null},firstError:function(){return this.firstKey?this.errors[this.firstKey]:null},eventIds:function(){return this.firstError?this.firstError.eventIds:[]},sObjectLabel:function(){return this.firstError?this.firstError.sObjectLabel:null},options:function(){return this.firstError?this.firstError.options:[]}},methods:{hide:function(){this.$emit("hide")},save:function(){this.$emit("save",{eventIds:this.eventIds,configId:this.selectedConfigId}),this.hide()},select:function(e){this.saveEnabled=!0,this.selectedConfigId=e.id}}},He=(s(617),Object(I.a)(je,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("MAModal",{attrs:{title:e.title,doDetach:!0,closeLabel:e.$Labels.MA_Close},on:{close:e.hide}},[s("div",{attrs:{slot:"content"},slot:"content"},[e.showConfigChoices?s("div",{key:"config-choices",staticClass:"page-wrap slds-brand-band slds-grid slds-grid_vertical"},[s("div",{staticClass:"slds-inline_icon_text slds-grid slds-m-bottom_large"},[s("span",{staticClass:"slds-icon slds-icon--small slds-m-right--small slds-col slds-no-flex ma-icon ma-icon-info",attrs:{"aria-hidden":"true"}}),e._v(" "),s("div",{staticClass:"slds-col slds-align-middle"},[s("p",[e._v("\n                        You have multiple event configurations that are related to "),s("span",{staticClass:"slds-text-color_default"},[s("strong",[e._v(e._s(e.firstError.sObjectLabel))])]),e._v(". What would you like to save these Schedule Events as?\n                    ")])])]),e._v(" "),e._l(e.options,(function(t,a){return s("a",{key:a,staticClass:"slds-box slds-box_link slds-box_x-small slds-m-bottom_x-small",class:{"slds-is-active":e.selectedConfigId===t.id},attrs:{href:"javascript:void(0);"},on:{click:function(s){return e.select(t)}}},[s("div",{staticClass:"slds-p-around_x-small"},[s("h2",{staticClass:"slds-truncate slds-text-heading_small slds-m-bottom_x-small"},[e._v(e._s(e._f("decode")(t.name)))]),e._v(" "),s("div",{staticClass:"slds-grid slds-m-top_x-small"},[s("div",{staticClass:"slds-col slds-size_1-of-2 slds-p-right_small"},[s("div",{staticClass:"slds-text-color_weak slds-text-body_small"},[e._v("Object")]),e._v(" "),s("div",[e._v(e._s(t.objectLabel))])]),e._v(" "),s("div",{staticClass:"slds-col slds-size_1-of-2"},[s("div",{staticClass:"slds-text-color_weak slds-text-body_small"},[e._v("Related To")]),e._v(" "),s("div",[e._v(e._s(e.firstError.baseObjectLabel))])])])])])}))],2):s("div",{key:"no-config"},[s("div",{staticClass:"slds-p-around_medium"},[s("div",{staticClass:"slds-text-heading_small slds-p-bottom_medium"},[e._v("Your org doesn't have Events related to "),s("strong",[e._v(e._s(e.errors.sObjectLabel))]),e._v(" configured for use in MapAnything.")]),e._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-p-bottom_medium"},[s("div",{staticClass:"slds-col slds-border_bottom"}),e._v(" "),s("div",{staticClass:"slds-p-horizontal_x-large"},[s("span",[e._v("OR")])]),e._v(" "),s("div",{staticClass:"slds-col slds-border_bottom"})]),e._v(" "),s("div",{staticClass:"slds-text-heading_small slds-p-bottom_large"},[e._v("The Marker Layer records you are trying to save as Events use a different base object than your org's configuration for Events related to "),s("strong",[e._v(e._s(e.errors.sObjectLabel))]),e._v(".")]),e._v(" "),s("div",{staticClass:"slds-box"},[s("div",{staticClass:"slds-inline_icon_text slds-grid"},[s("div",{staticClass:"slds-icon slds-icon--large slds-col slds-p-right_small"},[s("span",{staticClass:"slds-inline__icon ma-icon ma-icon-info",staticStyle:{"font-size":"24px"}})]),e._v(" "),s("div",{staticClass:"slds-col slds-align-middle slds-m-bottom_xx-small"},[s("p",{staticClass:"slds-text-color_default"},[s("b",[e._v("How to Resolve")])]),e._v(" "),s("p",{staticClass:"slds-text-color_weak"},[e._v("Ask your Salesforce Administrator to enable Events for this related object in "),s("strong",[e._v("MapAnything Configuration")]),e._v(" > "),s("strong",[e._v("Routes & Schedule")])])])])])])])]),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button",class:e.cancelClass,on:{click:e.hide}},[e._v(e._s(e._f("decode")(e.cancelLabel)))]),e._v(" "),e.showConfigChoices?s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!e.saveEnabled},on:{click:e.save}},[e._v(e._s(e.$Labels.MA_Save))]):e._e()])])}),[],!1,null,"3eb1fd33",null).exports);function ze(e){return function(e){if(Array.isArray(e))return Ue(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Be(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==s)return;var a,n,i=[],o=!0,r=!1;try{for(s=s.call(e);!(o=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){r=!0,n=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw n}}return i}(e,t)||Be(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){if(e){if("string"==typeof e)return Ue(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Ue(e,t):void 0}}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ye(e,t,s,a,n,i,o){try{var r=e[i](o),c=r.value}catch(e){return void s(e)}r.done?t(c):Promise.resolve(c).then(a,n)}function Ve(e){return function(){var t=this,s=arguments;return new Promise((function(a,n){var i=e.apply(t,s);function o(e){Ye(i,a,n,o,r,"next",e)}function r(e){Ye(i,a,n,o,r,"throw",e)}o(void 0)}))}}function qe(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function Qe(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(s),!0).forEach((function(t){Ge(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):qe(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ge(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Ke=window,Je=Ke.$,Ze=Ke.moment,Xe=Ke.MA,et=new Map;et.set(0,{hex:"00DBBD",class:"background-color--robins-egg-blue"}),et.set(1,{hex:"3188EF",class:"background-color--dodger-blue"}),et.set(2,{hex:"FFB34C",class:"background-color--koromiko-orange"}),et.set(3,{hex:"DE6DE4",class:"background-color--medium-orchid"}),et.set(4,{hex:"FA8072",class:"background-color--salmon"}),et.set(5,{hex:"00E67B",class:"background-color--spring-green"}),et.set(6,{hex:"7BBCF6",class:"background-color--maya-blue"});var tt,st=Object(a.f)(),at=window.FullCalendar.DragListener.prototype;tt=at.startDrag,at.startDrag=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];t[0].target.classList.contains("ma-calendar-location")||tt.apply(this,t)};var nt={components:{LocationSearch:R,MAModal:Oe.a,MACheckbox:ke.a,MAActionMenu:F.a,MAActionMenuItem:j.a,RouteTimeAndDistance:x.a,RouteSummary:P.a,RouteSelector:U,ShiftColor:Y,EventError:q,ResourceSearch:K,CalendarControls:oe,Queue:Le,LaborLawNotify:De,CloneEventsModal:xe,PendingChangeModal:Fe,SaveErrorModal:He,Einstein:ue,Pardot:me,Priority:Se},extends:M,data:function(){return{routeDefaults:null,travelMode:"",counter:0,showCloneScheduleModal:!1,Location:{START:Symbol("start"),END:Symbol("end")},actionMenu:{doRender:!1,doShow:!1,bindRef:null,activeEl:null,activeColumnId:null,activeTimeString:null,showStart:!0,showEnd:!0},isGuideUser:window.MASystem.Organization.isMAGuideEnabled,locationSearch:this.getDefaultLocationSearchSettings(),activeDrag:{columnId:null,type:null,rangeValidator:null},unwatchers:[],skipCalendarDateWatcherLogic:!1,previousColumnId:null,dropZoneListeners:new Map}},computed:Qe(Qe({},Object(n.mapGetters)("scheduling",{store__columnIdsForOptimization:"columnIdsForOptimization",store__hasOverlappingShifts:"hasOverlappingShifts",store__staticTime:"staticTime"})),{},{columnIds:function(){switch(this.store__calendarView){case a.a.AGENDA_DAY:return[0];case a.a.AGENDA_WEEK:return[-1,0,1,2,3,4,5,6];default:return[]}},locationSearchHeader:function(){var e=this.locationSearch.type===this.Location.START?"Start":"End";return"Set ".concat(e," Location")},isActionMenuDisabled:function(){return!0===this.locationSearch.doRender},dayViewRoute:function(){return this.store__isAgendaDay?(this.base__shifts.find((function(e){return null!=e.routing}))||{}).route:null},doDisableOptimizationDueToInvalidDuration:function(){return this.routeDefaults&&this.routeDefaults.duration<15}}),watch:{travelMode:function(){},store__calendarDate:function(e){this.skipCalendarDateWatcherLogic&&(this.skipCalendarDateWatcherLogic=!1),this.store__calendarView!==a.a.TIMELINE_DAY&&this.base__$calendar.fullCalendar("gotoDate",e),this.store__calendarView===a.a.AGENDA_WEEK&&this.resizeWeekHeader()},store__calendarView:function(e){var t=this;this.$nextTick((function(){e!==a.a.TIMELINE_DAY&&t.base__$calendar.fullCalendar("changeView",e,Ze(t.store__calendarDate)),e===a.a.AGENDA_WEEK&&t.resizeWeekHeader(),t.base__emitViewModeChangeEvent(e)}))},columnIds:{handler:function(e,t){var s=this;0!==e.length?this.previousColumnId&&e.length===this.previousColumnId.length||(t&&t.forEach((function(e){delete s.base__columnIdToDayInstance[e]})),e.forEach((function(e){s.$set(s.base__columnIdToDayInstance,e,Object.assign(s.getDefaultDayInstance(),{columnId:e}))}))):this.previousColumnId=t},immediate:!0}},created:function(){this.$bus.$on("hide-plotted-schedule",this.toggleMapOff),this.$bus.$on("user-settings-updated",this.updateDefaultDuration),this.$bus.$on("rerenderAgendaCalendar",this.rerenderAgendaCalendar);var e=this;window.FullCalendar.View.prototype.stopNowIndicator=function(){this.nowIndicatorTimeoutID&&(clearTimeout(this.nowIndicatorTimeoutID),this.nowIndicatorTimeoutID=null),this.nowIndicatorIntervalID&&(clearInterval(this.nowIndicatorIntervalID),this.nowIndicatorIntervalID=null)},window.FullCalendar.View.prototype.updateNowIndicator=function(){this.isDatesRendered&&this.initialNowDate&&(this.unrenderNowIndicator(),this.renderNowIndicator(this.initialNowDate.clone().add(e.store__staticTime)),this.isNowIndicatorRendered=!0)}},beforeDestroy:function(){this.base__$calendar.fullCalendar("destroy")},destroyed:function(){this.$bus.$off("hide-plotted-schedule",this.toggleMapOff),this.$bus.$off("user-settings-updated",this.updateDefaultDuration),this.$bus.$off("rerenderAgendaCalendar",this.rerenderAgendaCalendar)},mounted:function(){this.base__$calendar=Je(this.$refs.calendar),this.base__$calendar.fullCalendar(d.call(this)),this.$store.commit("scheduling/setDate",this.base__getCalendarDate()),this.base__calculateEventPriorityIndex(),this.$emit("mounted")},methods:Qe(Qe({},Object(n.mapMutations)("scheduling",{store__setOverlappingShifts:"setOverlappingShifts"})),{},{getEvents:function(e,t,s,a){var n=this;return Ve(regeneratorRuntime.mark((function i(){var o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.base__calendarId){i.next=2;break}return i.abrupt("return");case 2:if(n.base__callouts+=1,i.prev=3,n.store__isMonth){i.next=10;break}return i.next=7,n.init();case 7:if(n.setTimeAxisRange(),!n.base__skipTimeAxisCheck){i.next=10;break}return i.abrupt("return");case 10:return i.next=12,n.base__fetchEvents(e,t,s,n.base__calendarId);case 12:o=i.sent,n.store__isMonth||(n.base__events=o,n.base__setShiftIdOnEvents(n.base__events)),n.$nextTick((function(){if(a(n.store__isMonth?o:n.base__events),!n.store__isMonth){var e=n.buildNonWorkingHourEvents();n.base__$calendar.fullCalendar("renderEvents",e),n.initLocations()}})),i.next=20;break;case 17:i.prev=17,i.t0=i.catch(3),n.base__genericPromiseErrorHandler(i.t0);case 20:return i.prev=20,n.base__callouts-=1,i.finish(20);case 23:case"end":return i.stop()}}),i,null,[[3,17,20,23]])})))()},buildNonWorkingHourEvents:function(){var e=[];return Object.values(this.base__columnIdToDayInstance).forEach((function(t){t.shifts.forEach((function(t){return e.push({id:st,title:"Non-working Hours",className:"non-working-hours",columnId:t.columnId,start:t.startTime,end:t.endTime,rendering:"inverse-background"})}))})),e},setTimeAxisRange:function(){if(this.base__skipTimeAxisCheck)this.base__skipTimeAxisCheck=!1;else{var e=this.base__columnIdToDayInstance[0],t=e.hasOvernightShift,s=e.earliestShiftTime,n=e.latestShiftTime;if(t&&this.store__calendarView===a.a.AGENDA_DAY){this.base__skipTimeAxisCheck=!0;var i=this.base__buildTimeAxisString(s,-4),o=this.base__buildTimeAxisString(n,28);this.base__setTimeAxisRange(i,o)}else this.base__skipTimeAxisCheck=!0,this.base__setTimeAxisRange("00:00:00","24:00:00")}},initLocations:function(){this.$nextTick(this.renderLocations()),this.initDropZones(),this.addLocationDragStartListeners(),this.createShiftRecordWatchers()},init:function(){var e=this;return new Promise((function(t){var s={id:e.base__calendarId,name:e.$User.Name};e.base__fetchRouteDefaultsByResource(s).then((function(t){return t.duration=e.base__convertStringToMinutes(t.duration),e.travelMode=t.driveProfile,e.base__setDefaultDuration(t.duration),e.routeDefaults=t,e.base__fetchCalendarShifts(e.routeDefaults)})).then((function(s){Object.values(e.base__columnIdToDayInstance).forEach((function(t){t.workingHours=e.routeDefaults.workingHours,e.base__setShiftsOnInstance(t,s),t.shifts.forEach((function(t){return e.base__shifts.push(t)}))})),t()}))}))},renderLocations:function(){var e=this;Object.values(this.base__columnIdToDayInstance).forEach((function(t){t.shifts.forEach((function(t){var s=t.id,n=t.columnId,i=t.startLocation,o=t.endLocation,r=t.startTime,c=t.endTime,l=t.isOvernight;if(i.isSpatial&&n>-1){var d=e.$refs["start-".concat(s)][0];e.renderLocation(n,r,d),i.doShow=!0}if(o.isSpatial){var u=n;if(l&&e.store__calendarView===a.a.AGENDA_WEEK&&u++,u<7&&u>-1){var _=e.$refs["end-".concat(s)][0];e.renderLocation(n,c,_,u,!0),o.doShow=!0}}}))})),this.checkOverlappingShifts()},renderLocation:function(e,t,s){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,n=arguments.length>4?arguments[4]:void 0,i=t.format("HH:mm:ss"),o=Je('.fc-view-container tr[data-time="'.concat(i,'"]'));if(o.length&&s){var r=n&&o.length>1?o.get(1).offsetTop:o.get(0).offsetTop;s.style.top="".concat(r,"px"),s.style.display="";var c=Je(this.$el).find(".fc-event-container:not(.fc-helper-container)");c[a].append(s)}},getPriorityComponent:function(e){switch(e){case"Einstein":case"Pardot":return e;default:return"Priority"}},navigateToRecord:function(e){window.ma_navigateToSObject(e.recordId)},normalizeEventTimeInterval:function(e){var t=this.base__$calendar.fullCalendar("option","slotDuration").split(":")[1],s=e.start.minutes()%t,a=e.end.minutes()%t;s>0&&(s>Math.floor(t/2)?(e.start.add(t-s,"minutes"),e.end.add(t-a,"minutes")):(e.start.subtract(s,"minutes"),e.end.subtract(a,"minutes")),this.resetRouteDataByShiftId(e.shiftId),this.base__$calendar.fullCalendar("removeEvents",e.id),this.base__$calendar.fullCalendar("renderEvent",e),this.base__hasModifiedEvents=!0,this.base__updatedEventsSet.add(e.id))},initDropZones:function(){var e=this;this.$refs.calendar.querySelectorAll("div.fc-content-skeleton td:not(.fc-axis)").forEach((function(t,s){var a=t.querySelector("div.fc-content-col");a.setAttribute("data-column",s),a.style.height="".concat(Je("div.fc-slats").height(),"px"),a.style.background="transparent";var n=function(t){e.activeDrag.rangeValidator=null;for(var a=e.$refs.calendar.querySelectorAll("div.fc-slats tr"),n=function(n){var i=a[n],o=i.offsetTop,r=o+i.offsetHeight;if(t.layerY+t.srcElement.offsetTop>=o&&t.layerY+t.srcElement.offsetTop<=r){var c=i;if(e.activeDrag.type===e.Location.START){if(n+1===a.length)return{v:void 0};c=a[n+1]}var l=e.activeDrag.type===e.Location.START?"start":"end",d=e.base__columnIdToDayInstance[e.activeDrag.isOvernight?e.activeDrag.columnId:s].shifts,u=Ze(c.getAttribute("data-time"),"HH:mm:ss");return d.forEach((function(t){var s="".concat(l,"-").concat(t.id),a=e.activeDrag.type===e.Location.START?r:o;e.$refs[s][0].style.top="".concat(a,"px");var n=parseInt(u.format("H"),10),i=parseInt(u.format("m"),10);e.activeDrag.type===e.Location.START?t.record=Qe(Qe({},t.record),{StartHour__c:n,StartMinute__c:i}):e.activeDrag.type===e.Location.END&&(t.record=Qe(Qe({},t.record),{EndHour__c:n,EndMinute__c:i})),e.resetRouteDataByShiftId(t.id)})),"break"}},i=0;i<a.length;i++){var o=n(i);if("break"===o)break;if("object"===We(o))return o.v}};t.addEventListener("drop",n),e.dropZoneListeners.set(t,n),t.addEventListener("dragover",(function(t){var a=e.activeDrag.columnId===s||e.activeDrag.isOvernight&&e.activeDrag.overnightColumnId===s,n=t.target.closest("a"),i=!n||!n.classList.contains("fc-time-grid-event"),o=!t.target.closest("div.ma-calendar-location"),r=null===e.activeDrag.rangeValidator||e.activeDrag.rangeValidator(t.layerY+t.srcElement.offsetTop);a&&i&&o&&r&&t.preventDefault()}))})),this.actionMenu.bindRef=this.$refs.calendar.querySelector("div.fc-content-skeleton"),this.actionMenu.doRender=!0},actionMenuToggleValidationFn:function(e){var t=parseInt(Je(e.srcElement).closest(".fc-content-col").get(0).getAttribute("data-column"),10);if(null===t)return!1;var s=!1,a=!1,n=this.base__columnIdToDayInstance[t].shifts[0];if(n.startLocation.isSpatial&&(s=!0),n.endLocation.isSpatial&&(a=!0),s&&a)return!1;if(s){if(this.$refs["start-".concat(n.id)][0].offsetTop>=e.layerY+e.srcElement.offsetTop)return!1}else if(a){if(this.$refs["end-".concat(n.id)][0].offsetTop<=e.layerY+e.srcElement.offsetTop)return!1}return!0},analyzeCreateTarget:function(e){var t=this;if(e&&e.target){var s=parseInt(Je(e.srcElement).closest(".fc-content-col").get(0).getAttribute("data-column"),10);if(null!==s){this.actionMenu.activeColumnId=s;var n=this.base__columnIdToDayInstance[s].shifts[0];if(n.startLocation.isSpatial&&(this.actionMenu.showStart=!1),n.endLocation.isSpatial&&(this.actionMenu.showEnd=!1),this.store__calendarView===a.a.AGENDA_DAY&&n.isOvernight)return this.actionMenu.showStart=!1,this.actionMenu.showEnd=!1,void this.$nextTick((function(){t.actionMenu.doShow=!1}));for(var i=this.$refs.calendar.querySelectorAll("div.fc-slats tr"),o=0;o<i.length;o++){var r=i[o],c=r.offsetTop,l=c+r.offsetHeight;if(e.layerY>=c&&e.layerY<=l){this.actionMenu.activeTimeString=r.getAttribute("data-time"),this.actionMenu.activeEl=r.querySelector("td.fc-widget-content:not(.fc-axis):not(.fc-time)");var d=e.target.getBoundingClientRect(),u=!1,_=this.base__columnIdToDayInstance[s].calendarDate.format("YYYY-MM-DD"),h=Ze("".concat(_,"T").concat(this.actionMenu.activeTimeString)),f=Ze("".concat(_,"T").concat(n.startTime.format("HH:mm"))),v=Ze("".concat(_,"T").concat(n.endTime.format("HH:mm"))),m=this.store__calendarView===a.a.AGENDA_DAY?{isOvernight:!1}:this.base__columnIdToDayInstance[s-1].shifts[0];if(n.isOvernight&&v.add(1,"d"),h.isBefore(f)||h.isAfter(v))if(h.isBefore(f)&&m.isOvernight)this.actionMenu.showStart=!1,Ze("".concat(_,"T").concat(m.endTime.format("HH:mm"))).isSameOrAfter(h)?m.endLocation.isSpatial?(this.actionMenu.showEnd=!1,u=!0):this.actionMenu.activeColumnId--:(this.actionMenu.showEnd=!1,u=!0);else this.actionMenu.showStart=!1,this.actionMenu.showEnd=!1,u=!0;u&&this.$nextTick((function(){t.actionMenu.doShow=!1})),this.locationSearch.rect={height:d.height,width:d.width,left:d.left,top:d.top,bottom:d.bottom,x:d.x,y:e.clientY};break}}}}},hideActionMenu:function(){this.actionMenu.showStart=!0,this.actionMenu.showEnd=!0},locationSelected:function(e){var t=this,s=this.locationSearch.type===this.Location.START,n=this.locationSearch.activeColumnId;null===n&&(n=this.actionMenu.activeColumnId);var i=s?"Start":"End",o=s?"start":"end",r=s?"startLocation":"endLocation",c={};c["".concat(i,"Location__Latitude__s")]=e.Latitude__c,c["".concat(i,"Location__Longitude__s")]=e.Longitude__c,c["".concat(i,"Address__c")]=e.Name;var l=this.base__columnIdToDayInstance[n];if(!1===l.shifts[0][r].isSpatial){var d=l.calendarDate.format("YYYY-MM-DD"),u=Ze("".concat(d,"T").concat(this.actionMenu.activeTimeString)),_=parseInt(u.format("H"),10),h=parseInt(u.format("m"),10);c["".concat(i,"Hour__c")]=_,c["".concat(i,"Minute__c")]=h}l.shifts[0].record=Qe(Qe({},l.shifts[0].record),c),l.shifts[0][r]=Qe(Qe({},l.shifts[0][r]),{isSpatial:!0,doShow:!1,id:Object(a.f)()});var f=this.$refs["".concat(o,"-").concat(l.shifts[0].id)][0];this.$nextTick((function(){var e=s?l.shifts[0].startTime:l.shifts[0].endTime;if(s)t.renderLocation(n,e,f);else{var i=n;l.shifts[0].isOvernight&&t.store__calendarView===a.a.AGENDA_WEEK&&i++,t.renderLocation(n,e,f,i,!0)}l.shifts[0][r].doShow=!0})),this.closeLocationSearch(),this.resetRouteDataByShiftId(l.shifts[0].id)},setLocationHandler:function(e){this.locationSearch.el=this.actionMenu.activeEl,this.locationSearch.type=e,this.locationSearch.doRender=!0},closeLocationSearch:function(e){e&&e.stopPropagation(),this.locationSearch=Qe(Qe({},this.getDefaultLocationSearchSettings()),{rect:this.locationSearch.rect})},searchLocation:function(e,t,s){if(e===this.Location.START){var a=Ne(this.$refs["start-".concat(t.id)],1);this.locationSearch.el=a[0]}else if(e===this.Location.END){var n=Ne(this.$refs["end-".concat(t.id)],1);this.locationSearch.el=n[0]}this.locationSearch.el.contains(s.target)||s.stopPropagation(),this.locationSearch.shiftId=t.id,this.locationSearch.activeColumnId=t.columnId,this.locationSearch.rect=null,this.locationSearch.doRender=!0,this.locationSearch.type=e},cloneScheduleClickHandler:function(){this.base__hasPendingChanges?this.$emit("error","Cannot clone schedule with pending changes. Please save the schedule and then try cloning again."):this.showCloneScheduleModal=!0},cloneSchedule:function(e,t){var s=this;this.showCloneScheduleModal=!1,this.$nextTick((function(){s.base__save({cloneTargetDate:e,cloneSourceDate:s.store__calendarDate,doClone:!0,doCloneStartEndLocations:t})}))},updateDefaultDuration:function(){if(this.$User.Id===this.base__calendarId){var e=u.a.routeDefaults.duration;e=this.base__convertStringToMinutes(e),this.base__setDefaultDuration(e),this.routeDefaults.duration=e;var t=u.a.routeDefaults.driveProfile;this.travelMode=t,this.routeDefaults.travelMode=this.travelMode}},appendCustomColumnHeaderMarkup:function(){var e=this;Je("th.fc-day-header").each((function(t,s){var a=Je(s),n=a.find("a > div, div").data("column-id")||0;if(-1!==n){var i=Je(e.$refs["route-selector-".concat(n)][0].$el);a.append(i),i=Je(e.$refs["shift-color-".concat(n)][0].$el),a.append(i)}}))},getShiftColorHex:function(e){return e=-1===e?0:e,"#".concat(et.get(e).hex)},rerenderAgendaCalendar:function(){var e=this;window.setTimeout((function(){e.base__next(),window.setTimeout((function(){e.base__previous()}),350)}),350)},removeLocation:function(e,t){this.actionMenu.doShow=!1,this.locationSearch.doRender=!1;var s=this.base__columnIdToDayInstance[e.columnId].calendarDate,a=Ze.utc(s).format("dddd").toLowerCase(),n=this.routeDefaults.workingHours[a];t===this.Location.START?(this.actionMenu.showStart=!0,e.startLocation.isSpatial=e.startLocation.doShow=!1,e.record=Qe(Qe({},e.record),{StartAddress__c:null,StartLocation__Latitude__s:null,StartLocation__Longitude__s:null,StartHour__c:n.startHour,StartMinute__c:n.startMinute})):t===this.Location.END&&(this.actionMenu.showEnd=!0,e.endLocation.isSpatial=e.endLocation.doShow=!1,e.record=Qe(Qe({},e.record),{EndAddress__c:null,EndLocation__Latitude__s:null,EndLocation__Longitude__s:null,EndHour__c:n.endHour,EndMinute__c:n.endMinute})),this.resetRouteDataByShiftId(e.id)},setCalendarToDayView:function(e){var t=this;this.resetComponentState(),this.$nextTick((function(){t.skipCalendarDateWatcherLogic=!0,t.$store.commit("scheduling/setView",a.a.AGENDA_DAY),t.$store.commit("scheduling/setDate",e)}))},setExcludeInclude:function(e){this.resetRouteDataByShiftId(e.shiftId),this.base__setExcludeInclude(e)},updateLockStatus:function(e){this.resetRouteDataByShiftId(e.shiftId),this.base__setGuideLockStatus(e)},returnEventToQueue:function(e){this.deleteEvent(e),this.base__updatedEventsSet.delete(e.id);var t=Object.assign({},e);delete t.shiftId,delete t.recordId,delete t.resourceId,delete t.start,delete t.end,delete t.hasError,delete t.source,delete t.distance,delete t.totaltraveltime,delete t.errorMessage,delete t.errorTimeString,delete t.bgColorClass,t.hasError=!1,this.store__addItemToQueue(t),this.base__hasModifiedEvents=!0},removeAllScheduledEvents:function(){var e=this,t=[];this.base__$calendar.fullCalendar("clientEvents").forEach((function(s){"inverse-background"===s.rendering||s.isBreak||(s.recordId?(e.base__eventIdsForDelete.push(s.recordId),e.base__hasModifiedEvents=!0):e.base__numEventsReceived--,t.push(s.id),e.base__updatedEventsSet.delete(s.id),e.base__$calendar.fullCalendar("removeEvents",s.id))})),this.base__numEventsReceived||this.base__eventIdsForDelete.length||(this.base__hasModifiedEvents=!1,this.base__updatedEventsSet.clear()),this.resetAllRouteData(),this.base__events=this.base__events.filter((function(e){return-1===t.indexOf(e.id)})),Xe.Map.InfoBubble.hide()},toggleRouteByShift:function(e){null==e.routing?this.generateRouteByShiftId(e.id):this.resetRouteDataByShiftId(e.id)},toggleVisibilityByShift:function(e){e.onMap=!(!e.onMap&&"boolean"!=typeof e.onMap)&&!e.onMap,e.onMap?(this.$bus.$emit("hide-plotted-route"),e.routing.restoreRouteOnMap()):(Xe.Map.InfoBubble.hide(),e.routing.hideRouteOnMap())},optimizeWeekly:function(){var e=this,t=window.userSettings||{},s=Object.keys(this.store__columnIdsForOptimization),n=[],i=new Set;s.forEach((function(t){return e.base__columnIdToDayInstance[t].shifts.forEach((function(t){e.resetRouteDataByShiftId(t.id),n.push(t),i.add(t.id)}))}));var o=this.base__$calendar.fullCalendar("clientEvents").filter((function(e){return i.has(e.shiftId)})).concat(this.buildWaypointsFromQueue());if(o.length>700)window.MAToastMessages.showError({message:window.MASystem.Labels.MA_ROUTING_ERROR,subMessage:"Please limit your route to 700 stops or less. This includes your start and end location.",timeOut:1e4,extendedTimeOut:0,closeButton:!0});else if(o.length<2)window.MAToastMessages.showError({message:window.MASystem.Labels.MA_ROUTING_ERROR,subMessage:window.MASystem.Labels.MA_Please_Add_Two_Events,timeOut:1e4,extendedTimeOut:0,closeButton:!0});else{var r=this.base__buildWaypointsFromEvents(o),c=this.routeDefaults.duration,l=n.map((function(t){var s=e.base__getRouteTimes(t),a=s.routeStartTime,n=s.routeEndTime;return{first:p.call(e,t,a,e.Location.START),last:p.call(e,t,n,e.Location.END)}}));this.base__callouts++;var d=r.softBreaks,u=void 0===d?[]:d,_=r.hardBreaks,v=void 0===_?[]:_,m=window.getProperty(t,"RouteDefaults.optimizationType",!1)||"fastest shift completion",b={dayranges:l,waypoints:r.spatial,driveProfile:window.getProperty(t,"RouteDefaults.driveProfile",!1)||"driving",optimization_type:m,blockedtimes:v.map((function(e){return{starttime:e.start+1,endtime:e.end-1}})),softbreaks:u.map((function(e){return{starttime:e.start+1,endtime:e.end-1}}))};h.a.trackRequest(b),(new f.a).setAction(this.$Remoting.MapAnythingIORequestPOST).setErrorHandler(this.base__handleRemoteActionError.bind(this)).invoke([{subType:"core",action:"schedule",version:2},JSON.stringify(b)],(function(t){var s=t.data||{},a=s.status,n=s.jobid;t.success&&n&&"Accepted"===a?e.pollOptimizationServer(n).then(e.processWeeklyOptimizationResponse).catch((function(t){return e.$emit("error",t)})).finally((function(){e.base__callouts-=1})):(e.$emit("error","Failed to start async job."),e.base__callouts-=1)}))}function p(e,t,s){var n={id:Object(a.f)(),duration:c,flexible:!1,start:t.unix()};return s===this.Location.START&&e.startLocation.isSpatial?(n.lat=e.record.StartLocation__Latitude__s,n.lng=e.record.StartLocation__Longitude__s,n.duration=0):s===this.Location.END&&e.endLocation.isSpatial&&(n.lat=e.record.EndLocation__Latitude__s,n.lng=e.record.EndLocation__Longitude__s,n.duration=0),n}},pollOptimizationServer:function(e){var t=this;return new Promise((function(s,a){var n=setInterval((function(){(new f.a).setAction(t.$Remoting.MapAnythingIORequest).setErrorHandler((function(e,t){clearInterval(n),a(t.message)})).invoke([{subType:"core",action:"schedule",version:2},{jobId:e}],(function(t){var i=t.data||{},o=i.status,r=i.routes,c=void 0===r?[]:r;if(t.success)"Completed"===o&&c.length?(clearInterval(n),s(c)):"Failed"===o&&(clearInterval(n),a(new Error("Job Failed (".concat(e,")"))));else if(void 0!==t.errInfo){var l=JSON.parse(t.errInfo.replace(/&quot;/g,'"')),d=_.b.getWaypointErrorMessage(l.error.maioCode,_.a.SCHEDULE);clearInterval(n),a(d)}else clearInterval(n),a(t.message)}))}),6e3)}))},processWeeklyOptimizationResponse:function(e){var t=this,s=function(e,s){var a=t.store__queue.find((function(e){return e.id===s.id}));if(!a)return e;t.store__removeItemFromQueueById(a.id);var n=t.base__adjustToUserTimezone(Ze(1e3*s.start)),i=Qe(Qe({},a),{},{start:n,end:t.base__adjustToUserTimezone(Ze(1e3*s.start)).add(s.duration,"seconds")});return t.base__events.push(i),e.push(i),e},a=[];e.forEach((function(e){a=[].concat(ze(a),ze(e.waypoints.reduce(s,[])))})),a.length&&(this.base__hasModifiedEvents=!0,a.forEach((function(e){t.base__updatedEventsSet.add(e.id)}))),this.base__setShiftIdOnEvents(a),this.base__$calendar.fullCalendar("renderEvents",a)},optimize:function(e){this.generateRoute(e,!0)},generateRouteByShiftId:function(e){this.generateRoute(e)},generateRoute:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.resetRouteDataByShiftId(e);var a=this.base__shifts.find((function(t){return t.id===e}));if(s&&"boolean"==typeof s&&a.startTime.isBefore(Ze(),"d"))return this.$emit("error","Cannot optimize a route for a date in the past."),void(a.onMap=!1);var n=this.base__$calendar.fullCalendar("clientEvents").filter((function(t){return t.shiftId===e}));s&&(n=n.concat(this.buildWaypointsFromQueue()));var i=this.base__buildWaypointsFromEvents(n);if(a.routing=this.base__instantiateRoute(a,i,s),this.store__isAgendaWeek){var o=et.get(a.columnId);a.routing.setStrokeColor(o.hex),a.routing.setWaypointColor(o.hex)}if(!a.routing.isWaypointLengthInRange(_.a.SCHEDULE))return a.onMap=!1,void(a.routing=null);this.$bus.$emit("hide-plotted-route"),this.base__callouts+=1,a.routing.setDriveProfile(this.travelMode).build("scheduling").then((function(){return a.route=a.routing.getRoute(),a.onMap=!0,t.processWaypoints(a),t.$nextTick((function(){try{var e=function(e){t.setTravelSummaryOnCalendarEvents(e.waypoints)};h.a.moreThanOneRoute(a.route)?a.route.routes.forEach((function(t){e(t)})):e(a.route)}catch(e){t.$emit("error","An error occurred while applying travel summary to calendar events. (".concat(e.message,")"))}})),t.store__isAgendaWeek,t.$bus.$emit("route-created"),Promise.resolve()})).catch((function(e){e&&e.maioCode&&e.details?t.base__processResponseErrors(e,a):t.base__genericPromiseErrorHandler(e),a.onMap=!1,a.routing=null})).finally(this.base__genericPromiseFinallyHandler)},processWaypoints:function(e){var t=this,s=[],a=this.store__isAgendaWeek?et.get(e.columnId).class:et.get(1).class;function n(e){e.bgColorClass=a,e.distance=this.distance,e.totaltraveltime=this.totaltraveltime}function i(t,n){this.store__removeItemFromQueueById(t.id);var i=Qe(Qe({},t),{},{columnId:e.columnId,shiftId:e.id,bgColorClass:a,start:this.base__adjustToUserTimezone(Ze(1e3*n.start)),end:this.base__adjustToUserTimezone(Ze(1e3*n.start)).add(n.duration,"seconds"),distance:n.distance,totaltraveltime:n.totaltraveltime});this.base__events.push(i),s.push(i)}var o=function(s){s.waypoints.forEach((function(s){var a=t.base__events.find((function(e){return e.id===s.id}));if(a)n.call(s,a);else{e.startLocation&&s.id===e.startLocation.id&&n.call(s,e.startLocation);var o=t.store__queue.find((function(e){return e.id===s.id}));o&&i.call(t,o,s)}}))};h.a.moreThanOneRoute(e.route)?e.route.routes.forEach((function(e){o(e)})):o(e.route),s.length?(this.base__hasModifiedEvents=!0,s.forEach((function(e){t.base__updatedEventsSet.add(e.id)})),this.base__$calendar.fullCalendar("renderEvents",s)):this.base__$calendar.fullCalendar("rerenderEvents")},duplicationCheck:function(){var e=new Set;this.base__events.forEach((function(t){var s="".concat(void 0!==t.LinkId__c?t.LinkId__c:t.relationshipId,"-").concat(t.columnId);s=void 0!==t.LinkId__c?"".concat(t.LinkId__c):void 0!==t.relationshipId?"".concat(t.relationshipId,"-").concat(t.columnId):"".concat(t.recordId,"-").concat(t.columnId),t.isMALocation&&(s=t.placeId);var a="".concat(s,"-").concat(t.shiftId);e.has(a)&&!t.isBreak?(t.hasError=!0,t.errorMessage="Duplicate Stop"):(t.hasError=!1,e.add(a))}))},setTravelSummaryOnCalendarEvents:function(e){var t=this,s=1,a=this.base__$calendar.fullCalendar("clientEvents").sort(this.base__eventSorter);e.forEach((function(e){var n=a.filter((function(t){return t.id===e.id}));n.length&&Je(t.$refs[n[0].id]).find(".fc-content").prepend('<div class="ma-stop-number-wrap"><div class="ma-stop-number">'.concat(s++,"</div></div>"))}))},resetComponentState:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.dropZoneListeners.forEach((function(e,t){return t.removeEventListener("drop",e)})),this.dropZoneListeners.clear(),this.removeShiftRecordWatchers(),this.resetAllRouteData(),this.base__resetComponentState(e),this.counter=0},resetAllRouteData:function(){var e=this;this.base__shifts.forEach((function(t){return e.resetRouteDataByShiftId(t.id)}))},resetRouteDataByShiftId:function(e){var t=this.base__shifts.find((function(t){return t.id===e}));t&&(this.removeTravelSummaryAndColorFromCalendarEventsByShiftId(e),t.routing&&t.routing.clearRouteOnMap(),Object.assign(t,{onMap:!1,routing:null,route:{}},{startLocation:Object.assign(t.startLocation,this.base__getBaseDefaultLocationSettings()),endLocation:Object.assign(t.endLocation,this.base__getBaseDefaultLocationSettings())}))},removeTravelSummaryAndColorFromCalendarEventsByShiftId:function(e){var t=this;this.base__$calendar.fullCalendar("clientEvents").forEach((function(s){s.shiftId===e&&Je(t.$refs[s.id]).find(".ma-stop-number-wrap").remove()}));var s=[];this.base__events.forEach((function(a){if(a.shiftId===e){delete a.distance,delete a.totaltraveltime,delete a.errorMessage,delete a.errorTimeString,delete a.bgColorClass,a.hasError=!1;var n=t.base__$calendar.fullCalendar("clientEvents").filter((function(e){return e.id===a.id}))[0];n&&(n.hasError=!1,s.push(n))}})),this.base__$calendar.fullCalendar("updateEvents",s)},buildWaypointsFromQueue:function(){var e=[],t={duration:60*this.routeDefaults.duration,flexible:!0};return this.store__queue.forEach((function(s){e.push(Qe(Qe({},s),t))})),e},setCalendarId:function(e){var t=this;return Ve(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t.base__calendarId=e.id,t.resetComponentState(),s.next=4,t.init();case 4:a=t.routeDefaults.timezone?t.routeDefaults.timezone:t.$User.timezoneId,t.base__$calendar.fullCalendar("option","timezone",a),t.base__$calendar.fullCalendar("option","now",t.base__adjustToUserTimezone(Ze())),t.$nextTick((function(){t.base__$calendar.fullCalendar("refetchEvents")}));case 8:case"end":return s.stop()}}),s)})))()},save:function(){return this.base__save().then(this.hardResetComponentState).catch((function(){}))},setConfigId:function(e){var t=this;this.base__setConfigId(e),this.base__save().then((function(){t.base__storedNavigationAction&&"function"==typeof t.base__storedNavigationAction?t.base__storedNavigationAction():t.hardResetComponentState()}))},hardResetComponentState:function(){this.resetComponentState(this.store__calendarView===a.a.AGENDA_DAY),this.base__$calendar.fullCalendar("refetchEvents")},deleteEvent:function(e){var t=this;this.base__deleteEvent(e),this.$nextTick((function(){t.resetRouteDataByShiftId(e.shiftId),t.base__$calendar.fullCalendar("rerenderEvents")}))},addLocationDragStartListeners:function(){var e=this;this.base__shifts.forEach((function(t){var s=e.$refs["start-".concat(t.id)][0];"function"==typeof t.startLocation.dragStartFn&&s.removeEventListener("dragstart",t.startLocation.dragStartFn);var n=function(n){n.dataTransfer.dropEffect="move",n.dataTransfer.setData("application/x-foo","foo");var i=[];if(e.activeDrag.columnId=t.columnId,e.activeDrag.shiftId=t.id,e.activeDrag.type=e.Location.START,e.activeDrag.isOvernight=t.isOvernight,!t.endLocation.isSpatial||t.isOvernight&&e.store__calendarView!==a.a.AGENDA_WEEK)e.activeDrag.rangeValidator=function(){return!1};else{var o=e.$refs["end-".concat(t.id)][0].offsetTop;e.base__shifts.forEach((function(s){s.isOvernight&&s.columnId+1===t.columnId&&t.id!==s.id&&s.endLocation.isSpatial&&i.push(e.$refs["end-".concat(s.id)][0].offsetTop)})),t.isOvernight&&e.store__calendarView===a.a.AGENDA_WEEK&&6!==t.columnId&&i.push(o),e.activeDrag.rangeValidator=function(n){var r=!i||0===i.filter((function(e){return n-s.clientHeight<=e})).length,c=t.isOvernight&&e.store__calendarView===a.a.AGENDA_WEEK,l=(!t.isOvernight||e.store__calendarView!==a.a.AGENDA_WEEK)&&n+s.clientHeight<o;return r&&(c||l)}}};t.startLocation.dragStartFn=n,s.addEventListener("dragstart",n);var i=e.$refs["end-".concat(t.id)][0];"function"==typeof t.endLocation.dragStartFn&&i.removeEventListener("dragstart",t.endLocation.dragStartFn);var o=function(s){s.dataTransfer.dropEffect="move",s.dataTransfer.setData("application/x-foo","foo");var n=[];if(e.activeDrag.columnId=t.columnId,e.activeDrag.isOvernight=t.isOvernight,e.activeDrag.isOvernight&&(e.activeDrag.overnightColumnId=t.columnId+1),e.activeDrag.shiftId=t.id,e.activeDrag.type=e.Location.END,!t.startLocation.isSpatial||t.isOvernight&&e.store__calendarView!==a.a.AGENDA_WEEK)e.activeDrag.rangeValidator=function(){return!1};else{var o=e.$refs["start-".concat(t.id)][0].offsetTop;t.isOvernight&&e.base__shifts.forEach((function(s){e.activeDrag.overnightColumnId===s.columnId&&t.id!==s.id&&s.startLocation.isSpatial&&n.push(e.$refs["start-".concat(s.id)][0].offsetTop)})),-1!==t.columnId&&n.push(o),e.activeDrag.rangeValidator=function(s){return t.isOvernight&&e.store__calendarView===a.a.AGENDA_WEEK?!n||0===n.filter((function(e){return s>=e-i.clientHeight})).length:!n||s>o+i.clientHeight}}};t.endLocation.dragStartFn=o,i.addEventListener("dragstart",o)}))},removeShiftRecordWatchers:function(){this.unwatchers.forEach((function(e){return e()}))},createShiftRecordWatchers:function(){var e=this;this.columnIds.forEach((function(t){var s=e.base__columnIdToDayInstance[t];s.shifts.forEach((function(t){e.unwatchers.push(e.$watch((function(){return t.record}),(function(a){t.doUpsert=!0,t.startTime=Ze.tz(s.calendarDate.format("YYYY-MM-DD"),e.base__getCorrectTimezone()).add(a.StartHour__c,"h").add(a.StartMinute__c,"m"),t.endTime=Ze.tz(s.calendarDate.format("YYYY-MM-DD"),e.base__getCorrectTimezone()).add(a.EndHour__c,"h").add(a.EndMinute__c,"m"),a.StartHour__c>a.EndHour__c&&(t.endTime.add(1,"day"),t.isOvernight=!0),e.base__hasModifiedShifts=!0,e.base__$calendar.fullCalendar("removeEvents",st),e.base__$calendar.fullCalendar("renderEvents",e.buildNonWorkingHourEvents())})))}))}))},checkOverlappingShifts:function(){var e,t=this,s="";this.store__calendarView===a.a.AGENDA_WEEK&&Object.values(this.base__columnIdToDayInstance).forEach((function(a){return a.shifts.forEach((function(a){-1!==a.columnId&&(0===a.columnId&&(e=t.base__columnIdToDayInstance[-1].shifts[t.base__columnIdToDayInstance[-1].shifts.length-1].endTime),null!=e&&e.valueOf()>a.startTime.valueOf()&&(""===s&&(s+=window.MASystem.Labels.MA_Please_Correct_Overlapping_Shifts),s+="  ".concat(a.startTime.format("YYYY-MM-DD hh:mm a")," - ").concat(e.format("YYYY-MM-DD hh:mm a"))),e=a.endTime)}))})),""!==s?(this.store__setOverlappingShifts(!0),window.MAToastMessages.showError({message:s,subMessage:"",timeOut:1e4,extendedTimeOut:0,closeButton:!0})):this.store__setOverlappingShifts(!1)},getDefaultLocationSearchSettings:function(){return{doRender:!1,type:null,activeColumnId:null,el:null,rect:{}}},getDefaultDayInstance:function(){return{calendarDate:{},shifts:[],hasOvernightShift:!1,earliestShiftTime:null,latestShiftTime:null}},resizeWeekHeader:function(){var e=this;this.store__isAgendaWeek&&setTimeout((function(){for(var t=e.$refs.calendar.querySelectorAll("div.fc-agendaWeek-view div.fc-widget-header th"),s=e.$refs.calendar.querySelectorAll("div.fc-content-skeleton td"),a=e.$refs.calendar.querySelectorAll("div.fc-agendaWeek-view td.fc-head-container.fc-widget-header"),n=e.$refs.calendar.querySelectorAll("div.fc-agendaWeek-view thead.fc-head"),i=0;i<s.length;i++)Je(t[i]).css("width",s[i].clientWidth);Je(t[t.length-1]).css("padding-right",n[0].clientWidth-a[0].clientWidth)}),1e3)}})},it=(s(618),Object(I.a)(nt,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-grid slds-grid_vertical",staticStyle:{height:"100%"}},[a("div",{staticClass:"slds-grid",staticStyle:{height:"100%"}},[a("div",{staticClass:"slds-grid slds-grid_vertical slds-col"},[a("PendingChangeModal",{attrs:{showModal:e.base__showPendingChangeModal},on:{"update:showModal":function(t){e.base__showPendingChangeModal=t},"update:show-modal":function(t){e.base__showPendingChangeModal=t},discard:e.base__completeNavigationRequest,save:e.base__saveAndCompleteNavigationRequest}}),e._v(" "),e.base__showSaveErrorModal?a("SaveErrorModal",{attrs:{errors:e.base__configErrors},on:{hide:e.base__hideSaveErrorModal,save:e.setConfigId}}):e._e(),e._v(" "),e.showCloneScheduleModal?a("CloneEventsModal",{on:{cancel:function(t){e.showCloneScheduleModal=!1},clone:e.cloneSchedule}}):e._e(),e._v(" "),e.base__laborLawNotify?a("LaborLawNotify"):e._e(),e._v(" "),a("div",{staticClass:"slds-p-left_medium slds-p-right_x-small slds-p-vertical_small",class:{"schedule-week-header":e.store__isAgendaWeek},attrs:{id:"schedulePanelHeader"}},[a("div",{staticClass:"slds-grid"},[a("div",{staticClass:"slds-grid slds-col",attrs:{id:"scheduleHeaderQueueCollapseBreak"}},[a("div",{staticClass:"slds-p-right_x-small"},[a("ResourceSearch",{attrs:{storedSearchTerm:e.base__searchTerm},on:{selected:e.setCalendarId}})],1),e._v(" "),a("CalendarControls",{on:{today:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__today].concat(a))},previous:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__previous].concat(a))},next:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__next].concat(a))},"view-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarView].concat(a))},"date-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarDate].concat(a))}}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.base__showControls,expression:"base__showControls"}]},[a("button",{staticClass:"slds-button slds-button_success",attrs:{disabled:e.base__doDisableSaveBtn,"data-pendo":"schedule_save"},on:{click:e.save}},[e._v(e._s(e.$Labels.MA_Save))])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.base__showControls,expression:"base__showControls"}],staticClass:"slds-p-left_x-small"},[a("MAActionMenu",{staticClass:"slds-button_last",attrs:{showMoreLabel:e.$Labels.MA_SHOW_MORE}},[a("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",attrs:{slot:"button"},slot:"button"},[a("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),a("MAActionMenuItem",{attrs:{label:e.$Labels.MA_SCHEDULE_REMOVE_ALL_SCHEDULED_EVENTS},on:{click:e.removeAllScheduledEvents}}),e._v(" "),a("MAActionMenuItem",{attrs:{label:e.$Labels.MA_SCHEDULE_RETURN_ALL_TO_BE_SCHEDULED},on:{click:e.base__returnAllEventsToQueue}}),e._v(" "),a("MAActionMenuItem",{directives:[{name:"show",rawName:"v-show",value:"agendaDay"===e.store__calendarView,expression:"store__calendarView === 'agendaDay'"}],attrs:{label:"Clone Schedule"},on:{click:e.cloneScheduleClickHandler}})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.base__showFullScreenToggleControl,expression:"base__showFullScreenToggleControl"}]},[a("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:function(t){return e.$emit("toggleFullScreen")}}},[a("span",{staticClass:"slds-button__icon ma-icon ma-icon-expand"}),e._v(" "),a("span",{staticClass:"slds-button__icon ma-icon ma-icon-contract"})])])])]),e._v(" "),a("div",{staticClass:"slds-col slds-grid",attrs:{id:"schedulePanelBody"}},[a("div",{staticClass:"slds-grid slds-grid_vertical slds-col",attrs:{id:"schedulePanelCalendarWrap"}},[a("div",{ref:"calendar",staticClass:"ma-calendar slds-grid slds-grid_vertical slds-col"})]),e._v(" "),e.store__isAgendaDay?a("Queue",{attrs:{shifts:e.base__shifts,allowOptimization:!0},on:{optimize:e.optimize}}):e._e()],1),e._v(" "),null!=e.dayViewRoute?a("RouteSummary",{attrs:{route:e.dayViewRoute,hidePrintIcons:!0,hideTrafficData:!0}}):e._e(),e._v(" "),e._l(e.base__events,(function(t,n){return a("div",{key:n+"-"+t.id,ref:t.id,refInFor:!0,on:{click:function(e){return e.preventDefault(),e.stopPropagation(),function(){return!0}.apply(null,arguments)}}},[a("div",{staticClass:"fc-content"},[t.excludeFromRoute?a("span",{staticClass:"ma-icon ma-icon-nonspacial event-icon--right"}):e._e(),e._v(" "),a("div",{staticClass:"slds-grid slds-col fc-title-wrap"},[a("div",{staticClass:"fc-title"},[e.isGuideUser&&!t.isBreak?a("span",{staticClass:"ma-icon",class:e.base__getGuideWaypointLockIcon(t),on:{click:function(s){return e.updateLockStatus(t)}}}):e.isGuideUser&&t.isBreak?a("span",{staticClass:"slds-icon_container"},[a("img",{staticClass:"slds-icon slds-icon-text-default slds-icon_xx-small",attrs:{src:s(603)}})]):e._e(),e._v("\n                            "+e._s(e._f("decode")(t.title))+"\n                        ")])]),e._v(" "),t.showControls&&!t.isBreak?a("div",{staticClass:"ma-event-controls"},[t.spatial?a("MAActionMenu",{staticClass:"slds-button_last",attrs:{isShown:e.base__isActionMenuShown,doDetach:!0,listenForManualHideEvent:!0,hideOnMouseout:!0,showMoreLabel:e.$Labels.MA_SHOW_MORE},on:{"update:isShown":function(t){e.base__isActionMenuShown=t},"update:is-shown":function(t){e.base__isActionMenuShown=t},hide:function(e){t.showControls=!1}}},[a("button",{staticClass:"schedule-event-button",attrs:{slot:"button"},slot:"button"},[a("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),a("MAActionMenuItem",{directives:[{name:"show",rawName:"v-show",value:e.base__eventHasRecord(t),expression:"base__eventHasRecord(event)"}],attrs:{label:e.$Labels.MA_VIEW_RECORD},on:{click:function(s){return e.navigateToRecord(t)}}}),e._v(" "),a("MAActionMenuItem",{attrs:{label:"Snap to Nearest Interval"},on:{click:function(s){return e.normalizeEventTimeInterval(t)}}}),e._v(" "),a("MAActionMenuItem",{attrs:{label:e.base__getExcludeIncludeActionLabel(t)},on:{click:function(s){return e.setExcludeInclude(t)}}}),e._v(" "),a("MAActionMenuItem",{attrs:{label:e.$Labels.MA_SCHEDULE_RETURN_TO_BE_SCHEDULED},on:{click:function(s){return e.returnEventToQueue(t)}}})],1):e._e(),e._v(" "),a("button",{staticClass:"schedule-event-button",on:{click:function(s){return e.deleteEvent(t)}}},[a("span",{staticClass:"ma-icon ma-icon-remove"})])],1):e._e(),e._v(" "),t.priorityType?a("div",{staticClass:"priority-queue-item-wrap"},[a("span",{staticClass:"slds-button slds-button_icon priority-queue-item"},[a(e.getPriorityComponent(t.priorityType),{tag:"component",attrs:{value:t.priorityValue,fieldLabel:t.priorityLabel||"",sfdcFieldType:t.priorityFieldType||"number",priorityIndex:t.priority}}),e._v(" "),a("span",[e._v(e._s(e._f("decode")(t.priority)))])],1)]):e._e()]),e._v(" "),t.distance?a("RouteTimeAndDistance",{attrs:{distance:t.distance,totalTravelTime:t.totaltraveltime,travelMode:e.travelMode}}):e._e(),e._v(" "),t.hasError?a("EventError",{attrs:{event:t}}):e._e()],1)})),e._v(" "),e._l(e.base__shifts,(function(t){return a("div",{directives:[{name:"show",rawName:"v-show",value:t.startLocation.doShow,expression:"shift.startLocation.doShow"}],key:"start-"+t.id,ref:"start-"+t.id,refInFor:!0,staticClass:"ma-calendar-location ma-calendar-location-start",class:{"has-location-error":t.startLocation.hasError},attrs:{draggable:"true"},on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.searchLocation(e.Location.START,t,s)}}},[a("div",{staticClass:"slds-grid"},[e._m(0,!0),e._v(" "),a("div",{staticClass:"slds-col ma-calendar-start-location-title"},[e._v("\n                        "+e._s(e._f("decode")(t.record.StartAddress__c))+"\n                    ")]),e._v(" "),a("div",{staticClass:"ma-calendar-start-location-actions",on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.removeLocation(t,e.Location.START)}}},[a("span",{staticClass:"ma-icon ma-icon-remove"})])]),e._v(" "),t.startLocation.distance?a("RouteTimeAndDistance",{staticClass:"start-route-time-wrapper",attrs:{distance:t.startLocation.distance,totalTravelTime:t.startLocation.totaltraveltime,travelMode:e.travelMode}}):e._e(),e._v(" "),t.startLocation.hasError?a("EventError",{attrs:{event:t.startLocation}}):e._e()],1)})),e._v(" "),e._l(e.base__shifts,(function(t){return a("div",{directives:[{name:"show",rawName:"v-show",value:t.endLocation.doShow,expression:"shift.endLocation.doShow"}],key:"end-"+t.id,ref:"end-"+t.id,refInFor:!0,staticClass:"ma-calendar-location ma-calendar-location-end",class:{"has-location-error":t.endLocation.hasError},attrs:{draggable:"true"},on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.searchLocation(e.Location.END,t,s)}}},[a("div",{staticClass:"slds-grid"},[e._m(1,!0),e._v(" "),a("div",{staticClass:"slds-col ma-calendar-end-location-title"},[e._v("\n                        "+e._s(e._f("decode")(t.record.EndAddress__c))+"\n                    ")]),e._v(" "),a("div",{staticClass:"ma-calendar-end-location-actions",on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.removeLocation(t,e.Location.END)}}},[a("span",{staticClass:"ma-icon ma-icon-remove"})])]),e._v(" "),t.endLocation.hasError?a("EventError",{attrs:{event:t.endLocation}}):e._e()],1)}))],2),e._v(" "),e.locationSearch.doRender?a("LocationSearch",{attrs:{locationRef:e.locationSearch.el,locationRect:e.locationSearch.rect,label:e.locationSearchHeader,selectedHandler:e.locationSelected},on:{close:e.closeLocationSearch}}):e._e(),e._v(" "),e.actionMenu.doRender?a("MAActionMenu",{ref:"actionMenu",attrs:{doShowSync:e.actionMenu.doShow,isDisabled:e.isActionMenuDisabled,isToggleValid:e.actionMenuToggleValidationFn,hideOnMouseout:!0,bindTo:e.actionMenu.bindRef,bindToMousePosition:!0,showMoreLabel:e.$Labels.MA_SHOW_MORE},on:{"update:doShowSync":function(t){return e.$set(e.actionMenu,"doShow",t)},"update:do-show-sync":function(t){return e.$set(e.actionMenu,"doShow",t)},bindToClick:e.analyzeCreateTarget,hide:e.hideActionMenu}},[e.actionMenu.showStart?a("MAActionMenuItem",{attrs:{label:"Set Start Location"},on:{click:function(t){return e.setLocationHandler(e.Location.START)}}}):e._e(),e._v(" "),e.actionMenu.showEnd?a("MAActionMenuItem",{attrs:{label:"Set End Location"},on:{click:function(t){return e.setLocationHandler(e.Location.END)}}}):e._e()],1):e._e(),e._v(" "),e.store__isAgendaWeek?a("Queue",{staticClass:"schedule-week-queue",attrs:{allowOptimization:!0,shifts:e.base__shifts},on:{optimize:e.optimizeWeekly}}):e._e(),e._v(" "),e._l(e.base__columnIdToDayInstance,(function(t){return a("ShiftColor",{key:"shift-color-"+t.columnId,ref:"shift-color-"+t.columnId,refInFor:!0,staticClass:"ma-shift-color",attrs:{hidden:e.store__isAgendaDay||-1===t.columnId,shiftColor:""+e.getShiftColorHex(t.columnId)}})})),e._v(" "),e._l(e.base__columnIdToDayInstance,(function(t){return a("RouteSelector",{key:"route-selector-"+t.columnId,ref:"route-selector-"+t.columnId,refInFor:!0,staticClass:"ma-route-selector",class:{"slds-m-right_x-small":e.store__isAgendaDay},style:e.store__hasOverlappingShifts||-1===t.columnId?"display: none;":"",attrs:{shifts:t.shifts},on:{"toggle-route":e.toggleRouteByShift,"toggle-visibility":e.toggleVisibilityByShift}})}))],2)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ma-calendar-start-location-flag"},[t("span",{staticClass:"ma-icon ma-icon-priority"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ma-calendar-end-location-flag"},[t("span",{staticClass:"ma-icon ma-icon-goal"})])}],!1,null,"0791040f",null).exports),ot=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("figure",{staticClass:"slds-m-right_large"},[t("img",{attrs:{src:s(619)}})])])}],rt=window.$,ct=function(){var e=this;return{defaultDate:this.store__calendarDate.format(),header:!1,height:function(){var e=rt(".schedulePanel.is-schedule-resource").height()-rt("#schedulePanelHeader").height();return e+=18},editable:!0,lazyFetching:!1,droppable:!0,now:this.store__staticTime,nowIndicator:!0,schedulerLicenseKey:"0947007917-fcs-1462891368",timezone:this.$User.timezoneId,locale:this.$User.UserLocale,navLinks:!0,timeFormat:this.$User.timeFormat,defaultView:a.a.TIMELINE_DAY,resourceLabelText:"Resources",resourceAreaWidth:"250",slotWidth:"64",forceEventDuration:!0,resources:[],resourceRender:function(t,s){var a=s.find(".fc-cell-content"),n=rt("<button />",{class:"slds-button slds-button_icon slds-button_icon-small",click:function(){e.$bus.$emit("remove-resources",[t.id])}}),i=rt("<span />",{class:"ma-icon ma-icon-remove"});n.append(i).appendTo(a),e.$nextTick((function(){rt(e.$refs[t.id][0].$el).detach().prependTo(a)}))},eventRender:function(t,s){"inverse-background"!==t.rendering&&(e.eventIdToHTMLElementMap.set(t.id,s),e.$nextTick((function(){var a=rt(e.$refs[t.id]);if(a.length){var n=s.find(".fc-bg").detach(),o=s.find(".fc-start-resizer").detach(),r=s.find(".fc-end-resizer").detach(),c=s.find(".fc-title").detach(),l=e.base__events.find((function(e){return e.id===t.id}));a.find(".fc-title").remove(),s.empty(),s.append(a),s.append(n),s.append(o),s.append(r),s.find(".fc-content").prepend(c),l&&l.backgroundColor&&(s.css("background-color","#".concat(l.backgroundColor)),s.css("color",Object(i.c)(l.backgroundColor))),t.hasError&&s.addClass("has-error")}})))},eventReceive:function(t){e.base__hasModifiedEvents=!0,e.base__numEventsReceived++,e.store__removeItemFromQueueById(t.id),e.base__updatedEventsSet.add(t.id),e.base__events.push(t),e.base__setShiftIdOnEvents([t]),e.removeRouteByShiftId(t.shiftId),e.removeErrorsFromLocationWaypoints(t.shiftId),e.$nextTick((function(){e.base__$calendar.fullCalendar("updateEvent",t)}))},eventClick:function(t){var s=e.base__shifts.find((function(e){return e.id===t.shiftId}));t&&s&&s.routing&&e.base__showEventOnMap(t,s.routing)},eventDrop:function(t){e.base__hasModifiedEvents=!0,e.base__updatedEventsSet.add(t.id);var s=e.base__events.find((function(e){return e.id===t.id}));e.removeRouteByShiftId(s.shiftId),e.removeErrorsFromLocationWaypoints(s.shiftId),e.removeRouteByShiftId(t.shiftId),e.removeErrorsFromLocationWaypoints(t.shiftId),s.resourceId=t.resourceId,s.hasError=!1,t.hasError=!1,e.base__setShiftIdOnEvents([t]),e.base__$calendar.fullCalendar("updateEvent",t)},eventAfterAllRender:function(){e.base__$calendar.fullCalendar("getView").stopNowIndicator()},eventResize:function(t){e.base__hasModifiedEvents=!0,e.base__updatedEventsSet.add(t.id),e.removeRouteByShiftId(t.shiftId),e.removeErrorsFromLocationWaypoints(t.shiftId),e.base__events.find((function(e){return e.id===t.id})).hasError=!1,t.hasError=!1,e.base__$calendar.fullCalendar("updateEvent",t),e.base__$calendar.fullCalendar("rerenderEvents")},eventResizeStop:function(){e.base__$calendar.fullCalendar("rerenderEvents")},eventDragStart:function(t){e.base__events.find((function(e){return e.id===t.id})).hasError=!1},eventDragStop:function(){e.base__$calendar.fullCalendar("rerenderEvents")},eventMouseover:this.base__eventMouseoverHandler,eventMouseout:this.base__eventMouseoutHandler,dayNames:this.base__getDayNames(),dayNamesShort:this.base__getDayNamesShort(),viewRender:function(){rt(".fc-time-grid-container").scroll((function(){e.base__isActionMenuShown&&(e.$bus.$emit("ma-hide-action-menu"),e.base__isActionMenuShown=!1)})),e.init(),e.$bus.$emit("render-date-string",e.store__calendarDate),setTimeout((function(){rt(window).trigger("resize")}),1e3)},viewDestroy:this.resetComponentState}};function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==s)return;var a,n,i=[],o=!0,r=!1;try{for(s=s.call(e);!(o=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){r=!0,n=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw n}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ut(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ut(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}function _t(e,t,s,a,n,i,o){try{var r=e[i](o),c=r.value}catch(e){return void s(e)}r.done?t(c):Promise.resolve(c).then(a,n)}function ht(e){return function(){var t=this,s=arguments;return new Promise((function(a,n){var i=e.apply(t,s);function o(e){_t(i,a,n,o,r,"next",e)}function r(e){_t(i,a,n,o,r,"throw",e)}o(void 0)}))}}var ft=window,vt=ft.$,mt=ft.moment,bt=ft.MA,pt=["2196F3","F44336","4CAF50","9C27B0","FFEB3B","00BCD4","E91E63","FF9800","009688","795548","263238","673AB7","CDDC39","B71C1C","0D47A1","8BC34A","03A9F4","9E9E9E","1B5E20","FFC107","4A148C","607D8B","F57F17","3F51B5","FF5722"],gt={components:{MATooltip:H.a,MACheckbox:ke.a,MAActionMenu:F.a,MAActionMenuItem:j.a,EventError:q,RouteTimeAndDistance:x.a,ResourceSearch:K,CalendarControls:oe,Queue:Le,LaborLawNotify:De,PendingChangeModal:Fe,SaveErrorModal:He},directives:{"click-outside":ee.a},extends:M,data:function(){return{didLoadResources:!1,resources:[],storedResourceSearchTerm:"",isAddResourcePopupOpen:!1,resourceIdToDayInstance:{},eventIdToHTMLElementMap:new Map,colorSet:new Set}},computed:{showEmptyStateSVG:function(){return!this.resources.length},clickOutsideOptions:function(){return{active:!0,handler:this.doHideResourceSearchPopup}}},watch:{store__calendarDate:function(e){this.base__$calendar.fullCalendar("gotoDate",e)},store__calendarView:function(e){this.base__emitViewModeChangeEvent(e)}},created:function(){this.$bus.$on("remove-resources",this.removeResourcebyIds),this.$bus.$on("hide-plotted-schedule",this.removeAllRoutes)},destroyed:function(){this.$bus.$on("remove-resources",this.removeResourcebyIds),this.$bus.$off("hide-plotted-schedule",this.removeAllRoutes)},mounted:function(){this.base__$calendar=vt(this.$refs.calendar),this.base__$calendar.fullCalendar(ct.call(this)),this.base__forceMapResize(),this.base__setDefaultDuration(this.base__convertStringToMinutes(u.a.routeDefaults.duration))},beforeDestroy:function(){this.removeAllRoutes()},methods:{buildNonWorkingHourEvents:function(){var e=this,t=[];return Object.keys(this.resourceIdToDayInstance).forEach((function(s){e.resourceIdToDayInstance[s].shifts.forEach((function(e){return t.push({id:Object(a.f)(),resourceId:s,title:"Non-working Hours",className:"non-working-hours",start:e.startTime,end:e.endTime,rendering:"inverse-background"})}))})),t},init:function(){var e=this;return ht(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.base__callouts+=1,t.prev=1,t.next=4,e.fetchResources();case 4:return t.next=6,e.loadAllResourceEvents();case 6:return t.next=8,e.initializeShifts();case 8:if(e.base__setShiftIdOnEvents(e.base__events),e.base__$calendar.fullCalendar("renderEvents",e.base__events),e.scrolllToFirstEvent(),s=e.getShiftAnalysis(),e.setTimeAxisRange(s),!e.base__skipTimeAxisCheck){t.next=15;break}return t.abrupt("return");case 15:e.$nextTick((function(){var t=e.buildNonWorkingHourEvents();e.base__$calendar.fullCalendar("renderEvents",t),e.renderShifts()})),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(1),console.error(t.t0),e.base__genericPromiseErrorHandler(t.t0);case 22:return t.prev=22,e.base__callouts-=1,t.finish(22);case 25:case"end":return t.stop()}}),t,null,[[1,18,22,25]])})))()},initializeShifts:function(){var e=this;return ht(regeneratorRuntime.mark((function t(){var s,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=[],e.base__$calendar.fullCalendar("getResources").forEach((function(t){s.push(e.base__fetchRouteDefaultsByResource({id:t.id,name:t.title}))})),t.next=4,Promise.all(s);case 4:return a=t.sent,e.buildInstancesByRouteDefaultsArr(a),t.next=8,e.setShiftsOnInstances();case 8:case"end":return t.stop()}}),t)})))()},setShiftsOnInstances:function(){var e=this;return new Promise((function(t){var s=Object.values(e.resourceIdToDayInstance).map((function(t){return e.base__fetchCalendarShifts(t.routeDefaults)}));Promise.all(s.map((function(t){return t.catch((function(t){return e.base__showMapToastError(t.message)}))}))).then((function(s){s.forEach((function(t){var s=t.request,a=(s=void 0===s?{}:s).resourceId,n=e.resourceIdToDayInstance[a];e.base__setShiftsOnInstance(n,t),n.shifts.forEach((function(t){return e.base__shifts.push(t)}))})),t()}))}))},getShiftAnalysis:function(){var e=this,t={earliestShiftTime:null,latestShiftTime:null,hasOvernightShift:!1};return Object.keys(this.resourceIdToDayInstance).forEach((function(s){var a=e.resourceIdToDayInstance[s];t.earliestShiftTime&&!a.earliestShiftTime.isBefore(t.earliestShiftTime)||(t.earliestShiftTime=a.earliestShiftTime),t.latestShiftTime&&!a.latestShiftTime.isAfter(t.latestShiftTime)||(t.latestShiftTime=a.latestShiftTime),!t.hasOvernightShift&&a.hasOvernightShift&&(t.hasOvernightShift=!0)})),t},buildInstancesByRouteDefaultsArr:function(e){var t=this,s=mt.tz(this.base__$calendar.fullCalendar("getDate").format(),mt.ISO_8601,this.$User.timezoneId);e.forEach((function(e){e.duration=t.base__convertStringToMinutes(e.duration);var a=e.resource.id,n={resourceId:a,calendarDate:s,routeDefaults:e,workingHours:e.workingHours};t.$set(t.resourceIdToDayInstance,a,n)}))},setTimeAxisRange:function(e){var t=e.earliestShiftTime,s=e.latestShiftTime,a=e.hasOvernightShift;if(this.base__skipTimeAxisCheck)this.base__skipTimeAxisCheck=!1;else if(a){this.base__skipTimeAxisCheck=!0;var n=this.base__buildTimeAxisString(t,-4),i=this.base__buildTimeAxisString(s,28);this.base__setTimeAxisRange(n,i)}else"00:00:00"!==this.base__$calendar.fullCalendar("option","minTime")&&(this.base__skipTimeAxisCheck=!0,this.base__setTimeAxisRange("00:00:00","24:00:00"))},renderShifts:function(){var e=this;Object.values(this.resourceIdToDayInstance).forEach((function(t){return t.shifts.forEach((function(t){t.startLocation.isSpatial&&setTimeout((function(){e.renderStartLocation(t),t.startLocation.doShow=!0}),bt.Util.isIE()?500:1),t.endLocation.isSpatial&&setTimeout((function(){e.renderEndLocation(t),t.endLocation.doShow=!0}),bt.Util.isIE()?500:1)}))}))},renderStartLocation:function(e){var t=this.renderLocation(e.startTime,e.resourceId,"start-".concat(e.id)),s=this.$refs["start-tooltip-".concat(e.id)];s&&s.length&&(s[0].sourceStored=vt(t).find(".ma-drive-summary-line").get(0),s[0].bindToStored=vt(t).find(".ma-drive-summary-line").get(0));var a=this.$refs["start-error-tooltip-".concat(e.id)];a&&a.length&&(a[0].sourceStored=t,a[0].bindToStored=t)},renderEndLocation:function(e){var t=this.renderLocation(e.endTime,e.resourceId,"end-".concat(e.id)),s=this.$refs["end-error-tooltip-".concat(e.id)];s&&s.length&&(s[0].sourceStored=t,s[0].bindToStored=t)},renderLocation:function(e,t,s){var a=e.format("YYYY-MM-DDTHH:00:00"),n=vt('.fc-timelineDay-view th[data-date="'.concat(a,'"]')),i=this.$refs[s];if(n.length&&i){var o=e.minutes()/60,r=n.width(),c=n.get(0).offsetLeft+o*r;i[0].style.left="".concat(c,"px"),i[0].style.display="",i[0].id=s,vt('.fc-time-area tr[data-resource-id="'.concat(t,'"] > td.fc-widget-content')).append(i[0])}},removeAllResources:function(){this.removeResourcebyIds(this.resources.map((function(e){return e.id})))},softResetComponentState:function(){this.colorSet.clear(),this.resources.forEach((function(e){e.isActive=!1})),this.unrenderRoutesFromMap(),this.eventIdToHTMLElementMap=new Map},resetComponentState:function(){this.base__resetComponentState(),this.softResetComponentState()},unrenderRoutesFromMap:function(){var e=this;this.base__shifts.forEach((function(t){var s=e.getResourceById(t.resourceId);s&&(s.isActive=!1),t.routing&&e.removeRouteByShiftId(t.id)}))},removeAllRoutes:function(){this.unrenderRoutesFromMap()},removeRouteByShiftId:function(e){var t=this.base__shifts.find((function(t){return t.id===e}));if(t&&t.routing){t.routing.clearRouteOnMap(),this.colorSet.delete(t.routing.strokeColor),this.removeTravelSummaryFromLocationWaypoints(e),this.removeTravelSummaryFromCalendarEventsByShiftId(e);var s=this.resources.find((function(e){return e.id===t.resourceId}));s&&(s.isActive=!1);var a=this.base__$calendar.fullCalendar("clientEvents").filter((function(e){return e.resourceId===t.resourceId}));this.base__$calendar.fullCalendar("updateEvents",a),t.routing=null}},toggleResourceHandler:function(e){var t=this;if(this.resources.filter((function(e){return e.isActive})).length>25)this.$nextTick((function(){t.$set(e,"isActive",!1),t.$emit("error","You can only plot ".concat(25," resources at a time. Please toggle off a resource before plotting another."))}));else{var s=this.base__shifts.find((function(t){return t.resourceId===e.id}));e.isActive?this.generateRouteByShift(s).catch((function(s){t.$nextTick((function(){t.$set(e,"isActive",!1),t.base__showMapToastError(s)}))})).finally(this.base__genericPromiseFinallyHandler):(e.isActive=!1,this.removeRouteByShiftId(s.id))}},getResourceById:function(e){return dt(this.resources.filter((function(t){return t.id===e})),1)[0]},removeErrorsFromLocationWaypoints:function(e){var t=this.base__shifts.find((function(t){return t.id===e}));if(t){var s=t.startLocation,a=t.endLocation;s.hasError=!1,a.hasError=!1}},removeTravelSummaryFromLocationWaypoints:function(e){var t=this.base__shifts.find((function(t){return t.id===e})).startLocation;t.isSpatial&&(t.distance=0,t.totaltraveltime=0,t.timeInPixels=0)},removeTravelSummaryFromCalendarEventsByShiftId:function(e){this.base__events.forEach((function(t){t.shiftId===e&&(delete t.distance,delete t.totaltraveltime,delete t.stopNumber,delete t.backgroundColor,delete t.timeInPixels,delete t.travelMode,delete t.units)}))},addResource:function(e){var t=this;return ht(regeneratorRuntime.mark((function s(){var a,n;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(t.doHideResourceSearchPopup(),s.prev=1,25!==t.resources.length){s.next=5;break}return t.$emit("error","You may only have ".concat(25," resources. Please remove a resource before adding another.")),s.abrupt("return");case 5:if(!t.isResourceAlreadyLoaded(e)){s.next=8;break}return t.$emit("error","The resource, ".concat(e.name,", is already loaded.")),s.abrupt("return");case 8:return t.base__callouts+=1,a={id:e.id,name:window.htmlDecode(e.name),title:window.htmlDecode(e.name),timezone:e.timezone?window.htmlDecode(e.timezone):window.htmlDecode(t.$User.timezoneId),isActive:!1},t.resources.push(a),s.next=13,t.saveResources();case 13:return t.base__$calendar.fullCalendar("clientEvents").forEach((function(e){"inverse-background"===e.rendering&&t.base__$calendar.fullCalendar("removeEvents",e.id)})),t.base__$calendar.fullCalendar("addResource",a),s.next=17,t.loadResourceEventsByResource(a);case 17:return t.softResetComponentState(),s.next=20,t.initializeShifts();case 20:if(t.base__setShiftIdOnEvents(t.base__events.filter((function(t){return t.resourceId===e.id}))),t.base__$calendar.fullCalendar("renderEvents",t.base__events.filter((function(t){return t.resourceId===e.id}))),n=t.getShiftAnalysis(),t.setTimeAxisRange(n),!t.base__skipTimeAxisCheck){s.next=26;break}return s.abrupt("return");case 26:t.$nextTick((function(){var e=t.buildNonWorkingHourEvents();t.base__$calendar.fullCalendar("renderEvents",e),t.renderShifts()})),s.next=32;break;case 29:s.prev=29,s.t0=s.catch(1),t.$emit("error",s.t0);case 32:return s.prev=32,t.base__callouts-=1,s.finish(32);case 35:case"end":return s.stop()}}),s,null,[[1,29,32,35]])})))()},getNextColor:function(){var e=this,t=pt.find((function(t){return!e.colorSet.has(t)}));if(!t)throw new Error("No more colors available.");return this.colorSet.add(t),t},generateRouteByShift:function(e){var t=this;return new Promise((function(s,a){try{if(!e)return void s();e.routing=t.instantiateRouteByShift(e),t.base__callouts+=1,e.routing.build("scheduling").then((function(){var a=e.routing.getRoute();a.routes&&a.routes.length&&t.processWaypoints(a.routes[0].waypoints,e.routing.strokeColor,e),t.base__$calendar.fullCalendar("rerenderEvents"),s()})).catch((function(s){s&&s.maioCode&&s.details&&t.base__processResponseErrors(s,e),a(s.message),t.removeRouteByShiftId(e.id)}))}catch(e){a(e)}}))},processWaypoints:function(e,t,s){var a=this;if(e.length){var n=vt(".fc-time-area th:first-child").width(),o=this.resourceIdToDayInstance[s.resourceId],r=o.mode,c=o.units;if(s.startLocation&&e[0].id===s.startLocation.id){var l=e.shift();s.startLocation.distance=l.distance,s.startLocation.totaltraveltime=l.totaltraveltime,s.startLocation.timeInPixels=h(l.totaltraveltime),s.startLocation.units=c,s.startLocation.mode=r}for(var d=function(s){var n=e[s],o=a.base__events.findIndex((function(e){return e.id===n.id}));if(-1===o)return{v:void 0};var l=a.eventIdToHTMLElementMap.get(a.base__events[o].id),d=h(n.totaltraveltime);a.$set(a.base__events,o,Object.assign({},a.base__events[o],{stopNumber:s+1,backgroundColor:t,fontColor:Object(i.c)("#".concat(t)),distance:n.distance,totaltraveltime:n.totaltraveltime,timeInPixels:d,offsetLeft:l.offsetLeft,clientWidth:l.width(),travelMode:r,units:c}))},u=0;u<e.length;u++){var _=d(u);if("object"===lt(_))return _.v}}function h(e){return parseInt(e/3600*n,10)}},instantiateRouteByShift:function(e){var t=this.base__$calendar.fullCalendar("clientEvents").filter((function(t){return t.shiftId===e.id})),s=this.base__buildWaypointsFromEvents(t),a=this.getNextColor(),n=this.base__instantiateRoute(e,s);return n.setStrokeColor(a),n.setWaypointColor(a),n},isResourceAlreadyLoaded:function(e){return this.base__$calendar.fullCalendar("getResourceById",e.id)},removeResourcebyIds:function(e){var t=this;return ht(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t.base__callouts+=1,s.prev=1,t.resources=t.resources.filter((function(t){return!e.includes(t.id)})),e.forEach((function(e){t.base__$calendar.fullCalendar("removeResource",e),delete t.resourceIdToDayInstance[e]})),s.next=6,t.saveResources();case 6:return t.base__$calendar.fullCalendar("clientEvents").forEach((function(e){"inverse-background"===e.rendering&&t.base__$calendar.fullCalendar("removeEvents",e.id)})),t.base__$calendar.fullCalendar("clientEvents").filter((function(t){return e.includes(t.resourceId)})).map((function(e){return e.id})).forEach((function(e){t.base__$calendar.fullCalendar("removeEvents",e)})),t.base__events=t.base__events.filter((function(t){return!e.includes(t.resourceId)})),t.softResetComponentState(),s.next=12,t.initializeShifts();case 12:if(a=t.getShiftAnalysis(),t.setTimeAxisRange(a),!t.base__skipTimeAxisCheck){s.next=16;break}return s.abrupt("return");case 16:t.$nextTick((function(){var e=t.buildNonWorkingHourEvents();t.base__$calendar.fullCalendar("renderEvents",e),t.renderShifts()})),s.next=22;break;case 19:s.prev=19,s.t0=s.catch(1),t.$emit("error",s.t0);case 22:return s.prev=22,t.base__callouts-=1,s.finish(22);case 25:case"end":return s.stop()}}),s,null,[[1,19,22,25]])})))()},loadAllResourceEvents:function(){return this.loadResourceEvents(this.base__$calendar.fullCalendar("getResources"))},loadResourceEventsByResource:function(e){return this.loadResourceEvents([e])},loadResourceEvents:function(e){var t=this;return new Promise((function(s,a){var n=t.base__$calendar.fullCalendar("getDate").startOf("day"),i=t.base__$calendar.fullCalendar("getDate").endOf("day"),o=t.$User.timezoneId,r=[];console.log("resources",e),e.forEach((function(e){var s=t.base__adjustToUserTimezone(n.clone()),a=t.base__adjustToUserTimezone(i.clone()),c=e.timezone?e.timezone:o;r.push(t.base__fetchEvents(s,a,c,e.id))})),Promise.all(r).then((function(e){e.forEach((function(e){t.base__events=t.base__events.concat(e)})),s()})).catch((function(e){a(e)}))}))},scrolllToFirstEvent:function(){if(this.base__$calendar.fullCalendar("getResources").length&&!this.base__performedScrollToLogic){var e=this.base__$calendar.find("div.fc-event-container a"),t=e&&e.length>0?e[0].offsetLeft:0;e.each((function(e,s){s.offsetLeft<t&&(t=s.offsetLeft)})),vt("div.fc-scroller").animate({scrollLeft:t},250),this.base__performedScrollToLogic=!0}},fetchResources:function(){var e=this;return new Promise((function(t,s){if(e.didLoadResources)t();else{var a=e.base__calendarId.startsWith("005")?e.base__calendarId:e.$User.Id;(new f.a).setAction(e.$Remoting.getCalendarResourcesByUserId).setErrorHandler(e.base__handleRemoteActionError.bind(e,s)).invoke([a],(function(a){try{a.success?(a.data.forEach((function(t){t.isActive=!1,t.title="string"==typeof t.title?window.htmlDecode(t.title):t.title,e.resources.push(t),e.base__$calendar.fullCalendar("addResource",t)})),e.didLoadResources=!0,t()):s(new Error(a.message))}catch(e){s(new Error(e))}}))}}))},saveResources:function(){var e=this,t=this;return new Promise((function(s,a){var n=e.resources.map((function(e){return{id:e.id,title:e.title,timezone:e.timezone?e.timezone:t.$User.timezone}}));(new f.a).setAction(e.$Remoting.saveCalendarResources).setErrorHandler(e.base__handleRemoteActionError.bind(e,a)).invoke([n,e.base__calendarId],(function(e){e.success?s():a(new Error(e.message))}))}))},save:function(){var e=this;return this.base__save().then((function(){e.softResetComponentState(),e.base__$calendar.fullCalendar("rerenderEvents")})).catch((function(){}))},setConfigId:function(e){var t=this;this.base__setConfigId(e),this.base__save().then((function(){t.base__storedNavigationAction&&"function"==typeof t.base__storedNavigationAction&&t.base__storedNavigationAction(),t.resetComponentState()}))},deleteEvent:function(e){this.removeRouteByShiftId(e.shiftId),this.base__deleteEvent(e)},returnEventToQueue:function(e){this.deleteEvent(e);var t=Object.assign({},e);delete t.shiftId,delete t.recordId,delete t.resourceId,delete t.start,delete t.end,delete t.hasError,delete t.source,delete t.distance,delete t.totaltraveltime,delete t.errorMessage,delete t.errorTimeString,delete t.bgColorClass,t.hasError=!1,this.store__addItemToQueue(t)},setExcludeInclude:function(e){this.removeRouteByShiftId(e.shiftId),this.base__setExcludeInclude(e)},setFocus:function(){var e=this;this.$nextTick((function(){return e.$el.querySelector("input").focus()}))},doHideResourceSearchPopup:function(){this.isAddResourcePopupOpen=!1,this.storedResourceSearchTerm=""}}},yt=(s(620),s(621),Object(I.a)(gt,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-grid slds-grid_vertical",staticStyle:{height:"100%"}},[s("div",{staticClass:"slds-grid",staticStyle:{height:"100%"}},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-col",staticStyle:{height:"100%"}},[s("PendingChangeModal",{attrs:{showModal:e.base__showPendingChangeModal},on:{"update:showModal":function(t){e.base__showPendingChangeModal=t},"update:show-modal":function(t){e.base__showPendingChangeModal=t},discard:e.base__completeNavigationRequest,save:e.base__saveAndCompleteNavigationRequest}}),e._v(" "),e.base__showSaveErrorModal?s("SaveErrorModal",{attrs:{errors:e.base__configErrors},on:{hide:e.base__hideSaveErrorModal,save:e.setConfigId}}):e._e(),e._v(" "),e.base__laborLawNotify?s("LaborLawNotify"):e._e(),e._v(" "),s("div",{staticClass:"schedule-week-header slds-p-left_medium slds-p-right_x-small slds-p-vertical_small",attrs:{id:"schedulePanelHeader"}},[s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"slds-grid slds-col",attrs:{id:"scheduleHeaderQueueCollapseBreak"}},[s("CalendarControls",{on:{today:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__today].concat(a))},previous:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__previous].concat(a))},next:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__next].concat(a))},"view-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarView].concat(a))},"date-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarDate].concat(a))}}})],1),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_success",attrs:{disabled:e.base__doDisableSaveBtn},on:{click:e.save}},[e._v(e._s(e.$Labels.MA_Save))])]),e._v(" "),s("div",{staticClass:"slds-p-left_medium ma-resource-right-menu"},[s("MAActionMenu",{attrs:{showMoreLabel:e.$Labels.MA_SHOW_MORE}},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",attrs:{slot:"button"},slot:"button"},[s("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),s("MAActionMenuItem",{attrs:{label:e.$Labels.MA_REMOVE_ALL_RESOURCES},on:{click:e.removeAllResources}}),e._v(" "),s("MAActionMenuItem",{attrs:{label:e.$Labels.MA_REMOVE_ALL_FROM_MAP},on:{click:e.unrenderRoutesFromMap}}),e._v(" "),s("MAActionMenuItem",{attrs:{label:"Return all events to 'To Be Scheduled'"},on:{click:e.base__returnAllEventsToQueue}})],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.base__showFullScreenToggleControl,expression:"base__showFullScreenToggleControl"}],staticClass:"slds-p-left_xx-small"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:function(t){return e.$emit("toggleFullScreen")}}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-expand"}),e._v(" "),s("span",{staticClass:"slds-button__icon ma-icon ma-icon-contract"})])])])]),e._v(" "),s("div",{staticClass:"slds-col slds-grid",attrs:{id:"schedulePanelBody"}},[s("div",{staticClass:"addResourceButtonPositioner"},[s("button",{staticClass:"addResourceButton slds-button",on:{click:function(t){e.isAddResourcePopupOpen=!0,e.setFocus()}}},[s("span",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-new"}),e._v("\n                        "+e._s(e.$Labels.MA_Add)+"\n                    ")]),e._v(" "),e.isAddResourcePopupOpen?s("section",{directives:[{name:"click-outside",rawName:"v-click-outside:[clickOutsideOptions]",arg:e.clickOutsideOptions}],staticClass:"slds-popover slds-nubbin_bottom-left"},[s("div",{staticClass:"slds-popover__body"},[s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"slds-col"},[s("ResourceSearch",{attrs:{storedSearchTerm:e.storedResourceSearchTerm},on:{selected:e.addResource}})],1),e._v(" "),s("div",{staticClass:"slds-p-left_x-small"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.doHideResourceSearchPopup}},[e._v(e._s(e.$Labels.MA_Cancel))])])])])]):e._e()]),e._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical slds-col",attrs:{id:"schedulePanelCalendarWrap"}},[s("div",{ref:"calendar",staticClass:"ma-calendar slds-grid slds-grid_vertical slds-col"})]),e._v(" "),e.showEmptyStateSVG?s("div",{staticClass:"resource-empty-state"},[s("div",{staticClass:"slds-grid slds-grid_align-center slds-grid_vertical-align-center"},[e._m(0),e._v(" "),s("div",[s("h4",[e._v(e._s(e.$Labels.MA_RESOURCES_NO_RESOURCES_ADDED))]),e._v(" "),s("p",[e._v(e._s(e.$Labels.MA_RESOURCE_CLICK_THE_ADD_A_RESOURCE_BUTTON_GUIDE_TEXT))])])])]):e._e()]),e._v(" "),s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"slds-col"}),e._v(" "),s("div",e._l(e.resources,(function(t){return s("MACheckbox",{key:t.id,ref:t.id,refInFor:!0,attrs:{toggleBuffer:2e3},on:{input:function(s){return e.toggleResourceHandler(t)}},model:{value:t.isActive,callback:function(s){e.$set(t,"isActive",s)},expression:"resource.isActive"}})})),1)]),e._v(" "),e._l(e.base__events.filter((function(e){return null!==e.shiftId})),(function(t){return s("div",{key:t.id,ref:t.id,refInFor:!0,staticClass:"ma-resource-event"},[s("div",{staticClass:"fc-content slds-grid_vertical-align-center slds-grid_align-spread"},[t.excludeFromRoute?s("span",{staticClass:"ma-icon ma-icon-nonspacial event-icon--right"}):e._e(),e._v(" "),t.showControls&&!t.isBreak?s("div",{staticClass:"ma-event-controls slds-col_bump-left"},[t.spatial?s("MAActionMenu",{staticClass:"slds-button_last",attrs:{isShown:e.base__isActionMenuShown,doDetach:!0,listenForManualHideEvent:!0,showMoreLabel:e.$Labels.MA_SHOW_MORE},on:{"update:isShown":function(t){e.base__isActionMenuShown=t},"update:is-shown":function(t){e.base__isActionMenuShown=t},hide:function(e){t.showControls=!1}}},[s("button",{staticClass:"schedule-event-button",attrs:{slot:"button"},slot:"button"},[s("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),s("MAActionMenuItem",{attrs:{label:"Delete"},on:{click:function(s){return e.deleteEvent(t)}}}),e._v(" "),s("MAActionMenuItem",{attrs:{label:e.base__getExcludeIncludeActionLabel(t)},on:{click:function(s){return e.setExcludeInclude(t)}}}),e._v(" "),s("MAActionMenuItem",{attrs:{label:"Return to 'To Be Scheduled'"},on:{click:function(s){return e.returnEventToQueue(t)}}})],1):e._e()],1):e._e()]),e._v(" "),t.timeInPixels?s("div",{staticClass:"ma-drive-summary-line",style:{width:t.timeInPixels+"px"}},[s("MATooltip",{attrs:{bindToParent:!0,source:e.eventIdToHTMLElementMap.get(t.id)[0],helpLabel:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-popover__body",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("RouteTimeAndDistance",{staticClass:"ma-time-distance",attrs:{distance:t.distance,totalTravelTime:t.totaltraveltime,travelMode:t.travelMode,units:t.units}})],1)])])],1):e._e(),e._v(" "),t.hasError?s("MATooltip",{staticClass:"waypoint-error-tooltip",attrs:{bindToParent:!0,source:e.eventIdToHTMLElementMap.get(t.id)[0],helpLabel:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-popover__body",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("EventError",{attrs:{event:t}})],1)])]):e._e()],1)})),e._v(" "),e._l(e.base__shifts,(function(t){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.startLocation.doShow,expression:"shift.startLocation.doShow"}],key:"start-"+t.id,ref:"start-"+t.id,refInFor:!0,staticClass:"ma-resource-location ma-resource-location-start",class:{"has-location-error":t.startLocation.hasError}},[s("div",{staticClass:"ma-drive-summary-line"},[t.startLocation.timeInPixels?s("MATooltip",{ref:"start-tooltip-"+t.id,refInFor:!0,style:{width:t.startLocation.timeInPixels+"px"},attrs:{helpLabel:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-popover__body",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("RouteTimeAndDistance",{staticClass:"ma-time-distance",attrs:{distance:t.startLocation.distance,totalTravelTime:t.startLocation.totaltraveltime,travelMode:t.startLocation.mode,units:t.startLocation.units}})],1)])]):e._e()],1),e._v(" "),s("div",{staticClass:"ma-icon ma-icon-priority"}),e._v(" "),t.startLocation.hasError?s("MATooltip",{ref:"start-error-tooltip-"+t.id,refInFor:!0,staticClass:"waypoint-error-tooltip",attrs:{helpLabel:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-popover__body",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("EventError",{attrs:{event:t.startLocation}})],1)])]):e._e()],1)})),e._v(" "),e._l(e.base__shifts,(function(t){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.endLocation.doShow,expression:"shift.endLocation.doShow"}],key:"end-"+t.id,ref:"end-"+t.id,refInFor:!0,staticClass:"ma-resource-location ma-resource-location-end",class:{"has-location-error":t.endLocation.hasError}},[s("div",{staticClass:"ma-icon ma-icon-goal"}),e._v(" "),t.endLocation.hasError?s("MATooltip",{ref:"end-error-tooltip-"+t.id,refInFor:!0,staticClass:"waypoint-error-tooltip",attrs:{helpLabel:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-popover__body",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("EventError",{attrs:{event:t.endLocation}})],1)])]):e._e()],1)}))],2),e._v(" "),s("Queue",{staticClass:"schedule-week-queue",attrs:{allowOptimization:!1}})],1)])}),ot,!1,null,"1bb98b10",null).exports),St=s(19),Ct=s(141);function Et(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function wt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(s),!0).forEach((function(t){Tt(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Et(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Tt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var At=window.$,It={components:{MASpinner:St.a,MAToast:Ct.a,Calendar:it,ResourceCalendar:yt},data:function(){return{toast:"",level:"error",viewMode:a.d.DEFAULT,hasRightPanelIn:!1,isLoading:!0,doLoad:!1,mountedCallback:null}},computed:wt(wt({},Object(n.mapGetters)("tabs",{tabs__isTabActive:"isTabActive"})),{},{isTabActive:function(){return this.tabs__isTabActive(a.b.SCHEDULING)},isHalfHeight:function(){return this.viewMode===a.d.FULLWIDTH_HALFHEIGHT},isFullHeight:function(){return this.viewMode===a.d.FULLWIDTH_FULLHEIGHT},showFullScreenToggleControl:function(){return this.isHalfHeight||this.isFullHeight}},Object(n.mapGetters)("scheduling",{store__isAgendaDay:"isAgendaDay",store__isTimelineDay:"isTimelineDay",store__isAgendaWeek:"isAgendaWeek",store__isQueueCollapsed:"isQueueCollapsed",store__isQueueToggling:"isQueueToggling",store__unsupportedItems:"unsupportedItems"})),watch:{isTabActive:function(e){var t=this;e?(this.doLoad||setTimeout((function(){t.doLoad=!0}),300),this.$bus.$emit("set-map-view-mode",this.viewMode)):this.$bus.$emit("set-map-view-mode",a.d.DEFAULT)},viewMode:function(e){this.$bus.$emit("set-map-view-mode",e)}},created:function(){var e=this;this.$bus.$on("set-scheduling-has-right-panel-in",(function(t){e.hasRightPanelIn=t})),this.$bus.$on("activate-scheduling",this.activateScheduling),this.$bus.$on("set-calendar-view-mode",this.setViewMode),this.$bus.$on("set-schedule-fullscreen",this.setFullscreen)},destroyed:function(){this.$bus.$off("set-scheduling-has-right-panel-in"),this.$bus.$off("activate-scheduling",this.activateScheduling),this.$bus.$off("set-calendar-view-mode"),this.$bus.$off("set-schedule-fullscreen",this.setFullscreen)},methods:wt(wt(wt({},Object(n.mapMutations)("scheduling",{store__setUnsupportedItems:"setUnsupportedItems"})),Object(n.mapMutations)("tabs",{tabs__setTab:"setTab"})),{},{calendarMounted:function(){this.mountedCallback&&(this.mountedCallback(),this.mountedCallback=null)},activateScheduling:function(e){e&&"function"==typeof e&&(this.doLoad?e():(this.mountedCallback=e,this.tabs__setTab(a.b.SCHEDULING)))},closeToast:function(){this.toast="",this.level="error"},showError:function(e,t){var s=e instanceof Error?e.message:e;this.toast=s,t&&(this.level=t)},toggleFullScreen:function(){var e=this.viewMode===a.d.FULLWIDTH_FULLHEIGHT?a.d.FULLWIDTH_HALFHEIGHT:a.d.FULLWIDTH_FULLHEIGHT;this.viewMode=e,setTimeout((function(){At(window).trigger("resize")}),500)},setFullscreen:function(e){this.isTabActive&&!this.store__isAgendaDay&&(e?this.setViewMode(a.d.FULLWIDTH_FULLHEIGHT):this.setViewMode(a.d.FULLWIDTH_HALFHEIGHT))},setViewMode:function(e){Object.values(a.d).includes(e)&&(this.viewMode=e)}})},Mt=(s(622),s(623),Object(I.a)(It,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"schedulePanel left-ui-panel",class:{"is-in":e.isTabActive,"is-agenda-day-view":e.store__isAgendaDay,"is-schedule-week":e.store__isAgendaWeek,"is-schedule-resource":e.store__isTimelineDay,"queue-is-collapsed":e.store__isQueueCollapsed,"queue-is-toggling":e.store__isQueueToggling,"is-fullwidth-halfheight":e.isHalfHeight,"is-fullwidth-fullheight":e.isFullHeight,"has-right-panel-in":e.hasRightPanelIn}},[s("div",{staticClass:"calendar"},[s("MASpinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],attrs:{loadingLabel:e.$Labels.MA_Loading}}),e._v(" "),e.store__unsupportedItems.length?s("MAToast",{attrs:{closeLabel:e.$Labels.MA_Close,errorLabel:e.$Labels.MA_Error,state:"warning"},on:{close:function(t){return e.store__setUnsupportedItems([])}}},[s("div",[s("h2",{staticClass:"slds-text-heading_small"},[e._v(e._s(e.$Labels.MA_SCHEDULE_YOU_CANNOT_SCHEDULE_EVENTS_FOR_THESE_RECORDS_MESSAGE))]),e._v(" "),s("div",{staticClass:"slds-scrollable_y slds-m-top_x-small unsupportedContainer"},[s("table",{staticClass:"unsupportedRecordTable"},[s("tr",[s("th",[e._v(e._s(e.$Labels.MA_RECORD_NAME))]),e._v(" "),s("th",[e._v(e._s(e.$Labels.MA_OBJECT))])]),e._v(" "),e._l(e.store__unsupportedItems,(function(t,a){return s("tr",{key:a},[s("td",[e._v(e._s(e._f("decode")(t.title)))]),e._v(" "),s("td",[e._v(e._s(e._f("decode")(t.baseObjectLabel)))])])}))],2)])])]):e._e(),e._v(" "),e.toast?s("MAToast",{attrs:{msg:e.toast,state:e.level,closeLabel:e.$Labels.MA_Close,errorLabel:e.$Labels.MA_Error},on:{close:e.closeToast}}):e._e(),e._v(" "),e.doLoad?s("Calendar",{directives:[{name:"show",rawName:"v-show",value:!e.store__isTimelineDay,expression:"!store__isTimelineDay"}],key:"1",attrs:{base__storedIsLoading:e.isLoading,base__showFullScreenToggleControl:e.showFullScreenToggleControl},on:{"update:base__storedIsLoading":function(t){e.isLoading=t},"update:base__stored-is-loading":function(t){e.isLoading=t},toggleFullScreen:e.toggleFullScreen,error:e.showError,mounted:e.calendarMounted}}):e._e(),e._v(" "),e.store__isTimelineDay?s("ResourceCalendar",{key:"2",attrs:{base__storedIsLoading:e.isLoading,base__showFullScreenToggleControl:e.showFullScreenToggleControl},on:{"update:base__storedIsLoading":function(t){e.isLoading=t},"update:base__stored-is-loading":function(t){e.isLoading=t},toggleFullScreen:e.toggleFullScreen,error:e.showError}}):e._e()],1)])}),[],!1,null,"25ee5a9a",null));t.default=Mt.exports}}]);