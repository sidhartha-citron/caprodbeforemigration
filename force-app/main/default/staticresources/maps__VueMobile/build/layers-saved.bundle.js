(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[8088],{4173:(e,t,s)=>{e.exports=s.p+"images/db7d9ca69c5dbfe3c77d602857a98939.svg"},4427:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a='<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="52px" height="52px" viewBox="0 0 52 52" enable-background="new 0 0 52 52" xml:space="preserve"> <g> <path fill="#FFFFFF" d="M47.6,17.8L27.1,38.5c-0.6,0.6-1.6,0.6-2.2,0L4.4,17.8c-0.6-0.6-0.6-1.6,0-2.2l2.2-2.2\r\n\t\tc0.6-0.6,1.6-0.6,2.2,0l16.1,16.3c0.6,0.6,1.6,0.6,2.2,0l16.1-16.3c0.6-0.6,1.6-0.6,2.2,0l2.2,2.2C48.1,16.3,48.1,17.2,47.6,17.8z"/> </g> </svg> '},4922:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(5908),l=s(5511);const i={components:{MobileToggle:s(4549).Z},props:{layerData:{type:Object,required:!0}},data:()=>({}),computed:{...(0,a.mapGetters)("layers",{layers__getPlottedLayerById:"getPlottedLayerById"}),isPlotted:{get(){return this.layers__getPlottedLayerById(this.layerData.id).length>0},set(){this.toggleLayer()}},defaultAction(){return this.layerData.defaultAction},qid(){return this.layerData.qid},id(){return this.layerData.id},subType(){let e=this.layerData.baseObjectLabel;const t=this.layerData.type;return"datalayer"===t?e=this.$Labels.MA_Data_Layer:"favorite"===t&&(e=this.$Labels.MA_Favorite),"N/A"===e?"":e}},created(){this.processExtraPlotOptions()},methods:{...(0,a.mapMutations)("layers",{layer__updatesavedLoadingToggle:"updatesavedLoadingToggle"}),...(0,a.mapActions)("layers",{layers__getFolderData:"getFolderData"}),layerActionsClickHandler(){if(this.$bus.$emit("hide-search"),"open-folder"===this.defaultAction)this.layer__updatesavedLoadingToggle(!0),this.layers__getFolderData(this.layerData.id).catch((e=>{console.warn(e)})).finally((()=>{this.layer__updatesavedLoadingToggle(!1)}));else if(this.isPlotted){const e=`#ACTIVE_${this.id} .layer-nest-click-area`;document.querySelector(e).click()}else{const e=l.Z.getLayerActionFunction(this.layerData.type,this.defaultAction);if("javascript"===e.type)e.fn(this.layerData);else{const t=e.fn;this.$bus.$emit(t,this.layerData,(()=>{}))}}},processExtraPlotOptions(){if("marker"===this.layerData.type){this.defaultAction.indexOf("visible")>-1&&(this.layerData.visibleAreaOnly=!0);const e={clusters:"Cluster",markers:"Markers",scatter:"Scatter",heatmap:"Heatmap"},t=["clusters","markers","scatter","heatmap"].filter((e=>-1!==this.defaultAction.indexOf(e)));let s="Default";t.length>0&&(s=e[t[0]],this.layerData.renderAs=[s])}},toggleLayer(){if(this.isPlotted){const e=this.layers__getPlottedLayerById(this.layerData.id)||[];if(e.length>0){const t=e[0],{qid:s=""}=t;this.$bus.$emit("remove-layer",s)}else window.MAToastMessages.showWarning({message:"Unable to remove layer",subMessage:`Please remove the layer from the ${this.$Labels.MA_PLOT_ON_MAP} tab`,timeOut:1e4,closeButton:!0})}else this.layerActionsClickHandler();window.userSettings.recallMobileSaveState&&window.setMobileState()}}},r=(0,s(1900).Z)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"layerRow",staticClass:"MAFolderTemplate"},[a("div",e._b({staticClass:"layer-item slds-grid ma-folder-item qidLocation",attrs:{nodetype:e.layerData.nodetype,type:e.layerData.type}},"div",{"data-id":e.layerData.id,"perm-create":e.layerData.create,"perm-delete":e.layerData.delete,qid:e.layerData.qid,"perm-export":e.layerData.export,"perm-modify":e.layerData.modify,"perm-read":e.layerData.read,"perm-setpermissions":e.layerData.setpermissions},!1),["folder"!==e.layerData.type?a("div",{staticClass:"slds-p-around_medium slds-grid slds-grid_vertical-align-center"},[a("MobileToggle",{model:{value:e.isPlotted,callback:function(t){e.isPlotted=t},expression:"isPlotted"}})],1):e._e(),e._v(" "),a("div",{staticClass:"layer-nest-click-area layer-item_clickable-area slds-col slds-grid slds-p-left_medium",attrs:{action:e.defaultAction},on:{click:e.layerActionsClickHandler}},["arcgisonline"===e.layerData.type?a("div",{staticClass:"layer-item_icon slds-grid slds-grid_vertical-align-center slds-align-middle slds-p-right_medium"},[a("img",{staticClass:"arcGISQueryImage",attrs:{width:"24",height:"24",src:s(4173)}})]):a("div",{staticClass:"layer-item_icon slds-grid slds-grid_vertical-align-center slds-p-right_medium ma-icon ma-icon-",attrs:{type:e.layerData.type}}),e._v(" "),a("div",{staticClass:"layer-item_text slds-col slds-align-middle slds-p-vertical_small"},[a("div",{staticClass:"ma-item-name-title basicinfo-name slds-truncate"},[e._v(e._s(e._f("decode")(e.layerData.name)))]),e._v(" "),"folder"!==e.layerData.type?a("div",{staticClass:"layer-item_subtext ma-item-name-subtitle basicinfo-type slds-truncate"},[e._v("\n                    "+e._s(e._f("decode")(e.subType))+"\n                ")]):e._e()]),e._v(" "),e._m(0)])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"slds-p-around_medium slds-grid slds-grid_align-end slds-grid_vertical-align-center"},[t("span",{staticClass:"layer-item_chevron ma-icon ma-icon-chevronright"})])}],!1,null,"5e3c8f0e",null).exports},7487:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var a=s(675),l=s(5908);const i={computed:{...(0,l.mapGetters)("layers",{layers__breadCrumbs:"breadCrumbs"})},methods:{...(0,l.mapMutations)("layers",{layer__updatesavedLoadingToggle:"updatesavedLoadingToggle"}),...(0,l.mapActions)("layers",{layers__getFolderData:"getFolderData"}),getFolder(e){this.layer__updatesavedLoadingToggle(!0),this.layers__getFolderData(e).catch((e=>{console.warn(e),window.MAToastMessages.showError({message:"Folder Error",subMessage:"Unable to get folder contents",timeOut:6e3,closeButton:!0})})).finally((()=>{this.layer__updatesavedLoadingToggle(!1)}))},goBackOneFolder(){const e=this.layers__breadCrumbs.length-2,t=this.layers__breadCrumbs[e];t?this.getFolder(t.id):this.getFoler("Home")}}};var r=s(1900);const d=(0,r.Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"slide"}},[e.layers__breadCrumbs.length>1?s("div",{staticClass:"slds-grid slds-p-vertical_x-small slds-p-horizontal_small slds-border_bottom",attrs:{id:"layersBreadcrumb"}},[s("div",{staticClass:"slds-p-right_small"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:e.goBackOneFolder}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-back"})])]),e._v(" "),s("div",{staticClass:"breadcrumb_text-wrap"},[s("ol",{staticClass:"slds-breadcrumb slds-list_horizontal slds-wrap slds-grid_vertical-align-center",attrs:{id:"folder-breadcrumb"}},e._l(e.layers__breadCrumbs,(function(t,a){return s("li",{key:a,staticClass:"slds-breadcrumb__item",attrs:{"data-id":t.id}},[s("a",{on:{click:function(s){return e.getFolder(t.id)}}},[e._v(e._s(e._f("decode")(t.name)))])])})),0)])]):e._e()])}),[],!1,null,"3d9bf49f",null).exports;var n=s(5511),o=s(8969),c=s(3826);const u={name:"MobileExpandableFolder",components:{IconInline:o.Z},mixins:[c.Z],props:{sectionId:{type:String,required:!0},titleExpanded:{type:String,required:!0},titleTruncated:{type:String,required:!0},disabled:Boolean,disableTitleTruncation:Boolean,collapsedOnLoad:Boolean},data:()=>({isOpen:!0}),computed:{title(){return this.isOpen?this.titleExpanded:this.titleTruncated}},created(){this.collapsedOnLoad&&(this.isOpen=!1)},methods:{toggleSection(){this.isOpen=!this.isOpen,this.$bus.$emit("expandableSectionToggled",this.isOpen)}}},_=(0,r.Z)(u,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-section",class:{"slds-is-open":e.isOpen}},[a("h3",{staticClass:"slds-section__title",class:{"slds-theme_shade":e.disabled}},[e.disabled?e._t("title",(function(){return[a("span",{staticClass:"slds-p-horizontal_small",class:{"slds-truncate":!e.disableTitleTruncation},attrs:{title:e.title}},[e._v(e._s(e.decodeHtml(e.title)))])]})):a("button",{staticClass:"slds-button slds-section__title-action",attrs:{"aria-expanded":e.isOpen,"aria-controls":e.sectionId},on:{click:e.toggleSection}},[a("IconInline",{staticClass:"slds-icon_container",attrs:{svg:s(4427),iconClass:["slds-section__title-action-icon","slds-button__icon","slds-button__icon_left"]}}),e._v(" "),e._t("title",(function(){return[a("span",{class:{"slds-truncate":!e.disableTitleTruncation},attrs:{title:e.title}},[e._v(e._s(e.decodeHtml(e.title)))])]}))],2)],2),e._v(" "),a("div",{staticClass:"slds-section__content",attrs:{id:e.sectionId,"aria-hidden":!e.isOpen}},[e._t("content",(function(){return[a("p",[e._v("\n                Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Lorem ipsum dolor sit amet, consectetur adipiscing elit.\n                Nullam quis risus eget urna mollis ornare vel eu leo. Nulla vitae elit libero, a pharetra augue.\n            ")])]}))],2)])}),[],!1,null,null,null).exports;var m=s(4922);const{async:y}=window,h={components:{LayerRow:m.Z,MobileExpandableFolder:_},data:()=>({permissionView:"showHeirarchy",scrollBatches:[],batchSize:100,batchLoading:!1}),computed:{...(0,l.mapState)("layers",{layers__currentFolder:"currentFolder"}),...(0,l.mapGetters)("layers",{layers__savedLayers:"savedLayers",layers__breadCrumbs:"breadCrumbs",layers__layerIdArray:"layerIdArray",layers__allFolders:"allFolders"})},created(){this.getFolders()},methods:{...(0,l.mapMutations)("layers",{layer__updatesavedLoadingToggle:"updatesavedLoadingToggle",layer__updateSavedLayers:"udpateSavedLayers",layer__addFolder:"addFolder"}),...(0,l.mapActions)("layers",{layers__getFolderData:"getFolderData",layers__getAllLayers:"getAllLayers"}),async getFolders(){this.permissionView=window.getProperty(window,"userSettings.mobileFolderStructure",!1),"showHierarchy"===this.permissionView?await this.getHierarchyFolders():"flatFolder"===this.permissionView?await this.getFlatFolderDataRecurrsive("Home"):"flatAlphabetical"===this.permissionView&&await this.getFlatAlphabetical()},async getHierarchyFolders(){const e=window.getProperty(window,"userSettings.DefaultFolder",!1)||"Home";this.layer__updatesavedLoadingToggle(!0);try{await this.layers__getFolderData(e)}catch(t){console.warn(`Unable to get folder: ${e}`,t);try{await this.layers__getFolderData("Home")}catch(e){console.warn("Unable to get folder: Home",e),this.showHomeFolderError()}}finally{this.layer__updatesavedLoadingToggle(!1)}},async getFlatAlphabetical(){this.layer__updatesavedLoadingToggle(!0),await this.layers__getAllLayers([],"allByName");let e=[];for(let t=0;t<this.layers__layerIdArray.length;t++){const s=this.layers__layerIdArray[t];e.push(s),e.length===this.batchSize&&(this.scrollBatches.push(e),e=[])}e.length>0&&(this.scrollBatches.push(e),e=[]);const t=this.scrollBatches.shift();t&&await this.layers__getAllLayers(t,"allByName"),this.layer__updatesavedLoadingToggle(!1)},showHomeFolderError(){window.MAToastMessages.showError({message:"Unable to load home folder",subMessage:"Refreshing the page may fix this issue",timeOut:8e3,closeButton:!0})},async scroll(e){if(!this.batchLoading&&"flatAlphabetical"===this.permissionView){const{target:t}=e,{scrollHeight:s,scrollTop:a,clientHeight:l}=t,i=a>l/2;if(s-a<=l||i){const e=this.scrollBatches.shift();e&&(this.batchLoading=!0,await this.layers__getAllLayers(e,"allByName"),this.batchLoading=!1)}}},async getFlatFolderDataRecurrsive(e){const t=y.queue((async(e,s)=>{const a=e.id;try{const e=await n.Z.getAllFolders(a),{childFolders:l,childLayers:i,breadcrumbs:r}=e;if(l.length>0)for(let e=0;e<l.length;e++){const s=l[e],{properties:a={}}=s,{id:i}=a;i&&t.push({id:i},(()=>{}))}i.length>0&&this.layer__addFolder({name:a,breadcrumbs:r,childLayers:n.Z.buildLayerData(i)}),s()}catch(e){console.warn(`error getting folder: ${a}`,e),s()}}));t.concurrency=3,t.drain=()=>{this.batchLoading=!1},this.batchLoading=!0,t.push({id:e},(()=>{}))},truncateTitle(e){const t=e.split(" > ").slice(-2).join(" > ");return e.split(" > ").length>3?`...${t}`:e}}},g=(0,r.Z)(h,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ma-nested-wrap",attrs:{id:"layersFolders"}},[s("div",{staticClass:"ma-nested-wrap-inner"},["flatFolder"===e.permissionView?s("div",{staticClass:"ma-nested-item ma-nested-item--center ma-nested-item--root momentum-scrolling-y slds-scrollable folder-view"},[e._l(e.layers__allFolders,(function(t){return s("mobile-expandable-folder",{key:t.name,attrs:{sectionId:t.breadcrumbs,titleExpanded:t.breadcrumbs,titleTruncated:e.truncateTitle(t.breadcrumbs),disableTitleTruncation:!0,collapsedOnLoad:!0}},[s("div",{attrs:{slot:"content"},slot:"content"},e._l(t.childLayers,(function(e){return s("LayerRow",{key:e.qid,ref:"layer-"+e.qid,refInFor:!0,attrs:{layerData:e}})})),1)])})),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.batchLoading,expression:"batchLoading"}],staticClass:"slds-is-relative",staticStyle:{height:"60px"}},[e._m(0)])],2):s("div",{staticClass:"ma-nested-item ma-nested-item--center ma-nested-item--root momentum-scrolling-y slds-scrollable",on:{scroll:e.scroll}},[s("div",{staticClass:"ma-list momentum-scrolling-y slds-scrollable",class:{isHome:"Home"===e.layers__currentFolder},attrs:{id:"folder-contents"}},[e._l(e.layers__savedLayers,(function(e){return s("LayerRow",{key:e.qid,ref:"layer-"+e.qid,refInFor:!0,attrs:{layerData:e}})})),e._v(" "),e.batchLoading?s("div",{staticClass:"slds-is-relative",staticStyle:{height:"60px"}},[e._m(1)]):e._e()],2)]),e._v(" "),e._m(2)])])}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-spinner slds-spinner_brand slds-spinner_x-small slds-input__spinner",attrs:{role:"status"}},[s("span",{staticClass:"slds-assistive-text"},[e._v("Loading")]),e._v(" "),s("div",{staticClass:"slds-spinner__dot-a"}),e._v(" "),s("div",{staticClass:"slds-spinner__dot-b"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-spinner slds-spinner_brand slds-spinner_x-small slds-input__spinner",attrs:{role:"status"}},[s("span",{staticClass:"slds-assistive-text"},[e._v("Loading")]),e._v(" "),s("div",{staticClass:"slds-spinner__dot-a"}),e._v(" "),s("div",{staticClass:"slds-spinner__dot-b"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ma-nested-item ma-nested-item--right"},[t("div",{staticClass:"ma-list momentum-scrolling-y slds-scrollable"})])}],!1,null,null,null).exports,p={components:{MASpinner:a.Z,BreadCrumbs:d,SavedLayers:g},data:()=>({layersInFolder:[],breadcrumbs:[],isLoading:!1}),computed:{...(0,l.mapGetters)("layers",{layers__savedLoading:"savedLoading"})},methods:{...(0,l.mapMutations)("layers",{layers__udpateSavedLayers:"udpateSavedLayers",layer__updatesavedLoadingToggle:"updatesavedLoadingToggle",layers__updateBreadCrumbs:"updateBreadCrumbs"})}},v=(0,r.Z)(p,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"tabLayersSaved"}},[s("div",{staticClass:"ma-folder-content-wrap"},[s("MASpinner",{directives:[{name:"show",rawName:"v-show",value:e.layers__savedLoading,expression:"layers__savedLoading"}]}),e._v(" "),s("BreadCrumbs"),e._v(" "),s("SavedLayers")],1)])}),[],!1,null,null,null).exports}}]);