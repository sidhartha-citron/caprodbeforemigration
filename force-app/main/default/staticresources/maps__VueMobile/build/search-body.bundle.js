"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[7059],{6007:(e,s,t)=>{t.r(s),t.d(s,{default:()=>m});var a=t(5908);const{$:i,Plotting:r,MAToastMessages:l,google:o,MA:n}=window,c={props:{poiResults:{type:Array,default:()=>[]},markerResults:{type:Array,default:()=>[]},poiLoading:{type:Boolean,default:!1},markersLoading:{type:Boolean,default:!1},searchTerm:{type:String,default:""}},data:()=>({poiMarkerCount:0,showPoiSearchResults:!1,localPoiResults:[]}),computed:{...(0,a.mapGetters)("mainNavBar",{layers__activeTab:"activeTab"}),hasResults(){return this.poiResults.length>0||this.markerResults.length>0},showResults(){return this.searchTerm.length>2},poiMarkers:()=>window.MA.Map.Search.markers},watch:{poiResults(e){this.localPoiResults=e}},methods:{showPoiResult(e){const s=l.showLoading({message:`${this.$Labels.MA_Loading_With_Ellipsis}`,timeOut:0,extendedTimeOut:0});if(e.place_id){const t=e.place_id;this.getPoiInfo(t).then((()=>{l.hideMessage(s)}))}else{const t=e.structured_formatting.main_text;this.getPoiSuggestionInfo(t).then((()=>{l.hideMessage(s)}))}},removePOI(){try{n.Map.Search.markers.forEach((e=>{e.setMap(null)})),n.Map.Search.markers=[],this.poiMarkerCount=0}catch(e){}},showMarkerResult(e){const s=e.qid,t=e.Id,a=i(`#PlottedQueriesTable .savedQuery[qid="${s}"]`).data()||{},{records:o={}}=a,n=o[t];if(n){const{marker:e}=n;e?r.marker_Click.call(e,{markerType:"Marker"}):l.showError({message:"Oh Snap!",subMessage:"Unable to find this record."})}else l.showError({message:"Oh Snap!",subMessage:"Unable to find this record."})},getPoiInfo(e){return new Promise(((s,t)=>{const a=n.Map.Search.markers;this.poiMarkerCount=a.length;let i=!1;for(let s=0,t=a.length;s<t;s++){const t=a[s],{maData:l={}}=t,{place:o={}}=l;if(o.place_id===e){r.mobile.poiClick.call(t,{markerType:"POI"}),i=!0;break}}i?s():new o.maps.places.PlacesService(n.map).getDetails({placeId:e},((e,a)=>{if(a===o.maps.places.PlacesServiceStatus.OK){const t=new o.maps.Marker({map:n.map,position:e.geometry.location,title:e.name,maData:{place:e},icon:{url:e.icon,size:new o.maps.Size(71,71),origin:new o.maps.Point(0,0),anchor:new o.maps.Point(12,25),scaledSize:new o.maps.Size(25,25)},zIndex:-2});n.Map.Search.markers.push(t),this.poiMarkerCount=n.Map.Search.markers.length,o.maps.event.addListener(t,"click",(()=>{r.mobile.poiClick.call(t)})),r.mobile.poiClick.call(t,{markerType:"POI"}),s()}else t()}))}))},getPoiSuggestionInfo(e){return new Promise((s=>{window.placesSearch(e,{type:"place"}).then((e=>{i.each(n.Map.Search.markers,((e,s)=>{s.setMap(null)}));const t=[];i.each(e,((e,s)=>{if(s.geometry){const e=new o.maps.Marker({map:n.map,position:s.geometry.location,title:s.name,maData:{place:s},icon:{url:s.icon,size:new o.maps.Size(71,71),origin:new o.maps.Point(0,0),anchor:new o.maps.Point(12,25),scaledSize:new o.maps.Size(25,25)},zIndex:-2});t.push({place_id:s.place_id,structured_formatting:{main_text:s.name,secondary_text:s.formatted_address}}),o.maps.event.addListener(e,"click",(()=>{r.mobile.poiClick.call(e)})),n.Map.Search.markers.push(e)}})),this.poiMarkerCount=n.Map.Search.markers.length,this.$emit("set-results",{poi:t,markers:this.markerResults}),s()}))}))}}},m=(0,t(1900).Z)(c,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"ma-search-body main-panel",class:{in:"search"===e.layers__activeTab},attrs:{id:"searchBody"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showResults,expression:"!showResults"}],staticClass:"search-empty-state"},[e._m(0),e._v(" "),t("div",[t("p",{staticClass:"text-center"},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_SEARCH_FOR_MARKERS_FROM_ACTIVE_LAYERS_OR_GOOGLE_PLACES_AND))+"\n            ")])])]),e._v(" "),t("div",{staticClass:"search-result-wrap momentum-scrolling-y slds-scrollable",class:{in:e.showResults},attrs:{id:"searchResults"}},[e.showPoiSearchResults?e._e():t("ul",{staticClass:"markerResults"},[t("li",{staticClass:"ma-section-title"},[e._v(e._s(e._f("decode")(e.$Labels.MA_Records_ML)))]),e._v(" "),t("li",{directives:[{name:"show",rawName:"v-show",value:e.markersLoading,expression:"markersLoading"}],staticClass:"ma-section-title",staticStyle:{"padding-top":"5px"}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Loading_With_Ellipsis))+"\n            ")]),e._v(" "),t("li",{directives:[{name:"show",rawName:"v-show",value:!e.markersLoading&&0===e.markerResults.length,expression:"!markersLoading && markerResults.length === 0"}],staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item"},[e._m(1),e._v(" "),e._m(2)]),e._v(" "),e._l(e.markerResults,(function(s,a){return t("li",{directives:[{name:"show",rawName:"v-show",value:!e.markersLoading,expression:"!markersLoading"}],key:a,staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item",on:{click:function(t){return e.showMarkerResult(s)}}},[e._m(3,!0),e._v(" "),t("div",{staticClass:"search-result-content flex-grow-1"},[t("div",{staticClass:"search-result-text"},[e._v("\n                        "+e._s(e._f("decode")(s.tooltip1))+"\n                        "),t("div",{staticClass:"search-result-subtext"},[e._v("\n                            "+e._s(e._f("decode")(s.savedQueryName))+"\n                        ")])])])])}))],2),e._v(" "),t("ul",{staticClass:"poiResults"},[t("li",{staticClass:"ma-section-title",staticStyle:{position:"relative"}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Places_POI))+"\n                "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.poiMarkerCount>0,expression:"poiMarkerCount > 0"}],staticStyle:{position:"absolute",top:"2px",right:"10px"}},[t("button",{staticClass:"ma-button ma-button-sm ma-button--red icon-left",staticStyle:{padding:"0 .5rem","line-height":"1.75rem"},attrs:{id:"removePOI"},on:{click:e.removePOI}},[t("div",{staticClass:"ma-icon icon-left ma-icon-clear",staticStyle:{margin:".3rem .5rem 0 0"}}),e._v("\n                        Clear\n                    ")])])]),e._v(" "),t("li",{directives:[{name:"show",rawName:"v-show",value:e.poiLoading,expression:"poiLoading"}],staticClass:"ma-section-title",staticStyle:{"padding-top":"5px"}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Loading_With_Ellipsis))+"\n            ")]),e._v(" "),t("li",{directives:[{name:"show",rawName:"v-show",value:!e.poiLoading&&0===e.localPoiResults.length,expression:"!poiLoading && localPoiResults.length === 0"}],staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item"},[e._m(4),e._v(" "),e._m(5)]),e._v(" "),e._l(e.localPoiResults,(function(s,a){return t("li",{directives:[{name:"show",rawName:"v-show",value:!e.poiLoading,expression:"!poiLoading"}],key:a,staticClass:"search-result-item template flex-horizontal search-item-layers ui-menu-item",on:{click:function(t){return e.showPoiResult(s)}}},[t("div",{staticClass:"search-result-icon"},[s.place_id?t("div",{staticClass:"ma-icon-checkin"}):t("div",{staticClass:"ma-icon-search"})]),e._v(" "),t("div",{staticClass:"search-result-content flex-grow-1"},[t("div",{staticClass:"search-result-text"},[e._v("\n                        "+e._s(e._f("decode")(s.structured_formatting.main_text))+"\n                        "),s.structured_formatting.secondary_text?t("div",{staticClass:"search-result-subtext"},[e._v("\n                            "+e._s(e._f("decode")(s.structured_formatting.secondary_text))+"\n                        ")]):e._e()])])])}))],2)])])}),[function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"text-center"},[s("span",{staticClass:"ma-icon ma-icon-info ma-icon--large"})])},function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"search-result-icon"},[s("div",{staticClass:"ma-icon-warning"})])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"search-result-content flex-grow-1"},[t("div",{staticClass:"search-result-text"},[e._v("No Results Found")])])},function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"search-result-icon"},[s("div",{staticClass:"ma-icon-checkin"})])},function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"search-result-icon"},[s("div",{staticClass:"ma-icon-warning"})])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"search-result-content flex-grow-1"},[t("div",{staticClass:"search-result-text"},[e._v("No Results Found")])])}],!1,null,null,null).exports}}]);