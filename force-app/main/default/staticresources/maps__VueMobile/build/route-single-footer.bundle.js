"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[9588],{9013:(e,s,t)=>{t.r(s),t.d(s,{default:()=>b});var a=t(5908),l=t(4141),o=t(3294),i=t(675),r=t(379),n=t(2423),d=t(5261),c=t(7806);const{MA:u,MARemoting:_,google:h}=window,p={components:{MAModal:l.Z,MAInput:o.Z,MASpinner:i.Z,MobileSearch:c.Z},data:()=>({name:"",address:"",isLoading:!1,showSearch:!1,searchResult:null}),validations:{name:{required:r.C1}},methods:{...(0,a.mapMutations)("routes",{routes__addStop:"addStop"}),toggleSearch(e){this.showSearch=e},close(){this.isLoading||this.$emit("close")},updateSearchValue(e){this.address=e.label,this.searchResult=e.result},placeSearch:(e="",s={radius:8e3})=>new Promise(((t,a)=>{if(""===e)a(new Error("Missing search term."));else{const l=u.map.getBounds().getCenter(),o=l.lat(),i=l.lng();let r=s.radius||8e3;try{const e=u.map.getBounds();r=h.maps.geometry.spherical.computeDistanceBetween(l,e.getNorthEast()),r=r>5e4?5e4:r}catch(e){console.warn("Error getting map radius, defaulting to 5 miles. Results may be affected",e)}(new n.Z).setAction(_.placeSearch).setErrorHandler(((e,s)=>{console.warn(e),u.isUserLoggedIn(e,s,!0),a()})).invoke([e,o,i,r,"placeSearch"],(e=>{const{success:s=!1,data:l={}}=e;s?t(l.results):a()}),{escape:!1,buffer:!1})}})),validateStop(){this.isLoading||(this.searchResult&&!this.$v.$invalid?this.addStop():window.MAToastMessages.showError({message:this.$Labels.MA_Validation_Error,subMessage:this.$Labels.FavoriteLocation_Please_complete_all_information}))},addStop(){const e=this.searchResult,s={id:(0,d.x$)(),lat:e.geometry.location.lat,Latitude__c:e.geometry.location.lat,lng:e.geometry.location.lng,Longitude__c:e.geometry.location.lng,Name:this.name,Address__c:e.formatted_address,BaseObjectId__c:null,BaseObject__c:null,LinkId__c:"",MarkerLayer__c:"",Options__c:{TimeBasedOptions:{Start:"Set start time...",Duration:"0 hr, 30 min"},LockType:"unlocked",DraggablePoint:!1}};this.routes__addStop(s),this.$bus.$emit("remove-route"),this.$emit("close")}}};var m=t(1900);const v={components:{AddStopModal:(0,m.Z)(p,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("MAModal",{directives:[{name:"show",rawName:"v-show",value:!e.showSearch,expression:"!showSearch"}],staticClass:"slds-modal-fullscreen-phone",attrs:{id:"addStopModal",doDetach:!0,title:e._f("decode")(e.$Labels.MA_Add_Stop),closeLabel:e.$Labels.MA_Close},on:{close:e.close}},[t("div",{attrs:{slot:"content"},slot:"content"},[t("MASpinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),e._v(" "),t("div",{staticClass:"pad-8-16",attrs:{id:"changeowner-user-select"}},[t("MAInput",{attrs:{isRequired:!0,isInvalid:e.$v.name.$error,label:e._f("decode")(e.$Labels.MA_Name),requiredLabel:e.$Labels.MA_Required},on:{input:e.$v.name.$touch},model:{value:e.name,callback:function(s){e.name=s},expression:"name"}},[t("span",{attrs:{slot:"errors"},slot:"errors"},[e._v(e._s(e._f("decode")(e.$Labels.MA_A_NAME_IS_REQUIRED_TO_CONTINUE)))])]),e._v(" "),t("div",{staticClass:"slds-form-element"},[t("label",{staticClass:"slds-form-element__label"},[t("abbr",{staticClass:"slds-required",attrs:{title:"required"}},[e._v("*")]),e._v("\n                        "+e._s(e._f("decode")(e.$Labels.MA_Address))+"\n                    ")]),e._v(" "),t("div",{staticClass:"slds-form-element__control",staticStyle:{position:"relative"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.address,expression:"address"}],staticClass:"slds-input",attrs:{type:"text",placeholder:""},domProps:{value:e.address},on:{focus:function(s){return e.toggleSearch(!0)},input:function(s){s.target.composing||(e.address=s.target.value)}}})])])],1)],1),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"float-right"},[t("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.close}},[e._v("\n                    "+e._s(e._f("decode")(e.$Labels.MA_Cancel))+"\n                ")]),e._v(" "),t("button",{staticClass:"slds-button slds-button_brand",on:{click:e.validateStop}},[e._v("\n                    "+e._s(e._f("decode")(e.$Labels.MA_Done))+"\n                ")])])])]),e._v(" "),e.showSearch?t("MobileSearch",{attrs:{searchFunction:e.placeSearch,searchKey:"id",searchLabel:"formatted_address"},on:{"close-search-modal":function(s){return e.toggleSearch(!1)},result:e.updateSearchValue}}):e._e()],1)}),[],!1,null,null,null).exports},data:()=>({showAddStop:!1}),computed:{...(0,a.mapGetters)("routes",{routes__editMode:"editMode",routes__travelMode:"travelMode",routes__totalStops:"totalStops",routes__route:"route",routes__onMap:"onMap"}),getDirectionsText(){return this.routes__route.lockOrder?this.$Labels.MA_Get_Directions:this.$Labels.MA_Optimize}},created(){this.$bus.$on("refreshRoute",this.optimizeRoute)},destroyed(){this.$bus.$off("refreshRoute")},methods:{...(0,a.mapMutations)("routes",{routes__toggleEditMode:"toggleEditMode"}),...(0,a.mapActions)("routes",{routes__createRoute:"createRoute",routes__removeRoute:"removeRoute"}),removeRoute(){this.routes__removeRoute(),window.setMobileState()},showAddStopModal(){this.showAddStop=!0},closeAddStopModal(){this.showAddStop=!1},optimizeRoute(){this.$bus.$emit("remove-schedule-route"),this.routes__createRoute()},editRoute(){this.routes__toggleEditMode(!0)}}},b=(0,m.Z)(v,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"route-single-footer slds-is-relative slds-border_top slds-p-horizontal_medium slds-p-vertical_small"},[t("div",{staticClass:"slds-grid"},[t("div",{staticClass:"slds-p-right_x-small slds-col slds-size_1-of-2"},[t("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.showAddStopModal}},[e._v("\n                "+e._s(e.$Labels.MA_Add_Stop)+"\n            ")])]),e._v(" "),t("div",{staticClass:"slds-p-left_x-small slds-col slds-size_1-of-2"},[e.routes__onMap?t("button",{staticClass:"slds-button slds-button_brand slds-grid slds-grid slds-grid_vertical-align-center slds-grid_align-center",on:{click:e.removeRoute}},[t("div",[e._v("\n                    "+e._s(e.$Labels.MA_REMOVE_FROM_MAP)+"\n                ")])]):t("button",{staticClass:"slds-button slds-button_brand slds-grid slds-grid slds-grid_vertical-align-center slds-grid_align-center",on:{click:e.optimizeRoute}},[e._m(0),e._v(" "),t("div",[e._v("\n                    "+e._s(e.getDirectionsText)+"\n                ")])])])]),e._v(" "),e.showAddStop?t("AddStopModal",{on:{close:e.closeAddStopModal}}):e._e()],1)}),[function(){var e=this.$createElement,s=this._self._c||e;return s("div",[s("span",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-route"})])}],!1,null,"0de31de7",null).exports},7806:(e,s,t)=>{t.d(s,{Z:()=>i});var a=t(4141);const{getProperty:l}=window,o={components:{MAModal:a.Z},props:{searchFunction:{type:Function,required:!0},searchKey:{type:String,required:!0},searchLabel:{type:String,required:!0},minimumSearchLength:{type:Number,required:!1,default:2}},data:()=>({searchResults:[],styleObject:{position:"relative",padding:0,background:"#fff",border:"1px solid #dddbda","border-radius":".25rem","background-clip":"padding-box","box-shadow":"0 2px 2px 0 rgba(0,0,0,.1)"},searchTerm:"",isLoading:!1,searchTimeout:null}),computed:{showEmptyState(){const e=0===this.searchResults.length,s=this.searchTerm.length<=this.minimumSearchLength;return s||e||s}},watch:{searchTerm(e){e.length>this.minimumSearchLength&&this.debounceSearch(e)}},mounted(){this.$nextTick((()=>{this.$refs.mobileSearchInput.focus()}))},methods:{returnResult(e){this.$emit("result",e),this.close()},close(){this.$emit("close-search-modal")},clearInput(){this.returnResult({id:"",label:""})},debounceSearch(e){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((()=>{this.isLoading=!0,this.searchResults=[],this.searchFunction(e).then((e=>{this.processResults(e)})).catch((e=>{console.warn(e)})).finally((()=>{this.isLoading=!1}))}),250)},processResults(e){e.forEach((e=>{this.searchResults.push({label:l(e,this.searchLabel,!1),id:l(e,this.searchKey,!1),result:e})}))}}},i=(0,t(1900).Z)(o,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("MAModal",{staticClass:"slds-modal_large",attrs:{doDetach:!0,title:e.$Labels.MA_Search,closeLabel:e.$Labels.MA_Close},on:{close:e.close}},[t("div",{attrs:{slot:"content"},slot:"content"},[t("div",{staticClass:"ma-form-control has-inset-icon--right"},[t("div",{staticClass:"slds-form-element"},[t("div",{staticClass:"slds-form-element__control slds-input-has-icon slds-input-has-icon_right"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],staticClass:"slds-input__icon-group slds-input__icon-group_right"},[t("div",{staticClass:"slds-spinner slds-spinner_brand slds-spinner_x-small slds-input__spinner",staticStyle:{right:"5px"},attrs:{role:"status"}},[t("span",{staticClass:"slds-assistive-text"},[e._v("Loading")]),e._v(" "),t("div",{staticClass:"slds-spinner__dot-a"}),e._v(" "),t("div",{staticClass:"slds-spinner__dot-b"})])]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"slds-icon slds-input__icon slds-input__icon_left slds-icon-text-default ma-icon ma-icon-search"}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],ref:"mobileSearchInput",staticClass:"slds-input",attrs:{placeholder:e.$Labels.MA_Search+"...",type:"text"},domProps:{value:e.searchTerm},on:{input:function(s){s.target.composing||(e.searchTerm=s.target.value)}}})])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showEmptyState,expression:"showEmptyState"}],staticClass:"search-empty-state"},[t("div",{staticClass:"text-center"},[t("span",{staticClass:"ma-icon ma-icon-info ma-icon--large"})]),e._v(" "),t("div",[t("p",{staticClass:"text-center"},[e._v(e._s(e.$Labels.Mobile_Settings_Search_Help_Text))])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showEmptyState,expression:"!showEmptyState"}],staticClass:"slds-m-top_medium"},e._l(e.searchResults,(function(s,a){return t("article",{key:a,staticClass:"slds-card",style:e.styleObject,on:{click:function(t){return e.returnResult(s)}}},[t("div",{staticClass:"slds-card__header slds-grid"},[t("header",{staticClass:"slds-media slds-media_center slds-has-flexi-truncate"},[t("div",{staticClass:"slds-media__body"},[t("h2",{staticClass:"slds-card__header-title"},[t("div",{staticClass:"slds-card__header-link slds-truncate"},[t("span",[e._v(e._s(e._f("decode")(s.label)))])])])])])])])})),0)]),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"float-right"},[t("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.close}},[e._v("\n                "+e._s(e.$Labels.MA_Cancel)+"\n            ")]),e._v(" "),t("button",{staticClass:"slds-button slds-button_brand",on:{click:e.clearInput}},[e._v("\n                "+e._s(e.$Labels.MA_Clear)+"\n            ")])])])])}),[],!1,null,null,null).exports},3294:(e,s,t)=>{t.d(s,{Z:()=>l});const a={name:"MAInput",mixins:[t(3826).Z],props:{value:{type:[String,Number],required:!0},isRequired:{type:Boolean,default:!1},useTextArea:{type:Boolean,default:!1},disableResize:{type:Boolean,default:!1},label:{type:String,default:""},errors:{type:Array,default:()=>[]},placeholder:{type:String,default:""},type:{type:String,default:"text"},isInvalid:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},hasFocus:{type:Boolean,default:!1},requiredLabel:{type:String,default:"Required"}},computed:{showLabel(){return this.label},hasErrors(){return this.errors&&this.errors.length},listeners(){return{...this.$listeners,input:e=>this.$emit("input",e.target.value)}}},watch:{hasFocus(e){e&&this.focus()}},mounted(){this.hasFocus&&this.focus()},methods:{focus(){this.$refs.input.focus(),this.$refs.input.select()}}},l=(0,t(1900).Z)(a,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"slds-form-element",class:{"slds-has-error":e.isInvalid}},[e.showLabel?t("label",{staticClass:"slds-form-element__label"},[e.isRequired?t("abbr",{staticClass:"slds-required",attrs:{title:e.requiredLabel}},[e._v("*")]):e._e(),e._v("\n        "+e._s(e.decodeHtml(e.label))+"\n        "),e._t("label")],2):e._e(),e._v(" "),t("div",{staticClass:"slds-form-element__control",staticStyle:{position:"relative"}},[e.useTextArea?t("textarea",e._g({staticClass:"slds-textarea",attrs:{disabled:e.isDisabled,placeholder:e.placeholder},domProps:{value:e.decodeHtml(e.value)}},e.listeners)):t("input",e._g({ref:"input",staticClass:"slds-input",attrs:{type:e.type,disabled:e.isDisabled,placeholder:e.placeholder},domProps:{value:e.decodeHtml(e.value)},on:{blur:function(s){return e.$emit("update:hasFocus",!1)}}},e.listeners)),e._v(" "),e._t("extendInput")],2),e._v(" "),e.isInvalid?t("div",{staticClass:"slds-form-element__help"},[e._t("errors")],2):e._e()])}),[],!1,null,"71386de2",null).exports}}]);