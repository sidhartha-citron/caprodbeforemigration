"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[3593],{1201:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var o=s(5908),a=s(675),i=s(5493),r=s(1023),u=s(5261),n=s(3589),_=s(9159);const d={components:{RouteList:()=>({...(0,n.Z)(),component:s.e(3424).then(s.bind(s,9649)),error:_.Z}),RouteSingleView:()=>({...(0,n.Z)(),component:Promise.all([s.e(2432),s.e(716)]).then(s.bind(s,1428)),error:_.Z}),MASpinner:a.Z},props:{recallMobileSaveState:{type:Boolean,default:!1}},data:()=>({showRouteList:!0,routeIsNew:!0}),computed:{...(0,o.mapGetters)("mainNavBar",{layers__activeTab:"activeTab"}),...(0,o.mapGetters)("routes",{routes__isLoading:"isLoading",routes__route:"route",routes__isInitialized:"isInitialized",routes__showSingleRoute:"showSingleRoute",routes__record:"record",store__unsavedChanges:"unsavedChanges",store__pendingChanges:"pendingChanges"})},watch:{layers__activeTab(e){"routes"!==e||this.routes__isInitialized||this.initRoutes()},store__pendingChanges(){this.store__pendingChanges?(this.store__setUnsavedChanges(!0),this.store__resetSummary()):this.store__setUnsavedChanges(!1)}},created(){this.$bus.$on("init-routes",this.initRoutes),this.$bus.$on("add-to-route",this.addToRouteHandler),this.$bus.$on("add-to-new-route",this.addToNewRouteHandler),this.$bus.$on("remove-route",this.route__removeRoute),this.$bus.$on("get-plotted-route",this.getPlottedRoute),this.$bus.$on("plot-route",this.plotRoute),this.$bus.$on("zoom-to-fit-route",this.zoomToFitRoute)},methods:{...(0,o.mapMutations)("routes",{routes__loadingToggle:"loadingToggle",routes__updateRouteOptions:"updateRouteOptions",routes__updateInitialized:"updateInitialized",routes__setIsTimeBased:"setIsTimeBased",routes__updateRouteView:"updateRouteView",store__setUnsavedChanges:"setUnsavedChanges",store__resetSummary:"resetSummary"}),...(0,o.mapMutations)("mainNavBar",{mainNavBar__updateActiveTab:"updateActiveTab"}),...(0,o.mapActions)("routes",{routes__createNewRoute:"createNewRoute",routes__addWaypoints:"addWaypoints",route__removeRoute:"removeRoute"}),initRoutes(){return new Promise((e=>{this.routes__isInitialized?e():(this.routes__updateInitialized(),this.routes__loadingToggle(!0),this.routes__getRouteData().finally((()=>{this.routes__loadingToggle(!1),e()})))}))},zoomToFitRoute(e){if(this.routes__route.onMap){let t=!1;e.isEmpty()&&(t=!0),e.extend(this.routes__route.boundingbox.southwest),e.extend(this.routes__route.boundingbox.northeast),window.MA.map.fitBounds(e),t&&window.MA.map.setZoom(window.MA.map.getZoom()-1)}},addToRouteHandler(e){this.initRoutes().then((()=>{this.routes__showSingleRoute?this.addMarkersToRoute(e):this.routes__createNewRoute().then(this.addMarkersToRoute(e))}))},addToNewRouteHandler(e){this.store__unsavedChanges?("routes"!==this.mainNavBar__activeTab&&this.mainNavBar__updateActiveTab("routes"),window.MAToastMessages.showError({message:"Please save your current route first.",timeOut:0,closeButton:!0})):this.initRoutes().then(this.routes__createNewRoute()).then(this.addMarkersToRoute(e))},addMarkersToRoute(e){this.route__removeRoute(),this.routes__updateRouteView("singleView");const t=[];let s=!1;e.forEach((e=>{if(e.id=(0,u.x$)(),e.Name=e.title,e.Address__c=e.address||e.marker.address||e.marker.FormattedAddress_MA,e.Options__c=i.Z.defaultOptions,e.marker&&e.marker.StartDateTime&&e.marker.EndDateTime){s=!0,e.marker.DurationInMinutes=(e.marker.EndDateTime-e.marker.StartDateTime)/1e3/60;const t=r.Z.processEventData(e.marker);e={...e,...t}}t.push(e)})),s&&this.routes__setIsTimeBased(s),this.routes__addWaypoints(t)},...(0,o.mapActions)("routes",{routes__getRouteData:"getRouteData"}),getPlottedRoute(e){e({Id:this.routes__record.Id,onMap:this.routes__route.onMap})},plotRoute(e){this.initRoutes().then((()=>{this.$bus.$emit("display-route",e)}))}}},h=(0,s(1900).Z)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main-panel view-panel sidebar-panel slds-scope",class:{in:"routes"===e.layers__activeTab},attrs:{id:"routesWrap"}},["routes"===e.layers__activeTab&&e.routes__isInitialized||e.recallMobileSaveState?s("div",{staticStyle:{height:"100%"}},[s("MASpinner",{directives:[{name:"show",rawName:"v-show",value:e.routes__isLoading,expression:"routes__isLoading"}]}),e._v(" "),s("RouteList"),e._v(" "),e.routes__showSingleRoute?s("RouteSingleView"):e._e()],1):e._e()])}),[],!1,null,"78c2f582",null).exports}}]);