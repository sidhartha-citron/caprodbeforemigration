"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[2513],{5264:(e,t,s)=>{s.d(t,{Z:()=>a});const i=new Map;function n(e,t,s){const n=function(i){s.context._isDestroyed?document.removeEventListener("click",n):e.contains(i.target)||e===i.target||t(i)};i.set(e,n),setTimeout((()=>document.addEventListener("click",n)),0)}function o(e){const t=i.get(e);document.removeEventListener("click",t),i.delete(e)}const a={bind(e,{arg:{active:t,handler:s}},i){if("function"!=typeof s)throw new Error("v-click-outside: missing required handler argument.");!0===t&&n(e,s,i)},update(e,{arg:{active:t,handler:s}},a){t&&!i.has(e)?n(e,s,a):!t&&i.has(e)&&o(e)},unbind(e){o(e)}}},7335:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(5264);const{$:n}=window,o={name:"ActionSheet",directives:{"click-outside":i.Z},props:{options:{type:Array,required:!0},doDetach:{type:Boolean,default:!0},labelKey:{type:String,default:"label"},buttonText:{type:String,default:""},buttonIcon:{type:String,default:""},hideOverride:{type:Boolean,default:!1},selectedItems:{type:Array,default:()=>[]},buttonType:{type:String,default:""}},data:()=>({container:null,showOptions:!1,styleObject:{},window:{height:0,width:0},uid:"action-sheet"}),computed:{isPhone(){return this.window.width<769},computedIcon(){let e="";return""!==this.buttonIcon?e=this.buttonIcon:""===this.buttonText&&(e="ma-icon-threedots-vertical"),e},actionSheetClickOutsideOptions(){return{active:this.showOptions,handler:this.hideActionSheet}}},watch:{isPhone(){this.showOptions=!1}},created(){window.addEventListener("resize",this.handleResize),this.handleResize()},destroyed(){window.removeEventListener("resize",this.handleResize),this.hideActionSheet()},methods:{handleResize(){this.window.width=window.innerWidth,this.window.height=window.innerHeight},returnItem(e){e.isHeader||(this.$emit("select",e),this.hideActionSheet())},hideActionSheet(){this.showOptions=!1,this.container&&(this.container.remove(),this.container=null)},detach(){if(!this.$refs.button)return;const e=document.querySelector(`.slds-scope.${this.uid}`);try{e.remove()}catch(e){}const t=this.$refs.button.getBoundingClientRect();this.container=document.createElement("div"),this.container.className=`slds-scope ${this.uid}`,this.container.appendChild(this.$refs.actions),document.body.appendChild(this.container),this.styleObject={top:`${t.top+this.$refs.button.clientHeight+n(window).scrollTop()}px`,left:`${t.left+n(window).scrollLeft()}px`,"max-height":"300px"}},adjustForClipping(){const e=this.$refs.actions.getBoundingClientRect();let t;if(t=document.documentElement.clientHeight-window.innerHeight<=0?document.documentElement.clientHeight:window.innerHeight-this.getScrollbarWidth(),e.x<0)this.styleObject.left=`${this.$refs.actions.offsetLeft+Math.abs(e.x)}px`;else if(e.left+e.width>document.documentElement.clientWidth){const t=e.left+e.width-document.documentElement.clientWidth-n(window).scrollLeft();this.styleObject.left=e.left-t+"px"}const s=this.$refs.actions.scrollHeight,i=n(window).scrollTop();if(this.styleObject["max-height"]="300px",e.top+s>t){const n=e.top+s-i-t;this.$bus.$emit("ma-modal-scroll-by",n),this.styleObject.top=e.top-n+"px"}},disableClick(e){e.stopPropagation(),e.preventDefault()},openActionSheet(){this.showOptions=!0,this.doDetach&&this.detach(),this.$nextTick((()=>{this.doDetach&&this.adjustForClipping(),this.options.forEach(((e,t)=>{const s=e,i=this.$refs.optionItem[t];s.isHeader&&i.addEventListener("click",this.disableClick,!0)}))}))}}},a=(0,s(1900).Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"click-outside",rawName:"v-click-outside:[actionSheetClickOutsideOptions]",arg:e.actionSheetClickOutsideOptions}],staticClass:"action-sheet-wrapper slds-scope"},[s("div",{ref:"button",staticClass:"slds-grid slds-grid_vertical-align-center",on:{click:e.openActionSheet}},[s("div",{staticClass:"slds-button slds-col slds-truncate"},[e._v(e._s(e._f("decode")(e.buttonText)))]),e._v(" "),""!==e.computedIcon?s("div",[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",class:[e.buttonType]},[s("span",{staticClass:"slds-button__icon ma-icon",class:[e.computedIcon]})])]):e._e()]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showOptions,expression:"showOptions"}],ref:"actions",staticClass:"ma-action-sheet-wrap in slds-grid slds-grid_vertical slds-grid_align-end",style:e.isPhone?{}:e.styleObject},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isPhone,expression:"isPhone"}],staticClass:"action-sheet_mask",on:{click:e.hideActionSheet}}),e._v(" "),s("div",{staticClass:"action-sheet_wrap slds-grid slds-grid_vertical"},[s("div",{staticClass:"action-sheet_content slds-scrollable"},e._l(e.options,(function(t,i){return s("div",{key:i,ref:"optionItem",refInFor:!0,staticClass:"action-sheet_item slds-grid slds-p-around_medium",class:{"header slds-text-title_caps slds-section__title slds-theme--shade":t.isHeader,"slds-is-selected":e.selectedItems.includes(t.id)},on:{click:function(s){return e.returnItem(t)}}},[e._m(0,!0),e._v(" "),s("div",{staticClass:"slds-col"},[s("span",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e._f("decode")(t[e.labelKey])))])])])})),0),e._v(" "),s("div",{staticClass:"slds-button slds-button_neutral action-sheet_close-button",on:{click:e.hideActionSheet}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Close))+"\n            ")])])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"action-sheet_selected-icon slds-p-right_medium"},[t("span",{staticClass:"slds-icon slds-icon_x-small ma-icon ma-icon-check"})])}],!1,null,"44c08aa9",null).exports},7529:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var i=s(7335);const{MA:n,$:o,google:a,getProperty:l}=window,c={components:{ActionSheet:i.Z},props:{clickOptions:{type:Object,default:()=>{}},totalRecordCount:{type:String|Number,default:"0"}},data(){return{measurements:{area:0,perimeter:0},shapeInfoNotFound:!1,shapeInfoLoaded:!1,isShapeClick:!1,window:{height:0,width:0},customShapeActions:[{label:this.$Labels.MA_Save_As_Shape_Layer,value:"saveShape"}]}},computed:{isPhone(){return this.window.width<769},headerValue(){let e="Info";return this.isShapeClick?(e=window.getProperty(this.clickOptions,"shape.label",!1),void 0===e&&(e=window.getProperty(this.clickOptions,"feature.label",!1)||"Shape Info")):e="Cluster Info",e},isCustomShape(){return this.clickOptions.custom||!1}},created(){"shape"===this.clickOptions.type&&(this.isShapeClick=!0,this.$nextTick((()=>{const e=this.clickOptions.shape||this.clickOptions.feature||{};this.getShapeMeasurements(e)}))),window.addEventListener("resize",this.handleResize),this.handleResize()},destroyed(){window.removeEventListener("resize",this.handleResize)},methods:{hideCluster(){this.$emit("hide-cluster")},handleResize(){this.window.width=window.innerWidth,this.window.height=window.innerHeight},getShapeMeasurements(e){const t=e.qid,{shapeType:s=""}=e;if("travelTime"===s||"travelDistance"===s)return;const i=e instanceof a.maps.Circle?Number(e.getCenter()):null,c=e instanceof a.maps.Circle?Number(e.getRadius()):null,d=e instanceof a.maps.Rectangle?e.getBounds():null,r=e instanceof a.maps.Polygon?e.getPath():null,h=o(`#PlottedQueriesTable [qid="${t}"]`).data()||{},u=l(h,"id",!1);let p;if(u)p={territoryId:u};else if(i&&!Number.isNaN(c))p={type:"circle",radius:c,lat:i.lat(),lng:i.lng()};else if(d)p={type:"rectangle",NE:d.getNorthEast(),SW:d.getSouthWest()};else if(r){const e=[];r.getArray().forEach((t=>{e.push({lat:t.lat(),lng:t.lng()})})),p={type:"polygon",points:e}}p?n.getShapeGeometry(p).then((t=>{this.shapeInfoLoaded=!0;const{custom:s=!1}=t;let i="",o="";if(s){const e=l(t,"geometries.custom");i=e.area,o=e.perimeter}else{const s=l(e,"maData.id",!1);if("Merged Shape"===s){const e=t.total;i=e.area,o=e.perimeter}else{const e=l(t,"geometries",!1)[s];e?(i=e.area,o=e.perimeter):this.shapeInfoNotFound=!0}}this.measurements={area:n.Util.formatNumberString(i),perimeter:n.Util.formatNumberString(o)}})).fail((()=>{this.shapeInfoLoaded=!0,this.shapeInfoNotFound=!0})):(this.shapeInfoLoaded=!0,this.shapeInfoNotFound=!0)},handleSelectOption(e){"saveShape"===e.value&&window.launchSaveShapeUI(this.clickOptions)}}},d=(0,s(1900).Z)(c,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ma-top-bar tooltip-top-bar"},[s("div",{staticClass:"slds-grid",class:[e.isPhone?"phone-only":"tablet-only"],attrs:{id:"clusterTopBar"}},[s("div",{staticClass:"slds-p-left_x-small slds-p-vertical_small"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container hide-tooltip",on:{click:e.hideCluster}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-back"})])]),e._v(" "),s("div",{staticClass:"slds-p-around_medium"},[s("div",{staticClass:"slds-text-heading_medium slds-truncate"},[e._v(e._s(e._f("decode")(e.headerValue)))]),e._v(" "),s("div",{staticClass:"cluster_subtext"},[e._v(e._s(e._f("decode")(e.totalRecordCount))+" record(s)")]),e._v(" "),e.isShapeClick&&e.shapeInfoLoaded&&!e.shapeInfoNotFound?s("div",{staticClass:"cluster_subtext shape-geometry slds-m-top_small"},[s("div",[e._v("Area: "+e._s(e._f("decode")(e.measurements.area))+" m"),s("sup",[e._v("2")])]),e._v(" "),s("div",[e._v("Perimeter: "+e._s(e._f("decode")(e.measurements.perimeter))+" m")])]):e._e()]),e._v(" "),e.isCustomShape?s("div",{staticClass:"slds-p-right_x-small slds-p-vertical_small slds-col_bump-left"},[s("ActionSheet",{attrs:{doDetach:!0,options:e.customShapeActions},on:{select:e.handleSelectOption}})],1):e._e()])])}),[],!1,null,"50baf562",null).exports}}]);