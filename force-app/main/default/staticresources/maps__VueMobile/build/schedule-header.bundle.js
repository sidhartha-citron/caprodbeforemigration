"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[7797],{5264:(e,t,s)=>{s.d(t,{Z:()=>n});const a=new Map;function i(e,t,s){const i=function(a){s.context._isDestroyed?document.removeEventListener("click",i):e.contains(a.target)||e===a.target||t(a)};a.set(e,i),setTimeout((()=>document.addEventListener("click",i)),0)}function o(e){const t=a.get(e);document.removeEventListener("click",t),a.delete(e)}const n={bind(e,{arg:{active:t,handler:s}},a){if("function"!=typeof s)throw new Error("v-click-outside: missing required handler argument.");!0===t&&i(e,s,a)},update(e,{arg:{active:t,handler:s}},n){t&&!a.has(e)?i(e,s,n):!t&&a.has(e)&&o(e)},unbind(e){o(e)}}},8879:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var a=s(5908),i=s(3589),o=s(7335),n=s(9159);const{getProperty:l}=window,d={components:{DateSelectionModal:()=>({...(0,i.Z)(),component:s.e(9822).then(s.bind(s,314)),error:n.Z}),MultiConfigModal:()=>({...(0,i.Z)(),component:s.e(2143).then(s.bind(s,2019)),error:n.Z}),SaveChangesModal:()=>({...(0,i.Z)(),component:s.e(366).then(s.bind(s,5244)),error:n.Z}),ActionSheet:o.Z},data(){return{isSaveWarning:!1,saveWarnings:[],showActionSheet:!1,formattedDate:"",localDate:"",tempDate:"",dayOfWeek:"",dateString:"",showDateModal:!1,showMultiConfigModal:!1,showSaveChangesModal:!1,multipleConfigs:{},configToProcess:{},configArray:[],tempSaveData:{},unsavedActionToTake:null,dayMap:{0:this.$Labels.MA_Sunday,1:this.$Labels.MA_Monday,2:this.$Labels.MA_Tuesday,3:this.$Labels.MA_Wednesday,4:this.$Labels.MA_Thursday,5:this.$Labels.MA_Friday,6:this.$Labels.MA_Saturday}}},computed:{...(0,a.mapGetters)("schedule",{schedule__date:"date",schedule__onMap:"onMap",schedule__hasModifiedEvents:"hasModifiedEvents",schedule__queue:"queue",schedule__selectedShift:"selectedShift",schedule__shiftData:"shiftData"}),isGuideEnabled:()=>l(window.MASystem,"Organization.isMAGuideEnabled",!1)||!1,availableShifts(){const e=this.schedule__date.format("YYYY-MM-DD"),t=this.schedule__shiftData||{},{shiftMap:s={}}=t,a=s[e]||[],i=this.schedule__selectedShift.Id;return a.filter((e=>e.Id!==i))},onMap:{get(){return this.schedule__onMap},set(e){this.schedule__updateOnMap(e)}},scheduleOverflowOptions(){const e=[{label:this.$Labels.MA_SCHEDULE_REMOVE_ALL_SCHEDULED_EVENTS,value:"remove-all-events"},{label:this.$Labels.MA_SCHEDULE_RETURN_ALL_TO_BE_SCHEDULED,value:"return-all-events"}];return this.isGuideEnabled&&e.push({label:this.$Labels.MA_SCHEDULE_RETURN_ALL_UNLOCKED_TO_BE_SCHEDULED,value:"return-unlocked-events"}),this.availableShifts.length>0&&this.availableShifts.forEach((t=>{const s=this.schedule__date.format("M/D/YYYY"),a=`${s} ${t.maps__StartHour__c}:${t.maps__StartMinute__c}`,i=window.moment.tz(a,"M/D/YYYY H:m",window.MASystem.User.timezoneId),o=`${s} ${t.maps__EndHour__c}:${t.maps__EndMinute__c}`,n=window.moment.tz(o,"M/D/YYYY H:m",window.MASystem.User.timezoneId),l=`View Shift: ${i.format("h:mm a")} to ${n.format("h:mm a")}`;e.push({label:l,value:"change-shift",shiftId:t.Id})})),e},showLaborLawsBanner:()=>window.getProperty(window.MASystem,"Organization.LaborLawsNotify",!1)||!1},watch:{formattedDate(){this.updateDateString(),this.schedule__updateDate(this.localDate),this.getScheduleData({saveEventsState:!1})}},created(){this.localDate=this.schedule__date,this.updateDateString()},methods:{...(0,a.mapActions)("schedule",{schedule__removeRoute:"removeRoute",schedule__saveSchedule:"saveSchedule",schedule__checkScheduleQueue:"checkScheduleQueue",schedule__buildRoute:"buildRoute",schedule__returnAllEventsToQueue:"returnAllEventsToQueue",schedule__removeAllEvents:"removeAllEvents"}),...(0,a.mapMutations)("schedule",{schedule__updateDate:"updateDate",schedule__updateHasModifiedEvents:"updateHasModifiedEvents",schedule__updatedEventsSet:"updatedEventsSet",schedule__loadingToggle:"loadingToggle",schedule__updateOnMap:"updateOnMap",schedule__removeAllQueueItems:"removeAllQueueItems",schedule__setStateMobile:"updateMobileStateSchedule"}),...(0,a.mapMutations)("mainNavBar",{mainNavBar__updateActiveTab:"updateActiveTab",mainNavBar__toggleSubView:"toggleSubView"}),showSettings(){this.mainNavBar__toggleSubView({doShow:!0,subView:"settings"})},toggleDateModal(e){this.showDateModal=e},toggleMultiConfigModal(e){this.showMultiConfigModal=e},toggleSaveChangesModal(e){this.showSaveChangesModal=e},handleSelectOption(e){switch(e.value){case"remove-all-events":this.schedule__removeAllEvents();break;case"return-all-events":this.schedule__returnAllEventsToQueue();break;case"return-unlocked-events":this.schedule__returnAllEventsToQueue(!1);break;case"remove-all-unscheduled":this.schedule__removeAllQueueItems();break;case"change-shift":this.updateScheduleToNewShift(e.shiftId)}},discardClose(){this.setUnplotMobileState(),this.schedule__updatedEventsSet(new Set),this.schedule__updateHasModifiedEvents(!1),this.localDate=this.tempDate.clone(),this.tempDate=null,this.formattedDate=this.localDate.format("MM/DD/YYYY")},updateScheduleToNewShift(e){this.getScheduleData({saveEventsState:!1,shiftId:e})},saveClose(){this.setUnplotMobileState(),this.schedule__updatedEventsSet(new Set),this.schedule__updateHasModifiedEvents(!1),this.schedule__checkScheduleQueue().then((()=>{this.schedule__saveSchedule().then((e=>{window.trackUsage("Maps",{action:"Save Schedule",description:"Clicking Save on Schedule"}),e.multipleConfigs?(this.multipleConfigs=e.configs,this.configArray=Object.keys(this.multipleConfigs),this.tempSaveData=e.saveData,this.processNextConfig()):e.saveWarnings?(this.saveWarnings=e.saveWarnings,this.tempSaveData=e.saveData,this.multipleConfigs={},this.configArray=[],this.showSaveWarnings()):(this.localDate=this.tempDate.clone(),this.tempDate=null,this.formattedDate=this.localDate.format("MM/DD/YYYY"))})).catch((e=>{console.warn(e)}))}))},updateDateString(){const e=this.getMonths(),t=this.localDate,s=Number(t.format("M")),a=e.filter((e=>e.value===s))[0],i=t.format("DD, YYYY"),o=t.get("day");this.dayOfWeek=this.dayMap[o],this.dateString=`${a.abrv} ${i}`},setUnplotMobileState(){this.schedule__setStateMobile({dateString:this.localDate.format("YYYY-MM-DD"),schedulePlotted:!1}),window.setMobileState()},getNextDay(){this.schedule__hasModifiedEvents?(this.toggleSaveChangesModal(!0),this.tempDate=this.localDate.clone(),this.tempDate.add(1,"days")):(this.schedule__removeRoute(),this.localDate.add(1,"days"),this.formattedDate=this.localDate.format("MM/DD/YYYY"),this.setUnplotMobileState())},getPreviousDay(){this.schedule__hasModifiedEvents?(this.toggleSaveChangesModal(!0),this.tempDate=this.localDate.clone(),this.tempDate.subtract(1,"days")):(this.schedule__removeRoute(),this.localDate.subtract(1,"days"),this.formattedDate=this.localDate.format("MM/DD/YYYY"),this.setUnplotMobileState())},setDate(e){this.schedule__hasModifiedEvents?(this.tempDate=this.localDate.clone(),this.tempDate.set({date:e.get("date"),month:e.get("month"),year:e.get("year")}),this.$nextTick((()=>{this.toggleSaveChangesModal(!0)}))):(this.localDate.set({date:e.get("date"),month:e.get("month"),year:e.get("year")}),this.formattedDate=this.localDate.format("MM/DD/YYYY"))},getMonths(){return[{value:1,name:"January",label:this.$Labels.MA_January,abrv:"Jan."},{value:2,name:"February",label:this.$Labels.MA_February,abrv:"Feb."},{value:3,name:"March",label:this.$Labels.MA_March,abrv:"Mar."},{value:4,name:"April",label:this.$Labels.MA_April,abrv:"Apr."},{value:5,name:"May",label:this.$Labels.MA_May,abrv:"May"},{value:6,name:"June",label:this.$Labels.MA_June,abrv:"June"},{value:7,name:"July",label:this.$Labels.MA_July,abrv:"July"},{value:8,name:"August",label:this.$Labels.MA_August,abrv:"Aug."},{value:9,name:"September",label:this.$Labels.MA_September,abrv:"Sept."},{value:10,name:"October",label:this.$Labels.MA_October,abrv:"Oct."},{value:11,name:"November",label:this.$Labels.MA_November,abrv:"Nov."},{value:12,name:"December",label:this.$Labels.MA_December,abrv:"Dec."}]},getYears(){const e=[],t=Number(window.moment().format("YYYY"));if("number"==typeof t)for(let s=t-5;s<=t+2;s++)e.push(s);return e},getScheduleData({saveEventsState:e=!1,shiftId:t}){this.$emit("getScheduleData",{saveEventsState:e,shiftId:t})},toggleRoute(){this.onMap?this.generateRoute(!1):this.schedule__removeRoute()},generateRoute(e=!1){this.schedule__loadingToggle(!0),this.$bus.$emit("remove-route"),this.schedule__buildRoute({doOptimize:e}).then((()=>{window.MAToastMessages.showSuccess({message:this.$Labels.MA_Success}),this.onMap=!0})).catch((()=>{this.onMap=!1})).finally((()=>{this.schedule__loadingToggle(!1)}))},saveSchedule(){this.schedule__checkScheduleQueue().then((()=>{this.schedule__saveSchedule().then((e=>{window.trackUsage("Maps",{action:"Save Schedule",description:"Clicking Save on Schedule"}),e.multipleConfigs?(this.multipleConfigs=e.configs,this.configArray=Object.keys(this.multipleConfigs),this.tempSaveData=e.saveData,this.processNextConfig()):e.saveWarnings?(this.saveWarnings=e.saveWarnings,this.tempSaveData=e.saveData,this.multipleConfigs={},this.configArray=[],this.showSaveWarnings()):(window.MAToastMessages.showSuccess({message:"Scheduled Saved"}),this.getScheduleData({saveEventsState:!0}))})).catch((e=>{let t=String(e);t.indexOf("null object")>-1&&(t="An event in your schedule may not be supported, more information in debug console."),window.MAToastMessages.showError({message:"Unable to Save",subMessage:t,closeButton:!0,timeOut:1e4}),console.warn("Schedule save error: ",e)}))}))},saveIgnore(){this.processNextConfig(!0)},setConfigForEvents(e){this.attachConfigIdToSaveData(e),this.processNextConfig()},attachConfigIdToSaveData(e){const{eventIds:t=[],config:s={}}=e,a=this.tempSaveData,i=a.events;t.forEach((e=>{const t=i.filter((t=>e===t.uid));t.length>0&&(t[0].configId=s.id)})),this.tempSaveData=a},processNextConfig(e=!1){this.tempSaveData.ignoreSaveChecks=e,0===this.configArray.length?this.schedule__saveSchedule(this.tempSaveData).then((e=>{window.trackUsage("Maps",{action:"Save Schedule",description:"Clicking Save on Schedule"}),e.saveWarnings?(this.saveWarnings=e.saveWarnings,this.tempSaveData=e.saveData,this.multipleConfigs={},this.configArray=[],this.showSaveWarnings()):(window.MAToastMessages.showSuccess({message:"Scheduled Saved"}),this.getScheduleData({saveEventsState:!0}))})).catch((e=>{console.warn(e)})):(this.configToProcess=this.multipleConfigs[this.configArray.splice(0,1)],this.showMultiConfigModal=!0,this.isSaveWarning=!1)},showSaveWarnings(){this.showMultiConfigModal=!0,this.isSaveWarning=!0}}},c=(0,s(1900).Z)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.showLaborLawsBanner?s("div",{staticClass:"labor-law-notification slds-notify_container slds-notify_container--inline"},[s("div",{staticClass:"slds-notify slds-notify--alert slds-theme--warning slds-theme--alert-texture slds-banner"},[s("h2",[e._v(e._s(e._f("decode")(e.$Labels.MA_Labor_Laws)))])])]):e._e(),e._v(" "),s("div",{staticClass:"schedule-header"},[s("div",{staticClass:"slds-grid slds-wrap"},[s("div",{staticClass:"slds-p-around_medium slds-col slds-size_6-of-12"},[s("div",{staticClass:"slds-text-heading_medium slds-p-top_xxx-small"},[e._v(e._s(e._f("decode")(e.$Labels.MA_SCHEDULE)))])]),e._v(" "),s("div",{staticClass:"slds-col_bump-left slds-p-vertical_medium slds-col slds-size_6-of-12"},[s("ActionSheet",{attrs:{doDetach:!0,options:e.scheduleOverflowOptions},on:{select:e.handleSelectOption}})],1),e._v(" "),s("div",{staticClass:"slds-p-horizontal_medium slds-p-bottom_medium slds-col slds-size_12-of-12"},[s("button",{staticClass:"slds-button slds-button_stretch slds-button_success",attrs:{disabled:!e.schedule__hasModifiedEvents},on:{click:e.saveSchedule}},[e._v("\n                    "+e._s(e._f("decode")(e.$Labels.MA_Save))+"\n                ")])])]),e._v(" "),s("div",{staticClass:"slds-grid slds-p-bottom_x-small",attrs:{id:"scheduleDatePicker"}},[s("div",{staticClass:"slds-p-left_medium"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:e.getPreviousDay}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-chevronleft"})])]),e._v(" "),s("div",{staticClass:"slds-col slds-grid slds-grid_align-center"},[s("button",{staticClass:"slds-button slds-p-horizontal_small",on:{click:function(t){return e.toggleDateModal(!0)}}},[s("span",{staticClass:"slds-text-color_weak"},[e._v(e._s(e._f("decode")(e.dayOfWeek))+", "+e._s(e._f("decode")(e.dateString)))])])]),e._v(" "),s("div",{staticClass:"slds-p-right_medium"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:e.getNextDay}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-chevronright"})])])]),e._v(" "),e.showDateModal?s("DateSelectionModal",{attrs:{date:e.schedule__date},on:{close:function(t){return e.toggleDateModal(!1)},update:e.setDate}}):e._e(),e._v(" "),e.showMultiConfigModal?s("MultiConfigModal",{attrs:{config:e.configToProcess,isSaveWarning:e.isSaveWarning,saveWarnings:e.saveWarnings},on:{close:function(t){return e.toggleMultiConfigModal(!1)},"set-config":e.setConfigForEvents,ignore:e.saveIgnore}}):e._e(),e._v(" "),e.showSaveChangesModal?s("SaveChangesModal",{attrs:{title:e.$Labels.MA_SCHEDULE_SAVE_SCHEDULE_CHANGES_PROMPT},on:{close:function(t){return e.toggleSaveChangesModal(!1)},"discard-close":e.discardClose,"save-close":e.saveClose}}):e._e()],1)])}),[],!1,null,"3899c320",null).exports},7335:(e,t,s)=>{s.d(t,{Z:()=>n});var a=s(5264);const{$:i}=window,o={name:"ActionSheet",directives:{"click-outside":a.Z},props:{options:{type:Array,required:!0},doDetach:{type:Boolean,default:!0},labelKey:{type:String,default:"label"},buttonText:{type:String,default:""},buttonIcon:{type:String,default:""},hideOverride:{type:Boolean,default:!1},selectedItems:{type:Array,default:()=>[]},buttonType:{type:String,default:""}},data:()=>({container:null,showOptions:!1,styleObject:{},window:{height:0,width:0},uid:"action-sheet"}),computed:{isPhone(){return this.window.width<769},computedIcon(){let e="";return""!==this.buttonIcon?e=this.buttonIcon:""===this.buttonText&&(e="ma-icon-threedots-vertical"),e},actionSheetClickOutsideOptions(){return{active:this.showOptions,handler:this.hideActionSheet}}},watch:{isPhone(){this.showOptions=!1}},created(){window.addEventListener("resize",this.handleResize),this.handleResize()},destroyed(){window.removeEventListener("resize",this.handleResize),this.hideActionSheet()},methods:{handleResize(){this.window.width=window.innerWidth,this.window.height=window.innerHeight},returnItem(e){e.isHeader||(this.$emit("select",e),this.hideActionSheet())},hideActionSheet(){this.showOptions=!1,this.container&&(this.container.remove(),this.container=null)},detach(){if(!this.$refs.button)return;const e=document.querySelector(`.slds-scope.${this.uid}`);try{e.remove()}catch(e){}const t=this.$refs.button.getBoundingClientRect();this.container=document.createElement("div"),this.container.className=`slds-scope ${this.uid}`,this.container.appendChild(this.$refs.actions),document.body.appendChild(this.container),this.styleObject={top:`${t.top+this.$refs.button.clientHeight+i(window).scrollTop()}px`,left:`${t.left+i(window).scrollLeft()}px`,"max-height":"300px"}},adjustForClipping(){const e=this.$refs.actions.getBoundingClientRect();let t;if(t=document.documentElement.clientHeight-window.innerHeight<=0?document.documentElement.clientHeight:window.innerHeight-this.getScrollbarWidth(),e.x<0)this.styleObject.left=`${this.$refs.actions.offsetLeft+Math.abs(e.x)}px`;else if(e.left+e.width>document.documentElement.clientWidth){const t=e.left+e.width-document.documentElement.clientWidth-i(window).scrollLeft();this.styleObject.left=e.left-t+"px"}const s=this.$refs.actions.scrollHeight,a=i(window).scrollTop();if(this.styleObject["max-height"]="300px",e.top+s>t){const i=e.top+s-a-t;this.$bus.$emit("ma-modal-scroll-by",i),this.styleObject.top=e.top-i+"px"}},disableClick(e){e.stopPropagation(),e.preventDefault()},openActionSheet(){this.showOptions=!0,this.doDetach&&this.detach(),this.$nextTick((()=>{this.doDetach&&this.adjustForClipping(),this.options.forEach(((e,t)=>{const s=e,a=this.$refs.optionItem[t];s.isHeader&&a.addEventListener("click",this.disableClick,!0)}))}))}}},n=(0,s(1900).Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"click-outside",rawName:"v-click-outside:[actionSheetClickOutsideOptions]",arg:e.actionSheetClickOutsideOptions}],staticClass:"action-sheet-wrapper slds-scope"},[s("div",{ref:"button",staticClass:"slds-grid slds-grid_vertical-align-center",on:{click:e.openActionSheet}},[s("div",{staticClass:"slds-button slds-col slds-truncate"},[e._v(e._s(e._f("decode")(e.buttonText)))]),e._v(" "),""!==e.computedIcon?s("div",[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",class:[e.buttonType]},[s("span",{staticClass:"slds-button__icon ma-icon",class:[e.computedIcon]})])]):e._e()]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showOptions,expression:"showOptions"}],ref:"actions",staticClass:"ma-action-sheet-wrap in slds-grid slds-grid_vertical slds-grid_align-end",style:e.isPhone?{}:e.styleObject},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isPhone,expression:"isPhone"}],staticClass:"action-sheet_mask",on:{click:e.hideActionSheet}}),e._v(" "),s("div",{staticClass:"action-sheet_wrap slds-grid slds-grid_vertical"},[s("div",{staticClass:"action-sheet_content slds-scrollable"},e._l(e.options,(function(t,a){return s("div",{key:a,ref:"optionItem",refInFor:!0,staticClass:"action-sheet_item slds-grid slds-p-around_medium",class:{"header slds-text-title_caps slds-section__title slds-theme--shade":t.isHeader,"slds-is-selected":e.selectedItems.includes(t.id)},on:{click:function(s){return e.returnItem(t)}}},[e._m(0,!0),e._v(" "),s("div",{staticClass:"slds-col"},[s("span",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e._f("decode")(t[e.labelKey])))])])])})),0),e._v(" "),s("div",{staticClass:"slds-button slds-button_neutral action-sheet_close-button",on:{click:e.hideActionSheet}},[e._v("\n                "+e._s(e._f("decode")(e.$Labels.MA_Close))+"\n            ")])])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"action-sheet_selected-icon slds-p-right_medium"},[t("span",{staticClass:"slds-icon slds-icon_x-small ma-icon ma-icon-check"})])}],!1,null,"44c08aa9",null).exports}}]);