(function(){angular.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(b,a,c){return{require:"?ngModel",scope:{ngModel:"=",uiSortable:"="},link:function(r,i,q,h){var f;function p(t,s){if(s&&(typeof s==="function")){return function(){t.apply(this,arguments);s.apply(this,arguments)}}return t}function j(s){var t=s.data("ui-sortable");if(t&&typeof t==="object"&&t.widgetFullName==="ui-sortable"){return t}return null}function k(s,u){var t=s.sortable("option","helper");return t==="clone"||(typeof t==="function"&&u.item.sortable.isCustomHelperUsed())}function g(s){return(/left|right/).test(s.css("float"))||(/inline|table-cell/).test(s.css("display"))}function e(u,w){var t=null;for(var v=0;v<u.length;v++){var s=u[v];if(s.element[0]===w[0]){t=s.scope;break}}return t}function o(t,s){s.item.sortable._destroy()}var d={};var l={"ui-floating":undefined};var m={receive:null,remove:null,start:null,stop:null,update:null};var n={helper:null};angular.extend(d,l,b,r.uiSortable);if(!angular.element.fn||!angular.element.fn.jquery){c.error("ui.sortable: jQuery should be included before AngularJS!");return}if(h){r.$watch("ngModel.length",function(){a(function(){if(!!j(i)){i.sortable("refresh")}},0,false)});m.start=function(u,s){if(d["ui-floating"]==="auto"){var v=s.item.siblings();var t=j(angular.element(u.target));t.floating=g(v)}s.item.sortable={model:h.$modelValue[s.item.index()],index:s.item.index(),source:s.item.parent(),sourceModel:h.$modelValue,cancel:function(){s.item.sortable._isCanceled=true},isCanceled:function(){return s.item.sortable._isCanceled},isCustomHelperUsed:function(){return !!s.item.sortable._isCustomHelperUsed},_isCanceled:false,_isCustomHelperUsed:s.item.sortable._isCustomHelperUsed,_destroy:function(){angular.forEach(s.item.sortable,function(x,w){s.item.sortable[w]=undefined})}}};m.activate=function(v,u){f=i.contents();var w=i.sortable("option","placeholder");if(w&&w.element&&typeof w.element==="function"){var t=w.element();t=angular.element(t);var x=i.find('[class="'+t.attr("class")+'"]:not([ng-repeat], [data-ng-repeat])');f=f.not(x)}var s=u.item.sortable._connectedSortables||[];s.push({element:i,scope:r});u.item.sortable._connectedSortables=s};m.update=function(v,u){if(!u.item.sortable.received){u.item.sortable.dropindex=u.item.index();var s=u.item.parent();u.item.sortable.droptarget=s;var t=e(u.item.sortable._connectedSortables,s);u.item.sortable.droptargetModel=t.ngModel;i.sortable("cancel")}if(k(i,u)&&!u.item.sortable.received&&i.sortable("option","appendTo")==="parent"){f=f.not(f.last())}f.appendTo(i);if(u.item.sortable.received){f=null}if(u.item.sortable.received&&!u.item.sortable.isCanceled()){r.$apply(function(){h.$modelValue.splice(u.item.sortable.dropindex,0,u.item.sortable.moved)})}};m.stop=function(t,s){if(!s.item.sortable.received&&("dropindex" in s.item.sortable)&&!s.item.sortable.isCanceled()){r.$apply(function(){h.$modelValue.splice(s.item.sortable.dropindex,0,h.$modelValue.splice(s.item.sortable.index,1)[0])})}else{if((!("dropindex" in s.item.sortable)||s.item.sortable.isCanceled())&&!k(i,s)){f.appendTo(i)}}f=null};m.receive=function(t,s){s.item.sortable.received=true};m.remove=function(t,s){if(!("dropindex" in s.item.sortable)){i.sortable("cancel");s.item.sortable.cancel()}if(!s.item.sortable.isCanceled()){r.$apply(function(){s.item.sortable.moved=h.$modelValue.splice(s.item.sortable.index,1)[0]})}};n.helper=function(s){if(s&&typeof s==="function"){return function(v,t){var u=s.apply(this,arguments);t.sortable._isCustomHelperUsed=t!==u;return u}}return s};r.$watch("uiSortable",function(s){var t=j(i);if(!!t){angular.forEach(s,function(v,u){if(u in l){if(u==="ui-floating"&&(v===false||v===true)){t.floating=v}d[u]=v;return}if(m[u]){if(u==="stop"){v=p(v,function(){r.$apply()});v=p(v,o)}v=p(m[u],v)}else{if(n[u]){v=n[u](v)}}d[u]=v;i.sortable("option",u,v)})}},true);angular.forEach(m,function(t,s){d[s]=p(t,d[s]);if(s==="stop"){d[s]=p(d[s],o)}})}else{c.info("ui.sortable: ngModel not provided!",i)}i.sortable(d)}}}])})();