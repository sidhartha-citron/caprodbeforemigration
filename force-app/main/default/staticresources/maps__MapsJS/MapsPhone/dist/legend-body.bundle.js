(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[9768],{758:(e,t,o)=>{e.exports=o.p+"images/d61e60332b10a8fa7cd62815ef896afd.svg"},8751:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>g});var s=o(5908);const{$:l}=window,i={props:{legendInfo:{type:Object,required:!0},showAllRows:{type:Boolean,default:!1}},computed:{isVisible(){let e=!1;return(!0===this.showAllRows||this.legendInfo.totalmarkers>0)&&(e=!0),e}},methods:{toggleRow(e){this.$emit("toggle-row",e)},getIconColor(e){const t=l.parseHTML(e);return l(t).css("color")}}};var n=o(1900);const a=(0,n.Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.isVisible,expression:"isVisible"}],staticClass:"legend-item legend-row ma-form-control-wrap ma-checkbox-wrap flex-horizontal",staticStyle:{display:"flex"},attrs:{"data-id":e.legendInfo.legendId}},[s("div",{staticClass:"flex-grow-1"},[s("label",{staticClass:"ma-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.legendInfo.active,expression:"legendInfo.active"}],staticClass:"legend-checkbox",attrs:{name:"checkbox",type:"checkbox"},domProps:{checked:Array.isArray(e.legendInfo.active)?e._i(e.legendInfo.active,null)>-1:e.legendInfo.active},on:{change:[function(t){var o=e.legendInfo.active,s=t.target,l=!!s.checked;if(Array.isArray(o)){var i=e._i(o,null);s.checked?i<0&&e.$set(e.legendInfo,"active",o.concat([null])):i>-1&&e.$set(e.legendInfo,"active",o.slice(0,i).concat(o.slice(i+1)))}else e.$set(e.legendInfo,"active",l)},function(t){return e.toggleRow(e.legendInfo)}]}}),e._v(" "),s("span",{staticClass:"ma-checkbox-faux"}),e._v(" "),s("span",{staticClass:"ma-checkbox-label"},[e._v(e._s(e._f("decode")(e.legendInfo.label)))])])]),e._v(" "),s("div",{staticClass:"legend-count"},[s("span",{staticClass:"visiblemarkers"},[e._v(e._s(e._f("decode")(e.legendInfo.count)))]),e._v(" "),s("span",{staticClass:"of"},[e._v(e._s(e._f("decode")(e.$Labels.MA_of)))]),e._v(" "),s("span",{staticClass:"totalmarkers"},[e._v(e._s(e._f("decode")(e.legendInfo.totalmarkers)))])]),e._v(" "),s("div",{staticClass:"legend-marker"},[e.legendInfo.icon.indexOf("/images/marker")>-1||e.legendInfo.icon.indexOf("servlet.FileDownload")>-1||e.legendInfo.icon.indexOf("sfc/servlet.shepherd/version/download/")>-1||e.legendInfo.indexOf("sfc/servlet.shepherd/document/download/")>-1?s("img",{staticClass:"legend-image",staticStyle:{height:"20px","max-width":"30px"},attrs:{src:e.legendInfo.icon}}):-1!==e.legendInfo.icon.indexOf("ion-ios-infinite")?s("span",{style:{"font-size":"18px",color:e.getIconColor(e.legendInfo.icon)}},[e._v("âˆž")]):-1!==e.legendInfo.icon.indexOf("glyphicon-comment")?s("span",{staticClass:"slds-icon-utility-prompt",style:{"font-size":"16px",fill:e.getIconColor(e.legendInfo.icon)}},[s("MAIcon",{attrs:{slot:"extendInput",src:o(758)},slot:"extendInput"})],1):s("span",[e._v(e._s(e._f("decode")(e.legendInfo.icon)))])])])}),[],!1,null,"b8928084",null).exports,{jQuery:d}=window,c={components:{LegendRow:a},props:{selectedQuery:{type:String,required:!0},isLoading:{type:Boolean,default:!1}},data:()=>({toggleRows:!1,legendRows:{},legendField:"",showAllRows:!1,legendRowSelections:{},legendRowTimeout:null}),computed:{...(0,s.mapGetters)("mainNavBar",{mainNavBar__listView:"listView"}),showText(){let e=this.$Labels.MA_Show_All;return this.showAllRows&&(e=this.$Labels.MA_Show_Less),e}},watch:{selectedQuery(){this.build()}},mounted(){""!==this.selectedQuery&&this.build()},methods:{toggleAllRows(){const e=Object.keys(this.legendRows);this.legendRowSelections={},e.forEach((e=>{this.legendRowSelections[e]=this.toggleRows})),this.peformRowToggle()},build(){this.clearLegend(),this.updateLegendRows(),this.updateSelectAllCheckbox()},clearLegend(){this.legendRowSelections={},this.legendRows=[]},updateLegendRows(){const e=d(`#PlottedQueriesTable .PlottedRowUnit[qid="${this.selectedQuery}"]`).data()||{},{legendInfo:t={},tooltips:o=[]}=e;this.legendRows=t,this.legendField=this.getLegendFieldValue(o)},getLegendFieldValue(e){let t="";for(let o=0;o<e.length;o++){const s=e[o],{TooltipType:l="",FieldLabel:i}=s;"Color"===l&&(t=i)}return t},toggleRowVisibility(){this.showAllRows=!this.showAllRows},toggleRow(e){clearTimeout(this.legendRowTimeout),this.legendRowTimeout=null,this.legendRowSelections[e.legendId]=e.active,this.legendRowTimeout=setTimeout((()=>{this.peformRowToggle()}),250)},peformRowToggle(){const e=this,t=d(`#PlottedQueriesTable .PlottedRowUnit[qid="${this.selectedQuery}"]`);this.$emit("update:isLoading",!0);const o={plottedQuery:t,rows:this.legendRowSelections};window.Plotting.toggleLegendRow(o,(()=>{window.Plotting.updateQueryInfo(t,(()=>{e.build(),window.VueEventBus.$emit("refresh-list-view"),e.$emit("update:isLoading",!1),t.removeClass("loading"),t.find(".queryLoader").hide(),t.find(".queryIcon ").show()}))}))},updateSelectAllCheckbox(){const e=Object.keys(this.legendRows);let t=0;e.forEach((e=>{this.legendRows[e].active&&t++})),this.toggleRows=t===e.length}}},g=(0,n.Z)(c,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"qidLocation ma-view-body",attrs:{id:"legendBody"}},[o("div",{attrs:{id:"legendBodyInner"}},[o("div",{staticClass:"legend-body-fixed-header",staticStyle:{position:"relative"}},[o("div",{staticClass:"ma-divider compact"}),e._v(" "),o("div",{staticClass:"legend-item ma-form-control-wrap ma-checkbox-wrap"},[o("label",{staticClass:"ma-checkbox",staticStyle:{"min-height":"40px"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.toggleRows,expression:"toggleRows"}],attrs:{name:"checkbox",type:"checkbox",checked:"checked"},domProps:{checked:Array.isArray(e.toggleRows)?e._i(e.toggleRows,null)>-1:e.toggleRows},on:{change:[function(t){var o=e.toggleRows,s=t.target,l=!!s.checked;if(Array.isArray(o)){var i=e._i(o,null);s.checked?i<0&&(e.toggleRows=o.concat([null])):i>-1&&(e.toggleRows=o.slice(0,i).concat(o.slice(i+1)))}else e.toggleRows=l},e.toggleAllRows]}}),e._v(" "),o("span",{staticClass:"ma-checkbox-faux"}),e._v(" "),""!==e.legendField?o("span",{staticClass:"ma-checkbox-label queryColorField"},[o("strong",[e._v(e._s(e.$Labels.MA_Field)+":")]),e._v(" "+e._s(e._f("decode")(e.legendField)))]):e._e()])]),e._v(" "),o("div",{staticStyle:{position:"absolute",top:"2px",right:"0px"},on:{click:e.toggleRowVisibility}},[o("span",{staticClass:"float-left ma-button compact legend-moreless-text",staticStyle:{padding:"10px 20px 0px"}},[o("span",{staticClass:"moreless-text"},[e._v(e._s(e._f("decode")(e.showText)))])])])]),e._v(" "),o("div",{staticClass:"legend-body-scrolling-body momentum-scrolling-y slds-scrollable"},[o("div",{staticClass:"legend-wrap"},e._l(e.legendRows,(function(t,s){return o("LegendRow",{key:s,attrs:{legendInfo:t,showAllRows:e.showAllRows},on:{"toggle-row":e.toggleRow}})})),1)])])])}),[],!1,null,null,null).exports}}]);