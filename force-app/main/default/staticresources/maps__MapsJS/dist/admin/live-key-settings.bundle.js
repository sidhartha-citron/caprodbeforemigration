(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[9916],{5264:(t,e,s)=>{"use strict";s.d(e,{Z:()=>l});const i=new Map;function a(t,e,s){const a=function(i){s.context._isDestroyed?document.removeEventListener("click",a):t.contains(i.target)||t===i.target||e(i)};i.set(t,a),setTimeout((()=>document.addEventListener("click",a)),0)}function n(t){const e=i.get(t);document.removeEventListener("click",e),i.delete(t)}const l={bind(t,{arg:{active:e,handler:s}},i){if("function"!=typeof s)throw new Error("v-click-outside: missing required handler argument.");!0===e&&a(t,s,i)},update(t,{arg:{active:e,handler:s}},l){e&&!i.has(t)?a(t,s,l):!e&&i.has(t)&&n(t)},unbind(t){n(t)}}},8221:(t,e,s)=>{"use strict";s.d(e,{Z:()=>r});const i=new Map,a=(t,{anchorRef:e,anchorTopOnVerticalOverflow:s})=>{const i=t.getBoundingClientRect(),a=document.documentElement.clientHeight,n=document.documentElement.clientWidth;let l;if(l=a-window.innerHeight<=0?a:window.innerHeight-(()=>{const t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const e=t.offsetWidth-t.clientWidth;return t.remove(),e})(),i.x<0)t.style.left=`${t.offsetLeft+Math.abs(i.x)}px`;else if(i.left+i.width>n){const e=i.left+i.width-n-window.pageXOffset;t.style.left=i.left-e+"px"}const o=t.scrollHeight;let r;if(e&&s){const t=e.getBoundingClientRect();let s=t.bottom;s+o>l&&(s=t.top-o),r=s}else i.top+o>l&&(r=i.top-(i.top+o-l));r&&(t.style.top=`${r}px`)},n=t=>{let e=i.get(t);e&&(e.remove(),e=null,i.delete(t))};let l;const o=(t,e,s)=>{s&&"scroll"===s.type&&t&&t.contains(s.target)||("function"==typeof e?e(t,s):(n(t),window.removeEventListener("scroll",l,!0),l=null))},r={bind(t,e,s){e.value.disabled||s.context.$nextTick((()=>{const n=e.value,r=((t,e)=>{const s=document.createElement("div");return s.className=`slds-scope ${e.$el.className}`,s.appendChild(t),document.body.appendChild(s),e.$emit("detached",s),s})(t,s.context);s.container=r,i.set(t,r),"function"==typeof n.customDisplayMethod&&n.customDisplayMethod(),n.anchorRef&&n.anchorRef instanceof HTMLElement&&((t,e,{anchorRef:s,resizeToAnchor:i})=>{t.style.position="fixed";const a=s.getBoundingClientRect();t.style.top=`${a.top+s.offsetHeight}px`,t.style.left=`${a.left}px`,i&&(t.style.width=`${s.offsetWidth}px`)})(t,0,n),n.viewPortOverflow&&s.context.$nextTick((()=>{"function"==typeof n.onRender?(n.onRender(),s.context.$nextTick(a.bind(this,t,n))):a(t,n)})),l=o.bind(null,t,n.scrollHandler),window.addEventListener("scroll",l,!0)}))},update(t,{value:e},s){e.viewPortOverflow&&s.context.$nextTick((()=>{"function"==typeof e.onRender&&e.onRender(),a(t,e)}))},unbind(t){n(t),window.removeEventListener("scroll",l,!0),l=null}}},41:(t,e,s)=>{t.exports=s.p+"images/beb4089c3583201862ab1c68f94e5a23.svg"},8949:(t,e,s)=>{t.exports=s.p+"images/9ed3113fa0dfa644ad82ce83bb831a03.svg"},8881:(t,e,s)=>{t.exports=s.p+"images/c014dd95afd4a62abfd6f50902e31d50.svg"},8549:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>y});var i=s(675),a=s(3294),n=s(5835),l=s(8050),o=s(4141);const{MAToastMessages:r}=window,d={components:{MAInput:a.Z,MAButton:n.Z,MAModal:o.Z},data:()=>({liveTokenInput:"",liveTokenStored:"",isKeyReadOnly:!0,showWarning:!1,warningConfirmation:null}),computed:{isKeySaved(){return(""!==this.liveTokenInput||""!==this.liveTokenStored)&&this.liveTokenInput===this.liveTokenStored}},watch:{warningConfirmation:{handler(t){this.warningConfirmation=t.toUpperCase()},deep:!0}},async created(){await this.getStoredliveToken()},methods:{async getStoredliveToken(){this.$parent.isLoading=!0;try{const{success:t,data:e,error:s}=await(0,l.wX)("maps.LiveRemoteFunctions.RetrieveLiveKeySetting",[]);t?(this.liveTokenInput=e.liveToken,this.liveTokenStored=e.liveToken):(this.liveTokenInput="",this.liveTokenStored="","Failed To Get Live Key. No Key Was Found."!==s.messages.developerMsg&&r.showError({position:"toast-top-right",message:"Error",subMessage:s.messages,timeOut:8e3}))}catch(t){r.showError({position:"toast-top-right",message:"Remoting Error",subMessage:t,timeOut:8e3}),console.error(t)}finally{this.$parent.isLoading=!1}},async saveliveToken(t){this.$parent.isLoading=!0;try{const{success:e,error:s}=await(0,l.wX)("maps.LiveRemoteFunctions.SaveLiveKey",[t]);e?(await this.getStoredliveToken(),r.showSuccess({position:"toast-top-right",message:"Success",subMessage:""!==t.trim()?"Live API Key Saved":"Live API Key Removed",timeOut:8e3})):r.showError({position:"toast-top-right",message:"Error",subMessage:s,timeOut:8e3})}catch(t){r.showError({position:"toast-top-right",message:"Remoting Error",subMessage:t,timeOut:8e3}),console.error(t)}finally{this.$parent.isLoading=!1,this.isKeyReadOnly=!0}return null},async clearSavedKey(){this.$parent.isLoading=!0;try{await this.saveliveToken("")}catch(t){r.showError({position:"toast-top-right",message:"Error",subMessage:"Could not remove saved API key.",timeOut:8e3})}},async generateNewKey(){this.$parent.isLoading=!0;try{const{code:t,data:e,error:s}=await(0,l.wX)("maps.LiveRemoteFunctions.GenerateNewLiveKey",[]);200===t||201===t?(await this.saveliveToken(e.liveToken),await this.getStoredliveToken()):r.showError({position:"toast-top-right",message:"Error",subMessage:s,timeOut:8e3})}catch(t){r.showError({position:"toast-top-right",message:"Remoting Error",subMessage:t,timeOut:8e3}),console.error(t)}finally{this.$parent.isLoading=!1}},clickEditInput(){this.liveTokenStored?this.showWarning=!0:this.editKey()},clearInput(){this.liveTokenInput="",this.$refs.keyInput.focus()},editKey(){this.warningConfirmation="",this.isKeyReadOnly=!1,this.$refs.keyInput.focus()},confirmEditModal(){"EDIT"===this.warningConfirmation?(this.isKeyReadOnly=!1,this.showWarning=!1,this.editKey()):r.showWarning({position:"toast-top-right",message:"Please complete the confirmation challenge to edit your Live API key",timeOut:8e3})},closeModal(){this.showWarning=!1,this.isKeyReadOnly=!0,this.liveTokenInput=this.liveTokenStored}}};var c=s(1900);const u=(0,c.Z)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"live_api_key"}},[i("div",[i("div",{attrs:{id:"API-License"}},[i("div",{staticClass:"slds-section slds-is-open"},[t._m(0),t._v(" "),i("div",{staticClass:"slds-section__content section__content"},[i("div",{staticClass:"slds-m-horizontal_small slds-m-top_small",class:{"slds-card slds-card_boundary box":!t.isKeyReadOnly}},[i("div",{class:{"slds-card__body slds-card__body_inner":!t.isKeyReadOnly}},[i("div",{staticClass:"slds-col slds-size_1-of-1 slds-has-flexi-truncate slds-p-horizontal_small slds-p-vertical_medium slds-grid slds-grid_vertical-align-end"},[i("MAInput",{ref:"keyInput",staticClass:"slds-input-has-icon slds-input-has-icon_right slds-size_medium",class:{"readonly-input slds-border_bottom":t.isKeyReadOnly},attrs:{id:"text-input-key",isRequired:!0,type:"text",label:"Live API Key"},model:{value:t.liveTokenInput,callback:function(e){t.liveTokenInput=e},expression:"liveTokenInput"}},[i("MAButton",{directives:[{name:"show",rawName:"v-show",value:t.isKeyReadOnly,expression:"isKeyReadOnly"}],staticClass:"slds-input__icon slds-input__icon_right",attrs:{slot:"extendInput",title:"Edit API Key"},on:{click:t.clickEditInput},slot:"extendInput"},[i("MAIcon",{directives:[{name:"show",rawName:"v-show",value:t.isKeyReadOnly,expression:"isKeyReadOnly"}],attrs:{src:s(8949),iconClass:["slds-button__icon","slds-icon-text-light"],assistiveText:"Edit API Key"}})],1),t._v(" "),i("MAButton",{directives:[{name:"show",rawName:"v-show",value:!t.isKeyReadOnly,expression:"!isKeyReadOnly"}],staticClass:"slds-input__icon slds-input__icon_right",attrs:{slot:"extendInput",title:"Clear API Key"},on:{click:t.clearInput},slot:"extendInput"},[i("MAIcon",{directives:[{name:"show",rawName:"v-show",value:!t.isKeyReadOnly,expression:"!isKeyReadOnly"}],attrs:{src:s(41),iconClass:["slds-button__icon","slds-icon-text-light"],assistiveText:"Clear API Key"}})],1),t._v(" "),i("span",{attrs:{slot:"errors"},slot:"errors"},[t._v("The key is invalid")])],1),t._v(" "),i("div",{staticClass:"slds-m-left_x-small"},[t.isKeyReadOnly?t._e():i("button",{staticClass:"slds-button",attrs:{id:"keygenbtn",type:"button"},on:{click:t.generateNewKey}},[t._v("\n                                        Generate\n                                    ")])])],1),t._v(" "),t.isKeyReadOnly?t._e():i("div",{staticClass:"slds-grid slds-grid_align-center slds-p-top_large"},[i("button",{staticClass:"slds-button slds-button_neutral",attrs:{id:"cancelbtn",type:"button"},on:{click:t.closeModal}},[t._v("\n                                    Cancel\n                                ")]),t._v(" "),i("button",{staticClass:"slds-button slds-button_brand",attrs:{id:"keysavebtn",type:"button"},on:{click:function(e){return t.saveliveToken(t.liveTokenInput)}}},[t._v("\n                                    Save\n                                ")])])])])])])])]),t._v(" "),t.showWarning?i("MAModal",{attrs:{isSmall:"",title:"Confirm Key Edit"},on:{close:t.closeModal}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("div",{staticClass:"slds-grid slds-grid_align-center"},[i("MAIcon",{staticClass:"slds-icon_container",attrs:{src:s(8881),iconClass:["slds-icon","slds-icon-text-warning","slds-icon_large"],assistiveText:"Warning Icon"}})],1),t._v(" "),i("div",{staticClass:"slds-text-align_center slds-p-around_small"},[i("div",{staticClass:"slds-text-heading_small slds-p-around_x-small"},[t._v("\n                    Maps Live Tracking will require a full re-implementation of any devices associated with the current API key.\n                ")]),t._v(" "),i("div",{staticClass:"slds-text-heading_small slds-p-around_x-small slds-m-bottom_small"},[t._v("\n                    We strongly suggest you "),i("strong",[t._v("DO NOT")]),t._v(" make any changes to your API key.\n                ")]),t._v(" "),i("div",{staticClass:"slds-m-bottom_small"},[i("abbr",{staticClass:"slds-required",attrs:{title:"Required"}},[t._v("*")]),t._v(" "),i("span",[t._v('\n                        Type "'),i("strong",[t._v("EDIT")]),t._v('" below to confirm you want to modify your API key.\n                    ')])]),t._v(" "),i("div",{staticClass:"slds-align_absolute-center slds-col slds-size_1-of-3"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.warningConfirmation,expression:"warningConfirmation"}],staticClass:"slds-input",style:{"text-align":"center"},attrs:{id:"text-input-confirm",autocomplete:"off",type:"text"},domProps:{value:t.warningConfirmation},on:{input:[function(e){e.target.composing||(t.warningConfirmation=e.target.value)},function(e){return t.warningConfirmation.toUpperCase()}]}})])])]),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("button",{staticClass:"slds-button slds-button_neutral",on:{click:t.closeModal}},[t._v("\n                Cancel\n            ")]),t._v(" "),i("button",{staticClass:"slds-button slds-button_brand",on:{click:t.confirmEditModal}},[t._v("\n                Edit\n            ")])])]):t._e()],1)}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-section__title slds-theme_shade"},[s("span",{staticClass:"section-header-title slds-p-horizontal_small slds-truncate"},[t._v("Licensing")])])}],!1,null,"4402777c",null).exports;var h=s(2025);const{MAToastMessages:g}=window,v={components:{MADatetimePicker:h.Z},data(){return{tableRows:[],tableColumns:["DEVICE VENDOR","DEVICE ID"],sortTableBy:null,sortDirection:null,startingDate:this.getCurrentDate(),endingDate:this.getCurrentDate(),lastValidStartingDate:null,lastValidEndingDate:null}},methods:{returnCapitalized:t=>(t&&"gm"===t.toLowerCase()&&(t="GM"),t&&"mapanything"===t.toLowerCase()&&(t="MapAnything"),t?t.charAt(0).toUpperCase()+t.slice(1):null),async createDevicesTable(){const t={from:this.startingDate.startOf("day").valueOf(),to:this.endingDate.endOf("day").valueOf()};if(!this.validateDateSelected(this.startingDate,"start"))return!1;if(!this.validateDateSelected(this.endingDate,"end"))return!1;try{this.$parent.isLoading=!0;const{success:e,devices:s,error:i}=await(0,l.wX)("maps.LiveRemoteFunctions.GetLiveDeviceBillingStatus",[JSON.stringify(t)]);e?s.length>0?this.tableRows=s:g.showMessage({position:"toast-top-right",message:"No devices reporting in the date range you requested",timeOut:8e3}):g.showError({position:"toast-top-right",message:"Error",subMessage:i,timeOut:8e3})}catch(t){g.showError({position:"toast-top-right",message:"Remoting Error",subMessage:t.message.toString(),timeOut:8e3}),console.error(t.message)}finally{this.$parent.isLoading=!1}return null},validateDateSelected(t,e){t=t.startOf("day");const s=this.getCurrentDate().startOf("day"),i=this.getCurrentDate().subtract(60,"days").startOf("day");return t>s?(g.showError({position:"toast-top-right",message:"Validation Error",subMessage:"Cannot select a date in the future. Please adjust your starting and ending dates.",timeOut:8e3}),e&&"start"===e&&(null!=this.lastValidStartingDate?this.startingDate=this.lastValidStartingDate:this.startingDate=this.getCurrentDate()),e&&"end"===e&&(null!=this.lastValidEndingDate?this.endingDate=this.lastValidEndingDate:this.endingDate=this.getCurrentDate()),!1):i>t?(g.showError({position:"toast-top-right",message:"Validation Error",subMessage:"Cannot select a date older than 60 days in the past. Please adjust your starting and ending dates.",timeOut:8e3}),e&&"start"===e&&(null!=this.lastValidStartingDate?this.startingDate=this.lastValidStartingDate:this.startingDate=this.getCurrentDate()),e&&"end"===e&&(null!=this.lastValidEndingDate?this.endingDate=this.lastValidEndingDate:this.endingDate=this.getCurrentDate()),!1):("start"===e&&(this.lastValidStartingDate=t),"end"===e&&(this.lastValidEndingDate=t),!(null!=this.lastValidStartingDate&&null!=this.lastValidEndingDate&&this.lastValidStartingDate.valueOf()>this.lastValidEndingDate.valueOf()&&(g.showError({position:"toast-top-right",message:"Validation Error",subMessage:"Your end date cannot be before your start date. Please adjust your starting and ending dates.",timeOut:8e3}),1)))},getCurrentDate(){return this.$moment().tz(this.$User.timezoneId).locale(this.$User.UserLocale)}}},p=(0,c.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-m-top_x-large",attrs:{id:"live_billing_status"}},[s("div",[s("div",{attrs:{id:"Billing-Status"}},[s("div",{staticClass:"slds-section slds-m-bottom_large slds-is-open"},[t._m(0),t._v(" "),s("div",{staticClass:"slds-form slds-form_compound"},[s("div",{staticClass:"slds-form-element__row slds-p-around_large slds-grid_vertical-align-end"},[s("div",{staticClass:"slds-form-element slds-m-right_large slds-m-top_medium"},[s("MADatetimePicker",{attrs:{dateFormat:t.$User.dateFormat.toUpperCase(),showInputField:!0,locale:t.$User.UserLocale,timezone:t.$User.timezoneId,label:"Starting Date"},on:{input:function(e){return t.validateDateSelected(e,"start")}},model:{value:t.startingDate,callback:function(e){t.startingDate=e},expression:"startingDate"}})],1),t._v(" "),s("div",{staticClass:"slds-form-element"},[s("MADatetimePicker",{attrs:{dateFormat:t.$User.dateFormat.toUpperCase(),numYearsInFuture:0,showInputField:!0,locale:t.$User.UserLocale,timezone:t.$User.timezoneId,label:"Ending Date"},on:{input:function(e){return t.validateDateSelected(e,"end")}},model:{value:t.endingDate,callback:function(e){t.endingDate=e},expression:"endingDate"}})],1),t._v(" "),s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-p-left_x-small slds-p-top_x-small"},[s("button",{staticClass:"slds-button",attrs:{id:"getbillingbtn",type:"button"},on:{click:t.createDevicesTable}},[t._v("\n                                    Generate Report\n                                ")])])])])]),t._v(" "),t.tableRows.length>0?s("div",{staticClass:"slds-table_header-fixed_container",staticStyle:{"border-top":"1px solid rgb(221, 219, 218)",height:"100%"}},[s("div",{staticClass:"slds-table_header-fixed_scroller",staticStyle:{height:"100%",overflow:"auto"}},[s("table",{staticClass:"slds-table slds-table_fixed-layout slds-table_header-fixed slds-table_resizable-cols slds-table_bordered slds-table_striped",attrs:{id:"TABLEHEADER","aria-multiselectable":"true",role:"grid"}},[s("thead",[s("tr",{staticClass:"slds-line-height_reset"},t._l(t.tableColumns,(function(e,i){return s("th",{key:i,staticStyle:{height:"0px","line-height":"0"},attrs:{"aria-label":e,scope:"col"}},[s("div",{staticClass:"slds-cell-fixed",staticStyle:{display:"flex","flex-flow":"row nowrap"}},[s("a",{staticClass:"slds-th__action slds-text-link_reset",staticStyle:{"align-items":"center",display:"flex",flex:"1 1 auto","line-height":"1.25",width:"100%"}},[s("span",{staticClass:"slds-truncate",attrs:{title:e}},[t._v("\n                                                    "+t._s(e)+"\n                                                ")])])])])})),0)]),t._v(" "),s("tbody",t._l(t.tableRows,(function(e,i){return s("tr",{key:i,staticClass:"slds-hint-parent"},[s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[t._v("\n                                            "+t._s(e.vendor?t.returnCapitalized(e.vendor)+" ("+e.count+")":"")+"\n                                        ")])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[t._v("\n                                            "+t._s(e.deviceid)+"\n                                        ")])])])})),0)])])]):t._e()])])])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-section__title slds-theme_shade"},[s("span",{staticClass:"section-header-title slds-p-horizontal_small slds-truncate"},[t._v("Live Usage Statistics")])])}],!1,null,null,null).exports,m={components:{MASpinner:i.Z,BillingStatus:p,KeySettings:u},data:()=>({isLoading:!1})},y=(0,c.Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[t.isLoading?s("MASpinner"):t._e(),t._v(" "),s("div",{staticClass:"slds-p-around_medium"},[s("KeySettings"),t._v(" "),s("BillingStatus")],1)],1)}),[],!1,null,null,null).exports},5835:(t,e,s)=>{"use strict";s.d(e,{Z:()=>a});const i={name:"MAButton",props:{stretched:{type:Boolean,default:!1},theme:{type:String,default:"",validator:t=>{const e=["neutral","brand","inverse","destructive","success","outline-brand","text-destructive","container","border-filled","border","border-inverse"],s=!t||e.includes(t);return s||console.error(`Valid theme prop values are ${e.join(", ")}`),s}},disabled:{type:Boolean,default:!1},title:{type:String,default:""}},data:()=>({classes:[],observer:null,skipUpdateLogic:!1}),beforeUpdate(){this.setClasses()},mounted(){this.$slots.default.every((t=>void 0===t.componentInstance))?this.setClasses({skipNextUpdateLogic:!0}):(this.setClasses(),this.observer=new MutationObserver(this.setClasses.bind(this,{fromObserver:!0})),this.observer.observe(this.$el,{subtree:!0,childList:!0}))},beforeDestroy(){this.observer&&this.observer.disconnect()},methods:{setClasses({fromObserver:t=!1,skipNextUpdateLogic:e=!1}={}){if(this.skipUpdateLogic)return void(this.skipUpdateLogic=!1);t&&this.observer.disconnect(),(t||e)&&(this.skipUpdateLogic=!0),this.$set(this,"classes",[]),this.stretched&&this.classes.push("slds-button_stretch");let s=!1,i=!1,a=!1;this.$el.childNodes.forEach((t=>{"SPAN"===t.nodeName&&(t.getElementsByTagName("svg").length&&(i=!0),(t.classList.contains("slds-assistive-text")||t.getElementsByClassName("slds-assistive-text").length)&&(s=!0)),"#text"===t.nodeName&&t.textContent.trim()&&(a=!0)})),i||(i=this.$el.getElementsByTagName("svg").length>0),!i||s||a||console.error("Please add assistive text or a text node."),a&&s&&console.error("Detected root text node and assistive text, but assistive text is not needed."),this.theme&&(i&&s&&!a?this.classes.push(`slds-button_icon slds-button_icon-${this.theme}`):this.classes.push(`slds-button_${this.theme}`))}}},a=(0,s(1900).Z)(i,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",t._g({staticClass:"slds-button",class:t.classes,attrs:{disabled:t.disabled,title:t.title}},t.$listeners),[t._t("default")],2)}),[],!1,null,null,null).exports}}]);