(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[7995],{3826:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});const a={methods:{decodeHtml(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}}}},1546:(e,t,s)=>{e.exports=s.p+"images/f1d098fce1a3f9d55092c1a72f1b865d.svg"},3014:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(8050),l=s(675),i=s(6679);const{MAToastMessages:c}=window,n={components:{MASpinner:l.Z,MASelect:i.Z},data:()=>({isLoading:!1,scheduledBatchData:null,batchesToSchedule:{title:null},frequencyOptions:{options:[{value:"5mins",label:"Every 5 mins"},{value:"10mins",label:"Every 10 mins"},{value:"15mins",label:"Every 15 mins"},{value:"30mins",label:"Every 30 mins"},{value:"Hourly",label:"Hourly"},{value:"Daily",label:"Daily"}],label:"Frequency",selectedValue:"Hourly"},selectedDailyTime:null,dailyTimeOptions:{options:[{value:"0",label:"12:00 AM"},{value:"1",label:"1:00 AM"},{value:"2",label:"2:00 AM"},{value:"3",label:"3:00 AM"},{value:"4",label:"4:00 AM"},{value:"5",label:"5:00 AM"},{value:"6",label:"6:00 AM"},{value:"7",label:"7:00 AM"},{value:"8",label:"8:00 AM"},{value:"9",label:"9:00 AM"},{value:"10",label:"10:00 AM"},{value:"11",label:"11:00 AM"},{value:"12",label:"12:00 PM"},{value:"13",label:"1:00 PM"},{value:"14",label:"2:00 PM"},{value:"15",label:"3:00 PM"},{value:"16",label:"4:00 PM"},{value:"17",label:"5:00 PM"},{value:"18",label:"6:00 PM"},{value:"19",label:"7:00 PM"},{value:"20",label:"8:00 PM"},{value:"21",label:"9:00 PM"},{value:"22",label:"10:00 PM"},{value:"23",label:"11:00 PM"}],label:"Preferred Time",selectedValue:"0"},scheduleSettings:{DailySummBatchFrequency:null,DailySummBatchPreferredTime:null,DailySummBatchScheduled:!1,LastPositionBatchScheduled:!1}}),async created(){await this.scheduleBatchChecker(),await this.checkIfBatchesScheduled()},methods:{determineBatchesForUpdate(e){e&&(e.DailySummBatchScheduled&&e.LastPositionBatchScheduled||(e.DailySummBatchScheduled||e.LastPositionBatchScheduled?e.DailySummBatchScheduled&&!e.LastPositionBatchScheduled?(this.batchesToSchedule.title="Set Last Position Batch Job",this.scheduleSettings.DailySummBatchScheduled=!0,this.scheduleSettings.LastPositionBatchScheduled=!1):!e.DailySummBatchScheduled&&e.LastPositionBatchScheduled?(this.batchesToSchedule.title="Set Summary Batch Job",this.scheduleSettings.DailySummBatchScheduled=!1,this.scheduleSettings.LastPositionBatchScheduled=!0):c.showError({position:"toast-top-right",message:"Error",subMessage:"There was an issue checking if batches are already scheduled.",timeOut:8e3}):(this.batchesToSchedule.title="Set Summary & Last Position Batch Job",this.scheduleSettings.DailySummBatchScheduled=!1,this.scheduleSettings.LastPositionBatchScheduled=!1)))},async checkIfBatchesScheduled(){this.isLoading=!0;try{const{success:e,data:t}=await(0,a.wX)("maps.LiveRemoteFunctions.checkIfBatchesScheduled",[]);e?(this.scheduledBatchData=t,this.determineBatchesForUpdate(t)):c.showError({position:"toast-top-right",message:"Error",subMessage:"There was an issue retrieving your org's batch scheduling settings.",timeOut:8e3})}catch(e){c.showError({position:"toast-top-right",message:"Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}},async scheduleBatchChecker(){this.isLoading=!0;try{const{success:e,error:t}=await(0,a.wX)("maps.LiveRemoteFunctions.checkScheduledBatches",[]);e||c.showError({position:"toast-top-right",message:"Error",subMessage:t,timeOut:8e3})}catch(e){c.showError({position:"toast-top-right",message:"Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}},async saveAndscheduleBatches(){this.isLoading=!0;try{this.scheduleSettings.DailySummBatchFrequency=this.frequencyOptions.selectedValue,this.scheduleSettings.DailySummBatchPreferredTime=this.dailyTimeOptions.selectedValue;const{success:e,data:t}=await(0,a.wX)("maps.LiveRemoteFunctions.saveAndscheduleBatches",[this.scheduleSettings]);e?(c.showSuccess({position:"toast-top-right",message:"Success",subMessage:t,timeOut:8e3}),await this.checkIfBatchesScheduled()):c.showError({position:"toast-top-right",message:"Error",subMessage:"There was an issue retrieving your org's batch scheduling settings.",timeOut:8e3})}catch(e){c.showError({position:"toast-top-right",message:"Remoting Error",subMessage:e,timeOut:8e3})}finally{this.isLoading=!1}}}},o=(0,s(1900).Z)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"slds-m-around--medium",attrs:{id:"app"}},[e.isLoading?a("MASpinner"):e._e(),e._v(" "),a("div",{staticClass:"slds-section__title slds-theme--shade"},[a("div",{staticClass:"slds-media__figure slds-m-right_x-small"},[a("MAIcon",{staticClass:"slds-icon_container",attrs:{src:s(1546),iconClass:["slds-icon","slds-icon-text-default"],assistiveText:"Batch Job Scheduling"}})],1),e._v(" "),a("span",{staticClass:"section-header-title slds-truncate"},[e._v("Batch Job Scheduling")])]),e._v(" "),a("div",{staticClass:"slds-m-around--small"},[e.scheduledBatchData&&e.scheduledBatchData.DailySummBatchScheduled&&e.scheduledBatchData.CountOfActiveConfigs>0?a("div",[a("div",{staticClass:"slds-text-heading_medium slds-p-top--small slds-p-bottom--small"},[e._v("\n                Live Tracking Summary Batch Job\n            ")]),e._v(" "),e._m(0)]):e._e(),e._v(" "),e.scheduledBatchData&&e.scheduledBatchData.DailySummBatchScheduled&&e.scheduledBatchData.CountOfActiveConfigs<1?a("div",[a("div",{staticClass:"slds-text-heading_medium slds-p-top--small slds-p-bottom--small"},[e._v("\n                Live Tracking Summary Batch Job\n            ")]),e._v(" "),e._m(1)]):e._e(),e._v(" "),e.scheduledBatchData&&e.scheduledBatchData.LastPositionBatchScheduled?a("div",[a("div",{staticClass:"slds-text-heading_medium slds-p-top--large slds-p-bottom--small"},[e._v("\n                Last Position Batch Job\n            ")]),e._v(" "),e._m(2)]):e._e(),e._v(" "),!e.scheduledBatchData||e.scheduledBatchData.DailySummBatchScheduled&&e.scheduledBatchData.LastPositionBatchScheduled?e._e():a("div",[a("div",{staticClass:"slds-text-heading_medium slds-p-top--medium slds-p-bottom--small"},[e._v("\n                "+e._s(e.batchesToSchedule.title)+" Schedule\n            ")]),e._v(" "),a("div",{staticClass:"slds-box"},[a("MASelect",{attrs:{options:e.frequencyOptions.options,label:e.frequencyOptions.label,hasNoneOption:!1,keyString:"value",valueString:"label"},model:{value:e.frequencyOptions.selectedValue,callback:function(t){e.$set(e.frequencyOptions,"selectedValue",t)},expression:"frequencyOptions.selectedValue"}}),e._v(" "),"Daily"===e.frequencyOptions.selectedValue?a("MASelect",{attrs:{options:e.dailyTimeOptions.options,label:e.dailyTimeOptions.label,hasNoneOption:!1,keyString:"value",valueString:"label"},model:{value:e.dailyTimeOptions.selectedValue,callback:function(t){e.$set(e.dailyTimeOptions,"selectedValue",t)},expression:"dailyTimeOptions.selectedValue"}}):e._e(),e._v(" "),a("div",{staticClass:"slds-p-left_x-small slds-p-top_x-small"},[a("button",{staticClass:"slds-button slds-button--success slds-button--brand",attrs:{id:"alertsavebtn",type:"button"},on:{click:e.saveAndscheduleBatches}},[e._v("\n                        Save\n                    ")])])],1)])])],1)}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-box slds-p-top--small"},[e._v("\n                Daily or Hourly Summary Job "),s("span",{staticClass:"slds-text-color_success"},[e._v("already scheduled")]),e._v(", to manage please go to "),s("strong",[e._v("Setup -> Scheduled Jobs")]),e._v(".\n            ")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-box slds-p-top--small"},[e._v("\n                Please "),s("a",{attrs:{href:"/apex/maps__Settings?tabId=LiveDailySummaries"}},[e._v("create a Daily Summary configuration")]),e._v(" to schedule a job.\n            ")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-box"},[e._v("\n                Last Position Job "),s("span",{staticClass:"slds-text-color_success"},[e._v("already scheduled")]),e._v(", to manage please go to "),s("strong",[e._v("Setup -> Scheduled Jobs")]),e._v(".\n            ")])}],!1,null,null,null).exports},6679:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});const a={name:"MASelect",mixins:[s(3826).Z],props:{label:{type:String,default:""},options:{type:[Object,Array],required:!0},keyString:{type:String,default:"key"},valueString:{type:String,default:"value"},hasNoneOption:{type:Boolean,default:!0},value:{type:[String,Number],default:""},default:{type:[String,Number],default:""},isRequired:{type:Boolean,default:!1},isInvalid:{type:Boolean,default:!1},placeholder:{type:String,default:""},requiredLabel:{type:String,default:"Required"},noneLabel:{type:String,default:"--None--"}},data(){return{defaultValue:this.default}},computed:{showLabel(){return this.label}},watch:{value(){const e={};e[this.keyString]=this.value,e[this.valueString]=this.getSelectedValue(),this.$emit("change",e)}},methods:{getKey(e){return"string"==typeof e||"number"==typeof e?e:e[this.keyString]},getValue(e){return"string"==typeof e||"number"==typeof e?e:e[this.valueString]},isSelected(e){return this.getKey(e)===this.value},change(e){e||(e=null);let t=this.options.find((t=>("object"==typeof t?t[this.keyString]:t).toString()===e));"object"==typeof t&&(t=t[this.keyString]),this.$emit("input",t)},getSelectedValue(){if(!this.options||!this.options.length)return"";const e=this.options.find((e=>this.getKey(e)===this.value));return e?this.decodeHtml(this.getValue(e)):null},remove(){this.$emit("input",""),this.doHide()}}},l=(0,s(1900).Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-form-element",class:{"slds-has-error":e.isInvalid}},[e.showLabel?s("label",{staticClass:"slds-form-element__label"},[e.isRequired?s("abbr",{staticClass:"slds-required",attrs:{title:e.requiredLabel}},[e._v("*")]):e._e(),e._v("\n        "+e._s(e.decodeHtml(e.label))+"\n    ")]):e._e(),e._v(" "),s("select",{staticClass:"slds-select",attrs:{placeholder:e.placeholder},on:{change:function(t){return e.change(t.target.value)}}},[e.hasNoneOption?s("option",{attrs:{value:""}},[e._v("\n            "+e._s(e.noneLabel)+"\n        ")]):e._e(),e._v(" "),e._l(e.options,(function(t,a){return s("option",{key:a,domProps:{value:e.getKey(t),selected:e.isSelected(t)}},[e._v("\n            "+e._s(e.getValue(t))+"\n        ")])}))],2),e._v(" "),e.isInvalid?s("div",{staticClass:"slds-form-element__help"},[e._t("errors")],2):e._e()])}),[],!1,null,null,null).exports}}]);