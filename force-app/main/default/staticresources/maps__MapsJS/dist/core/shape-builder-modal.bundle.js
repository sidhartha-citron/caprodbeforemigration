"use strict";(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[453],{5477:(e,t,s)=>{s.r(t),s.d(t,{default:()=>R});var l=s(5908),a=s(4461),i=s(7102),o=s(379),r=s(2423);const n=(e,t,s=[])=>new Promise(((l,a)=>{const i={overlay:e,level:t,filters:s};(new r.Z).setAction("maps.RemoteFunctions.MapAnythingIORequestPOST").setErrorHandler((e=>{console.warn("Failed to get overlay information related to selected level",e),a(new Error("Failed to get overlay information related to selected level"))})).invoke([{subType:"boundary",action:"search",version:"1"},JSON.stringify(i)],(e=>{const{success:t=!1,data:s={}}=e;if(t){const{geoids:e=[]}=s;l(e)}else console.warn("Failed to get overlay information related to selected level",e),a(new Error("Failed to get overlay information related to selected level"))}),{escape:!1,buffer:!1})})),d=(e=!1,t,s)=>new Promise(((l,a)=>{let i={};if(e){if(!t||!s)return void a(new Error("Missing required information to retrieve field level data: Country or Level."));i={overlay:t,level:s,fields:!0}}(new r.Z).setAction("maps.RemoteFunctions.MapAnythingIORequest").setErrorHandler((e=>{console.warn("Failed to get country select options",e),a(new Error("Unable to retrieve latest information. If this issue persists please contact support"))})).invoke([{subType:"boundary",action:"overlays",version:"1"},i],(e=>{const{success:t=!1,data:s={}}=e;if(t){const{overlays:e=[]}=s;l(e)}else console.warn("Failed to get country select options",e),a(new Error("Unable to retrieve latest information. If this issue persists please contact support"))}),{escape:!1,buffer:!1})}));var c=s(9090),u=s(4069);const p={components:{ScopedNotification:c.ac,MAInput:u.Z},props:{validator:{type:Object,required:!0},isUsedInRule:{type:Boolean,default:!1}},computed:{...(0,l.mapState)("shapeBuilder",{builder__shape:"shape"})},methods:{moveToSelectionTab(){this.$emit("update-tab","shapeBuilderSelections")}}};var h=s(1900);const _=(0,h.Z)(p,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"slds-p-around--large",staticStyle:{width:"75%"}},[s("div",{staticClass:"slds-grid slds-gutters_large"},[s("div",{staticClass:"slds-col slds-size_2-of-5"},[s("MAInput",{staticClass:"territory-name",attrs:{isRequired:!0,type:"text",placeholder:"ex. Southeast Territory",label:"Name"},on:{input:e.validator.builder__shape.Name.$touch},model:{value:e.builder__shape.Name,callback:function(t){e.$set(e.builder__shape,"Name",t)},expression:"builder__shape.Name"}}),e._v(" "),!e.validator.builder__shape.Name.required&&e.validator.builder__shape.Name.$dirty?s("div",{staticClass:"invalidField"},[e._v("\n                    "+e._s(e.$Labels.MA_This_Field_Is_Required)+"\n                ")]):e._e(),e._v(" "),e.validator.builder__shape.Name.maxLength?e._e():s("div",{staticClass:"invalidField"},[e._v("\n                    "+e._s(e.$Labels.MA_Max_Length_80_Name)+"\n                ")]),e._v(" "),s("MAInput",{staticClass:"territory-description",attrs:{useTextArea:!0,type:"text",placeholder:"ex. Enterprise Sales Territory",label:"Description"},model:{value:e.builder__shape.maps__Description__c,callback:function(t){e.$set(e.builder__shape,"maps__Description__c",t)},expression:"builder__shape.maps__Description__c"}}),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button--success",attrs:{id:"shapeLayerBuilderTabDetailsNextButton",disabled:!e.validator.builder__shape.Name.required},on:{click:e.moveToSelectionTab}},[e._v("\n                        Next\n                    ")])])],1),e._v(" "),e.isUsedInRule?s("div",{staticClass:"slds-col slds-size_3-of-5 slds-p-horizontal_large"},[s("ScopedNotification",{attrs:{theme:"info"}},[s("p",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.$Labels.AutoAssignment_ShapeLayer_Warning))])])],1):e._e()])])])}),[],!1,null,null,null).exports;var v=s(257);const m={components:{Spinner:c.$j},directives:{"click-outside":i.Z},props:{zipImportData:{type:Object,required:!0},showZipImportScreen:{type:Boolean,required:!0}},data:()=>({isLoading:!1,showFormattingGuidelines:!1,importError:!1,invalidZipCodes:[],validZipLength:0,zipEntry:""}),computed:{levelString(){const{levels:e=[]}=this.zipImportData;return e.map((e=>e.label)).join(", ")},clickOutsideZip(){return{active:!0,handler:this.closeImport}},...(0,l.mapState)("shapeBuilder",{builder__country:"country"})},methods:{closeImport(){this.zipEntry="",this.$emit("update:showZipImportScreen",!1)},toggleFormattingGuidelines(e){this.showFormattingGuidelines=e},processZipCodes(){this.isLoading=!0;const e=this.formatUserEntry();this.getZipCodeImports(e).then((e=>{this.updateZipCodeData(e)})).catch((e=>{window.MAToastMessages.showError({message:this.$Labels.MA_Error,subMessage:e.message,timeOut:0,extendedTimeOut:0,closeButton:!0})})).finally((()=>{this.isLoading=!1}))},getZipCodeImports(e){return new Promise(((t,s)=>{const l={zips:e,country_code:this.builder__country};(new v.Z).setAction("maps.RemoteFunctions.MapAnythingIORequestPOST").setErrorHandler((e=>{console.warn(e),s(new Error(e))})).invoke([{subType:"boundary",action:"zipimport",version:"1"},JSON.stringify(l)],(e=>{const{success:l=!1,data:a={},errInfo:i='{error: {message: "Unknown Error"}}'}=e;if(l)t(a);else{let e="Unknown Error";try{const t=JSON.parse(i),{error:s={}}=t;e=s.message}catch(e){}s(new Error(e))}}),{escape:!1})}))},updateZipCodeData(e={}){this.invalidZipCodes=[],this.importError=!1,this.validZipCodes=[];const{validZips:t=[],invalidZips:s=[]}=e,l=t.length,i=[];for(let e=0;e<l;e++){const s=t[e];s.level=4,s.active=!0,s.plotted=!1,s.guid=(0,a.x$)(),i.push(s)}this.validZipLength=i.length,this.$emit("update-user-entry",i),s.length>0?(this.importError=!0,this.invalidZipCodes=s):(this.closeImport(),window.MAToastMessages.showSuccess({subMessage:`${this.validZipLength} item(s) imported successfully`,timeOut:6e3}))},formatUserEntry(){return this.zipEntry.split(/[\s,]+/)},dismissErrors(){this.importError=!1,this.zipEntry=""}}},b=(0,h.Z)(m,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("section",{directives:[{name:"click-outside",rawName:"v-click-outside:[clickOutsideZip]",arg:e.clickOutsideZip}],staticClass:"slds-popover slds-popover_panel slds-popover_medium",staticStyle:{position:"absolute",top:"10px",right:"10px"},attrs:{"aria-labelledby":"panel-heading-id",role:"dialog"}},[e.isLoading?s("Spinner"):e._e(),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-button_icon slds-button_icon-small slds-float_right slds-popover__close js-hide-shape-builder-paste-clipboard",attrs:{title:"Close dialog"},on:{click:e.closeImport}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-close",attrs:{"aria-hidden":"true"}})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.showFormattingGuidelines,expression:"!showFormattingGuidelines"}],staticClass:"slds-popover__body"},[s("div",{staticClass:"slds-p-top--large slds-p-horizontal--large"},[e._m(0),e._v(" "),s("p",{staticClass:"slds-text-body_small slds-text-color_weak slds-p-bottom_x-small"},[e._v('\n                    Paste copied items into the text area below and click the "Process Items" button. Be sure to review our\n                    '),s("a",{attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.toggleFormattingGuidelines(!0)}}},[e._v("\n                        formatting guidelines\n                    ")]),e._v(".\n                    "),s("span",{staticStyle:{"font-weight":"bold"}},[e._v("Items that can be processed inclued "+e._s(e.levelString)+".")])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.importError,expression:"!importError"}]},[s("div",{staticClass:"slds-p-top--medium slds-p-horizontal--large slds-p-bottom_x-small"},[s("div",{staticClass:"slds-form-element",attrs:{id:"shapeBuilderPasteClipboardTextAreaWrap"}},[s("div",{staticClass:"slds-form-element__control"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.zipEntry,expression:"zipEntry"}],staticClass:"slds-textarea",attrs:{placeholder:"Paste import data here..."},domProps:{value:e.zipEntry},on:{input:function(t){t.target.composing||(e.zipEntry=t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"slds-p-horizontal--large slds-p-bottom--large"},[s("div",{staticClass:"flex-row"},[s("div",{staticClass:"flex-grow-1"}),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_neutral js-hide-shape-builder-paste-clipboard",on:{click:e.closeImport}},[e._v("\n                                Cancel\n                            ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand js-show-shape-builder-paste-clipboard-processing",attrs:{id:"shapeBuilderPasteClipboardProcessingButton"},on:{click:e.processZipCodes}},[e._v("\n                                Process Items\n                            ")])])])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.importError,expression:"importError"}],staticClass:"slds-p-top--medium slds-p-horizontal--large"},[s("div",{staticClass:"slds-box slds-box_x-small slds-theme_shade slds-m-bottom--small"},[s("div",{staticClass:"slds-p-bottom--small slds-text-color_weak"},[e._v("\n                        "+e._s(e.validZipLength)+" ZIP Codes successfully added.\n                    ")]),e._v(" "),s("div",{staticClass:"slds-p-bottom--xx-small slds-text-color_error"},[e._v("\n                        "+e._s(e.invalidZipCodes.length)+" errors:\n                    ")]),e._v(" "),s("div",{staticClass:"slds-box slds-box_x-small slds-theme_default slds-scrollable_y invalid-zips",staticStyle:{"max-height":"100px"}},e._l(e.invalidZipCodes,(function(t,l){return s("div",{key:l},[e._v("\n                            "+e._s(t)+"\n                        ")])})),0)]),e._v(" "),s("div",{staticClass:"slds-text-align_right slds-p-bottom--small"},[s("button",{staticClass:"slds-button slds-button_neutral js-hide-shape-builder-paste-error-wrap",on:{click:e.dismissErrors}},[e._v("\n                        Dismiss\n                    ")])])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showFormattingGuidelines,expression:"showFormattingGuidelines"}],staticClass:"slds-popover__body",attrs:{id:"shapeBuilderPasteClipboardGuidelines"}},[s("div",{staticClass:"slds-p-around--large"},[e._m(1),e._v(" "),s("p",{staticClass:"slds-text-body_small slds-text-color_weak slds-m-bottom--medium"},[e._v("Set up your boundaries by separating them with a comma or a line break. Examples below.")]),e._v(" "),e._m(2),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(t){return e.toggleFormattingGuidelines(!1)}}},[s("div",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-check "}),e._v("\n                        Got It\n                    ")])])])])],1)])}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-p-bottom_small"},[s("h3",{staticClass:"slds-text-heading_small"},[e._v("Paste Items Below")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-p-bottom_x-small"},[s("h3",{staticClass:"slds-text-heading_small"},[e._v("Formatting Guidelines")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex-row slds-p-bottom--medium"},[s("div",{staticClass:"width-50percent slds-p-right--xx-small"},[s("div",[e._v("Comma")]),e._v(" "),s("div",{staticClass:"slds-box slds-theme_shade"},[s("p",{staticClass:"slds-text-body_small slds-text-color_weak"},[e._v("28205, 28206, 28207"),s("br"),s("br")])])]),e._v(" "),s("div",{staticClass:"width-50percent slds-p-left--xx-small"},[s("div",[e._v("Line Break")]),e._v(" "),s("div",{staticClass:"slds-box slds-theme_shade"},[s("p",{staticClass:"slds-text-body_small slds-text-color_weak"},[e._v("28205"),s("br"),e._v(" 28206"),s("br"),e._v(" 28207")])])])])}],!1,null,null,null).exports,f={components:{Picklist:c.Gp,Tooltip:c.u,TextInput:c.oi},directives:{"click-outside":i.Z},data:()=>({filterStyleObj:{left:"0px",bottom:"10px"},filterSearchTimeout:null}),computed:{clickOutsideFilterResults(){return{active:!0,handler:this.closeFilterResults}},...(0,l.mapState)("shapeBuilder",{builder__country:"country",builder__level:"level",builder__filters:"filters",builder__filterFields:"filterFields",builer__activeFilterId:"activeFilterId"})},methods:{...(0,l.mapMutations)("shapeBuilder",{builder__resetFilters:"resetFilters",builder__removeFilters:"removeFilters",builder__addFilter:"addFilter",builder__setFilterFields:"setFilterFields",builder__setActiveFilterId:"setActiveFilterId"}),buildFilter(){const e={field:"",label:"",type:"string",pills:[],operator:"",guid:(0,a.x$)(),searchTerm:"",result:[],showResults:!1,active:!1,searchLoading:!1,filterOperators:[],isValid:!1,min:"",max:"",isDirty:!0};if(this.builder__filterFields.length){const[t]=this.builder__filterFields;e.field=t.id,this.updateFilterSearchCriteria(e),this.builder__addFilter(e),this.showFilterEditMode(e)}else this.$emit("update-loading",!0),d(!0,this.builder__country,this.builder__level).then((t=>{this.setFilterFields(t);const[s]=this.builder__filterFields;e.field=s.id,this.updateFilterSearchCriteria(e),this.builder__addFilter(e),this.showFilterEditMode(e)})).finally((()=>{this.$emit("update-loading",!1)}))},removeFilter(e){this.builder__removeFilters([e]),this.closeFilterEditMode(),this.$nextTick((()=>{this.$emit("update-selections")}))},closeFilterEditMode(){this.builder__setActiveFilterId("")},showFilterEditMode(e){this.builder__setActiveFilterId(e.guid),this.$nextTick((()=>{const{$refs:t}=this,s=t[`filter_${e.guid}`],[l]=s,a=l.getBoundingClientRect(),{width:i}=a;this.filterStyleObj.left=`${i+25}px`}))},setFilterFields(e){const[t]=e;if(t){const{levels:e=[]}=t,[s]=e,l=[];s&&(s.fields.forEach((e=>{l.push(e)})),this.builder__setFilterFields(l))}},updateFilterSearchCriteria(e){const t=e.field,s=this.builder__filterFields.find((e=>e.id===t));e.label=s.label;const l=s.filter_as;e.filterOperators="decimal"===l?[{label:"equals"},{label:"less than"},{label:"greater than"},{label:"less or equal"},{label:"greater or equal"},{label:"not equal to"}]:[{label:"contains"},{label:"equals"},{label:"not equal to"},{label:"starts with"},{label:"does not contain"}];const[a]=e.filterOperators;e.operator=a.label,e.type=l,e.isDirty=!0,e.min="",e.pills=[],e.isValid=!1},filterString(e){const{pills:t=[]}=e;return t.map((e=>e.label)).join(", ")},removeFilterPill(e,t){e.pills=e.pills.filter((e=>e.value!==t.value)),e.isDirty=!0,e.isValid=!1,e.pills.length&&(e.isValid=!0)},runFilterSearch(){this.closeFilterEditMode(),this.$nextTick((()=>{this.$emit("update-selections")}))},debounceFilterSearch(e){if(null!==this.filterSearchTimeout&&clearTimeout(this.filterSearchTimeout),e.searchTerm.length<2)return e.results=[],void(e.searchLoading=!1);e.searchLoading=!0,this.filterSearchTimeout=setTimeout((()=>{var t,s,l,a;this.filterSearchTimeout=null,e.showResults=!0,(t=this.builder__country,s=this.builder__level,l=e.field,a=e.searchTerm,new Promise(((e,i)=>{const o={overlay:t,level:s,field:l,searchterm:a};(new r.Z).setAction("maps.RemoteFunctions.MapAnythingIORequest").setErrorHandler((e=>{console.warn("Failed to get fields related to selected level",e),i(new Error("Failed to get fields related to selected level"))})).invoke([{subType:"boundary",action:"autocomplete",version:"1"},o],(t=>{const{success:s=!1,data:l={}}=t;if(s){const t=l.data;e(t)}else console.warn("Failed to get fields related to selected level",t),i(new Error("Failed to get fields related to selected level"))}),{escape:!1,buffer:!1})}))).then((t=>{e.results=t,e.results.unshift({id:"searchTerm",value:e.searchTerm,label:e.searchTerm})})).finally((()=>{e.searchLoading=!1}))}),500)},showFilterResults(e){e.showResults=!0},closeFilterResults(e){let t=!0;try{e.srcElement.className.indexOf("filter-search")>0&&(t=!1)}catch(e){}t&&this.builder__filters.forEach((e=>{e.showResults=!1}))},addFilterPill(e,t){e.pills.push(t),e.showResults=!1,e.searchTerm="",e.results=[],e.isDirty=!0,e.isValid=!0},cancelFilterCheck(e){let t=!0;""===e.field&&(t=!1),""===e.operator&&(t=!1),e.pills.length||(t=!1),t?this.closeFilterEditMode():this.removeFilter(e.guid)},removeAllFilters(){const e=this.builder__filters.map((e=>e.guid));this.builder__removeFilters(e),this.closeFilterEditMode(),this.$nextTick((()=>{this.$emit("update-selections")}))}}},y=(0,h.Z)(f,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.builder__level,expression:"builder__level != ''"}]},[s("div",{staticClass:"slds-filters"},[s("h3",{staticClass:"slds-text-body_small slds-m-vertical_x-small slds-form-element__label"},[e._v("Matching all these filters")]),e._v(" "),s("ol",{staticClass:"slds-list_vertical slds-list_vertical-space filterListItem"},e._l(e.builder__filters,(function(t,l){return s("li",{key:l,ref:"filter_"+t.guid,refInFor:!0,staticClass:"slds-item slds-hint-parent filter-list-item js-filter-2"},[s("div",{staticClass:"slds-filters__item slds-grid slds-grid_vertical-align-center slds-is-relative filter-item"},[s("button",{staticClass:"slds-button_reset slds-grow slds-has-blur-focus",attrs:{href:"javascript:void(0);"},on:{click:function(s){return e.showFilterEditMode(t)}}},[""===t.field||""===t.operator?s("div",[e._v("New Filter")]):s("div",{staticClass:"filter-content-complete"},[s("p",{staticClass:"slds-text-body_small field-label"},[e._v(e._s(t.label)+" ")]),e._v(" "),s("p",{staticClass:"filters-from-pills"},[e._v(e._s(t.operator)+" "+e._s(e.filterString(t)))])])]),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-button_icon slds-button_icon-small js-remove-filter-item",on:{click:function(s){return e.removeFilter(t.guid)}}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-remove slds-filters__item-remove-button remove-filter-item"})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.builer__activeFilterId===t.guid,expression:"builer__activeFilterId === filter.guid"}],staticClass:"slds-filters__item-popover slds-filters__item-popover-positioner-left-bottom",style:e.filterStyleObj},[s("section",{staticClass:"slds-popover slds-popover_panel slds-nubbin_left-bottom slds-popover_large"},[s("div",{staticClass:"slds-p-around--small filter-form-container",attrs:{"field-datatype":"string"}},[s("div",{staticClass:"js-shape-filter-wrapper"},[s("div",{staticClass:"slds-form slds-form_stacked"},[s("Picklist",{staticClass:"slds-m-bottom_small",attrs:{options:e.builder__filterFields,required:"",labels:{name:"Field",placeholder:e.$Labels.MA_Select_an_Option},idKey:"id",titleKey:"label"},on:{changed:function(s){return e.updateFilterSearchCriteria(t)}},model:{value:t.field,callback:function(s){e.$set(t,"field",s)},expression:"filter.field"}}),e._v(" "),s("Picklist",{staticClass:"slds-m-bottom_small",attrs:{options:t.filterOperators,required:"",labels:{name:"Operator",placeholder:e.$Labels.MA_Select_an_Option},idKey:"label",titleKey:"label"},model:{value:t.operator,callback:function(s){e.$set(t,"operator",s)},expression:"filter.operator"}}),e._v(" "),s("div",{staticClass:"slds-form-element"},["decimal"===t.type?s("div",[s("TextInput",{attrs:{type:"number",labels:{name:"Value"}},model:{value:t.min,callback:function(s){e.$set(t,"min",s)},expression:"filter.min"}})],1):s("div",[s("label",{staticClass:"slds-form-element__label string-label"},[e._v("Value")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchTerm,expression:"filter.searchTerm"}],staticClass:"slds-input min filter-search",attrs:{type:"text"},domProps:{value:t.searchTerm},on:{input:[function(s){s.target.composing||e.$set(t,"searchTerm",s.target.value)},function(s){return e.debounceFilterSearch(t)}],focus:function(s){return e.showFilterResults(t)}}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showResults,expression:"filter.showResults"},{name:"click-outside",rawName:"v-click-outside:[clickOutsideFilterResults]",arg:e.clickOutsideFilterResults}],staticClass:"slds-dropdown slds-dropdown_left slds-is-absolute",staticStyle:{"min-height":"100px","max-height":"500px",width:"100%",overflow:"auto"}},[s("ul",{staticClass:"slds-dropdown__list",attrs:{role:"menu"}},[s("li",{directives:[{name:"show",rawName:"v-show",value:t.searchTerm.length<2,expression:"filter.searchTerm.length < 2"}]},[s("div",{staticClass:"slds-text-align_center"},[s("div",{staticClass:"slds-p-top_large"},[s("Icon",{attrs:{category:"utility",name:"info",size:"small"}})],1),e._v(" "),s("div",{staticClass:"slds-text-color_weak"},[e._v("\n                                                                    "+e._s(e.$Labels.MA_char_search)+"\n                                                                ")])])]),e._v(" "),e._l(t.results,(function(l,a){return s("li",{key:a,staticClass:"slds-dropdown__item filter-line-item",attrs:{"data-label":l.label,"data-value":l.value,role:"presentation"},on:{click:function(s){return s.stopPropagation(),e.addFilterPill(t,l)}}},[s("a",{attrs:{href:"javascript:void(0);",role:"menuitem"}},[s("span",{staticClass:"slds-truncate filter-dropdown-item",attrs:{title:l.label}},["searchTerm"===l.id?s("Icon",{attrs:{category:"utility",name:"search",size:"xx-small"}}):e._e(),e._v("\n                                                                    "+e._s(e._f("decode")(l.label))+"\n                                                                ")],1)])])}))],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.searchLoading,expression:"filter.searchLoading"}],staticClass:"slds-spinner_container",staticStyle:{left:"1px",top:"1px",height:"calc(100% - 2px)",width:"calc(100% - 2px)","border-radius":"0px 0px 4px 4px",display:"block"}},[e._m(0,!0)])]),e._v(" "),s("div",{staticClass:"slds-p-top--xx-small filter-item-pills"},e._l(t.pills,(function(l,a){return s("span",{key:a,staticClass:"filter-pill slds-pill slds-pill_link"},[s("a",{staticClass:"slds-pill__action",attrs:{href:"javascript:void(0);",title:l.label}},[s("span",{staticClass:"slds-pill__label filter-pill-value"},[e._v(e._s(l.label))])]),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-button_icon slds-pill__remove js-remove-pill",attrs:{title:"Remove"},on:{click:function(s){return s.stopPropagation(),e.removeFilterPill(t,l)}}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-remove remove-filter-pill"})])])})),0)])])],1),e._v(" "),s("div",{staticClass:"slds-p-top--medium"},[s("div",{staticClass:"flex-row"},[s("div",{staticClass:"flex-grow-1"}),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isDirty&&t.isValid&&"decimal"!==t.type},on:{click:function(s){return e.cancelFilterCheck(t)}}},[e._v("\n                                                    "+e._s(e.$Labels.MA_Cancel)+"\n                                                ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!t.isValid&&"decimal"!==t.type},on:{click:e.runFilterSearch}},[e._v("\n                                                    "+e._s(e.$Labels.MapsSetting_Update)+"\n                                                ")])])])])])])])])])])})),0)]),e._v(" "),s("div",{staticClass:"slds-filters__footer slds-p-around--none slds-p-vertical--medium flex-row"},[s("div",{directives:[{name:"show",rawName:"v-show",value:""===e.builer__activeFilterId,expression:"builer__activeFilterId === ''"}],staticClass:"slds-is-relative"},[s("Tooltip",[s("p",[e._v("Let’s filter down what ZIP Codes you want to see."),s("br"),s("br"),e._v(" e.g. I want to see ZIP Codes filtered by "),s("strong",[e._v('County equals "Mecklenburg, NC"')]),e._v(".")])]),e._v(" "),s("button",{staticClass:"slds-button_reset slds-text-link",on:{click:e.buildFilter}},[e._v("\n                Add Filter\n            ")])],1),e._v(" "),s("div",{staticClass:"flex-grow-1"}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.builder__filters.length,expression:"builder__filters.length"}]},[s("button",{staticClass:"slds-button_reset slds-text-link slds-col_bump-left remove-all-shape-filters",on:{click:e.removeAllFilters}},[e._v("\n                Remove All\n            ")])])])])}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-spinner slds-spinner_medium slds-spinner_brand",attrs:{role:"status"}},[s("span",{staticClass:"slds-assistive-text"},[e._v("Loading")]),e._v(" "),s("div",{staticClass:"slds-spinner__dot-a"}),e._v(" "),s("div",{staticClass:"slds-spinner__dot-b"})])}],!1,null,null,null).exports,g={components:{Button:c.zx,Picklist:c.Gp,Tooltip:c.u,ZipImport:b,Filters:y},props:{isLoading:{type:Boolean,default:!1},showDrawOnMap:{type:Boolean,default:!1}},data:()=>({availableOverlaysHolder:[],availableOverlays:[],selectedOverlaysHolder:[],countryOptions:[],iWantToSeeOptions:[],returnLimit:5e3,tooManyOverlays:!0,showZipImportScreen:!1}),computed:{selectedCountryData(){const e=this.countryOptions.find((e=>e.id===this.country));let t={};return e&&(t=e),t},overlayZipImportInfo(){const e={support:!1,levels:[]},{zip_postal_levels:t=[],zip_supported:s=!1,levels:l=[]}=this.selectedCountryData;return s&&(e.support=!0,e.levels=l.filter((e=>t.includes(e.id)))),e},country:{get(){return this.$store.state.shapeBuilder.country},set(e){this.builder__updateCountry(e)}},level:{get(){return this.$store.state.shapeBuilder.level},set(e){this.builder__updateLevel(e)}},...(0,l.mapState)("shapeBuilder",{builder__selectedOverlays:"selectedOverlays",builder__filters:"filters",builder__availableOverlays:"availableOverlays"})},created(){this.setLoadingStatus(!0),d().then((e=>{this.setCountryOptions(e),this.setIWantToSeePicklist()})).catch((e=>{this.showError(e.message),this.$emit("close")})).finally((()=>{this.setLoadingStatus(!1)}))},methods:{...(0,l.mapGetters)("shapeBuilder",{builder__formattedFilters:"formattedFilters"}),...(0,l.mapMutations)("shapeBuilder",{builder__updateSelectedOverlays:"updateSelectedOverlays",builder__updateCountry:"updateCountry",builder__updateLevel:"updateLevel",builder__resetFilters:"resetFilters",builder__toggleDrawOnMap:"toggleDrawOnMap",builder__removeFilters:"removeFilters",builder__updateAvailableOverlays:"updateAvailableOverlays"}),showError(e){window.MAToastMessages.showError({message:this.$Labels.MA_Error,subMessage:e,timeOut:0,extendedTimeOut:0,closeButton:!0})},clearPreviousPreviousOverlaySelections(){this.availableOverlaysHolder=[],this.builder__updateAvailableOverlays([]),this.tooManyOverlays=!0,this.builder__resetFilters()},updateIWantToSeePicklistOptions(){this.level="",this.setIWantToSeePicklist(),this.clearPreviousPreviousOverlaySelections()},updateOverlaySelections(e=!1){this.setLoadingStatus(!0),e&&this.clearPreviousPreviousOverlaySelections(),this.getSelectedInformation().then((e=>{e.length>this.returnLimit?this.tooManyOverlays=!0:(this.tooManyOverlays=!1,this.setAvailableOverlay(e))})).catch((e=>{this.showError(e.message)})).finally((()=>{this.setLoadingStatus(!1)}))},selectAllAvailable(){const{$refs:e}=this,{availableOptions:t}=e;t&&Array.from(t.options).forEach((e=>{this.availableOverlaysHolder.push(e.value)}))},unselectAllAvailable(){this.availableOverlaysHolder=[]},selectAllSelected(){const{$refs:e}=this,{selectedOptions:t}=e;t&&Array.from(t.options).forEach((e=>{this.selectedOverlaysHolder.push(e.value)}))},unselectAllSelected(){this.selectedOverlaysHolder=[]},removeAllSelected(){const{$refs:e}=this,{selectedOptions:t}=e;t&&(Array.from(t.options).forEach((e=>{this.selectedOverlaysHolder.push(e.value)})),this.removeSelectedShapes(),this.selectedOverlaysHolder=[])},addSelectedShapes(){const e=this.level,t=this.builder__availableOverlays.reduce(((e,t,s)=>(e[t.value]=s,e)),{}),s=this.builder__selectedOverlays.reduce(((e,t,s)=>(e[t.value]=s,e)),{}),l=this.availableOverlaysHolder;let i=l.length;const o=[],r=this.builder__availableOverlays;for(;i--;){const n=l[i];let d=!1;const c=s[n];this.builder__selectedOverlays[c]&&(d=!0);const u=t[n];if(!d){const t=this.builder__availableOverlays[u];t&&(t.level=e,t.active=!0,t.plotted=!1,t.guid=(0,a.x$)(),o.push(t))}r.splice(u,1)}const n=[...this.builder__selectedOverlays,...o];this.availableOverlaysHolder=[],this.selectedOverlaysHolder=[],this.builder__updateAvailableOverlays(r),this.builder__updateSelectedOverlays(n)},removeSelectedShapes(){const e=this.level,t=this.availableOverlays.reduce(((e,t,s)=>(e[t.value]=s,e)),{}),s=this.builder__selectedOverlays.reduce(((e,t,s)=>(e[t.value]=s,e)),{}),l=this.selectedOverlaysHolder;let a=l.length;const[i]=this.builder__availableOverlays;let o="";if(i){const e=i.value.split("-");[o]=e}const r=this.builder__selectedOverlays,n=[];for(;a--;){const i=l[a],d=s[i],c=this.builder__selectedOverlays[d],{level:u}=c;let p=!1;if(!this.tooManyOverlays&&u===e){const e=c.value.split("-")[0];if(0===this.builder__availableOverlays.length||o===e){const e=t[i];this.builder__availableOverlays[e]||(p=!0)}}p&&n.push(c),r.splice(d,1)}this.availableOverlaysHolder=[],this.selectedOverlaysHolder=[],this.builder__updateSelectedOverlays(r),this.builder__updateAvailableOverlays([...this.builder__availableOverlays,...n])},upateSelectedWithUserImport(e){const t=this.builder__selectedOverlays,s=t.length,l=e.length,a=[];for(let i=0;i<l;i++){const l=e[i],o=l.value;let r=!1;for(let e=0;e<s;e++)if(o===t[e].value){r=!0;break}r||a.push(l)}const i=[...this.builder__selectedOverlays,...a];this.builder__updateSelectedOverlays(i)},getSelectedInformation(e=!1){return new Promise(((t,s)=>{this.returnLimit=5e3,(0===this.builder__filters.length||e)&&(e=!0,this.returnLimit=500);const l=this.builder__formattedFilters(e),{valid:a=[],invalid:i=[]}=l;i.length&&(this.builder__removeFilters(i),window.MAToastMessages.showWarning({message:"Filter Warning",subMessage:`${i.length} invalid filter(s) automatically removed`,timeOut:6e3})),n(this.country,this.level,a).then((e=>{t(e)})).catch((()=>{s(new Error("Failed to get overlay information related to selected level"))}))}))},setLoadingStatus(e){this.$emit("update-loading",e)},setCountryOptions(e){this.countryOptions=e},setIWantToSeePicklist(){const{levels:e=[]}=this.selectedCountryData;this.iWantToSeeOptions=e},setAvailableOverlay(e){this.builder__updateAvailableOverlays(e)},doShowDrawOnMap(){this.builder__toggleDrawOnMap(!0)}}},w=(0,h.Z)(g,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{"overflow-y":"scroll","overflow-x":"hidden"}},[s("div",{staticClass:"slds-grid slds-p-bottom_x-small"},[e._m(0),e._v(" "),s("Button",{directives:[{name:"show",rawName:"v-show",value:""!=e.level,expression:"level != ''"}],staticClass:"js-show-shape-builder-drawing-mode",attrs:{variant:"neutral"},on:{click:e.doShowDrawOnMap}},[s("div",{staticClass:"slds-button__icon slds-button__icon--left ma-icon ma-icon-lasso"}),e._v("\n            Draw on Map\n        ")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.overlayZipImportInfo.support,expression:"overlayZipImportInfo.support"}]},[s("Button",{staticClass:"slds-m-left_x-small",attrs:{variant:"neutral",label:"Paste Zip Codes",iconCategory:"utility",iconName:"paste"},on:{click:function(t){e.showZipImportScreen=!e.showZipImportScreen}}}),e._v(" "),e.showZipImportScreen?s("ZipImport",{attrs:{zipImportData:e.overlayZipImportInfo,showZipImportScreen:e.showZipImportScreen},on:{"update:showZipImportScreen":function(t){e.showZipImportScreen=t},"update:show-zip-import-screen":function(t){e.showZipImportScreen=t},"update-user-entry":e.upateSelectedWithUserImport}}):e._e()],1)],1),e._v(" "),s("div",{staticClass:"slds-grid slds-gutters slds-border_top slds-p-top_x-small"},[s("div",{staticClass:"slds-col slds-size_1-of-3"},[s("div",{staticClass:"slds-form slds-form--stacked slds-m-bottom--x-small"},[s("Picklist",{staticClass:"slds-m-bottom_small",attrs:{options:e.countryOptions,filterable:"",required:"",labels:{name:"Country",placeholder:e.$Labels.MA_Select_an_Option},titleKey:"label"},on:{changed:e.updateIWantToSeePicklistOptions},model:{value:e.country,callback:function(t){e.country=t},expression:"country"}}),e._v(" "),s("div",[s("Tooltip",{staticClass:"slds-m-top_xx-small"},[s("p",[e._v("Select what shape type you want to see on the map."),s("br"),s("br"),e._v(" e.g. I want to see "),s("strong",[e._v("ZIP Codes")]),e._v(".")])]),e._v(" "),s("Picklist",{staticClass:"slds-m-bottom_small",attrs:{options:e.iWantToSeeOptions,filterable:"",required:"",labels:{name:"I Want To See...",placeholder:e.$Labels.MA_Select_an_Option},titleKey:"label_plural"},on:{changed:function(t){return e.updateOverlaySelections(!0)}},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}})],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.level,expression:"level != ''"}],staticClass:"slds-p-bottom--medium",attrs:{id:"shapeBuilderFiltersDrawOnMapWrap"}},[s("button",{staticClass:"slds-button slds-button--neutral js-show-shape-builder-drawing-mode",on:{click:e.doShowDrawOnMap}},[s("div",{staticClass:"slds-button__icon slds-button__icon--left ma-icon ma-icon-lasso"}),e._v("\n                    Draw on Map\n                ")])]),e._v(" "),s("Filters",{on:{"update-loading":e.setLoadingStatus,"update-selections":function(t){return e.updateOverlaySelections(!1)}}})],1),e._v(" "),s("div",{staticClass:"slds-col slds-size_1-of-3 slds-border_right",staticStyle:{position:"relative"}},[s("div",{staticClass:"slds-grid slds-grid_vertical"},[s("div",{staticClass:"slds-col"},[e._v("Available Shapes")]),e._v(" "),s("div",{staticClass:"slds-col"},[s("div",{staticClass:"slds-p-around_x-small slds-border_left slds-border_right slds-border_top"},[e._v("\n                        Select "),s("a",{attrs:{href:"javascript:void(0);"},on:{click:e.selectAllAvailable}},[e._v("All")]),e._v(" / "),s("a",{attrs:{href:"javascript:void(0);"},on:{click:e.unselectAllAvailable}},[e._v("None")])]),e._v(" "),s("div",[e.tooManyOverlays?s("div",{staticClass:"slds-p-around_large slds-border_left slds-border_right slds-border_top slds-border_bottom",staticStyle:{"overflow-y":"auto",height:"calc( 100vh - 400px)"}},[s("div",{staticClass:"slds-text-align_center"},[s("div",{staticClass:"slds-p-bottom_medium"},[s("Icon",{attrs:{category:"utility",name:"info",size:"small"}})],1),e._v(" "),s("div",{staticClass:"slds-text-color_weak"},[e._v("\n                                    The shape type you want to see returns a large number of results. Please add a filter to narrow down the available shapes.\n                                ")])])]):s("select",{directives:[{name:"model",rawName:"v-model",value:e.availableOverlaysHolder,expression:"availableOverlaysHolder"}],ref:"availableOptions",staticClass:"slds-select",staticStyle:{"overflow-y":"auto",height:"calc( 100vh - 400px)"},attrs:{size:"50",multiple:""},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.availableOverlaysHolder=t.target.multiple?s:s[0]}}},e._l(e.builder__availableOverlays,(function(t,l){return s("option",{key:l,staticClass:"slds-truncate",attrs:{"data-level":2},domProps:{value:t.value}},[e._v("\n                                "+e._s(e._f("decode")(t.label))+"\n                            ")])})),0)])])]),e._v(" "),s("div",{staticStyle:{position:"absolute",right:"-17px",top:"105px"}},[s("div",{staticClass:"flex-column"},[s("div",{staticClass:"slds-p-bottom--medium"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-border slds-button_icon-border-filled",on:{click:e.addSelectedShapes}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-right"})])]),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-border slds-button_icon-border-filled",on:{click:e.removeSelectedShapes}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-left"})])])])])]),e._v(" "),s("div",{staticClass:"slds-col"},[s("div",{staticClass:"slds-grid slds-grid_vertical"},[s("div",{staticClass:"slds-col"},[e._v("Selected Shapes")]),e._v(" "),s("div",{staticClass:"slds-col"},[s("div",{staticClass:"slds-p-around_x-small slds-border_left slds-border_right slds-border_top"},[e._v("\n                        Select "),s("a",{attrs:{href:"javascript:void(0);"},on:{click:e.selectAllSelected}},[e._v("All")]),e._v(" / "),s("a",{attrs:{href:"javascript:void(0);"},on:{click:e.unselectAllSelected}},[e._v("None")]),e._v(" "),s("a",{staticClass:"slds-float_right",attrs:{href:"javascript:void(0);"},on:{click:e.removeAllSelected}},[e._v("Clear")])]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedOverlaysHolder,expression:"selectedOverlaysHolder"}],ref:"selectedOptions",staticClass:"slds-select",staticStyle:{"overflow-y":"auto",height:"calc( 100vh - 400px)"},attrs:{size:"50",multiple:"multiple"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedOverlaysHolder=t.target.multiple?s:s[0]}}},e._l(e.builder__selectedOverlays,(function(e,t){return s("option",{key:t,staticClass:"slds-truncate",attrs:{label:e.label},domProps:{value:e.value}})})),0)])])])])])}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-col_bump-right slds-m-top--x-small"},[s("h3",{staticClass:"slds-text-heading_small"},[e._v("Shape Selection")])])}],!1,null,null,null).exports,O={components:{ChromePicker:s(4023).Chrome,TextInput:c.oi},directives:{"click-outside":i.Z},props:{color:{type:String,required:!0},label:{type:String,default:"Color"}},data:()=>({selectedColor:{hex:"#00FF00"},colorTimeout:null,showPicker:!1,colorPickerStyle:{top:"0px",left:"0px",bottom:null}}),computed:{clickOutsideColor(){return{active:!0,handler:this.closeColorPicker}}},created(){this.selectedColor.hex=this.color},mounted(){this.setInputBackgroundColor(this.color)},methods:{toggleColorPicker(){this.$nextTick((()=>{const{$refs:e}=this,{colorPickerInput:t}=e;if(t){const{$el:e}=t,s=e.getBoundingClientRect(),{top:l,height:a,left:i}=s,o=a+l;this.colorPickerStyle.top=`${o}px`;const r=i-50;this.colorPickerStyle.left=`${r}px`,this.colorPickerStyle.bottom=null}this.showPicker=!this.showPicker,this.$nextTick(this.setInputBackgroundColor.bind(this,this.selectedColor.hex))}))},closeColorPicker(){this.showPicker=!1,this.$nextTick((()=>{this.setInputBackgroundColor(this.selectedColor.hex)}))},setInputBackgroundColor(e){this.checkColorOffScreen();const{$refs:t}=this;if(t.colorPickerInput){this.selectedColor.hex=e;const s=t.colorPickerInput,{$el:l}=s;l.querySelector("input").style.backgroundColor=e,this.$emit("update:color",e)}},checkColorOffScreen(){const e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t=this.$refs.colorPicker;if(t){const{$el:s}=t,l=s.getBoundingClientRect(),{bottom:a}=l;a>e&&(this.colorPickerStyle.bottom="0",this.colorPickerStyle.top=null)}},updateValue(e){null!==this.colorTimeout&&clearTimeout(this.colorTimeout),this.colorTimeout=setTimeout((()=>{const{hex:t}=e;this.setInputBackgroundColor(t)}),100)}}},C=(0,h.Z)(O,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("TextInput",{ref:"colorPickerInput",staticClass:"color-input",attrs:{labels:{name:e.$props.label},type:"text"},on:{click:e.toggleColorPicker},model:{value:e.color,callback:function(t){e.color=t},expression:"color"}}),e._v(" "),e.showPicker?s("ChromePicker",{directives:[{name:"click-outside",rawName:"v-click-outside:[clickOutsideColor]",arg:e.clickOutsideColor}],ref:"colorPicker",staticClass:"color-picker",style:e.colorPickerStyle,attrs:{value:e.selectedColor.hex,disableAlpha:!0},on:{input:e.updateValue},model:{value:e.selectedColor,callback:function(t){e.selectedColor=t},expression:"selectedColor"}}):e._e()],1)}),[],!1,null,"53b732ad",null).exports,S={components:{Picklist:c.Gp,Checkbox:c.XZ,InputColorPicker:C,TextInput:c.oi},data:()=>({opacityOptions:[{label:"10%",value:"0.1"},{label:"20%",value:"0.2"},{label:"30%",value:"0.3"},{label:"40%",value:"0.4"},{label:"50%",value:"0.5"},{label:"60%",value:"0.6"},{label:"70%",value:"0.7"},{label:"80%",value:"0.8"},{label:"90%",value:"0.9"},{label:"100%",value:"1"}],justificationOptions:[{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}],fontOptions:[{label:"8px",value:"8px"},{label:"9px",value:"9px"},{label:"10px",value:"10px"},{label:"11px",value:"11px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"17px",value:"17px"},{label:"18px",value:"18px"}],colorPickerStyle:{top:"0px",left:"0px"},activeColorPicker:""}),computed:{...(0,l.mapState)("shapeBuilder",{builder__shape:"shape"}),shapeOptions(){return this.builder__shape.maps__Options__c}}},x=(0,h.Z)(S,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{width:"500px"}},[s("div",{staticClass:"slds-grid slds-p-bottom_x-small"},[s("div",{staticClass:"slds-col_bump-right slds-m-top--x-small"},[s("h3",{staticClass:"slds-text-heading_small"},[e._v(e._s(e.$Labels.Context_Shape_Options))])])]),e._v(" "),s("div",{staticClass:"slds-border_top slds-p-top_x-small"},[s("InputColorPicker",{attrs:{label:e.$Labels.TerritoryBuilder_Fill_Color,color:e.shapeOptions.colorOptions.fillColor},on:{"update:color":function(t){return e.$set(e.shapeOptions.colorOptions,"fillColor",t)}}}),e._v(" "),s("InputColorPicker",{attrs:{label:e.$Labels.TerritoryBuilder_Border_Color,color:e.shapeOptions.colorOptions.borderColor},on:{"update:color":function(t){return e.$set(e.shapeOptions.colorOptions,"borderColor",t)}}}),e._v(" "),s("Picklist",{staticClass:"slds-m-bottom_small",attrs:{options:e.opacityOptions,labels:{name:"Opacity"},idKey:"value",titleKey:"label"},model:{value:e.shapeOptions.colorOptions.fillOpacity,callback:function(t){e.$set(e.shapeOptions.colorOptions,"fillOpacity",t)},expression:"shapeOptions.colorOptions.fillOpacity"}})],1),e._v(" "),s("div",{staticClass:"slds-grid slds-p-bottom_x-small"},[s("div",{staticClass:"slds-col_bump-right slds-m-top--x-small"},[s("h3",{staticClass:"slds-text-heading_small"},[e._v(e._s(e.$Labels.TerritoryBuilder_Label_Options))])])]),e._v(" "),s("div",{staticClass:"slds-border_top slds-p-top_x-small"},[s("Checkbox",{staticClass:"flex-row slds-form-element",attrs:{labels:{name:"Enable Label"}},model:{value:e.shapeOptions.colorOptions.labelEnabled,callback:function(t){e.$set(e.shapeOptions.colorOptions,"labelEnabled",t)},expression:"shapeOptions.colorOptions.labelEnabled"}}),e._v(" "),s("TextInput",{attrs:{type:"text",labels:{name:"Label Text Override"}},model:{value:e.shapeOptions.colorOptions.labelOverride,callback:function(t){e.$set(e.shapeOptions.colorOptions,"labelOverride",t)},expression:"shapeOptions.colorOptions.labelOverride"}}),e._v(" "),s("Picklist",{staticClass:"slds-m-bottom_small",attrs:{options:e.justificationOptions,labels:{name:"Justification"},idKey:"value",titleKey:"label"},model:{value:e.shapeOptions.colorOptions.labelJustification,callback:function(t){e.$set(e.shapeOptions.colorOptions,"labelJustification",t)},expression:"shapeOptions.colorOptions.labelJustification"}}),e._v(" "),s("Picklist",{staticClass:"slds-m-bottom_small",attrs:{options:e.fontOptions,labels:{name:"Font Size"},idKey:"value",titleKey:"label"},model:{value:e.shapeOptions.colorOptions.labelFontSize,callback:function(t){e.$set(e.shapeOptions.colorOptions,"labelFontSize",t)},expression:"shapeOptions.colorOptions.labelFontSize"}}),e._v(" "),s("InputColorPicker",{attrs:{label:e.$Labels.TerritoryBuilder_Label_FontColor,color:e.shapeOptions.colorOptions.labelFontColor},on:{"update:color":function(t){return e.$set(e.shapeOptions.colorOptions,"labelFontColor",t)}}}),e._v(" "),s("InputColorPicker",{attrs:{label:e.$Labels.TerritoryBuilder_Label_BGColor,color:e.shapeOptions.colorOptions.labelBGColor},on:{"update:color":function(t){return e.$set(e.shapeOptions.colorOptions,"labelBGColor",t)}}}),e._v(" "),s("Picklist",{staticClass:"slds-m-bottom_small",attrs:{options:e.opacityOptions,labels:{name:"Background Opacity"},idKey:"value",titleKey:"label"},model:{value:e.shapeOptions.colorOptions.labelBGOpacity,callback:function(t){e.$set(e.shapeOptions.colorOptions,"labelBGOpacity",t)},expression:"shapeOptions.colorOptions.labelBGOpacity"}})],1),e._v(" "),s("div",{staticClass:"slds-grid slds-p-bottom_x-small"},[s("div",{staticClass:"slds-col_bump-right slds-m-top--x-small"},[s("h3",{staticClass:"slds-text-heading_small"},[e._v(e._s(e.$Labels.MA_Advanced_Options))])])]),e._v(" "),s("div",{staticClass:"slds-border_top slds-p-top_x-small"},[s("Checkbox",{staticClass:"flex-row slds-form-element",attrs:{labels:{name:e.$Labels.MA_Dissolve_Geometry}},model:{value:e.shapeOptions.advancedOptions.dissolveGeometry,callback:function(t){e.$set(e.shapeOptions.advancedOptions,"dissolveGeometry",t)},expression:"shapeOptions.advancedOptions.dissolveGeometry"}}),e._v(" "),s("Checkbox",{staticClass:"flex-row slds-form-element",attrs:{labels:{name:e.$Labels.LayersTab_Shape_Display_OnlyShowMarkersInside}},model:{value:e.shapeOptions.advancedOptions.affectVisibility,callback:function(t){e.$set(e.shapeOptions.advancedOptions,"affectVisibility",t)},expression:"shapeOptions.advancedOptions.affectVisibility"}})],1)])}),[],!1,null,null,null).exports;var k=s(5735),M=s.n(k);const L={props:{searchResult:{type:Object,default:()=>{}}},data:()=>({dateTime:new Date}),computed:{searchItem(){const e=this.searchResult,t=window.getProperty(e||{},"geometry.location",!1);let s=null;return null!==t&&(s={id:e.id||this.dateTime.getTime(),address:e.formatted_address||"N/A",label:e.name||"N/A",placeId:e.place_id,coordinates:t}),s},isValid(){return null!==this.searchItem}},methods:{selected(){this.$emit("selected",this.searchItem)}}},P={components:{LassoSearchResult:(0,h.Z)(L,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isValid?s("li",{staticClass:"slds-listbox__item",attrs:{role:"presentation"},on:{click:e.selected}},[s("div",{staticClass:"slds-media slds-is-relative slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta",attrs:{role:"option"}},[e._m(0),e._v(" "),s("span",{staticClass:"slds-media__body"},[s("span",{staticClass:"label_info slds-listbox__option-text slds-listbox__option-text_entity"},[e._v(e._s(e.searchItem.label))]),e._v(" "),s("span",{staticClass:"address_info slds-listbox__option-meta slds-listbox__option-meta_entity"},[e._v(e._s(e.searchItem.address))])])])]):e._e()}),[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"slds-media__figure slds-m-left_medium"},[t("span",{staticClass:"slds-icon slds-input__icon slds-input__icon_left slds-icon-text-default ma-icon ma-icon-checkin",attrs:{title:"Description of icon when needed"}})])}],!1,null,null,null).exports},directives:{"click-outside":i.Z},data:()=>({searchIsLoading:!1,placeSearchTerm:"",showSearchResults:!1,placeSearchResults:[],skipSearch:!1,lassoMarkers:[]}),computed:{clickOutsideOptions(){return{active:!0,handler:this.hideSearchResults}},...(0,l.mapState)("shapeBuilder",{builder__showDrawOnMap:"showDrawOnMap"})},watch:{builder__showDrawOnMap(){this.clearSearch()},placeSearchTerm(e,t){this.skipSearch?this.skipSearch=!1:(this.searchIsLoading=!0,e!==t&&e.length>=2?this.debounceSearch(e):(this.placeSearchResults=[],this.showSearchResults=!1,this.searchIsLoading=!1))}},created(){document.getElementById("topRightMapControls").classList.add("refreshLassoIsVisible")},destroyed(){document.getElementById("topRightMapControls").classList.remove("refreshLassoIsVisible"),this.clearSearch()},methods:{focusSearch(){this.placeSearchTerm.length>=2&&setTimeout((()=>{this.showSearchResults=!0}),500)},hideSearchResults(){this.showSearchResults=!1},clearSearch(){this.clearSearchResults(),this.placeSearchTerm=""},processSearchResult(e){this.clearSearchResults();const{coordinates:t}=e,{label:s}=e,{address:l}=e;if(null!==t||void 0!==t){const{map:e}=window.MA,a=new window.google.maps.LatLng(t.lat,t.lng);e.panTo(a);const i=window.getProperty(window.MASystem,"Organization.MAIO_URL",!1),o=new window.google.maps.Marker({position:a,icon:{url:`${i}/images/marker?color=da8175&forlegend=false&icon=Marker2`,anchor:new window.google.maps.Point(10,34),scaledSize:{height:34,width:20}},map:e,title:s||"Lasso Marker"});this.skipSearch=!0,this.placeSearchTerm=s||l,this.lassoMarkers.push(o)}},clearSearchResults(){this.placeSearchResults=[],this.removeLassoSearchMarkers(),this.showSearchResults=!1},debounceSearch(){null!==this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((()=>{this.searchTimeout=null,this.placeSearchTerm.length>=2&&this.filteredGoogleSearch(this.placeSearchTerm)}),500)},filteredGoogleSearch(e){window.MASearch.searchGooglePlaces(e,{radius:5e4}).then((e=>{if(this.searchIsLoading=!1,e&&e.success){const t=window.getProperty(e,"data.results",!1)||[];this.placeSearchResults=t,this.showSearchResults=!0}else this.placeSearchResults=[],this.showSearchResults=!1}))},removeLassoSearchMarkers(){const e=this.lassoMarkers.length;for(let t=0;t<e;t++)this.lassoMarkers[t].setMap(null);this.lassoMarkers=[]}}},A=(0,h.Z)(P,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-form-element",staticStyle:{width:"250px",position:"absolute",right:"334px",top:"9px","z-index":"100"},attrs:{id:"shapeBuilderSearchContainer"}},[s("label",{staticClass:"slds-form-element__label slds-assistive-text",attrs:{for:""}},[e._v("Search")]),e._v(" "),s("div",{staticClass:"slds-form-element__control slds-input-has-icon slds-input-has-icon_left-right"},[s("span",{staticClass:"slds-icon slds-input__icon slds-input__icon_left slds-icon-text-default ma-icon ma-icon-search"}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.placeSearchTerm,expression:"placeSearchTerm"}],staticClass:"slds-input",attrs:{type:"text",placeholder:"Search"},domProps:{value:e.placeSearchTerm},on:{focus:e.focusSearch,input:function(t){t.target.composing||(e.placeSearchTerm=t.target.value)}}}),e._v(" "),s("div",{staticClass:"slds-input__icon-group slds-input__icon-group_right"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.searchIsLoading,expression:"searchIsLoading"}],staticClass:"slds-spinner slds-spinner_brand slds-spinner_x-small",staticStyle:{left:"0px",position:"relative"},attrs:{role:"status"}},[s("span",{staticClass:"slds-assistive-text"},[e._v("Loading")]),e._v(" "),s("div",{staticClass:"slds-spinner__dot-a"}),e._v(" "),s("div",{staticClass:"slds-spinner__dot-b"})]),e._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:!e.searchIsLoading,expression:"!searchIsLoading"}],staticClass:"slds-input__icon slds-input__icon_right slds-button slds-button_icon",on:{click:e.clearSearch}},[s("span",{staticClass:"slds-button__icon slds-icon-text-light ma-icon ma-icon-clear"})])]),e._v(" "),e.showSearchResults?s("div",{directives:[{name:"click-outside",rawName:"v-click-outside:[clickOutsideOptions]",arg:e.clickOutsideOptions}],attrs:{id:"shapeBuilderSearchResults",role:"listbox"}},[s("ul",{staticClass:"slds-listbox slds-listbox_vertical slds-dropdown slds-dropdown_fluid",staticStyle:{"max-height":"375px",overflow:"auto"},attrs:{role:"presentation"}},e._l(e.placeSearchResults,(function(t,l){return s("LassoSearchResult",{key:l,attrs:{searchResult:t},on:{selected:e.processSearchResult}})})),1)]):e._e()])])}),[],!1,null,null,null).exports;let I={};const{google:T,jQuery:$}=window,F={components:{Spinner:c.$j,LassoSearch:A,TextInput:c.oi},data:()=>({tileLabels:!1,selectedOverlaysHolder:[],showTiles:!1,lassoSelection:"hand",lassoOptions:{lassoMove:null,lassoMouseUp:null,lassoPollyLine:null,lassoInProgress:!1,mapToggleListener:null,mapToggleCallsOut:0,strokeColor:"#232323"},showLabels:!1,isLoading:!1,searchIsLoading:!1,plotQueue:null,plotLoading:null}),computed:{...(0,l.mapState)("shapeBuilder",{builder__shape:"shape",builder__selectedOverlays:"selectedOverlays",builder__country:"country",builder__level:"level",builder__showDrawOnMap:"showDrawOnMap",builder__filters:"filters",builder__availableOverlays:"availableOverlays"})},watch:{builder__showDrawOnMap(e){e?(this.hidePlottedOverlays(),this.lassoSelection="hand",this.showDrawTiles(),this.plotOverlays(),this.hideMapElements(),this.toggleClickEvents(!1)):(this.lassoSelection="hand",this.terminatePlotQueue(),this.removeDrawTiles(),this.hidePlottedOverlays(),this.updateSavedOverlaysIfActive(),this.showMapElements(),this.toggleClickEvents(!0))}},created(){I={}},destroyed(){I=null},methods:{...(0,l.mapGetters)("shapeBuilder",{builder__formattedFilters:"formattedFilters"}),...(0,l.mapMutations)("shapeBuilder",{builder__updateSelectedOverlays:"updateSelectedOverlays",builder__toggleDrawOnMap:"toggleDrawOnMap",builder__removeFilters:"removeFilters",builder__updateAvailableOverlays:"updateAvailableOverlays"}),close(){this.hideDrawOnMap(),this.clearLassoEvents(),this.$nextTick((()=>{this.$emit("close")}))},hideDrawOnMap(){this.builder__toggleDrawOnMap(!1)},selectAllSelected(){const e=[];this.builder__selectedOverlays.forEach((t=>{try{const e=I[t.value];t.active||e.setMap(window.MA.map)}catch(e){}t.active=!0,e.push(t)})),this.builder__updateSelectedOverlays(e)},unselectAllSelected(){const e=[];this.builder__selectedOverlays.forEach((t=>{try{const e=I[t.value];t.active&&e.setMap(null)}catch(e){}t.active=!1,e.push(t)})),this.builder__updateSelectedOverlays(e)},toggleItem(e){const t=[];this.builder__selectedOverlays.forEach((s=>{s.value===e.value&&(e.active=!e.active),t.push(s)})),this.builder__updateSelectedOverlays(t);const{value:s}=e,l=I[s];try{e.active?l.setMap(window.MA.map):l.setMap(null)}catch(e){console.warn("shape not found",e)}},removeDrawTiles(){try{window.MA.Map.removeOverlay("maLassoShape")}catch(e){}},showDrawTiles(){this.removeDrawTiles();const e=`${window.getProperty(window.MASystem,"Organization.MAIO_URL",!1)}/boundary/tile`,t=this.showLabels,s=new T.maps.ImageMapType({name:"maLassoShape",maxZoom:18,tileSize:new T.maps.Size(256,256),opacity:.75,getTileUrl:(s,l)=>{let a=t;return l<9&&t?a=!1:l>=10&&t&&(a=!0),[e,"/1?",`x=${s.x}`,"&",`y=${s.y}`,"&",`z=${l}`,"&",`overlay=${this.builder__country}`,"&",`level=${this.builder__level}`,"&",`labels=${a}`].join("")}});window.MA.map.overlayMapTypes.push(s)},plotOverlays(){return new Promise((e=>{this.isLoading=!0,this.plotLoading=window.MAToastMessages.showLoading({message:`${this.$Labels.MA_Loading}...`,subMessage:"Grabbing your selections...",timeOut:0,extendedTimeOut:0});const t=[];let s=[];const l=[],a=this.builder__selectedOverlays,i=a.length;for(let e=0;e<i;e++){const i=a[e];if(i.plotted){const{active:e}=i;e&&l.push(i.value)}else s.push(i.value),s.length>=10&&(t.push(s),s=[])}s.length>0&&(t.push(s),s=[]),this.showPlottedOverlays(l);const o={remaining:t.length,total:t.length};this.plotQueue=M()(((e,t)=>{const{request:s}=e,{total:l}=o,a=l-this.plotQueue.length(),i=Math.round(a/l*100);this.plotLoading.find(".toast-message").text(`Grabbing your selections...  ${i}%`),(new v.Z).setAction("maps.RemoteFunctions.MapAnythingIORequestPOST").setErrorHandler((e=>{console.warn(e),t()})).invoke([{subType:"boundary",action:"geography",version:"1"},JSON.stringify(s)],(e=>{const{success:s=!1,data:l={}}=e;if(s){const e=l.data,s=e.length;for(let t=0;t<s;t++){const s=e[t],{geojson:l={}}=s,{features:a=[]}=l,i=a.length;for(let e=0;e<i;e++){const t=a[e],{properties:s={}}=t,l=s.id,i=I[l];if(i)try{i.setMap(null),delete I[l]}catch(e){}const o=new T.maps.Data;o.addGeoJson(t),o.setStyle({strokeColor:"#061c3f",fillColor:"#1589ee",fillOpacity:"0.2",strokeWeight:3,zIndex:1,clickable:!1,boundriesKey:l}),o.setMap(window.MA.map),I[l]=o;const r=this.builder__selectedOverlays.find((e=>e.value===l));r&&(r.plotted=!0)}}t()}else console.warn(e),t()}),{escape:!1,buffer:!1})}),3),this.plotQueue.drain=()=>{e(),this.isLoading=!1,window.MAToastMessages.hideMessage(this.plotLoading)};const r=t.length;if(r)for(let e=0;e<r;e++){const s={geoIds:t[e],format:"GeoJSON",merged:!1};this.plotQueue.push({request:s})}else this.plotQueue.drain()}))},hidePlottedOverlays(){const e=Object.keys(I),t=e.length;for(let s=0;s<t;s++){const t=e[s],l=I[t];try{l.setMap(null)}catch(e){}}},showPlottedOverlays(e=[]){const t=e.length;for(let s=0;s<t;s++){const t=e[s],l=I[t];try{l.setMap(window.MA.map)}catch(e){}}},updateSavedOverlaysIfActive(){const e=[],t=[],s=this.builder__selectedOverlays.length;for(let l=0;l<s;l++){const s=this.builder__selectedOverlays[l],{active:a}=s;a?t.push(s):e.push(s)}this.builder__updateSelectedOverlays(t),this.builder__updateAvailableOverlays([...this.builder__availableOverlays,...e])},hideMapElements(){try{const e=document.querySelector("#horizontalViewsWrap .layersPanel");e&&e.classList.remove("is-in"),document.getElementById("maMainNavbar").style.display="none",window.MA.map.disableKeyDragZoom()}catch(e){console.warn("Class names may have changd, unble to hide elements",e)}},showMapElements(){try{const e=document.querySelector("#horizontalViewsWrap .layersPanel");e&&e.classList.add("is-in"),document.getElementById("maMainNavbar").style.display="",window.MA.map.enableKeyDragZoom()}catch(e){console.warn("Class names may have changd, unble to show elements",e)}},updateLasso(e){this.clearLassoEvents(),this.lassoSelection=e,"plus"===e||"minus"===e?(this.toggleLassoMapOptions(!1),this.setLassoEvent(e)):"pointer"===e?this.setMapToggleEvent():this.clearLassoEvents()},clearLassoEvents(){this.lassoSelection="hand",window.MA.map.setOptions({draggableCursor:`url("${window.MASystem.Images.cursors.hand}"), auto`});try{T.maps.event.removeListener(this.lassoOptions.lassoMove)}catch(e){}try{T.maps.event.removeListener(this.lassoOptions.lassoMouseUp)}catch(e){}try{this.lassoOptions.lassoPollyLine.setMap(null)}catch(e){}try{T.maps.event.removeListener(this.lassoOptions.mapToggleListener)}catch(e){}try{T.maps.event.clearListeners(window.MA.map.getDiv(),"mousedown")}catch(e){}},toggleLassoMapOptions(e=!0){window.MA.map.setOptions({draggable:e,scrollwheel:e,disableDoubleClickZoom:e})},setLassoEvent(e){"plus"===e?window.MA.map.setOptions({draggableCursor:`url(${window.MASystem.Images.cursors.lasso_plus}), auto`}):"minus"===e?window.MA.map.setOptions({draggableCursor:`url(${window.MASystem.Images.cursors.lasso_minus}), auto`}):window.MA.map.setOptions({draggableCursor:"default"}),window.google.maps.event.addDomListener(window.MA.map.getDiv(),"mousedown",(()=>{this.lassoOptions.lassoPollyLine=new T.maps.Polyline({map:window.MA.map,clickable:!1,strokeColor:this.lassoOptions.strokeColor,zIndex:1500,strokeWeight:4}),this.lassoOptions.lassoMove=T.maps.event.addListener(window.MA.map,"mousemove",(e=>{this.lassoOptions.lassoInProgress=!0,this.lassoOptions.lassoPollyLine.getPath().push(e.latLng)})),this.lassoOptions.lassoMouseUp=T.maps.event.addListenerOnce(window.MA.map,"mouseup",(()=>{this.lassoOptions.lassoInProgress=!1,T.maps.event.removeListener(this.lassoOptions.lassoMove);const t=this.lassoOptions.lassoPollyLine.getPath();this.lassoOptions.lassoPollyLine.setMap(null),this.lassoOptions.lassoPollyLine=null,this.lassoOptions.lassoPollyLine=new T.maps.Polygon({map:window.MA.map,path:t,strokeColor:this.lassoOptions.strokeColor,strokeWeight:4}),T.maps.event.clearListeners(window.MA.map.getDiv(),"mousedown"),this.toggleLassoMapOptions(!0);let s=[];const l=this.lassoOptions.lassoPollyLine.getPaths().getArray(),a=l.length;for(let e=0;e<a;e++){const t=l[e].getArray();s=s.concat(t)}const i=window.MAToastMessages.showLoading({message:`${this.$Labels.MA_Loading}...`,subMessage:"Grabbing your selections...",timeOut:0,extendedTimeOut:0});this.isLoading=!0,this.processLassoPoints(s).then((t=>{this.clearLassoEvents(),"plus"===e?(this.addOverlaysFromUserSelection(t),this.plotOverlays()):(this.isLoading=!1,this.removeOverlaysFromUserSelection(t))})).catch((e=>{console.warn(e),this.clearLassoEvents(),this.isLoading=!1})).finally((()=>{window.MAToastMessages.hideMessage(i)}))}))}))},processLassoPoints(e){return new Promise(((t,s)=>{const l=[];e.forEach((e=>{l.push({lat:e.lat(),lng:e.lng()})}));const a=this.builder__formattedFilters(),{valid:i=[],invalid:o=[]}=a;o.length&&this.builder__removeFilters(o);const r=[{field_id:"spatial",values:l},...i];n(this.builder__country,this.builder__level,r).then((e=>{t(e)})).catch((e=>{this.clearLassoEvents(),s(e)}))}))},addOverlaysFromUserSelection(e=[]){const t=e.length;for(let s=0;s<t;s++){const t=e[s],l=this.builder__selectedOverlays.find((e=>e.value===t.value));if(l){const{value:e}=l,t=I[e];if(!l.active){l.active=!0;try{t.setMap(window.MA.map)}catch(e){}}}else this.builder__selectedOverlays.push({level:this.builder__level,value:t.value,label:t.label,active:!0,guid:(0,a.x$)(),plotted:!1})}this.builder__updateSelectedOverlays(this.builder__selectedOverlays)},removeOverlaysFromUserSelection(e=[]){const t=e.length;for(let s=0;s<t;s++){const t=e[s],l=this.builder__selectedOverlays.find((e=>e.value===t.value));if(l){const{value:e}=l,t=I[e];if(l.active){l.active=!1;try{t.setMap(null)}catch(e){}}}}this.builder__updateSelectedOverlays(this.builder__selectedOverlays)},setMapToggleEvent(){window.MA.map.setOptions({draggableCursor:"default"}),this.lassoOptions.mapToggleListener=window.MA.map.addListener("click",(e=>{const t=e.latLng;void 0===t&&window.MAToastMessages.showWarning({message:"Unable to locate this position.",subMessage:"Please try a different location.",timeOut:5e3}),this.lassoOptions.mapToggleCallsOut++;const s=new window.google.maps.Circle({center:t,radius:1}).getBounds(),l=[t,s.getNorthEast(),s.getSouthWest()];this.isLoading=!0,this.processLassoPoints(l).then((e=>{this.processMapToggleOverlays(e)})).catch((e=>{this.clearLassoEvents(),console.warn(e)})).finally((()=>{this.isLoading=!1}))}))},processMapToggleOverlays(e){const t=e.length,s=[],l=[];for(let a=0;a<t;a++){const t=e[a],i=this.builder__selectedOverlays.find((e=>e.value===t.value));i&&i.active?l.push(t):s.push(t)}l.length&&this.removeOverlaysFromUserSelection(l),s.length&&(this.addOverlaysFromUserSelection(s),this.plotOverlays())},save(){this.hideDrawOnMap(),this.clearLassoEvents(),this.$nextTick((()=>{this.$emit("save")}))},terminatePlotQueue(){try{this.plotQueue.kill(),window.MAToastMessages.hideMessage(this.plotLoading),this.isLoading=!1}catch(e){console.warn(e)}},toggleClickEvents(e=!0){document.querySelectorAll(".PlottedShapeLayer").forEach((t=>{const s=$(t).data(),{classList:l=[]}=t;if(l.contains("maTerritory"))try{const{dataLayer:t}=s,l=t.getStyle();l.clickable=e,t.setStyle(l)}catch(e){console.warn("unable to disable territory clicks",e)}else{const{proxObjects:t=[]}=s;t.forEach((t=>{t.setOptions({clickable:e})}))}})),document.querySelectorAll("#PlottedQueriesTable .proximity.layer").forEach((t=>{const s=$(t).data(),{proxObject:l}=s;l&&l.setOptions({clickable:e})}))}}},E=(0,h.Z)(F,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.builder__showDrawOnMap,expression:"builder__showDrawOnMap"}]},[s("LassoSearch"),e._v(" "),s("div",{staticClass:"slds-scope",staticStyle:{position:"absolute",top:"0",right:"0",bottom:"0","z-index":"100",background:"white",width:"330px"}},[s("div",{staticClass:"slds-grid slds-grid_vertical",staticStyle:{height:"100%"}},[s("div",{staticClass:"slds-col slds-grow-none"},[s("div",{staticClass:"slds-grid slds-p-vertical_x-small slds-p-horizontal_x-small slds-border_bottom",staticStyle:{background:"#f4f6f9"}},[s("div",{staticClass:"slds-col"},[s("button",{staticClass:"slds-button slds-button_neutral js-show-shape-builder-manual-mode",on:{click:e.hideDrawOnMap}},[s("div",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-back"}),e._v("\n                            "+e._s(e.$Labels.MA_Back_Full_Editor)+"\n                        ")])]),e._v(" "),s("div",{staticClass:"slds-col"},[s("div",{staticClass:"slds-button-group",attrs:{role:"group"}},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-large-icon slds-button_icon-border-filled shape-builder-drawing-tool-button no-focus-styling has-hover-tooltip",class:{"slds-is-active":"plus"===e.lassoSelection},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.updateLasso("plus")}}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-lasso-plus"}),e._v(" "),s("div",{staticClass:"slds-popover slds-popover_tooltip slds-nubbin_top-right shape-builder-drawing-button-tooltip",staticStyle:{width:"210px"},attrs:{role:"tooltip"}},[s("div",{staticClass:"slds-popover__body"},[e._v("\n                                        "+e._s(e.$Labels.MA_Add_Selection_Draw)+"\n                                        "),s("div",{staticClass:"slds-text-body_small slds-m-top--small tooltip-action-instruction"},[e._v(e._s(e.$Labels.MA_Click_Plus_Draw))])])])]),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-large-icon slds-button_icon-border-filled shape-builder-drawing-tool-button no-focus-styling has-hover-tooltip",class:{"slds-is-active":"minus"===e.lassoSelection},on:{click:function(t){return e.updateLasso("minus")}}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-lasso-minus"}),e._v(" "),s("div",{staticClass:"slds-popover slds-popover_tooltip slds-nubbin_top-right shape-builder-drawing-button-tooltip",staticStyle:{width:"210px"},attrs:{role:"tooltip"}},[s("div",{staticClass:"slds-popover__body"},[e._v("\n                                        "+e._s(e.$Labels.MA_Remove_Selection_Draw)+"\n                                        "),s("div",{staticClass:"slds-text-body_small slds-m-top--small tooltip-action-instruction"},[e._v(e._s(e.$Labels.MA_Click_Plus_Draw))])])])]),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-border-filled shape-builder-drawing-tool-button no-focus-styling has-hover-tooltip",class:{"slds-is-active":"pointer"===e.lassoSelection},on:{click:function(t){return e.updateLasso("pointer")}}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-cursor-pointer"}),e._v(" "),s("div",{staticClass:"slds-popover slds-popover_tooltip slds-nubbin_top-right shape-builder-drawing-button-tooltip",staticStyle:{width:"210px"},attrs:{role:"tooltip"}},[s("div",{staticClass:"slds-popover__body"},[e._v("\n                                        "+e._s(e.$Labels.MA_Individual_Selection_Draw)+"\n                                    ")])])]),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-border-filled shape-builder-drawing-tool-button no-focus-styling has-hover-tooltip",class:{"slds-is-active":"hand"===e.lassoSelection},on:{click:function(t){return e.updateLasso("hand")}}},[s("div",{staticClass:"slds-button__icon ma-icon ma-icon-hand"}),e._v(" "),s("div",{staticClass:"slds-popover slds-popover_tooltip slds-nubbin_top-right shape-builder-drawing-button-tooltip",staticStyle:{"white-space":"nowrap"},attrs:{role:"tooltip"}},[s("div",{staticClass:"slds-popover__body"},[e._v("\n                                        "+e._s(e.$Labels.MA_Default_Cursor)+"\n                                    ")])])])])])])]),e._v(" "),s("div",{staticClass:"slds-grow-none slds-col slds-p-around_x-small"},[s("TextInput",{attrs:{required:"",type:"text",labels:{name:e.$Labels.MA_Name,placeholder:"ex. Southeast Territory"}},model:{value:e.builder__shape.Name,callback:function(t){e.$set(e.builder__shape,"Name",t)},expression:"builder__shape.Name"}})],1),e._v(" "),s("div",{staticClass:"slds-col slds-p-around_small slds-p-top_none",staticStyle:{height:"30%"}},[s("div",{staticClass:"slds-grid slds-grid_vertical",staticStyle:{height:"100%",position:"relative"}},[s("Spinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),e._v(" "),s("div",{staticClass:"slds-col slds-grow-none"},[e._v("Selected Shapes")]),e._v(" "),s("div",{staticClass:"slds-col slds-grow-none"},[s("div",{staticClass:"slds-p-around_x-small slds-border_left slds-border_right slds-border_top slds-grid"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.showLabels,expression:"showLabels"}],staticClass:"test",attrs:{id:"lassoLabels",type:"checkbox"},domProps:{checked:Array.isArray(e.showLabels)?e._i(e.showLabels,null)>-1:e.showLabels},on:{change:[function(t){var s=e.showLabels,l=t.target,a=!!l.checked;if(Array.isArray(s)){var i=e._i(s,null);l.checked?i<0&&(e.showLabels=s.concat([null])):i>-1&&(e.showLabels=s.slice(0,i).concat(s.slice(i+1)))}else e.showLabels=a},e.showDrawTiles]}}),e._v(" "),e._m(0)])]),e._v(" "),s("div",{staticClass:"slds-col_bump-left"},[e._v("\n                                Select "),s("a",{attrs:{href:"javascript:void(0);"},on:{click:e.selectAllSelected}},[e._v("All")]),e._v(" / "),s("a",{attrs:{href:"javascript:void(0);"},on:{click:e.unselectAllSelected}},[e._v("None")])])])]),e._v(" "),s("div",{ref:"selectedOptions",staticClass:"slds-col slds-listbox slds-listbox_vertical slds-p-around_x-small slds-border_top slds-border_left slds-border_right slds-border_bottom",staticStyle:{overflow:"auto"}},e._l(e.builder__selectedOverlays,(function(t){return s("div",{key:t.guid,staticClass:"slds-listbox__item lasso-list-item slds-truncate",class:{"slds-is-selected":t.active},attrs:{value:t.value},on:{click:function(s){return e.toggleItem(t)}}},[s("span",{staticClass:"slds-listbox__option slds-listbox__option_plain slds-media",attrs:{role:"option"}},[s("span",{staticClass:"slds-truncate",attrs:{title:t.label}},[s("Icon",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"item.active"}],attrs:{category:"utility",name:"check",variant:"inverse",size:"x-small"}}),e._v(" "),s("span",{staticClass:"slds-m-left_xxx-small list-item-label"},[e._v(e._s(t.label))])],1)])])})),0),e._v(" "),s("div",{staticClass:"slds-col slds-grow-none slds-p-top--x-small slds-text-color_weak"},[e._v("\n                        ("),s("span",[e._v(e._s(e.builder__selectedOverlays.length))]),e._v(") shapes selected\n                    ")])],1)]),e._v(" "),s("div",{staticClass:"slds-col slds-grow-none"},[s("div",{staticClass:"flex-shrink-0"},[s("div",{staticClass:"flex-row slds-p-vertical--x-small slds-p-horizontal--medium",staticStyle:{"background-color":"#f4f6f9","border-top":"1px solid #d8dde6"}},[s("div",{staticClass:"flex-grow-1"}),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.close}},[e._v("\n                                "+e._s(e.$Labels.MA_Cancel)+"\n                            ")])]),e._v(" "),s("div",{staticClass:"slds-p-left--x-small"},[s("button",{staticClass:"slds-button slds-button_brand",attrs:{id:"shapeBuilderDrawingSaveAndPlot"},on:{click:e.save}},[e._v("\n                                "+e._s(e.$Labels.MA_Save_Plot)+"\n                            ")])])])])])])])],1)}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("label",{staticClass:"slds-checkbox__label",attrs:{for:"lassoLabels"}},[s("span",{staticClass:"slds-checkbox_faux"}),e._v(" "),s("span",{staticClass:"slds-form-element__label"},[e._v("Show Labels")])])}],!1,null,"5127ff2c",null).exports,{async:D}=window,B={components:{Modal:c.u_,Tabs:c.mQ,Tab:c.OK,Spinner:c.$j,Details:_,ShapeSelection:w,Display:x,DrawOnMap:E},directives:{"click-outside":i.Z},props:{modalOptions:{type:Object,default:()=>{}}},validations(){const e={builder__shape:{Name:{required:o.C1,maxLength:(0,o.BS)(80)}}};return this.picklistVisible&&(e.selectedCustomMarker={required:o.C1}),e},data:()=>({isUsedInRule:!1,isLoading:!1,isPlotted:!1,loadingIndex:0,activeTabId:"shapeBuilderDetails",isClone:!1,mainProgressStyle:{loading:!0,style:{width:"0%"}},selectedOverlays:[],drawingOption:{level:"",country:""}}),computed:{createdInfo(){return`***Created By ${this.builder__shape.CreatedBy.Name} on ${window.moment(this.builder__shape.CreatedDate).format(window.formatUserLocaleDate({moment:!0}))}, Modified By ${this.builder__shape.LastModifiedBy.Name} on ${window.moment(this.builder__shape.LastModifiedDate).format(window.formatUserLocaleDate({moment:!0}))}`},clickOutsideFilterOptions(){return{active:!0,handler:this.checkFilterPopup}},clickOutsideFilterResults(){return{active:!0,handler:this.hideFilterResults}},...(0,l.mapState)("shapeBuilder",{builder__shape:"shape",builder__selectedOverlays:"selectedOverlays",builder__showDrawOnMap:"showDrawOnMap"}),saveText(){let e=this.$Labels.MA_Save_Plot;return this.isPlotted&&(e=this.$Labels.MA_SAVE_AND_REFRESH),e}},async created(){const{id:e,isClone:t=!1,folder:s,plotted:l=!1}=this.modalOptions;if(this.isClone=t,this.isPlotted=l,e)this.isUsedInRule=await this.checkIfShapeIsUsedInRule(e),this.setLoadingStatus(!0),(e=>new Promise(((t,s)=>{const l={ajaxResource:"TerritoryAJAXResources",action:"getTerritory",id:e};(new r.Z).setAction("maps.RemoteFunctions.processAJAXRequest").setErrorHandler((e=>{console.warn(e),s(new Error("Unable to retrieve shape data. If issue persists please contact support."))})).invoke([l],(e=>{const{success:l=!1,data:a={}}=e;l?t(a):(console.warn(e),s(new Error("Unable to retrieve shape data. If issue persists please contact support.")))}),{escape:!1,buffer:!1})})))(e).then((e=>{this.setSavedShapeData(e),this.setSavedTerritoryGeometries().then((e=>{this.builder__updateSelectedOverlays(e)})).finally((()=>{this.setLoadingStatus(!1)}))})).catch((e=>{this.setLoadingStatus(!1),console.warn(e),this.showError(e.message),this.close()}));else{const e={maps__User__c:null,maps__Folder__c:null};"PersonalRoot"===s||"RoleUserFolder"===s?e.maps__User__c=window.MA.CurrentUser.Id:"CorporateRoot"===s||(e.maps__Folder__c=s),this.builder__updateShapeData(e)}},destroyed(){this.builder__resetBuilder()},methods:{...(0,l.mapMutations)("shapeBuilder",{builder__updateShapeData:"updateShapeData",builder__updateSelectedOverlays:"updateSelectedOverlays",builder__resetBuilder:"resetBuilder"}),updateTab(e){this.activeTabId=e},setLoadingStatus(e){e?this.loadingIndex++:this.loadingIndex--,this.loadingIndex<=0?(this.loadingIndex=0,this.isLoading=!1):this.isLoading=!0},close(){this.builder__resetBuilder(),this.$emit("close")},setSavedShapeData(e={}){const{territory:t={}}=e;if(this.builder__updateShapeData(t),this.isClone){const e={Id:null,Name:`Copy of ${this.builder__shape.Name}`};this.builder__updateShapeData(e)}const s={country:"shapesV2",advancedOptions:{calculateTerritoryAggregates:!1,dissolveGeometry:!0,affectVisibility:!1},colorOptions:{fillColor:"#16325C",borderColor:"#3083D3",fillOpacity:"0.2",labelEnabled:!1,labelOverride:"",labelJustification:"center",labelFontSize:"10px",labelFontColor:"#FFFFFF",labelBGColor:"#000000",labelBGOpacity:"0.3"}};try{const e=JSON.parse(t.maps__Options__c),l={...s,...e};this.builder__updateShapeData({maps__Options__c:l})}catch(e){console.warn(e),this.showError("An error occured while setting some options, please review before saving."),this.builder__updateShapeData({maps__Options__c:s})}},showError(e){window.MAToastMessages.showError({message:this.$Labels.MA_Error,subMessage:e,timeOut:0,extendedTimeOut:0,closeButton:!0})},buildGeoIdSaveData(){const e={};this.builder__selectedOverlays.forEach((t=>{const{level:s,value:l}=t;e[s]=e[s]||[],e[s].push(l)}));const t=JSON.stringify(e).match(/.{1,100000}/g),s={Name:`${this.builder__shape.Name}-geometry`,maps__Geometry__c:t[0]||{},maps__Geometry2__c:t[1]||"",maps__Geometry3__c:t[2]||"",maps__Geometry4__c:t[3]||"",maps__Geometry5__c:t[4]||"",maps__Geometry6__c:t[5]||"",maps__Geometry7__c:t[6]||"",maps__Geometry8__c:t[7]||"",maps__Geometry9__c:t[8]||"",maps__Geometry10__c:t[9]||""};return JSON.stringify(s)},buildTerritorySaveData(e){const t=this.builder__shape.maps__Options__c,s=JSON.stringify(t),l={Name:this.builder__shape.Name,maps__Description__c:this.builder__shape.maps__Description__c,maps__User__c:this.builder__shape.maps__User__c,maps__Folder__c:this.builder__shape.maps__Folder__c,Id:this.builder__shape.Id,maps__Options__c:s,maps__JobId__c:e};return JSON.stringify(l)},saveUpdatedTerritory(e){this.validateLayer()&&(this.setLoadingStatus(!0),this.saveLayer().then((t=>{window.MAToastMessages.showSuccess({message:"Layer Saved"}),e&&(this.isPlotted&&document.querySelector(`.PlottedShapeLayer.maTerritory[data-id="${t.Id}"]`).querySelector(".btn-remove").click(),window.MA_DrawShapes.init({id:t.Id})),this.$bus.$emit("refresh-folder")})).catch((e=>{this.showError(e.message)})).finally((()=>{this.setLoadingStatus(!1),this.close()})))},validateLayer(){let e=!0,t="";this.builder__shape.Name||(this.updateTab("shapeBuilderDetails"),t="Please enter a valid name for this layer",e=!1),this.builder__selectedOverlays.length||(this.updateTab("shapeBuilderSelections"),t="At least 1 shape is required to save",e=!1);const s=this.builder__selectedOverlays.map((e=>e.value));return JSON.stringify(s).match(/.{1,100000}/g).length>10&&(this.updateTab("shapeBuilderSelections"),t="Please remove some boundaries and try again.",e=!1),e||window.MAToastMessages.showWarning({message:"Unable to save layer",subMessage:t,timeOut:7e3}),e},saveLayer(){return new Promise(((e,t)=>{var s;(s=this.builder__selectedOverlays.map((e=>e.value)),new Promise(((e,t)=>{1===s.length&&s.push(s[0]);const l={geo_ids:s};(new r.Z).setAction("maps.RemoteFunctions.MapAnythingIORequestPOST").setErrorHandler((e=>{console.warn(e),t(new Error("Failed to start merge job, if issue persists please contact support"))})).invoke([{subType:"geometry",action:"merge",version:"1"},JSON.stringify(l)],(s=>{const{success:l=!1,data:a={}}=s;if(l){const t=a.data||{},{job_id:s}=t;e(s)}else console.warn(s),t(new Error("Failed to start merge job, if issue persists please contact support"))}),{escape:!1})}))).then((s=>{const l=this.buildGeoIdSaveData();((e,t)=>new Promise(((s,l)=>{const a={ajaxResource:"TerritoryAJAXResources",action:"saveBoundaryInfo",serializedTerritory:e,serializedGeometry:t};(new r.Z).setAction("maps.RemoteFunctions.processAJAXRequest").setErrorHandler((e=>{console.warn(e),l(new Error("Unable to save shape data. If issue persists please contact support."))})).invoke([a],(e=>{const{success:t=!1,data:a={}}=e;t?s(a):(console.warn(e),l(new Error("Unable to save shape data. If issue persists please contact support.")))}),{escape:!1})})))(this.buildTerritorySaveData(s),l).then((t=>{e(t)})).catch((()=>{t(new Error("Unable to save shape data. If issue persists please contact support."))}))})).catch((e=>{t(new Error(e.message))}))}))},async checkIfShapeIsUsedInRule(e){const{data:t=!1,error:s}=await this.$remoting("AutoAssignmentController.isShapeUsedInPlan",[e]);return s&&console.error(s),t},setSavedTerritoryGeometries(){return new Promise((e=>{const t=window.getProperty(this.builder__shape,"maps__ShapeLayerGeometries__r.records",!1)||[],s=[];for(let e=0;e<t.length;e++){const l=t[e]||{};let a={};try{const e=l.maps__Geometry__c||"{}",t=l.maps__Geometry2__c||"",s=l.maps__Geometry3__c||"",i=l.maps__Geometry4__c||"",o=l.maps__Geometry5__c||"",r=l.maps__Geometry6__c||"",n=l.maps__Geometry7__c||"",d=l.maps__Geometry8__c||"",c=l.maps__Geometry9__c||"",u=l.maps__Geometry10__c||"";a=JSON.parse(e+t+s+i+o+r+n+d+c+u)}catch(e){this.showError("Unable to parse all shape information. Some data may be missing."),console.warn("Unable to parse custom shape info",e),console.warn(l.maps__Geometry__c)}const{country:i}=this.builder__shape.maps__Options__c;if(a){const e=Object.keys(a);for(let t=0;t<e.length;t++){let l=e[t]||"";const o=a[l]||[];"states"===l?l="1":"counties"===l?l="2":"zips"===l&&(l="4");for(let e=0;e<o.length;e++){let t=o[e];"USA"===i&&"2"===l?0===t.indexOf("USA-2-")?s.push({level:l,boundary:t}):s.push({level:l,boundary:`USA-2-${t.substring(4)}`}):(t=t.replace(/ +(?= )/g,"").replace(/ /g,"_"),s.push({level:l,boundary:t}))}}}break}this.getSavedGeoIdLabels(s).then((t=>{t.sort(((e,t)=>e.label>t.label?1:e.label<t.label?-1:0)),e(t)}))}))},getSavedGeoIdLabels(e){return new Promise((t=>{const s=window.MA.Util.createBatchable(e,100);this.mainProgressStyle.style.width="0%",this.mainProgressStyle.loading=!0;const l={remaining:s.length,total:s.length},i=[],o=D.queue(((e,t)=>{l.remaining=o.tasks.length;const{remaining:s,total:r}=l,d=r-s,c=Math.round(d/r*100);this.mainProgressStyle.style.width=`${c}%`;const u=e.idsToSend.map((e=>e.boundary));n("*","*",[{field_id:"geoid",values:u}]).then((s=>{for(let t=0;t<s.length;t++){const l=s[t],o=e.idsToSend.find((e=>e.boundary===l.value));i.push({level:o.level||"1",value:l.value,label:l.label,active:!0,guid:(0,a.x$)(),plotted:!1})}t()})).catch((()=>{t()}))}),3);if(s.length>0)for(let e=0;e<s.length;e++)o.push({idsToSend:s[e]});else o.push({idsToSend:[]});o.drain=()=>{this.mainProgressStyle.loading=!1,t(i)}}))}}},R=(0,h.Z)(B,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"shapeBuilderModalWrapper"}},[s("DrawOnMap",{on:{close:e.close,save:function(t){return e.saveUpdatedTerritory(!0)}}}),e._v(" "),s("Modal",{directives:[{name:"show",rawName:"v-show",value:!e.builder__showDrawOnMap,expression:"!builder__showDrawOnMap"}],attrs:{title:"Shape Layer Builder",size:"large",labels:{close:e.$Labels.MA_Close}},on:{close:e.close}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("Spinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),e._v(" "),e.mainProgressStyle.loading?s("div",{staticClass:"slds-progress-bar slds-progress-bar_small",staticStyle:{position:"absolute",top:"0px",left:"0"},attrs:{"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"25",role:"progressbar"}},[s("span",{staticClass:"slds-progress-bar__value",style:e.mainProgressStyle.style},[s("span",{staticClass:"slds-assistive-text"},[e._v("Progress: 25%")])])]):e._e(),e._v(" "),s("Tabs",{attrs:{activeTabId:e.activeTabId,isVertical:""},on:{changed:e.updateTab}},[s("Tab",{attrs:{id:"shapeBuilderDetails",title:"Details"}},[s("Details",{attrs:{validator:e.$v,isUsedInRule:e.isUsedInRule},on:{"update-tab":e.updateTab}})],1),e._v(" "),s("Tab",{attrs:{id:"shapeBuilderSelections",title:"Shape Selection"}},[s("ShapeSelection",{on:{"update-loading":e.setLoadingStatus,close:e.close}})],1),e._v(" "),s("Tab",{attrs:{id:"shapeBuilderDisplay",title:e.$Labels.MA_DISPLAY}},[s("Display")],1)],1)],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("div",{staticClass:"slds-float_left slds-m-top_xx-small"},[e._v(e._s(e.createdInfo))]),e._v(" "),s("button",{staticClass:"slds-button slds-button--neutral",on:{click:e.close}},[e._v("\n                Cancel\n            ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand save-boundary",on:{click:function(t){return e.saveUpdatedTerritory(!1)}}},[e._v("\n                "+e._s(e.$Labels.MA_Save_Close)+"\n            ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand save-boundary",on:{click:function(t){return e.saveUpdatedTerritory(!0)}}},[e._v("\n                "+e._s(e.saveText)+"\n            ")])])])],1)}),[],!1,null,null,null).exports},4069:(e,t,s)=>{s.d(t,{Z:()=>a});const l={name:"MAInput",mixins:[{methods:{decodeHtml(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}}}],props:{value:{type:[String,Number],required:!0},isRequired:{type:Boolean,default:!1},useTextArea:{type:Boolean,default:!1},disableResize:{type:Boolean,default:!1},label:{type:String,default:""},errors:{type:Array,default:()=>[]},placeholder:{type:String,default:""},type:{type:String,default:"text"},isInvalid:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},hasFocus:{type:Boolean,default:!1},requiredLabel:{type:String,default:"Required"}},computed:{showLabel(){return this.label},hasErrors(){return this.errors&&this.errors.length},listeners(){return{...this.$listeners,input:e=>this.$emit("input",e.target.value)}}},watch:{hasFocus(e){e&&this.focus()}},mounted(){this.hasFocus&&this.focus()},methods:{focus(){this.$refs.input.focus(),this.$refs.input.select()}}},a=(0,s(1900).Z)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-form-element",class:{"slds-has-error":e.isInvalid}},[e.showLabel?s("label",{staticClass:"slds-form-element__label"},[e.isRequired?s("abbr",{staticClass:"slds-required",attrs:{title:e.requiredLabel}},[e._v("*")]):e._e(),e._v("\n        "+e._s(e.decodeHtml(e.label))+"\n        "),e._t("label")],2):e._e(),e._v(" "),s("div",{staticClass:"slds-form-element__control",staticStyle:{position:"relative"}},[e.useTextArea?s("textarea",e._g({staticClass:"slds-textarea",attrs:{disabled:e.isDisabled,placeholder:e.placeholder},domProps:{value:e.decodeHtml(e.value)}},e.listeners)):s("input",e._g({ref:"input",staticClass:"slds-input",attrs:{type:e.type,disabled:e.isDisabled,placeholder:e.placeholder},domProps:{value:e.decodeHtml(e.value)},on:{blur:function(t){return e.$emit("update:hasFocus",!1)}}},e.listeners)),e._v(" "),e._t("extendInput")],2),e._v(" "),e.isInvalid?s("div",{staticClass:"slds-form-element__help"},[e._t("errors")],2):e._e()])}),[],!1,null,"71386de2",null).exports},6408:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=(0,s(6681).regex)("alpha",/^[a-zA-Z]*$/);t.default=l},6195:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=(0,s(6681).regex)("alphaNum",/^[a-zA-Z0-9]*$/);t.default=l},5573:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.withParams)({type:"and"},(function(){for(var e=this,s=arguments.length,l=new Array(s),a=0;a<s;a++)l[a]=arguments[a];return t.length>0&&t.reduce((function(t,s){return t&&s.apply(e,l)}),!0)}))}},7884:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(e,t){return(0,l.withParams)({type:"between",min:e,max:t},(function(s){return!(0,l.req)(s)||(!/\s/.test(s)||s instanceof Date)&&+e<=+s&&+t>=+s}))}},6681:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.req=t.regex=t.ref=t.len=void 0,Object.defineProperty(t,"withParams",{enumerable:!0,get:function(){return a.default}});var l,a=(l=s(8085))&&l.__esModule?l:{default:l};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var o=function(e){if(Array.isArray(e))return!!e.length;if(null==e)return!1;if(!1===e)return!0;if(e instanceof Date)return!isNaN(e.getTime());if("object"===i(e)){for(var t in e)return!0;return!1}return!!String(e).length};t.req=o,t.len=function(e){return Array.isArray(e)?e.length:"object"===i(e)?Object.keys(e).length:String(e).length},t.ref=function(e,t,s){return"function"==typeof e?e.call(t,s):s[e]},t.regex=function(e,t){return(0,a.default)({type:e},(function(e){return!o(e)||t.test(e)}))}},4078:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=(0,s(6681).regex)("decimal",/^[-]?\d*(\.\d+)?$/);t.default=l},8107:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=(0,s(6681).regex)("email",/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i);t.default=l},379:(e,t,s)=>{function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}Object.defineProperty(t,"gH",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"_L",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"BS",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"PW",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"uv",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"C1",{enumerable:!0,get:function(){return i.default}});u(s(6408)),u(s(6195)),u(s(5669)),u(s(7884)),u(s(8107)),u(s(9103)),u(s(7340));var a=u(s(5287)),i=(u(s(3091)),u(s(2419))),o=(u(s(2941)),u(s(8300)),u(s(918)),u(s(3213)),u(s(5832)),u(s(5573)),u(s(2500)),u(s(2628))),r=u(s(301)),n=u(s(6673)),d=u(s(4078));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(c=function(e){return e?s:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}!function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var s=c(t);if(s&&s.has(e))return s.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=i?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(a,o,r):a[o]=e[o]}a.default=e,s&&s.set(e,a)}(s(6681))},6673:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=(0,s(6681).regex)("integer",/(^[0-9]*$)|(^-[0-9]+$)/);t.default=l},9103:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681),a=(0,l.withParams)({type:"ipAddress"},(function(e){if(!(0,l.req)(e))return!0;if("string"!=typeof e)return!1;var t=e.split(".");return 4===t.length&&t.every(i)}));t.default=a;var i=function(e){if(e.length>3||0===e.length)return!1;if("0"===e[0]&&"0"!==e)return!1;if(!e.match(/^\d+$/))return!1;var t=0|+e;return t>=0&&t<=255}},7340:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:":";return(0,l.withParams)({type:"macAddress"},(function(t){if(!(0,l.req)(t))return!0;if("string"!=typeof t)return!1;var s="string"==typeof e&&""!==e?t.split(e):12===t.length||16===t.length?t.match(/.{2}/g):null;return null!==s&&(6===s.length||8===s.length)&&s.every(a)}))};var a=function(e){return e.toLowerCase().match(/^[0-9a-f]{2}$/)}},5287:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(e){return(0,l.withParams)({type:"maxLength",max:e},(function(t){return!(0,l.req)(t)||(0,l.len)(t)<=e}))}},301:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(e){return(0,l.withParams)({type:"maxValue",max:e},(function(t){return!(0,l.req)(t)||(!/\s/.test(t)||t instanceof Date)&&+t<=+e}))}},3091:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(e){return(0,l.withParams)({type:"minLength",min:e},(function(t){return!(0,l.req)(t)||(0,l.len)(t)>=e}))}},2628:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(e){return(0,l.withParams)({type:"minValue",min:e},(function(t){return!(0,l.req)(t)||(!/\s/.test(t)||t instanceof Date)&&+t>=+e}))}},2500:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(e){return(0,l.withParams)({type:"not"},(function(t,s){return!(0,l.req)(t)||!e.call(this,t,s)}))}},5669:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=(0,s(6681).regex)("numeric",/^[0-9]*$/);t.default=l},5832:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.withParams)({type:"or"},(function(){for(var e=this,s=arguments.length,l=new Array(s),a=0;a<s;a++)l[a]=arguments[a];return t.length>0&&t.reduce((function(t,s){return t||s.apply(e,l)}),!1)}))}},2419:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681),a=(0,l.withParams)({type:"required"},(function(e){return"string"==typeof e?(0,l.req)(e.trim()):(0,l.req)(e)}));t.default=a},2941:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(e){return(0,l.withParams)({type:"requiredIf",prop:e},(function(t,s){return!(0,l.ref)(e,this,s)||(0,l.req)(t)}))}},8300:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(e){return(0,l.withParams)({type:"requiredUnless",prop:e},(function(t,s){return!!(0,l.ref)(e,this,s)||(0,l.req)(t)}))}},918:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(6681);t.default=function(e){return(0,l.withParams)({type:"sameAs",eq:e},(function(t,s){return t===(0,l.ref)(e,this,s)}))}},3213:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=(0,s(6681).regex)("url",/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i);t.default=l},8085:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(16).R;t.default=l},16:(e,t,s)=>{function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}t.R=void 0;var a="undefined"!=typeof window?window:void 0!==s.g?s.g:{},i=a.vuelidate?a.vuelidate.withParams:function(e,t){return"object"===l(e)&&void 0!==t?t:e((function(){}))};t.R=i}}]);