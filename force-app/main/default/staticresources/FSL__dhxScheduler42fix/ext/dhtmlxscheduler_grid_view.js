/*
dhtmlxScheduler v.4.2.0 Stardard

This software is covered by GPL license. You also can obtain Commercial or Enterprise license to use it in non-GPL project - please contact sales@dhtmlx.com. Usage without proper license is prohibited.

(c) Dinamenta, UAB.
*/
!function(){scheduler._grid={sort_rules:{"int":function(e,t,i){return 1*i(e)<1*i(t)?1:-1},str:function(e,t,i){return i(e)<i(t)?1:-1},date:function(e,t,i){return new Date(i(e))<new Date(i(t))?1:-1}},_getObjName:function(e){return"grid_"+e},_getViewName:function(e){return e.replace(/^grid_/,"")}}}(),scheduler.createGridView=function(e){function t(e){return!(void 0!==e&&(1*e!=e||0>e))}var i=e.name||"grid",s=scheduler._grid._getObjName(i);scheduler.config[i+"_start"]=e.from||new Date(0),scheduler.config[i+"_end"]=e.to||new Date(9999,1,1),scheduler[s]=e,scheduler[s].defPadding=8,scheduler[s].columns=scheduler[s].fields,scheduler[s].unit=e.unit||"month",scheduler[s].step=e.step||1,delete scheduler[s].fields;
for(var r=scheduler[s].columns,a=0;a<r.length;a++)t(r[a].width)&&(r[a].initialWidth=r[a].width),t(r[a].paddingLeft)||delete r[a].paddingLeft,t(r[a].paddingRight)||delete r[a].paddingRight;scheduler[s].select=void 0===e.select?!0:e.select,void 0===scheduler.locale.labels[i+"_tab"]&&(scheduler.locale.labels[i+"_tab"]=scheduler[s].label||scheduler.locale.labels.grid_tab),scheduler[s]._selected_divs=[],scheduler.date[i+"_start"]=function(t){return scheduler.date[e.unit+"_start"]?scheduler.date[e.unit+"_start"](t):t
},scheduler.date["add_"+i]=function(e,t){return scheduler.date.add(e,t*scheduler[s].step,scheduler[s].unit)},scheduler.templates[i+"_date"]=function(e,t){return scheduler.templates.day_date(e)+" - "+scheduler.templates.day_date(t)},scheduler.templates[i+"_full_date"]=function(e,t,s){return scheduler.isOneDayEvent(s)?this[i+"_single_date"](e):scheduler.templates.day_date(e)+" &ndash; "+scheduler.templates.day_date(t)},scheduler.templates[i+"_single_date"]=function(e){return scheduler.templates.day_date(e)+" "+this.event_date(e)
},scheduler.templates[i+"_field"]=function(e,t){return t[e]},scheduler.attachEvent("onTemplatesReady",function(){scheduler.attachEvent("onDblClick",function(e){return this._mode==i?(scheduler._click.buttons.details(e),!1):!0}),scheduler.attachEvent("onClick",function(e,t){return this._mode==i&&scheduler[s].select?(scheduler._grid.unselectEvent("",i),scheduler._grid.selectEvent(e,i,t),!1):!0});var e=scheduler.render_data;scheduler.render_data=function(){return this._mode!=i?e.apply(this,arguments):void scheduler._grid._fill_grid_tab(s)
};var t=scheduler.render_view_data;scheduler.render_view_data=function(){var e=scheduler._els.dhx_cal_data[0].lastChild;return this._mode==i&&e&&(scheduler._grid._gridScrollTop=e.scrollTop),t.apply(this,arguments)}}),scheduler[i+"_view"]=function(e){if(scheduler._grid._sort_marker=null,delete scheduler._gridView,scheduler._grid._gridScrollTop=0,scheduler._rendered=[],scheduler[s]._selected_divs=[],e){var t=null,r=null,a=scheduler[s];a.paging?(t=scheduler.date[i+"_start"](new Date(scheduler._date)),r=scheduler.date["add_"+i](t,1)):(t=scheduler.config[i+"_start"],r=scheduler.config[i+"_end"]),scheduler._min_date=t,scheduler._max_date=r,scheduler._grid.set_full_view(s);
var n="";+t>+new Date(0)&&+r<+new Date(9999,1,1)&&(n=scheduler.templates[i+"_date"](t,r)),scheduler._els.dhx_cal_date[0].innerHTML=n,scheduler._gridView=s}}},scheduler.dblclick_dhx_grid_area=function(){!this.config.readonly&&this.config.dblclick_create&&this.addEventNow()},scheduler._click.dhx_cal_header&&(scheduler._old_header_click=scheduler._click.dhx_cal_header),scheduler._click.dhx_cal_header=function(e){if(scheduler._gridView){var t=e||window.event,i=scheduler._grid.get_sort_params(t,scheduler._gridView);
scheduler._grid.draw_sort_marker(t.originalTarget||t.srcElement,i.dir),scheduler.clear_view(),scheduler._grid._fill_grid_tab(scheduler._gridView,i)}else if(scheduler._old_header_click)return scheduler._old_header_click.apply(this,arguments)},scheduler._grid.selectEvent=function(e,t,i){if(scheduler.callEvent("onBeforeRowSelect",[e,i])){var s=scheduler._grid._getObjName(t);scheduler.for_rendered(e,function(e){e.className+=" dhx_grid_event_selected",scheduler[s]._selected_divs.push(e)}),scheduler._select_id=e
}},scheduler._grid._unselectDiv=function(e){e.className=e.className.replace(/ dhx_grid_event_selected/,"")},scheduler._grid.unselectEvent=function(e,t){var i=scheduler._grid._getObjName(t);if(i&&scheduler[i]._selected_divs)if(e){for(var s=0;s<scheduler[i]._selected_divs.length;s++)if(scheduler[i]._selected_divs[s].getAttribute("event_id")==e){scheduler._grid._unselectDiv(scheduler[i]._selected_divs[s]),scheduler[i]._selected_divs.slice(s,1);break}}else{for(var s=0;s<scheduler[i]._selected_divs.length;s++)scheduler._grid._unselectDiv(scheduler[i]._selected_divs[s]);
scheduler[i]._selected_divs=[]}},scheduler._grid.get_sort_params=function(e,t){var i=e.originalTarget||e.srcElement,s="desc";"dhx_grid_view_sort"==i.className&&(i=i.parentNode),i.className&&-1!=i.className.indexOf("dhx_grid_sort_asc")||(s="asc");for(var r=0,a=0;a<i.parentNode.childNodes.length;a++)if(i.parentNode.childNodes[a]==i){r=a;break}var n=null;if(scheduler[t].columns[r].template){var d=scheduler[t].columns[r].template;n=function(e){return d(e.start_date,e.end_date,e)}}else{var l=scheduler[t].columns[r].id;
"date"==l&&(l="start_date"),n=function(e){return e[l]}}var o=scheduler[t].columns[r].sort;return"function"!=typeof o&&(o=scheduler._grid.sort_rules[o]||scheduler._grid.sort_rules.str),{dir:s,value:n,rule:o}},scheduler._grid.draw_sort_marker=function(e,t){"dhx_grid_view_sort"==e.className&&(e=e.parentNode),scheduler._grid._sort_marker&&(scheduler._grid._sort_marker.className=scheduler._grid._sort_marker.className.replace(/( )?dhx_grid_sort_(asc|desc)/,""),scheduler._grid._sort_marker.removeChild(scheduler._grid._sort_marker.lastChild)),e.className+=" dhx_grid_sort_"+t,scheduler._grid._sort_marker=e;
var i="<div class='dhx_grid_view_sort' style='left:"+(+e.style.width.replace("px","")-15+e.offsetLeft)+"px'>&nbsp;</div>";e.innerHTML+=i},scheduler._grid.sort_grid=function(e){var e=e||{dir:"desc",value:function(e){return e.start_date},rule:scheduler._grid.sort_rules.date},t=scheduler.get_visible_events();return t.sort("desc"==e.dir?function(t,i){return e.rule(t,i,e.value)}:function(t,i){return-e.rule(t,i,e.value)}),t},scheduler._grid.set_full_view=function(e){if(e){var t=(scheduler.locale.labels,scheduler._grid._print_grid_header(e));
scheduler._els.dhx_cal_header[0].innerHTML=t,scheduler._table_view=!0,scheduler.set_sizes()}},scheduler._grid._calcPadding=function(e,t){var i=(void 0!==e.paddingLeft?1*e.paddingLeft:scheduler[t].defPadding)+(void 0!==e.paddingRight?1*e.paddingRight:scheduler[t].defPadding);return i},scheduler._grid._getStyles=function(e,t){for(var i=[],s="",r=0;t[r];r++)switch(s=t[r]+":",t[r]){case"text-align":e.align&&i.push(s+e.align);break;case"vertical-align":e.valign&&i.push(s+e.valign);break;case"padding-left":void 0!==e.paddingLeft&&i.push(s+(e.paddingLeft||"0")+"px");
break;case"padding-right":void 0!==e.paddingRight&&i.push(s+(e.paddingRight||"0")+"px")}return i},scheduler._grid._fill_grid_tab=function(e,t){for(var i=(scheduler._date,scheduler._grid.sort_grid(t)),s=scheduler[e].columns,r="<div>",a=-2,n=0;n<s.length;n++){var d=scheduler._grid._calcPadding(s[n],e);a+=s[n].width+d,n<s.length-1&&(r+="<div class='dhx_grid_v_border' style='left:"+a+"px'></div>")}r+="</div>",r+="<div class='dhx_grid_area'><table>";for(var n=0;n<i.length;n++)r+=scheduler._grid._print_event_row(i[n],e);
r+="</table></div>",scheduler._els.dhx_cal_data[0].innerHTML=r,scheduler._els.dhx_cal_data[0].lastChild.scrollTop=scheduler._grid._gridScrollTop||0;var l=scheduler._els.dhx_cal_data[0].getElementsByTagName("tr");scheduler._rendered=[];for(var n=0;n<l.length;n++)scheduler._rendered[n]=l[n]},scheduler._grid._print_event_row=function(e,t){var i=[];e.color&&i.push("background:"+e.color),e.textColor&&i.push("color:"+e.textColor),e._text_style&&i.push(e._text_style),scheduler[t].rowHeight&&i.push("height:"+scheduler[t].rowHeight+"px");
var s="";i.length&&(s="style='"+i.join(";")+"'");for(var r=scheduler[t].columns,a=scheduler.templates.event_class(e.start_date,e.end_date,e),n="<tr class='dhx_grid_event"+(a?" "+a:"")+"' event_id='"+e.id+"' "+s+">",d=scheduler._grid._getViewName(t),l=["text-align","vertical-align","padding-left","padding-right"],o=0;o<r.length;o++){var h;h=r[o].template?r[o].template(e.start_date,e.end_date,e):"date"==r[o].id?scheduler.templates[d+"_full_date"](e.start_date,e.end_date,e):"start_date"==r[o].id||"end_date"==r[o].id?scheduler.templates[d+"_single_date"](e[r[o].id]):scheduler.templates[d+"_field"](r[o].id,e);
var _=scheduler._grid._getStyles(r[o],l),c=r[o].css?' class="'+r[o].css+'"':"";n+="<td style='width:"+r[o].width+"px;"+_.join(";")+"' "+c+">"+h+"</td>"}return n+="<td class='dhx_grid_dummy'></td></tr>"},scheduler._grid._print_grid_header=function(e){for(var t="<div class='dhx_grid_line'>",i=scheduler[e].columns,s=[],r=i.length,a=scheduler._obj.clientWidth-2*i.length-20,n=0;n<i.length;n++){var d=1*i[n].initialWidth;isNaN(d)||""===i[n].initialWidth||null===i[n].initialWidth||"boolean"==typeof i[n].initialWidth?s[n]=null:(r--,a-=d,s[n]=d)
}for(var l=Math.floor(a/r),o=["text-align","padding-left","padding-right"],h=0;h<i.length;h++){var _=s[h]?s[h]:l;i[h].width=_-scheduler._grid._calcPadding(i[h],e);var c=scheduler._grid._getStyles(i[h],o);t+="<div style='width:"+(i[h].width-1)+"px;"+c.join(";")+"'>"+(void 0===i[h].label?i[h].id:i[h].label)+"</div>"}return t+="</div>"};
//# sourceMappingURL=../sources/ext/dhtmlxscheduler_grid_view.js.map