var initialRecordState="";var lastModifiedByLocking="";var releaseName=ReleaseConsolePage.Labels.New;var LabelNew=ReleaseConsolePage.Labels.New_Release;var tabName=ReleaseConsolePage.Labels.RM+": "+ReleaseConsolePage.Labels.New;var recordState="";var isRecordLock="";var categoryId="";var status="";var desc="";var isDeleted=false;var selectedCategoryId="";var isNeedToRefreshRelease=false;var isNeedToRefreshRelatedList=false;var isNeedToRefreshSmartView=false;var isFocusOnReleaseForm=true;var isFocusOnRelatedList=false;var isFocusOnSmartView=false;var isNewReleaseForm=false;var isNewRecordLock=false;var saveFromQuickClose=false;var isNeedToRefreshReleaseList=false;var waitMsgBar="";var isReleaseFormFrameLoaded=true;var isReleaseRelatedListFrameLoaded=true;var isReleaseSmartViewFrameLoaded=true;var clickedOnce=false;var isSaveForSingleConsole=true;var isSAVE=false;var screenWidth=671;var screenHeight=400;var ServiceTargetsBtnHandlerWindow;var SconsoletabName="";var isOptionalItemsAdded=false;var viewActionHistoryBtnHandler;var newActionHandler;var addNoteHandler;var ReopenBtnHandler;var CloseBtnHandler;var cloneBtnHandler;var ChangeScheduleBtnHandler;var knowledgeSearchBtnHandler;var CIExplorerBtnHandler;var ReleaseManifestBtnHandler;var submitforapprovalHandler;function screenLeft(a){return parseInt((screen.availWidth/2)-(a/2))}function screenTop(b){if(Ext.isChrome){var a=parseInt((screen.availHeight/2)-(screenHeight/2));return(a-25)}else{return parseInt((screen.availHeight/2)-(screenHeight/2))}}var left=screenLeft();var top=screenTop();var functionArray=new Array();function setReleaseData(a){functionArray[0]=a}function saveRelease(a){functionArray[1]=a}function assignRFLookupFilter(a){functionArray[2]=a}function getLookupFilterQuery(a){return functionArray[2](a)}function reopenRelease(){if(verifyChange()){handleSave()}Visualforce.remoting.Manager.invokeAction(_RemotingActions.reopenRelease,recordId,function(a,b){if(b.type==="exception"){alert(b.message);stopWaitMsgBar()}else{stopWaitMsgBar();if(isFocusOnReleaseForm){loadReleaseDetail(recordId)}if(isFocusOnRelatedList){loadReleaseDetail(recordId);loadReleaseRelatedList(recordId)}isNeedToRefreshRelatedList=true;isNeedToRefreshReleaseList=true;isNeedToRefreshSmartView=true}},{escape:true})}function LoadHandlerForActionItem(){cloneBtnHandler=function(e,f){var g=window.location.hash=!!window.MSInputMethodContext;if(Ext.isIE||g){hideMenu()}if(isServiceCloudConsole=="true"){sforce.console.openPrimaryTab(null,releaseConsole+"&record_id="+recordId+"&isCloneRequest=true&isServiceCloudConsole=true&ran="+new Date().getTime(),true,ReleaseConsolePage.Labels.New);return false}else{if(isRFConsoleDetailForm=="true"){window.parent.addTab(recordId,"","Release__c",true)}else{if(verifyChange()){var h=cloneBtnHandler;showCloseWarning(h,null)}else{isCloneRequest="true";startWaitMsgBar();loadReleaseDetail(recordId)}}}};var b;CloseBtnHandler=function(f,g){if(verifyChange()){Ext.Msg.defaultButton=1;Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:ReleaseConsolePage.Labels.closeConfirmMsg,buttons:Ext.Msg.OK,buttonText:{ok:ReleaseConsolePage.Labels.Ok},icon:Ext.MessageBox.INFO})}else{screenHeight=400;screenWidth=871;var i=new Object;i.startWaitMsgBar=startWaitMsgBar;i.isNeedToRefreshRelatedList=isNeedToRefreshRelatedList;i.loadReleaseDetail=loadReleaseDetail;i.isNeedToRefreshReleaseList=isNeedToRefreshReleaseList;i.startWaitMsgBar=startWaitMsgBar;i.refreshRelease=refreshRelease;var e="dialogWidth:"+screenWidth+"px;dialogHeight:"+screenHeight+"px;status;resizable;scrollbars:no;center:yes;dialogLeft:"+screenLeft(screenWidth)+"px;;dialogTop:"+screenTop(screenHeight)+"px;";var h=window.location.hash=!!window.MSInputMethodContext;if(!b||b.closed){if(window.showModalDialog&&(Ext.isIE||h)){b=window.showModalDialog("/apex/CloseRelease?releaseId="+recordId+"&calledFrom=rfconsole&isLookup=true",i,e)}else{e="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=yes,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);b=window.open("/apex/CloseRelease?releaseId="+recordId+"&calledFrom=rfconsole&isLookup=true","_blank",e)}}if(b!=""&&typeof(b)!="undefined"&&b.focus){b.focus()}}};ReopenBtnHandler=function(e,f){startWaitMsgBar();reopenRelease()};var a;addNoteHandler=function(e,f){if(!a||a.closed){a=window.open("/apex/stdlayoutreleaseaddnotepage?id="+recordId+"&fromconsole=true","addNote","width=600,height=400,resizable = 0,scrollbars=no,status=1,top=350,left=350")}if(a.focus){a.focus()}};var c;newActionHandler=function(e,f){c=window.open("/apex/searchPage?popupId=Action&isLookup=true&objectType=Release_History__c&isCalledFromConsole=true&enableSelfClosing=false&standardLayout=true&parentId="+recordId+"&filterClause=appliesToRelease__c%3Dtrue%20and%20system__c%3Dfalse","newAction","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=no");if(c.focus){c.focus()}};var d;viewActionHistoryBtnHandler=function(e,f){screenWidth=671;screenHeight=400;c=window.open("/apex/ViewAllActions?ObjectId="+recordId+"&recordState="+recordState+"&objectName=Release&recordName="+releaseName,"actionHistory","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=yes");if(c.focus){c.focus()}}}var openInVar="";var customActionJsonString="";var urlStringVar="";var custionActionObj="";function customActionHandler(a){openInVar=a.openIn;custionActionObj=a;getCustomActionURL(a.id)}function openUrl(){if(openInVar.indexOf("Remedyforce")!=-1){window.parent.parent.addNewTab(custionActionObj.id,customActionHeaderLabel,"NavigatorPage?title="+custionActionObj.encodedText+"&isCustomActionLink=true&target="+urlStringVar)}else{if(openInVar.toLowerCase().indexOf("window")!=-1){var a="resizable=1,scrollbars=1,fullscreen=1,toolbar=1,menubar=1,location=1,height="+screen.height+",width="+screen.width+",top = 0,left = 0";window.open(urlStringVar,"",a)}else{window.open(urlStringVar)}}}function getCustomActionURL(customId){var incId=recordId;eval(orgNamespace).JSRemoteActions.getCustomActionURL("Release",incId,customId,function(result,event){if(event.status){if(result!=""&&result!=null){urlStringVar=result;openUrl()}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:false})}function getDetailViewActionMenu(){if(ActionMenuItem=="-"){ActionMenuItem=""}var a=false;if(recordId==null||recordId==""){a=true}return Ext.create("Ext.menu.Menu",{id:"mainMenu",baseCls:"bmc-menu",shadow:false,items:ActionMenuItem,listeners:{mouseleave:{element:"el",delay:5000,fn:function(){this.hide()}}}})}var ReleaseRelatedListBtnhandler;function getDetailVeiwToolBar(){var e=function(f,g){if(isRFConsoleDetailForm=="true"){window.parent.addTab(null,"","Release__c")}else{if(isServiceCloudConsole=="true"){sforce.console.openPrimaryTab(null,releaseConsole+"&record_id=&isServiceCloudConsole=true&ran="+new Date().getTime(),true,ReleaseConsolePage.Labels.New);return false}else{if(verifyChange()){var h=e;showCloseWarning(h)}else{startWaitMsgBar();loadReleaseDetail(null);disableActionMenuItems(true)}}}};var b=function(g,h){startWaitMsgBar();Ext.getCmp("ReleaseFormBtnId").toggle(true);Ext.getCmp("actionButton").setDisabled(false);Ext.getCmp("agentToolsBtnId").setDisabled(false);if(isRecordLock&&isRecordLock.indexOf("true")>-1){Ext.getCmp("saveId").setDisabled(true)}else{if(!_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(true)}else{if(_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(false)}}}var f=document.getElementById("releaseRelatedListFrameId");hideDiv(f);var i=document.getElementById("releaseDetailsFrameId");if(i.src==""||isNeedToRefreshRelease==true){loadReleaseDetail(recordId)}else{showDiv(i);if(isActivityFeedEnabled==true){showActivityFeed()}if(isCISidebarEnabled==true){showRelatedCI()}if(isReleaseFormFrameLoaded){stopWaitMsgBar()}resizeReleaseDetailsFrameForIEEDGE()}};ReleaseRelatedListBtnhandler=function(g,h){Ext.getCmp("ReleaseReleatedListBtnId").toggle(true);Ext.getCmp("actionButton").setDisabled(false);Ext.getCmp("agentToolsBtnId").setDisabled(false);if(isRecordLock&&isRecordLock.indexOf("true")>-1){Ext.getCmp("saveId").setDisabled(true)}else{if(!_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(true)}else{if(_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(false)}}}startWaitMsgBar();var f=document.getElementById("releaseDetailsFrameId");hideDiv(f);hideActivityFeed();hideRelatedCI();var j=document.getElementById("releaseSmartViewFrameId");hideDiv(j);var i=document.getElementById("releaseRelatedListFrameId");if(i.src==""||isNeedToRefreshRelatedList==true){loadReleaseRelatedList(recordId)}else{showDiv(i);if(isReleaseRelatedListFrameLoaded){stopWaitMsgBar()}}};var a=function(h,i){Ext.getCmp("ReleaseSmartViewBtnId").toggle(true);Ext.getCmp("actionButton").setDisabled(true);Ext.getCmp("agentToolsBtnId").setDisabled(true);Ext.getCmp("saveId").setDisabled(true);var g=document.getElementById("releaseDetailsFrameId");hideDiv(g);hideActivityFeed();hideRelatedCI();var f=document.getElementById("releaseRelatedListFrameId");hideDiv(f);if(hasActivityFeedPermission!=undefined){if(hasActivityFeedPermission==true){loadContentsInSmartViews()}else{showSmartViewsError(isLoggedInUserAdmin)}stopWaitMsgBar()}else{checkSmartViewAccess(false)}};var c=function(f,g){functionArray[1]();if(isRFConsoleDetailForm){isSaveForSingleConsole=true;isSAVE=true}Ext.getCmp("ReleaseFormBtnId").toggle(true);var h=document.getElementById("releaseDetailsFrameId");showDiv(h)};var d=function(g,h){if(verifyChange()){var f=d;showCloseWarning(f)}else{startWaitMsgBar();if(isFocusOnReleaseForm){loadReleaseDetail(recordId)}else{if(isFocusOnRelatedList){loadReleaseRelatedList(recordId)}else{if(isFocusOnSmartView){loadReleaseSmartView(recordId)}else{loadReleaseDetail(null)}}}}};return Ext.create("Ext.toolbar.Toolbar",{id:"detailViewToolbarId",items:[{xtype:"tbspacer",width:5},{id:"newId",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:ReleaseConsolePage.Labels.New,tooltip:returnLabel(ReleaseConsolePage.Labels.New,"N"),disabled:!_ServerVariables.ObjectMetadata.isCreateable,handler:e},{xtype:"tbspacer",width:5},{id:"refreshId",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:ReleaseConsolePage.Labels.Undo,tooltip:ReleaseConsolePage.Labels.Undo_Consolebtn_Tooltip,handler:d},{xtype:"tbspacer",width:5},{id:"saveId",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",text:ReleaseConsolePage.Labels.Save,tooltip:returnLabel(ReleaseConsolePage.Labels.Save,"S"),disabled:!_ServerVariables.ObjectMetadata.isUpdateable,handler:c},{xtype:"tbspacer",width:5},"-",{id:"actionButton",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",text:ReleaseConsolePage.Labels.Actions,tooltip:returnLabel(ReleaseConsolePage.Labels.Actions,"A"),menu:getDetailViewActionMenu()},{id:"agentToolsBtnId",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"bmc-btn-dropdown-focus",overCls:"bmc-btn-dropdown-over",pressedCls:"bmc-btn-dropdown-pressed",text:ReleaseConsolePage.Labels.AgentTools,tooltip:returnLabel(ReleaseConsolePage.Labels.AgentTools,"T"),menu:getReleaseAgentToolsBtnMenu()},{id:"ReleaseFormBtnGroupId",xtype:"buttongroup",columns:5,border:false,frame:false,items:[{id:"ReleaseFormBtnId",cls:(!isRFConsoleDetailForm||parent.hideSmartViewbtn())?"bmc-togglebar-left-btn-smart-view-disable":"bmc-togglebar-left-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:ReleaseConsolePage.Labels.ReleaseForm,tooltip:ReleaseConsolePage.Labels.ReleaseForm,enableToggle:true,pressed:true,disabled:((recordId==null||recordId==""||recordId=="new")?true:false),toggleGroup:"releaseBtnGroup",handler:b,listeners:{toggle:{fn:function(f,g){if(g){isFocusOnReleaseForm=true}else{isFocusOnReleaseForm=false}}}}},{id:"ReleaseReleatedListBtnId",cls:(!isRFConsoleDetailForm||parent.hideSmartViewbtn())?"bmc-togglebar-right-btn":"bmc-togglebar-center-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:ReleaseConsolePage.Labels.RelatedLists,tooltip:ReleaseConsolePage.Labels.RelatedLists,enableToggle:true,disabled:((recordId==null||recordId==""||recordId=="new")?true:false),toggleGroup:"releaseBtnGroup",handler:ReleaseRelatedListBtnhandler,listeners:{toggle:{fn:function(f,g){if(g){isFocusOnRelatedList=true}else{isFocusOnRelatedList=false}}}}},{id:"ReleaseSmartViewBtnId",cls:"bmc-togglebar-right-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:ReleaseConsolePage.Labels.SmartView,tooltip:ReleaseConsolePage.Labels.SmartView,enableToggle:true,disabled:((recordId==null||recordId==""||recordId=="new"||isCloneRequest=="true")?true:false),toggleGroup:"releaseBtnGroup",handler:a,hidden:(!isRFConsoleDetailForm||parent.hideSmartViewbtn()),listeners:{toggle:{fn:function(f,g){if(g){isFocusOnSmartView=true}else{isFocusOnSmartView=false}f.doComponentLayout()}}}}]},{xtype:"tbfill"},{id:"LockRecord",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:ReleaseConsolePage.Labels.LockRecord,tooltip:_ServerLabels.LockRecordToolTip,hidden:true,disabled:!_ServerVariables.ObjectMetadata.isUpdateable},{id:"UnlockRecord",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:ReleaseConsolePage.Labels.UnlockRecord,tooltip:_ServerLabels.UnlockRecordToolTip,hidden:true,disabled:!_ServerVariables.ObjectMetadata.isUpdateable},{xtype:"tbspacer",width:5},{id:"LockRecordIcon",xtype:"label",hidden:true,cls:"d-icon-lock lock-color lock-icon",autoEl:{title:ReleaseConsolePage.Labels.LockedRecord}},{id:"LockRecordLbl",xtype:"label",text:ReleaseConsolePage.Labels.Locked,hidden:true,cls:"recordLockText"},{id:"UnlockRecordIcon",xtype:"label",hidden:true,cls:"d-icon-lock_open lock-icon",autoEl:{title:ReleaseConsolePage.Labels.UnlockedRecord}},{xtype:"tbspacer",width:0},{xtype:"tbseparator",id:"helpIconSeparator"},{xtype:"tbspacer",width:0},{xtype:"label",html:'<a href="#" onclick="OpenHelppage(\'Detail\');" title="'+_ServerLabels.Help+'" class="d-icon-question_circle help-icon"></a>'},{xtype:"tbspacer",width:10}]})}function getDetailViewPanel(){var a=Ext.create("Ext.Panel",{id:"detailViewChildPanelId",cls:"detail-view-position-fixed",border:false,hidden:(recordId==""),width:"100%",anchor:"0 0",layout:{type:"anchor"},tbar:getDetailVeiwToolBar(),items:[Ext.create("Ext.Panel",{border:false,anchor:"0 0",width:"100%",contentEl:"DetailFormDiv"})]});waitMsgBar=new Ext.LoadMask(a,{floating:{shadow:false},msgCls:"d-loader-container",msg:'<ul class="d-loading"><li class="d-loading__stick d-loading__stick_1"></li><li class="d-loading__stick d-loading__stick_2"></li><li class="d-loading__stick d-loading__stick_3"></li><li class="d-loading__stick d-loading__stick_4"></li><li class="d-loading__stick d-loading__stick_5"></li><li class="d-loading__stick d-loading__stick_6"></li><li class="d-loading__stick d-loading__stick_7"></li><li class="d-loading__stick d-loading__stick_8"></li><li class="d-loading__stick d-loading__stick_9"></li><li class="d-loading__stick d-loading__stick_10"></li><li class="d-loading__stick d-loading__stick_11"></li><li class="d-loading__stick d-loading__stick_12"></li></ul><div>'+_ServerLabels.PleaseWaitMsg+"</div>"});return a}function LoadRecord(a){if(verifyChange()){var b=LoadRecordFunc;showCloseWarning(b,a)}else{LoadRecordFunc(a)}}function LoadRecordFunc(a){console.log("Loading record...");console.log(a);recordId=a;startWaitMsgBar();if(recordId==null||recordId==""){loadReleaseDetail(null)}else{isNeedToRefreshRelatedList=true;loadReleaseDetail(a)}}function showDiv(a){a.style.display="block";a.style.height="100%";a.style.width="100%";var c=/chrome/i.test(navigator.userAgent);if(c){var b=a.clientHeight+2;b=(b/a.clientHeight)*100;a.style.height=b+"%"}}function hideDiv(a){a.style.display="none";a.style.height="0px";a.style.width="0px"}function LoadHandlerForAgentItem(){var a;var d;var c;ReleaseManifestBtnHandler=function(e,f){screenWidth=1100;screenHeight=650;windowFeatures="status = 1,height = "+screenHeight+", width = "+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1,scrollbars=yes";c=window.open("/apex/ReleaseManifest?id="+recordId+"&stdForm=true&objectName=release__c","Manifest",windowFeatures);if(c.focus){c.focus()}};var b;CIExplorerBtnHandler=function(f,g){screenWidth=1200;screenHeight=650;var e="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=no,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);b=window.open("/apex/CIExplorerLauncher?Module=Release__c&RecordSequence="+recordId+"&id="+recordId+"&stdForm=true&isCalledFromConsole=true","ReleaseCIExplorer",e);if(b.focus){b.focus()}};knowledgeSearchBtnHandler=function(e,f){screenHeight=400;screenWidth=671;a=window.open("/apex/KnowledgeSearch?enableSelfClosing=false&calledFromForm=true&standardLayout=true&isCalledFromConsole=true&objectName=Releases&search="+encodeURIComponent(desc)+"&isServiceCloudConsole="+isServiceCloudConsole,"KnowledgeSearch","status = 1, height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1, scrollbars=no");if(a.focus){a.focus()}};ChangeScheduleBtnHandler=function(e,f){screenHeight=700;screenWidth=1100;d=window.open("/apex/ChangeSchedule?standardLayout=true","ChangeSchedule","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1,scrollbars=no");if(d.focus){d.focus()}}}function getReleaseAgentToolsBtnMenu(){var a=false;if(recordId==null||recordId==""){a=true}return Ext.create("Ext.menu.Menu",{id:"AgentToolsMenu",baseCls:"bmc-menu",shadow:false,items:AgentMenuItem,listeners:{mouseleave:{element:"el",delay:5000,fn:function(){this.hide()}}}})}function loadReleaseRelatedList(d){isReleaseRelatedListFrameLoaded=false;isFocusOnRelatedList=true;isFocusOnReleaseForm=false;var a=document.getElementById("releaseDetailsFrameId");hideDiv(a);hideActivityFeed();hideRelatedCI();var c=document.getElementById("releaseSmartViewFrameId");hideDiv(c);var b=document.getElementById("releaseRelatedListFrameId");b.src="/apex/consoleReleaseRelatedList?id="+d+"&isdtp=vw";addOnLoadEvent(b,afterReleaseRelatedListFrameLoad);showDiv(b)}function loadReleaseSmartView(d){isFocusOnForm=false;isFocusOnRelatedList=false;isFocusOnSmartView=true;var b=document.getElementById("releaseDetailsFrameId");hideDiv(b);hideActivityFeed();hideRelatedCI();var a=document.getElementById("releaseRelatedListFrameId");hideDiv(a);var c=document.getElementById("releaseSmartViewFrameId");if(typeof((c)!="undefined"&&c.src=="")){c.src="/apex/DeepView?id="+d+"&isEmbeddedMode=true";addOnLoadEvent(c,afterReleaseSmartViewFrameLoad);showDiv(c)}}function refreshRelease(){if(isFocusOnReleaseForm){loadReleaseDetail(recordId);isNeedToRefreshRelatedList=true}else{loadReleaseRelatedList(recordId);isNeedToRefreshRelease=true;refreshReleaseFormTimeOut()}}function loadReleaseDetail(d){isReleaseFormFrameLoaded=false;isFocusOnRelatedList=false;isFocusOnReleaseForm=true;var a=document.getElementById("releaseRelatedListFrameId");hideDiv(a);var c=document.getElementById("releaseDetailsFrameId");if(d==null||d==""||isCloneRequest=="true"){isNewReleaseForm=true;isNewRecordLock=true;if(isCloneRequest=="true"){isCloneRequest="false";c.src="/apex/ConsoleReleaseDetail?oldReleaseId="+d;clickedOnce=true;handleChange()}else{c.src="/apex/ConsoleReleaseDetail?clientId="+_ServerVariables.PageParams.clientid}}else{isNewReleaseForm=false;c.src="/apex/ConsoleReleaseDetail?id="+d}addOnLoadEvent(c,afterReleaseDetailFrameLoad);if(isNewReleaseForm){Ext.getCmp("helpIconSeparator").hide();Ext.getCmp("detailViewToolbarId").doLayout()}else{addOptionalToolbarItems();Ext.getCmp("helpIconSeparator").show();Ext.getCmp("detailViewToolbarId").doLayout()}showDiv(c);var b=Ext.getCmp("detailViewChildPanelId");b.show();if(isActivityFeedEnabled==true&&isNewReleaseForm!=true&&isCloneRequest!="true"&&isFocusOnReleaseForm==true){displayActivityFeed=true}if(isCISidebarEnabled==true&&isNewReleaseForm!=true&&isCloneRequest!="true"&&isFocusOnReleaseForm==true){displayCISidebar=true}}function afterReleaseDetailFrameLoad(){if(isNewReleaseForm){afterNewFormLoad()}else{afterDetailFormLoad()}isNeedToRefreshRelease=false;isReleaseFormFrameLoaded=true;if(isDeleted){disableDetailFormButtons()}isDeleted=false;resizeReleaseDetailsFrameForIEEDGE()}function resizeReleaseDetailsFrameForIEEDGE(){if(checkIsIEBrowser()||(/Edge\/\d./i.test(navigator.userAgent))){document.getElementById("releaseDetailsFrameId").style.position="fixed";document.getElementById("releaseDetailsFrameId").style.height="92%"}}function afterReleaseRelatedListFrameLoad(){stopWaitMsgBar();isReleaseRelatedListFrameLoaded=true}function afterReleaseSmartViewFrameLoad(){var a=document.getElementById("releaseSmartViewFrameId");if(a&&a.src!=""){stopWaitMsgBar()}isReleaseSmartViewFrameLoaded=true}function afterNewFormLoad(){removeReleaseData();AttRefGeneratorId="";Ext.getCmp("saveId").setDisabled(false);Ext.getCmp("refreshId").setDisabled(false);if(Ext.getCmp("viewActionHistoryId")!=undefined&&Ext.getCmp("viewActionHistoryId")!=null){Ext.getCmp("viewActionHistoryId").setDisabled(true)}disableActionMenuItems(true);disableAgentMenuItems(true);if(isServiceCloudConsole=="true"){sforce.console.setTabTitle(LabelNew)}Ext.getCmp("ReleaseFormBtnId").toggle(false);Ext.getCmp("ReleaseReleatedListBtnId").toggle(false);Ext.getCmp("ReleaseFormBtnId").setDisabled(true);Ext.getCmp("ReleaseReleatedListBtnId").setDisabled(true);isNewReleaseForm=false;stopWaitMsgBar()}function afterDetailFormLoad(){if(functionArray[0]!="undefined"&&functionArray[0]!=null&&functionArray[0]!="null"&&functionArray[0]!=""){disableActionMenuItems(true);var h=functionArray[0]();var e=recordId;if(isRFConsoleDetailForm&&isSaveForSingleConsole){window.parent.changeTabTitle(tabId,h.Name);isSaveForSingleConsole=false;window.parent.updateDirtyFlag(tabId,false);if(e==null||e==""){window.parent.changeTabItemId(h.Id,tabId)}}if(e==null||e==""){enableCustomActions()}getReleaseData(h);Ext.getCmp("refreshId").setDisabled(false);if(Ext.getCmp("viewActionHistoryId")!=undefined&&Ext.getCmp("viewActionHistoryId")!=null){Ext.getCmp("viewActionHistoryId").setDisabled(false)}if(isServiceCloudConsole=="true"){sforce.console.setTabTitle(h.Name);SconsoletabName=h.Name;sforce.console.getFocusedPrimaryTabId(addSConsoleTabComplete)}var f=Ext.getCmp("ReleaseStatusId");if(f){f.update(h.Stage__c)}if(isFocusOnReleaseForm){Ext.getCmp("ReleaseFormBtnId").toggle(true)}Ext.getCmp("ReleaseFormBtnId").setDisabled(false);Ext.getCmp("ReleaseReleatedListBtnId").setDisabled(false);if(_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(false)}else{Ext.getCmp("saveId").setDisabled(true)}if(isFocusOnSmartView){Ext.getCmp("saveId").setDisabled(true)}var m=Ext.getCmp("closeButtonId");var g=Ext.getCmp("reopenButtonId");var j=Ext.getCmp("cloneButtonId");var l=Ext.getCmp("printId");var b=Ext.getCmp("printPDFId");var d=Ext.getCmp("addNoteId");var n=Ext.getCmp("newActionId");var c=Ext.getCmp("knowledgeSearchButtonId");var k=Ext.getCmp("ChangeScheduleId");var i=Ext.getCmp("CiExplorerButtonId");var a=Ext.getCmp("ReleaseManifestButtonId");if(recordState=="true"){if(_ServerVariables.ObjectMetadata.isUpdateable){if(m!=undefined&&m!=null){m.setDisabled(false)}if(n!=undefined&&n!=null){n.setDisabled(false)}if(d!=undefined&&d!=null){d.setDisabled(false)}checkApprovalstatus();if(typeof(recordLock)!="undefined"&&recordLock!=null&&recordLock!="Off"){if(!isSAVE||(isSAVE&&initialRecordState=="true")){if(typeof(isRecordLock)!="undefined"&&isRecordLock!=null&&isRecordLock.indexOf("false")>-1){if(recordLock=="Explicit"){if(isRecordLock.indexOf("##")>-1){recordLockedIcons("")}else{recordUnlockedIcons()}}else{if(recordLock=="Implicit"){getRecordLockedValue("recordLock")}}}else{enableRecordReadModeMsg(isRecordLock)}}isSAVE=false}}else{if(m!=undefined&&m!=null){m.setDisabled(true)}if(n!=undefined&&n!=null){n.setDisabled(true)}if(d!=undefined&&d!=null){d.setDisabled(true)}}if(c!=undefined&&c!=null){c.setDisabled(false)}if(g!=undefined&&g!=null){g.setDisabled(true)}}else{disableAllrecordLockIcons();if(m!=undefined&&m!=null){m.setDisabled(true)}if(d!=undefined&&d!=null){d.setDisabled(true)}if(n!=undefined&&n!=null){n.setDisabled(true)}if(c!=undefined&&c!=null){c.setDisabled(true)}if(_ServerVariables.ObjectMetadata.isUpdateable){if(g!=undefined&&g!=null){g.setDisabled(false)}}else{if(g!=undefined&&g!=null){g.setDisabled(true)}}}if(l!=undefined&&l!=null){l.setDisabled(false)}if(b!=undefined&&b!=null){b.setDisabled(false)}if(a!=undefined&&a!=null){a.setDisabled(false)}if(i!=undefined&&i!=null){i.setDisabled(false)}if(k!=undefined&&k!=null){k.setDisabled(false)}refreshReleaseListTimeOut();refreshReleaseRelatedListTimeOut();if(_ServerVariables.ObjectMetadata.isCreateable){if(j!=undefined&&j!=null){j.setDisabled(false)}}else{if(j!=undefined&&j!=null){j.setDisabled(true)}}}stopWaitMsgBar()}function refreshReleaseListTimeOut(){if(isNeedToRefreshReleaseList&&isServiceCloudConsole!="true"){isNeedToRefreshReleaseList=false;if(isRFConsoleDetailForm=="true"&&typeof(window.parent)!="undefined"&&typeof(window.parent)!=undefined){setTimeout(function(){window.parent.refreshListView("Release__c")},2000)}else{setTimeout(function(){doRefresh()},2000)}}}function refreshReleaseRelatedListTimeOut(){if(isNeedToRefreshRelatedList){var a=isFocusOnFormTab();setTimeout(function(){isNeedToRefreshRelatedList=false;isReleaseRelatedListFrameLoaded=false;var b=document.getElementById("releaseRelatedListFrameId");b.src="/apex/consoleReleaseRelatedList?id="+recordId+"&isdtp=vw";addOnLoadEvent(b,afterReleaseRelatedListFrameLoad);if(isActivityFeedEnabled==true){loadContentsInActivityFeed(a)}if(isCISidebarEnabled==true&&recordId){loadContentsInRelatedCIs(a)}},2000)}}function getReleaseData(a){recordId=a.Id;releaseName=a.Name;recordState=a.state__c;categoryId=a.FKCategory__c;status=a.Stage__c;desc=a.Description__c;if(desc!=null&&desc!=""&&desc.length>500){desc=desc.substring(0,500)}isRecordLock=a.isRecordLock}function removeReleaseData(){recordId=null;releaseName=ReleaseConsolePage.Labels.New;recordState="";categoryId="";status=""}function startWaitMsgBar(){if(waitMsgBar!=""){waitMsgBar.setVisible(true)}}function setIsNeedToRefreshRelatedList(a){isNeedToRefreshRelatedList=a}function stopWaitMsgBar(){if(waitMsgBar!=""&&waitMsgBar.isVisible()){waitMsgBar.setVisible(false)}}function disableDetailFormButtons(){Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("refreshId").setDisabled(true);Ext.getCmp("ReleaseFormBtnId").setDisabled(true);Ext.getCmp("ReleaseReleatedListBtnId").setDisabled(true);Ext.getCmp("ReleaseSmartViewBtnId").setDisabled(true);Ext.getCmp("agentToolsBtnId").setDisabled(true);Ext.getCmp("actionButton").setDisabled(true)}function ReleaseConsolePageinReadMode(){Ext.getCmp("saveId").setDisabled(true);if(Ext.getCmp("reopenButtonId")!=undefined&&Ext.getCmp("reopenButtonId")!=null){Ext.getCmp("reopenButtonId").setDisabled(true)}if(Ext.getCmp("closeButtonId")!=undefined&&Ext.getCmp("closeButtonId")!=null){Ext.getCmp("closeButtonId").setDisabled(true)}if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(true)}}function RTFEnabledPage(){if(isRTFEnabledReleasePage=="true"){return true}else{return false}}function afterSaveSucceed(){if(!isDeleted){isNeedToRefreshReleaseList=true;isNeedToRefreshRelatedList=true;addOptionalToolbarItems();afterReleaseDetailFrameLoad()}else{isNeedToRefreshReleaseList=true;refreshReleaseListTimeOut()}if(isActivityFeedEnabled==true){displayActivityFeed=true}if(isCISidebarEnabled==true){displayCISidebar=true}Ext.getCmp("ReleaseSmartViewBtnId").setDisabled(false);clickedOnce=false;if(isServiceCloudConsole=="true"){sforce.console.setTabUnsavedChanges(false)}var a=Ext.getCmp("detailViewToolbarId").items;Ext.getCmp("helpIconSeparator").show();Ext.getCmp("detailViewToolbarId").doLayout()}function hideMenu(){var b=Ext.getCmp("mainMenu");if(b!="undefined"&&b!=null&&b!=""){Ext.getCmp("mainMenu").hide()}var a=Ext.getCmp("AgentToolsMenu");if(a!="undefined"&&a!=null&&a!=""){Ext.getCmp("AgentToolsMenu").hide()}}function refreshRelatedLists(){isNeedToRefreshRelatedList=true;refreshReleaseRelatedListTimeOut()}function disableAgentMenuItems(a){if(Ext.getCmp("knowledgeSearchButtonId")!=undefined&&Ext.getCmp("knowledgeSearchButtonId")!=null){Ext.getCmp("knowledgeSearchButtonId").setDisabled(a)}if(Ext.getCmp("CiExplorerButtonId")!=undefined&&Ext.getCmp("CiExplorerButtonId")!=null){Ext.getCmp("CiExplorerButtonId").setDisabled(a)}if(Ext.getCmp("ChangeScheduleId")!=undefined&&Ext.getCmp("ChangeScheduleId")!=null){Ext.getCmp("ChangeScheduleId").setDisabled(a)}if(Ext.getCmp("ReleaseManifestButtonId")!=undefined&&Ext.getCmp("ReleaseManifestButtonId")!=null){Ext.getCmp("ReleaseManifestButtonId").setDisabled(a)}}function disableActionMenuItems(a){if(Ext.getCmp("reopenButtonId")!=undefined&&Ext.getCmp("reopenButtonId")!=null){Ext.getCmp("reopenButtonId").setDisabled(a)}if(Ext.getCmp("closeButtonId")!=undefined&&Ext.getCmp("closeButtonId")!=null){Ext.getCmp("closeButtonId").setDisabled(a)}if(Ext.getCmp("cloneButtonId")!=undefined&&Ext.getCmp("cloneButtonId")!=null){Ext.getCmp("cloneButtonId").setDisabled(a)}if(Ext.getCmp("printId")!=undefined&&Ext.getCmp("printId")!=null){Ext.getCmp("printId").setDisabled(a)}if(Ext.getCmp("printPDFId")!=undefined&&Ext.getCmp("printPDFId")!=null){Ext.getCmp("printPDFId").setDisabled(a)}if(Ext.getCmp("addNoteId")!=undefined&&Ext.getCmp("addNoteId")!=null){Ext.getCmp("addNoteId").setDisabled(a)}if(Ext.getCmp("newActionId")!=undefined&&Ext.getCmp("newActionId")!=null){Ext.getCmp("newActionId").setDisabled(a)}if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(a)}}function setTabUnsavedChanges(){if(isServiceCloudConsole=="true"){sforce.console.setTabUnsavedChanges(true)}}document.onkeydown=function(g){var c,a,d;d=0;if(isRFConsoleDetailForm=="true"){c=window.parent;d=window.parent.count}a=window.self;var f=document.getElementById("releaseDetailsFrameId");var b="";if(f.src==""){b="ListViewNewButton"}else{if((typeof(f)!="undefined"&&f!=null)&&f.src!=""){b="newId"}}if(!window.isRFHotkeysDisabled){handleShortcuts(g,c,a,d,isRFConsoleDetailForm,b)}};function addSConsoleTab(c,b){try{SconsoletabName=b;sforce.console.openPrimaryTab(null,c,true," ",addSConsoleTabComplete)}catch(a){}}function addSConsoleTabComplete(a){try{var c=new Date();c.setYear(c.getFullYear()+10);if(a.success==true){document.cookie="SconsoletabName="+a.id+";path=/;SameSite=None;Secure;expires="+c.toUTCString()}else{if(Ext.util.Cookies.get(SconsoletabName)!=null){sforce.console.focusPrimaryTabById(Ext.util.Cookies.get(SconsoletabName))}}}catch(b){}}function refreshReleaseFormTimeOut(){if(isNeedToRefreshRelease){var a=isFocusOnFormTab();setTimeout(function(){isNeedToRefreshRelease=false;var b=document.getElementById("releaseDetailsFrameId");b.src="/apex/ConsoleReleaseDetail?id="+recordId;if(isActivityFeedEnabled==true){loadContentsInActivityFeed(a)}if(isCISidebarEnabled==true&&recordId){loadContentsInRelatedCIs(a)}},2000)}}function loadContentsInRelatedCIs(a){if(isBaseElementAccessible==true&&isServicesAndCISliderEnabled==true){RelatedCIRefreshStarted();var b=document.getElementById("relatedCISmartViewSidebarFrameId");if(typeof b!="undefined"&&b!=null){b.src="/apex/CIAssetSlideIn?id="+recordId+"&objName=Release__c"}if(a){enableRelatedCI()}}}function enableCustomActions(){var b=Ext.getCmp("mainMenu").items;if(b!="undefined"&&b!=null&&b!=""){for(var d=0;d<b.length;d++){var a=b.items[d];if(a.id!="undefined"&&a.openIn!="undefined"&&typeof(a.openIn)!="undefined"){Ext.getCmp(a.id).setDisabled(false)}}}var c=Ext.getCmp("AgentToolsMenu").items;if(c!="undefined"&&c!=null&&c!=""){for(var d=0;d<c.length;d++){var a=c.items[d];if(a.id!="undefined"&&a.openIn!="undefined"&&typeof(a.openIn)!="undefined"){Ext.getCmp(a.id).setDisabled(false)}}}}function loadContentsInActivityFeed(a){if(isCalledFromActivityFeed!=true){activityFeedRefreshStarted();var b=document.getElementById("releaseSmartViewSidebarFrameId");if(typeof b!="undefined"&&b!=null){b.src="/apex/DeepView?id="+recordId+"&showSidebarOnly=true&moduleName=Release__c"}}isCalledFromActivityFeed=false;if(a){enableActivityFeed()}}function addOptionalToolbarItems(){if(!isOptionalItemsAdded){var a=Ext.getCmp("detailViewToolbarId");var b=0;a.insert(++b,{xtype:"label",id:"ReleaseStatusId",cls:"recordStage",text:status});a.insert(++b,{xtype:"tbspacer",width:5});a.insert(++b,"-");a.insert(++b,{xtype:"tbspacer",width:5});isOptionalItemsAdded=true}}function loadContentsInSmartViews(){var a=document.getElementById("releaseSmartViewFrameId");showDiv(a);if(typeof((a)!="undefined"&&a.src=="")||isNeedToRefreshSmartView==true){startWaitMsgBar();loadReleaseSmartView(recordId)}else{showDiv(a)}stopWaitMsgBar()}function addOnLoadEvent(b,a){if(b.addEventListener){b.addEventListener("load",a)}else{if(b.attachEvent){b.attachEvent("onload",a)}}};