var isFisrtLoad=true;var isConfigurationChanged="";Ext.define("Ext.ux.form.ItemSelector",{extend:"Ext.ux.form.MultiSelect",alias:["widget.itemselectorfield","widget.itemselector"],alternateClassName:["Ext.ux.ItemSelector"],requires:["Ext.button.Button","Ext.ux.form.MultiSelect"],hideNavIcons:false,buttons:["add","remove"],buttonsText:{top:"Move to Top",up:"Move Up",add:"Add to Selected",remove:"Remove from Selected",down:"Move Down",bottom:"Move to Bottom"},layout:{type:"hbox",align:"stretch"},initComponent:function(){var a=this;a.ddGroup=a.id+"-dd";a.callParent();a.bindStore(a.store)},createList:function(b){var a=this;return Ext.create("Ext.ux.form.MultiSelect",{submitValue:false,getSubmitData:function(){return null},getModelData:function(){return null},flex:1,title:b,store:{model:a.store.model,data:[]},displayField:a.displayField,valueField:a.valueField,disabled:a.disabled,listeners:{boundList:{scope:a,itemdblclick:a.onItemDblClick,itemmouseenter:a.onItemMouseEnter}}})},setupItems:function(){var a=this;a.fromField=a.createList(a.fromTitle);a.toField=a.createList(a.toTitle);return[a.fromField,{xtype:"container",margins:"0 18",layout:{type:"vbox",pack:"Top"},items:a.createButtons()},a.toField]},createButtons:function(){var b=this,a=[];if(!b.hideNavIcons){Ext.Array.forEach(b.buttons,function(c){a.push({xtype:"button",tooltip:b.buttonsText[c],handler:b["on"+Ext.String.capitalize(c)+"BtnClick"],cls:Ext.baseCSSPrefix+"form-itemselector-btn",iconCls:Ext.baseCSSPrefix+"form-itemselector-"+c,navBtn:true,scope:b,width:14,margin:"10 0 0 0"})})}return a},getSelections:function(b){var a=b.getStore();return Ext.Array.sort(b.getSelectionModel().getSelection(),function(d,c){d=a.indexOf(d);c=a.indexOf(c);if(d<c){return -1}else{if(d>c){return 1}}return 0})},onAddBtnClick:function(){var b=this,a=b.getSelections(b.fromField.boundList);b.moveRec(true,a);b.toField.boundList.getSelectionModel().select(a)},onRemoveBtnClick:function(){var b=this,a=b.getSelections(b.toField.boundList);b.moveRec(false,a);b.fromField.boundList.getSelectionModel().select(a)},moveRec:function(f,e){var c=this,g=c.fromField,a=c.toField,b=f?g.store:a.store,d=f?a.store:g.store;b.suspendEvents();d.suspendEvents();b.remove(e);d.add(e);b.resumeEvents();d.resumeEvents();isEntitlementChanged=true;g.boundList.refresh();a.boundList.refresh();c.syncValue()},syncValue:function(){var a=this;a.mixins.field.setValue.call(a,a.setupValue(a.toField.store.getRange()))},onItemDblClick:function(a,b){this.moveRec(a===this.fromField.boundList,b)},onItemMouseEnter:function(f,a,d,b,g,c){if(!d.title){d.setAttribute("title",RemedyForceHTMLProcessor.htmlDecoder(a.data.text))}},setValue:function(g){var e=this,h=e.fromField,a=e.toField,b=h.store,f=a.store,c;if(!e.fromStorePopulated){e.fromField.store.on({load:Ext.Function.bind(e.setValue,e,[g]),single:true});return}g=e.setupValue(g);e.mixins.field.setValue.call(e,g);c=e.getRecordsForValue(g);b.suspendEvents();f.suspendEvents();b.removeAll();var d=e.id;if(d!="accountSelector"||isEntitlementRefreshed||(PreviousConfig!=null&&PreviousConfig!=""&&PreviousConfig!=currentConfig&&isConfigurationChanged!=currentConfig)){f.removeAll()}e.populateFromStore(e.store);Ext.Array.forEach(c,function(i){if(b.indexOf(i)>-1){b.remove(i)}if(d!="accountSelector"||f.data.items.indexOf(i)>-1||isFisrtLoad||isEntitlementRefreshed||(PreviousConfig!=currentConfig&&PreviousConfig!=null&&PreviousConfig!=""&&isConfigurationChanged!=currentConfig)){f.add(i)}});isConfigurationChanged=currentConfig;isEntitlementRefreshed=false;b.resumeEvents();f.resumeEvents();Ext.suspendLayouts();h.boundList.refresh();a.boundList.refresh();Ext.resumeLayouts(true)},onBindStore:function(a,b){var d=this;if(d.fromField){d.fromField.store.removeAll();var c=d.id;if(c!="accountSelector"||isEntitlementRefreshed||(PreviousConfig!=currentConfig)&&(PreviousConfig!=null&&PreviousConfig!=""&&isConfigurationChanged!=currentConfig)){d.toField.store.removeAll()}if(a.getCount()){d.populateFromStore(a)}else{d.store.on("load",d.populateFromStore,d)}}},populateFromStore:function(a){var b=this.fromField.store;this.fromStorePopulated=true;b.add(a.getRange());b.fireEvent("load",b)},onEnable:function(){var a=this;a.callParent();a.fromField.enable();a.toField.enable();Ext.Array.forEach(a.query("[navBtn]"),function(b){b.enable()})},onDisable:function(){var a=this;a.callParent();a.fromField.disable();a.toField.disable();Ext.Array.forEach(a.query("[navBtn]"),function(b){b.disable()})},onDestroy:function(){this.bindStore(null);this.callParent()}});