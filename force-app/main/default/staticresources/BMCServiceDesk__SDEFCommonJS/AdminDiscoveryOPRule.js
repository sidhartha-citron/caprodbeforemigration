var gridrowIndex,isOPRuleLoaded=false,orStore,validateOPRuleInterval=false;function CreateOPRuleSection(){orStore=Ext.create("Ext.data.ArrayStore",{fields:[{name:"OR_Status"},{name:"OR_StatusValue"},{name:"Status"},{name:"Status_ID"}],data:orData});function a(g,e,c,h,f,d){return'<table style="width: 99%"><tr class="slds-line-height_reset"><td style="width:155px;"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none"><input id= "'+c.get("OR_StatusValue")+'" onkeypress="return statusBoxKeyPressed(event,'+h+')" class= "clsInputTextBox slds-input slds-combobox__input slds-combobox__input-value" type="text" value="'+g+'" /><span class="rf-icon search-iconCls slds-icon_container slds-icon-utility-search slds-input__icon slds-input__icon_right" onClick="gridrowIndex = '+h+'; openStatusLookup()"><span class="taskLookupIconCls"><svg xmlns="http://www.w3.org/2000/svg" class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#search" /></svg></span><span class="taskLookupIconClsForIE"></span></span></div></td></tr></table>'}var b=Ext.create("Ext.grid.Panel",{id:"MappingGrid",renderTo:"mappingGrid",store:orStore,height:275,width:485,cls:"gridFontCls",columns:[{id:"OR_Status",header:ORStatusLabel,width:180,sortable:false,menuDisabled:true,dataIndex:"OR_Status"},{id:"OR_StatusValue",header:"OR Status Value",hidden:true,width:100,sortable:false,menuDisabled:true,dataIndex:"OR_StatusValue"},{id:"Status",header:taskStatusLabel,width:130,sortable:false,menuDisabled:true,dataIndex:"Status",renderer:a},{id:"Status_ID",header:"Status_ID",hidden:true,sortable:false,menuDisabled:true,dataIndex:"Status_ID"}],stripeRows:true,autoScroll:false,autoExpandColumn:"Status",border:true,forceFit:true,viewConfig:{scrollOffset:0},listeners:{itemclick:function(i,c,g,d,h,f){gridrowIndex=d}}});statusBoxKeyPressed=function(c,f){if(c.keyCode==Ext.EventObject.BACKSPACE||c.keyCode==Ext.EventObject.DELETE){gridrowIndex=f;var d=Ext.getCmp("MappingGrid").store.getAt(f);d.set("Status_ID","");document.getElementById(d.get("OR_Status")).value=""}};hideLoadingMask();HourSpiner=Ext.create("Ext.form.NumberField",{id:"HrSpiner_OP",allowNegative:false,allowDecimals:false,minValue:0,maxValue:10000,maxLength:5,value:opHours,width:40,renderTo:"hourSpiner_OP",listeners:{change:function(f,e,c,d){opHours=e}}});MinSpiner=Ext.create("Ext.form.NumberField",{id:"MinuteSpiner_OP",allowNegative:false,allowDecimals:false,minValue:0,maxValue:59,maxLength:2,value:opMinutes,width:40,renderTo:"minSpiner_OP",listeners:{change:function(f,e,c,d){opMinutes=e}}});validateOPRuleInterval=!isOPIntervalStopped}function openStatusLookup(){var a=Ext.getCmp("MappingGrid").store.getAt(gridrowIndex);onCompleteFunction=setStatusValue;var b="SearchAndLink?txt="+a.get("OR_StatusValue")+"&frm=linkingPage:theForm&filterObjectId=&parentName=Task__c&childName=Status__c&isLookUp=Status__c&filterId=active_custom&addlFilterId=status_ta&lightningUI=true";showLightningPopup("vfModalPage",selectFromStatusLabel,b,500,800)}function setStatusValue(d){var a=Ext.getCmp("MappingGrid");if(d.indexOf(EF)>0){var c=a.getStore().getAt(gridrowIndex);c.set("Status_ID",d.split(EF)[0]);var b=c.get("OR_StatusValue");document.getElementById(b).value=decodeVal(d.split(EF)[1])}rfPopUpClose("rfModalVFPage")}function decodeVal(a){a=a.replace("&gt;",">","g");a=a.replace("&lt;","<","g");a=a.replace("&quot;",'"',"g");a=a.replace("&amp;","&","g");return a}function setPopUpVar(b,a){if(b!=null&&b!=""&&onCompleteFunction!=null){onCompleteFunction(b,a)}}function SaveOPIntervalHandler(b){validateOPRuleInterval=isOPIntervalStopped;var a=getOPIntervalData();if(a!=false){isOPIntervalStopped=!isOPIntervalStopped;if(isOPIntervalStopped){b.value=StartLbl}else{b.value=StopLbl}saveOPRuleInterval(a,isOPIntervalStopped)}}function getGridData(){var c="";var a=0;var b="";if(orStore!=undefined&&orStore!=null){while(orStore.data.length>a){b=orStore.getAt(a).get("Status_ID");c=c+orStore.getAt(a).get("OR_StatusValue")+PE+b+nonPrint;a++}}return c}function getOPIntervalData(){var c=0;var a;var b;if(validateOPRuleInterval&&!HourSpiner.getValue()&&!MinSpiner.getValue()){window.parent.Ext.MessageBox.show({msg:timeMandatoryError,buttons:Ext.MessageBox.OK});return false}else{if(HourSpiner.getValue()==null){a=0}else{a=HourSpiner.getValue()}if(MinSpiner.getValue()==null){b=0}else{b=MinSpiner.getValue()}c=(parseInt(a)*60)+parseInt(b);return c}};