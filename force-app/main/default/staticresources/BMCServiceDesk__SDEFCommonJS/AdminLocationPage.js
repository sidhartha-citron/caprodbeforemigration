var savefirstTime;var saveSuccessful=true;var PhysicalLocationName;var activeAllWindowFlag=true;var rerenderPage=false;var waitMask;var dataPresent;var idSetString="";Ext.onReady(function(){hideUserPicklist();setTypeAheadForLookups();waitMask=new Ext.LoadMask(Ext.getBody(),{msg:saveMaskMsg});var g=function(h,i){activeAllWindowFlag=false;window.parent.addTab("AdminLocationPage","Location","Location")};var f=function(h,i){Ext.getCmp("saveId").setDisabled(true);if(waitMask!=null){waitMask.show()}save();Ext.getCmp("saveId").setDisabled(false);if(savefirstTime==true){disableNextPreviousBtn()}else{enableNextPreviousBtn()}};var b=function(h,i){resetPhysicalLocation()};var e=function(h,i){if(document.getElementById("nextId").disabled!=true){createWACSet();nextBtnWACHandler(idSetString)}};var a=function(h,i){if(document.getElementById("prevId").disabled!=true){createWACSet();previousBtnWACHandler(idSetString)}};Ext.create("Ext.toolbar.Toolbar",{title:"",cls:"toolSpCls",height:35,id:"rf-webapi-toolbar",renderTo:"btnToolbar",items:[{xtype:"button",scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:tooltipNew,scope:this,id:"newId",handler:g},{scale:"medium",iconCls:"bmcSave",tooltipType:"title",id:"saveId",scope:this,tooltip:tooltipSave,handler:f},{scale:"medium",tooltipType:"title",tooltip:tooltipCopy,iconCls:"bmcCopy",scope:this,id:"copyId",handler:function(){activeAllWindowFlag=false;window.parent.addTab("AdminLocationPage?copyId="+PhysicalLocationId+"",PhysicalLocationHeader,PhysicalLocationHeader)},disabled:isLocationCreatable},{xtype:"tbseparator",id:"tbseparatorId"},{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:tooltipDelete,scope:this,id:"deleteId",handler:DeleteBtnHandler,disabled:isLocationDeletable},{scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:tooltipRefresh,id:"resetId",handler:b},"->",{xtype:"box",id:"prevId",autoEl:{tag:"img",src:(b_previous),title:tooltipPreviousRecord},cls:"cursorCls",listeners:{render:function(h){h.el.on("click",a)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:b_next,title:tooltipNextRecord},cls:"cursorSpaceCls",listeners:{render:function(h){h.el.on("click",e)}}}]});if(PhysicalLocationId==null||PhysicalLocationId==""){savefirstTime=true;Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconCls("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);if(isLocationCreatable==false){Ext.getCmp("saveId").setDisabled(true)}disableNextPreviousBtn()}else{Ext.getCmp("saveId").setDisabled(!isLocationUpdatable);if(isLocationDeletable){Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconCls("bmcDelete")}else{Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconCls("bmcDeleteDisable")}Ext.getCmp("copyId").setDisabled(!isLocationCreatable);Ext.getCmp("newId").setDisabled(!isLocationCreatable);Ext.getCmp("resetId").setDisabled(false);if(WACset!=undefined&&WACset.length<=1){disableNextPreviousBtn()}else{enableNextPreviousBtn()}savefirstTime=false}setLeftPropertyOfToolbar();previousBtnAlign();Ext.create("Ext.panel.Panel",{layout:{type:"vbox",align:"stretch",pack:"start",split:true,collapsible:true},id:"mainPanel",height:"auto",width:"auto",items:[{xtype:"panel",layout:"fit",flex:0.3,border:false,overflowX:"hidden",overflowY:"auto",contentEl:"northcontent"},{xtype:"splitter",id:"SplitTab",collapsible:true,collapseTarget:"next",animate:true,width:85,height:10,layout:"stretch"},{xtype:"panel",id:"childPanel",layout:"fit",height:0,flex:0.33,html:'<iframe id= "SIIframeID" src="" scrolling="no" style="width:100%;height:100%;display:none;border: none"></iframe>',title:"",collapsible:true,collapseDirection:"bottom",animCollapse:false,headerPosition:"top",listeners:{resize:function(m,l,h,j,n,k){var i=window.frames.SIIframeID.contentWindow;if(i!=""&&i!=undefined&&i.detailsPanel!=""&&i.detailsPanel!=undefined){if(h<315){i.detailsPanel.setHeight(285)}else{i.detailsPanel.setHeight(h-30)}}}}}],renderTo:"content-div"});var d=Ext.getCmp("childPanel");resizePanels();d.collapse();handleElemEvent();d.setTitle(labelLocationSupportingInformation);refreshSupportingInfo();d.on("expand",resizepanelsexpand,this,{});d.on("collapse",resizepanelscollapse,this,{});d.on("resize",resize,this,{});if(isReadOnly!=undefined&&isReadOnly.toUpperCase()=="TRUE"){var c=document.getElementById("btnToolbar");if(c!=undefined){c.style.display="none"}makeOnlyReadOnlyField()}});function refreshSupportingInfo(){if(PhysicalLocationId!=null&&PhysicalLocationId!=""){Ext.getCmp("childPanel").setDisabled(false);getInfoPane(PhysicalLocationId,PhysicalLocationInstId)}else{Ext.getCmp("childPanel").setDisabled(true)}}function getInfoPane(e,c){var b="";var a="/apex/SIContainerPage?oid="+e+"&otype=Base_Location&wid=&isInactive=false&filterClause="+b+"&isCIExplorer=true&InstId="+c;var d=document.getElementById("SIIframeID");if(d!=undefined){d.style.display="none";d.src=a;d.style.display="block"}}function resizePanels(){var c={};c.width=Ext.getBody().getViewSize().width;c.height=Ext.getBody().getViewSize().height;var b=Ext.getCmp("mainPanel");b.setSize(c.width,c.height);document.getElementById("northcontent").style.width=c.width+"px";if(isChildPanelCollapsed){resizepanelscollapse()}else{resizepanelsexpand()}Ext.getCmp("rf-webapi-toolbar").setWidth(c.width);var a=window.frames.SIIframeID.contentWindow;if(a!=""&&a!=undefined&&a.detailsPanel!=""&&a.detailsPanel!=undefined){a.detailsPanel.setWidth(c.width-23)}}function resizepanelsexpand(){isChildPanelCollapsed=false;var a=document.getElementById("childPanel").style.height;childpanelheight=parseInt(a,10);document.getElementById("northcontent").style.height=(Ext.getBody().getViewSize().height-(childpanelheight+65))+"px"}function resizepanelscollapse(){isChildPanelCollapsed=true;document.getElementById("northcontent").style.height="100%"}function resize(){if(isChildPanelCollapsed){resizepanelscollapse()}else{resizepanelsexpand()}}function disableNextPreviousBtn(){var a=document.getElementById("prevId");var b=document.getElementById("nextId");if(Ext.isIE8){if(a!=null){a.className=a.className+" x-item-disabled";a.disabled=true}if(b!=null){b.className=b.className+" x-item-disabled";b.disabled=true}}else{Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true)}}function enableNextPreviousBtn(){var a=document.getElementById("prevId");var b=document.getElementById("nextId");if(Ext.isIE8){if(a!=null){a.style.filter="alpha(opacity=100)";a.style.cursor="pointer"}if(b!=null){b.style.filter="alpha(opacity=100)";b.style.cursor="pointer"}}else{Ext.getCmp("prevId").setDisabled(false);Ext.getCmp("nextId").setDisabled(false)}}function setLeftPropertyOfToolbar(){var d=document.getElementById("saveId");var f=document.getElementById("copyId");var c=document.getElementById("resetId");var a=document.getElementById("tbseparatorId");var e=document.getElementById("deleteId");var b;if(d!=null&&d!=""){b=parseInt(d.style.left,10);d.style.left=(b-2)+"px"}if(f!=null&&f!=""){b=parseInt(f.style.left,10);f.style.left=(b-3)+"px"}if(a!=null&&a!=""){b=parseInt(a.style.left,10);a.style.left=(b-4)+"px"}if(e!=null&&e!=""){b=parseInt(e.style.left,10);e.style.left=(b-2)+"px"}if(c!=null&&c!=""){b=parseInt(c.style.left,10);c.style.left=(b-6)+"px"}}function previousBtnAlign(){var a=document.getElementById("prevId");var c=document.getElementById("nextId");var b=a.style.left;b=b.toString().slice(0,-2);b=parseInt(b,10);b=b+2;b=b.toString();b=b+"px";a.style.left=b}function showDeleteMsg(){Ext.MessageBox.confirm(tooltipDelete,deleteConfirm,function(a){if(a==="yes"){DeleteRecord()}})}function refreshListView(){window.parent.refreshList();window.parent.closeTab(wid)}function generateObjPreFixMap(b){var d=b.prefixList;for(var c=0;c<d.length;c++){ObjectPrefixMap[c]=new Array(2);var a=d[c];var e=a.split(":");ObjectPrefixMap[c][0]=e[0];ObjectPrefixMap[c][1]=e[1]}ObjectPrefixMap[d.length]=new Array(2);ObjectPrefixMap[d.length][0]="005";ObjectPrefixMap[d.length][1]="User";ObjectPrefixMap[d.length+1]=new Array(2);ObjectPrefixMap[d.length+1][0]="StandardUserLookup";ObjectPrefixMap[d.length+1][1]="User";prefixMap=ObjectPrefixMap}var lookupObject;function openLookup(c,d,o,l){if(isReadOnly==undefined||isReadOnly.toUpperCase()!="TRUE"){var f=c.split("&");var b="";if(f.length>2){var p=c.search("lkpr=")>0?f[2].split("="):f[1].split("=");b=p[1];currentField=document.getElementById(b);isFromLookup=true}for(var k=0;k<f.length;k++){if(f[k]!=undefined){urlArr2=f[k].split("=");if(urlArr2[0]=="lktp"){lookupType=urlArr2[1]}}}for(var k=0;k<ObjectPrefixMap.length;k++){if(lookupType==ObjectPrefixMap[k][0]){lookupObject=ObjectPrefixMap[k][1];break}}var g="";if(lookupType=="StandardUserLookup"){lookupObject="User";g="active_standard"}var n="";l=decodeURIComponent((l+"").replace(/\+/g,"%20"));var m=l.split("=");if(m.length==2){n=m[1];if(n!=null){n=n.trim();n=encodeURIComponent(n);if(n!=""&&n.length<2){n=""}}}var a=parseInt((screen.availWidth/2)-(1000/2));var j=parseInt((screen.availHeight/2)-(600/2));var e=true;var h="";c=orgNamespace+"SearchAndLink?txt="+b;c=c+"&filterObjectId=a1FA0000002p3Or&parentName=BMC_BaseElement__c&childName="+lookupObject+"&isLookUp="+lookupObject+"&NewLookUpType="+h+"&filterId="+g+"&searchLookUpStr="+n+"&isCustomLookup="+e;openPopup(c,"lookup",350,480,"width=1000,height=600,toolbar=no,status=no,left= "+a+",top="+j+",directories=no,menubar=no,resizable=yes,scrollable=no",true)}}function showLoadingMask(){if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.show()}}function handleSave(){window.parent.handleSave(wid,PhysicalLocationId)}function afterSave(){if(waitMask!=null){waitMask.hide()}if(SavedSuccessfully==msgFromServer){window.parent.refreshList();updateTitle();buttonValidator();refreshSupportingInfo();ShowInlineMessage("SaveMessageDiv","rf-webapi-toolbar",-50)}}var firstClick=true;function updateTitle(){if(newTitle!=""){window.parent.changeTitle(wid,newTitle,PhysicalLocationHeader)}}function getWID(){return wid}function activateWindow(){if(window.parent.activateWindow!=undefined){if(activeAllWindowFlag==true){window.parent.activateWindow(getWID())}}activeAllWindowFlag=true}if(isReadOnly==undefined||isReadOnly.toUpperCase()!="TRUE"){document.onclick=activateWindow}var clickedOnce=false;function handleChange(){if(!clickedOnce){clickedOnce=true;window.parent.registerChange(wid2)}}function handleResetChange(){if(clickedOnce){clickedOnce=false;window.parent.registerSave(wid2)}}var DeleteBtnHandler=function(){showDeleteMsg()};function buttonValidator(){if((newTitle!=null&&newTitle!="")&&(errormsg==null||errormsg==""||errormsg==SavedSuccessfully)){if(isLocationDeletable==true){Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconCls("bmcDelete")}if(isLocationCreatable==true){Ext.getCmp("copyId").setDisabled(false)}if(isLocationUpdatable==false){Ext.getCmp("saveId").setDisabled(true)}Ext.getCmp("resetId").setDisabled(false)}}function createWACSet(){idSetString="";var a=0;while(WACset.length>a){if(idSetString==""){idSetString=WACset[a]}else{idSetString=idSetString+","+WACset[a]}a++}}function hideUserPicklist(){var a=document.getElementsByTagName("select");for(var b in a){var c=a[b];if(typeof(c.id)!="undefined"&&c.id.search("l_inputField1_mlktp")!=-1){c.style.display="none"}}}function updateSupportingInformation(){getInfoPane(PhysicalLocationId,PhysicalLocationInstId)}function openPopupWithTitle(b,d,a,e,c){if(a==null||a==""){a=""}if(e==null||e==""){e=550}if(c==null||c==""){c=670}if(b&&b.indexOf("SearchAndLink")!=-1){e=600;c=1000}onCompleteFunction=d;popUpWindow=new Ext.create("Ext.window.Window",{height:e,width:c,title:a,x:10,y:5,modal:true,resizable:false,bodyStyle:"background-color:#FFFFFF;",constrain:true,viewConfig:{forceFit:true},cls:"",frame:true,html:'<iframe frameborder="0" src ="/apex/'+b+'" style="width:100%;height:100%;border:none"/>'});popUpWindow.show()}function setPopUpVar(b,a){if(b!=null&&b!=""&&onCompleteFunction!=null){onCompleteFunction(b,a)}}function makeOnlyReadOnlyField(){var c=document.getElementsByTagName("input");var g=document.getElementsByTagName("select");var b=document.getElementsByTagName("textarea");var a=[];if(c!=undefined){a.push(c)}if(g!=undefined){a.push(g)}if(b!=undefined){a.push(b)}if(a!=undefined){for(var d=0;d<a.length;++d){var f=a[d];if(f!=undefined){for(var e=0;e<f.length;e++){f[e].disabled=true;f[e].style.backgroundColor="#D3D3D3"}}}}}Ext.EventManager.onWindowResize(function(){resizePanels()});function getFilterQueryString(a){}function getFilterCondition(e,b,d,c,a){if(b=="User"||b=="AllUser"||b=="Account"){return escape("Isactive = true ")}if(typeof(b)!="undefined"&&b!="User"&&b!="Account"&&b.indexOf("__c")<0){return""}}function setDivPosition(d){var c=[d.offsetLeft,d.offsetTop];var b;while(d.offsetParent!=null){var a=d.offsetParent;c[0]+=a.offsetLeft-a.scrollLeft;b=a.offsetTop-a.scrollTop;if(b<0){b=0}c[1]+=b;d=a}return c}function escSpeChars(a){a=replaceAll(a,"\\","?");a=replaceAll(a,"?","\\");a=replaceAll(a,"?","?");a=replaceAll(a,"?","\\?");a=replaceAll(a,"^","?");a=replaceAll(a,"?","\\^");a=replaceAll(a,"$","?");a=replaceAll(a,"?","\\$");a=replaceAll(a,"(","?");a=replaceAll(a,"?","\\(");a=replaceAll(a,")","?");a=replaceAll(a,"?","\\)");a=replaceAll(a,"[","?");a=replaceAll(a,"?","\\[");a=replaceAll(a,"]","?");a=replaceAll(a,"?","\\]");a=replaceAll(a,"{","?");a=replaceAll(a,"?","\\}");a=replaceAll(a,"*","?");a=replaceAll(a,"?","\\*");a=replaceAll(a,"+","?");a=replaceAll(a,"?","\\+");a=replaceAll(a,"|","?");a=replaceAll(a,"?","\\|");return a}function replaceAll(e,c,d){var a=e;var b=a.indexOf(c);while(b!=-1){a=a.replace(c,d);b=a.indexOf(c)}return a};