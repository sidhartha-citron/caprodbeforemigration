var flag="true";var UnsharedQvs,DisplayMsg,DashboardContainer,PanelHeight,QVWidgetsUpdateList,qvStateMap={},isRefreshBtnPressed="true";var sequence=1,selectedWidget="";var customPageSize;var currentWidgets=[];var totalCols=2;var centerContainer;var SelQVGridStore,selRowIndex,SelQVGridStoreArr=[];var refreshQVList=false;var firstPanelItemId="";var currentFocusedElement="";var isPanelMaximized=false;var previousVisitedPanel="";function stopWaitMsgBar(){if(waitMsgBar!=""&&waitMsgBar!="undefined"){waitMsgBar.setVisible(false)}document.getElementById("mainPanel").style.height="auto";document.getElementById("manageDbPanel").style.height="auto"}function startWaitMsgBar(){waitMsgBar=new Ext.LoadMask(document.getElementById("manageDbPanel"),{msg:pleasewait});if(waitMsgBar!=""){waitMsgBar.setVisible(true)}}function setCustomPageSize(a){customPageSize=a;minRecordSelector.setValue(parseInt(customPageSize));recordSelector.setValue(parseInt(customPageSize))}function ChangeListViewPageRecords(b){customPageSize=b;for(var a=0;a<currentWidgets.length;a++){widgetId=currentWidgets[a];if(typeof(window.frames[widgetId])!="undefined"){window.frames[widgetId].waitMask.show();window.frames[widgetId].changeRecordsPerPage(true,customPageSize)}}}var PageSizeOptionsData=[{value:10,label:"10"},{value:25,label:"25"},{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"}];var recordSelector=Ext.create("Ext.form.ComboBox",{store:Ext.create("Ext.data.Store",{fields:["value","label"],data:PageSizeOptionsData}),id:"recordSelector",queryMode:"local",displayField:"label",valueField:"value",margin:"4 15 4 8",editable:false,forceSelection:true,typeAhead:true,width:60,listeners:{afterrender:function(){this.setValue(parseInt(customPageSize))},change:function(d,c,a,b){if(typeof(a)!="undefined"&&a!=null){ChangeListViewPageRecords(c);minRecordSelector.setValue(c)}}}});var minRecordSelector=Ext.create("Ext.form.ComboBox",{store:Ext.create("Ext.data.Store",{fields:["value","label"],data:PageSizeOptionsData}),id:"minRecordSelector",queryMode:"local",displayField:"label",valueField:"value",margin:"4 15 4 8",editable:false,forceSelection:true,typeAhead:true,width:60,listeners:{afterrender:function(){this.setValue(parseInt(customPageSize))},change:function(d,c,a,b){if(typeof(a)!="undefined"&&a!=null){ChangeListViewPageRecords(c);recordSelector.setValue(c)}}}});var DBTbar;function createToolBar(){DBTbar=Ext.create("Ext.toolbar.Toolbar",{renderTo:"DBToolbar",border:false,height:40,defaultType:"button",items:[{xtype:"tbspacer",width:10},{text:_ServerLabels.ManageDashboard,handler:function(){startWaitMsgBar();var b=document.getElementById("selectOption");var a="";if(b!=null){b.value=_ServerLabels.MyDashboardTitle;a=b.options[b.selectedIndex].value}if(isdefaultConsoleDB&&(a==_ServerLabels.MyDashboardTitle||a=="")){document.getElementById("resetLink").style.display="block"}getQuickviews(a);document.getElementById("manageDbPanel").style.overflow="auto";document.getElementById("manageDbPanel").style.visibility="visible";SelQVGridStore=Ext.data.StoreManager.lookup("SelQVGridStore");if(typeof(SelQVGridStore)!=null&&typeof(SelQVGridStore)!=""&&typeof(SelQVGridStore)!="undefined"){SelQVGridStore.add(SelQVGridStoreArr)}}},{xtype:"tbspacer",width:5},{text:_ServerLabels.Refresh,handler:function(){waitMask.show();window.location.reload()}},"->",{text:_ServerLabels.RecordsPerPage,xtype:"label"},minRecordSelector,"-",{xtype:"tbspacer",width:5},{xtype:"label",html:'<a href="#" onclick="OpenHelppage();"><img title="'+_ServerLabels.Help+'" height="17" width="17" id="helpConsoleQV" src="'+SDEFStylesPATH+'/SDEFbuttons/b_console_help.png"></a>'},{xtype:"tbspacer",width:15}]})}function maximizepanel(a){var j=Ext.getCmp("DashboardContainer");var d=Ext.getCmp("MaxPanel");var a=a.initialConfig;var e=a.itemId+"_Max";var i=getTools(e,"MaxPanel");qvStateMap[e]=qvStateMap[a.itemId];var h=window.frames[a.itemId];var g=qvStateMap[a.itemId].qvView;if(a.html.indexOf("pageNumber")!=-1){var c=a.html.indexOf("pageNumber=");c=c+11;var f=a.html.indexOf('" name=');var l=a.html.substring(c,f);a.html=a.html.replace("&pageNumber="+l,"&pageNumber="+h.currentPage)}else{a.html=a.html.replace('" name="'+a.itemId+'"',"&pageNumber="+h.currentPage+'" name="'+e+'"')}a.tools=i;a.height=Ext.getBody().getViewSize().height-40;a.margin="0 0 0 0";d.insert(0,a);d.doLayout();j.getLayout().setActiveItem(1);j.doLayout();currentWidgets.push(e);var k=window.frames[e];if(typeof(h)!="undefined"&&typeof(k)!="undefined"){document.getElementById(Ext.getCmp("viewtool"+e+"-MaxPanel").el.dom.childNodes[0].id).className="sprite sprite-QV_options";if(h.hasRTFilters){var b=Ext.getCmp("filtertool"+e+"-MaxPanel");b.show();if(!h.isNoFilterEnabled){document.getElementById(b.el.dom.childNodes[0].id).className="sprite sprite-QV_filter_applied"}else{document.getElementById(b.el.dom.childNodes[0].id).className="sprite sprite-QV_filter"}}}d.getComponent(a.itemId).removeCls("rf-qv-portletdisabled");d.getComponent(a.itemId).addCls("rf-qv-portlet");isPanelMaximized=true;previousVisitedPanel=""}function minimizepanel(b){isMaxPanel=false;var a=Ext.getCmp("DashboardContainer");var f=Ext.getCmp("MaxPanel");var e=b.itemId+"_Max";var d=window.frames[b.itemId];d.location.reload();var c=window.frames[e];if(qvStateMap[e].qvView==""){qvStateMap[e].qvView=c.viewState}qvStateMap[b.itemId]=qvStateMap[e];if(qvStateMap[e].qvView=="tableView"){isTableView=true;if(typeof(d)!="undefined"&&typeof(c)!="undefined"){d.waitMask.show();d.minimizeQV("tableView",c.currentPage)}}else{if(qvStateMap[e].qvView=="chartView"){isTableView=false;if(typeof(d)!="undefined"&&typeof(c)!="undefined"){d.waitMask.show();d.minimizeQV("chartView",c.currentPage)}}}f.remove(b);currentWidgets.pop();f.doLayout();a.getLayout().setActiveItem(0);a.doLayout();centerContainer.getComponent(b.itemId).removeCls("rf-qv-portletdisabled");centerContainer.getComponent(b.itemId).addCls("rf-qv-portlet");if(typeof(d)!="undefined"&&d.hasRTFilters&&!d.isNoFilterEnabled){document.getElementById(Ext.getCmp("filtertool"+b.itemId+"-MinPanel").el.dom.childNodes[0].id).className="sprite sprite-QV_filter_applied"}else{if(typeof(d)!="undefined"&&d.hasRTFilters&&d.isNoFilterEnabled){document.getElementById(Ext.getCmp("filtertool"+b.itemId+"-MinPanel").el.dom.childNodes[0].id).className="sprite sprite-QV_filter"}}document.getElementById(Ext.getCmp("viewtool"+b.itemId+"-MinPanel").el.dom.childNodes[0].id).className="sprite sprite-QV_options";isPanelMaximized=false;previousVisitedPanel=b.itemId}Ext.define("Ext.app.ConsoleDashboard",{extend:"Ext.container.Container",xtype:"ViewportDashboardLayout",layout:"card",id:"DashboardContainer",renderTo:"MyDB",initComponent:function(){var a=this;Ext.apply(a,{items:[{items:[{id:"centerportal",region:"center",layout:{type:"table",columns:totalCols,tableAttrs:{style:{width:"100%",height:"100%"}}},border:false,items:[]}]},{xtype:"container",id:"MaxPanel",layout:{type:"vbox",align:"stretch"}}]});a.callParent(arguments)}});function isOdd(a){return(a%2==0)?false:true}Ext.onReady(function(){createToolBar();Ext.create("Ext.app.ConsoleDashboard");QVCount=parseInt(QVCount);calculateQVHeight();centerContainer=Ext.getCmp("centerportal");repeatListOfWidgetsPage();addQVPanel();if(centerContainer.getComponent(firstPanelItemId)!="undefined"&&centerContainer.getComponent(firstPanelItemId)!=null){centerContainer.getComponent(firstPanelItemId).removeCls("rf-qv-portletdisabled");centerContainer.getComponent(firstPanelItemId).addCls("rf-qv-portlet")}if(refreshQVList==true){window.setInterval(function(){window.parent.parent.updateMyQVList()},10000)}centerContainer.doLayout();DashboardContainer=Ext.getCmp("DashboardContainer");Ext.EventManager.onWindowResize(DashboardContainer.doLayout,DashboardContainer);if(Ext.isChrome||Ext.isIE||checkIsIEEleBrowser()){var a=window.parent.frames.dashboardframe.document;if(typeof(a)!="undefined"&&typeof(a)!=null&&typeof(a)!=""){a.body.style.overflowX="hidden"}}createSelectedQVGrid();waitMask.hide()});function calculateQVHeight(){var a=Ext.getBody().getViewSize().height;a=a-DBTbar.getHeight();if(typeof(QVCount)!="undefined"&&QVCount>0){if(QVCount==1){PanelHeight=a-1}else{if(QVCount==2){PanelHeight=a-20}else{PanelHeight=500}}}}function getTools(a,b){return[{xtype:"tool",type:"filtertool",scale:"medium",cls:"rf-panel-tools",width:27,id:"filtertool"+a+"-"+b,tooltip:_ServerLabels.AdvancedFilter,tooltipType:"title",hidden:true,handler:function(g,f,d,c){var h=window.frames[a];if(!isPanelMaximized){currentFocusedElement=a;if(typeof(h)!="undefined"&&!h.isNoFilterEnabled){changePanel("sprite sprite-QV_filter_applied")}else{if(typeof(h)!="undefined"&&h.isNoFilterEnabled){changePanel("sprite sprite-QV_filter")}}}selectedWidget=a;if(typeof(h)!="undefined"){h.showRunTimeFilter()}}},{xtype:"tool",type:"viewtool",scale:"medium",cls:"rf-panel-tools",tooltip:_ServerLabels.Views,tooltipType:"title",width:30,id:"viewtool"+a+"-"+b,handler:function(g,f,d,c){var h=window.frames[a];if(!isPanelMaximized){currentFocusedElement=a;if(typeof(h)!="undefined"&&!h.isNoFilterEnabled){changePanel("sprite sprite-QV_filter_applied")}else{if(typeof(h)!="undefined"&&h.isNoFilterEnabled){changePanel("sprite sprite-QV_filter")}}}selectedWidget=a;if(typeof(h)!="undefined"&&h.isRunTimeFilterVisible()){h.showRunTimeFilter()}getViewMenu(d,a).showBy(d,"tr-br?")}}]}var getViewMenu=function(d,c){var b=Ext.getCmp("viewMenu");if(b!=null&&b!=undefined){b.destroy()}var h=qvStateMap[c];var g=window.frames[c];var a=true;if(h.qvView==""){h.qvView=g.viewState}if(h.qvView=="chartView"){a=false}var e="";if(typeof(g)!="undefined"){e=g.getLastRefreshedTime()}var f=d.down("menu");if(!f){f=Ext.create("Ext.menu.Menu",{id:"viewMenu",items:[{text:_ServerLabels.Table,checked:a,id:"tableViewId",group:"qvRadio",handler:function(){showTableView(c)}},{text:_ServerLabels.Chart,checked:!a,id:"chartViewId",group:"qvRadio",handler:function(){showChartView(c)}},{xtype:"menuseparator"},{xtype:"form",layout:{type:"hbox",align:"center",pack:"center"},border:false,height:35,items:[{xtype:"tbspacer",width:10},{xtype:"label",cls:"rf-refresh-lbl",left:35,text:_ServerLabels.autoRefreshLabel},{xtype:"tbspacer",width:70},{xtype:"button",scale:"large",id:"autoRefreshId",iconCls:h.imageCls,disabled:false,enableToggle:true,tooltipType:"title",cls:"rf-on-off-btn",tooltip:h.toolTipRefreshBtn,pressed:h.isRefreshBtnState,width:52,toggleHandler:function(i,j){if(j){i.setIconCls("auto-refresh-off");Ext.getCmp("intervalLabel").removeCls("rf-interval-lbl");Ext.getCmp("intervalLabel").addClass("rf-interval-lbl-off");Ext.getCmp("refreshInterval").setDisabled(true);Ext.getCmp("applyBtnId").setDisabled(true);i.setTooltip(_ServerLabels.toolTipAutoRefreshOFF);autoRefreshable=false}else{i.setIconCls("auto-refresh-on");Ext.getCmp("intervalLabel").addCls("rf-interval-lbl");Ext.getCmp("intervalLabel").removeCls("rf-interval-lbl-off");Ext.getCmp("refreshInterval").setDisabled(false);Ext.getCmp("applyBtnId").setDisabled(false);i.setTooltip(_ServerLabels.toolTipAutoRefreshON);autoRefreshable=true}createCookie(c,Ext.getCmp("refreshInterval"));setQVstate(c,h)}},{xtype:"tbspacer",width:10}]},{xtype:"form",layout:{type:"hbox",align:"center",pack:"center"},border:false,height:30,items:[{xtype:"tbspacer",width:25},{xtype:"label",id:"intervalLabel",name:"intervalLabel",cls:h.isRefreshBtnState?"rf-interval-lbl-off":"rf-interval-lbl",text:_ServerLabels.intervalMinLabel},{xtype:"tbspacer",width:10},{xtype:"textfield",stripCharsRe:/[^0-9]/g,id:"refreshInterval",cls:"rf-refresh-text",name:"refreshInterval",disabled:h.isRefreshBtnState,tooltip:h.toolTipRefreshBtn,value:h.refreshInterval,maxLength:3,width:30,listeners:{afterrender:function(){this.nav=Ext.create("Ext.util.KeyNav",this.el,{left:function(i){i.stopPropagation();this.moveLeft(i.ctrlKey)},right:function(i){i.stopPropagation();this.moveRight(i.ctrlKey)}})},change:function(j){var i=this.getValue();if(i!=null&&i.toString().length>3){this.setValue(oldValue)}else{oldValue=i}}}},{xtype:"tbspacer",width:10},{xtype:"button",id:"applyBtnId",cls:"rf-apply-btn",disabled:h.isRefreshBtnState,text:_ServerLabels.Apply,handler:function(){createCookie(c,Ext.getCmp("refreshInterval"));qvAutoRefresh(c)}},{xtype:"tbspacer",width:10}]},{xtype:"label",id:"refreshed",disabled:true,cls:"rf-last-refreshed-lbl",text:e}]})}return f};var getFilterMenu=function(a){var b=a.down("menu");if(!b){b=Ext.create("Ext.menu.Menu",{items:[{text:"Under Construction"},{text:"Under Construction"}]})}return b};function showTableView(a){qvStateMap[a].qvView="tableView";if(typeof(window.frames[a])!="undefined"){window.frames[a].showTableView();window.frames[a].saveState(qvStateMap[a].qvView,qvStateMap[a].sequenceid)}}var showChartView=function(a){qvStateMap[a].qvView="chartView";if(typeof(window.frames[a])!="undefined"){window.frames[a].showChartView();window.frames[a].saveState(qvStateMap[a].qvView,qvStateMap[a].sequenceid)}};function qvAutoRefresh(d){var a="tableView";var c=window.frames[d];var e=qvStateMap[d].autoRefreshable;if(typeof(c)!="undefined"){if(c.viewState!=""){}a=c.viewState;if(e){c.waitMask.show();c.loadResultSet(a,false)}}var b=Ext.util.Cookies.get(d+currentUser);if(b!=null&&b!=""&&b!=0&&b!="0"){t=setTimeout('qvAutoRefresh("'+d+'" );',b*60000)}}function setQVstate(d,c){var e=d+currentUser;isRefreshBtnPressed=Ext.util.Cookies.get(e+"isPressed");var b=new Object();b.qvId=c;b.qvView="";b.isRefreshBtnPressed=isRefreshBtnPressed;b.sequenceid=sequence;sequence++;if(isRefreshBtnPressed=="true"){imageCls="auto-refresh-off";isRefreshBtnState=true;autoRefreshable=false;toolTipRefreshBtn=_ServerLabels.toolTipAutoRefreshOFF}else{imageCls="auto-refresh-on";isRefreshBtnState=false;autoRefreshable=true;toolTipRefreshBtn=_ServerLabels.toolTipAutoRefreshON}b.isRefreshBtnState=isRefreshBtnState;b.autoRefreshable=autoRefreshable;b.toolTipRefreshBtn=toolTipRefreshBtn;b.imageCls=imageCls;var a=Ext.util.Cookies.get(e);if(a!=null&&a!=""){b.refreshInterval=a}else{b.refreshInterval=10}b.isRefreshBtnState=isRefreshBtnState;qvStateMap[d]=b}function createCookie(b,c){if(c.getValue()==null||c.getValue()==""){c.setValue(0)}var a=new Date();a.setYear(a.getFullYear()+10);document.cookie=b+currentUser+"="+c.getValue()+";path=/;expires="+a.toUTCString()+";SameSite=None;Secure";document.cookie=b+currentUser+"isPressed="+Ext.getCmp("autoRefreshId").pressed+";path=/;expires="+a.toUTCString()+";SameSite=None;Secure";qvStateMap[b].refreshInterval=c.getValue()}Ext.fly(document.body).on("click",function(a){if(a.getTarget().id!="rf-dbqv-filter-btnEl"){var b=window.frames[selectedWidget];if(typeof(b)!="undefined"){if(b.isRunTimeFilterVisible()){b.showRunTimeFilter()}}}});function hidePanel(){document.getElementById("manageDbPanel").style.overflow="hidden";document.getElementById("manageDbPanel").style.visibility="hidden"}function showPanel(i,j){var p=document.getElementById(i);var l=document.getElementById(j);var o=document.getElementById("mainPanel").clientHeight;if(p.style.display=="block"){p.style.display="none";l.className="panelUpImg"}else{p.style.display="block";l.className="panelDownImg"}o=o-50;var g=document.getElementById("myQvPanel");var k=document.getElementById("shareQvPanel");var e=g.style.display;var n=k.style.display;var b=document.getElementById("mainPanel");var c=document.getElementById("shareQvHeader");var d=document.getElementById("manageDbPanel");if(e=="block"&&n=="block"){g.style.maxHeight=83+"px";var h=document.getElementById("myQvPanel").offsetHeight;var f=220-h-52;k.style.maxHeight=f+"px";var m=document.getElementById("shareQvPanel").offsetHeight;var a=220-m-52;g.style.maxHeight=a+"px";b.style.height="auto"}else{if(e=="none"&&n=="block"){b.style.height="auto";c.style.margin="2px 0px 0px 0px";k.style.maxHeight=166+"px"}else{if(e=="block"&&n=="none"){b.style.height="auto";g.style.maxHeight=168+"px"}else{if(e=="none"&&n=="none"){c.style.margin="2px 0px 0px 0px";b.style.height="52px"}}}}d.style.height="auto"}Ext.EventManager.onWindowResize(function(){if(flag=="false"){var f=Ext.getCmp("MaxPanel");if(typeof(f)!="undefined"&&f!=null&&f!=""){var c=f.getHeight();var b=Ext.getBody().getViewSize().height-30;if(b>c||b<c){f.child("panel").setHeight(b)}}}var e=Ext.getCmp("centerportal");if(flag=="true"&&QVCount==2&&PanelHeight!=340){var a,d=0;if(typeof(DashboardWidgets)!=undefined){for(d=0;d<DashboardWidgets.length;d++){a=e.getComponent(DashboardWidgets[d].widgetId);if(typeof(a)!="undefined"){a.setHeight(Ext.getBody().getViewSize().height-60)}}}}});var isReload=false,isDefault=false;function OkBtnHandler(){isReload=true;var c=document.getElementById("selectOption");var b="";if(c!=null){b=c.options[c.selectedIndex].value}if(b==_ServerLabels.DefaultDashboard){isDefault=true}var a=[];if(typeof(SelQVGridStore)!=null&&typeof(SelQVGridStore)!=""&&typeof(SelQVGridStore)!="undefined"){SelQVGridStore.each(function(d){a.push({QvId:d.get("id"),widorder:d.get("order"),isfull:d.get("isfull")})})}a=JSON.stringify(a);saveQvHandler(b,a)}function reloadPage(){if(errorStr!=null&&errorStr!=""){stopWaitMsgBar();showErrorMessage(errorStr)}else{if(!isReload&&!errorStr){stopWaitMsgBar();showErrorMessage(savedSuccessLabel)}else{if(isReload&&!errorStr){if(!isDefault){window.location.reload()}else{if(isDefault){hidePanel()}}}}}isReload=false;isDefault=false}function checkIsIEEleBrowser(){var b=window.navigator.userAgent;var a=b.indexOf("MSIE ");if(a>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return true}else{return false}}function getCount(h,d,g){var j=document.getElementById(h.id);var a=j;if(a.checked==true){count++}else{count--}if(count>parseInt(qvLimitOnDashboard)){a.checked=false;count--;Ext.MessageBox.show({msg:qvLimitMsgLabel,title:"",width:300,height:"auto",buttons:Ext.MessageBox.OK,closable:false,cls:"messageboxcss"})}else{var e,f={};if(a.checked==true){e=SelQVGridStore.getCount()+1;f={id:d,qvname:g,order:e,isfull:false};SelQVGridStore.add(f)}else{var b=SelQVGridStore.getCount();f=SelQVGridStore.getById(d);e=f.get("order");SelQVGridStore.remove(f);if(e!=b){var c;for(var c=e-1;c<SelQVGridStore.getCount();c++){f=SelQVGridStore.getAt(c);if(typeof(f)!=null&&typeof(f)!=""&&typeof(f)!="undefined"){f.set("order",c+1)}}}}}}function showErrorMessage(a){Ext.MessageBox.show({msg:a,title:"",width:300,height:"auto",buttons:Ext.MessageBox.OK,closable:false,cls:"messageboxcss"});return}function showMsgPopup(){if(errorStr!=null&&errorStr!=""){showErrorMessage(errorStr)}}function adjustHeight(){var c=document.getElementById("mainPanel").clientHeight;c=c-50;var b=document.getElementById("myQvPanel").offsetHeight;var a=(parseInt(c)-parseInt(b));document.getElementById("shareQvPanel").style.maxHeight=a+"px"}function getDashboardValue(){var b=document.getElementById("selectOption");var a="";if(b!=null){a=b.options[b.selectedIndex].value}dashboardName=a}function getSelectedValue(a){dashboardName=a.value;if(isdefaultConsoleDB&&dashboardName==_ServerLabels.MyDashboardTitle){document.getElementById("resetLink").style.display="block"}else{if(dashboardName==_ServerLabels.DefaultDashboard){document.getElementById("resetLink").style.display="none"}}startWaitMsgBar();SelQVGridStoreArr=[];SelQVGridStore.removeAll();getQuickviews(dashboardName)}function addQVPanel(){if(QVCount!=1){centerContainer.addCls("RFDashboard")}calculatecolspanForPanels();var b,c;var e,d,f,g=0;var a,h;while(DashboardWidgets.length>g){e=1;if(DashboardWidgets[g].isSingleRow=="false"&&DashboardWidgets[g].colspan!=1&&QVCount!=1){d=DashboardWidgets[g].colspan;DashboardWidgets[g].colspan=1}else{d=0}if(DashboardWidgets[g].isQVOptimized=="false"){refreshQVList=true}if(QVCount==2&&DashboardWidgets[g].isSingleRow=="true"){PanelHeight=340}var j="/apex/consoleQuickViewPage?queryName="+DashboardWidgets[g].quickViewId+"&isDashboard=true&widgetId="+DashboardWidgets[g].widgetId+"&qvTitle="+encodeURIComponent(DashboardWidgets[g].quickview)+"&system="+DashboardWidgets[g].isSystem+"&optimized="+DashboardWidgets[g].isQVOptimized+"&isSingleRow="+DashboardWidgets[g].isSingleRow+"&qvCount="+g;if(UnsharedQvs.indexOf(DashboardWidgets[g].quickViewId)==-1){c='<iframe id="container" src="'+j+'" name="'+DashboardWidgets[g].widgetId+'" style="width:100%;height:100%;border: none"/>'}else{c='<div class="rf-unsharedQV"><a href="#" onclick="RemoveWidget(\''+DashboardWidgets[g].widgetId+"');\" >"+DisplayMsg+"</a></div>"}h=DashboardWidgets[g].widgetId;b=Ext.create("Ext.panel.Panel",{itemId:DashboardWidgets[g].widgetId,title:DashboardWidgets[g].quickview,colspan:DashboardWidgets[g].colspan,cls:"rf-qv-portletdisabled",hideCollapseTool:true,tools:getTools(DashboardWidgets[g].widgetId,"MinPanel"),header:{height:30},frame:false,closable:false,height:PanelHeight,html:c,listeners:{afterrender:function(i){i.header.el.on("dblclick",function(){if(QVCount!=1){if(flag=="true"){selectedWidget=h;maximizepanel(i);flag="false"}else{if(flag=="false"){minimizepanel(i);flag="true"}}}});i.header.el.on("click",function(){if(!isPanelMaximized){changeCSS("rf-qv-portlet","rf-qv-portletdisabled");changeCSS("sprite sprite-QV_filter","sprite sprite-QV_filter_disabled");changeCSS("sprite sprite-QV_filter_applied","sprite sprite-QV_filter_applied_disabled");changeCSS("sprite sprite-QV_options","sprite sprite-QV_options_disabled ");i.removeCls("rf-qv-portletdisabled");i.addCls("rf-qv-portlet");var k=window.frames[i.itemId];if(typeof(k)!="undefined"&&k.hasRTFilters&&!k.isNoFilterEnabled){document.getElementById(Ext.getCmp("filtertool"+i.itemId+"-MinPanel").el.dom.childNodes[0].id).className="sprite sprite-QV_filter_applied"}else{if(typeof(k)!="undefined"&&k.hasRTFilters&&k.isNoFilterEnabled){document.getElementById(Ext.getCmp("filtertool"+i.itemId+"-MinPanel").el.dom.childNodes[0].id).className="sprite sprite-QV_filter"}}document.getElementById(Ext.getCmp("viewtool"+i.itemId+"-MinPanel").el.dom.childNodes[0].id).className="sprite sprite-QV_options"}})}}});centerContainer.add(b);if(d>0){while(e<d){a=Ext.create("Ext.panel.Panel",{id:"dummy"+DashboardWidgets[g].widgetId+"-"+e,hideCollapseTool:true,colspan:DashboardWidgets[g].colspan,frame:false,closable:false,height:PanelHeight,border:false,html:'<iframe style="width:100%;height:100%;border: none"></iframe>'});centerContainer.add(a);e++}}setQVstate(DashboardWidgets[g].widgetId,DashboardWidgets[g].quickViewId);currentWidgets.push(DashboardWidgets[g].widgetId);if(g==0){firstPanelItemId=h}g++}}function calculatecolspanForPanels(){var a,b=0;var c=0;while(DashboardWidgets.length>b){a=b+1;c++;if(DashboardWidgets[b].order==QVCount){if(DashboardWidgets[b].order==1){DashboardWidgets[b].colspan=totalCols}else{if(DashboardWidgets[b].isSingleRow=="true"){DashboardWidgets[b].colspan=totalCols;c=totalCols}else{if(c==totalCols){DashboardWidgets[b].colspan=1}else{DashboardWidgets[b].colspan=(totalCols-c)+1}}}}else{if(DashboardWidgets[b].isSingleRow=="true"){DashboardWidgets[b].colspan=totalCols;c=totalCols}else{if(DashboardWidgets[b].isSingleRow=="false"){if(DashboardWidgets[a].isSingleRow=="false"){DashboardWidgets[b].colspan=1}else{if(DashboardWidgets[a].isSingleRow=="true"){DashboardWidgets[b].colspan=(totalCols-c)+1}}}}}if(c==totalCols){c=0}b++}}function createSelectedQVGrid(){var a=Ext.create("Ext.data.Store",{id:"SelQVGridStore",fields:["id","order","qvname",{name:"isfull",type:"boolean"}],data:{items:[]},proxy:{type:"memory",reader:{type:"json",root:"items"}}});var b=Ext.create("Ext.grid.Panel",{height:155,width:565,id:"qv-grid",renderTo:"selQVid",store:a,cls:"rf-qv-grid",viewConfig:{markDirty:false},rowLines:false,header:false,dockedItems:[{xtype:"toolbar",dock:"right",cls:"rf-qv-rbar",width:40,border:false,layout:{pack:"center"},items:[{xtype:"button",iconCls:"move_top",handler:function(){moveSelectedRow(b,"top")}},{xtype:"tbspacer",width:5},{xtype:"button",iconCls:"move_up",handler:function(){moveSelectedRow(b,"up")}},{xtype:"tbspacer",width:5},{xtype:"button",iconCls:"move_down",handler:function(){moveSelectedRow(b,"down")}},{xtype:"tbspacer",width:5},{xtype:"button",iconCls:"move_bottom",handler:function(){moveSelectedRow(b,"bottom")}}]}],columns:[{text:"ID",dataIndex:"id",flex:0.1,hidden:true},{text:"Order",dataIndex:"order",flex:0.1,hidden:true},{text:SelectedQVsLabel,dataIndex:"qvname",flex:0.6,sortable:false,menuDisabled:true,draggable:false,resizable:false},{text:QVSpanWidthLabel,dataIndex:"isfull",checkOnly:true,flex:0.2,sortable:false,menuDisabled:true,draggable:false,resizable:false,renderer:function(f,g,c,e){var d="'"+c.get("id")+"'";e="'"+e+"'";if(f==true){return'<center><input onclick="updateISFull(false,'+d+","+e+');"  type="checkbox" checked /></center>'}else{return'<center><input onclick="updateISFull(true,'+d+","+e+');" type="checkbox" /></center>'}}}],listeners:{select:function(d,c,e,f){selRowIndex=e}}})}function moveSelectedRow(e,g){var b=e.getSelectionModel().selected;if(!b){return}var d=selRowIndex;var f=e.getStore();var b=f.getAt(d);var c=f.getCount();var a=e.getSelectionModel();if(g=="up"){d--;if(d<0){return}selRowIndex--}else{if(g=="down"){d++;if(d>=c){return}selRowIndex++}else{if(g=="top"){selRowIndex=0;if(d==0){a.select(d);return}d=0}else{if(g=="bottom"){selRowIndex=c-1;if(d==c){a.select(d);return}d=c-1}}}}f.remove(b);f.insert(d,b);a.select(d);updateQVOrder(e,g,d)}function updateQVOrder(e,h,c){var g=e.getStore();var b=g.getAt(c);var a=b.get("order");var d,f;b.set("order",c+1);if(h=="up"){f=g.getAt(c+1);f.set("order",a)}else{if(h=="down"){f=g.getAt(c-1);f.set("order",a)}else{if(h=="top"){for(d=c+1;d<g.getCount();d++){f=g.getAt(d);f.set("order",d+1)}}else{if(h=="bottom"){for(d=0;d<c;d++){f=g.getAt(d);f.set("order",d+1)}}}}}if(Ext.IE||checkIsIEEleBrowser()){e.getView().refresh()}}function updateISFull(f,e,c){e=SelQVGridStore.getById(e);if(typeof(e)!=null&&typeof(e)!=""&&typeof(e)!="undefined"){e.set("isfull",f)}var d=Ext.getCmp("qv-grid");var a=d.getSelectionModel();var b=d.getSelectionModel().selected;a.select(parseInt(c));selRowIndex=c;if(Ext.IE||checkIsIEEleBrowser()){d.getView().refresh()}}function applyBtnHandler(){var a=[];if(typeof(SelQVGridStore)!=null&&typeof(SelQVGridStore)!=""&&typeof(SelQVGridStore)!="undefined"){SelQVGridStore.each(function(b){a.push({QvId:b.get("id"),widorder:b.get("order"),isfull:b.get("isfull")})})}a=JSON.stringify(a);saveQvHandler(dashboardName,a)}function OpenHelppage(){var a="helpfile.htm";if(wikiUrl!=null&&wikiUrl!=undefined&&wikiUrl!=""){window.open(wikiUrl,false,"width="+screen.width+",height="+screen.height+",resizable = 1,scrollbars=yes,status=1,top=0,left=0",false)}else{window.open(helpResource+"/"+a,false,"width="+screen.width+",height="+screen.height+",resizable = 1,scrollbars=no,status=1,top=0,left=0",false)}}function changeCSS(e,c){var d=Ext.dom.Query.select("."+e);var b=Ext.get(d[0]);if(b!=null){b.removeCls(e);b.addCls(c)}}function changePanel(a){changeCSS("rf-qv-portlet","rf-qv-portletdisabled");changeCSS("sprite sprite-QV_filter_applied","sprite sprite-QV_filter_applied_disabled");changeCSS("sprite sprite-QV_filter","sprite sprite-QV_filter_disabled ");changeCSS("sprite sprite-QV_options","sprite sprite-QV_options_disabled");centerContainer.getComponent(currentFocusedElement).removeCls("rf-qv-portletdisabled");centerContainer.getComponent(currentFocusedElement).addCls("rf-qv-portlet");document.getElementById(Ext.getCmp("filtertool"+currentFocusedElement+"-MinPanel").el.dom.childNodes[0].id).className=a;document.getElementById(Ext.getCmp("viewtool"+currentFocusedElement+"-MinPanel").el.dom.childNodes[0].id).className="sprite sprite-QV_options"}function highlightFocusedPanel(c,b){var d=c;var a;while(d!=undefined){a=d.dom!=undefined?d.dom.parentNode:d.parentNode;if(a.nodeName=="#document"){var e;if(a.URL){e=getUrlParameter(a.URL,"widgetId")}currentFocusedElement=e;break}d=a}changePanel(b)}function getUrlParameter(b,e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var d="[\\?&]"+e+"=([^&#]*)";var c=new RegExp(d);var a=c.exec(b);if(a==null){return""}else{return a[1]}};