Ext.onReady(function(){var f;var h;Ext.QuickTips.init();populateFieldStore();this.contextMenu=new Ext.menu.Menu({items:[new Ext.grid.GridPanel({store:objFieldStore,columns:[{id:"name",header:"Name",dataIndex:"name",hidden:true,hideable:false},{id:"label",header:contextmenuheader,style:"color: white !important; font-weight: bold !important;",sortable:false,width:225,dataIndex:"label"}],stripeRows:true,autoExpandColumn:"label",height:200,width:250,closable:true,header:false,enableCtxMenu:false,enableColLock:false,enableColumnMove:false,enableColumnResize:false,listeners:{itemclick:function(w,u,x,z,y){y.stopEvent();var v=k.getForm().findField("autoReply");q(" {!record_"+u.get("name")+"}");Ext.get("fieldMenu").hide()},itemcontextmenu:function(v,u,w){w.stopEvent()},headercontextmenu:function(u,v,w){w.stopEvent()}}})],id:"fieldMenu",width:250});populateGroupData();populateUserData();function q(w){if(h!=null&&typeof(h)!="undefined"&&h.value!=null&&typeof(h.value)!="undefined"){if(Ext.isIE){if(document.selection){h.focus();sel=document.selection.createRange();sel.text=w}}else{var v=h.selectionStart;var u=h.selectionEnd;if(v!=null&&typeof(v)!="undefined"&&u!=null&&typeof(u)!="undefined"){h.focus();h.value=h.value.substring(0,v)+w+h.value.substring(u,h.value.length);h.setSelectionRange(u+w.length,u+w.length)}}}}var l,r;if(chatterUserValue!=null&&chatterUserValue!=""){l=false;r=false}else{l=true;r=true}var k=new Ext.FormPanel({id:"ChatterListenerPanel",border:false,height:477,width:800,autoWidth:true,bodyStyle:" margin-left: 0px;margin-top: 0px;",items:[{xtype:"panel",height:459,width:750,border:0,bodyPadding:10,items:[{xtype:"textfield",fieldLabel:chatterlistenerNameLabel+requiredStyle,id:"CLname",cls:"clsInputTextBoxTD",value:nameValue,labelSeparator:""},{xtype:"combobox",fieldLabel:chatterListenerGroupLabel+requiredStyle,id:"groupCombo",inputId:"groupComboInput",editable:false,store:groupStore,valueField:"Id",displayField:"label",cls:"clsTemplateSelectList",queryMode:"local",value:groupIdValue,labelSeparator:"",tpl:'<tpl for="."><div class="x-boundlist-item">{label:htmlEncode}</div></tpl>',listeners:{change:function(){handleChange()}}},{xtype:"textfield",fieldLabel:chatterListenerKeywordLabel+requiredStyle,id:"tagText",cls:"clsInputTextBoxTD",value:keywordValue,labelSeparator:"",listeners:{render:function(u){u.tip=Ext.create("Ext.tip.ToolTip",{target:u.el,trackMouse:true,html:CLHashtags,style:"border-color :#8eacce"})}}},{xtype:"textfield",fieldLabel:chatterListenerObjectLabel,id:"objectSeleted",cls:"clsInputTextBoxTD",readOnly:true,fieldStyle:"background : none !important;background-color: #D4D0C8 !important;",value:"Incident",labelSeparator:""},{xtype:"panel",border:0,frame:false,height:27,width:"100%",id:"TemplatePanel",layout:{type:"table"},frameHeader:false,preventHeader:true,items:[{xtype:"textfield",fieldLabel:chatterListenerTemplateLabel+requiredStyle,id:"templateText",cls:"clsInputTextBoxTD",readOnly:true,value:templateValue,labelSeparator:"",listeners:{render:function(u){u.tip=Ext.create("Ext.tip.ToolTip",{target:u.el,trackMouse:true,html:CLTemplateTooltip,style:"border-color :#8eacce"})}}},{xtype:"button",cls:"lookupIconOn",style:"margin-left:5px;\r\nmargin-top:-6px;",id:"TemplateLookup",listeners:{click:function(){handleChange();openPopupRF("SearchPage?popupId=Template&isLookup=true&parentName=chatterListner&filterClause="+escape("templateFor__c='Incident'"),true,500,625)}}},{xtype:"button",cls:"lookupIconLaunchForm",style:"margin-left:5px;\r\nmargin-top:-6px;",id:"TemplateDetail",listeners:{render:function(u){u.tip=Ext.create("Ext.tip.ToolTip",{target:u.el,trackMouse:true,html:CLViewTemplate,style:"border-color :#8eacce"})},click:function(){var v,x;if(n==""){v=templateIDvalue;x=templateValue}else{v=n;x=s}if(v!=null&&v!=""){var u=window.parent.parent.get("Templates");var w="NavigatorPage?useListViewTarget=true&title="+x+"&target=TemplatePage?id="+v+"&moduleName=Templates";window.parent.parent.addNewTab(u,templateTabHeader,w)}}}}]},{xtype:"panel",border:0,frame:false,height:27,width:"100%",cls:"clsInputTextBoxTD",style:"margin-bottom: 0px;",layout:{type:"table"},frameHeader:false,preventHeader:true,items:[{xtype:"textfield",fieldLabel:chatterListenerAutoReplyUserLabel,id:"userCombo",cls:"clsInputTextBoxTD",readOnly:true,value:chatterUserValue,labelSeparator:"",listeners:{change:function(w,v,u){c(v)},render:function(u){u.tip=Ext.create("Ext.tip.ToolTip",{target:u.el,trackMouse:true,html:CLAutoReplyUserTooltip,style:"border-color :#8eacce"})}}},{xtype:"button",cls:"lookupIconOn",style:"margin-left:5px;\r\nmargin-top:-6px;",id:"ChatterUserLookup",listeners:{click:function(){handleChange();openPopupRF("SearchPage?popupId=Client&isLookup=true&parentName=chatterListner&additional_columns=name,username,firstname,lastname,phone,extension,email,ProfileId,Profile.Name&filterClause=IsStaffUser__c%3Dtrue&isAssignTo=true",true)}}}]},{xtype:"checkboxfield",fieldLabel:" ",id:"copyFromIncidentChbx",boxLabel:chatterListenerCopyFromIncidnetLabel,style:"margin-bottom:-1px;",labelSeparator:"",disabled:r,listeners:{render:function(u){u.tip=Ext.create("Ext.tip.ToolTip",{target:u.el,trackMouse:true,html:CopyFromIncidentTooltip,style:"border-color :#8eacce"})}}},{xtype:"panel",border:0,frame:false,height:115,width:"100%",cls:"clsInputTextBoxTD",id:"autoReplyToChatterPanel",style:"margin-bottom: -9px;",layout:{type:"table"},frameHeader:false,preventHeader:true,items:[{xtype:"panel",border:0,frame:false,height:"auto",width:220,cls:"clsInputTextBoxTD",layout:{type:"table"},frameHeader:false,preventHeader:true,items:[{xtype:"label",id:"autoReplyLabel",text:chatterListenerAutoReplyLabel,labelSeparator:""}]},{xtype:"panel",border:0,id:"autoReplyPanel",frame:false,height:"auto",width:470,cls:"clsInputTextBoxTD",layout:{type:"table"},frameHeader:false,preventHeader:true,items:[{xtype:"textareafield",id:"autoReply",inputId:"autoReplyInput",height:105,width:460,cls:"clsInputTextBoxTD",readOnlyCls:"clsReadOnlyTextBox",value:autoReplyValue,labelSeparator:""}],listeners:{render:function(u){u.tip=Ext.create("Ext.tip.ToolTip",{target:u.el,trackMouse:true,html:CLAutoReplyTooltip,style:"border-color :#8eacce !important"});c(chatterUserValue)},afterrender:function(u){h=document.getElementById("autoReplyInput");u.body.on("contextmenu",function(A){var y=k.getForm().findField("autoReply");var w=k.getForm().findField("copyFromIncidentChbx").getValue();if(w==true){var B=y;var x=B.getHeight();var v=B.getWidth();var z=A.getXY();if(z[1]>x){z[1]=z[1]-205}if((z[0]+255)>v){z[0]=z[0]-255}contextMenu.showAt(z);A.stopEvent()}})}}}]},{xtype:"checkboxfield",fieldLabel:chatterListenerAtuoFollowLabel,id:"followChbx",boxLabel:"",cls:"chkboxpadding",checked:autofollowValue,labelSeparator:"",listeners:{render:function(u){u.tip=Ext.create("Ext.tip.ToolTip",{target:u.el,trackMouse:true,html:CLAutoFollow,style:"border-color :#8eacce"})}}},{xtype:"checkboxfield",fieldLabel:chatterListenerPublishOnSaveLabel,id:"publishChbx",boxLabel:"",cls:"chkboxpadding",value:false,labelSeparator:"",listeners:{render:function(u){u.tip=Ext.create("Ext.tip.ToolTip",{target:u.el,trackMouse:true,html:CLPublishOnSave,style:"border-color :#8eacce"})}}}]}]});var d=Ext.extend(Ext.Panel,{id:"menuBarPanel",renderTo:"btnToolbar",defaults:{bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"}});new d({title:"",bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;",height:35,tbar:[{scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:lblNew,disabled:!isCreateable,id:"newId",listeners:{click:function(){window.parent.addTab("chatterlistenerPage?title="+encodeURIComponent(chatterListenerHeaderName),chatterListenerHeaderName,chatterListenerHeaderName)}}},{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:lblSave,disabled:((!isUpdateable&&!isNewRecord)||(isNewRecord&&!isCreateable)),id:"saveId",listeners:{click:function(){t()}}},{scale:"medium",iconCls:"bmcCopy",tooltipType:"title",tooltip:lblCopy,id:"copyId",disabled:!isCreateable||isNewRecord,listeners:{click:function(){window.parent.addTab("chatterlistenerPage?title="+encodeURIComponent(chatterListenerHeaderName)+"&copyid="+getRecordID(),chatterListenerHeaderName,chatterListenerHeaderName)}}},{xtype:"tbseparator",id:"separatorId"},{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:lblDelete,id:"deleteId",disabled:isNewRecord||!isDeletable,listeners:{click:function(){Ext.Msg.show({title:deleteLabel,msg:closeWindowMsg,buttons:Ext.Msg.YESNO,fn:function(u){if(u=="yes"){deleteConfig();window.parent.refreshList();window.parent.closeTab(wid)}},icon:Ext.MessageBox.WARNING})}}},{scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:lblReset,id:"resetId",disabled:isNewRecord,listeners:{click:function(){p();refreshConfig()}}},{xtype:"tbfill"},{id:"inactive",xtype:"checkbox",cls:"checkboxWithPadding",width:75,color:"#004376",align:"top",checked:inactiveValue,boxLabel:'<span class="checkboxLabelCls" style="font-family: Tahoma, MS Sans Serif;font-size: 11px;">'+chatterListenerInactive+"</span>"},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:(getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif"),title:lblPreviousRecord},cls:"cursorCls",listeners:{render:function(u){u.el.on("click",j)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:lblNextRecord},cls:"cursorSpaceCls",listeners:{render:function(u){u.el.on("click",a)}}}]});var n="",m="",s="";window.setTemplateID=function(v,u){n=v;s=u;k.getForm().findField("templateText").setValue(u)};window.setClientID=function(v,u){m=v;k.getForm().findField("userCombo").setValue(u)};window.getName=function(){var u=k.getForm().findField("CLname").getValue();return u};function o(v){var u=/^[a-zA-Z0-9,]+$/;if(v.length>0){if(v.match(u)){return true}else{return false}}else{return true}}function b(w){var x=0;var u=0;var v=w.length;do{u=w.indexOf(",");if(u>100){return false}else{w=w.substring(u+1,v)}v=w.length;if(w.indexOf(",")==-1){if(v>100){return false}else{return true}}}while(w.indexOf(",")!=-1);return true}function t(){var u,z,D,H,C,G,A,B,w,F,v,x,y;u=k.getForm().findField("CLname").getValue();z=k.getForm().findField("groupCombo").getValue();D=k.getForm().findField("groupCombo").getRawValue();H=k.getForm().findField("tagText").getValue();C=k.getForm().findField("objectSeleted").getValue();G=k.getForm().findField("templateText").getValue();A="fkclient__c";B=k.getForm().findField("userCombo").getValue();w=k.getForm().findField("autoReply").getValue();F=k.getForm().findField("copyFromIncidentChbx").getValue();v=k.getForm().findField("followChbx").getValue();x=k.getForm().findField("publishChbx").getValue();y=Ext.getCmp("inactive").getValue();var E=false;if(u.length>80){errormsg=nameLengthValidation}else{if(H.length>255){errormsg=keywordLengthLabel}else{if(w.length>1000){errormsg=autoReplyLenghtMsg}else{if(y&&x){errormsg=inactiveConfigLabel}else{if(!o(H)){errormsg="Only alphanumeric characters are allowed in the Hashtags field. Do not enter special characters."}else{if(!b(H)){errormsg="Maximum character limit allowed for a hashtag is 100 characters."}else{if((u!=null&&u!="")&&(z!=null&&z!="")&&(H!=null&&H!="")&&(G!=null&&G!="")&&(w!=null&&w!="")){saveConfig(u,z,D,H,C,G,A,B,w,F,v,x,m,n,y);E=true;waitbox(0)}else{errormsg=requiredFieldMsg}}}}}}}if(!E){waitbox(0);displayError();waitMsg.hide()}}window.disableButtons=function(u){var v=u;Ext.getCmp("copyId").setDisabled(!isCreateable||isNewRecord);Ext.getCmp("saveId").setDisabled((!isUpdateable&&!isNewRecord)||(isNewRecord&&!isCreateable));Ext.getCmp("deleteId").setDisabled(isNewRecord||!isDeletable);Ext.getCmp("resetId").setDisabled(v);k.getForm().findField("publishChbx").setValue(false);var w=navigator.userAgent.toLowerCase();if(w.indexOf("msie")==-1){Ext.getCmp("prevId").setDisabled(v);Ext.getCmp("nextId").setDisabled(v)}};var i=new Ext.Panel({id:"mainPanel",border:true,height:645,autoWidth:true,items:[k],renderTo:"mainDiv"});function e(){if(f==null||f==""){if(typeof(window.parent.returnListOfId)=="function"){f=window.parent.returnListOfId()}}}function j(){if(!isNewRecord){e();var v="";var u=0;while(f.length>u){if(v==""){v=f[u]}else{v=v+","+f[u]}u++}p();previousIncidentBtnHandler(v)}}function a(){if(!isNewRecord){e();var v="";var u=0;while(f.length>u){if(v==""){v=f[u]}else{v=v+","+f[u]}u++}p();nextIncidentBtnHandler(v)}}function c(w){var x=k.getForm().findField("autoReply");var u=k.getForm().findField("autoReplyInput");var v=k.getForm().findField("copyFromIncidentChbx");if(w!=""&&w!=null){v.setDisabled(false);u.setReadOnly(false);document.getElementById("autoReplyInput").style.cssText="background : none !important;background-color: none !important; width:460px; height:105px;"}else{v.setDisabled(true);u.setReadOnly(true);document.getElementById("autoReplyInput").style.cssText="background : none !important;background-color: #D4D0C8 !important; width:460px;"}}if(isNewRecord){var g=navigator.userAgent.toLowerCase();if(g.indexOf("msie")==-1){Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true)}}if(isToUpdateTitle!=null&&isToUpdateTitle!="undefined"&&isToUpdateTitle=="true"){updateTitle();isToUpdateTitle="false"}function p(){if(isFormDirty){isFormDirty=false;window.parent.registerSave(wid)}}handleElemEvent()});