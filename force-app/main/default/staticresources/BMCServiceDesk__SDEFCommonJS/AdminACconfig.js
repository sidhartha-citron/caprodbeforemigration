var isChanged=false;function onSaveComplete(){if(errMsg!=null||errMsg!=""){if(errMsg==saveMsg){showMessage(savedSuccesslbl)}else{showACErrMsg(errMsg,true,true)}}waitMsg.hide()}function showValidationMsg(){if(errMsg!=null||errMsg!=""){if(errMsg==validCreds){showACErrMsg(errMsg,false)}else{showACErrMsg(errMsg,true)}}waitMsg.hide()}function SaveBtnHandler(){setGridData();var a=setProcessorData();if(a){if(isChanged){handleAcSave()}else{handleACMappingSave()}}}function handleAcSave(){var a=getACEnableEle();if(a!=null){if(a.checked){var b=checkAllValuesValid();if(b){waitbox(0);saveAcConfig()}else{if(!b){showACErrMsg(acConfMissing,true,true)}}}else{waitbox(0);upsertEnableAC()}}}function handleACMappingSave(){var a=getACEnableEle();if(a!=null){if(a.checked){waitbox(0);saveAcMapping()}}}function allValuesEntered(){var d=getAcServerNameEle();var b=getACPortEle();var c=getACUserNameEle();var a=getACPwdEle();if((d!=null&&d.value!="")&&(b!=null&&b.value!="")&&(c!=null&&c.value!="")&&(a!=null&&a.value!="")){return true}else{return false}}function checkAllValuesValid(){if(allValuesEntered()){return true}else{var a=getACEnableEle().checked;if(a){showExtJSmessage(acConfMissing);return false}else{return true}}}function validateACcredsJS(){var a=checkAllValuesValid();if(a){waitbox(0);validateACcreds()}}function toggleAC(b){if(b){var f=getAcServerNameEle();if(f!=null){f.disabled=false}var d=getACPortEle();if(d!=null){d.disabled=false}var e=getACUserNameEle();if(e!=null){e.disabled=false}var a=getACPwdEle();if(a!=null){a.disabled=false}var c=getUpgradedACVersionEle();if(c!=null){c.disabled=false}Ext.getCmp("MappingGrid").setDisabled(false);Ext.getCmp("processorhourFieldsId").setDisabled(false);Ext.getCmp("processorminuteFieldId").setDisabled(false);Ext.getCmp("processorbutton").setDisabled(false);document.getElementById(ACLogId).disabled=false}else{var f=getAcServerNameEle();if(f!=null){f.disabled=true}var d=getACPortEle();if(d!=null){d.disabled=true}var e=getACUserNameEle();if(e!=null){e.disabled=true}var a=getACPwdEle();if(a!=null){a.disabled=true}var c=getUpgradedACVersionEle();if(c!=null){c.disabled=true}Ext.getCmp("MappingGrid").setDisabled(true);Ext.getCmp("processorhourFieldsId").setDisabled(true);Ext.getCmp("processorminuteFieldId").setDisabled(true);Ext.getCmp("processorbutton").setDisabled(true);document.getElementById(ACLogId).disabled=true}}function checkNumbers(b){if(window.event!=null&&typeof(window.event)!="undefined"){var a=window.event.keyCode}else{if(b!=null){var a=b.which}else{return true}}if(a>31&&(a<48||a>57)){return false}return true}function chkToEnableValidateBtn(){var a=document.getElementById("validateCredentialsBtn");if(getACEnableEle().checked&&getAcServerNameEle().value!=""&&getACPortEle().value!=""&&getACUserNameEle().value!=""&&getACPwdEle().value!=""){a.disabled=false;a.style.color="#004376"}else{a.disabled=true;a.style.color="#808080"}}Ext.onReady(function(){orStore=new Ext.data.ArrayStore({fields:[{name:"OR_Status"},{name:"OR_StatusValue"},{name:"Status"},{name:"Status_ID"}]});orStore.loadData(orData);function b(h,f,d,i,g,e){return'<table style="width: 99%"><tr><td style="width: 203px"><input readonly="readonly" id= "'+d.get("OR_StatusValue")+'" onkeypress="return statusBoxKeyPressed(event,'+i+')" class= "clsInputTextBox" type="text" value="'+h+'" /></td><td><input type="button" class="lookupIconOn" onClick="gridrowIndex = '+i+'; openStatusLookup()" /></tr></table>'}var c=new Ext.grid.GridPanel({id:"MappingGrid",renderTo:"mappingGrid",store:orStore,height:215,width:470,cls:"gridFontCls",columns:[{id:"OR_Status",header:ORStatusLabel,width:220,sortable:false,menuDisabled:true,dataIndex:"OR_Status"},{id:"OR_StatusValue",header:"OR Status Value",hidden:true,width:220,sortable:false,menuDisabled:true,dataIndex:"OR_StatusValue"},{id:"Status",header:taskStatusLabel,width:230,sortable:false,menuDisabled:true,dataIndex:"Status",renderer:b},{id:"Status_ID",header:"Status_ID",hidden:true,sortable:false,menuDisabled:true,dataIndex:"Status_ID"}],stripeRows:true,autoScroll:false,autoExpandColumn:"Status",border:true,viewConfig:{forceFit:true,scrollOffset:0},listeners:{rowClick:function(f,e,d){gridrowIndex=e}}});statusBoxKeyPressed=function(d,g){if(d.keyCode==Ext.EventObject.BACKSPACE||d.keyCode==Ext.EventObject.DELETE){gridrowIndex=g;var f=Ext.getCmp("MappingGrid").store.getAt(g);f.set("Status_ID","");document.getElementById(f.get("OR_Status")).value=""}};ProcessorhourField=new Ext.ux.form.SpinnerField({id:"processorhourFieldsId",value:processordefaulthourvalue,minValue:0,maxValue:99,width:50,renderTo:"processorhourFieldTD",enableKeyEvents:true,maxLength:2,allowDecimals:false,autoCreate:{tag:"input",type:"text",autocomplete:"off",maxlength:"2"},listeners:{keydown:function(f,d){if(d.getKey()==109){d.stopEvent()}},keyup:function(f,d){validateSpinnerField(f,d)}}});processorminuteField=new Ext.ux.form.SpinnerField({id:"processorminuteFieldId",type:"spinnerfield",name:"processorminuteFieldId",minValue:0,maxValue:59,maxLength:2,autoCreate:{tag:"input",type:"text",autocomplete:"off",maxlength:"2"},value:processordefaultminutevalue,allowDecimals:false,enableKeyEvents:true,incrementValue:1,renderTo:"processorminuteFieldTD",width:55,listeners:{keydown:function(f,d){if(d.getKey()==109){d.stopEvent()}},keyup:function(f,d){validateSpinnerField(f,d)}}});processorButton=new Ext.Button({id:"processorbutton",name:"processorbutton",text:"",renderTo:"processorButtonTD",width:200,handler:function(){if(processorButton.getText()==startbuttontext){var e=0;var d=false;while(orStore.data.length>e){if(orStore.getAt(e).get("Status_ID")!=null&&orStore.getAt(e).get("Status_ID")!=""){d=true;break}e++}if(!d){showACWarnMsg(processorWarningMsg)}else{Ext.getCmp("processorbutton").setText(stopbuttontext);Ext.getCmp("processorbutton").setDisabled(true);ScheduleJob()}}else{Ext.getCmp("processorbutton").setText(startbuttontext);Ext.getCmp("processorbutton").setDisabled(true);StopJob()}}});if(!jobstatusflag){Ext.getCmp("processorbutton").setText(startbuttontext)}else{Ext.getCmp("processorbutton").setText(stopbuttontext)}var a=getACEnableEle();if(a!=null){toggleAC(a.checked)}});function openStatusLookup(){var a=Ext.getCmp("MappingGrid").store.getAt(gridrowIndex);openPopupRF("SearchPage?popupId=Status&isLookup=true&idNameForPopUp=true&filterClause="+escape("inactive__c = false and appliesToTask__c = true"),setStatusValue,570,670,true)}function setStatusValue(d){var a=Ext.getCmp("MappingGrid");if(d.indexOf(EF)>0){var c=a.store.getAt(gridrowIndex);c.set("Status_ID",d.split(EF)[0]);var b=c.get("OR_StatusValue");document.getElementById(b).value=decodeVal(d.split(EF)[1])}}function setGridData(){var c="";var a=0;var b="";while(orStore.data.length>a){b=orStore.getAt(a).get("Status_ID");c=c+orStore.getAt(a).get("OR_StatusValue")+PE+b+nonPrint;a++}document.getElementById(mappingGridDataComponent).value=c}function decodeVal(a){a=a.replace("&gt;",">","g");a=a.replace("&lt;","<","g");a=a.replace("&quot;",'"',"g");a=a.replace("&amp;","&","g");return a}function setProcessorData(){var c=0;var b;var a;if(ProcessorhourField.getValue()===""){showACErrMsg(timeMandatoryError,false);return false}else{b=ProcessorhourField.getValue()}if(processorminuteField.getValue()===""){showACErrMsg(timeMandatoryError,false);return false}else{a=processorminuteField.getValue()}if(ProcessorhourField.getValue()==0&&processorminuteField.getValue()==0){showACErrMsg(timeMandatoryError,false);return false}c=(parseInt(b)*60)+parseInt(a);document.getElementById(processorIntervalDataComp).value=c;return true}function showACWarnMsg(a){Ext.Msg.show({msg:a,buttons:Ext.Msg.YESNO,fn:function(b){if(b=="yes"){Ext.getCmp("processorbutton").setText(stopbuttontext);Ext.getCmp("processorbutton").setDisabled(true);ScheduleJob();return true}},icon:Ext.MessageBox.WARNING});return false}function showMessage(a){Ext.MessageBox.show({id:"commonmsgbox",title:messageHeader,width:250,msg:a,buttons:Ext.MessageBox.OK})}function waitbox(a){if(parseInt(a)>0){setTimeout("waitMsg.hide()",a)}waitMsg=new Ext.Window({height:100,width:200,resizable:false,closable:false,header:false,frame:false,modal:true,shadow:false,baseCls:"waitboxCls",items:[{xtype:"panel",height:100,width:200,border:false,bodyStyle:"background-color:transparent;border:none;",html:'<div align="center"><img src="'+tabOutImg+'"/></div>'}]});waitMsg.show()};