var initialRecordState="";var lastModifiedByLocking="";var changeName=ChangeConsolePage.Labels.New;var LabelNew=ChangeConsolePage.Labels.New_ChangeRequest;var tabName=ChangeConsolePage.Labels.ChangeRecordPrefix+": "+ChangeConsolePage.Labels.New;var isRecordLock="";var status="";var desc="";var isDeleted=false;var ServiceTargetStatus="";var selectedCategoryId="";var isSaveForSingleConsole=true;var isSAVE=false;var isNeedToRefreshChange=false;var isNeedToRefreshRelatedList=false;var isNeedToRefreshSmartView=false;var isFocusOnChangeForm=true;var isFocusOnRelatedList=false;var isFocusOnSmartView=false;var isNewChangeForm=false;var isNeedToRefreshChangeList=false;var waitMsgBar="";var isChangeFormFrameLoaded=true;var isChangeRelatedListFrameLoaded=true;var isChangeSmartViewFrameLoaded=true;var clickedOnce=false;var ServiceTargetsBtnHandlerWindow;var isNewRecordLock=false;var saveFromQuickClose=false;var screenWidth=671;var screenHeight=400;var SconsoletabName="";var isOptionalItemsAdded=false;var sendEmailBtnHandler;var viewActionHistoryBtnHandler;var newActionHandler;var RespondedBtnHandler;var addNoteHandler;var cloneBtnHandler;var ReopenBtnHandler;var CloseBtnHandler;var createKABtnHandler;var knowledgeSearchBtnHandler;var CIExplorerBtnHandler;var ChangeScheduleBtnHandler;var ServiceTargetsBtnHandler;var ChangeManifestBtnHandler;var ChangeCollisionBtnHandler;function screenLeft(a){return parseInt((screen.availWidth/2)-(a/2))}function screenTop(b){if(Ext.isChrome){var a=parseInt((screen.availHeight/2)-(screenHeight/2));return(a-25)}else{return parseInt((screen.availHeight/2)-(screenHeight/2))}}var left=screenLeft();var top=screenTop();var functionArray=new Array();function setChangeData(a){functionArray[0]=a}function saveChange(a){functionArray[1]=a}function showCollisionMessagePar(a){functionArray[2]=a}function assignRFLookupFilter(a){functionArray[3]=a}function getLookupFilterQuery(a){return functionArray[3](a)}function reopen(){if(verifyChange()){handleSave()}Visualforce.remoting.Manager.invokeAction(_RemotingActions.reopen,recordId,function(a,b){if(b.type==="exception"){alert(b.message);stopWaitMsgBar()}else{stopWaitMsgBar();if(isFocusOnChangeForm){loadChangeDetail(recordId)}if(isFocusOnRelatedList){loadChangeDetail(recordId);loadChangeRelatedList(recordId)}isNeedToRefreshRelatedList=true;isNeedToRefreshChangeList=true;isNeedToRefreshSmartView=true;if(isServiceCloudConsole!="true"&&isRFConsoleDetailForm&&window.parent.MultiPageLayout&&window.parent.MultiPageLayout.isEnabledForCR){UndoBtnHandler()}}},{escape:true})}function responded(){Visualforce.remoting.Manager.invokeAction(_RemotingActions.responded,recordId,function(a,b){if(b.type==="exception"){alert(b.message);stopWaitMsgBar()}else{stopWaitMsgBar();loadChangeDetail(recordId)}},{escape:true})}var openCloneRecordTabHandler=function(a){window.parent.addTab(recordId,"","Change_Request__c",true,"","","",a)};function LoadHandlerForActionItem(){var b;CloseBtnHandler=function(g,h){if(verifyChange()){Ext.Msg.defaultButton=1;Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:ChangeConsolePage.Labels.closeConfirmMsg,buttons:Ext.Msg.OK,buttonText:{ok:ChangeConsolePage.Labels.ServiceTargetsOK},icon:Ext.MessageBox.INFO})}else{screenHeight=440;screenWidth=871;var j=new Object;j.isNeedToRefreshRelatedList=isNeedToRefreshRelatedList;j.loadChangeDetail=loadChangeDetail;j.startWaitMsgBar=startWaitMsgBar;j.refreshChange=refreshChange;j.isNeedToRefreshChangeList=j;j.isRFConsoleDetailForm=isRFConsoleDetailForm;var f="dialogWidth:"+screenWidth+"px;dialogHeight:"+screenHeight+"px;status;resizable;scrollbars:no;center:yes;dialogLeft:"+screenLeft(screenWidth)+"px;;dialogTop:"+screenTop(screenHeight)+"px;";var i=window.location.hash=!!window.MSInputMethodContext;if(!b||b.closed){if(window.showModalDialog&&(Ext.isIE||i)){b=window.showModalDialog("/apex/CloseChangePage?changeId="+recordId+"&calledFrom=rfconsole&isLookup=true",j,f)}else{f="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=yes,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);b=window.open("/apex/CloseChangePage?changeId="+recordId+"&calledFrom=rfconsole&isLookup=true","_blank",f)}}if(b!=""&&typeof(b)!="undefined"&&b.focus){b.focus()}}};ReopenBtnHandler=function(f,g){startWaitMsgBar();reopen()};cloneBtnHandler=function(f,g){var h=window.location.hash=!!window.MSInputMethodContext;if(Ext.isIE||h){hideMenu()}if(isServiceCloudConsole=="true"){sforce.console.openPrimaryTab(null,changeConsole+"&record_id="+recordId+"&isCloneRequest=true&isServiceCloudConsole=true&ran="+new Date().getTime(),true,ChangeConsolePage.Labels.New);return false}else{if(isRFConsoleDetailForm=="true"){if(previousFormLayoutId&&window.parent.MultiPageLayout&&window.parent.MultiPageLayout.isEnabledForCR){window.parent.hasFormLayoutAccessCloneMessage(openCloneRecordTabHandler,previousFormLayoutId,"cr")}else{window.parent.addTab(recordId,"","Change_Request__c",true)}}else{if(verifyChange()){var i=cloneBtnHandler;showCloseWarning(i,null)}else{isCloneRequest="true";startWaitMsgBar();loadChangeDetail(recordId)}}}};var a;addNoteHandler=function(f,g){if(!a||a.closed){a=window.open("/apex/stdlayoutchangerequestaddnotepage?id="+recordId+"&fromconsole=true","addNote","width=600,height=400,resizable = 0,scrollbars=no,status=1,top=350,left=350")}if(a.focus){a.focus()}};RespondedBtnHandler=function(f,g){startWaitMsgBar();responded()};var c;newActionHandler=function(f,g){c=window.open("/apex/searchPage?popupId=Action&isLookup=true&objectType=Change_History__c&isCalledFromConsole=true&enableSelfClosing=false&standardLayout=true&parentId="+recordId+"&filterClause=appliesToChange__c%3Dtrue%20and%20system__c%3Dfalse","newAction","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=no");if(c.focus){c.focus()}};var e;viewActionHistoryBtnHandler=function(f,g){screenWidth=671;screenHeight=400;c=window.open("/apex/ViewAllActions?ObjectId="+recordId+"&recordState="+recordState+"&objectName=Change Request&recordName="+changeName,"actionHistory","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=yes");if(c.focus){c.focus()}};var d;sendEmailBtnHandler=function(g,h){screenHeight=700;screenWidth=900;left=screenLeft(screenWidth);top=screenTop(screenHeight);var f="dialogWidth:"+screenWidth+"px;dialogHeight:"+screenHeight+"px;status;resizable;scrollbars:no;center:yes;dialogLeft:"+screenLeft(screenWidth)+"px;;dialogTop:"+screenTop(screenHeight)+"px;";if(!d||d.closed){if(window.showModalDialog&&Ext.isIE){var i=new Object;i.isFocusOnRelatedList=isFocusOnRelatedList;i.loadChangeRelatedList=loadChangeRelatedList;i.startWaitMsgBar=startWaitMsgBar;i.setIsNeedToRefreshRelatedList=setIsNeedToRefreshRelatedList;d=window.showModalDialog("/apex/ComposeEmailPage?enableSelfClosing=false&recordId="+recordId+"&isNew=true&objectName=Change_Request__c&isConsolePage=true&popupHeader="+changeName,i,f)}else{f="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=yes,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);d=window.open("/apex/ComposeEmailPage?enableSelfClosing=false&recordId="+recordId+"&isNew=true&objectName=Change_Request__c&isConsolePage=true&popupHeader="+changeName,"_blank",f)}}if(d!=""&&typeof(d)!="undefined"&&d.focus){d.focus()}}}var openInVar="";var customActionJsonString="";var urlStringVar="";var custionActionObj="";function customActionHandler(a){openInVar=a.openIn;custionActionObj=a;getCustomActionURL(a.id)}function openUrl(){if(openInVar.indexOf("Remedyforce")!=-1){window.parent.parent.addNewTab(custionActionObj.id,customActionHeaderLabel,"NavigatorPage?title="+custionActionObj.encodedText+"&isCustomActionLink=true&target="+urlStringVar)}else{if(openInVar.toLowerCase().indexOf("window")!=-1){var a="resizable=1,scrollbars=1,fullscreen=1,toolbar=1,menubar=1,location=1,height="+screen.height+",width="+screen.width+",top = 0,left = 0";window.open(urlStringVar,"",a)}else{window.open(urlStringVar)}}}function getCustomActionURL(customId){var incId=recordId;eval(orgNamespace).JSRemoteActions.getCustomActionURL("Change",incId,customId,function(result,event){if(event.status){if(result!=""&&result!=null){urlStringVar=result;openUrl()}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:false})}function getDetailViewActionMenu(){if(ActionMenuItem=="-"){ActionMenuItem=""}var a=false;if(recordId==null||recordId==""){a=true}return Ext.create("Ext.menu.Menu",{id:"mainMenu",baseCls:"bmc-menu",shadow:false,items:ActionMenuItem})}var ImpactAnalysisHandlerwindow;var ImpactAnalysisHandler=function(a,b){screenWidth=1100;screenHeight=650;ImpactAnalysisHandlerwindow=window.open("/apex/ImpactAnalysis?parentId="+recordId+"&popupHeader="+changeName,"ImpactAnalysis","status = 1,height =600,width =1100,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1,scrollbars=yes");if(ImpactAnalysisHandlerwindow.focus){ImpactAnalysisHandlerwindow.focus()}};function loadMultiPageLayoutMenu(){return isServiceCloudConsole!="true"&&isRFConsoleDetailForm&&window.parent.MultiPageLayout.isEnabledForCR&&window.parent.MultiPageLayout.details.cr.length>1}function getChangePageLayoutMenu(){if(loadMultiPageLayoutMenu()){return Ext.create("Ext.menu.Menu",{id:"pageLayoutMenuItems",baseCls:"bmc-menu",shadow:false,items:window.parent.getPageLayoutMenuItems(ChangeFormNewBtnHandler,"cr"),maxHeight:"310",listeners:{mouseleave:{element:"el",fn:function(){Ext.getCmp("pageLayoutMenuItems").hide()}}}})}else{return""}}var ChangeFormNewBtnHandler=function(a,b){var c=window.location.hash=!!window.MSInputMethodContext;if(Ext.isIE||c){hideMenu()}if(isRFConsoleDetailForm=="true"){window.parent.addTab(null,"","Change_Request__c","","","","",this.optionId)}else{if(isServiceCloudConsole=="true"){sforce.console.openPrimaryTab(null,changeConsole+"&record_id=&isServiceCloudConsole=true&ran="+new Date().getTime(),true,ChangeConsolePage.Labels.New);return false}else{if(verifyChange()){var d=NewBtnhandler;showCloseWarning(d,null)}else{startWaitMsgBar();loadChangeDetail(null)}}}};var ChangeRelatedListBtnhandler;var UndoBtnHandler=function(b,c){if(verifyChange()){var a=UndoBtnHandler;showCloseWarning(a)}else{startWaitMsgBar();formLayoutId=previousFormLayoutId;if(isFocusOnChangeForm){loadChangeDetail(recordId)}else{if(isFocusOnRelatedList){loadChangeRelatedList(recordId)}else{if(isFocusOnSmartView){loadChangeSmartView(recordId)}else{loadChangeDetail(null)}}}}};function getDetailVeiwToolBar(){var c=function(d,e){if(!loadMultiPageLayoutMenu()){ChangeFormNewBtnHandler(d,e)}};var a=function(f,g){startWaitMsgBar();Ext.getCmp("ChangeFormBtnId").toggle(true);Ext.getCmp("actionButton").setDisabled(false);Ext.getCmp("agentToolsBtnId").setDisabled(false);if(isRecordLock&&isRecordLock.indexOf("true")>-1){Ext.getCmp("saveId").setDisabled(true)}else{if(_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(false)}}var e=document.getElementById("changeRelatedListFrameId");hideDiv(e);var d=document.getElementById("changeDetailsFrameId");if(d.src==""||isNeedToRefreshChange==true){loadChangeDetail(recordId)}else{showDiv(d);if(isActivityFeedEnabled==true){showActivityFeed()}if(isCISidebarEnabled==true){showRelatedCI()}if(isChangeFormFrameLoaded){stopWaitMsgBar()}resizeChangeConsoleDetailsFrameForIEEDGE()}};ChangeRelatedListBtnhandler=function(e,f){Ext.getCmp("changeReleatedListBtnId").toggle(true);Ext.getCmp("actionButton").setDisabled(false);Ext.getCmp("agentToolsBtnId").setDisabled(false);if(isRecordLock&&isRecordLock.indexOf("true")>-1){Ext.getCmp("saveId").setDisabled(true)}else{if(_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(false)}}startWaitMsgBar();var h=document.getElementById("changeDetailsFrameId");hideDiv(h);hideActivityFeed();hideRelatedCI();var g=document.getElementById("changeSmartViewFrameId");hideDiv(g);var d=document.getElementById("changeRelatedListFrameId");if(d.src==""||isNeedToRefreshRelatedList==true){loadChangeRelatedList(recordId)}else{showDiv(d);if(isChangeRelatedListFrameLoaded){stopWaitMsgBar()}}};ChangeSmartViewBtnhandler=function(e,f){Ext.getCmp("SmartViewBtnId").toggle(true);Ext.getCmp("actionButton").setDisabled(true);Ext.getCmp("agentToolsBtnId").setDisabled(true);Ext.getCmp("saveId").setDisabled(true);var g=document.getElementById("changeDetailsFrameId");hideDiv(g);hideActivityFeed();hideRelatedCI();var d=document.getElementById("changeRelatedListFrameId");hideDiv(d);if(hasActivityFeedPermission!=undefined){if(hasActivityFeedPermission==true){loadContentsInSmartViews()}else{showSmartViewsError(isLoggedInUserAdmin)}stopWaitMsgBar()}else{checkSmartViewAccess(false)}};var b=function(e,f){startWaitMsgBar();functionArray[1]();if(isRFConsoleDetailForm){isSaveForSingleConsole=true;isSAVE=true}Ext.getCmp("ChangeFormBtnId").toggle(true);var d=document.getElementById("changeDetailsFrameId");showDiv(d)};return Ext.create("Ext.toolbar.Toolbar",{id:"detailViewToolbarId",items:[{xtype:"tbspacer",width:5},{id:"newId",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:ChangeConsolePage.Labels.New,menu:getChangePageLayoutMenu(),arrowCls:"d-icon-angle_down",tooltip:returnLabel(ChangeConsolePage.Labels.New,"N"),disabled:!_ServerVariables.ObjectMetadata.isCreateable,handler:c},{xtype:"tbspacer",width:5},{id:"refreshId",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:ChangeConsolePage.Labels.Undo,tooltip:ChangeConsolePage.Labels.Undo_Consolebtn_Tooltip,handler:UndoBtnHandler},{xtype:"tbspacer",width:5},{id:"saveId",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",text:ChangeConsolePage.Labels.Save,tooltip:returnLabel(ChangeConsolePage.Labels.Save,"S"),disabled:!_ServerVariables.ObjectMetadata.isUpdateable,handler:b},{xtype:"tbspacer",width:5},"-",{id:"actionButton",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",text:ChangeConsolePage.Labels.Actions,tooltip:returnLabel(ChangeConsolePage.Labels.Actions,"A"),menu:getDetailViewActionMenu()},{id:"agentToolsBtnId",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"bmc-btn-dropdown-focus",overCls:"bmc-btn-dropdown-over",pressedCls:"bmc-btn-dropdown-pressed",text:ChangeConsolePage.Labels.AgentTools,tooltip:returnLabel(ChangeConsolePage.Labels.AgentTools,"T"),menu:getChangeAgentToolsBtnMenu()},{id:"ChangeFormBtnGroupId",xtype:"buttongroup",columns:3,border:false,frame:false,items:[{id:"ChangeFormBtnId",cls:"bmc-togglebar-left-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:ChangeConsolePage.Labels.ChangeForm,tooltip:ChangeConsolePage.Labels.ChangeForm,enableToggle:true,pressed:true,disabled:((recordId==null||recordId==""||recordId=="new")?true:false),toggleGroup:"changeBtnGroup",handler:a,listeners:{toggle:{fn:function(d,e){if(e){isFocusOnChangeForm=true}else{isFocusOnChangeForm=false}}}}},{id:"changeReleatedListBtnId",cls:(!isRFConsoleDetailForm||parent.hideSmartViewbtn())?"bmc-togglebar-right-btn":"bmc-togglebar-center-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:ChangeConsolePage.Labels.RelatedLists,tooltip:ChangeConsolePage.Labels.RelatedLists,enableToggle:true,disabled:((recordId==null||recordId==""||recordId=="new")?true:false),toggleGroup:"changeBtnGroup",handler:ChangeRelatedListBtnhandler,listeners:{toggle:{fn:function(d,e){if(e){isFocusOnRelatedList=true}else{isFocusOnRelatedList=false}}}}},{id:"SmartViewBtnId",cls:"bmc-togglebar-right-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:ChangeConsolePage.Labels.SmartView,tooltip:ChangeConsolePage.Labels.SmartView,enableToggle:true,disabled:((recordId==null||recordId==""||recordId=="new"||isCloneRequest=="true")?true:false),toggleGroup:"changeBtnGroup",handler:ChangeSmartViewBtnhandler,hidden:(!isRFConsoleDetailForm||parent.hideSmartViewbtn()),listeners:{toggle:{fn:function(d,e){if(e){isFocusOnSmartView=true}else{isFocusOnSmartView=false}d.doComponentLayout()}}}}]},{xtype:"tbfill"},{id:"LockRecord",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:ChangeConsolePage.Labels.LockRecord,tooltip:_ServerLabels.LockRecordToolTip,hidden:true,disabled:!_ServerVariables.ObjectMetadata.isUpdateable},{id:"UnlockRecord",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:ChangeConsolePage.Labels.UnlockRecord,tooltip:_ServerLabels.UnlockRecordToolTip,hidden:true,disabled:!_ServerVariables.ObjectMetadata.isUpdateable},{xtype:"tbspacer",width:5},{id:"LockRecordIcon",xtype:"label",hidden:true,cls:"d-icon-lock lock-color lock-icon",autoEl:{title:ChangeConsolePage.Labels.LockedRecord}},{id:"LockRecordLbl",xtype:"label",text:ChangeConsolePage.Labels.Locked,hidden:true,cls:"recordLockText"},{id:"UnlockRecordIcon",xtype:"label",hidden:true,cls:"d-icon-lock_open lock-icon",autoEl:{title:ChangeConsolePage.Labels.UnlockedRecord}},{xtype:"tbspacer",width:0},{xtype:"tbseparator",id:"helpIconSeparator"},{xtype:"tbspacer",width:0},{xtype:"label",html:'<a href="#" onclick="OpenHelppage(\'Detail\');" title="'+_ServerLabels.Help+'" class="d-icon-question_circle help-icon"></a>'},{xtype:"tbspacer",width:10}]})}function getDetailViewPanel(){var a=Ext.create("Ext.Panel",{id:"detailViewChildPanelId",cls:"detail-view-position-fixed",border:false,hidden:(recordId==""),width:"100%",anchor:"0 0",layout:{type:"anchor"},tbar:getDetailVeiwToolBar(),items:[Ext.create("Ext.Panel",{border:false,anchor:"0 0",width:"100%",contentEl:"DetailFormDiv"})]});waitMsgBar=new Ext.LoadMask(a,{floating:{shadow:false},msgCls:"d-loader-container",msg:'<ul class="d-loading"><li class="d-loading__stick d-loading__stick_1"></li><li class="d-loading__stick d-loading__stick_2"></li><li class="d-loading__stick d-loading__stick_3"></li><li class="d-loading__stick d-loading__stick_4"></li><li class="d-loading__stick d-loading__stick_5"></li><li class="d-loading__stick d-loading__stick_6"></li><li class="d-loading__stick d-loading__stick_7"></li><li class="d-loading__stick d-loading__stick_8"></li><li class="d-loading__stick d-loading__stick_9"></li><li class="d-loading__stick d-loading__stick_10"></li><li class="d-loading__stick d-loading__stick_11"></li><li class="d-loading__stick d-loading__stick_12"></li></ul><div>'+_ServerLabels.PleaseWaitMsg+"</div>"});return a}function LoadHandlerForAgentItem(){var e;var c;var b;var a;ChangeCollisionBtnHandler=function(f,g){screenWidth=1100;screenHeight=600;windowFeatures="status = 1,height = "+screenHeight+", width = "+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1,scrollbars=yes";ChangeCollisionBtnHandlerWindow=window.open(changeCollisionsPageURL+"&CurrentChangeID="+recordId,"ChangeCollisions",windowFeatures);if(ChangeCollisionBtnHandlerWindow.focus){ChangeCollisionBtnHandlerWindow.focus()}};ChangeManifestBtnHandler=function(f,g){screenWidth=1100;screenHeight=650;windowFeatures="status = 1,height = "+screenHeight+", width = "+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1,scrollbars=yes";a=window.open("/apex/ReleaseManifest?id="+recordId+"&stdForm=true&objectName=change_request__c&formLayoutId="+formLayoutId+"&isRFConsoleDetailForm="+isRFConsoleDetailForm,"Manifest",windowFeatures);if(a.focus){a.focus()}};ServiceTargetsBtnHandler=function(f,g){screenHeight=400;screenWidth=1087;var h="FKChangeRequest__c='"+recordId+"'";b=window.open("/apex/SearchPage?popupId=ChangeRequestServiceTarget&isLookup=true&filterClause="+escape(h)+"&standardLayout=true&iscalledFromConsole=true&popupFor=ServiceTargets&popupHeader="+changeName,"ServiceTarget","status = 1,height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=no");if(b.focus){b.focus()}};ChangeScheduleBtnHandler=function(f,g){screenHeight=650;screenWidth=1100;e=window.open("/apex/ChangeSchedule?standardLayout=true","ChangeSchedule","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1,scrollbars=no");if(e.focus){e.focus()}};var d;CIExplorerBtnHandler=function(g,h){screenWidth=1200;screenHeight=650;var f="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=no,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);d=window.open("/apex/CIExplorerLauncher?Module=Change_Request__c&RecordSequence="+recordId+"&id="+recordId+"&stdForm=true&isCalledFromConsole=true","CRCIExplorer",f);if(d.focus){d.focus()}};knowledgeSearchBtnHandler=function(f,g){screenHeight=400;screenWidth=671;c=window.open("/apex/KnowledgeSearch?enableSelfClosing=false&calledFromForm=true&standardLayout=true&isCalledFromConsole=true&objectName=Change Requests&search="+encodeURIComponent(desc)+"&isServiceCloudConsole="+isServiceCloudConsole,"KnowledgeSearch","status = 1, height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1, scrollbars=no");if(c.focus){c.focus()}};createKABtnHandler=function(f,g){screenHeight=170;screenWidth=475;createKABtnHandlerWindow=window.open("/apex/CreateKnowledgePage?isCalledFromConsole=true&changeid="+recordId,"CreateKnowledgeArticle","status = 1, height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1, scrollbars=no");if(createKABtnHandlerWindow.focus){createKABtnHandlerWindow.focus()}}}function getChangeAgentToolsBtnMenu(){var a=false;if(recordId==null||recordId==""){a=true}return Ext.create("Ext.menu.Menu",{id:"AgentToolsMenu",shadow:false,baseCls:"bmc-menu",items:AgentMenuItem})}function LoadRecord(a){if(verifyChange()){var b=LoadRecordFunc;showCloseWarning(b,a)}else{LoadRecordFunc(a)}}function LoadRecordFunc(a){console.log("Loading record...");console.log(a);recordId=a;startWaitMsgBar();if(recordId==null||recordId==""){loadChangeDetail(null)}else{isNeedToRefreshRelatedList=true;loadChangeDetail(a)}}function showDiv(a){a.style.display="block";a.style.height="100%";a.style.width="100%";var c=/chrome/i.test(navigator.userAgent);if(c){var b=a.clientHeight+2;b=(b/a.clientHeight)*100;a.style.height=b+"%"}}function hideDiv(a){a.style.display="none";a.style.height="0px";a.style.width="0px"}function loadChangeRelatedList(c){isFocusOnChangeForm=false;isFocusOnRelatedList=true;isChangeRelatedListFrameLoaded=false;var d=document.getElementById("changeDetailsFrameId");hideDiv(d);hideActivityFeed();hideRelatedCI();var b=document.getElementById("changeSmartViewFrameId");hideDiv(b);var a=document.getElementById("changeRelatedListFrameId");a.src="/apex/consoleChangeRelatedList?id="+c+"&isdtp=vw&obj=Change_Request__c";addOnLoadEvent(a,afterChangeRelatedListFrameLoad);showDiv(a)}function loadChangeSmartView(a){isFocusOnForm=false;isFocusOnRelatedList=false;isFocusOnSmartView=true;var c=document.getElementById("changeDetailsFrameId");hideDiv(c);hideActivityFeed();hideRelatedCI();var d=document.getElementById("changeRelatedListFrameId");hideDiv(d);var b=document.getElementById("changeSmartViewFrameId");if(typeof((b)!="undefined"&&b.src=="")||isNeedToRefreshSmartView==true){b.src="/apex/DeepView?id="+a+"&isEmbeddedMode=true";addOnLoadEvent(b,afterChangeSmartViewFrameLoad);showDiv(b)}}function loadChangeDetail(d){isChangeFormFrameLoaded=false;isFocusOnChangeForm=true;isFocusOnRelatedList=false;var b=document.getElementById("changeRelatedListFrameId");hideDiv(b);var a=document.getElementById("changeDetailsFrameId");if(d==null||d==""||isCloneRequest=="true"){isNewChangeForm=true;isNewRecordLock=true;if(isCloneRequest=="true"){isCloneRequest="false";a.src="/apex/ConsoleChangeDetail?oldChangeId="+d+"&formLayoutId="+formLayoutId;clickedOnce=true;handleChange()}else{a.src="/apex/ConsoleChangeDetail?clientId="+_ServerVariables.PageParams.clientid+"&formLayoutId="+formLayoutId+"&templateId="+templateId+"&isLayoutChanged="+isLayoutChanged}}else{isNewChangeForm=false;a.src="/apex/ConsoleChangeDetail?id="+d+"&formLayoutId="+formLayoutId+"&templateId="+templateId+"&isLayoutChanged="+isLayoutChanged}addOnLoadEvent(a,afterChangeDetailFrameLoad);if(isNewChangeForm){Ext.getCmp("helpIconSeparator").hide();Ext.getCmp("detailViewToolbarId").doLayout()}else{addOptionalToolbarItems();Ext.getCmp("helpIconSeparator").show();Ext.getCmp("detailViewToolbarId").doLayout()}showDiv(a);var c=Ext.getCmp("detailViewChildPanelId");c.show();if(isActivityFeedEnabled==true&&isNewChangeForm!=true&&isCloneRequest!="true"&&isFocusOnChangeForm==true){displayActivityFeed=true}if(isCISidebarEnabled==true&&isNewChangeForm!=true&&isCloneRequest!="true"&&isFocusOnChangeForm==true){displayCISidebar=true}}function afterChangeDetailFrameLoad(){if(isNewChangeForm){afterNewFormLoad()}else{afterDetailFormLoad()}isNeedToRefreshChange=false;isChangeFormFrameLoaded=true;if(isDeleted){disableDetailFormButtons()}isDeleted=false;resizeChangeConsoleDetailsFrameForIEEDGE()}function resizeChangeConsoleDetailsFrameForIEEDGE(){if(checkIsIEBrowser()||(/Edge\/\d./i.test(navigator.userAgent))){document.getElementById("changeDetailsFrameId").style.position="fixed";document.getElementById("changeDetailsFrameId").style.height="92%"}}function afterChangeRelatedListFrameLoad(){stopWaitMsgBar();isChangeRelatedListFrameLoaded=true}function afterChangeSmartViewFrameLoad(){var a=document.getElementById("changeSmartViewFrameId");if(a&&a.src!=""){stopWaitMsgBar()}isChangeSmartViewFrameLoaded=true}function afterNewFormLoad(){removeChangeData();AttRefGeneratorId="";Ext.getCmp("saveId").setDisabled(false);Ext.getCmp("refreshId").setDisabled(false);if(Ext.getCmp("viewActionHistoryId")!=undefined&&Ext.getCmp("viewActionHistoryId")!=null){Ext.getCmp("viewActionHistoryId").setDisabled(true)}if(isServiceCloudConsole=="true"){sforce.console.setTabTitle(LabelNew)}disableActionMenuItems(true);disableAgentMenuItems(true);Ext.getCmp("ChangeFormBtnId").toggle(false);Ext.getCmp("changeReleatedListBtnId").toggle(false);Ext.getCmp("changeReleatedListBtnId").setDisabled(true);Ext.getCmp("ChangeFormBtnId").setDisabled(true);isNewChangeForm=false;stopWaitMsgBar()}function afterDetailFormLoad(){if(functionArray[0]!="undefined"&&functionArray[0]!=null&&functionArray[0]!="null"&&functionArray[0]!=""){disableActionMenuItems(true);disableAgentMenuItems(true);var b=functionArray[0]();var o=recordId;if(isRFConsoleDetailForm&&isSaveForSingleConsole){window.parent.changeTabTitle(tabId,b.Name);isSaveForSingleConsole=false;window.parent.updateDirtyFlag(tabId,false);if(o==null||o==""){window.parent.changeTabItemId(b.Id,tabId)}}if(o==null||o==""){enableCustomActions()}getChangeData(b);if(Ext.getCmp("viewActionHistoryId")!=undefined&&Ext.getCmp("viewActionHistoryId")!=null){Ext.getCmp("viewActionHistoryId").setDisabled(false)}Ext.getCmp("refreshId").setDisabled(false);if(isServiceCloudConsole=="true"){sforce.console.setTabTitle(b.Name);SconsoletabName=b.Name;sforce.console.getFocusedPrimaryTabId(addSConsoleTabComplete)}var c=Ext.getCmp("ChangeStatusId");if(c){c.update(b.Stage__c)}Ext.getCmp("changeReleatedListBtnId").setDisabled(false);if(isFocusOnChangeForm){Ext.getCmp("ChangeFormBtnId").toggle(true)}Ext.getCmp("ChangeFormBtnId").setDisabled(false);Ext.getCmp("AgentToolsMenu").setDisabled(false);if(_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(false)}else{Ext.getCmp("saveId").setDisabled(true)}if(isFocusOnSmartView){Ext.getCmp("saveId").setDisabled(true)}var n=Ext.getCmp("respondedButtonId");var f=Ext.getCmp("closeButtonId");var d=Ext.getCmp("reopenButtonId");var h=Ext.getCmp("addNoteId");var p=Ext.getCmp("emailId");var e=Ext.getCmp("cloneButtonId");var m=Ext.getCmp("printId");var t=Ext.getCmp("printPDFId");var k=Ext.getCmp("attachFileId");var r=Ext.getCmp("newActionId");var g=Ext.getCmp("knowledgeSearchButtonId");var s=Ext.getCmp("createKnowledgeArticleButtonId");var l=Ext.getCmp("CiExplorerButtonId");var j=Ext.getCmp("ChangeManifestButtonId");var q=Ext.getCmp("ChangeScheduleId");var i=Ext.getCmp("ImpactAnalysisId");var a=Ext.getCmp("ChangeCollisionId");if(recordState=="true"){if(_ServerVariables.ObjectMetadata.isUpdateable){if(n!=undefined&&n!=null){n.setDisabled(false)}if(f!=undefined&&f!=null){f.setDisabled(false)}if(p!=undefined&&p!=null){p.setDisabled(false)}if(h!=undefined&&h!=null){h.setDisabled(false)}if(r!=undefined&&r!=null){r.setDisabled(false)}checkApprovalstatus();if(typeof(recordLock)!="undefined"&&recordLock!=null&&recordLock!="Off"){if(!isSAVE||(isSAVE&&initialRecordState=="true")){if(typeof(isRecordLock)!="undefined"&&isRecordLock!=null&&isRecordLock.indexOf("false")>-1){if(recordLock=="Explicit"){if(isRecordLock.indexOf("##")>-1){recordLockedIcons("")}else{recordUnlockedIcons()}}else{if(recordLock=="Implicit"){getRecordLockedValue("recordLock")}}}else{enableRecordReadModeMsg(isRecordLock)}}isSAVE=false}}else{if(r!=undefined&&r!=null){r.setDisabled(true)}}if(d!=undefined&&d!=null){d.setDisabled(true)}if(g!=undefined&&g!=null){g.setDisabled(false)}}else{disableAllrecordLockIcons();if(n!=undefined&&n!=null){n.setDisabled(true)}if(f!=undefined&&f!=null){f.setDisabled(true)}if(p!=undefined&&p!=null){p.setDisabled(true)}if(h!=undefined&&h!=null){h.setDisabled(true)}if(r!=undefined&&r!=null){r.setDisabled(true)}if(_ServerVariables.ObjectMetadata.isUpdateable){if(d!=undefined&&d!=null){d.setDisabled(false)}}else{Ext.getCmp("saveId").setDisabled(true)}if(g!=undefined&&g!=null){g.setDisabled(true)}}if(m!=undefined&&m!=null){m.setDisabled(false)}if(t!=undefined&&t!=null){t.setDisabled(false)}if(s!=undefined&&s!=null){s.setDisabled(false)}if(l!=undefined&&l!=null){l.setDisabled(false)}if(i!=undefined&&i!=null){i.setDisabled(false)}if(a!=undefined&&a!=null){a.setDisabled(false)}if(j!=undefined&&j!=null){j.setDisabled(false)}if(q!=undefined&&q!=null){q.setDisabled(false)}if(ChangeServiceTargetButtonState!=undefined&&ChangeServiceTargetButtonState!=null){ChangeServiceTargetButtonState(ServiceTargetStatus)}refreshChangeListTimeOut();refreshChangeRelatedListTimeOut();if(_ServerVariables.ObjectMetadata.isCreateable){if(e!=undefined&&e!=null){e.setDisabled(false)}}else{if(e!=undefined&&e!=null){e.setDisabled(true)}}}stopWaitMsgBar()}function refreshChangeRelatedListTimeOut(){if(isNeedToRefreshRelatedList){var a=isFocusOnFormTab();setTimeout(function(){isNeedToRefreshRelatedList=false;isChangeRelatedListFrameLoaded=false;var b=document.getElementById("changeRelatedListFrameId");b.src="/apex/consoleChangeRelatedList?id="+recordId+"&isdtp=vw&obj=Change_Request__c";addOnLoadEvent(b,afterChangeRelatedListFrameLoad);if(isActivityFeedEnabled==true&&recordId){loadContentsInActivityFeed(a)}if(isCISidebarEnabled==true&&recordId){loadContentsInRelatedCIs(a)}},2000)}}function refreshChangeListTimeOut(){if(isNeedToRefreshChangeList&&isServiceCloudConsole!="true"){isNeedToRefreshChangeList=false;if(isRFConsoleDetailForm=="true"&&typeof(window.parent)!="undefined"&&typeof(window.parent)!=undefined){setTimeout(function(){window.parent.refreshListView("Change_Request__c")},2000)}else{setTimeout(function(){doRefresh()},2000)}}}function getChangeData(a){recordId=a.Id;changeName=a.Name;recordState=a.state__c;broadcast=a.FKBroadcast__c;categoryId=a.FKCategory__c;status=a.Stage__c;desc=a.changeDescription__c;if(desc!=null&&desc!=""&&desc.length>500){desc=desc.substring(0,500)}ServiceTargetStatus=a.ServiceTargetStatus;isRecordLock=a.isRecordLock}function removeChangeData(){recordId=null;changeName=ChangeConsolePage.Labels.New;recordState="";broadcast="";categoryId="";status="";ServiceTargetStatus=""}function ChangeServiceTargetButtonState(a){var c=Ext.getCmp("servicetargets");var b=Ext.getCmp("ServiceTargetsButtonId");if(typeof(b!="undefined")&&b!=null){if(a==""){b.setDisabled(true)}else{b.setDisabled(false)}}if(typeof(c!="undefined")&&c!=null){if(a==""){c.disable()}else{c.enable()}}}function changeServiceTargetIcons(b,a){b.replaceCls("serviceTargetsEmpty","serviceTargetsDisable");b.replaceCls("serviceTargetsEnable","serviceTargetsDisable");b.replaceCls("serviceTargetsWarning","serviceTargetsDisable");b.replaceCls("serviceTargetsMissed","serviceTargetsDisable");if(a==ChangeConsolePage.Labels.ServiceTargetsOK){b.replaceCls("serviceTargetsDisable","serviceTargetsEnable")}else{if(a==ChangeConsolePage.Labels.ServiceTargetsMissed){b.replaceCls("serviceTargetsDisable","serviceTargetsMissed")}else{if(a==ChangeConsolePage.Labels.ServiceTargetsWarning){b.replaceCls("serviceTargetsDisable","serviceTargetsWarning")}}}if(isNewChangeForm){b.replaceCls("serviceTargetsDisable","serviceTargetsEmpty")}else{b.dom.title=ChangeConsolePage.Labels.ServiceTargets}}function handleServiceTargets(){screenHeight=400;screenWidth=1087;var a="FKChangeRequest__c='"+recordId+"'";if(!ServiceTargetsBtnHandlerWindow||ServiceTargetsBtnHandlerWindow.closed){ServiceTargetsBtnHandlerWindow=window.open("/apex/SearchPage?popupId=ChangeRequestServiceTarget&isLookup=true&filterClause="+escape(a)+"&standardLayout=true&iscalledFromConsole=true&popupFor=ServiceTargets&popupHeader="+changeName,"ServiceTarget","status = 1,height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=no")}if(ServiceTargetsBtnHandlerWindow.focus){ServiceTargetsBtnHandlerWindow.focus()}}function startWaitMsgBar(){if(waitMsgBar!=""){waitMsgBar.setVisible(true)}}function setIsNeedToRefreshRelatedList(a){isNeedToRefreshRelatedList=a}function stopWaitMsgBar(){if(waitMsgBar!=""&&waitMsgBar.isVisible()){waitMsgBar.setVisible(false)}}function disableDetailFormButtons(){Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("refreshId").setDisabled(true);Ext.getCmp("changeReleatedListBtnId").setDisabled(true);Ext.getCmp("ChangeFormBtnId").setDisabled(true);Ext.getCmp("SmartViewBtnId").setDisabled(true);Ext.getCmp("agentToolsBtnId").setDisabled(true);Ext.getCmp("actionButton").setDisabled(true)}function ChangeReqConsolePageinReadMode(){Ext.getCmp("saveId").setDisabled(true);if(Ext.getCmp("closeButtonId")!=undefined&&Ext.getCmp("closeButtonId")!=null){Ext.getCmp("closeButtonId").setDisabled(true)}if(Ext.getCmp("reopenButtonId")!=undefined&&Ext.getCmp("reopenButtonId")!=null){Ext.getCmp("reopenButtonId").setDisabled(true)}if(Ext.getCmp("respondedButtonId")!=undefined&&Ext.getCmp("respondedButtonId")!=null){Ext.getCmp("respondedButtonId").setDisabled(true)}if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(true)}}function RTFEnabledPage(){if(isRTFEnabledChangePage=="true"){return true}else{if(isServiceCloudConsole!="true"&&isRFConsoleDetailForm&&window.parent.MultiPageLayout&&window.parent.MultiPageLayout.isEnabledForCR){var a=getLayoutKey();if(isRTFEnabledChangePage.indexOf(a+",")>-1){return true}else{return false}}else{return false}}}function getLayoutKey(){var a="";if(formLayoutId&&formLayoutId.indexOf(NONPRINT)>-1){var b=formLayoutId.split(NONPRINT);if(b.length>1){a=b[0];return a}}if(window.parent.MultiPageLayout&&window.parent.MultiPageLayout.defaultLayoutCR){a=window.parent.MultiPageLayout.defaultLayoutCR}return a}function afterSaveSucceed(){if(!isDeleted){previousFormLayoutId=formLayoutId;isNeedToRefreshChangeList=true;isNeedToRefreshRelatedList=true;addOptionalToolbarItems();afterChangeDetailFrameLoad()}else{isNeedToRefreshChangeList=true;refreshChangeListTimeOut()}if(isActivityFeedEnabled==true){displayActivityFeed=true}if(isCISidebarEnabled==true){displayCISidebar=true}Ext.getCmp("SmartViewBtnId").setDisabled(false);clickedOnce=false;layoutTypeClickedOnce=false;isLayoutChanged=false;if(isServiceCloudConsole=="true"){sforce.console.setTabUnsavedChanges(false)}Ext.getCmp("helpIconSeparator").show();Ext.getCmp("detailViewToolbarId").doLayout()}function hideMenu(){var b=Ext.getCmp("mainMenu");if(b!="undefined"&&b!=null&&b!=""){Ext.getCmp("mainMenu").hide()}var a=Ext.getCmp("AgentToolsMenu");if(a!="undefined"&&a!=null&&a!=""){Ext.getCmp("AgentToolsMenu").hide()}var c=Ext.getCmp("pageLayoutMenuItems");if(typeof(c)!="undefined"&&c){Ext.getCmp("pageLayoutMenuItems").hide()}}function disableAgentMenuItems(a){if(Ext.getCmp("knowledgeSearchButtonId")!=undefined&&Ext.getCmp("knowledgeSearchButtonId")!=null){Ext.getCmp("knowledgeSearchButtonId").setDisabled(a)}if(Ext.getCmp("createKnowledgeArticleButtonId")!=undefined&&Ext.getCmp("createKnowledgeArticleButtonId")!=null){Ext.getCmp("createKnowledgeArticleButtonId").setDisabled(a)}if(Ext.getCmp("CiExplorerButtonId")!=undefined&&Ext.getCmp("CiExplorerButtonId")!=null){Ext.getCmp("CiExplorerButtonId").setDisabled(a)}if(Ext.getCmp("ServiceTargetsButtonId")!=undefined&&Ext.getCmp("ServiceTargetsButtonId")!=null){Ext.getCmp("ServiceTargetsButtonId").setDisabled(a)}if(Ext.getCmp("ChangeManifestButtonId")!=undefined&&Ext.getCmp("ChangeManifestButtonId")!=null){Ext.getCmp("ChangeManifestButtonId").setDisabled(a)}if(Ext.getCmp("ChangeScheduleId")!=undefined&&Ext.getCmp("ChangeScheduleId")!=null){Ext.getCmp("ChangeScheduleId").setDisabled(a)}if(Ext.getCmp("ImpactAnalysisId")!=undefined&&Ext.getCmp("ImpactAnalysisId")!=null){Ext.getCmp("ImpactAnalysisId").setDisabled(a)}if(Ext.getCmp("ChangeCollisionId")!=undefined&&Ext.getCmp("ChangeCollisionId")!=null){Ext.getCmp("ChangeCollisionId").setDisabled(a)}}function disableActionMenuItems(a){if(Ext.getCmp("cloneButtonId")!=undefined&&Ext.getCmp("cloneButtonId")!=null){Ext.getCmp("cloneButtonId").setDisabled(a)}if(Ext.getCmp("closeButtonId")!=undefined&&Ext.getCmp("closeButtonId")!=null){Ext.getCmp("closeButtonId").setDisabled(a)}if(Ext.getCmp("reopenButtonId")!=undefined&&Ext.getCmp("reopenButtonId")!=null){Ext.getCmp("reopenButtonId").setDisabled(a)}if(Ext.getCmp("respondedButtonId")!=undefined&&Ext.getCmp("respondedButtonId")!=null){Ext.getCmp("respondedButtonId").setDisabled(a)}if(Ext.getCmp("addNoteId")!=undefined&&Ext.getCmp("addNoteId")!=null){Ext.getCmp("addNoteId").setDisabled(a)}if(Ext.getCmp("emailId")!=undefined&&Ext.getCmp("emailId")!=null){Ext.getCmp("emailId").setDisabled(a)}if(Ext.getCmp("printId")!=undefined&&Ext.getCmp("printId")!=null){Ext.getCmp("printId").setDisabled(a)}if(Ext.getCmp("printPDFId")!=undefined&&Ext.getCmp("printPDFId")!=null){Ext.getCmp("printPDFId").setDisabled(a)}if(Ext.getCmp("newActionId")!=undefined&&Ext.getCmp("newActionId")!=null){Ext.getCmp("newActionId").setDisabled(a)}if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(a)}}function refreshRelatedLists(){isNeedToRefreshRelatedList=true;refreshChangeRelatedListTimeOut()}function setTabUnsavedChanges(){if(isServiceCloudConsole=="true"){sforce.console.setTabUnsavedChanges(true)}}document.onkeydown=function(g){var c,a,d;d=0;if(isRFConsoleDetailForm=="true"){c=window.parent;d=window.parent.count}a=window.self;var f=document.getElementById("changeDetailsFrameId");var b="";if(f.src==""){b="ListViewNewButton"}else{if((typeof(f)!="undefined"&&f!=null)&&f.src!=""){b="newId"}}if(!window.isRFHotkeysDisabled){handleShortcuts(g,c,a,d,isRFConsoleDetailForm,b)}};function addSConsoleTab(c,b){try{SconsoletabName=b;sforce.console.openPrimaryTab(null,c,true," ",addSConsoleTabComplete)}catch(a){}}function addSConsoleTabComplete(a){try{var c=new Date();c.setYear(c.getFullYear()+10);if(a.success==true){document.cookie="SconsoletabName="+a.id+";path=/;SameSite=None;Secure;expires="+c.toUTCString()}else{if(Ext.util.Cookies.get(SconsoletabName)!=null){sforce.console.focusPrimaryTabById(Ext.util.Cookies.get(SconsoletabName))}}}catch(b){}}function refreshChange(){if(isFocusOnChangeForm){loadChangeDetail(recordId);isNeedToRefreshRelatedList=true}else{loadChangeRelatedList(recordId);isNeedToRefreshChange=true;refreshChangeFormTimeOut()}}function refreshChangeFormTimeOut(){if(isNeedToRefreshChange){var a=isFocusOnFormTab();setTimeout(function(){isNeedToRefreshChange=false;var b=document.getElementById("changeDetailsFrameId");b.src="/apex/ConsoleChangeDetail?id="+recordId;if(isActivityFeedEnabled==true){loadContentsInActivityFeed(a)}},2000)}}function enableCustomActions(){var b=Ext.getCmp("mainMenu").items;if(b!="undefined"&&b!=null&&b!=""){for(var d=0;d<b.length;d++){var a=b.items[d];if(a.id!="undefined"&&a.openIn!="undefined"&&typeof(a.openIn)!="undefined"){Ext.getCmp(a.id).setDisabled(false)}}}var c=Ext.getCmp("AgentToolsMenu").items;if(c!="undefined"&&c!=null&&c!=""){for(var d=0;d<c.length;d++){var a=c.items[d];if(a.id!="undefined"&&a.openIn!="undefined"&&typeof(a.openIn)!="undefined"){Ext.getCmp(a.id).setDisabled(false)}}}}function showCollisionMessage(){functionArray[2]()}function loadChangeschPage(a){var f=650;var c=1100;var d=(screen.width-c)/2;var b=parseInt((screen.height/2)-(f/2))-50;var e=window.open("/apex/ChangeSchedule?"+a,"viewChangeschedule","status = 1,height ="+f+",width ="+c+",left="+d+",top="+b+", resizable = 1,scrollbars=no");if(e.focus){e.focus()}}function loadContentsInActivityFeed(a){if(isCalledFromActivityFeed!=true){activityFeedRefreshStarted();var b=document.getElementById("changeSmartViewSidebarFrameId");if(typeof b!="undefined"&&b!=null){b.src="/apex/DeepView?id="+recordId+"&showSidebarOnly=true&moduleName=Change_Request__c"}}isCalledFromActivityFeed=false;if(a){enableActivityFeed()}}function loadContentsInRelatedCIs(a){if(isBaseElementAccessible==true&&isServicesAndCISliderEnabled==true){RelatedCIRefreshStarted();var b=document.getElementById("relatedCISmartViewSidebarFrameId");if(typeof b!="undefined"&&b!=null){b.src="/apex/CIAssetSlideIn?id="+recordId+"&objName=Change_Request__c"}if(a){enableRelatedCI()}}}function addOptionalToolbarItems(){if(!isOptionalItemsAdded){var a=Ext.getCmp("detailViewToolbarId");var b=0;a.insert(++b,{xtype:"label",id:"ChangeStatusId",cls:"recordStage",text:status,width:"auto"});a.insert(++b,{xtype:"tbspacer",width:5});a.insert(++b,"-");a.insert(++b,{xtype:"label",autoEl:{tag:"label",width:"25px",title:(recordId==null||recordId==""||recordId=="new")?"":ChangeConsolePage.Labels.ServiceTargets},cls:"serviceTargetsEmpty",border:false,id:"servicetargets",disabled:(ServiceTargetStatus==""),listeners:{disable:function(d){changeServiceTargetIcons(d.getEl(),ServiceTargetStatus)},enable:function(d){changeServiceTargetIcons(d.getEl(),ServiceTargetStatus)},render:function(d){d.getEl().on({click:function(c){if(ServiceTargetStatus!=""){handleServiceTargets()}},scope:d})}}});a.insert(++b,"-");a.insert(++b,{xtype:"tbspacer",width:5});isOptionalItemsAdded=true}}function loadContentsInSmartViews(){var a=document.getElementById("changeSmartViewFrameId");if(typeof((a)!="undefined"&&a.src=="")||isNeedToRefreshSmartView==true){startWaitMsgBar();loadChangeSmartView(recordId)}else{showDiv(a)}stopWaitMsgBar()}function addOnLoadEvent(b,a){if(b.addEventListener){b.addEventListener("load",a)}else{if(b.attachEvent){b.attachEvent("onload",a)}}}function changeLayout(a,b){startWaitMsgBar();formLayoutId=a;if(b){templateId=b}isLayoutChanged=true;loadChangeDetail(recordId)};