window.addEventListener("load",function(){initToolbar()});function initToolbar(){var a=getCookie("benchmarks_checkbox");var b=getCookie("benchmarks_radio");if(a!=null&&a=="true"){document.getElementById("drillDownCheckbox").checked=true;if(b!=null&&b=="CompanySizeBenchmark"){activateRadio("CompanySizeBenchmark");getBenchmarks("CompanySizeBenchmark")}else{activateRadio("IndustryBenchmark");getBenchmarks("IndustryBenchmark")}}else{enableRadios(false);if(b!=null&&b=="CompanySizeBenchmark"){activateRadio("CompanySizeBenchmark")}else{activateRadio("IndustryBenchmark")}loadGraphs()}}function clearNotification(){var a=document.getElementById("errorMessages");var c=a.lastElementChild;while(c){a.removeChild(c);c=a.lastElementChild}var b=document.getElementById("msgDiv");b.style.display="none"}function loadGraphs(){clearNotification();if(KPIBenchmarksDisabledDuration==undefined||KPIBenchmarksDisabledDuration==null){KPIBenchmarksDisabledDuration=0}MTTRSeries=convertJsonStringToObject(MTTRSeriesJsonString);MTTRBenchmarkSeries=convertJsonStringToObject(MTTRBenchmarkSeriesJsonString);FCRSeries=convertJsonStringToObject(FCRSeriesJsonString);FCRBenchmarkSeries=convertJsonStringToObject(FCRRBenchmarkSeriesJsonString);SLAPercentSeries=convertJsonStringToObject(SLAPercentSeriesJsonString);SLAPercentBenchmarkSeries=convertJsonStringToObject(SLAPercentBenchmarkSeriesJsonString);xAxis=convertJsonStringToObject(XAxisJsonString);drawGraph(xAxis,MTTRBenchmarkSeries,MTTRSeries,_Labels.KPI_MTTRTitle,"MTTR","#328DEE"," "+_Labels.BusinessDaysUnit);drawGraph(xAxis,FCRBenchmarkSeries,FCRSeries,_Labels.KPI_FCRTitle,"FCR","#328DEE","%");drawGraph(xAxis,SLAPercentBenchmarkSeries,SLAPercentSeries,_Labels.KPI_SLAAchievementTitle,"SLAPercent","#328DEE","%");if(isDashDown||!isKPIDataAvailable||contactSupport){var a=document.getElementById("errorMessages");var c;if(contactSupport){c=document.createElement("div");c.appendChild(document.createTextNode(_Labels.ContactSupport));a.appendChild(c)}else{if(isDashDown){c=document.createElement("div");c.appendChild(document.createTextNode(_Labels.DashDownError));a.appendChild(c)}}if(!isKPIDataAvailable){c=document.createElement("div");c.appendChild(document.createTextNode(_Labels.CustomerDataNotAvailable));a.appendChild(c)}var b=document.getElementById("msgDiv");b.style.display="block"}hs.graphicsDir=highslideGraphicsPath;hs.showCredits=false;if(KPI_CALCULATION_INPROGRESS||KPIS_MISSING_MONTHS>0){showNotification()}}function convertJsonStringToObject(a){var b;if(a!=undefined&&a!=null&&a!=""){b=JSON.parse(a)}return b}function drawGraph(b,g,c,f,a,e,d){Highcharts.chart(a,{credits:{enabled:false},title:{text:f,style:{color:"#000000",fontFamily:"Salesforce Sans,Arial,sans-serif",fontWeight:"bold",fontSize:"13px"}},subtitle:{text:null},xAxis:{categories:b,gridLineWidth:1,labels:{step:3}},yAxis:[{title:{text:null},labels:{format:"{value:.,0f}"},showFirstLabel:false,tickPixelInterval:35.5},{opposite:true,title:{text:null},labels:{align:"right",x:-3,y:16,format:"{value:.,0f}"},showFirstLabel:false,tickPixelInterval:35.5}],legend:{align:"left",verticalAlign:"bottom",borderWidth:0,symbolHeight:50,symbolPadding:20,symbolWidth:35,itemStyle:{fontWeight:"normal"}},tooltip:{shared:false,crosshairs:true,useHTML:true,borderRadius:0,backgroundColor:"white",style:{opacity:1,zIndex:"9999 !important"},shadow:false,formatter:function(){var k="";var q='<table style="border:none;font-family: Salesforce Sans,Arial,sans-serif;">';var h=0;var j=this.series.chart.series.length;var r,o,p,s;for(h=0;h<j;h++){o=this.series.chart.series[h];r=o.name;if(r!=_Labels.YourConfiguration){r=_Labels.Benchmarks}var m=0;if(k==""){k=this.point.Month}for(var l=0;l<this.series.chart.series[h].data.length;l++){s=this.series.chart.series[h].data[l];if(s.Month==this.point.Month){if(this.series.name!=_Labels.Benchmarks&&typeof s.incCount!="undefined"){p=s.incCount}if(typeof s.y!="undefined"){m=s.y}break}}q+='<tr><td class="tooltipTd"><span style="color:'+o.color+'">\u25CF</span> '+r+':</td><td class="tooltipTd"><b>'+m+"</b>"+d+"</td></tr>"}q=q+"</table>";if(p!=undefined){q=q+'<hr class="hrSeparator" /><span style="font-family: Salesforce Sans,Arial,sans-serif;">'+_Labels.ClosedRecords+": <b>"+p+"</b></span>"}var n='<span style="font-family: Salesforce Sans,Arial,sans-serif;"><b>'+k+"</b></span>";return n+'<hr class="hrSeparator"/>'+q}},plotOptions:{series:{cursor:"pointer",point:{events:{click:function(h){hs.htmlExpand(null,{pageOrigin:{x:h.pageX||h.clientX,y:h.pageY||h.clientY},outlineType:null,maincontentText:generateInsights(this),width:435})}}},marker:{lineWidth:1,radius:5}}},series:[{name:_Labels.YourConfiguration,data:c,color:e,animation:{duration:3000,},marker:{symbol:"circle"},zIndex:2},{name:_Labels.Benchmarks,data:g,color:"#F86E00",animation:{duration:1500,},marker:{symbol:"circle"},zIndex:1}]})}function generateInsights(a){var b="";b=b+'<div class="insights_wrapper">';b=b+'<div class="insights_header"><div class="highslide-move insight_headertext">'+_Labels.Insights+" ("+a.Month+')</div><div class="close_button" onclick="hs.close()"><span class="d-icon-cross clickable_cursor"></span></div></div>';b=b+'<div class="insights_body">';b=b+"<table>";b=b+'<tr><th></th><th class="insights_columnHeaders">'+_Labels.YourConfiguration+'</th><th class="insights_columnHeaders">'+_Labels.Benchmarks+"</th></tr>";var d;if(a.insights.BenchMarks!=undefined){d=a.insights.BenchMarks}else{d=a.insights.KPIValue}if(a.incCount!=undefined){b=b+'<div class="insight_footer">'+_Labels.ClosedRecords+": <b>"+a.incCount+"</b></div>"}for(var c in d){b=b+'<tr><td class="insight_label">'+c+"</td>";var f="-",e="center_align",g="-";if(a.insights.KPIValue!=undefined&&a.insights.KPIValue[c]!=null){f=a.insights.KPIValue[c];if(a.insights.BenchMarks!=undefined&&a.insights.BenchMarks[c]!=null){e=e+" "+getCssClassForInsights(a.insights.KEYS[c],a.insights.KPIValue[c],a.insights.BenchMarks[c])}}if(a.insights.BenchMarks!=undefined&&a.insights.BenchMarks[c]!=null){g=a.insights.BenchMarks[c]}b=b+'<td class="'+e+'">'+f+'</td><td class="center_align">'+g+"</td></tr>"}b=b+"</table>";b=b+'<a target="_blank" class="insight_valueAdoptionLink" href="#" onclick="LaunchValueAdoption();return false;">'+_Labels.ValueAdoptionLinkLabel+"</a>";b=b+"</div></div>";return b}function getCssClassForInsights(d,a,f){var e=Number(a);var c=Number(f);var b=new Array("SSADOPTION","CHATADOPTION","RESPONSETARGET","KA");if(b.indexOf(d)>-1){if(e>=c){return"insight_positive"}else{return"insight_negative"}}else{if(e<=c){return"insight_positive"}else{return"insight_negative"}}}function showNotification(){var a;if(!KPI_CALCULATION_INPROGRESS){a=document.createElement("div");a.setAttribute("id","notificationWrapper");var e=document.createElement("div");a.setAttribute("id","notificationMsgWrapper");e.appendChild(document.createTextNode(_Labels.fallBackNotification));var c=document.createElement("button");c.appendChild(document.createTextNode(_Labels.start));c.setAttribute("onclick","startKPIProcessing();return false;");c.setAttribute("class","notification_button");e.appendChild(c);a.appendChild(e);var b=document.getElementById("errorMessages");b.appendChild(a)}else{showCalculationInProgress()}var d=document.getElementById("msgDiv");d.style.display="block"}function showCalculationInProgress(){var a=document.createElement("div");a.setAttribute("id","notificationWrapper");a.appendChild(document.createTextNode(_Labels.KPICalculationInProgress));var b=document.getElementById("errorMessages");b.appendChild(a)}function startKPIProcessing(){showLoadingMask(true);Visualforce.remoting.Manager.invokeAction(_Remoting.calculateMissingKPIs,KPIS_MISSING_MONTHS,function(a,b){showLoadingMask(false);if(b.status){var c=document.getElementById("notificationMsgWrapper");c.parentNode.removeChild(c);showCalculationInProgress()}else{}})}function openHelp(){if(helpUrl){window.open(helpUrl,false,"width="+screen.width+",height="+screen.height+",resizable = 1,scrollbars=yes,status=1,top=0,left=0",false)}}function showLoadingMask(a){if(a){document.getElementById("loaderDiv").style.display="block";document.getElementById("maskDiv").style.display="block"}else{document.getElementById("loaderDiv").style.display="none";document.getElementById("maskDiv").style.display="none"}}function checkBoxClick(a){if(a){toggleCheckBoxFn()}if(isCheckBoxChecked()){setCookie("benchmarks_checkbox","true");enableRadios(true);if(isRadioActive("CompanySizeBenchmark")){getBenchmarks("CompanySizeBenchmark")}else{getBenchmarks("IndustryBenchmark");activateRadio("IndustryBenchmark")}}else{setCookie("benchmarks_checkbox","false");enableRadios(false);getBenchmarks("GlobalBenchmark")}}function isCheckBoxChecked(){var a=document.getElementById("drillDownCheckbox");if(a&&a.checked){return true}else{return false}}function toggleCheckBoxFn(){var a=document.getElementById("drillDownCheckbox");if(a&&a.checked){a.checked=false}else{a.checked=true}}function radioClick(a){setCookie("benchmarks_radio",a);if(isCheckBoxChecked()){activateRadio(a,true);getBenchmarks(a)}}function activateRadio(a){var d=document.getElementById("IndustryBenchmark");var c=document.getElementById("CompanySizeBenchmark");if(d){d.firstElementChild.className="emptyCheckbox emptyCheckbox-svg"}if(c){c.firstElementChild.className="emptyCheckbox emptyCheckbox-svg"}var b=document.getElementById(a);if(b){b.firstElementChild.className="fillCheckBox fillCheckBox-svg"}}function isRadioActive(a){var b=document.getElementById(a);if(b&&b.firstElementChild.className.indexOf("fillCheckBox")>-1){return true}else{return false}}function enableRadios(a){var c=document.getElementById("IndustryBenchmark");var b=document.getElementById("CompanySizeBenchmark");if(c&&b){if(a){c.classList.remove("disabled");b.classList.remove("disabled")}else{c.classList.add("disabled");b.classList.add("disabled")}}}function getBenchmarks(a){showLoadingMask(true);closeAllInsights();console.log("benchmarkType::"+a);if(a=="GlobalBenchmark"){generateData("0")}else{if(a=="IndustryBenchmark"){generateData("1")}else{if(a=="CompanySizeBenchmark"){generateData("2")}}}}function LaunchValueAdoption(){if(parent.popupReadinessWindow){parent.popupReadinessWindow()}}function setCookie(a,b){document.cookie=a+"="+b+";SameSite=None;Secure"}function getCookie(a){var b=new RegExp(a+"=([^;]+)");var c=b.exec(document.cookie);return(c!=null)?unescape(c[1]):null}function closeAllInsights(){if(hs.expanders){for(var a=0;a<hs.expanders.length;a++){var b=hs.expanders[a];if(b){b.close()}}}};