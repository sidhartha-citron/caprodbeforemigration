document.onkeydown=clearCookieOnf5key;function clearCookieOnf5key(a){a=a||window.event;if(typeof(currentPage)!="undefined"&&currentPage=="ChangeSchedule"&&a.keyCode==116&&typeof(parentWindow)!="undefined"&&parentWindow!=null&&parentWindow!=""){a.preventDefault();deleteCookies()}}if(typeof(SDEDateFormat)=="undefined"||SDEDateFormat==null||SDEDateFormat==""){SDEDateFormat="m/d/Y h:i A"}if(typeof(SDETimeFormat)=="undefined"||SDETimeFormat==null||SDETimeFormat==""){SDETimeFormat="h:i A"}Date.useStrict=true;var ShowChangeNumberOrTypeValue={number:"number",type:"type"};var ShowReleaseNumberOrTypeValue={number:"number",type:"type"};var ViewComboValues={day12:"DayView12",day24:"DayView24",week:"WeekView",month:"MonthView"};var pageRefreshed=true;var linkedToVal="[]";var isFilterApplidCookie="";Ext.onReady(function(){isFilterApplidCookie=Ext.util.Cookies.get("apex__isFilterApplied");if(isFilterApplidCookie&&isFilterApplidCookie.length==2){isFilterApplidCookie=isFilterApplidCookie.replace('""',"")}if(isFilterApplidCookie!=null&&isFilterApplidCookie==""){document.cookie=changeLabel+loggedInuserId+"=;path=/;SameSite=None;Secure";document.cookie=releaseLabel+loggedInuserId+"=;path=/;SameSite=None;Secure";document.cookie="tempReleaseCookie"+loggedInuserId+"cs=;path=/;SameSite=None;Secure";document.cookie="tempRequestCookie"+loggedInuserId+"cs=;path=/;SameSite=None;Secure"}if(typeof(currentPage)!="undefined"&&currentPage!=null&&currentPage!="ChangeScheduleSettings"){setTimeOptionData();ObsInstance=new CalendarObservable();console.log("adding obs-instance event handlers");ObsInstance.on(CalendarEvents.VIEW_UPDATED,logObservable);ObsInstance.on(CalendarEvents.VIEW_UPDATED,updateCalendar);var j=generateLegendBar();var i=getCenterPanel();var a=getWestPanel();var k=loadFromServer();if(typeof(k)!="undefined"&&k!=null){syncDates(k.DrawerDatePicker);document.getElementById("StartTime").value=k.DrawerStartTimeField;if(k.DrawerChangeGroup==ShowChangeNumberOrTypeValue.type){document.getElementById("cmbChange").value="Type"}else{document.getElementById("cmbChange").value="Number"}if(k.DrawerReleaseGroup==ShowReleaseNumberOrTypeValue.type){document.getElementById("cmbRelease").value="Type"}else{document.getElementById("cmbRelease").value="Number"}if(k.DrawerChangeGroup=="undefined"){document.getElementById("chkChange").checked=""}if(k.DrawerReleaseGroup=="undefined"){document.getElementById("chkRelease").checked=""}document.getElementById("ViewType").value=k.DrawerViewCombo}var b=new Ext.Panel({layout:"border",stateful:false,items:[a,i],tbar:generateToolbar(),height:controlHeight});b.render("contentDiv");document.getElementById("timelineId").title=Labels.lblTimeline;document.getElementById("tableId").title=Labels.lblTable;var d=getCalendarHTML();document.getElementById("CalendarPanel").firstChild.firstChild.appendChild(d);var h=getTaskCalendarHTML();document.getElementById("taskCalendarPanel").firstChild.firstChild.appendChild(h);ObsInstance.updateView();Ext.QuickTips.init();ChangeCalendar();var f=Ext.urlDecode(window.location.href);if(f.SlideOutWest=="true"){b.layout.west.animFloat=false;b.layout.west.slideOut();b.layout.west.animFloat=true}var e=Ext.get("drawerPanel-xcollapsed");if(e!=null){e.addListener("mouseover",function(){b.layout.west.slideOut()})}pageRefreshed=false;document.getElementById("cmbLinkedTo").selectedIndex=0;document.getElementById("cmbLinkedTo").parentNode.style.width="100px";renderTaskGrid();renderUnscheduleGrid();document.getElementById("schedulePage:taskPanel").style.display="none";if(typeof(isFilterApplied)!="undefined"&&isFilterApplied=="true"){Ext.getCmp("FilterBtn").setIconClass("Filter_Applied");var g=Ext.util.Cookies.get("FilterTooltip"+loggedInuserId+"cs");Ext.getCmp("FilterBtn").setTooltip(g)}}document.getElementById("noTaskRecord").style.display="block"});function applyFilter(b,a){if(b=="Release"){applyReleaseFilter(a)}else{applyChangeFilter(a)}}var gridData=[];function renderTaskGrid(){if(taskRecordFound){var b=new Ext.data.ArrayStore({fields:[{name:Labels.lblTask+" #"},{name:Labels.lblType},{name:Labels.lblCategory},{name:Labels.lblDescription},{name:Labels.lblStatus},{name:Labels.lblScheduledStart},{name:Labels.lblScheduledEnd}]});b.loadData(gridData);var a=new Ext.grid.ColumnModel({columns:[{id:"taskName",header:Labels.lblTask+" #",width:150},{id:"taskType",header:Labels.lblType,width:100},{id:"taskCategory",header:Labels.lblCategory,width:120},{id:"taskDescription",header:Labels.lblDescription,width:200},{id:"taskStatus",header:Labels.lblStatus,width:80},{id:"taskStartDate",header:Labels.lblScheduledStart,width:120},{id:"taskEndDate",header:Labels.lblScheduledEnd,width:120}],defaults:{sortable:false,menuDisabled:true,width:100}});grid=new Ext.grid.GridPanel({id:"grid",autoWidth:true,border:true,store:b,autoscroll:"auto",height:"100px",autoHeight:false,cm:a,height:148,layout:"fit",stateful:true,stateId:"grid",enableColumnResize:true,enableColumnMove:false,viewConfig:{forceFit:true,scrollOffset:0},autoFitColumns:true});grid.render("schedulePage:taskPanel")}}function renderUnscheduleGrid(){if(!unScheduleTaskRecordFound){var e=new Ext.form.Label({name:"lblNoRecFnd",id:"lblNoRecFnd",style:"vertical-align: middle; text-align: center;",text:Labels.lblNoRecordsFound});var a=new Ext.Panel({height:152,bodyStyle:"padding-top:67px; padding-left:82px;",items:[e]});a.render("unscheduleDiv")}else{var d=new Ext.data.ArrayStore({fields:[{name:Labels.lblTask+" #"},{name:Labels.lblType},{name:Labels.lblDescription},{name:"Id"}]});d.loadData(unscheduleTask);var b=new Ext.grid.GridPanel({store:d,id:"taskDetail",columns:[{id:"TaskName",header:Labels.lblTask+" #",width:100,menuDisabled:true,renderer:function(k,h,g,l,j,i){if(k!=Labels.lblCreationPending){var f=d.getAt(l).get("Id");return'<a class="changeLink" onclick="openTaskForm(\''+f+"','"+k+"')\">"+k+"</a>"}else{return k}}},{id:"Type",header:Labels.lblType,width:90,menuDisabled:true},{id:"Description",header:Labels.lblDescription,width:85,menuDisabled:true}],stripeRows:true,autoHeight:true,bodyCssClass:"gridPanelMinHeight",layout:"fit",width:"auto",stateId:"grid1",title:Labels.tasks});b.render("unscheduleDiv")}}if(typeof(console)=="undefined"||console==null){console={log:function(b){}}}function logObservable(a){console.log("-date updated1--"+a.date);console.log("-start time updated1--"+a.startTime);console.log("-radio updated1--"+a.showChangeNumberOrType);console.log("-view type updated1--"+a.viewType)}function getCenterPanel(){var a=new Ext.Panel({layout:"border",border:false,style:"border:10px solid #005d9c;",region:"center",items:[getCalendarPanel(),generateTaskPanel()]});return a}function getCalendarPanel(){return(new Ext.Panel({layout:"fit",id:"CalendarPanel",autoScroll:"auto",region:"center",border:false}))}function getCalendarHTML(){var d,a;var b=document.createElement("table");b.cellPadding="0";b.cellSpacing="0";b.id="mainTable";b.name="mainTable";d=b.insertRow(0);a=d.insertCell(0);a.appendChild(GetMainHeader());d=b.insertRow(1);a.appendChild(GetCalendar());var e=document.createElement("div");e.id="destroyer";e.appendChild(b);return e}function collapsablePanelPluginInit(g,b,e,d,f){if(g.collapsible){var a="x-collapsed-header-text";if((g.region=="east")||(g.region=="west")){a+="-rotated"}g.on("render",function(){var h=g.ownerCt;h.on("afterlayout",function(){var k=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");var j=((g.region=="east")||(g.region=="west"));var i="";if(!(j&&k)){a="x-panel-header x-panel-header-rotated";b=e+"important;position: relative;";if(j){b+="white-space: nowrap; writing-mode: tb-rl;top:5px;"}else{b+="top: 1px;"}}else{if(!!navigator.userAgent.match(/Trident.*rv\:11\./)){b+="left:2px; writing-mode: tb-rl;"}else{b+="left:2px;"}i='<table><tr><td height="5"></td></tr></table>'}g.collapsedTitleEl=g.ownerCt.layout[g.region].getCollapsedEl().createChild({tag:"div",cls:a,html:i+'<div title="'+f+'" style="'+b+'" >'+d+"</div>"});g.setTitle=Ext.Panel.prototype.setTitle.createSequence(function(l){var m=g.collapsedTitleEl.dom;m=RemedyForceHTMLProcessor.clearHTML(m);m.appendChild(document.createTextNode(l))})},false,{single:true})})}}function getWestPanel(){Ext.override(Ext.DatePicker,{showPrevMonth:function(b){var f=this.activeDate.add("mo",-1);this.update(f);this.fireEvent("select",this,f)},showNextMonth:function(b){var f=this.activeDate.add("mo",1);this.update(f);this.fireEvent("select",this,f)},onMonthClick:function(h,f){h.stopEvent();var g=new Ext.Element(f),b;if(g.is("button.x-date-mp-cancel")){this.hideMonthPicker()}else{if(g.is("button.x-date-mp-ok")){var i=new Date(this.mpSelYear,this.mpSelMonth,(this.activeDate||this.value).getDate());if(i.getMonth()!=this.mpSelMonth){i=new Date(this.mpSelYear,this.mpSelMonth,1).getLastDateOfMonth()}window.status=i;this.update(i);this.hideMonthPicker();this.fireEvent("select",this,i)}else{if((b=g.up("td.x-date-mp-month",2))){this.mpMonths.removeClass("x-date-mp-sel");b.addClass("x-date-mp-sel");this.mpSelMonth=b.dom.xmonth}else{if((b=g.up("td.x-date-mp-year",2))){this.mpYears.removeClass("x-date-mp-sel");b.addClass("x-date-mp-sel");this.mpSelYear=b.dom.xyear}else{if(g.is("a.x-date-mp-prev")){this.updateMPYear(this.mpyear-10)}else{if(g.is("a.x-date-mp-next")){this.updateMPYear(this.mpyear+10)}}}}}}}});drawer_Datepicker=new Ext.DatePicker({listeners:{select:{fn:function(d,b){ObsInstance.updateDate(d,b)},scope:this},afterrender:{fn:function(b){b.todayBtn.on("click",GoToToday)},scope:this}}});var a=new Ext.Panel({width:210,id:"drawerPanel",region:"west",collapsible:true,split:false,collapsed:true,autoHide:(Ext.isIE||!!navigator.userAgent.match(/Trident.*rv\:11\./)||navigator.userAgent.toLowerCase().indexOf("firefox")>-1)?false:true,minSize:175,maxSize:400,margins:"0 0 0 0",cmargins:"0 0 0 0",plugins:{init:function(b){collapsablePanelPluginInit(b,"padding-left:0px;","",Labels.HeaderViews,Labels.HeaderViews);document.getElementById("drawerPanelContent").style.display="block"}},contentEl:"drawerPanelContent"});drawer_Datepicker.render("datePickerHolder");return a}var drawer_Datepicker=null;var drawer_RadioGroup=null;var drawer_StartTimeField=null;var drawer_ViewCombo=null;function generateToolbar(){var a=new Ext.Toolbar({border:false,height:40,margins:"0 0 0 0",autoWidth:true,items:[{scale:"medium",iconCls:"bmcRefreshCalendar",tooltipType:"title",tooltip:Labels.RefreshButtonTooltip,id:"refreshCalendarBtn",handler:RefreshButtonClick},{scale:"medium",iconCls:"bmcPrintCalendar",tooltipType:"title",tooltip:Labels.PrintButtonTooltip,id:"printCalendarBtn",handler:PrintButtonClick},{scale:"medium",iconCls:"bmcReportCalendar",tooltipType:"title",tooltip:Labels.lblReport,id:"reportCalendarBtn",handler:ReportButtonClick},{scale:"medium",iconCls:"settingson",tooltipType:"title",tooltip:Labels.lblSettings,handler:showSettings,hidden:!isAdminUser},{xtype:"tbfill"},{xtype:"textfield",fieldLabel:"Text",name:"textvalue",id:"searchField",emptyText:Labels.lblEmptySearchText,emptyClass:"x-form-empty-field",listeners:{specialkey:function(d,b){if(b.getKey()==b.ENTER){search()}}}},{scale:"medium",iconCls:"bmcSearchCalendar",tooltipType:"title",id:"searchCalendarBtn",tooltip:Labels.lblSearch,handler:search},{scale:"medium",iconCls:"Filter_Not_Applied",tooltipType:"title",tooltip:FilterLabel,id:"FilterBtn",style:{align:"left"},handler:checkAccessOnFilter},{scale:"medium",iconCls:"bmcResetCalendar",tooltipType:"title",tooltip:Labels.UndoBtnTooltip,id:"resetCalendarBtn",handler:reset},{xtype:"tbtext",html:'<img id="BarIcon" src="'+BarImgsrc+'"  />'},{xtype:"tbtext",html:'<img id="legendIcon" src="'+LegendImgSrc+'" onmouseover="showLegendTip(this);" />'}]});return a}var filterWindowOpened=false;var Xin,Yin;function openWindow(){filterWindowOpened=true;var b=document.getElementById("mainTable");if(typeof("MainPanel")!="undefined"&&b!=null){var d=b.getBoundingClientRect();Xin=d.right-625}else{Xin=735}Yin=50;var a="ChangeScheduleFilter";AdvancedFilterPopUp=new Ext.Window({width:635,height:Ext.isGecko?205:200,x:Xin,y:Yin,closable:false,shadow:false,header:false,id:"win",resizable:false,bodyStyle:"background-color:#FFFFFF;",constrain:true,viewConfig:{forceFit:true},frame:false,html:'<iframe frameborder="0" src ="/apex/'+a+'" style="width:100%;height:99%;border:1px solid #C4C0CE;margin: 0px 2px 0px 2px;"/>'});AdvancedFilterPopUp.show()}function showInfoMessage(){var a=Labels.lblFilterAccessMsg;Ext.MessageBox.show({msg:a,title:Labels.lblInformation,width:300,height:"auto",buttons:Ext.MessageBox.OK})}document.onclick=closePopUp;function closePopUp(a){a=a||window.event;a=a.target||a.srcElement;if(a.id!="BTNFilterBtn"){if(filterWindowOpened){AdvancedFilterPopUp.close();filterWindowOpened=false}}}Ext.EventManager.onWindowResize(function(){var b=document.getElementById("mainTable");var e=735;var a=50;if(typeof("MainPanel")!="undefined"&&b!=null){var d=b.getBoundingClientRect();e=d.right-625}if(AdvancedFilterPopUp!=undefined&&AdvancedFilterPopUp!=null&&filterWindowOpened){AdvancedFilterPopUp.setPosition(e,a,true)}});function setWinSize(){var a=Ext.getCmp("win").getHeight();a=a-130;Ext.getCmp("win").setHeight(a)}function resizeFilterWindow(a){if(a==0){var b=Ext.getCmp("win").getHeight();Ext.getCmp("win").setHeight(b+130)}else{var d=(a*20)+200;if(d<=368&&a!=1&&a<6){Ext.getCmp("win").setHeight(d)}if(a<=1){Ext.getCmp("win").setHeight(200)}}}var LegendToolTip=null;var legend_html="";function showLegendTip(a,b){if(LegendToolTip==null){var d=a;if(d==null){d=a.srcElement}LegendToolTip=new Ext.ToolTip({target:d.id,anchor:"bottom",shadow:false,autoWidth:true,autoHide:false,bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;overflow-y:auto;maxHeight:550px;",html:legend_html})}if(!Ext.isIE){LegendToolTip.targetXY=[a.pageX,a.pageY];LegendToolTip.show()}LegendToolTip.on("show",function(){var e;LegendToolTip.getEl().on("mouseout",function(){e=window.setTimeout(function(){LegendToolTip.hide()},500)});LegendToolTip.getEl().on("mouseover",function(){window.clearTimeout(e)});Ext.get(LegendToolTip.target).on("mouseover",function(){window.clearTimeout(e)});Ext.get(LegendToolTip.target).on("mouseout",function(){e=window.setTimeout(function(){LegendToolTip.hide()},500)})})}function generateLegendBar(){var b=getCalendarLegendData();var a=new Ext.XTemplate('<tpl for="codes">',"<tr>","<tpl if=\"values.text == '1'\">",'<td style="height:20px;width:40px;background-color:{code}">',"&nbsp;<s>{div_html}</s>","</td>","<td>&nbsp;</td>","<td>{title}</td>","</tpl>","<tpl if=\"values.text == '0'\">",'<td style="height:1px;" colspan="3">','<br /><div class="hrline"></div><br />',"</td>","</tpl>","<tpl if=\"values.text == '2'\">",'<td class="emergencyDeployRelease">',"&nbsp;<s>{div_html}</s>","</td>","<td>&nbsp;</td>","<td>{title}</td>","</tpl>","<tpl if=\"values.text == '3'\">",'<td class="minorDeployRelease">',"&nbsp;<s>{div_html}</s>","</td>","<td>&nbsp;</td>","<td>{title}</td>","</tpl>","<tpl if=\"values.text == '4'\">",'<td class="majorDeployRelease">',"&nbsp;<s>{div_html}</s>","</td>","<td>&nbsp;</td>","<td>{title}</td>","</tpl>","<tpl if=\"values.text == '5'\">",'<td class="deploymentRelease">',"&nbsp;<s>{div_html}</s>","</td>","<td>&nbsp;</td>","<td>{title}</td>","</tpl>","<tpl if=\"values.text == '6'\">",'<td class="closedDeploymentReleaseTooltip">',"&nbsp;<s>{div_html}</s>","</td>","<td>&nbsp;</td>","<td>{title}</td>","</tpl>","</tr>","</tpl>");legend_html="<table cellpadding='3' cellspacing='3'>"+a.apply(b)+"</table>"}var NONPRINT="ф";function generateTaskPanel(){var a=taskFilterCookie;var l=taskTypes.split(NONPRINT);a=a.split(NONPRINT);var b=new Array(l.length+l.length+1);var k=0,g=0;if(document.getElementById("taskFilterValue").value=="All"){document.getElementById("taskFilterValue").value=document.getElementById("taskFilterValue").value.replace("All","")}for(;k<l.length;k++,g++){var m=false;if(a!="All"){for(c=0;c<a.length;c++){if(l[k]==a[c]){m=true;document.getElementById("taskFilterValue").value=document.getElementById("taskFilterValue").value+l[k]+NONPRINT;break}}}else{m=true;document.getElementById("taskFilterValue").value=document.getElementById("taskFilterValue").value+l[k]+NONPRINT}b[g]={xtype:"checkbox",name:"ttype",group:"ttype",checked:m,iconCls:"emptyIcon",boxLabel:l[k]+" "+Labels.lblTasks,inputValue:l[k],handler:filterTasksHandler};g=g+1;b[g]=" "}b[g]={text:Labels.lblApply,iconCls:"mnuList",handler:doApply};var n=new Ext.form.Label({text:Labels.lblLinkedTo,margins:"20 0 0 0",width:100,tooltipType:"title",tooltip:Labels.lblLinkedTo,id:"lblLinkedTo"});linkComboStore=new Ext.data.JsonStore({id:"inputStore",data:combolinkedVal,fields:["id","name"]});var e="<select id='cmbLinkedTo' style='width:130px;' onchange='ViewTasks();'>";linkComboStore.each(function(i){e+="<option value='"+i.get("id")+"'>"+i.get("name")+"</option>"});e+="</select>";var h=new Ext.form.ComboBox({id:"cmbLinkedTo",fieldLabel:Labels.lblLinkedTo,margins:"0 0 0 0",store:linkComboStore,displayField:"name",valueField:"id",typeAhead:true,mode:"local",triggerAction:"all",editable:false,selectOnFocus:true,width:100,value:SelectedLinkedName});h.on("select",function(){ViewTasks()});var f=new Ext.Toolbar({border:false,height:35,margins:"0 0 0 0",autoWidth:true,items:[n,{html:"&nbsp;&nbsp;&nbsp;",xtype:"spacer"},h,{html:"&nbsp;",xtype:"spacer"},{xtype:"tbseparator"},{iconCls:"bmcView1",tooltip:Labels.HeaderViews,tooltipType:"title",id:"btnView",scale:"medium",menu:b},{xtype:"tbseparator"},{html:"&nbsp;",xtype:"spacer"},{scale:"medium",cls:"viewTimelineSelected",id:"timelineId",handleMouseEvents:false,handler:showTaskCalendar},{scale:"medium",cls:"viewTable",id:"tableId",handleMouseEvents:false,handler:showTaskTable}]});var d=new Ext.Panel({header:true,border:false,title:'<div title="'+Labels.lblHideTasks+'">'+Labels.lblTasks+"</div>",floatable:false,region:"south",layout:"border",collapsible:true,collapsed:true,height:200,defaults:{split:true},id:"mainTaskCalendar",items:[{id:"taskPanel",tbar:f,width:800,collapsible:false,autoScroll:true,region:"center",items:[getTaskCalendarPanel()],listeners:{resize:function(){refreshGrid()}},contentEl:"schedulePage:taskPanel"},{title:Labels.lblUnscheduledTasks,id:"unScheduleTasks",region:"east",autoScroll:true,collapsible:true,width:300,minWidth:300,maxWidth:300,contentEl:"unscheduleDiv",plugins:{init:function(i){var j="";if(Ext.isIE){j+="right:6px;"}else{j+="left:0px;"}collapsablePanelPluginInit(i,"padding-left:0px;color:#004376;",j,Ext.util.Format.ellipsis(Labels.lblUnscheduledTasks,22),Labels.lblUnscheduledTasks)}}}],plugins:{init:function(i){collapsablePanelPluginInit(i,"padding-left:0px;cursor:pointer;font-weight:bold;color:#FFF;","",Labels.lblTasks,Labels.lblTasks)}}});return d}function showSettings(){openPopupDialog("ChangeScheduleSettings","",ChangeColorCodeTitle,350,350);popUpWindow.center()}function openPopupDialog(e,g,d,h,f){if(d==null){d=""}if(h==null||h==""){h=1050}if(f==null||f==""){f=670}onCompleteFunction=g;var b=e.split("?");var a="background-color:#FFFFFF;";popUpWindow=new Ext.Window({height:h,width:f,title:d,bbar:{displayInfo:true,buttonAlign:"left",height:25,items:getBbarOptions()},x:10,y:5,modal:true,resizable:true,autoScroll:true,bodyStyle:a,constrain:true,viewConfig:{forceFit:true},html:'<iframe frameborder="0" src ="/apex/'+e+'" style="width:100%;height:100%;border:none"/>',});popUpWindow.show()}function getBbarOptions(){var a=new Array(2);a[0]={iconCls:"bbar-button",text:lblSave,tooltipType:"title",tooltip:Labels.lblSave,id:"btnsave",disabled:true,handler:callSave};a[1]={iconCls:"bbar-button",text:lblCancel,tooltipType:"title",tooltip:Labels.lblCancel,id:"btncancel",handler:callCancel};return a}function callSave(){createXMLBody()}function callCancel(){popUpWindow.close()}function enableSaveButton(){var a=Ext.getCmp("btnsave");if(a!=undefined){a.setDisabled(false)}}var updatedColors=[];function createXMLBody(){if(updatedColors.length>0){Visualforce.remoting.Manager.invokeAction(_remote_createInsertAndUpdateBody,updatedColors,function(a,b){if(b.status){RefreshButtonClick(true);popUpWindow.close()}},{escape:false})}}function ViewTasks(){var a=Ext.getCmp("cmbLinkedTo");SelectedLinkedName=a.getValue();changeTask(SelectedLinkedName)}var isCalendarShown=true;function showTaskCalendar(){isCalendarShown=true;document.getElementById("taskCalendarPanel").style.display="block";document.getElementById("schedulePage:taskPanel").style.display="none";if(document.getElementById("timelineId").className.indexOf("viewTimelineSelected")!=-1){return}document.getElementById("timelineId").className=document.getElementById("timelineId").className.replace("viewTimeline","viewTimelineSelected");document.getElementById("tableId").className=document.getElementById("tableId").className.replace("viewTableSelected","viewTable")}function showTaskTable(){isCalendarShown=false;document.getElementById("taskCalendarPanel").style.display="none";document.getElementById("schedulePage:taskPanel").style.display="block";if(document.getElementById("tableId").className.indexOf("viewTableSelected")!=-1){return}document.getElementById("tableId").className=document.getElementById("tableId").className.replace("viewTable","viewTableSelected");document.getElementById("timelineId").className=document.getElementById("timelineId").className.replace("viewTimelineSelected","viewTimeline");refreshGrid()}function doApply(){if(SelectedLinkedName!=null&&SelectedLinkedName!=""){changeTask(SelectedLinkedName)}}function replaceAll(f,d,e){var a=f;var b=a.indexOf(d);while(b!=-1){a=a.replace(d,e);b=a.indexOf(d)}return a}var filterTasksHandler=function(b,a){setOptions(b,a)};function setOptions(b,a){if(a){document.getElementById("taskFilterValue").value=document.getElementById("taskFilterValue").value+b.inputValue+NONPRINT}else{while(document.getElementById("taskFilterValue").value.indexOf(NONPRINT+b.inputValue+NONPRINT)!=-1){document.getElementById("taskFilterValue").value=document.getElementById("taskFilterValue").value.replace(NONPRINT+b.inputValue+NONPRINT,NONPRINT)}while(document.getElementById("taskFilterValue").value.indexOf(NONPRINT+b.inputValue)!=-1){document.getElementById("taskFilterValue").value=document.getElementById("taskFilterValue").value.replace(NONPRINT+b.inputValue,"")}while(document.getElementById("taskFilterValue").value.indexOf(b.inputValue+NONPRINT)!=-1){document.getElementById("taskFilterValue").value=document.getElementById("taskFilterValue").value.replace(b.inputValue+NONPRINT,"")}while(document.getElementById("taskFilterValue").value.indexOf(b.inputValue)!=-1){document.getElementById("taskFilterValue").value=document.getElementById("taskFilterValue").value.replace(b.inputValue,"")}}}function createCookie(d,e,f){if(f){var b=new Date();b.setTime(b.getTime()+(f*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=d+"="+e+a+"; path=/;SameSite=None;Secure"}function readCookie(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return f.substring(e.length,f.length)}}return""}function eraseCookie(a){createCookie(a,"",-1)}function changeGridValue(){var f=document.getElementById("unscheduleDiv");f=RemedyForceHTMLProcessor.clearHTML(f);renderUnscheduleGrid();var d=document.getElementById("taskCalendarTable");var b=d.parentNode;b=RemedyForceHTMLProcessor.clearHTML(b);var g,a;var e=document.createElement("table");e.id="taskCalendarTable";e.name="taskCalendarTable";e.style.tableLayout="fixed";e.cellPadding="0";e.cellSpacing="0";e.width="100%";b.appendChild(e);if(taskRecordFound){getTaskCalendarPanel();GetTaskCalendarData(e);renderTaskGrid()}else{TaskGridData=" ";GetTaskCalendarData(e)}if(isCalendarShown){showTaskCalendar()}else{showTaskTable()}}function RefreshButtonClick(a){if(typeof(a)!="undefined"&&a){ObsInstance.updateView(true)}else{ObsInstance.updateView()}}function deleteAllCookies(){deleteCookies();document.cookie=changeLabel+loggedInuserId+"=;path=/;SameSite=None;Secure";document.cookie=releaseLabel+loggedInuserId+"=;path=/;SameSite=None;Secure";document.cookie="tempReleaseCookie"+loggedInuserId+"cs=;path=/;SameSite=None;Secure";document.cookie="tempRequestCookie"+loggedInuserId+"cs=;path=/;SameSite=None;Secure"}function PrintButtonClick(){if(window.print){var f=document.createElement("style");f.type="text/css";var e=false||!!document.documentMode;if(e){var b="";var g=navigator.userAgent;var d=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(d.exec(g)!=null){b=parseFloat(RegExp.$1)}}if(b==8){f.cssText=".alternateRow0,.alternateRow1,.blackout,.serviceOutage{ border-left:1px solid #e7e7e7;border-right:1px solid #e7e7e7;background-color:#fff; border-top:1px solid #e7e7e7;border-bottom:1px solid #e7e7e7;}";f.cssText+=".normalHeader { background-color: #C4D8E8; }"}else{var a=".alternateRow0,.alternateRow1,.blackout,.serviceOutage{ border-left:1px solid #e7e7e7;border-right:1px solid #e7e7e7;background-color:#fff; border-top:1px solid #e7e7e7;border-bottom:1px solid #e7e7e7;}";a+=".normalHeader { background-color: #C4D8E8; }";f.appendChild(document.createTextNode(a))}document.getElementsByTagName("head")[0].appendChild(f);document.getElementById("calendarTable").border="1";RemedyForceHTMLProcessor.copyHTML(document.getElementById("mainTable"),document.body);window.print();document.location.reload(true)}}function ReportButtonClick(){var a="'/ChangeScheduleExportCSV?refresh=true&CurrentView="+CurrentViewParam+"&ClientDate="+ClientDateParam+"";window.open(a)}var ObsInstance=null;var CalendarEvents={VIEW_UPDATED:"view_updated"};var CalendarObservable=function(){this.values={};this.addEvents({parameters_updated:true})};Ext.extend(CalendarObservable,Ext.util.Observable,{updateDate:function(b,a,d){this.values.date=a;syncDates(a);this.updateView(d)},updateView:function(b){var a=getParamsForView();a.DoNotSlideOutWest=(b==true);this.values.date=a.date;this.values.startTime=a.startTime;this.values.showChangeNumberOrType=a.showChangeNumberOrType;this.values.showReleaseNumberOrType=a.showReleaseNumberOrType;this.values.viewType=a.viewType;this.values.filterField=a.filterField;this.values.filterField=a.filterValue;this.values.DoNotSlideOutWest=a.DoNotSlideOutWest;this.fireEvent(CalendarEvents.VIEW_UPDATED,this.values,null)}});function syncDates(a){drawer_Datepicker.setValue(a)}function getParamsForView(){var e={};e.date=drawer_Datepicker.getValue();e.startTime=document.getElementById("StartTime").value;var a=document.getElementById("cmbChange");var b=document.getElementById("cmbRelease");var d=document.getElementById("<%=DropDownList1.ClientID%>");if(document.getElementById("chkChange").checked&&a.options[a.selectedIndex].value=="Number"){e.showChangeNumberOrType=ShowChangeNumberOrTypeValue.number}else{if(document.getElementById("chkChange").checked&&a.options[a.selectedIndex].value=="Type"){e.showChangeNumberOrType=ShowChangeNumberOrTypeValue.type}}if(document.getElementById("chkRelease").checked&&b.options[b.selectedIndex].value=="Number"){e.showReleaseNumberOrType=ShowReleaseNumberOrTypeValue.number}else{if(document.getElementById("chkRelease").checked&&b.options[b.selectedIndex].value=="Type"){e.showReleaseNumberOrType=ShowReleaseNumberOrTypeValue.type}}e.viewType=document.getElementById("ViewType").value;e.filterField="some_field__c";e.filterValue="P1";return e}function ViewChanged(){ObsInstance.updateView()}function FireOnChangeEvent(){ViewChanged()}function GoToToday(){document.getElementById("ViewType").value=ViewComboValues.day12}function EnableDisableTime(){var a=document.getElementById("ViewType");if(a.value=="DayView12"||a.value=="DayView24"){document.getElementById("StartTime").disabled=false}else{document.getElementById("StartTime").disabled=true}}function move(d){var a=getParamsForView().viewType;var b=drawer_Datepicker.getValue();var e=1;if(a==ViewComboValues.day12){b=b.add(Date.DAY,1*d)}else{if(a==ViewComboValues.day24){b=b.add(Date.DAY,1*d)}else{if(a==ViewComboValues.week){b=b.add(Date.DAY,7*d)}else{if(a==ViewComboValues.month){b=b.add(Date.MONTH,1*d)}}}}ObsInstance.updateDate(null,b,true)}function previous(){move(-1)}function next(){move(1)}function updateCalendar(a){if(pageRefreshed){return}var d=a.date.add(Date.HOUR,a.startTime).format(isoDateFormat);console.log("isodate:"+d);var b="";if(a.viewType==ViewComboValues.day12){b="DayView12"}else{if(a.viewType==ViewComboValues.day24){b="DayView24"}else{if(a.viewType==ViewComboValues.week){b="WeekView"}else{if(a.viewType==ViewComboValues.month){b="MonthView"}}}}if(getStandardLayout()){window.location.href=CurrentPage+"?refresh=true&CurrentView="+b+"&ClientDate="+d+"&StartTime="+a.startTime+"&changeNumberOrType="+a.showChangeNumberOrType+"&releaseNumberOrType="+a.showReleaseNumberOrType+"&height="+controlHeight+"&SlideOutWest="+(!a.DoNotSlideOutWest)+"&standardLayout=true"}else{window.location.href=CurrentPage+"?refresh=true&CurrentView="+b+"&ClientDate="+d+"&StartTime="+a.startTime+"&changeNumberOrType="+a.showChangeNumberOrType+"&releaseNumberOrType="+a.showReleaseNumberOrType+"&height="+controlHeight+"&SlideOutWest="+(!a.DoNotSlideOutWest)}console.log("Calendar updated for date "+a.date)}var ChangeTypeColorArr;var ReleaseTypeColorArr;var maxColumns;function GetMainHeader(){var f,a;var b=document.createElement("table");b.cellPadding="0";b.cellSpacing="0";b.id="headerTable";b.name="headerTable";f=b.insertRow(0);a=f.insertCell(0);a.width="35%";a=f.insertCell(1);a.id="movePreviousHeader";var e=document.createElement("img");e.setAttribute("id","previousBTN");e.setAttribute("src",PrevImgSrc);e.setAttribute("style","cursor:pointer");e.setAttribute("onclick","previous();");e.setAttribute("title",Labels.lblPrevious);a.appendChild(e);a=f.insertCell(2);a=RemedyForceHTMLProcessor.clearHTML(a);a.appendChild(document.createTextNode(HeaderLabel));a.id="lblHeader";a.width="16%";a=f.insertCell(3);a.id="movePreviousHeader";var d=document.createElement("img");d.setAttribute("id","nextBTN");d.setAttribute("src",NextImgSrc);d.setAttribute("style","cursor:pointer");d.setAttribute("onclick","next();");d.setAttribute("title",Labels.lblNext);a.appendChild(d);a=f.insertCell(4);a.width="35%";return(b)}function GetCalendar(){var d,a;var b=document.createElement("table");b.id="calendarTable";b.name="calendarTable";b.style.tableLayout="fixed";b.cellPadding="0";b.cellSpacing="0";d=b.insertRow(b.rows.length);GetCalendarHeader(d);return(b)}function ChangeCalendar(){var h,a;var f=document.getElementById("calendarTable");GetBlackoutData(f);var e=Ext.util.Cookies.get("apex__filterQueryChange");var i=Ext.util.Cookies.get("apex__filterQueryRelease");if(e&&e.length==2){e=e.replace('""',"")}if(i&&i.length==2){i=i.replace('""',"")}if(isFilterApplidCookie!=null&&isFilterApplidCookie=="true"&&e!=null&&e!=""){GetCalendarData(f)}else{if(isFilterApplidCookie!=null&&isFilterApplidCookie=="true"&&i!=null&&i!=""){GetReleaseCalendarData(f)}else{GetCalendarData(f);GetReleaseCalendarData(f)}}var d=document.getElementById("taskCalendarTable");GetTaskCalendarData(d);var g=Ext.get("CalendarPanel").getHeight();var b=document.getElementById("calendarTable").clientHeight+35;if(g>b){document.getElementById("calendarTable").rows[document.getElementById("calendarTable").rows.length-1].style.height=parseInt("0"+document.getElementById("calendarTable").rows[document.getElementById("calendarTable").rows.length-1].style.height,10)+(g-b)+"px"}}function GetCalendarHeader(e){maxColumns=calendarHeader.length;for(var b=0;b<maxColumns;b++){cell=e.insertCell(b);if((ExtJSViewType=="WeekView")||(ExtJSViewType=="MonthView")){var f=(calendarHeader[b][0]).split(" ");for(var a=0;a<f.length;a++){cell.appendChild(document.createTextNode(f[a]));if(a<(f.length-1)){cell.appendChild(document.createElement("br"))}}}else{if(ExtJSViewType=="DayView24"){var d=calendarHeader[b][0];if(d<9){cell.appendChild(document.createTextNode("0"+d+":00"))}else{cell.appendChild(document.createTextNode(d+":00"))}}else{cell.appendChild(document.createTextNode(calendarHeader[b][0]))}}if(calendarHeader[b][1]==0){cell.className="serviceOutageHeader"}else{if(calendarHeader[b][1]==1){cell.className="blackoutHeader"}else{cell.className="normalHeader"}}}}function GetBlackoutData(p){var q=BOGridData.length;var k=RegExp("'","g");var t,r,m,e,o,a,l,d,s,b;for(var h=0;h<q;h++){t=p.insertRow(p.rows.length);t.style.height="20px";m=1;arrSOs=BOGridData[h];e=arrSOs.length;for(var g=0;g<e;g++){o=arrSOs[g][0];a=RemedyForceHTMLProcessor.htmlDecoder(arrSOs[g][1]);d=arrSOs[g][2];s=arrSOs[g][3];l=arrSOs[g][4];while(m<=maxColumns){r=t.insertCell(t.cells.length);if(m==d){var f=document.createElement("a");if(getStandardLayout()){var n="'/"+o+"'";f.setAttribute("onclick","window.open("+n+");")}else{f.setAttribute("onclick","openServiceOutageForm('"+o+"','"+escape(a)+"');")}f.setAttribute("class","changeLink");f.appendChild(document.createTextNode(a));r.id="s_o"+h+"c"+g;r.appendChild(f);if(l==1){r.className="blackout"}else{r.className="serviceOutage"}r.colSpan=s-d+1;if(Ext.isIE){r.onmouseover=new Function("showToolTip(event,'"+o+"', false, 'Change')")}else{r.setAttribute("onmouseover","showToolTip(event, '"+o+"', false, 'Change')")}m=s+1;break}else{if(calendarHeader[m-1][1]!=255){if(calendarHeader[m-1][1]==0){r.className="serviceOutage"}else{if(calendarHeader[m-1][1]==1){r.className="blackout"}}}else{if((m-1)%2==0){r.className="alternateRow0"}else{r.className="alternateRow1"}}}m++}}while(m<=maxColumns){r=t.insertCell(t.cells.length);if(calendarHeader[m-1][1]!=255){if(calendarHeader[m-1][1]==0){r.className="serviceOutage"}else{if(calendarHeader[m-1][1]==1){r.className="blackout"}}}else{if((m-1)%2==0){r.className="alternateRow0"}else{r.className="alternateRow1"}}m++}}}function GetCalendarData(b){var a=ChangeGridData.length;var h,d,o,u,m,r,t,l,f,n,e,y;for(var w=0;w<a;w++){h=b.insertRow(b.rows.length);h.style.height="20px";o=1;arrChanges=ChangeGridData[w];u=arrChanges.length;for(var v=0;v<u;v++){m=arrChanges[v][0];r=arrChanges[v][1];t=arrChanges[v][2];l=arrChanges[v][3];f=arrChanges[v][4];n=arrChanges[v][5];collisionDetectionState=arrChanges[v][6];var q=(collisionDetectionState=="collision");while(o<=maxColumns){d=h.insertCell(h.cells.length);if(o==l){if(!n){y="#F2F2F2"}else{if(typeof(ChangeTypeColorArr[t])!="undefined"){y=ChangeTypeColorArr[t]}else{y="#CCCCCC"}}var g=document.createElement("a");var s=document.createElement("s");if(isRFConsoleEnabled=="true"){g.setAttribute("onclick","openChangeForm('"+m+"','"+r+"');")}else{if(getStandardLayout()){var k="'/"+m+"'";g.setAttribute("onclick","window.open("+k+");")}else{g.setAttribute("onclick","openChangeForm('"+m+"','"+r+"');")}}g.setAttribute("class","changeLink");if(ExtJSChangeNumberOrType=="number"||ExtJSChangeNumberOrType=="undefined"){g.appendChild(document.createTextNode(r))}else{g.appendChild(document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(t)))}if(q){e=document.createElement("i");e.className="arrow_before";var x=document.createTextNode("\u00A0");e.appendChild(x);d.appendChild(e)}if(!n){s.appendChild(g);d.appendChild(s)}else{d.appendChild(g)}d.id="c_r"+w+"c"+v;d.className="changeRequest";d.bgColor=y;d.colSpan=f-l+1;var p=d.id;if(Ext.isIE){d.onmouseover=new Function("showToolTip(event,'"+m+"', true, 'Change')")}else{d.setAttribute("onmouseover","showToolTip(event, '"+m+"', true, 'Change')")}o=f+1;break}else{if(calendarHeader[o-1][1]!=255){if(calendarHeader[o-1][1]==0){d.className="serviceOutage"}else{if(calendarHeader[o-1][1]==1){d.className="blackout"}}}else{if((o-1)%2==0){d.className="alternateRow0"}else{d.className="alternateRow1"}}}o++}}while(o<=maxColumns){d=h.insertCell(h.cells.length);if(calendarHeader[o-1][1]!=255){if(calendarHeader[o-1][1]==0){d.className="serviceOutage"}else{if(calendarHeader[o-1][1]==1){d.className="blackout"}}}else{if((o-1)%2==0){d.className="alternateRow0"}else{d.className="alternateRow1"}}o++}}}function GetReleaseCalendarData(b){var a=ReleaseGridData.length;var m,d,q,n,k,v,h,p,g,s,f,e;for(var x=0;x<a;x++){m=b.insertRow(b.rows.length);m.style.height="20px";q=1;arrReleases=ReleaseGridData[x];n=arrReleases.length;for(var w=0;w<n;w++){var y;var u=arrReleases[w][0].indexOf("$")!=-1?true:false;k=u?arrReleases[w][0].substring(0,arrReleases[w][0].length-1):arrReleases[w][0];v=RemedyForceHTMLProcessor.htmlDecoder(arrReleases[w][1]);h=arrReleases[w][2];p=arrReleases[w][3];g=arrReleases[w][4];s=arrReleases[w][5];if(s){if(h=="Minor"||h==""){y="minorReleaseLink"}else{y="releaseLink"}}else{y="minorReleaseLink"}while(q<=maxColumns){d=m.insertCell(m.cells.length);if(q==p){if(!s&&!u){e="#F2F2F2";y="minorReleaseLink"}else{if(typeof(ReleaseTypeColorArr[h])!="undefined"){e=ReleaseTypeColorArr[h]}else{if(h==""){e="#C4D8E8"}else{e="#CCCCCC"}}}var l=document.createElement("a");var t=document.createElement("s");if(isRFConsoleEnabled=="true"){l.setAttribute("class","changeLink");l.setAttribute("onclick","openReleaseForm('"+k+"','"+v+"');")}else{var o="'/"+k+"'";l.setAttribute("class",y);l.setAttribute("onclick","window.open("+o+");")}if(ExtJSReleaseNumberOrType=="number"||ExtJSReleaseNumberOrType=="undefined"){l.appendChild(document.createTextNode(v))}else{l.appendChild(document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(h)))}if(!s){t.appendChild(l);d.appendChild(t)}else{d.appendChild(l)}if(!u){d.id="ri_r"+x+"c"+w}else{d.id="rd_r"+x+"c"+w}d.className="release";if(!s&&u){d.className="closedDeploymentRelease"}if(u&&h=="Minor"&&s){d.className="minorDeployRelease"}else{if(u&&h=="Major"&&s){d.className="majorDeployRelease"}else{if(u&&h=="Emergency"&&s){d.className="emergencyDeployRelease"}else{if(u&&h==""&&s){d.className="deploymentRelease"}}}}d.bgColor=e;d.colSpan=g-p+1;var r=d.id;if(Ext.isIE){d.onmouseover=new Function("showToolTip(event,'"+arrReleases[w][0]+"', true, 'Release')")}else{d.setAttribute("onmouseover","showToolTip(event, '"+arrReleases[w][0]+"', true, 'Release')")}q=g+1;break}else{if(calendarHeader[q-1][1]!=255){if(calendarHeader[q-1][1]==0){d.className="serviceOutage"}else{if(calendarHeader[q-1][1]==1){d.className="blackout"}}}else{if((q-1)%2==0){d.className="alternateRow0"}else{d.className="alternateRow1"}}}q++}}while(q<=maxColumns){d=m.insertCell(m.cells.length);if(calendarHeader[q-1][1]!=255){if(calendarHeader[q-1][1]==0){d.className="serviceOutage"}else{if(calendarHeader[q-1][1]==1){d.className="blackout"}}}else{if((q-1)%2==0){d.className="alternateRow0"}else{d.className="alternateRow1"}}q++}}}function openServiceOutageForm(a,d){var b="NavigatorPage?&title="+d+"&target=BlackOutPage?id="+a;window.parent.parent.addNewTab("BlackoutPage",Labels.lblPSO,b);return false}function openChangeForm(a,e){if(isRFConsoleEnabled=="true"){if(hasLayoutAccess(a,"CR")){openPopupRecord(a,e,"Change_Request__c",null,null,null)}else{var f,d=getLayoutName(a,"CR");if(d!=undefined&&d!=""){f=Labels.LayoutInsufficientAccess+" "+d}else{f=Labels.LayoutInsufficientAccessGeneric}showMessage(f)}}else{var b="NavigatorPage? &title="+e+"&target=ChangeRequestPage?id="+a;window.parent.parent.addNewTab("ChangeRequestPage",Labels.lblCR,b);return false}}function openReleaseForm(a,d){if(isRFConsoleEnabled=="true"){openPopupRecord(a,d,"Release__c",null,null,null)}else{var b="NavigatorPage? &title="+d+"&target=ReleasePage?id="+a;window.parent.parent.addNewTab("ReleasePage",Labels.lblCR,b);return false}}function openTaskForm(a,d){if(hasLayoutAccess(a,"TS")){openPopupRecord(a,d,"Task__c",null,null,null)}else{var e,b=getLayoutName(a,"TS");if(b!=undefined&&b!=""){e=Labels.LayoutInsufficientAccess+" "+b}else{e=Labels.LayoutInsufficientAccessGeneric}showMessage(e)}}var changeToolTip=null;function showToolTip(b,a,g,d){var f=b.target;if(f==null){f=b.srcElement}if(f.nodeName=="A"){return}var e;if(d=="Release"){e=getReleaseToolTip(a)}else{if(d=="Task"){e=getTaskToolTip(a)}else{if(g){e=getChangeToolTip(a)}else{e=getBlackoutToolTip(a)}}}if(changeToolTip!=null){changeToolTip.body.update(e)}else{changeToolTip=null;changeToolTip=new Ext.ToolTip({id:"chgTooltip",target:f.id,title:"",anchor:"left",html:e,width:385,shadow:false,autoScroll:true,autoHide:false,trackMouse:true,bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;overflow:hidden; overflow-y:auto;maxHeight:300px;",dismissDelay:0,listeners:{render:function(h){h.getEl().on({mouseleave:function(){changeToolTip.hide()},scope:h})}}})}if(Ext.isIE){changeToolTip.targetXY=[b.clientX,b.clientY]}else{changeToolTip.targetXY=[b.pageX,b.pageY]}changeToolTip.show()}function dynamicToolTip(h,f){var j,l,e,g;var o="";var q=1;var d="";if(h=="Release"){e=RelTtipHeader.split(",");j=ReleaseTooltip[f].split("%#$#%");g=Labels.lblRelease}else{if(h=="Task"){e=TaskTtipHeader.split(",");j=TaskTooltip[f].split("%#$#%");g=Labels.lblTask}else{if(h=="Change"){e=CRTtipHeader.split(",");j=ChangeRequestTooltip[f].split("%#$#%");q=2;g=Labels.lblChangeRequest;var b=j[1];var a=(b=="collision");if(a){d="<div class='collision_detected_ttip'><i class='arrow_before'>&nbsp;</i>"+Labels.lblCollisionDetected+"</div>"}}}}var n=e.length;var p=j.length;var m=Math.min(n,p);l='<tr><td class="ttipHeader1" width="40%">'+g+'</td><td class="ttipHeader1" style="white-space:normal;">'+j[0]+d+'</td></tr><tr><td colspan="2"></td></tr>';for(var k=q;k<m;k++){o=o+'<tr><td class="ttipHeader2" valign="top">'+e[k]+':</td><td class="ttipLabel">'+j[k].replace(/`n/g,"<br />")+"</td></tr>"}if(m>q){var l=l+'<td colspan="2"><hr></td></tr>'}html='<table class="ttipTable" cellpadding=4 cellspacing=3 border=0 width="350" style="table-layout:fixed">'+l+o;return html}function getChangeToolTip(b){var a;if(typeof(ChangeRequestTooltip[b])=="undefined"){a="</span>"+Labels.lblChangeRequest+"</span>"}else{a=dynamicToolTip("Change",b)}return a}function getReleaseToolTip(a){var b;if(typeof(ReleaseTooltip[a])=="undefined"){b="</span>"+Labels.lblRelease+"</span>"}else{b=dynamicToolTip("Release",a)}return b}function getTaskToolTip(b){var e,d,a="";if(typeof(TaskTooltip[b])=="undefined"){a="</span>"+Labels.lblTask+"</span>"}else{mainHtml=dynamicToolTip("Task",b)}return mainHtml}function getBlackoutToolTip(d){var b,a="";if(typeof(BOTooltip[d])=="undefined"){a="<span>"+Labels.lblPSO+"</span>"}else{b=BOTooltip[d].split("%#$#%");if(b.length!=6){a="<span>"+Labels.lblPSO+"</span>"}else{if(b.length>0){b[1]=b[1].replace(/>/g,"&gt;");b[1]=b[1].replace(/</g,"&lt;")}a='<table class="ttipTable" cellpadding=3 cellspacing=3 border=0 width="350" style="table-layout:fixed"><tr><td class="ttipHeader1"  width="45%">'+Labels.lblName+'</td><td class="ttipHeader1"  style="white-space:normal;">'+b[0]+'</td></tr><tr><td colspan="2" class="ttipLabel">'+b[1].replace(/`n/g,"<br>")+'</td></tr><tr><td class="ttipHeader2" >'+Labels.lblAffectedService+':</td><td class="ttipLabel">'+b[2]+'</td></tr><tr><td class="ttipHeader2" >'+Labels.lblBOStartDate+':</td><td class="ttipLabel">'+b[3]+'</td></tr><tr><td class="ttipHeader2" >'+Labels.lblBOEndDate+':</td><td class="ttipLabel">'+b[4]+'</td></tr><tr><td class="ttipHeader2" >'+Labels.lblBlackoutPeriod+':</td><td class="ttipLabel">'+((b[5]=="1")?Labels.lblTrue:Labels.lblFalse)+"</td></tr></table>"}}return a}function getTaskCalendarPanel(){return(new Ext.Panel({layout:"fit",id:"taskCalendarPanel",region:"center",border:false}))}function getTaskCalendarHTML(){var d,a;var b=document.createElement("table");b.cellPadding="0";b.cellSpacing="0";b.id="taskTable";b.name="taskTable";b.width="100%";d=b.insertRow(0);a=d.insertCell(0);d=b.insertRow(1);a.appendChild(GetTaskCalendar());var e=document.createElement("div");e.id="taskdestroyer";e.appendChild(b);return e}function GetTaskCalendar(){var d,a;var b=document.createElement("table");b.id="taskCalendarTable";b.name="taskCalendarTable";b.style.tableLayout="fixed";b.cellPadding="0";b.cellSpacing="0";b.width="100%";d=b.insertRow(b.rows.length);return(b)}function GetTaskCalendarData(b){var a=TaskGridData.length;var m,d,q,x,g,h,l,o,f,p,e,y;gridData=[];for(var w=0;w<a;w++){m=b.insertRow(b.rows.length);q=1;arrTasks=TaskGridData[w];x=arrTasks.length;if(a==1){m.style.height="135px"}else{if(a==2){m.style.height="115px"}else{if(a==3){m.style.height="95px"}else{if(a==4){m.style.height="75px"}else{if(a==5){m.style.height="55px"}else{if(a>=6){m.style.height="35px"}}}}}}for(var v=0;v<x;v++){if(x==1&&a==1){m.style.height="135px"}else{m.style.height="20px"}var t;g=arrTasks[v][0];h=arrTasks[v][1];l=arrTasks[v][2];o=arrTasks[v][3];f=arrTasks[v][4];p=arrTasks[v][5];var u=new Array(5);if(isRFConsoleEnabled=="true"){u[0]='<a href="#" onclick="openTaskForm(\''+g+"','"+h+"')\">"}else{if(getStandardLayout()){var n="'/"+g+"'";u[0]='<a href="#" onclick="window.open('+n+')">'}else{u[0]='<a href="#" onclick="openTaskForm(\''+g+"','"+h+"')\">"}}u[0]+=h+"</a>";u[1]=l;u[2]=arrTasks[v][6];u[3]=arrTasks[v][7];u[4]=arrTasks[v][8];u[5]=arrTasks[v][9];u[6]=arrTasks[v][10];gridData.push(u);t="releaseLink";while(q<=maxColumns){d=m.insertCell(m.cells.length);if(q==o){if(!p){y="#F2F2F2"}else{if(typeof(TaskTypeColorArr['"'+Labels.lblOpenTask+'"'])!="undefined"){y=TaskTypeColorArr['"'+Labels.lblOpenTask+'"']}else{y="#CCCCCC"}}var k=document.createElement("a");var s=document.createElement("s");if(isRFConsoleEnabled=="true"){k.setAttribute("onclick","openTaskForm('"+g+"','"+h+"');")}else{if(getStandardLayout()){var n="'/"+g+"'";k.setAttribute("onclick","window.open("+n+");")}else{k.setAttribute("onclick","openTaskForm('"+g+"','"+h+"');")}}k.setAttribute("class","changeLink");k.appendChild(document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(h)));if(!p){s.appendChild(k);d.appendChild(s)}else{d.appendChild(k)}d.id="t_r"+w+"c"+v;d.className="changeRequest";d.bgColor=y;d.colSpan=f-o+1;var r=d.id;if(Ext.isIE){d.onmouseover=new Function("showToolTip(event,'"+g+"', true, 'Task')")}else{d.setAttribute("onmouseover","showToolTip(event, '"+g+"', true, 'Task')")}q=f+1;break}else{if((q-1)%2==0){d.className="alternateRow0"}else{d.className="alternateRow1"}}q++}}while(q<=maxColumns){d=m.insertCell(m.cells.length);if((q-1)%2==0){d.className="alternateRow0"}else{d.className="alternateRow1"}q++}}}function reset(){if(isFilterApplidCookie!=null&&isFilterApplidCookie=="true"){deleteAllCookies()}Ext.getCmp("searchField").setValue("")}function isCJKChar(d){var b=/[\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/;var a=b.test(d);return(a)}function search(){var e=Ext.getCmp("searchField").getValue();var g=encodeURIComponent(e.trim());if(g.length<2&&!isCJKChar(e.trim())){Ext.MessageBox.show({title:Labels.lblWarning,msg:Labels.lblGsErrorMsg,width:300,buttons:Ext.MessageBox.OK});return}else{var b="apex/KnowledgeSearch?calledFromForm=true&isCalendarSearch=true&search="+g;var h=1000;var a=400;var d=parseInt((screen.availWidth/2)-(h/2));var f=parseInt((screen.availHeight/2)-(a/2));window.open(b,"_blank","status = 1, height ="+a+", width ="+h+",left="+d+",top="+f+", resizable = 1, scrollbars=no")}}function RemoveReserveCharactersForSOSL(d){var b=new Array("?","&","|","!","{","}","[","]","(",")","^","~","*",":","\\",'"',"+","-","'");for(var a=0;a<b.length;a++){d=d.replace(b[a],"")}return d}function refreshGrid(){if(Ext.getCmp("grid")!=null){Ext.getCmp("grid").getView().refresh()}}function showMessage(a){Ext.MessageBox.show({msg:a,title:Labels.lblInformation,width:300,height:"auto",buttons:Ext.MessageBox.OK})}function hasLayoutAccess(d,b){var f=true,e=false,g;if(b=="CR"){e=isMultipleLayoutEnabledCR;g=layoutIdJSON_CR}else{if(b=="TS"){e=isMultipleLayoutEnabledTS;g=layoutIdJSON_TS}}if(e!=undefined&&e!=null&&e==true){var a=g[d],j="¬";if(a){var i=a.split(j);if(i.length>1){if(i[0]!=undefined&&i[0]!=null&&i[0]!=""){var h=i[0].toLowerCase();if(h=="false"){f=false}}}}}return f}function getLayoutName(e,d){var b="",i=false,f;if(d=="CR"){i=isMultipleLayoutEnabledCR;f=layoutIdJSON_CR}else{if(d=="TS"){i=isMultipleLayoutEnabledTS;f=layoutIdJSON_TS}}if(i!=undefined&&i!=null&&i==true){var a=f[e],h="¬";if(a){var g=a.split(h);if(g.length>1){if(g[1]!=undefined&&g[1]!=null&&g[1]!=""){b=g[1]}}}}return b};