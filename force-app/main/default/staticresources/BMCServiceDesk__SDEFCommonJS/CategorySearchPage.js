var showFooterPanel=true;var NewBtnHandler=function(a,b){var c=new Array(1);if(isRequestCatalog=="true"){c[0]="OpenCategoryPageFromRequestDef"}else{c[0]="OpenCategoryPage"}window.parent.setPopUpVar(c);parent.window.closePopupRF()};function changeGrouping(){var a=Ext.getCmp("groupoptions");var b=Ext.getCmp("groupoptions").getValue();document.getElementById("selectedCategory").value=Ext.getCmp("groupoptions").getValue();renderTree()}function SendValueToParent(b){window.parent.setPopUpVar(b);parent.window.closePopup()}function pageRefresh(){window.location.reload()}Ext.onReady(function(){Ext.QuickTips.init();var i=new Date();var d=i.getTime();Nwlatency=d-getServerendtime();clookupdata+=labelPMServerTime;clookupdata+=servertime;clookupdata+="<br>";clookupdata+=labelNwLatency;clookupdata+=Nwlatency;clookupdata+="<br>";showCategoryList=getshowCategoryList();if(showCategoryList){if(isRequestCatalog){document.getElementById("categoryListPage").innerHTML='<iframe id="categoryListFrameId" name="categoryListFrame" frameborder="0" scrolling="no" src ="/apex/SearchPage?popupId=Category&pgheight=750&wid=1&isLookup=true&disableFirstColLink=true&hideIncidentCat=true&filterClause='+escape("inactive__c = false")+'" style="width:100%;height:100%;border:none;"/>'}else{if(popupId!=null&&popupId!="null"&&popupId.toLowerCase()=="incident"){document.getElementById("categoryListPage").innerHTML='<iframe id="categoryListFrameId" name="categoryListFrame" frameborder="0" scrolling="no" src ="/apex/SearchPage?popupId=Category&pgheight=750&wid=1&isLookup=true&disableFirstColLink=true&showFilterMenu=true&pId=incident&filterClause='+escape("inactive__c = false")+'" style="width:100%;height:100%;border:none;"/>'}else{document.getElementById("categoryListPage").innerHTML='<iframe id="categoryListFrameId" name="categoryListFrame" frameborder="0" scrolling="no" src ="/apex/SearchPage?popupId=Category&pgheight=750&wid=1&isLookup=true&disableFirstColLink=true&filterClause='+escape("inactive__c = false")+'" style="width:100%;height:100%;border:none;"/>'}}}else{document.getElementById("categoryListPage").style.display="none";if(popupId!=null&&popupId!="null"&&popupId.toLowerCase()=="incident"){new Ext.Toolbar({renderTo:"btntoolbar",items:[{scale:"medium",tooltipType:"title",disabled:isNewButtonDisable,tooltip:labelNew,iconCls:"bmcNew",id:"categoryNew",listeners:{mouseover:function(){this.setIconClass("bmcNewOn")},mouseout:function(){this.setIconClass("bmcNew")}},handler:NewBtnHandler}," ","-"," ",filterMenuPanel," ","-"," ",cmbbx," ","  "," ",srchTxtFld,{xtype:"spacer",width:Ext.isIE?20:5},{iconCls:"bmcSearch",tooltip:labelSearch,tooltipType:"title",id:"categorySearch",handler:txtSearch}," "," "," ",{scale:"medium",iconCls:"bmcRefresh",tooltip:labelRefresh,tooltipType:"title",style:{align:"left"},id:"categoryRefresh",handler:pageRefresh}]})}else{new Ext.Toolbar({renderTo:"btntoolbar",items:[{scale:"medium",tooltipType:"title",disabled:isNewButtonDisable,tooltip:labelNew,iconCls:"bmcNew",id:"categoryNew",listeners:{mouseover:function(){this.setIconClass("bmcNewOn")},mouseout:function(){this.setIconClass("bmcNew")}},handler:NewBtnHandler}," ","-"," ",cmbbx," ","  "," ",srchTxtFld,{xtype:"spacer",width:Ext.isIE?20:5},{iconCls:"bmcSearch",tooltip:labelSearch,tooltipType:"title",id:"categorySearch",handler:txtSearch}," "," "," ",{scale:"medium",iconCls:"bmcRefresh",tooltip:labelRefresh,tooltipType:"title",style:{align:"left"},id:"categoryRefresh",handler:pageRefresh}]})}var n=function(s,r){if(r.getKey()==r.RETURN||r.getKey()==r.ENTER){if(document.getElementById(cancelBtnId)!=null){document.getElementById(cancelBtnId).disabled=true}txtSearch()}};srchTxtFld.on("specialkey",n);var m=193;if(isRequestCatalog=="true"){m=395}new Ext.Panel({renderTo:"categoryPageTree",height:m,autoScroll:true,items:[{xtype:"treepanel",height:m,width:640,margins:"0 10 0 0",autoScroll:true,useArrows:true,split:true,id:"categoryTree",border:false,margins:"0 5 0 0",cmargins:"0 5 0 0",titleCollapse:true,loader:new Ext.tree.TreeLoader(),root:new Ext.tree.AsyncTreeNode({text:labelCatByDesc,expanded:true,children:categoriesObj}),rootVisible:true,listeners:{click:function(r){if(r==this.getRootNode()){a("","","")}else{availableForSR=r.attributes.availableForSR;a(r.id,r.text,r.attributes.urgencyId);if(showFooterPanel!=null&&typeof(showFooterPanel)!="undefined"&&(showFooterPanel==true||showFooterPanel=="")){if(isRequestCatalog!="true"){nodeClicked(r.id)}}}},dblclick:function(r){if(r==this.getRootNode()){return}availableForSR=r.attributes.availableForSR;a(r.id,r.text,r.attributes.urgencyId);saveCategory()}}}]})}function a(s,r,t){categoryId=s;categoryName=r;catUrgency=t}if(isRequestCatalog!="true"){var h=new Ext.data.ArrayStore({fields:[{name:"StandardDescription"},{name:"DescriptionID"},{name:"ID"}],data:descriptionData});var g=new Ext.data.ArrayStore({fields:[{name:"StandardResolution"},{name:"ResolutionID"},{name:"ID"}],data:resolutionData});var k=new Array(3);k[0]={id:"StandardDescription",header:labelStandardDescription,dataIndex:"StandardDescription"};k[1]={id:"DescriptionID",header:"DescriptionID",hidden:true,dataIndex:"DescriptionID"};k[2]={id:"ID",header:"ID",hidden:true,dataIndex:"ID"};var q=new Array(3);q[0]={id:"StandardResolution",header:labelStandardResolution,dataIndex:"StandardResolution"};q[1]={id:"ResolutionID",header:"ResolutionID",hidden:true,dataIndex:"ResolutionID"};q[2]={id:"ID",header:"ID",hidden:true,dataIndex:"ID"};desGrid=new Ext.grid.GridPanel({store:h,border:true,cm:new Ext.grid.ColumnModel({defaults:{sortable:true},columns:k}),viewConfig:{scrollOffset:0,forceFit:true},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),trackMouseOver:false,loadMask:true,height:145,frame:true,stripeRows:true,enableColumnMove:false,enableHdMenu:false,id:"decsriptionGrid",layout:"fit",listeners:{rowClick:function(r,v,s){descriptionString="";var t=r.store.getAt(v);var u=t.get("DescriptionID");descriptionString=t.get("ID");handleRowClick(u)}}});var e=new Ext.Panel({defaults:{height:33},items:[{id:"desCheckBox",xtype:"checkbox",width:37,checked:false}]});var b=new Ext.Panel({defaults:{height:33},items:[{id:"resCheckBox",xtype:"checkbox",width:37,checked:false}]});resGrid=new Ext.grid.GridPanel({store:g,cm:new Ext.grid.ColumnModel({defaults:{sortable:true},columns:q}),viewConfig:{scrollOffset:0,forceFit:true},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),trackMouseOver:false,loadMask:true,layout:"fit",height:145,frame:true,stripeRows:true,enableColumnMove:false,enableHdMenu:false,id:"resolutionGrid",listeners:{rowClick:function(r,v,t){resolutionString="";var u=r.store.getAt(v);var s=u.get("ResolutionID");resolutionString=u.get("ResolutionID")}}});var o=new Ext.Panel({height:175,layout:"vbox",layoutConfig:{align:"stretch"},items:[e,desGrid]});var l=new Ext.Panel({height:175,layout:"vbox",layoutConfig:{align:"stretch"},items:[b,resGrid]});if(getIsStandardDescription()=="true"){var p=new Ext.Panel({border:false,height:200,layout:"hbox",collapsible:true,title:labelStandardDescriptionAndResolution,renderTo:"div1",disabled:isShowFooterDisabled(),defaults:{flex:1},items:[o,l]})}}var c=new Date();var j=c.getTime();var f=j-d;clookupdata+=pageLoad;clookupdata+=f;document.getElementById("lookupdataval").value=clookupdata});function saveCategory(){if(!availableForSR&&isRequestCatalog){showMessage(labelSRDCategorySelectionErrorMsg);return}if(categoryId==null||categoryId==""){showMessage(labelSelCategory)}else{var a=categoryName+":"+descriptionString+":"+resolutionString;var b=new Array(5);b[0]=decodeSpecialChar(categoryName);if(isRequestCatalog!="true"){if(Ext.getCmp("desCheckBox").getValue()){b[1]=decodeSpecialChar(descriptionString)}else{b[1]=null}if(Ext.getCmp("resCheckBox").getValue()){b[2]=decodeSpecialChar(resolutionString)}else{b[2]=null}}else{b[1]=null;b[2]=null}b[3]=categoryId;b[4]=decodeSpecialChar(catUrgency);window.parent.setPopUpVar(b);setTimeout("window.parent.closePopupRF()",1000)}}function changeTitle(b,c,a){}function activateWindow(){}function addTab(){}function selectedCatDBClk(c,b,d){var a=frames.categoryListFrame.grid.store.getAt(b).get("Name");catUrgency=frames.categoryListFrame.grid.store.getAt(b).get("FkUrgency__c");categoryId=d;categoryName=a;saveCategory()}function selectedCatSingleClk(c,b,d){var a=frames.categoryListFrame.grid.store.getAt(b).get("Name");catUrgency=frames.categoryListFrame.grid.store.getAt(b).get("FkUrgency__c");categoryId=d;categoryName=a;if(showFooterPanel!=null&&typeof(showFooterPanel)!="undefined"&&(showFooterPanel==true||showFooterPanel=="")){nodeClicked(d)}};