var objName;var idset;var ownerIdString;var duration=0,insideNote=false,clickedOnce=false,changeDone=false,networklatencystart="",startTime=new Date(),windowloaddate="",networklatency="",isDormantSection=false,isNoteEnableFlag=true,hideCustomFieldAccordion=true,closedStageName,durationError=0;document.onclick=activateWindow;var resizeGrid=function resizeGrid(){if(Ext.getCmp("southPanelSI")!=undefined){Ext.getCmp("southPanelSI").setWidth(Ext.getCmp("southPanelSI").getWidth())}};var NewBtnHandler=function(){openPage("ChangeRequestPageCustom",ChangeRequestHeader,ChangeRequestHeader);activeAllWindowFlag=false;activeAllWindowFlag=false};function OpenHelpUrl(a){if(a.toLowerCase().indexOf("changerequestservicetarget")!=-1){OpenHelppage("ServiceTransaction","module","form")}else{if(a.toLowerCase().indexOf("composeemailpage")!=-1){OpenHelppage("EmailConversationChange","module","form")}}}var SaveBtnHandler=function(){if(!inProgress){var e=document.getElementById(changeDescriptionComponent).value;var a=document.getElementById(rolloutComponent).value.trim();var c=document.getElementById(backoutComponent).value.trim();var b=document.getElementById(backoutComponent).value.trim();var g=e.length;if(!Ext.isIE&&e!=null){if(null!=e.match(/[^\n]*\n[^\n]*/gi)){g=g+e.match(/[^\n]*\n[^\n]*/gi).length}}if(g>32000){Ext.MessageBox.show({msg:labelChangeDescription+": "+AddNote.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK});return}if(a.length>255){Ext.MessageBox.show({msg:labelRolloutPlan+": "+AddNote.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK});return}if(c.length>255){Ext.MessageBox.show({msg:labelBackoutPlan+": "+AddNote.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK});return}if(b.length>255){Ext.MessageBox.show({msg:labelReasonForChange+": "+AddNote.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK});return}var f=ValidateForm();if(f==true){Ext.getCmp("saveId").setDisabled(true);var d=Ext.getCmp("change_inactive__c").getValue();waitbox(0);save(d)}}};var CopyBtnHandler=function(){callCopyPage();activeAllWindowFlag=false};var DeleteBtnHandler=function(){Ext.MessageBox.confirm(labelDelete,DeletedRecord,function(a){if(a==="yes"){deleteChangeRequest()}})};var ResetBtnHandler=function(){resetChangeRequest()};var CloseBtnHandler=function(a,b){closeChangeRequest()};var RespondedBtnHandler=function(a,b){window.parent.registerChange(wid);respondedBtnHandler()};var disableTrue=function(){};function senddata(){return data}Ext.onReady(function(){if(closedStageName=="CLOSED"||closedStageName=="Closed"){Ext.MessageBox.show({title:Information,msg:ClosedStage,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}getapplyTemp();disableDateField();if(hideCustomFieldAccordion){document.getElementById(ChangePageComp.ComponentVars.customFieldAccordionPanelId).style.display="none"}windowloaddate=new Date();networklatencystart=windowloaddate.getTime();networklatency=networklatencystart-networkstart;Ext.QuickTips.init();createControlMap();renderElementsByType();var w=Ext.extend(Ext.Panel,{renderTo:"btnToolbar",defaults:{bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"}});var p=function(x,y){openPopup("SearchPage?popupId=Client&isLookup=true&filterClause="+escape("IsStaffUser__c=true")+"&isAssignTo=true",preAssignChangeTOStaff)};var u=function(x,y){openPopup("SearchPage?popupId=Queue&isQueurorUser=true&isLookup=true&queueFor=Change_Request__c&isOnlyQueueList=true&filterClause="+escape("sobjectType='"+objName+"'"),preAssignChangeTOQueue)};var h=function(x,y){waitbox(0);assignTOMyself();handleChange()};var m=function(x,y){openPopup("SearchPage?popupId=Client&isLookup=true&filterClause="+escape("profileid='"+profileId+"' And IsStaffUser__c=true")+"&isAssignTo=true",preAssignChangeTOStaff)};var j=function(x,y){reopenChange()};var b=function(x,y){var z=Ext.getCmp("templateBtnId");if(changeId!=null&&changeId!=""&&overwrite=="true"){Ext.MessageBox.confirm("",OverwriteWarning,function(A){if(A==="yes"){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Change Request'  and Hasrecurrence__c = false"),fetchChangeTemplates)}})}else{if((changeId!=null&&changeId!=""&&overwrite=="false"&&changeDone==true)||(changeId==null||changeId==""&&overwrite=="false"&&z.disabled==false&&changeDone==true)){Ext.MessageBox.confirm("",replaceUnsaved,function(A){if(A==="yes"){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Change Request'  and Hasrecurrence__c = false"),fetchChangeTemplates)}})}else{if(z.disabled==false){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Change Request'  and Hasrecurrence__c = false"),fetchChangeTemplates)}}}};var c=function(x,y){if(window.parent.changeArray[wid2]!=null&&typeof(window.parent.changeArray[wid2])!="undefined"&&window.parent.changeArray[wid2]!=-1){checkLoseChanges(o)}else{if(document.getElementById("prevId").disabled!=true){o()}}};var g=function(x,y){if(window.parent.changeArray[wid2]!=null&&typeof(window.parent.changeArray[wid2])!="undefined"&&window.parent.changeArray[wid2]!=-1){checkLoseChanges(n)}else{if(document.getElementById("nextId").disabled!=true){n()}}};var a=function(x,y){getChangeProcBtnHandler()};updateTitle();converdisabletoreadonly();handleElemEvent();function e(){if(idset==null||idset==""){if(getIsDirect()==""){if(typeof(window.parent.returnListOfId)=="function"){idset=window.parent.returnListOfId()}}else{if(typeof(window.parent.parent.getIdArray)=="function"){idset=window.parent.parent.getIdArray()}window.parent.handleSave(getWID(),getID())}}}e();function o(){var y="";var x=0;while(idset.length>x){if(y==""){y=idset[x]}else{y=y+","+idset[x]}x++}previousChangeBtnHandler(y)}function n(){var y="";var x=0;while(idset.length>x){if(y==""){y=idset[x]}else{y=y+","+idset[x]}x++}nextChangeBtnHandler(y)}new w({id:"toolBarId",title:"",cls:"toolSpCls",bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;",tbar:[{scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:labelNew,id:"newId",handler:NewBtnHandler}," ",{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:labelSave,id:"saveId",handler:SaveBtnHandler}," ",{scale:"medium",iconCls:"bmcCopy",tooltipType:"title",tooltip:labelCopy,id:"copyId",handler:CopyBtnHandler}," ","-"," ",{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:labelDelete,id:"deleteId",handler:DeleteBtnHandler}," ",{scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:labelReset,id:"resetId",handler:ResetBtnHandler}," ",separator," ",{id:"assignToId",scale:"medium",iconCls:"bmcAssign1",tooltipType:"title",tooltip:labelAssignTo,menu:[{text:labelIncidentsStaff,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToStaffButtonId",handler:p},{text:labelIncidentMyself,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToMyselfButtonId",handler:h},{text:labelIncidentMemberofProfName,id:"assignToMemberOfAdminButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:m},{text:labelChangeQueue,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToQueueButtonId",handler:u}]}," ",{id:"actionId",scale:"medium",iconCls:"bmcAction1",tooltipType:"title",tooltip:labelActions,menu:[{text:labelIncidentClose,id:"closeButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:CloseBtnHandler},{text:labelReopenChange,id:"reopenButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:j},{text:labelResponded,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"respondedButtonId",handler:RespondedBtnHandler},{text:Print,disabled:IsNewRecord(changeId),icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printButtonId",handler:PrintBtnHandler},{text:PrintPDF,disabled:IsNewRecord(changeId),icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printPdfButtonId",handler:PrintPDFBtnHandler},"-",customActionJsonString]}," ",{scale:"medium",iconCls:"bmcTemplate",tooltipType:"title",tooltip:labelTemplate,id:"templateBtnId",handler:b,listeners:{disable:function(){this.setIconClass("bmcTemplateDisable")},enable:function(){this.setIconClass("bmcTemplate")}}}," ",{scale:"medium",iconCls:"bmcAPM",tooltipType:"title",tooltip:labelChangeMgmtProcess,id:"changeProcButton",handler:a}," ","-"," ",{scale:"medium",iconCls:"bmcCIExplorer",tooltipType:"title",tooltip:labelLaunchCIExplorer,id:"ciExplorerBtn",listeners:{mouseover:function(){this.setIconClass("bmcCIExplorerOn")},mouseout:function(){this.setIconClass("bmcCIExplorer")},disable:function(){this.setIconClass("bmcCIExplorerDisable")},enable:function(){this.setIconClass("bmcCIExplorer")}},handler:ShowCIExplorer}," ",{scale:"medium",iconCls:"bmcEmailMessage",tooltipType:"title",tooltip:labelEmailMessage,id:"emailId",disabled:false,handler:sendEmailBtnHandler,listeners:{disable:function(){this.setIconClass("bmcEmailMessageDisable")},enable:function(){this.setIconClass("bmcEmailMessage")}}}," ",{scale:"medium",iconCls:"bmcServiceTargets",tooltipType:"title",tooltip:labelServiceTargets,id:"servicetargets",disabled:!hasServiceTargets,listeners:{disable:function(){this.setIconClass("bmcServiceTargetsDisable")},enable:function(){this.setIconClass("bmcServiceTargets")}},handler:ServiceTargetsBtnHandler},new Ext.Toolbar.Fill(),{id:"change_inactive__c",xtype:"checkbox",width:93,color:"#004376",align:"top",checked:false,boxLabel:'<span class="checkboxLabelCls" id="inactiveLabel">'+labelInactive+"</span>"},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif",title:labelPreviousRecord},cls:"cursorCls",listeners:{render:function(x){x.el.on("click",c)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:labelNextRecord},cls:"cursorSpaceCls",listeners:{render:function(x){x.el.on("click",g)}}}]});new Ext.ToolTip({target:"change_inactive__c",anchor:"left",html:labelTooltipChangeInactive});document.getElementById("capsule").style.display="block";var r=new Ext.Panel({layout:"border",height:Ext.isIE7?670:Ext.isIE?674:Ext.isSafari?695:680,border:false,id:"canvasPanelId",cls:"canvasPanelCls",items:[{xtype:"panel",layout:"fit",overflow:"auto",autoScroll:true,split:false,width:"auto",height:465,cls:"northPanelCls",region:"center",contentEl:Ext.isIE?"capsule":changeFormComponent},{xtype:"panel",layout:"fit",overflow:"auto",border:false,id:"southPanelSI",autoScroll:true,split:true,collapsible:true,collapseMode:"mini",width:"auto",height:Ext.isIE7?275:Ext.isIE?250:245,minHeight:Ext.isIE?170:200,animCollapse:false,region:"south",listeners:{resize:function(A,C,z,y,B){if(typeof(z)=="number"){document.getElementById("detailsDivSI").style.height=z+"px"}var x=document.getElementById("SIIframeID").style.display;if(x!="none"){if(typeof(window.frames.SIIframeID.setSouthPanelHeight)=="function"){window.frames.SIIframeID.setSouthPanelHeight(z)}}},collapse:function(){this.setWidth("auto")}},contentEl:"detailsDivSI"}],listeners:{afterlayout:function(x){x.layout.south.miniSplitEl.dom.qtip=labelDragResizeClickCollapse;x.layout.south.getCollapsedEl();x.layout.south.miniCollapsedEl.dom.qtip=labelClickToExpand},single:true}});var v=new Ext.Viewport({layout:"anchor",width:"auto",id:"viewportId",border:false,cls:"viewportCanvasCls",items:[{anchor:"100%",layout:"fit",items:r}]});ChangeBtnStatus(cilink_record);if(changeId==null||changeId==""){document.getElementById("linkSIAvailTD").style.display="none";document.getElementById("noSIAvailTD").style.display="block"}else{var k=displaySI(cookieName,iFrameSrc);if(!k){if(document.getElementById("noSIAvailTD")!=null){document.getElementById("noSIAvailTD").style.display="none"}if(document.getElementById("linkSIAvailTD")!=null){document.getElementById("linkSIAvailTD").style.display="block"}}}if(isRecordDeleted()){Ext.Msg.alert(Information,labelRecordDeleted,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}changeId=getChangeId();ChangeCloseState=getChangeCloseState();assignMyselfState=getAssignMyselfState();isChangeCreatable=getIsChangeCreatable();isChangeDeletable=getIsChangeDeletable();isChangeUpdateable=getisChangeUpdateable();if(changeId==null||changeId==""){Ext.getCmp("emailId").setDisabled(true);Ext.getCmp("emailId").setIconClass("bmcEmailMessageDisable");document.getElementById("linkSIAvailTD").style.display="none";document.getElementById("noSIAvailTD").style.display="block";Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("copyId").setIconClass("bmcCopyDisable");Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("assignToMyselfButtonId").setDisabled(true);Ext.getCmp("closeButtonId").setDisabled(true);Ext.getCmp("reopenButtonId").setDisabled(true);Ext.getCmp("respondedButtonId").setDisabled(true);if(isChangeCreatable!=null&&isChangeCreatable=="false"){Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("newId").setDisabled(true);Ext.getCmp("assignToStaffButtonId").setDisabled(true);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(true);Ext.getCmp("templateBtnId").setDisabled(true);Ext.getCmp("templateBtnId").setIconClass("bmcTemplateDisable");Ext.getCmp("respondedButtonId").setDisabled(true);Ext.getCmp("assignToQueueButtonId").setDisabled(true)}}else{if(setcheckforTemplate=="true"){if(ChangeCloseState=="false"){Ext.getCmp("templateBtnId").setDisabled(true)}else{Ext.getCmp("templateBtnId").setDisabled(false)}}else{Ext.getCmp("templateBtnId").setDisabled(true)}if(getAssignMyselfState()=="true"){Ext.getCmp("assignToMyselfButtonId").setDisabled(false)}if(getChangeCloseState()=="false"){Ext.getCmp("closeButtonId").setDisabled(true);Ext.getCmp("reopenButtonId").setDisabled(false);Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("assignToMyselfButtonId").setDisabled(true);Ext.getCmp("assignToStaffButtonId").setDisabled(true);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(true);Ext.getCmp("assignToQueueButtonId").setDisabled(true);Ext.getCmp("respondedButtonId").setDisabled(true);Ext.getCmp("emailId").setDisabled(true)}if(getChangeCloseState()=="true"){Ext.getCmp("closeButtonId").setDisabled(false);Ext.getCmp("reopenButtonId").setDisabled(true);Ext.getCmp("saveId").setDisabled(false);Ext.getCmp("respondedButtonId").setDisabled(false);Ext.getCmp("assignToMyselfButtonId").setDisabled(false);Ext.getCmp("assignToStaffButtonId").setDisabled(false);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(false);Ext.getCmp("assignToQueueButtonId").setDisabled(false);Ext.getCmp("emailId").setDisabled(false)}if(isChangeCreatable!=null&&isChangeCreatable=="false"){Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("copyId").setIconClass("bmcCopyDisable");Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("assignToMyselfButtonId").setDisabled(true);Ext.getCmp("closeButtonId").setDisabled(true);Ext.getCmp("reopenButtonId").setDisabled(true);Ext.getCmp("newId").setDisabled(true);Ext.getCmp("assignToStaffButtonId").setDisabled(true);Ext.getCmp("assignToQueueButtonId").setDisabled(true);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(true);Ext.getCmp("respondedButtonId").setDisabled(true);Ext.getCmp("templateBtnId").setDisabled(true)}if(isChangeDeletable!=null&&isChangeDeletable=="true"){Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconClass("bmcDelete")}if(isChangeDeletable!=null&&isChangeDeletable=="false"){Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable")}if(isChangeUpdateable!=null&&isChangeUpdateable=="false"){Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("closeButtonId").setDisabled(true);Ext.getCmp("reopenButtonId").setDisabled(true);Ext.getCmp("assignToStaffButtonId").setDisabled(true);Ext.getCmp("assignToQueueButtonId").setDisabled(true);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(true);Ext.getCmp("assignToMyselfButtonId").setDisabled(true);Ext.getCmp("respondedButtonId").setDisabled(true);Ext.getCmp("templateBtnId").setDisabled(true)}}renderAddNoteButton();if(typeof(getIsCopySaved)=="function"&&getIsCopySaved()=="false"){var d=getChangeInactive();Ext.getCmp("saveId").setDisabled(true);save(d)}var t=getChangeInactive();Ext.getCmp("change_inactive__c").setValue(t);var s=new Date();var l=s.getTime();var i=(l-networklatencystart);data+=labelPM_netwokLatency;data+=networklatency;data+="<br>";data+=labelPM_PageLoad;data+=i;if(window.parent.refreshGridSI!=undefined){window.parent.refreshGridSI(wid,resizeGrid)}var f=getInactiveDisable();if(f){Ext.getCmp("change_inactive__c").setDisabled(f)}var q=document.getElementById(ChangePageComp.ComponentVars.ChatterdAccordionPanelId);if(q!=null){q.title=ChangeChatterFeed;q.childNodes[0].innerHTML=Ext.util.Format.ellipsis(ChangeChatterFeed,42)}ChangeServiceTargetButtonState()});var sendEmailBtnHandler=function(a,b){openPopupWithTitle("ComposeEmailPage?recordId="+getChangeId()+"&isNew=true&objectName=Change_Request__c",composeMailOnCompleteIn,labelMsgPageHeader+changeRequestName,getEmailWinHt(),getEmailWinWidth(),false)};function composeMailOnCompleteIn(){var a=document.getElementById("SIIframeID").style.display;if(window.frames.SIIframeID!=null&&typeof(window.frames.SIIframeID)!="undefined"){if(a!="none"){document.getElementById("SIIframeID").contentWindow.composeMailOnComplete()}}}function preAssignChangeTOQueue(a){waitbox(0);assignChangeTOQueue(a);if(a!=null&&a!="undefined"&&a!=""){handleChange()}}function ChangeServiceTargetButtonState(){if(typeof(Ext.getCmp("servicetargets"))!="undefined"&&Ext.getCmp("servicetargets")!=null){if(!hasServiceTargets){Ext.getCmp("servicetargets").disable()}else{Ext.getCmp("servicetargets").enable()}}}function showInfoPopup(b,a,f){var e="";var g=b.target;if(g==null){g=b.srcElement}if(f=="staff"){var c=getStaffHiddeninput();e=document.getElementById(c).value;tooltipforstaff()}else{if(f=="closeComments"){e=getCloseComments();assignTheCommentValue()}}if(e!=""&&e!=null){var d=new Ext.ToolTip({target:g.id,title:"",anchor:"right",width:200,trackMouse:true,shadow:"sides",bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",dismissDelay:20000,html:document.getElementById(a).innerHTML})}}function closeWindow(){window.parent.refreshList();window.parent.closeTab(wid)}function handleResetChange(){if(clickedOnce){clickedOnce=false;changeDone=false;window.parent.registerSave(wid2)}if(hideCustomFieldAccordion){document.getElementById(ChangePageComp.ComponentVars.customFieldAccordionPanelId).style.display="none"}}function ChangeBtnStatus(a){if(a=="true"){Ext.getCmp("ciExplorerBtn").enable()}else{Ext.getCmp("ciExplorerBtn").disable()}}function ShowCIExplorer(){var c=labelCIExpCIExplorer;var a=escape("CIExplorerLauncher?Module=Change_Request__c&RecordSequence="+changeId+"&id="+changeId);var b="NavigatorPage?title="+c+"&target="+a;window.parent.parent.addNewTab("CIExplorerLauncher",labelConfigurationItemsExplorer,b)}function displayActiveTextArea(d,c){var a=new Array(4);a[0]={btnId:"changeDescriptionBtn",textAreaCompId:changeDescriptionComponent,textLabel:labelChangeDescription};a[1]={btnId:"rolloutPlanBtn",textAreaCompId:rolloutComponent,textLabel:labelRolloutPlan};a[2]={btnId:"reasonForChangeBtn",textAreaCompId:resonforChangeComponent,textLabel:labelReasonForChange};a[3]={btnId:"backoutPlanBtn",textAreaCompId:backoutComponent,textLabel:labelBackoutPlan};activeBtnId=d.id;txtSize=c;for(var b=0;b<a.length;b++){if(activeBtnId==a[b].btnId){activeBtnTitle=a[b].textLabel;activeTextAreaId=a[b].textAreaCompId;document.getElementById(a[b].btnId).style.fontWeight="bold";document.getElementById(a[b].textAreaCompId).style.display="block"}else{document.getElementById(a[b].btnId).style.fontWeight="normal";document.getElementById(a[b].textAreaCompId).style.display="none"}}}function formCSZString(d,c,b){var a="";if(d!=""){a=ellipse(d,33)+", "}if(c!=""){a=a+ellipse(c,33)+" "}if(b!=""){a=a+ellipse(b,33)}return a}function tooltipforstaffJS(f,a,e,c,b,d){strSingleLineText=document.getElementById("userAddressforttdivId").innerHTML.replace(new RegExp("\\n","g")," ");document.getElementById("userAddressforttdivId").innerHTML=ellipse(strSingleLineText,33);document.getElementById("userNameforttdivId").innerHTML=ellipse(f,50);document.getElementById("userTitleforttdivId").innerHTML=ellipse(a,40);document.getElementById("userCSZforttdivId").innerHTML=e;document.getElementById("userCountryforttdivId").innerHTML=ellipse(c,33);document.getElementById("userPhoneforttdivId").innerHTML=ellipse(b,33);document.getElementById("userEmailforttdivId").innerHTML='<a href="'+d+'" class="clsCmdLinkTooltip">'+ellipse(d,33)+"</a>"}function ellipse(b,a){if(b.length>a){return b.substr(0,a-3)+"..."}return b}function updateFieldsOnSave(a){a="#"+a;if(a=="#"){a=ChangeRequestHeader}window.parent.changeTitle(wid,a,a)}function refreshparentList(){window.parent.needsRefresh=true}function getChangeProcBtnHandler(){var a="NavigatorPage?title="+ChangeProcess+"&target=ChangeProcMgmtPage?id=1002";window.parent.parent.addNewTab(ChangeProcess,AlignabilityProcessModel,a,"false")}function writeCookie(){if(document.getElementById("configureSIId").checked){createSICookie(cookieName,"true");var a=displaySI(cookieName,iFrameSrc)}}function changeMenuHandler(e,d,c){if(d!=null&&d!=""){var b=getChangeInactive();Ext.getCmp("change_inactive__c").setValue(b);Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconClass("bmcDelete");Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("copyId").setIconClass("bmcCopy");var a=getInactiveDisable();if(a){Ext.getCmp("change_inactive__c").setDisabled(a);Ext.getCmp("prevId").setDisabled(a);Ext.getCmp("nextId").setDisabled(a)}else{Ext.getCmp("prevId").setDisabled(false);Ext.getCmp("nextId").setDisabled(false)}Ext.getCmp("resetId").setDisabled(false);if(setcheckforTemplate=="true"){Ext.getCmp("templateBtnId").setDisabled(c)}else{Ext.getCmp("templateBtnId").setDisabled(true);Ext.getCmp("templateBtnId").setIconClass("bmcTemplateDisable")}if(e=="true"){Ext.getCmp("assignToMyselfButtonId").setDisabled(false)}else{Ext.getCmp("assignToMyselfButtonId").setDisabled(true)}if(c=="true"){Ext.getCmp("closeButtonId").setDisabled(true);Ext.getCmp("reopenButtonId").setDisabled(false);Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("assignToStaffButtonId").setDisabled(true);Ext.getCmp("assignToQueueButtonId").setDisabled(true);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(true);Ext.getCmp("assignToMyselfButtonId").setDisabled(true);Ext.getCmp("respondedButtonId").setDisabled(true)}else{Ext.getCmp("closeButtonId").setDisabled(false);Ext.getCmp("reopenButtonId").setDisabled(true);Ext.getCmp("respondedButtonId").setDisabled(false);Ext.getCmp("saveId").setDisabled(false)}}else{Ext.getCmp("saveId").setDisabled(false)}}function buttonValidator(){if(changeId!=null&&changeId!=""){Ext.getCmp("emailId").setDisabled(false);Ext.getCmp("emailId").setIconClass("bmcEmailMessage");var a=document.getElementById("SIIframeID").style.display;if(cookieValue=="true"&&a=="none"){SIComp("/apex/SIContainerPage?oid="+changeId+"&otype=Change_Request__c&wid="+wid+"&stateofIncident="+closeState+"&isChangeCreatable="+getIsChangeCreatable()+"&isInactive="+isInactive)}else{if(a=="none"){document.getElementById("noSIAvailTD").style.display="none";if(Ext.isChrome){document.getElementById("onDemandSITableId").style.display="inline-table";document.getElementById("linkSIAvailTD").style.display="table-cell"}else{document.getElementById("onDemandSITableId").style.display="block";document.getElementById("linkSIAvailTD").style.display="block"}}}}}function setAssignedToJS(){if(ownerIdString!=null&&ownerIdString!=""&&ownerIdString!="undefined"){setAssignedTo(ownerIdString)}taboutFlag=false}function renderAddNoteAfterClose_JS(b,c){if(b!=null){b.disabled=true;b.className="clsInputTextAreaDisabledNote";var a=document.getElementById("addNoteBtn");a.disabled=true;a.className="AddButtonOff"}if(c!=null){c.disabled=true;c.className="clsDurationTextBoxDisable"}}function renderAddNoteButton_JS(c,f,d,b){if(c!=null){var a=document.getElementById("addNoteBtn");var e=c.value.trim();if(b==null||b==""||e==null||e==""||d=="false"){a.disabled=true;a.className="AddButtonOff"}else{a.disabled=false;a.className="AddNoteButton"}if(b==null||b==""||d=="false"){c.disabled=true;c.className="clsInputTextAreaDisabledNote";f.disabled=true;f.className="clsDurationTextBoxDisable"}else{if(isNoteEnableFlag){c.value="";isNoteEnableFlag=false}c.disabled=false;c.className="clsInputTextAreaNote";f.disabled=false;f.className="clsDurationTextBox"}}}function validateDuration_JS(e){var d=e.value;if(d!=""){var b=d.split(":");if(b[0].length==1){d="0"+d;e.value=d;durationError=0}var a=/^([0-9]{2}):([0-9]{2})$/;var c=d.match(a);if(c==null){durationError=1;Ext.MessageBox.show({msg:AddNote.Labels.DurationError,buttons:Ext.MessageBox.OK});e.value="00:00"}}}function enableAddNote_JS(){if(errormsg==AddNote.Labels.DurationError){var a=document.getElementById("addNoteBtn");a.disabled=false;a.className="AddNoteButton";var b=document.getElementById(AddNoteComp.ComponentVars.Notes);b.disabled=false;b.className="clsInputTextAreaNote";var c=document.getElementById(AddNoteComp.ComponentVars.Duration);c.disabled=false;c.className="clsDurationTextBox";c.value="00:00"}}function disableAddNote_JS(b,c){validateDuration(c);if(durationError!=1){if(b.length>32000){Ext.MessageBox.show({msg:AddNote.Labels.Note+" : "+AddNote.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK})}else{var a=document.getElementById("addNoteBtn");a.disabled=true;a.className="AddButtonOff";saveNote(b,c)}}durationError=0}function renderNote_JS(){if(errormsg==AddNote.Labels.DurationError){Ext.MessageBox.show({msg:errormsg,buttons:Ext.MessageBox.OK})}else{var a=document.getElementById(AddNoteComp.ComponentVars.Notes);if(a!=null){a.disabled=false;a.className="clsInputTextAreaNote";a.value="";if(insideNote==false){clickedOnce=true;handleResetChange()}}var b=document.getElementById(AddNoteComp.ComponentVars.Duration);if(b!=null){b.disabled=false;b.value="00:00"}}}function afterAddNote(){var a=document.getElementById("SIIframeID").style.display;if(cookieValue!="true"&&(a=="none")){SIComp(iFrameSrc)}else{if(a!="none"){window.frames.SIIframeID.refreshDocs()}}}function handleChange(){if(!clickedOnce){clickedOnce=true;changeDone=true;window.parent.registerChange(wid2)}}function openCategoryPage(a){if(a!=null||a!=""){if(a[0]!=null||a[0]!=""){var b=a[3];categoryName=a[0];if(a[4]!=null&&a!="undefined"){document.getElementById(ChangePageComp.ComponentVars.CategoryFKUrgency).value=a[4]}setCatData(b,categoryName)}}}function showErrorMsgCR(a){Ext.MessageBox.show({msg:a,buttons:Ext.MessageBox.OK})}function ServiceTargetsBtnHandler(a,b){openPopupForServiceTarget("SearchPage?popupId=ChangeRequestServiceTarget&isLookup=true&amp;filterClause="+escape("FKChangeRequest__c='"+changeRequestId+"'"),("#"+changeRequestName+" "+labelServiceTargets))}function preAssignChangeTOStaff(a){waitbox(0);assignChangeTOStaff(a);if(a!=null&&a!="undefined"&&a!=""){handleChange()}}function getCustomActionURL(customId){var changeId=getChangeId();eval(orgNamespace).JSRemoteActions.getCustomActionURL("Change_Request",changeId,customId,function(result,event){if(event.status){if(result!=""&&result!=null){urlStringVar=result;openUrl()}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:true})}function OpenServiceRequest(a){var b=getWID();var d;var c;if(a=="IncidentPage"){d=getServiceRequestId();c=a+escape("?id="+d+"&parentWid="+b+"&isDirect=true&columnField=name&direction=DESC");if(d!=null&&d!="undefined"&&typeof(d)!="undefined"){window.parent.parent.addNewTab(a,labelIncidentPlural,"NavigatorPage?title="+getServiceRequestName()+"&tabTitle="+getServiceRequestName()+"&target="+c)}}}function disableDateField(){var d=window.document.getElementsByTagName("span");for(var c=0;c<d.length;c++){var e=d[c].getAttribute("class");if(e=="dateInput"){var b=d[c].childNodes[0];if(b!=null){var a=b.getAttribute("class");if(a!=null&&a=="clsPanelInputTextboxReadOnly"){b.disabled=true}}}}};