function getUrlParameter(d){d=d.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+d+"=([^&#]*)";var b=new RegExp(c);var a=b.exec(window.location.href);if(a==null){return""}else{return a[1]}}var ExtIframeContainerIdWhatFix="";if(typeof(window.parent.showSelfHelp)!="undefined"&&window.parent.showSelfHelp){ExtIframeContainerIdWhatFix="winId2"}var standardLayout;var wikiUrl;var wikiUrlForList;var wikiUrlForForm;var wikiUrlCategoryManagePage;var popIDs;var isReqDefPage=false;var win,pagetargettocontrolhelp,indexArray=new Array(),titleArray=new Array(),linkArray=new Array(),reverseLinkArray=new Array(),tempIndexWin,counter=0,index=1,windowIndex=0,tabIndex=0,splitIndex=0,win2,tb,skyWindow,splitButton,resTokens,idSet,tabToolTipText,idArray=new Array(),reverseIdArray=new Array(),changeArray=new Array(),refreshGridArray=new Array(),refreshSearchPageToolbar=new Array(),selectedWinId,tabCount=0,xOnMove=0;yOnMove=0;needsRefresh=false;doSubmitForApproval=null;function activateWindow(a){if(a!=null&&a!=""){Ext.getCmp("winId"+a).show()}}function RefreshToolbar(a){refreshSearchPageToolbar[1]=a}function loadingDataToList(){Ext.MessageBox.show({msg:"Loading data, please wait...",progressText:"Loading...",width:300,wait:true,waitConfig:{interval:150}});setTimeout(function(){Ext.MessageBox.hide()},3000)}function refreshGridSI(b,a){refreshGridArray[b]=a}function registerChange(a){changeArray[a]=1}function registerSave(a){changeArray[a]=-1}function getParam(g,f){var e="";if(g.indexOf("?")>-1){var d=g.substr(g.indexOf("?")+1);var a=d.split("&");for(var c=0;c<a.length;c++){var b=a[c].split("=");if(b[0]==f){e=b[1];break}}}return unescape(e)}function refreshList(){if(isReqDefPage==true){var a=window.frames["naviframe"+2];a.pgRefresh()}else{var a=window.frames["naviframe"+1];a.pgRefresh()}}function addQuery(a,b){window.parent.addQueryNode(a,b)}function refreshPage(b){var c=Ext.getCmp("winId"+b);if(c!=null){var a=reverseLinkArray[b];if(a.match(/\?/)){a=a+"&wid="+b}else{a=a+"?wid="+b}Ext.get(c.body.id).update('<iframe name = "naviframe'+b+'" src ="/apex/'+a+'" style="width:100%;height:100%;border:none"/>')}}function refreshPage(c,a){var d=Ext.getCmp("winId"+c);if(d!=null){var b=reverseLinkArray[c];if(b.match(/\?/)){b=b+"&wid="+c}else{b=b+"?wid="+c}if(!(b.match(/\?id=/)||b.match(/\&id=/))){b=b+"&id="+a}Ext.get(d.body.id).update('<iframe name = "naviframe'+c+'" src ="/apex/'+b+'" style="width:100%;height:100%;border:none"/>')}}function listOfId(a){idSet=a}function returnListOfId(){return idSet}function getTitleText(b){var a="";if(b!=null&&b!=""){b=b.replace("%2523","#");if(b.length>11){a=b.substring(0,9)+"..."}else{a=b}}return a}function handleDelet(a){var b=idArray[a];if(typeof(b)!="undefined"&&b!=-1){closeTab(b)}}function closeTab(b){linkArray[reverseLinkArray[b]]=-1;idArray[reverseIdArray[b]]=-1;reverseIdArray[b]=-1;Ext.getCmp("tbId").remove("tabId"+b,true);Ext.getCmp("splitButtonId").menu.remove("splitId"+b,true);Ext.getCmp("tbId").remove("spacerId"+b,true);var a=document.getElementById("winId"+b);a.parentNode.removeChild(a);if(isReqDefPage==true){colorChange(2)}else{colorChange(1)}}function handleMultiDelet(b){var a=new Array();for(var c=0;c<b.length;c++){a.push(idArray[b[c]])}if(typeof(a)!="undefined"&&a!=-1){closeMultiTabs(a)}}function closeMultiTabs(a){var c;for(var b=0;b<a.length;b++){c=a[b];linkArray[reverseLinkArray[c]]=-1;idArray[reverseIdArray[c]]=-1;reverseIdArray[c]=-1;Ext.getCmp("tbId").remove("tabId"+c,true);Ext.getCmp("splitButtonId").menu.remove("splitId"+c,true);Ext.getCmp("tbId").remove("spacerId"+c,true);skyWindow.remove("winId"+c,true)}}function closeTemplateTab(c,b){linkArray[reverseLinkArray[c]]=-1;idArray[reverseIdArray[c]]=-1;reverseIdArray[c]=-1;Ext.getCmp("tbId").remove("tabId"+c,true);Ext.getCmp("splitButtonId").menu.remove("splitId"+c,true);Ext.getCmp("tbId").remove("spacerId"+c,true);var a=document.getElementById("winId"+c);a.parentNode.removeChild(a);var d=document.getElementById("winId"+b);if(d==null||d==undefined){colorChange(1)}else{if(b>=1){colorChange(b)}}}function changeTitle(e,g,d){if(win){win.hide()}var c=skyWindow.findById("winId"+e).getWidth();var f=Ext.util.Format.htmlEncode(g);f=changeHeader(f);var a=f;Ext.getCmp("tabId"+e).setTooltip(Ext.util.Format.htmlDecode(a));titleArray[e]=f;f=getTitleText(f);d=getHeaderTitleText(d,c,e);d=Ext.util.Format.htmlEncode(d);d=changeHeader(d);skyWindow.findById("winId"+e).setTitle(d);Ext.getCmp("splitId"+e).setText(Ext.util.Format.htmlEncode(g));Ext.getCmp("tabId"+e).setText(f);var b=Ext.getCmp("headerTooltip"+e);if(typeof(b)!="undefined"&&b!="undefined"&&b!=null){Ext.getCmp("headerTooltip"+e).title=d}}function setTooltipOnWindowTitle(d,a){var e=Ext.getCmp("winId"+d);var b=e.header;var c=b.child("span:last-child");if(a.search("<div")!=-1){}a=a.split("<div")[0];new Ext.ToolTip({id:"headerTooltip"+d,title:a,target:c.id,trackMouse:true,anchor:"top",anchorOffset:5})}function addStageProgression(j,f){var c=skyWindow.findById("winId"+j);if(c!=null&&typeof(c)!="undefined"){c.stageIndicator=f;var h=skyWindow.findById("winId"+j).title;var a=h.search('<div id="title">');if(a!=-1){var g=h.indexOf('<div id="title">')+16;var b=h.indexOf("</div>");h=h.substring(g,b)}var e=f;var d=skyWindow.findById("winId"+j).getWidth();if(d>=650){e=adjustStageProgressionLabels(d,e);skyWindow.findById("winId"+j).setTitle(setTitleWithStageProgression(h,e));win2.addClass("headerOnRender")}else{skyWindow.findById("winId"+j).setTitle(h)}}}function getHeaderTitleText(e,b,d){var a=e;var c;if(e!=null&&e!=""){if((b<650)||d==1||(b>=650&&(pagetargettocontrolhelp!="INCIDENTPAGE"&&pagetargettocontrolhelp!="INCIDENTPAGECUSTOM"&&pagetargettocontrolhelp!="CHANGEREQUESTPAGE"&&pagetargettocontrolhelp!="CHANGEREQUESTPAGECUSTOM"&&pagetargettocontrolhelp!="PROBLEMPAGE"&&pagetargettocontrolhelp!="TASKPAGECUSTOM"&&pagetargettocontrolhelp!="TASKPAGE"&&pagetargettocontrolhelp!="BROADCASTSPAGE"))){c=(b-110)/11}else{if((b>=650)&&(pagetargettocontrolhelp=="INCIDENTPAGE"||pagetargettocontrolhelp=="CHANGEREQUESTPAGE"||pagetargettocontrolhelp=="INCIDENTPAGECUSTOM"||pagetargettocontrolhelp=="CHANGEREQUESTPAGECUSTOM"||pagetargettocontrolhelp=="PROBLEMPAGE"||pagetargettocontrolhelp=="TASKPAGECUSTOM"||pagetargettocontrolhelp=="TASKPAGE"||pagetargettocontrolhelp=="BROADCASTSPAGE")){c=(b-510)/11}}if(e.length>c){a=e.substring(0,c)+"..."}else{a=e}}return a}function highlightWindow(a){skyWindow.findById("winId"+a).show()}function getId(c){var b=getParam(c,"isCustomActionLink");if(b!=null&&typeof(b)!="undefined"&&b!=""){var a=b.split("~");if(a!=null&&typeof(a)!="undefined"&&a.length>1){return a[1]}}return getParam(c,"id")}function handleSave(a,b){if(typeof(idArray[b])=="undefined"||idArray[b]==a){idArray[reverseIdArray[a]]=-1;idArray[b]=a;reverseIdArray[a]=b;linkArray[reverseLinkArray[a]]=-1}}function updateListWindow(b,c,f,a){if(a==undefined){if(f=="Request Definition"){wid=2}else{wid=1}}else{wid=a}var e=getTitleText(c);Ext.getCmp("tabId"+wid).setText(e);Ext.getCmp("splitId"+wid).setText(e);skyWindow.findById("winId"+wid);var d=skyWindow.findById("winId"+wid);b=b+"&wid="+wid;if(d!=null){linkArray[b]=1;reverseLinkArray[1]=b;d.setTitle(f);Ext.get(d.body.id).update('<iframe name = "naviframe'+wid+'" src ="/apex/'+b+'" style="width:100%;height:100%;border:none"/>')}d.show()}function replaceAll(e,c,d){var a=e;var b=a.indexOf(c);while(b!=-1){a=a.replace(c,d);b=a.indexOf(c)}return a}function changeHeader(a){a=replaceAll(a,"%25","%");a=replaceAll(a,"%23","#");a=replaceAll(a,"%26","&");a=replaceAll(a,"%22",'"');a=replaceAll(a,"%2B","+");a=replaceAll(a,"&amp;","&");a=replaceAll(a,"<","&lt");a=replaceAll(a,">","&gt");return a}function htmlEncode(c,b){if(c!=null){c=c.replace("/script>","")}var d=document.createElement("div");RemedyForceHTMLProcessor.clearHTML(d);d.appendChild(document.createTextNode(c));if(typeof(d.firstChild)!="undefined"&&d.firstChild!=null&&typeof(d.firstChild.nodeValue)!="undefined"&&d.firstChild.nodeValue!=null){var a=Ext.util.Format.htmlDecode(d.firstChild.nodeValue);if(b!=null&&b){a=getTitleText(a)}return Ext.util.Format.htmlEncode(a)}return""}function addTab(c,d,h,f){if(d=="LocationTitle"||h=="LocationTitle"){d=labelLocations;h=labelLocations}else{if(d=="NormalizationRule"||h=="NormalizationRule"){d=labelNormalizationRule;h=labelNormalizationRule}else{if(d=="NormalizationException"||h=="NormalizationException"){d=labelNormalizationException;h=labelNormalizationException}}}tabToolTipText=Ext.util.Format.htmlDecode(d);if(tabToolTipText!=undefined&&tabToolTipText!="undefined"&&tabToolTipText.match("%23")!=-1){tabToolTipText=tabToolTipText.replace("%23","#")}c=unescape(c);var b=getId(c);if(d!=null&&d!="undefined"&&d!=undefined&&d!=""){if(d.match("%23")!=-1){d=d.replace("%23","#")}if(d.match("%20")!=-1){d=d.replace("%20"," ")}}if(h!=null&&h!="undefined"&&h!=undefined&&h!=""){if(h.match("%23")!=-1){h=h.replace("%23","#")}h=h.replace(" #","# ")}d=htmlEncode(d,true);h=htmlEncode(h,false);d=changeHeader(d);h=changeHeader(h);if(c.match(/SelfServiceSettingsCollection/)!=null){h=h+"<div class='clsHeaderLabelInfoToMoveToNewSSUI'>"+lblInfoToMoveToNewSSUI+" <a href='#' onClick=\"window.open('/apex/AdminHomePage?openSSGeneral=true')\" style='color: white !important;'>"+ClickHerelbl+"</a> "+lblInfoToMoveToNewSSUI2+"</div>"}if(c.match("%26")!=-1){c=c.replace("%26","&")}if(c.match("%23")!=-1){c=c.replace("%23","#")}c=unescape(c);if(c.match(/SearchPage/)!=null){standardLayout=getUrlParameter("standardLayout");var a=getUrlParameter("popupId");if(standardLayout=="true"&&a=="Organization%26view=list"){c=c+"&pgheight="+444}else{c=c+"&pgheight="+getClientHeightForList()}}var g=linkArray[c];if(c.indexOf("SuggestedOwnerMapping")>-1&&g=="1"){return}if(typeof(g)!="undefined"&&g!=-1&&typeof(f)!="undefined"&&f==true&&c.match(/\&masterId/)!=null){updateListWindow(c,d,h,g)}else{if(typeof(g)!="undefined"&&g!=-1&&((c.match(/\?id/)!=null||c.match(/\&id/)!=null||c.match(/\&qvId/)!=null||c.match(/\?qvId/)!=null||c.match(/ManagePage/)!=null||c.match(/ManageCategoryIcon/)!=null||c.match(/\&masterId/)!=null))){highlightWindow(g)}else{if(b!=null&&b!=""&&typeof(idArray[b])!="undefined"&&idArray[b]!=-1){highlightWindow(idArray[b]);if(c.indexOf("&reloadWin=true")!=-1){c=c.replace("/apex/","");updateListWindow(c,d,h,idArray[b])}}else{if((b==null||b=="")&&index>1&&skipGettingStarted==null&&(c.match(/SearchPage/)!=null||c.match(/SelfServiceSettingsCollection/)!=null)){updateListWindow(c,d,h)}else{if(typeof(g)!="undefined"&&g!=-1&&(c.match(/\?isPrbLink/)!=null||c.match(/\&isPrbLink/)!=null)){highlightWindow(g)}else{idArray[b]=index;reverseIdArray[index]=b;linkArray[c]=index;reverseLinkArray[index]=c;indexArray[d]=index;titleArray[index]=d;tabCount++;var e=c;if(e.match(/\?/)){e=e+"&wid="+index}else{e=e+"?wid="+index}counter++;tempIndexTab=index++;tb.add({id:"tabId"+tempIndexTab,tooltipType:"title",tooltip:tabToolTipText,text:d,width:70,enableToggle:true,listeners:{toggle:onItemToggle},pressed:true});tb.add({id:"spacerId"+tempIndexTab,xtype:"spacer",width:5});windowIndex=index;splitIndex=tempIndexTab;splitButton.menu.add({id:"splitId"+splitIndex,text:h,checked:false,group:"sBtnItemGroup",handler:onItemCheck});tb.doLayout(true,true);openPanel(e,h)}}}}}}function openPanel(k,g){if(getUrlParameter("fromstdCI")=="true"){if(getUrlParameter("BMC_BaseElementid")!=null&&getUrlParameter("BMC_BaseElementid")!=""){k=k+"&BMC_BaseElementid="+getUrlParameter("BMC_BaseElementid")}else{if(getUrlParameter("id")!=null&&getUrlParameter("id")!=""){k=k+"&id="+getUrlParameter("id")}}}if(getUrlParameter("standardLayout")=="true"){var c=getUrlParameter("target");if(c.indexOf("ChangeSchedule")!=-1){k=k+"&standardLayout=true"}}k=unescape(k);var l=getParam(k,"wid");tempIndexWin=windowIndex-1;splitIndex=tempIndexWin;var f;var b=k.split("?");pagetargettocontrolhelp=b[0];pagetargettocontrolhelp=pagetargettocontrolhelp.toUpperCase();var a="";if(!getParam(k,"isCustomActionLink").match(/\true/)){a="/apex/"}win2=new Ext.Window({id:"winId"+tempIndexWin,title:(pagetargettocontrolhelp=="REQUESTDEFPAGE")?"":g,stageIndicator:"",renderTo:skyWindow.body,constrain:true,width:400,height:300,maximizable:(pagetargettocontrolhelp=="REQUESTDEFPAGE")?false:true,minimizable:(pagetargettocontrolhelp=="REQUESTDEFPAGE")?false:true,resizable:(pagetargettocontrolhelp=="REQUESTDEFPAGE")?false:true,frame:false,border:true,closable:(pagetargettocontrolhelp=="REQUESTDEFPAGE")?false:true,xOnMove:xOnMove,yOnMove:yOnMove,cls:(pagetargettocontrolhelp=="REQUESTDEFPAGE")?"":"headerDefault",tools:[{id:"info",handler:function(){addTab("GettingStartedforSRD?id=thePage",labelGettingStarted,labelGettingStarted)},hidden:(pagetargettocontrolhelp=="REQUESTDEFPAGE")?true:(paramtitle=="Request Definition"&&pagetargettocontrolhelp=="SEARCHPAGE")?false:true},{id:"pm",handler:function(){var m="naviframe"+l;var o=window.frames[m].senddata();if(pagetargettocontrolhelp=="CMDBMANAGER"){o=window.frames[m].CMDBManagerNamespace.instance.showMetrics()}var e=new Array();e=k.split("?");var n=new Ext.QuickTip({target:this,title:"",anchor:"right",width:200,shadow:"sides",bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",dismissDelay:1500000,html:o});n.show()},hidden:(pagetargettocontrolhelp=="REQUESTDEFPAGE")?true:(pagetargettocontrolhelp=="SEARCHPAGE")?true:(pagetargettocontrolhelp=="APPROVALLISTVIEWPAGE")?true:(pagetargettocontrolhelp=="INCIDENTPAGE")?false:(pagetargettocontrolhelp=="TASKPAGE")?false:(pagetargettocontrolhelp=="CMDBMANAGER")?false:(pagetargettocontrolhelp=="CIEXPLORERLAUNCHER")?false:(pagetargettocontrolhelp=="CHANGEASSESSMENTPAGE")?false:(pagetargettocontrolhelp=="CHANGEAPPROVAL")?false:(pagetargettocontrolhelp=="CHANGEREQUESTPAGE")?false:(pagetargettocontrolhelp=="PROBLEMPAGE")?false:(pagetargettocontrolhelp=="INCIDENTPAGECUSTOM")?false:(pagetargettocontrolhelp=="CHANGEREQUESTPAGECUSTOM")?false:(pagetargettocontrolhelp=="TASKPAGECUSTOM")?false:(pagetargettocontrolhelp=="REQUESTDEFPAGE")?false:true},{id:"dpm",handler:function(){},hidden:(pagetargettocontrolhelp!="SEARCHPAGE"||pagetargettocontrolhelp=="REQUESTDEFPAGE")?true:false},{id:"help",handler:function(){var n;if(paramtitle=="Request Definition"){n=window.frames.naviframe2}else{n=window.frames.naviframe1}var p=n.location.pathname;var m=p.split("/");f=m[m.length-1];f=f.toUpperCase();if(f=="SEARCHPAGE"){var o;var e=new Array();e=k.split("?");if(e[0]=="SearchPage"){o="list";wikiUrl=wikiUrlForList}else{o="form";if(e[0]=="ManagePage"&&popIDs=="ManageCategories"){wikiUrl=wikiUrlCategoryManagePage}else{wikiUrl=wikiUrlForForm}}if(wikiUrl!=null&&wikiUrl!=""&&wikiUrl!=undefined&&isNewContextpage()){window.open(wikiUrl,false,"width="+screen.width+",height="+screen.height+",resizable = 1,scrollbars=yes,status=1,top=0,left=0",false)}else{n.showFrameHelp(o)}}else{if(f=="CMDBMANAGER"){window.frames.naviframe1.CMDBManagerNamespace.instance.showHelp()}else{if(f=="APPROVALLISTVIEWPAGE"){var o;var e=new Array();e=k.split("?");e[0]=e[0].toUpperCase();if(e[0]=="APPROVALLISTVIEWPAGE"){o="list"}else{o="form"}window.frames.naviframe1.showFrameHelp(o)}else{if(f=="SUGGESTEDOWNERMAPPING"){if(typeof(wikiUrl)!=undefined&&wikiUrl!=null&&wikiUrl!=""){window.open(wikiUrl,false,"width="+screen.width+",height="+screen.height+",resizable = 1,scrollbars=yes,status=1,top=0,left=0",false)}else{OpenHelppage("suggested_owner","module","form")}}else{if(wikiUrl!=null&&wikiUrl!=""&&wikiUrl!=undefined&&isNewContextpage()){window.open(wikiUrl,false,"width="+screen.width+",height="+screen.height+",resizable = 1,scrollbars=yes,status=1,top=0,left=0",false)}else{n.OpenHelppage()}}}}}},hidden:(pagetargettocontrolhelp=="REQUESTDEFPAGE"||pagetargettocontrolhelp=="GETTINGSTARTEDFORSRD"||pagetargettocontrolhelp=="SLMPROCMGMTPAGE"||pagetargettocontrolhelp=="INCPROCMGMTPAGE"||pagetargettocontrolhelp=="CHANGEPROCMGMTPAGE"||pagetargettocontrolhelp=="PROBLEMPROCMGMTPAGE")?true:false}],defaultButton:"tabId"+tempIndexWin,html:"<iframe "+((ExtIframeContainerIdWhatFix==("winId"+tempIndexWin)&&l>1)?'id="naviframeId"':"")+' name = "naviframe'+l+'" src ="'+k+'" style="width:100%;height:100%;border:none"/>',listeners:{beforeclose:function(e){var o=this.id;var m=o.split("winId");var n=m[1];if(!e.pendingClose&&changeArray[n]!=null&&typeof(changeArray[n])!="undefined"&&changeArray[n]!=-1){Ext.Msg.show({title:labelcloseWindow,msg:labelcloseWindowLabel,buttons:Ext.Msg.YESNO,fn:function(p){if(p=="yes"){e.pendingClose=true;e.close()}},icon:Ext.MessageBox.WARNING});return false}},close:function(){counter--;var t=this.id;if(t==ExtIframeContainerIdWhatFix){ExtIframeContainerIdWhatFix="winId"+(tempIndexWin+1)}var o=t.split("winId");var s=Ext.getCmp("tabId"+o[1]);var n=Ext.getCmp("spacerId"+o[1]);var r=Ext.getCmp("splitButtonId");if(s.xtbHidden==true){tb.getLayout().unhideItem(s)}if(n.xtbHidden==true){tb.getLayout().unhideItem(n)}tb.remove(s,true);tb.remove(n,true);linkArray[reverseLinkArray[o[1]]]=-1;r.menu.remove("splitId"+o[1],true);try{var m="naviframe"+l;var q=window.frames[m].window;q.document.clear();q.location.href="about:blank"}catch(p){}skyWindow.remove(this,true);linkArray[reverseLinkArray[o[1]]]=-1;idArray[reverseIdArray[o[1]]]=-1;reverseIdArray[o[1]]=-1;tabCount--;if(Ext.getCmp("winId1")!=null&&Ext.getCmp("winId1")!="undefined"){Ext.getCmp("winId1").show()}colorChange(1);tb.doLayout(true,true);if(tempIndexWin==1&&pagetargettocontrolhelp!="SEARCHPAGE"){window.parent.CloseActiveTab()}if(tabCount==0&&pagetargettocontrolhelp=="CIEXPLORERLAUNCHER"){window.parent.CloseActiveTab()}try{this.removeAll()}catch(p){}},minimize:function(){this.hide();var e=this.id;var m=e.split("winId");this.setAnimateTarget(this.defaultButton);this.hide();onWindowMinimize(m[1])},maximize:function(){this.focus();db=this.defaultButton;Ext.getCmp(db);this.setAnimateTarget(Ext.getCmp(db));this.removeClass("headerOnRestore");this.addClass("headerOnMaximize");this.addClass("maxHeight");if(this.tools.restore){this.tools.restore.dom.style.display="inline";this.tools.maximize.dom.style.display="none"}for(i=0;i<window.frames.length;i++){if(window.frames[i].frames.myFrame!="undefined"&&window.frames[i].frames.myFrame!=null){window.frames[i].frames.myFrame.height="99%";break}}},restore:function(){this.focus();this.removeClass("headerOnMaximize");this.addClass("headerOnRestore");this.tools.maximize.dom.style.display="inline";this.tools.restore.dom.style.display="none"},resize:function(){tb.doLayout(true,true);var q=this.id;var o=q.split("winId");var e=titleArray[o[1]];var n=getHeaderTitleText(e,this.getWidth(),o[1]);var m=this.stageIndicator;if(m!=""){if(this.getWidth()>=650){m=adjustStageProgressionLabels(this.getWidth(),m);this.setTitle(setTitleWithStageProgression(n,m))}else{this.removeClass("headerOnRender");this.setTitle(n)}}if(document.getElementById("stageprogressbar")!=null){this.addClass("headerOnRender")}else{this.removeClass("headerOnRender")}var o=q.split("winId");var p=o[1];if(refreshGridArray[p]!=null){refreshGridArray[p]()}if(refreshSearchPageToolbar[1]!=null){refreshSearchPageToolbar[1]()}},move:function(){if(isBrowserWindowMaximized()){this.xOnMove=this.x;this.yOnMove=this.y}}}});skyWindow.add(win2);win2.on("activate",function(){var m=this.id;var e=m.split("winId");colorChange(e[1]);this.focus()});if(pagetargettocontrolhelp=="SEARCHPAGE"||pagetargettocontrolhelp=="SUGGESTEDOWNERMAPPING"){win2.tools.close.disabled=true;win2.addClass("closeBtnDisabledCls")}applyToolTipOnWinHeaderBtn();setTooltipOnWindowTitle(tempIndexWin,g);try{win2.show();win2.maximize()}catch(h){win2.maximize();win2.setSize(500,600);win2.minimize();win2.show();win2.on("restore",function(){win2.setSize(400,300);win2.setPosition(200,200)});var j=win2.id;var d=j.split("winId");colorChange(d[1])}}function setWindowPosition(){Ext.WindowMgr.each(function(a){if(a.xOnMove!=0){a.setPosition(a.xOnMove,a.yOnMove)}})}function closeTabsByCount(){if(tabCount!=1){counter--;Ext.getCmp("tbId").remove("tabId"+selectedWinId,true);Ext.getCmp("tbId").remove("spacerId"+selectedWinId,true);linkArray[reverseLinkArray[selectedWinId]]=-1;Ext.getCmp("splitButtonId").menu.remove("splitId"+selectedWinId,true);linkArray[reverseLinkArray[selectedWinId]]=-1;idArray[reverseIdArray[selectedWinId]]=-1;if(selectedWinId!=1){Ext.getCmp("winId"+selectedWinId).close()}else{for(var a=2;a<=index;a++){if(Ext.getCmp("winId"+a)!=null){Ext.getCmp("winId"+selectedWinId).close();Ext.getCmp("winId"+a).show();colorChange(a);break}}}tb.doLayout(true,true)}else{window.parent.setQVTabId()}}function applyToolTipOnWinHeaderBtn(){new Ext.ToolTip({target:win2.tools.close,trackMouse:true,anchor:"top",anchorOffset:10,html:ToolTipClose});new Ext.ToolTip({target:win2.tools.minimize,trackMouse:true,anchor:"top",html:TooltipMinimize});new Ext.ToolTip({target:win2.tools.info,trackMouse:true,anchor:"top",html:labelGettingStarted});new Ext.ToolTip({target:win2.tools.maximize,trackMouse:true,anchor:"top",html:TooltipMaximize});new Ext.ToolTip({target:win2.tools.restore,trackMouse:true,anchor:"top",html:TooltipRestore});new Ext.ToolTip({target:win2.tools.help,trackMouse:true,anchor:"top",html:ToolTipHelp})}function onItemToggle(b,c){if(win){win.hide()}var a=b.id;var d=getModuleName();if(a=="tabId1"&&(d.indexOf(NavTasksLabel)>-1||d.indexOf(NavIncidentsLabel)>-1||d.indexOf(NavChangeAssessmentsLabel)>-1||d.indexOf(NavProblemsLabel)>-1||d.indexOf(NavChangeRequestsLabel)>-1||d.indexOf(NavSLALabel)>-1||d.indexOf(NavChattersLabel)>-1)&&needsRefresh){refreshList();needsRefresh=false}resTokens=a.split("tabId");Ext.getCmp("winId"+resTokens[1]).show();colorChange(resTokens[1])}function onItemCheck(j,h){var b=j.id;resTokens=b.split("splitId");if(j.id=="splitCascadeId"){var g=0;var f=0;for(var c=1;c<=index;c++){if(Ext.getCmp("winId"+c)!=null){if(Ext.getCmp("winId"+c).maximized==true){Ext.getCmp("winId"+c).restore()}Ext.getCmp("winId"+c).setPosition(g,f);Ext.getCmp("winId"+c).show();g=g+40;f=f+50}}}if(j.id=="splitTileId"){var e=skyWindow.getHeight();var d=0;var k=skyWindow.getWidth()/2;if(counter==2){d=e}else{if((counter%2)==0){d=(e/counter)*2}else{d=(e/(counter+1))*2}}var g=0;var f=0;var a=0;for(var c=1;c<=index;c++){if(Ext.getCmp("winId"+c)!=null){if(Ext.getCmp("winId"+c).maximized==true){Ext.getCmp("winId"+c).restore()}Ext.getCmp("winId"+c).setPosition(g,f);Ext.getCmp("winId"+c).setHeight(d);Ext.getCmp("winId"+c).setWidth(k);Ext.getCmp("winId"+c).show();a++;g=g+k+2;if((a%2)==0){g=0;f=f+d+2}}}}if(j.id!="splitTileId"&&j.id!="splitCascadeId"){Ext.getCmp("winId"+resTokens[1]).show()}}function onWindowMinimize(b){if(b!=1&&Ext.getCmp("winId1").hidden==false){Ext.getCmp("winId1").show();colorChange(1)}else{for(var a=2;a<=index;a++){if(Ext.getCmp("winId"+a)!=null&&Ext.getCmp("winId"+a).hidden==false){Ext.getCmp("winId"+a).show();colorChange(a);break}else{if(Ext.getCmp("winId1").hidden==false){colorChange(1)}}}}}function colorChange(e){selectedWinId=e;for(var d=1;d<=index;d++){var a=Ext.getCmp("winId"+d);var b=Ext.getCmp("tabId"+d);var c=Ext.getCmp("splitId"+d);if(a!=null){if(d==e){a.removeClass("headerDefault");a.removeClass("headerLightBlue");a.removeClass("headerBlue");if(pagetargettocontrolhelp=="REQUESTDEFPAGE"&&(e!=2||paramtitle=="Request Definitions")&&e!=1){a.addClass("removeHeader")}else{a.addClass("headerBlue");a.removeClass("removeHeader")}a.show()}else{a.removeClass("headerDefault");a.removeClass("headerBlue");a.removeClass("headerLightBlue ");if(pagetargettocontrolhelp=="REQUESTDEFPAGE"&&(e!=2||paramtitle=="Request Definitions")&&e!=1){a.addClass("removeHeader")}else{a.addClass("headerLightBlue")}}}if(Ext.getCmp("tabId"+d)!=null){if(d==e){b.removeClass("bgGrey");b.removeClass("bgBlue");b.addClass("bgBlue")}else{b.removeClass("bgBlue");b.removeClass("bgGrey");b.addClass("bgGrey")}}if(c!=null){if(d==e){c.setChecked(true)}}}}var firstWindowWidth;Ext.onReady(function(){Ext.override(Ext.Panel,{createToolHandler:function(q,o,r,p){return function(s){q.removeClass(r);s.stopEvent();if(!q.disabled&&o.handler){o.handler.call(o.scope||q,s,q,p)}}}});if(skipGettingStarted==null){skipGettingStarted="false"}var b=getUrlParameter("popupHeader");b=b.replace(/\+/gi," ");document.title=b;var a="98%";var m="auto";var f=Ext.isIE7?730:Ext.isIE8?716:Ext.isSafari?735:720;var j=getUrlParameter("standardLayout");if(j!="true"){try{var c=parent.parent.Ext.getCmp("winId1");if(c){firstWindowWidth=c.getWidth()}}catch(e){var d=parent.Ext.getCmp("winId1");if(d){firstWindowWidth=d.getWidth()}}}if(paramTabName=="SSCategory"||paramTabName=="SSTemplate"||paramTabName=="SSFAQ"){a=firstWindowWidth-50;m=a;if(typeof(parent.parent.Ext.getCmp("winId1"))!="undefined"&&parent.parent.Ext.getCmp("winId1")!=null){parent.parent.Ext.getCmp("winId1").on("resize",setWidthForSelfSetting)}if(firstWindowWidth>800){a=firstWindowWidth-175;m=a}}tb=new Ext.Toolbar({id:"tbId",width:m,height:"35",renderTo:"menubar",cls:"tBarCls"});skyWindow=new Ext.Window({renderTo:"skyWind",baseCls:"sky",width:a,shadow:false,resizable:false,closable:false,height:f,bodyStyle:{"background-color":"#FFFFFF"},listeners:{afterlayout:function(){tb.doLayout();setWindowPosition()}}});splitButton=new Ext.Button({id:"splitButtonId",tooltipType:"title",tooltip:labellayout,enableToggle:false,iconCls:"blist",cls:"splitButtonCls",menu:{cls:"splitMenuCls",items:[{id:"splitCascadeId",text:NavCascade,checked:false,hidden:(paramtitle=="Request Definitions"||paramtitle=="Request Definition")?true:false,group:"sBtnItemGroup",handler:onItemCheck},{id:"splitTileId",text:NavTile,checked:false,hidden:(paramtitle=="Request Definitions"||paramtitle=="Request Definition")?true:false,group:"sBtnItemGroup",handler:onItemCheck},"-"]},listeners:{mouseover:function(){this.setIconClass("blistOn")},mouseout:function(){this.setIconClass("blist")}}});tb.add(splitButton);tb.add({xtype:"spacer",width:2});tb.add("-");tb.add({xtype:"spacer",width:7});tb.doLayout(true,true);var g=document.getElementById("skyWind");if(g){if(Ext.isIE7){g.style.marginTop="375px"}else{if(Ext.isIE){g.style.marginTop="344px"}else{if(Ext.isSafari){g.style.marginTop="353px"}else{g.style.marginTop="345px"}}}}if(paramTabName=="SSCategory"||paramTabName=="SSTemplate"||paramTabName=="SSFAQ"){adjustWindowSizeForSelfServiceSetting()}skyWindow.show();if(paramuseListViewTarget=="true"){var l=window.parent.getPageTarget().split("¬");addTab(l[0],l[1],l[1]);window.parent.setpageTarget(null);skipGettingStarted=null}if(tabTitle!=""){if(j=="true"){if(paramTarget!=null&&paramTarget.indexOf("AppAdmin")!=-1){paramTarget=paramTarget+"&standardLayout=true"}addTab(paramTarget,tabTitle,paramtitle)}else{addTab(paramTarget,tabTitle,paramtitle)}}else{if(j=="true"){if(paramTarget!=null&&paramTarget.indexOf("AppAdmin")!=-1){paramTarget=paramTarget+"&standardLayout=true"}if(paramtitle=="Request Definition"){addTab("GettingStartedforSRD?id=thePage",labelGettingStarted,labelGettingStarted);addTab(paramTarget,paramtitle,paramtitle);if(skipGettingStarted=="false"){highlightWindow("1")}}else{addTab(paramTarget,paramtitle,paramtitle)}}else{if(paramtitle=="Request Definition"){isReqDefPage=true;addTab("GettingStartedforSRD?id=thePage",labelGettingStarted,labelGettingStarted);addTab(paramTarget,paramtitle,paramtitle);if(skipGettingStarted=="false"){highlightWindow("1")}}else{if(paramtitle=="Normalization Rules"&&getUrlParameter("isFromNormExcep")=="true"){var h=decodeURIComponent(getUrlParameter("selectedNormName"));var k=getUrlParameter("SelectedNormRuleID");addTab(paramTarget,paramtitle,paramtitle);addTab("/apex/AdminNormalizationPage?id="+k,h,h)}else{addTab(paramTarget,paramtitle,paramtitle)}}}}skipGettingStarted=null;var n=paramTabName;if(n!=null&&n!=""&&n!="SSFAQ"&&n!="SSCategory"&&n!="SSTemplate"){window.parent.setTabFunctionList(n,addTab)}Ext.QuickTips.init()});function adjustStageProgressionLabels(a,h){var m="";var b="";var d=a-670;var k=0;var g=0;if((d>115)&&(d<271)){k=4}else{if((d>270)&&(d<436)){k=8}else{if((d>435)&&(d<601)){k=12}else{if(d>600){k=16}}}}var l=h.split("</span>");var c=l.length-1;for(var f=0;f<c;f++){var j=l[f].lastIndexOf(">");var e=l[f].substring(j+1,l[f].length);g=e.length+k;if(f==0){b=StageProgression_Opened.substring(0,g)}else{if(f==1){b=StageProgression_Acknowledged.substring(0,g)}else{if(f==2){b=StageProgression_InProcess.substring(0,g)}else{if(f==3){b=StageProgression_Closed.substring(0,g)}}}}m+=l[f].substring(0,j+1)+b+"</span>"}m+=l[4];return m}function setWidthForSelfSetting(){try{if(typeof(parent.parent.Ext.getCmp("winId1"))!="undefined"&&parent.parent.Ext.getCmp("winId1")!=null){firstWindowWidth=parent.parent.Ext.getCmp("winId1").getWidth();skyWindow.setWidth(firstWindowWidth-40);tb.setWidth(firstWindowWidth-40);if(firstWindowWidth>800){skyWindow.setWidth(firstWindowWidth-175);tb.setWidth(firstWindowWidth-175)}skyWindow.doLayout();Ext.WindowMgr.each(function(d){if(d!=null){var b=d.id;var c=b.split("Id");if(c[0]=="win"){d.restore();d.maximize()}}})}}catch(a){}}function adjustWindowSizeForSelfServiceSetting(){var a=document.getElementById("skyWind");try{if(Ext.isIE7){a.style.marginLeft="117px"}else{if(Ext.isIE8){a.style.marginLeft="117px"}else{if(Ext.isSafari){a.style.marginLeft="110px"}else{a.style.marginLeft="110px"}}}if(firstWindowWidth>800){a.style.marginLeft="0px"}}catch(b){}}function handleApprovalSubmission(a,b,c){var f=a.id;var d=f.split("winId");var e=d[1];if(changeArray[e]!=null&&typeof(changeArray[e])!="undefined"&&changeArray[e]!=-1){Ext.Msg.show({title:labelcloseWindow,msg:c,buttons:Ext.Msg.YESNO,fn:function(g){if(g=="yes"){doSubmitForApproval=true;b()}else{if(g=="no"){doSubmitForApproval=false}}},icon:Ext.MessageBox.WARNING});return false}else{b()}};