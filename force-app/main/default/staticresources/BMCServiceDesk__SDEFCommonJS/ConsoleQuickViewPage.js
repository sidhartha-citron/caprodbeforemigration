var priorityArray=new Array();priorityArray["priority1-16.gif"]=1;priorityArray["priority2-16.gif"]=2;priorityArray["priority3-16.gif"]=3;priorityArray["priority4-16.gif"]=4;priorityArray["priority5-16.gif"]=5;priorityArray["priority6-16.gif"]=6;var divIds;var divValue;var divFType;var statusArray=new Array();statusArray["svt-missed.png"]="Missed";statusArray["svt-cancelled.png"]="Cancelled";statusArray["svt-warning.png"]="Warning";statusArray["svt-attached_ok_met.png"]="Met/OK";var consoleObjList=["Incident__c","Task__c","Change_Request__c","Problem__c","Release__c","Broadcasts__c"];var gridStore;var chartViewPanel;var resultSet=new Array();var tableGrid;var isRefreshBtnState=true;var isRefreshBtnPressed="true";var autoRefreshable=true;var isFrstTimeLoad=true;var objectLabelNameList=new Array();var objectLabelNameListIter=0;var newBtnMenu;var pagingBar;var chartDataResultSet,isStaffSelected=false;var PE="П";var isFilterShown=false;var typeAheadResult=new Ext.util.HashMap();var hasQVObjAccessError=false;Ext.Loader.setConfig({enabled:true});function checkboxModelSelection(){Ext.override(Ext.selection.CheckboxModel,{onRowMouseDown:function(b,a,g,d,h){var f=this,c=h.getTarget("."+Ext.baseCSSPrefix+"grid-row-checker"),j;if(!f.allowRightMouseSelection(h)){return}if(f.checkOnly&&!c){return}if(c){j=f.getSelectionMode();if(j!=="SINGLE"){f.setSelectionMode("SIMPLE")}f.selectWithEvent(a,h);f.setSelectionMode(j)}else{f.selectWithEvent(a,h)}}})}Ext.onReady(function(){checkboxModelSelection();if(qvObjAccessError!=null&&qvObjAccessError!=""&&qvObjAccessError!=undefined){hasQVObjAccessError=true}var j=createTopTitlebar();var e=createTopToolbar();var b;if(qvObjAccessError!=null&&qvObjAccessError!=""&&qvObjAccessError!=undefined){b=Ext.create("Ext.Panel",{html:qvObjAccessError});var a=Ext.create("Ext.container.Viewport",{layout:"border",items:[{region:"north",items:[j,e]},{region:"center",layout:"fit",id:"centerRegion",items:b}]});waitMask.hide();return}tableGrid=createTableView();if(!isDashboard){createRecordSelector()}chartViewPanel=createChartView();var l=tableGrid;var g=chartViewPanel;if(viewState=="chartView"){l=chartViewPanel;g=tableGrid}var a=Ext.create("Ext.container.Viewport",{layout:"border",items:[{region:"north",items:[j,e]},{region:"center",layout:"fit",id:"centerRegion",items:l}]});var h=Ext.getCmp("centerRegion");h.add(g);h.doLayout();if(!isObjectNameAvailable){addObjectFieldToFieldsInfoTable()}if(!isOptimized&&isObjectNameAvailable){saveQuickViewData()}waitMask.hide();if(isDashboard){var f=window.parent.customPageSize;if(f=="undefined"||f!=customPageSize){window.parent.setCustomPageSize(customPageSize)}}if(hasRTFilters){createRunTimeFields();var d=createToolTipText();if(isDashboard){var d=createToolTipText();document.getElementById("qvFilterPanel").style.maxWidth="90%";var c=window.parent.Ext.getCmp("filtertool"+widgetId+"-MinPanel");if(c!=null){c.show();c=window.parent.document.getElementById("filtertool"+widgetId+"-MinPanel-toolEl");if(d!=""){c.title=d}}maxFilterIcon=window.parent.document.getElementById("filtertool"+widgetId+"_Max-MaxPanel-toolEl");if(maxFilterIcon!=null){if(d!=""){maxFilterIcon.title=d}}}else{var m=Ext.getCmp("qv-filter-id");if(d!=""){m.setTooltip(d)}}setEncryptedFieldsDisabled()}if(parent.name=="dashboardframe"){var k=parent.Ext.getCmp("viewtool"+widgetId+"-MinPanel");if(k){parent.document.getElementById(k.el.dom.childNodes[0].id).className="sprite sprite-QV_options"}makePanelDisabled()}});Ext.button.Button.prototype.tooltipType="title";Ext.toolbar.Paging.prototype.old_getPagingItems=Ext.toolbar.Paging.prototype.getPagingItems;Ext.toolbar.Paging.prototype.getPagingItems=function(){var b=this;var d=b.old_getPagingItems();for(var a=0;a<d.length;a++){var c=d[a];if(typeof(c)=="object"&&typeof(c.tooltipType)!="undefined"){c.tooltipType="title"}}return d};var paginationTbar=function(){if(isSingleModuleQV){var a=new Ext.PagingToolbar({store:gridStore,displayInfo:true,id:"pagingBar",emptyMsg:_ServerLabels.NoRecordFoundMsg,refreshText:_ServerLabels.PageRefresh,nextText:_ServerLabels.PageNext,firstText:_ServerLabels.PageFirst,lastText:_ServerLabels.PageLast,prevText:_ServerLabels.PagePrevious,beforePageText:_ServerLabels.Page,afterPageText:_ServerLabels.Of,displayMsg:_ServerLabels.Records+" "+getStart()+" - "+getEnd()+" "+_ServerLabels.LabelOf+" "+totalRecords,moveNext:moveNext,movePrevious:movePrevious,moveFirst:moveFirst,moveLast:moveLast,doRefresh:doRefresh,prependButtons:true,listeners:{beforechange:function(e,c,b){waitMask.show();var d=Ext.getCmp("pagingBar").child("#inputItem").getActionEl().dom.value;if(d>parseInt(totalPage)){d=parseInt(totalPage)}if(d<=0){d=1}currentPage=parseInt(d);resetpagingBar();loadTableData(currentPage)}},getPageData:function(){var b={currentPage:parseInt(currentPage),pageCount:parseInt(totalPage),total:parseInt(totalRecords)};return b}})}else{a=new Ext.PagingToolbar({hidden:true})}return a};function createTableView(){Ext.define("QVModel",{extend:"Ext.data.Model",fields:modelfields});Ext.QuickTips.init();gridStore=Ext.create("Ext.data.ArrayStore",{model:"QVModel",data:{result:resultSet,total:totalRecords},pageSize:customPageSize,proxy:{type:"memory",reader:{type:"array",root:"result",totalProperty:"total"}}});if(!Ext.getCmp("delButton").hidden){var b=Ext.create("Ext.selection.CheckboxModel",{checkOnly:true,listeners:{selectionchange:function(g,f){(Ext.getCmp("changeOwnerButton")).setDisabled(!(f.length!=0&&isUpdateable(objectLabelNameList[0][1].toLowerCase())));(Ext.getCmp("delButton")).setDisabled(!(f.length!=0&&isDeletable(objectLabelNameList[0][1].toLowerCase())));if(isDashboard){var e="";if(isNoFilterEnabled){e="sprite sprite-QV_filter"}else{e="sprite sprite-QV_filter_applied"}parent.highlightFocusedPanel(document.getElementById(Ext.getCmp("QVtoolbar").el.dom.childNodes[0].id),e)}}}})}var d=Ext.getBody().getViewSize().width;var a=true;if(d<totalColWidth||(viewState=="chartView"&&isDashboard)){a=false}var c=Ext.create("Ext.grid.Panel",{id:"QVGridPanel",store:gridStore,columns:gridColumns,selModel:b,width:"auto",height:"100%",header:false,border:false,enableColumnHide:false,forceFit:a,viewConfig:{stripeRows:false,getRowClass:function(f){var e=f.get("Id");var h=e.split(",");var g=h[2];return"css"+g.substr(1)}},bbar:paginationTbar(),listeners:{sortchange:function(f,g,h,e){if(isSingleModuleQV==true&&(g.getSortParam()!=sortByField||h!=sortDir)){waitMask.show();sortByField=g.dataIndex;sortDir=h;handleColumnClick(sortByField,sortDir)}},celldblclick:function(f,n,g,j,k,m,l,h){firstColVal=j.raw[0];gerRecordIdFromColumn(firstColVal);if(g!=0){openRFTab(j.raw[0],j.get("Name"))}}}});return c}function ChangeListViewPageRecords(a){customPageSize=a;waitMask.show();changeRecordsPerPage(true,customPageSize)}var PageSizeOptionsData=[{value:10,label:"10"},{value:25,label:"25"},{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"}];function createRecordSelector(){if(isSingleModuleQV){tableGrid.child("[dock=bottom]").add(["->",{text:_ServerLabels.RecordsPerPage,xtype:"label"},Ext.create("Ext.form.ComboBox",{store:Ext.create("Ext.data.Store",{fields:["value","label"],data:PageSizeOptionsData}),queryMode:"local",displayField:"label",valueField:"value",margin:"4 15 4 8",editable:false,forceSelection:true,typeAhead:true,width:60,listeners:{afterrender:function(){this.setValue(parseInt(customPageSize))},change:function(d,c,a,b){if(typeof(a)!="undefined"&&a!=null){waitMask.show();ChangeListViewPageRecords(c)}}}})])}}function createMenuForNewBtn(){var c;if(!isSingleModuleQV){newBtnMenu=new Array();for(var b=0;b<objectLabelNameList.length;b++){if(objectLabelNameList[b][1].toLowerCase()=="incident_service_target__c"||objectLabelNameList[b][1].toLowerCase()=="change_request_service_target__c"||objectLabelNameList[b][1].toLowerCase()=="bmc_businessservice__c"||objectLabelNameList[b][1].toLowerCase()=="bmc_baseelement__c"){continue}var a={text:getObjectLabel(objectLabelNameList[b][1].toLowerCase()),id:"NewBtn-"+objectLabelNameList[b][2],objectName:objectLabelNameList[b][1],hidden:(consoleObjList.indexOf(objectLabelNameList[b][1])==-1),disabled:!isCreateable(objectLabelNameList[b][1].toLowerCase()),handler:function(d){objectName=d.objectName;if(consoleObjList.indexOf(objectName)!=-1){if(isDashboard){window.parent.parent.addTab(null,null,objectName)}else{window.parent.addTab(null,null,objectName)}Ext.get("menuItem").hide()}else{alert("Object is not  Supported......")}}};newBtnMenu.push(a)}c=Ext.create("Ext.menu.Menu",{id:"menuItem",items:newBtnMenu})}return c}var getObjectLabel=function(a){if(a=="incident__c"){return _ServerLabels.Incident}else{if(a=="task__c"){return _ServerLabels.Task}else{if(a=="problem__c"){return _ServerLabels.Problem}else{if(a=="change_request__c"){return _ServerLabels.Change_request}else{if(a=="release__c"){return _ServerLabels.Release}else{if(a=="broadcasts__c"){return _ServerLabels.Broadcast}}}}}}};function createTopToolbar(){var a=Ext.create("Ext.toolbar.Toolbar",{id:"QVtoolbar",border:false,items:[{id:"newButton",text:_ServerLabels.New,menu:createMenuForNewBtn(),tooltip:_ServerLabels.New,hidden:(consoleObjList.indexOf(objectLabelNameList[0][1])==-1),disabled:!isCreateable(objectLabelNameList[0][1].toLowerCase()),objectName:objectLabelNameList[0][1],handler:function(b){if(b.menu==null||b.menu=="undefined"){objectName=b.objectName;if(consoleObjList.indexOf(objectName)!=-1){if(isDashboard){window.parent.parent.addTab(null,null,objectName)}else{window.parent.addTab(null,null,objectName)}}else{alert("Object is not  Supported......")}}}},{xtype:"tbspacer",width:0},{id:"delButton",text:_ServerLabels.Delete,tooltip:_ServerLabels.Delete,disabled:true,hidden:isHideButton(),disabled:true,handler:function(){var c=tableGrid.getSelectionModel().getSelection();var b=_ServerLabels.deleteMsg;Ext.Msg.defaultButton="no";if(c.length>1){b=_ServerLabels.multiDeleteMsg}Ext.Msg.confirm(_ServerLabels.Delete,b,function(f){if(f==="yes"){var h=tableGrid.getSelectionModel().getSelection();var d=[];var j;for(var e=0;e<h.length;e++){var g=h[e].data.Id;g=g.split(",");d.push(g[0]);j=g[5]}waitMask.show();deleteRecord(d.toString(),j)}})}},{xtype:"tbspacer",width:0},{id:"changeOwnerButton",text:_ServerLabels.ChangeOwner,tooltip:_ServerLabels.ChangeOwner,disabled:true,hidden:isHideButton(),handler:function(){staffEleId="";window.open("/apex/SuggestionPage?ownerType=OWNER&parentObjectName="+objectLabelNameList[0][1]+"&fromInciOwnerLkup=true&changeOwner=true",null,"status = 1,height =480, width = 800,left= 100,top=50, resizable = 0,scrollbars=no")}},{xtype:"tbfill"},{xtype:"label",id:"helpIcon",html:'<a href="#" onclick="OpenHelppage();"><img title="'+_ServerLabels.Help+'" height="17" width="17" id="helpConsoleQV" src="'+SDEFStylesPATH+'/SDEFbuttons/b_console_help.png"></a>'},{id:"slidersMenu",iconCls:"d-icon-gear sliderButtonIcon",cls:"rf-view-option sliderButtonPosition",tooltip:_ServerLabels.Views,scale:"medium",bodyBorder:true,buttonAlign:"left",tooltipType:"title",style:{align:"left"},hidden:true,menu:{shadow:false,border:1,style:{borderStyle:"solid"},items:[{xtype:"fieldset",width:350,style:{marginTop:5},layout:{type:"hbox"},border:false,items:[{xtype:"slider",id:"alphaSlider",fieldLabel:"Alpha",value:0,width:270,labelWidth:75,increment:1,minValue:0,maxValue:50,listeners:{change:function(d,e,b,c){QVchart.options.chart.options3d.alpha=parseFloat(e);QVchart.redraw(false);Ext.getCmp("alphaValueLabel").setText(e)}}},{xtype:"tbspacer"},{xtype:"tbspacer"},{xtype:"label",flex:3,id:"alphaValueLabel",html:"0"}]},{xtype:"fieldset",width:350,layout:{type:"hbox"},border:false,items:[{xtype:"slider",id:"betaSlider",fieldLabel:"Beta",value:0,width:270,labelWidth:75,increment:1,minValue:-45,maxValue:45,listeners:{change:function(d,e,b,c){QVchart.options.chart.options3d.beta=parseFloat(e);QVchart.redraw(false);Ext.getCmp("betaValueLabel").setText(e)}}},{xtype:"tbspacer"},{xtype:"tbspacer"},{xtype:"label",flex:3,id:"betaValueLabel",html:"0"}]},{xtype:"fieldset",width:350,layout:{type:"hbox"},border:false,items:[{xtype:"slider",id:"depthSlider",fieldLabel:"Depth",value:0,width:270,labelWidth:75,increment:1,minValue:20,maxValue:100,listeners:{change:function(d,e,b,c){QVchart.options.chart.options3d.depth=parseFloat(e);QVchart.redraw(false);Ext.getCmp("depthValueLabel").setText(e)}}},{xtype:"tbspacer"},{xtype:"tbspacer"},{xtype:"label",flex:3,id:"depthValueLabel",html:"20"}]}],listeners:{hide:function(b,d){var c=Ext.util.Cookies.get(chartSpecsCookie);var e={};if(c){e=JSON.parse(c)}e.alpha=QVchart.options.chart.options3d.alpha;e.beta=QVchart.options.chart.options3d.beta;e.depth=QVchart.options.chart.options3d.depth;c=JSON.stringify(e);document.cookie=chartSpecsCookie+"="+c+";path=/;SameSite=None;Secure;expires="+getRFCookieExpiry()}}}},{xtype:"tbspacer",width:10}]});return a}function isHideButton(){if(isSingleModuleQV){if(consoleObjList.indexOf(objectLabelNameList[0][1])==-1){return true}else{return false}}else{return true}}function createTopTitlebar(){isRefreshBtnPressed=Ext.util.Cookies.get(cookieName+"isPressed");if(isRefreshBtnPressed=="true"){imageCls="auto-refresh-off";isRefreshBtnState=true;autoRefreshable=false;toolTipRefreshBtn=_ServerLabels.toolTipAutoRefreshOFF}else{imageCls="auto-refresh-on";isRefreshBtnState=false;autoRefreshable=true;toolTipRefreshBtn=_ServerLabels.toolTipAutoRefreshON}var b="";var d=Ext.create("Ext.toolbar.Toolbar",{id:"QVtitlebar",cls:"rf-QVtitlebar",border:false,hidden:isDashboard,height:30,items:[{xtype:"label",cls:"rf-qvTitle-lbl",text:qvTitle},"->",{cls:"rf-view-option",iconCls:"sprite sprite-QV_filter",scale:"medium",id:"qv-filter-id",tooltip:_ServerLabels.AdvancedFilter,hidden:!hasRTFilters,handler:function(){if(hasRTFilters&&isFilterShown==false){Ext.fly("qvFilterPanel").show();if(Ext.isIE8){ExpandFilterPanel(true,false)}if(divIds!=""&&divValue!=null&&divFType=="combo"){var f=document.getElementById(divIds);if(typeof(f.value)=="undefined"||f.value==null||f.value==""){if(divValue!=null&&divValue.toLowerCase()=="false"){f.value=false}else{f.value=true}}}isFilterShown=true}else{if(hasRTFilters&&isFilterShown==true){Ext.fly("qvFilterPanel").hide();isFilterShown=false}}}},{id:"qv-view-id",iconCls:"sprite sprite-QV_options",cls:"rf-view-option",tooltip:_ServerLabels.Views,scale:"medium",tooltipType:"title",style:{align:"right"},hidden:hasQVObjAccessError,menu:{items:[{text:_ServerLabels.Table,checked:true,id:"tableViewId",group:"qvRadio",handler:showTableView},{text:_ServerLabels.Chart,checked:false,id:"chartViewId",group:"qvRadio",handler:showChartView},{xtype:"menuseparator"},{xtype:"form",layout:{type:"hbox",align:"center",pack:"center"},border:false,height:35,items:[{xtype:"tbspacer"},{xtype:"label",cls:"rf-refresh-lbl",left:35,text:_ServerLabels.autoRefreshLabel},{xtype:"tbspacer"},{xtype:"button",scale:"large",id:"autoRefreshId",iconCls:imageCls,disabled:false,enableToggle:true,tooltipType:"title",cls:"rf-on-off-btn",tooltip:toolTipRefreshBtn,pressed:isRefreshBtnState,width:52,toggleHandler:function(f,g){if(g){f.setIconCls("auto-refresh-off");Ext.getCmp("intervalLabel").removeCls("rf-interval-lbl");Ext.getCmp("intervalLabel").addClass("rf-interval-lbl-off");Ext.getCmp("refreshInterval").setDisabled(true);Ext.getCmp("applyBtnId").setDisabled(true);f.setTooltip(_ServerLabels.toolTipAutoRefreshOFF);autoRefreshable=false}else{f.setIconCls("auto-refresh-on");Ext.getCmp("intervalLabel").addCls("rf-interval-lbl");Ext.getCmp("intervalLabel").removeCls("rf-interval-lbl-off");Ext.getCmp("refreshInterval").setDisabled(false);Ext.getCmp("applyBtnId").setDisabled(false);f.setTooltip(_ServerLabels.toolTipAutoRefreshON);autoRefreshable=true}}},{xtype:"tbspacer",width:10}]},{xtype:"form",layout:{type:"hbox",align:"center",pack:"center"},border:false,height:30,items:[{xtype:"tbspacer",width:25},{xtype:"label",id:"intervalLabel",name:"intervalLabel",cls:isRefreshBtnState?"rf-interval-lbl-off":"rf-interval-lbl",text:_ServerLabels.intervalMinLabel},{xtype:"tbspacer",width:10},{xtype:"textfield",stripCharsRe:/[^0-9]/g,id:"refreshInterval",cls:"rf-refresh-text",name:"refreshInterval",disabled:isRefreshBtnState,tooltip:toolTipRefreshBtn,maxLength:3,value:10,width:30,listeners:{afterrender:function(){this.nav=Ext.create("Ext.util.KeyNav",this.el,{left:function(f){f.stopPropagation();this.moveLeft(f.ctrlKey)},right:function(f){f.stopPropagation();this.moveRight(f.ctrlKey)}})},change:function(g){var f=this.getValue();if(f!=null&&f.toString().length>3){this.setValue(b)}else{b=f}}}},{xtype:"tbspacer",width:10},{xtype:"button",id:"applyBtnId",cls:"rf-apply-btn",disabled:isRefreshBtnState,text:_ServerLabels.Apply,handler:function(){createCookie();autoRefresh()}},{xtype:"tbspacer",width:10}]},{xtype:"label",id:"refreshed",disabled:true,cls:"rf-last-refreshed-lbl",text:_ServerLabels.lastRefreshedLabel+lastRefreshed}]},handler:function(){}}]});cookieValue=Ext.util.Cookies.get(cookieName);var e=Ext.getCmp("refreshInterval");if(cookieValue!=null&&cookieValue!=""){e.setValue(cookieValue)}else{var a=new Date();var c=new Date(a.getTime()+10*365*24*60*60*1000);document.cookie=cookieName+"="+e.getValue()+";path=/;SameSite=None;Secure;expires="+c.toUTCString()}return d}function createChartView(){var a=Ext.create("Ext.panel.Panel",{layout:"fit",id:"chartViewPanel",minHeight:200,contentEl:"chartView",autoScroll:true,listeners:{resize:function(){if(viewState=="chartView"){renderNewCharts()}else{Ext.getCmp("slidersMenu").hide();Ext.getCmp("helpIcon").removeCls("helpIconCls")}}}});return a}function funcQVDataPanelJS(e,f){rows=e;if(f!=null&&f.length==0){totalRows=0}else{totalRows=parseInt(f)}c=gridColumns.length;resultSet=[];for(var d=0;totalRows>d;d++){if(rows[d]==null){break}for(var c=0;colsSize+1>c;c++){if(rows[d][c]!=null){var b=rows[d][c].dp;var a=rows[d][c].vl;if(resultSet[d]==null){resultSet[d]=new Array(colsSize+1)}resultSet[d][b]=a}}}}function openRFTab(b,d){var c=b.split(",");var a=c[0];var f=c[5];var e="";if(c.length>5){e=c[6]}if(e!=""&&e!=null&&(e=="true"||e==true)){e="ServiceRequest"}else{e="Incident"}if(consoleObjList.indexOf(f)!=-1){if(d){d=RemedyForceHTMLProcessor.htmlDecoder(unescape(d))}if(isDashboard){if(isServiceRequest||(e!=null&&e!="")){window.parent.parent.addTab(a,d,f,null,null,null,e)}else{window.parent.parent.addTab(a,d,f,null,null,null,null)}}else{if(isServiceRequest||(e!=null&&e!="")){window.parent.addTab(a,d,f,null,null,null,e)}else{window.parent.addTab(a,d,f,null,null,null,null)}}}else{if(f!=null&&f.toLowerCase()=="bmc_baseelement__c"){if(isLightningExperience==true){window.open("/one/one.app#/alohaRedirect/apex/"+namespace+"CMDBManager?cmdbRecordId="+a)}else{window.open("/apex/CMDBManager?cmdbRecordId="+a)}}else{window.open("/"+a)}}}function renderChartJS(e,d){d=d+"?ChartNoDataText="+noRecordsDisplayMsg;var c=Ext.getBody().getViewSize().width-30;var b=Ext.getBody().getViewSize().height;if(e==""||e=="<graph></graph>"){e="<graph></graph>";b=200}var a=new FusionCharts(d,"myChartId",c,b,"0","1");a.setDataXML(e);a.setTransparent(true);a.render("chartView")}function ReloadForm(){if(viewState=="tableView"){chartViewPanel.hide();Ext.getCmp("slidersMenu").hide();Ext.getCmp("helpIcon").removeCls("helpIconCls");tableGrid.show();Ext.define("QVModel",{extend:"Ext.data.Model",fields:modelfields});gridStore=Ext.create("Ext.data.ArrayStore",{model:"QVModel",data:{result:resultSet,total:totalRecords},pageSize:customPageSize,sorters:{property:sortByField,direction:sortDir},proxy:{type:"memory",reader:{type:"array",root:"result",totalProperty:"total"}}});tableGrid.reconfigure(gridStore,gridColumns);bbar=Ext.getCmp("pagingBar");if(bbar!=null&&typeof(bbar)!="undefined"){bbar.bindStore(gridStore,true);resetpagingBar()}}else{tableGrid.hide();chartViewPanel.show();chartViewPanel.doComponentLayout()}Ext.getCmp("refreshed").setText(_ServerLabels.lastRefreshedLabel+lastRefreshed);if(isDashboard&&window.parent!=null){var a=window.parent.Ext.getCmp("refreshed");if(a!=null){a.setText(_ServerLabels.lastRefreshedLabel+lastRefreshed)}}waitMask.hide()}var showTableView=function(a,b){waitMask.show();if(b!="undefined"){loadResultSet("tableView",false)}};var showChartView=function(a,b){waitMask.show();Ext.getCmp("changeOwnerButton").setDisabled(true);Ext.getCmp("delButton").setDisabled(true);chartViewPanel.show();chartViewPanel.doComponentLayout();if(b!="undefined"){loadResultSet("chartView",false)}};function renderColumnStyle(m,p,c,b,j,e,h){var f=h.ownerCt.columns[j].isWrappable;var g=h.ownerCt.columns[j].isHTMLFormatted;var k=h.ownerCt.columns[j].isCalculated;var d=h.getHeaderAtIndex(j);var r=d.dataIndex;var n=d.dataType.toUpperCase();var l=n=="DATE"?dateOnlyFormat:dateFormat;var o=d.isFirstCol;var a;if(f==true){p.style="white-space:normal !important;"}var q=c.get("Id");if(n.indexOf("DATE")!=-1){m=m.replace("&nbsp;"," ");if(Ext.isDate(Ext.Date.parseDate(m,"Y-m-d H:i:s"))){m=Ext.Date.parseDate(m,"Y-m-d H:i:s");m=Ext.util.Format.date(m,l);a=m}}if(r.match("Priority_ID__c")||r.match("Priority__c")){if(priorityArray[m]==null||priorityArray[m]==""){a=Ext.util.Format.htmlEncode(m)}else{a='<span class="clsImageA" ><img src="'+SDEFStylesPATH+"/SDEFimages/"+Ext.util.Format.htmlEncode(m)+'"> </span>'}}else{if(r.match("Status__c")){if(statusArray[m]==null||statusArray[m]==""){a=Ext.util.Format.htmlEncode(m)}else{a='<span class="clsImageA" ><img src="'+SDEFStylesPATH+"/SDEFicons/"+Ext.util.Format.htmlEncode(m)+'"> </span>'}}else{if(g){a=m}else{a=Ext.util.Format.htmlEncode(m)}}}if(o){var s=c.get("Name");gerRecordIdFromColumn(q);a=Ext.util.Format.htmlDecode(a.replace(/&nbsp;/g," "));return"<a onclick=\"openRFTab('"+q+"', '"+escape(s)+'\')" style="color:black;" href="#">'+a+"</a>"}return Ext.util.Format.htmlDecode(a.replace(/&nbsp;/g," "))}function autoRefresh(){if(autoRefreshable&&!isFrstTimeLoad){waitMask.show();loadResultSet(viewState,false)}isFrstTimeLoad=false;var a=Ext.util.Cookies.get(cookieName);if(a!=null&&a!=""&&a!=0&&a!="0"){t=setTimeout(autoRefresh,a*60000)}}window.onload=autoRefresh;function createCookie(){var c=Ext.getCmp("refreshInterval");if(c.getValue()==null||c.getValue()==""){c.setValue(0)}var a=new Date();var b=new Date(a.getTime()+10*365*24*60*60*1000);document.cookie=cookieName+"="+c.getValue()+";path=/;SameSite=None;Secure;expires="+b.toUTCString();document.cookie=cookieName+"isPressed="+Ext.getCmp("autoRefreshId").pressed+";path=/;SameSite=None;Secure;expires="+b.toUTCString()}function CreateNewRecord(){if(prefix!=null&&prefix!=""){window.open("/"+prefix+"/e")}}var RecordId;function gerRecordIdFromColumn(a){var b=a.split(",");RecordId=b[0]}function reloadGrid(){gridStore.loadData(resultSet);tableGrid.doLayout();waitMask.hide()}function isCreateable(b){if(b.toLowerCase()=="incident_service_target__c"||b.toLowerCase()=="change_request_service_target__c"||b.toLowerCase()=="bmc_businessservice__c"||b.toLowerCase()=="bmc_baseelement__c"||b.toLowerCase()=="change_assessment__c"){return false}objs=createAccessDeniedObjs.split(nonPrint);for(var a=0;a<objs.length;a++){if(objs[a]==b){return false}}return true}function isDeletable(b){if(b.toLowerCase()=="incident_service_target__c"||b.toLowerCase()=="change_request_service_target__c"||b.toLowerCase()=="bmc_businessservice__c"||b.toLowerCase()=="bmc_baseelement__c"||b.toLowerCase()=="change_assessment__c"){return false}objs=deletableAccessDeniedObjs.split(nonPrint);for(var a=0;a<objs.length;a++){if(objs[a]==b){return false}}return true}function isUpdateable(b){if(b.toLowerCase()=="incident_service_target__c"||b.toLowerCase()=="change_request_service_target__c"||b.toLowerCase()=="bmc_businessservice__c"||b.toLowerCase()=="bmc_baseelement__c"||b.toLowerCase()=="change_assessment__c"){return false}objs=updateAccessDeniedObjs.split(nonPrint);for(var a=0;a<objs.length;a++){if(objs[a]==b){return false}}return true}function assignOwnerfields(c,e,k,f){if(staffEleId!=""){try{var o=document.getElementById(staffEleId+"_lkname");var b=document.getElementById(staffEleId+"_lkid");if(c!=null&&c!=""){o.value=e;b.value=c}else{o.value=f;b.value=k}}catch(g){}staffEleId=""}else{waitMask.show();var d=null,n=null,j=null;if(typeof(k)!="undefined"&&k!=null&&k!=""){n=k}if(typeof(c)!="undefined"&&c!=null&&c!=""){j=c}if(n==null&&j==null){alert("ERROR -- Owner not found ")}var m=tableGrid.getSelectionModel().getSelection();var l=[];for(var h=0;h<m.length;h++){var a=m[h].data.Id;var p=a.split(",");if(p[0]!=""){l.push(p[0])}}ChangeOwnerOfRecords_Remote(l,n,j)}}function ChangeOwnerOfRecords_Remote(c,b,a){Visualforce.remoting.Manager.invokeAction(_RemotingActions.ChangeOwnerStaffNQueue,objectLabelNameList[0][1],c,b,a,function(d,e){if(typeof(d.ExceptionMessage)!="undefined"||d.ExceptionMessage!=null){Ext.Msg.show({msg:d.ExceptionMessage,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}loadTableData(currentPage)},{escape:true})}function resetpagingBar(){pagingBar=Ext.getCmp("pagingBar");pagingBar.displayMsg=_ServerLabels.Records+" "+getStart()+" - "+getEnd()+" "+_ServerLabels.LabelOf+" "+totalRecords;pagingBar.onLoad()}function moveNext(){waitMask.show();currentPage++;resetpagingBar();loadTableData(currentPage)}function movePrevious(){waitMask.show();currentPage--;resetpagingBar();loadTableData(currentPage)}function moveFirst(){waitMask.show();currentPage=1;resetpagingBar();loadTableData(currentPage)}function moveLast(){waitMask.show();currentPage=totalPage;resetpagingBar();loadTableData(currentPage)}function doRefresh(){waitMask.show();resetpagingBar();loadTableData(currentPage)}function getLastRefreshedTime(){return _ServerLabels.lastRefreshedLabel+lastRefreshed}function getStart(){if(currentPage==null||currentPage=="undefined"){currentPage=1}if(customPageSize==null||customPageSize=="undefined"){customPageSize=1}var a=(currentPage*customPageSize)-(customPageSize-1);if(a<0){a=1}return a}function getEnd(){if(currentPage==null||currentPage=="undefined"){currentPage=1}if(customPageSize==null||customPageSize=="undefined"){customPageSize=1}if(totalRecords==null||totalRecords=="undefined"){totalRecords=1}var a=currentPage*customPageSize;if(a>totalRecords){a=totalRecords}if(a<0){a=1}return a}function showChartPopup(){Ext.define("chartModel",{extend:"Ext.data.Model",fields:modelfields});var b=Ext.create("Ext.data.ArrayStore",{model:"chartModel",data:chartDataResultSet});var c=Ext.create("Ext.grid.Panel",{id:"QVChartGridPanel",store:b,columns:gridColumns,width:"auto",height:"200",viewConfig:{stripeRows:false,getRowClass:function(e){var d=e.get("Id");var g=d.split(",");var f=g[2];return"css"+f.substr(1)}},listeners:{itemdblclick:function(f,j,g,k,h){var d=j.raw[0];gerRecordIdFromColumn(d);openRFTab(j.raw[0],j.get("Name"))}}});var a=Ext.getCmp("chartPopupWin");if(a!=null){a.removeAll();a.add(c);a.show()}}function funcWholePageJS(a,b){if(a!=null&&(a).length==0){colsSize=0}else{colsSize=parseInt(a)}if(b!=null&&(b).length==0){totalRows=0}else{totalRows=parseInt(b)}}function PopulateChartGroupRowDataArray(e){var b=new Array(colsSize);chartDataResultSet=resultSet;var c=new Array();for(var d=0;resultSet.length>d;d++){var a=e.split(PE);if(a=chartDataResultSet[d][0].split(",")[5]){c[d]=chartDataResultSet[d][0].split(",")[0]}}}function strEndsWith(b,a){return b.indexOf(a,b.length-a.length)!==-1}function chartEventHandler(j){waitMask.show();var h=j.replace(/\\/g,"\\\\");h=h.replace(/'/g,"\\'");h=h.replace(nonPrint+"lt;","&lt;","g");h=h.replace(nonPrint+"gt;","&gt;","g");j=j.replace(nonPrint+"lt;","&amp;lt;","g");j=j.replace(nonPrint+"gt;","&amp;gt;","g");loadChartPopupData(true,h);var l=j.split(PE);var e,c;if(strEndsWith(l[0],"__c")){e=l[0].substring(0,(l[0].length-3))}else{e=l[0]}if(strEndsWith(l[1],"__c")){c=l[1].substring(0,(l[1].length-3))}else{c=l[1]}var m;if(l[3]==":"){m=e+"."+c+"="+_ServerLabels.missingValue}else{m=e+"."+c+"="+l[3]}m=escapeSpecialChars(m);var k=Ext.getCmp("chartPopupWin");var f,d;if(isDashboard){var g=window.parent.Ext.getCmp("centerportal");if(g!=null&&g!=undefined&&widgetId!=""){f=g.getComponent(widgetId);f.header.mask()}var b=window.parent.Ext.getCmp("MaxPanel");if(b!=null&&b!=undefined&&widgetId!=""){d=b.getComponent(widgetId);if(d!=null&&d!=undefined&&widgetId!=""){d.header.mask()}}}if(k==null){var a=Ext.create("Ext.window.Window",{id:"chartPopupWin",height:250,width:300,title:m,modal:true,constrain:true,viewConfig:{forceFit:true},layout:"fit",closeAction:"hide",listeners:{beforeclose:function(n){if(isDashboard){if(f!=null&&f!=undefined){f.header.unmask()}if(d!=null&&d!=undefined){d.header.unmask()}}}}})}else{k.setTitle(m)}}function escapeSpecialChars(a){a=a.replace("<","&lt;","g");a=a.replace(">","&gt;","g");return a}Ext.fly(document.body).on("click",function(c){var b=Ext.fly(c.getTarget());if(isFilterShown==true&&!b.findParent("div#qvFilterPanel")&&!b.findParent("div#autocompleteDiv")&&c.getTarget().id.indexOf("qv-filter-id-")==-1&&!b.findParent("[id^=datepicker-]")&&!b.findParent("[id^=monthpicker-]")){if(Ext.get("qvFilterPanel").isVisible()){Ext.fly("qvFilterPanel").hide();isFilterShown=false}}if(parent.name=="dashboardframe"&&!parent.isPanelMaximized){var a="";if(isNoFilterEnabled){a="sprite sprite-QV_filter"}else{a="sprite sprite-QV_filter_applied"}parent.highlightFocusedPanel(b,a)}});function showRunTimeFilter(){if(hasRTFilters&&isFilterShown==false){var a=document.getElementById("qvFilterPanel");a.style.top="0px";Ext.fly("qvFilterPanel").show();isFilterShown=true;if(Ext.isIE8){ExpandFilterPanel(isSingleRow,false)}}else{if(hasRTFilters&&isFilterShown==true){Ext.fly("qvFilterPanel").hide();isFilterShown=false}}}function checkType(b,c){if(c=="number"||c=="double"||c=="phone"){var a=(b.which)?b.which:b.keyCode;if(a>31&&(a<48||a>57)){return false}return true}}var emptyVal=false;var isLookupError=false;var filterStr="";var rtfString="";var errorLabelList="";var isNoFilterEnabled=true;function isRunTimeFilterVisible(){return Ext.get("qvFilterPanel").isVisible()}function createToolTipText(p){var w,q=0;filterStr="";rtfString="";emptyVal=false;var o="";isNoFilterEnabled=true;var a=["<",">","<=",">="];var m="";while(filterInfo.length>q){var x=filterInfo[q].queryCondId;var n;var h="";var f=false;var k="";var g=filterInfo[q].operator;var b=document.getElementById(x+"_isChecked").checked;if(filterInfo[q].type.toLowerCase()=="lookup"){validateLookupInput(x);var e=document.getElementById(x+"_lkid");if(e!=null){var d=document.getElementById(x+"_lkname").value;if(d.trim()!=""){n=e.value+""}else{n=""}h=filterInfo[q].extraInfo.split(",")[1];f=true;w=d}}else{if(filterInfo[q].type=="date"||filterInfo[q].type=="datetime"){var e=Ext.getCmp(x+"_date");if(e!=null&&e!=undefined){var r=e.getValue();var j=false;if(filterInfo[q].type=="datetime"&&typeof(p)!="undefined"&&p!=null&&p==true&&isOptimized==true&&filterInfo[q].hasInitialvalue=="true"&&(filterInfo[q].operator=="<="||filterInfo[q].operator==">")){j=true}if(r!=null&&r!=""){if(typeof(filterInfo[q].value)=="object"){n=ConvertUTCtoGMT(r.toUTCString(),j)}else{n=ConvertUTCtoGMT(r+"",j)}}else{if(r==null||r=="null"||r==""){n="null"}}if(b==true&&n=="null"&&a.indexOf(g)!=-1){if(m==null||m==""||m=="undefined"){m=filterInfo[q].label}else{m=m+", "+filterInfo[q].label}emptyVal=true}}}else{if(filterInfo[q].type=="picklist"){var e=document.getElementById(x+"_pick");if(e!=null){n=e.value+"";h=filterInfo[q].extraInfo.split(",")[1]}}else{if(filterInfo[q].type=="combo"){var e=document.getElementById(x);if(e!=null&&(e.options[e.selectedIndex]!=undefined||e.options[e.selectedIndex]!=null)){n=e.options[e.selectedIndex].value}if(e.options[e.selectedIndex]==undefined||e.options[e.selectedIndex].value=="null"||e.options[e.selectedIndex].value==null){n="null"}if(n=="null"){b=false}}else{if(filterInfo[q].type=="text"||filterInfo[q].type=="textarea"||filterInfo[q].type=="number"||filterInfo[q].type=="phone"||filterInfo[q].type=="double"||filterInfo[q].type=="EMAIL"||filterInfo[q].type=="CURRENCY"||filterInfo[q].type=="PERCENT"||filterInfo[q].type=="URL"){var e=document.getElementById(x);if(e!=null){n=e.value+""}if(e.value=="null"||e.value==""||e.value==null){n="null"}if(b==true&&n=="null"&&a.indexOf(g)!=-1){if(m==null||m==""||m=="undefined"){m=filterInfo[q].label}else{m=m+", "+filterInfo[q].label}emptyVal=true}}else{n=filterInfo[q].value+"";if(filterInfo[q].value=="null"||filterInfo[q].value==""||filterInfo[q].value==null){n="null"}}}}}}k=filterInfo[q].extraInfo.split(",")[3];if((k.toLowerCase()=="ownerid"||k.toLowerCase()=="fkopenby__c"||k.toLowerCase()=="fkstaff__c")&&filterInfo[q].type=="ASSIGNEDTO_FIELD"){var e=document.getElementById(x);if(e!=null&&e.options[e.selectedIndex]!=null&&e.options[e.selectedIndex]!="undefined"){n=e.options[e.selectedIndex].value}if(n!="Me"&&n!="My Queues"){validateLookupInput(x);var l=document.getElementById(x+"_lkid");n=l.value+"";h=filterInfo[q].extraInfo.split(",")[1];f=true;w=document.getElementById(x+"_lkname").value}else{w=n}}filterStr=filterStr+x+"¬"+n+"¬"+h+"¬"+f+"¬"+k+"¬"+b+"¬"+PE;if(filterInfo[q].type!="lookUp"&&filterInfo[q].type.toUpperCase()!="ASSIGNEDTO_FIELD"){w=n}if(w==""){w="null"}rtfString=rtfString+x+"¬"+n+"¬"+w+"¬"+b+PE;if(b){isNoFilterEnabled=false}var v;if(b){if(o==""){o=filterInfo[q].label+" "+filterInfo[q].operator+" "+w}else{if(v!=""&&v=="1"){o=o+" "+_ServerLabels.SLM_AND}else{if(v!=""&&v=="0"){o=o+" "+_ServerLabels.OR}}o=o+" "+filterInfo[q].label+" "+filterInfo[q].operator+" "+w}}v=filterInfo[q].groupingOperator;q++}var u=Ext.getCmp("qv-filter-id");u.setIconCls("sprite sprite-QV_filter_applied");if(isNoFilterEnabled){o=_ServerLabels.NoFilterApplied;u.setIconCls("sprite sprite-QV_filter")}if(isDashboard){var c=parent.Ext.getCmp("filtertool"+widgetId+"-MinPanel");var s=parent.Ext.getCmp("filtertool"+widgetId+"_Max-MaxPanel");if(isNoFilterEnabled){if(c){parent.document.getElementById(c.el.dom.childNodes[0].id).className="sprite sprite-QV_filter"}if(s){parent.document.getElementById(s.el.dom.childNodes[0].id).className="sprite sprite-QV_filter"}}else{if(c){parent.document.getElementById(c.el.dom.childNodes[0].id).className="sprite sprite-QV_filter_applied"}if(s){parent.document.getElementById(s.el.dom.childNodes[0].id).className="sprite sprite-QV_filter_applied"}}}if(emptyVal){_ServerLabels.ValidationForOperator=_ServerLabels.ValidationForOperator.replace("{0}",m);errorLabelList=m}return o}function validateLookupInput(c){isLookupError=false;var h=document.getElementById(c+"_isChecked").checked;if(h){var g=false;var d;if(typeAheadResult.containsKey(c)){d=typeAheadResult.get(c).reultArray.length}else{d=-1}if(d==0){typeAheadResult.get(c).isLookupError=true}else{if(d>0){var e=document.getElementById(c+"_lkname").value;if(e==""){var b=document.getElementById(c+"_lkid").value;if(b!=""){document.getElementById(c+"_lkid").value="null"}}else{for(var a=0;a<d;a++){var f=typeAheadResult.get(c).isQueue;if(f&&typeAheadResult.get(c).reultArray[a]["Queue"]["Name"].toLowerCase()==e.toLowerCase()){document.getElementById(c+"_lkname").value=typeAheadResult.get(c).reultArray[a]["Queue"]["Name"];document.getElementById(c+"_lkid").value=typeAheadResult.get(c).reultArray[a]["QueueId"];g=true;break}else{if(!f&&typeAheadResult.get(c).reultArray[a]["Name"].toLowerCase()==e.toLowerCase()){document.getElementById(c+"_lkname").value=typeAheadResult.get(c).reultArray[a]["Name"];document.getElementById(c+"_lkid").value=typeAheadResult.get(c).reultArray[a]["Id"];g=true;break}}}if(!g){typeAheadResult.get(c).isLookupError=true}else{typeAheadResult.get(c).isLookupError=false}}}}}typeAheadResult.each(function(j,l,k){h=document.getElementById(j+"_isChecked").checked;if(l.isLookupError==true&&h){isLookupError=true;document.getElementById(j+"_lkid").value=""}});if(isLookupError==true){document.getElementById("filterErrorPanel").style.display="block";return}else{document.getElementById("filterErrorPanel").style.display="none"}}function runTimeSearchHandler(){var d=true;var c=createToolTipText(d);var b=false;if(emptyVal){if(Ext.isGecko){document.getElementById("filterErrorPanelOperator").textContent=_ServerLabels.ValidationForOperator}else{document.getElementById("filterErrorPanelOperator").innerText=_ServerLabels.ValidationForOperator}document.getElementById("filterErrorPanelOperator").style.display="block";_ServerLabels.ValidationForOperator=_ServerLabels.ValidationForOperator.replace(errorLabelList,"{0}");b=true}else{document.getElementById("filterErrorPanelOperator").style.display="none"}if(isLookupError==true){document.getElementById("filterErrorPanel").style.display="block";b=true}if(b){return}try{waitMask.show();document.getElementById("filterErrorPanel").style.display="none";document.getElementById("filterErrorPanelOperator").style.display="none";if(isDashboard){loadRunTimeFilter(filterStr,rtfString,false);var h=window.parent.document.getElementById("filtertool"+widgetId+"-MinPanel-toolEl");if(h!=null){h.title=c}var a=window.parent.document.getElementById("filtertool"+widgetId+"_Max-MaxPanel-toolEl");if(a!=null){a.title=c}}else{loadRunTimeFilter(filterStr,null,false);var g=Ext.getCmp("qv-filter-id");g.setTooltip(c)}}catch(f){}}var staffEleId="";function openOwnerLookupPopUP(e,b){staffEleId=e;var h=b.split(",");var f=h[1];var c=f.split("__");if(c.length==3){f=c[1]+"__c"}else{f=c[0]+"__c"}var k="STAFF";var n=document.getElementById(e);if(n!=null){var j=n.options[n.selectedIndex].value;if(j=="SelectQueue"){k="QUEUE"}}var a=parseInt((screen.availWidth/2)-(670/2));var d=parseInt((screen.availHeight/2)-(480/2));var m=670;var g=480;var l="width="+m+",height="+g+",status=1,resizable=1,scrollbars=no,left="+a+",top="+d;window.open("/apex/SuggestionPage?parentObjectName="+f+"&fromInciOwnerLkup=true&ownerType="+k,"lkpopup",l)}function openLookupPopUP(c,a){var o=document.getElementById(c+"_isChecked");if(o.checked){staffEleId=c;var k=a.split(",");var h=k[1];var n=k[0];var b=parseInt((screen.availWidth/2)-(1000/2));var g=parseInt((screen.availHeight/2)-(600/2));var m=1000;var j=600;var l="width="+m+",height="+j+",status=1,resizable=1,scrollbars=no,left="+b+",top="+g;var e="";var d=k[3];var f=h.split("__");if(f.length==3){h=f[1]+"__c"}else{h=f[0]+"__c"}if((d.toLowerCase()=="ownerid"||d.toLowerCase()=="fkopenby__c"||d.toLowerCase()=="fkstaff__c")){e="staffusers"}else{e=getFilterId(n,h)}if(isSystemQVForQue){window.open("/apex/SuggestionPage?parentObjectName="+h+"&fromInciOwnerLkup=true&ownerType=QUEUE","lkpopup",l)}else{window.open("/apex/SearchAndLink?isFromQV=true&parentName="+h+"&childName="+n+"&isLookUp="+n+"&txt="+c+"&filterId="+e,"lkpopup",l)}}else{return}}function setLookUpField(b,a,c){try{document.getElementById(b+"_lkname").value=c;document.getElementById(b+"_lkid").value=a;if(typeAheadResult.containsKey(b)){typeAheadResult.removeAtKey(b)}}catch(d){}}function createRunTimeFields(){for(i=0;i<filterInfo.length;i++){if(filterInfo[i].type=="date"||filterInfo[i].type=="datetime"){var b=filterInfo[i].queryCondId;var d=filterInfo[i].isFilterEnabled;var c=filterInfo[i].value;c=Ext.util.Format.date(filterInfo[i].value,dateFormat);Ext.create("Ext.form.Panel",{renderTo:b+"_datefield",width:170,height:22,title:"Dates",border:false,header:false,items:[{xtype:"datefield",id:b+"_date",anchor:"100%",height:22,format:dateFormat,name:"from_date",value:c,disabled:(d=="false")?true:false,fieldCls:(d=="false")?"rf-date-Disabled":"rf-date-Enabled",listeners:{disable:function(f,e){f.setFieldStyle("background-color: #eeeee0;background-image:none;")},enable:function(f,e){f.setFieldStyle("background-Color:white;background-image:none;")}}}]})}else{if(filterInfo[i].type=="lookUp"||(filterInfo[i].type=="ASSIGNEDTO_FIELD"&&filterInfo[i].value!="Me"&&filterInfo[i].value!="My Queues")){var b=filterInfo[i].queryCondId;var a=document.getElementById(b+"_lkid");if(a!=null){a.value=filterInfo[i].extraInfo.split(",")[2]}}}}}function ConvertUTCtoGMT(p,h){var b=new Array(13);var j=new Array(7);b[0]="Jan";b[1]="Feb";b[2]="Mar";b[3]="Apr";b[4]="May";b[5]="Jun";b[6]="Jul";b[7]="Aug";b[8]="Sep";b[9]="Oct";b[10]="Nov";b[11]="Dec";j[0]="Sun";j[1]="Mon";j[2]="Tue";j[3]="Wed";j[4]="Thu";j[5]="Fri";j[6]="Sat";var e=new Date(p);if(typeof(h)!=undefined&&h!=null&&h==true){e.setDate(e.getDate()+1)}var k=b[e.getMonth()];var a=e.getDate();var n=j[e.getDay()];var l=e.getYear();var g=e.getHours();if(g<=9){g="0"+g}var f=e.getMinutes();if(f<=9){f="0"+f}var c=e.getSeconds();if(c<=9){c="0"+c}var m=e.getTimezoneOffset();var d;var q;if(m<0){d=Math.floor(-m/60);q=-m%60;m="+"+d+q+""}else{d=Math.floor(m/60);q=m%60;m="-"+d+q+""}if(l<2000){l=l+1900}var o=n+" "+k+" "+a+" "+l+" "+g+":"+f+":"+c+" GMT"+m;return o}function loadPickList(d,b,c){var f=d.split(",");var a=f[1].split("__");var e;if(a.length==3){e=a[1]+"__c"}else{e=a[0]+"__c"}populatePickListCombo(e+"."+f[3],b,c)}function populatePickListCombo(g,b,f){var a=document.getElementById(b+"_pick");var e;var c=0;e=document.createElement("option");e.text="";e.value=null;a.add(e);e.selected=true;for(var d=0;d<pickListData.length;d++){if(pickListData[d][2].toUpperCase()==g.toUpperCase()){pickListArray[c]=pickListData[d];e=document.createElement("option");e.text=pickListData[d][1];e.value=pickListData[d][0];a.add(e);if(pickListData[d][1]==f){e.selected=true}c=c+1}}}function onOwnerChange(f){var g=f.options[f.selectedIndex].value;var e=f.id+"_lkname";var d=document.getElementById(f.id+"_lktable");var b=document.getElementById(f.id+"_lktd");var h=document.getElementById(e);var a=document.getElementById(f.id);var c=document.getElementById("qvFilterPanel");if(g!="None"&&g!="Me"&&g!="My Queues"){c.style.maxWidth="65%";if(isDashboard){c.style.maxWidth="90%";h.style.width="110px";a.style.width="110px"}b.style.display="inline";h.value="";isStaffSelected=true;if(Ext.isIE8){ExpandFilterPanel(isSingleRow,true)}}else{c.style.maxWidth="65%";if(isDashboard){c.style.maxWidth="90%"}h.style.width="170px";a.style.width="170px";b.style.display="none";isStaffSelected=false;if(Ext.isIE8){ExpandFilterPanel(isSingleRow,false)}}}function setSelectedValue(c,h,l,d){if(l=="combo"){divIds=c;divValue=h;divFType=l;var j=document.getElementById(c);if(h.toLowerCase()=="false"){j.selectedIndex=1}}var e=document.getElementById(c);if(typeof(e)!=null&&typeof(e)!="undefined"){if(l=="ASSIGNEDTO_FIELD"&&h!=""&&h!="Me"&&h!="My Queues"){var b=d.split(",")[0];var g=document.getElementById("qvFilterPanel");var k=document.getElementById(c+"_lktable");var f=document.getElementById(c+"_lktd");var a=document.getElementById(c+"_lkid");if(g!=null&&k!=null&&f!=null&&a!=null){k.style.width="400px";f.style.display="inline";a.value=d.split(",")[2];if(Ext.isIE8){isStaffSelected=true}}if(b.toLowerCase()=="user"){e.value="SelectStaff"}else{if(b.toLowerCase()=="queue"){e.value="SelectQueue"}}}else{if(h!=""){if(h.toLowerCase()=="true"||h.toLowerCase()=="false"){e.value=h.toLowerCase()}else{e.value=h}}}}}var qvObject="",selectClientId=0,isAutocomplete=false;function fetchTypeAheadData(c,h,a,g){var m=a.split(",");var j=m[0];var f=m[1].split("__");var d;if(f.length==3){d=f[1]+"__c"}else{d=f[0]+"__c"}lkupObject=j;var p="Id,Name";var l="Name ";var o="";var e=m[3];var b="";if((e.toLowerCase()=="ownerid"||e.toLowerCase()=="fkopenby__c"||e.toLowerCase()=="fkstaff__c")){o="IsStaffUser__c=true AND isActive=true ";var n=document.getElementById(h);if(n!=null){var k=n.options[n.selectedIndex].value;if(k=="SelectQueue"){b="QUEUE"+PE+m[1];lkupObject="QueueSobject"}}else{if(isSystemQVForQue){b="QUEUE"+PE+m[1];lkupObject="QueueSobject"}}}else{o=getFilterCondition(lkupObject,d)}Visualforce.remoting.Manager.invokeAction(_RemotingActions.getLookUpData,j,c.value,o,p,l,b,function(s,w){var r=document.getElementById("autocompleteDiv");r.style.display="block";var v=setDivPosition(c);r.style.left=v[0]+0+"px";r.style.top=v[1]+18+"px";if(j=="User"){if(s.length==1){var u=s[0].Id;var q=s[0].Username;clientfields(u,q)}}findAutoOption(s,"selectAutoOptions","autocompleteDiv",c,g)},{escape:false})}function findAutoOption(o,p,k,e,l){var m=e.id.split("_lkname");m=m[0];resultSetCategory=o;var b=new Object();b.reultArray=resultSetCategory;b.isLookupError=false;b.emptyVal=false;if(lkupObject=="QueueSobject"){b.isQueue=true}else{b.isQueue=false}if(resultSetCategory!=null){typeAheadResult.add(m,b)}if(resultSetCategory==null){return}var a=document.getElementById(p);var f=document.getElementById(k);isAutocomplete=false;try{iKeyCodeEvt=l.keyCode||l.which||l.keyChar||""}catch(u){iKeyCodeEvt=""}currentField=e;if(iKeyCodeEvt!=""&&iKeyCodeEvt!=undefined&&iKeyCodeEvt==13){SelectAutoValue(a,k);return}var x="";var r=resultSetCategory.length;a.options.length=0;if(e.value.length>0){var w=null;var j=0;var h=0;for(var q=0;q<resultSetCategory.length;q++){document.getElementById(k).style.visibility="visible";w=document.createElement("option");var n,v;if(lkupObject=="BMC_BusinessService__c"&&qvObject=="Incident__c"){n=resultSetCategory[q][orgNamespace+"FKBMC_BaseElement__r"].Name;v=resultSetCategory[q][orgNamespace+"FKBMC_BaseElement__r"].Id}else{n=resultSetCategory[q].Name;v=resultSetCategory[q].Id}w.setAttribute("id",v);if(lkupObject=="QueueSobject"){n=resultSetCategory[q].Queue.Name;v=resultSetCategory[q].QueueId;w.setAttribute("id",v);w.setAttribute("value",n);w.setAttribute("title",n);w.appendChild(document.createTextNode(n));x=n}else{if(lkupObject=="User"){w.setAttribute("value",resultSetCategory[q].Username);w.setAttribute("title",resultSetCategory[q].Username+" ("+n+" )");w.appendChild(document.createTextNode(resultSetCategory[q].Username+" ("+n+" )"));x=document.createTextNode(resultSetCategory[q].Username+" ("+n+" )")}else{w.setAttribute("value",n);w.setAttribute("title",n);w.appendChild(document.createTextNode(n));x=n}}a.appendChild(w);if(h<x.length){h=x.length}j++}if(a.options.length>0){var s;var d;h=(h*6)+20;if(navigator.userAgent.toLowerCase().indexOf("msie")>-1){s=(j*13)+2+"px";if(navigator.userAgent.toLowerCase().indexOf("msie 7")>-1){s=(j*15)+4+"px"}if(h<204){d=171+"px"}else{d="auto !important"}}else{s=(j*13)+5+"px";if(h<204){d=171+"px"}else{d="auto !important"}}a.setAttribute("style","height: "+s+"; width: "+d)}else{a.style.height="0px";h=0;document.getElementById(k).style.visibility="hidden"}}else{h=0;document.getElementById(k).style.visibility="hidden"}if((a.selectedIndex==-1||a.selectedIndex==0)&&j>selectClientId){a.selectedIndex=selectClientId}else{a.selectedIndex=0}if(window.document.body!=null&&typeof(window.document.body)!="undefined"){var g=f.style.left.substring(0,f.style.left.length-2);var d=a.style.width.substring(0,a.style.width.length-2);if(window.document.body.clientWidth<parseInt(g)+parseInt(d)){var c=window.document.body.clientWidth-d-10;f.style.left=c+"px"}}switch(iKeyCodeEvt){case 38:if(selectClientId>0){a.selectedIndex=selectClientId-1}selectClientId--;break;case 40:if(selectClientId<a.options.length-1){a.selectedIndex++;selectClientId++}else{a.selectedIndex=selectClientId}break;case 13:currentField=e;SelectAutoValue(a,k);break}}function getFilterCondition(b,c){b=b.toLowerCase();c=c.toLowerCase();if(b=="impact__c"||b=="priority__C"||b=="urgency__c"||b=="account"||b=="category__c"){return escape("Inactive__c = false")}else{if(b=="broadcasts__c"||b=="task__c"||b=="incident__c"||b=="release__c"||b=="change_request__c"||b=="problem__c"){return escape("Inactive__c = false AND state__c = true")}else{if(b=="status__c"){if(c=="incident__c"){return escape("Inactive__c = false and appliesToIncident__c = true")}else{if(c=="task__c"){return escape("Inactive__c = false and appliesToTask__c = true")}else{if(c=="problem__c"){return escape("Inactive__c = false and appliesToProblem__c = true")}else{if(c=="change_request__c"){return escape("Inactive__c = false and appliesToChange__c = true")}else{if(c=="release__c"){return escape("Inactive__c = false and appliesToRelease__c = true")}else{if(c=="broadcasts__c"){return escape("inactive__c = false and appliesToBroadcasts__c = true")}}}}}}}else{if(b=="systemplate__c"){var a="";if(c.toLowerCase()=="incident__c"||c.toLowerCase()=="incident"){a="Incident"}else{if(c.toLowerCase()=="task__c"||c.toLowerCase()=="task"){a="Task"}else{if(c.toLowerCase()=="change_request__c"||c.toLowerCase()=="change request"){a="Change Request"}else{if(c.toLowerCase()=="release__c"||c.toLowerCase()=="release"){a="Release"}else{if(c.toLowerCase()=="srm_processtemplate__c"||c.toLowerCase()=="process template"){a="Request Detail"}}}}}return escape("Inactive__c = false and templateFor__c ='"+a+"' and systemTemplate__c = false")}else{if(b=="user"){return escape("IsActive = true")}else{return""}}}}}}function getFilterId(a,b){a=a.toLowerCase();b=b.toLowerCase();if(a=="impact__c"||a=="priority__C"||a=="urgency__c"||a=="account"||a=="category__c"){return escape("active_custom")}else{if(a=="broadcasts__c"||a=="task__c"||a=="incident__c"||a=="release__c"||a=="change_request__c"||a=="problem__c"){return escape("active_custom")+"&addlFilterId=open_custom"}else{if(a=="status__c"){if(b=="Incident"){return escape("active_custom")+"&addlFilterId=status_in"}else{if(b=="Task"){return escape("active_custom")+"&addlFilterId=status_ta"}else{if(b=="Problem"){return escape("active_custom")+"&addlFilterId=status_pr"}else{if(b=="Change Console"){return escape("active_custom")+"&addlFilterId=status_cr"}else{if(b=="Release"){return escape("active_custom")+"&addlFilterId=status_rm"}else{if(b=="broadcasts__c"){return escape("active_custom")+"&addlFilterId=status_br"}}}}}}}else{if(a=="systemplate__c"){return escape("active_custom")+"&addlFilterId="+getObjectCode(b)}else{if(a=="user"){return escape("active_standard")}else{return""}}}}}}function getObjectCode(a){if(a=="incident__c"||a=="incident"){return"temp_in"}else{if(a=="task__c"||a=="task"){return"temp_ta"}else{if(a=="problem__c"||a=="problem"){return"temp_pr"}else{if(a=="change_request__c"||a=="change request"){return"temp_cr"}else{if(a=="release__c"||a=="release"){return"temp_rm"}else{if(a=="broadcast__c"||a=="broadcast"){return"temp_br"}else{if(a=="srm_processtemplate__c"||a=="process template"){return"temp_rd"}}}}}}}}function setDivPosition(d){var c=[d.offsetLeft,d.offsetTop];var b;while(d.offsetParent!=null){var a=d.offsetParent;c[0]+=a.offsetLeft-a.scrollLeft;b=a.offsetTop-a.scrollTop;if(b<0){b=0}c[1]+=b;d=a}return c}function SelectAutoValue(e,k){var j=e.selectedIndex;var g="";var h=resultSetCategory.length;var c="";if(j>-1){g=e.options[j];for(var f=0;f<resultSetCategory.length;f++){var l=resultSetCategory[f].Name;var b=resultSetCategory[f].Id;if(lkupObject=="QueueSobject"){l=resultSetCategory[f].Queue.Name;b=resultSetCategory[f].QueueId}if(l==g.value){currentField.value=l;var d=currentField.id.split("_lkname");var a=d[0]+"_lkid";if(a!=null&&a!="undefined"){document.getElementById(a).value=b}}}}isLookupError=false;document.getElementById("filterErrorPanel").style.display="none";isAutocomplete=false;document.getElementById(k).style.visibility="hidden"}function disableDiv(a,d,b){var e=b.id.split("_lkname");var c=e[0];validateLookupInput(c);if(!isAutocomplete){document.getElementById(a).style.visibility="hidden"}}function OpenHelppage(){var a="helpfile.htm";if(wikiUrl!=null&&wikiUrl!=undefined&&wikiUrl!=""){window.open(wikiUrl,false,"width="+screen.width+",height="+screen.height+",resizable = 1,scrollbars=yes,status=1,top=0,left=0",false)}else{window.open(helpResource+"/"+a,false,"width="+screen.width+",height="+screen.height+",resizable = 1,scrollbars=no,status=1,top=0,left=0",false)}}function ExpandFilterPanel(a,c){var d=window.parent.Ext.getCmp("MaxPanel");var b=document.getElementById("qvFilterPanel");var e;if(d!=null&&d!=undefined&&widgetId!=""){e=d.getComponent(widgetId)}if(a||(e!=null&&e!=undefined)){if(c||isStaffSelected){b.style.left="40%"}else{b.style.left="60%"}}}function makePanelDisabled(){var c=parent.getUrlParameter(window.location.href,"qvCount");if(c!=""&&c.length>0){if(c.indexOf("#")>-1){c=c.substring(0,c.length-1)}if(parent.previousVisitedPanel!=widgetId&&c!="0"){parent.previousVisitedPanel="";var a=parent.Ext.getCmp("filtertool"+widgetId+"-MinPanel");if(a){if(isNoFilterEnabled){parent.document.getElementById(a.el.dom.childNodes[0].id).className="sprite sprite-QV_filter_disabled"}else{parent.document.getElementById(a.el.dom.childNodes[0].id).className="sprite sprite-QV_filter_applied_disabled"}}var b=parent.Ext.getCmp("viewtool"+widgetId+"-MinPanel");if(b){parent.document.getElementById(b.el.dom.childNodes[0].id).className="sprite sprite-QV_options_disabled "}}}}function setChkBoxTooltip(b,g){var h=document.getElementById(b+"_isChecked");var j=document.getElementById(b+"_displayLabel");var d=document.getElementById(b+"_operator");var e=document.getElementById(b);var c;if(g=="lookUp"){e=document.getElementById(b+"_lkname")}else{if(g=="picklist"){e=document.getElementById(b+"_pick")}else{if(g=="date"||g=="datetime"){var a=Ext.getCmp(b+"_date");e=a}else{if(g=="ASSIGNEDTO_FIELD"){var f=document.getElementById(b);c=document.getElementById(b+"_lkname")}}}}if(h.checked){j.className="rf-filter-lbl";d.className="rf-filter-operator";e.className="rf-input-text";if(g=="date"||g=="datetime"){e.setDisabled(false)}else{if(g=="ASSIGNEDTO_FIELD"){e.disabled=false;c.className="rf-input-text"}else{if(g=="combo"||g=="picklist"){e.disabled=false}else{e.readOnly=false}}}}else{j.className="rf-filter-lbl-Disabled";d.className="rf-filter-operator-Disabled";e.className="rf-input-text-Disabled";if(g=="date"||g=="datetime"){e.setDisabled(true)}else{if(g=="ASSIGNEDTO_FIELD"){e.disabled=true;c.className="rf-input-text-Disabled"}else{if(g=="combo"||g=="picklist"){e.disabled=true}else{e.readOnly=true}}}}}function setChkBoxValue(g,f,d){var h=document.getElementById(g+"_isChecked");var c=document.getElementById(g+"_displayLabel");var e=document.getElementById(g+"_operator");var b=document.getElementById(g);var a;if(d=="lookUp"){b=document.getElementById(g+"_lkname")}else{if(d=="picklist"){b=document.getElementById(g+"_pick")}else{if(d=="ASSIGNEDTO_FIELD"){a=document.getElementById(g+"_lkname")}}}if(f=="true"){h.checked=true;c.className="rf-filter-lbl";e.className="rf-filter-operator";b.className="rf-input-text";if(d!="date"||d!="datetime"){if(d=="ASSIGNEDTO_FIELD"){b.disabled=false;a.className="rf-input-text"}else{if(d=="combo"||d=="picklist"){b.disabled=false}else{b.readOnly=false}}}}}function ShowMessage(b,a){if(a!=null&&a!=""){Ext.Msg.show({title:b,msg:a,icon:Ext.MessageBox.INFO,frame:false,buttons:Ext.Msg.OK})}}function setEncryptedFieldsDisabled(){for(var a=0;a<encryptedFieldIds.length;a++){var b=document.getElementById(encryptedFieldIds[a]+"_isChecked");b.checked=false;b.disabled=true;b.onchange()}};