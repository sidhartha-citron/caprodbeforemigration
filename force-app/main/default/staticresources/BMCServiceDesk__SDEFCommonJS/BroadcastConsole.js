var initialRecordState="";var lastModifiedByLocking="";var BroadcastName=BroadcastConsolePage.Labels.New;var LabelNew=BroadcastConsolePage.Labels.New_Broadcast;var tabName=BroadcastConsolePage.Labels.RM+": "+BroadcastConsolePage.Labels.New;var recordState="";var isRecordLock="";var status="";var desc="";var isDeleted=false;var disableActionBtn=false;var isNeedToRefreshBroadcast=false;var isNeedToRefreshRelatedList=false;var isFocusOnBroadcastForm=true;var isFocusOnRelatedList=false;var isNewBroadcastForm=false;var isNeedToRefreshBroadcastList=false;var waitMsgBar="";var isBroadcastFormFrameLoaded=true;var isBroadcastRelatedListFrameLoaded=true;var clickedOnce=false;var isSaveForSingleConsole=true;var isSAVE=false;var isNewRecordLock=false;var saveFromQuickClose=false;var screenWidth=671;var screenHeight=400;var ServiceTargetsBtnHandlerWindow;var SconsoletabName="";var BRTooltipName="";var isOptionalItemsAdded=false;var viewActionHistoryBtnHandler;var cloneBtnHandler;var ReopenBtnHandler;var CloseBtnHandler;var addNoteHandler;var newActionHandler;var knowledgeSearchBtnHandler;var submitforapprovalHandler;function screenLeft(a){return parseInt((screen.availWidth/2)-(a/2))}function screenTop(a){return parseInt((screen.availHeight/2)-(screenHeight/2))}var left=screenLeft();var top=screenTop();var functionArray=new Array();function setBroadcastData(a){functionArray[0]=a}function saveBroadcast(a){functionArray[1]=a}function reopen(){if(verifyChange()){handleSave()}Visualforce.remoting.Manager.invokeAction(_RemotingActions.reopen,recordId,function(a,b){if(b.type==="exception"){Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:b.message,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});stopWaitMsgBar()}else{stopWaitMsgBar();if(isFocusOnBroadcastForm){loadBroadcastDetail(recordId)}if(isFocusOnRelatedList){loadBroadcastDetail(recordId);loadBroadcastRelatedList(recordId)}isNeedToRefreshRelatedList=true;isNeedToRefreshBroadcastList=true}},{escape:true})}function LoadHandlerForActionItem(){var c;newActionHandler=function(e,f){c=window.open("/apex/searchPage?popupId=Action&isLookup=true&objectType=BroadcastHistory__c&isCalledFromConsole=true&enableSelfClosing=false&standardLayout=true&parentId="+recordId+"&filterClause=appliesToBroadcasts__c%3Dtrue%20and%20system__c%3Dfalse","newAction","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=no");if(c.focus){c.focus()}};var a;addNoteHandler=function(e,f){if(!a||a.closed){a=window.open("/apex/stdlayoutbroadcastaddnotepage?id="+recordId+"&fromconsole=true","addNote","width=600,height=400,resizable = 0,scrollbars=no,status=1,top=350,left=350");console.log("record id for new note"+recordId)}if(a.focus){a.focus()}};var b;CloseBtnHandler=function(f,g){if(verifyChange()){Ext.Msg.defaultButton=1;Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:BroadcastConsolePage.Labels.closeConfirmMsg,buttons:Ext.Msg.OK,buttonText:{ok:ConsoleCommonLabels.Labels.ServiceTargetsOK},icon:Ext.MessageBox.INFO})}else{screenHeight=440;screenWidth=871;var i=new Object;i.isNeedToRefreshRelatedList=isNeedToRefreshRelatedList;i.loadBroadcastDetail=loadBroadcastDetail;i.startWaitMsgBar=startWaitMsgBar;i.refreshBroadcast=refreshBroadcast;i.isNeedToRefreshChangeList=i;var e="dialogWidth:"+screenWidth+"px;dialogHeight:"+screenHeight+"px;status;resizable;scrollbars:no;center:yes;dialogLeft:"+screenLeft(screenWidth)+"px;;dialogTop:"+screenTop(screenHeight)+"px;";var h=window.location.hash=!!window.MSInputMethodContext;if(!b||b.closed){if(window.showModalDialog&&(Ext.isIE||h)){b=window.showModalDialog("/apex/BroadcastClosePage?broadcastId="+recordId+"&calledFrom=rfconsole&isLookup=true",i,e)}else{e="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=yes,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);b=window.open("/apex/BroadcastClosePage?broadcastId="+recordId+"&calledFrom=rfconsole&isLookup=true","_Blank",e)}}if(b!=""&&typeof(b)!="undefined"&&b.focus){b.focus()}}};ReopenBtnHandler=function(e,f){startWaitMsgBar();reopen()};cloneBtnHandler=function(e,f){var g=window.location.hash=!!window.MSInputMethodContext;if(Ext.isIE||g){hideMenu()}if(isServiceCloudConsole=="true"){sforce.console.openPrimaryTab(null,broadcastConsole+"&record_id="+recordId+"&isCloneRequest=true&isServiceCloudConsole=true&ran="+new Date().getTime(),true,BroadcastConsolePage.Labels.New);return false}else{if(isRFConsoleDetailForm=="true"){window.parent.addTab(recordId,"","Broadcasts__c",true)}else{if(verifyChange()){var h=cloneBtnHandler;showCloseWarning(h,null)}else{isCloneRequest="true";startWaitMsgBar();loadBroadcastDetail(recordId)}}}};var d;viewActionHistoryBtnHandler=function(e,f){screenWidth=671;screenHeight=400;c=window.open("/apex/ViewAllActions?ObjectId="+recordId+"&objectName=Broadcast&recordState="+recordState+"&recordName="+BroadcastName,"actionHistory","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=yes");if(c.focus){c.focus()}}}var openInVar="";var customActionJsonString="";var urlStringVar="";var custionActionObj="";function customActionHandler(a){openInVar=a.openIn;custionActionObj=a;getCustomActionURL(a.id)}function openUrl(){if(openInVar.indexOf("Remedyforce")!=-1){window.parent.parent.addNewTab(custionActionObj.id,customActionHeaderLabel,"NavigatorPage?title="+custionActionObj.encodedText+"&isCustomActionLink=true&target="+urlStringVar)}else{if(openInVar.toLowerCase().indexOf("window")!=-1){var a="resizable=1,scrollbars=1,fullscreen=1,toolbar=1,menubar=1,location=1,height="+screen.height+",width="+screen.width+",top = 0,left = 0";window.open(urlStringVar,"",a)}else{window.open(urlStringVar)}}}function getCustomActionURL(customId){var incId=recordId;eval(orgNamespace).JSRemoteActions.getCustomActionURL("Broadcast",incId,customId,function(result,event){if(event.status){if(result!=""&&result!=null){urlStringVar=result;openUrl()}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:false})}function getDetailViewActionMenu(){if(ActionMenuItem=="-"){ActionMenuItem=""}var a=false;if(recordId==null||recordId==""||recordId=="new"){a=true}return Ext.create("Ext.menu.Menu",{id:"mainMenu",baseCls:"bmc-menu",shadow:false,items:ActionMenuItem})}function getDetailVeiwToolBar(){var c=function(d,e){if(isRFConsoleDetailForm=="true"){window.parent.addTab(null,"","Broadcasts__c")}else{if(isServiceCloudConsole=="true"){sforce.console.openPrimaryTab(null,broadcastConsole+"&record_id=&isServiceCloudConsole=true&ran="+new Date().getTime(),true,BroadcastConsolePage.Labels.New);return false}else{if(verifyChange()){var f=c;showCloseWarning(f,null)}else{startWaitMsgBar();loadBroadcastDetail(null);disableActionMenuItems(true);disableAgentMenuItems(true)}}}};var b=function(e,f){if(verifyChange()){var d=b;showCloseWarning(d)}else{startWaitMsgBar();if(isFocusOnBroadcastForm){loadBroadcastDetail(recordId)}else{if(isFocusOnRelatedList){loadBroadcastRelatedList(recordId)}else{loadBroadcastDetail(null)}}}};var a=function(d,e){functionArray[1]();if(isRFConsoleDetailForm){isSaveForSingleConsole=true;isSAVE=true}Ext.getCmp("BroadcastFormBtnId").toggle(true);var f=document.getElementById("broadcastDetailsFrameId");showDiv(f)};return Ext.create("Ext.toolbar.Toolbar",{id:"detailViewToolbarId",items:[{xtype:"tbspacer",width:5},{id:"newId",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:BroadcastConsolePage.Labels.New,tooltip:returnLabel(BroadcastConsolePage.Labels.New,"N"),disabled:!_ServerVariables.ObjectMetadata.isCreateable,handler:c},{xtype:"tbspacer",width:5},{id:"refreshId",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:BroadcastConsolePage.Labels.Undo,tooltip:BroadcastConsolePage.Labels.Undo_Consolebtn_Tooltip,handler:b},{xtype:"tbspacer",width:5},{id:"saveId",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",text:BroadcastConsolePage.Labels.Save,tooltip:returnLabel(BroadcastConsolePage.Labels.Save,"S"),disabled:!_ServerVariables.ObjectMetadata.isUpdateable,handler:a},{xtype:"tbspacer",width:5},"-",{id:"actionButton",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",text:BroadcastConsolePage.Labels.Actions,tooltip:returnLabel(BroadcastConsolePage.Labels.Actions,"A"),menu:getDetailViewActionMenu()},{id:"agentToolsBtnId",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"bmc-btn-dropdown-focus",overCls:"bmc-btn-dropdown-over",pressedCls:"bmc-btn-dropdown-pressed",text:BroadcastConsolePage.Labels.AgentTools,tooltip:returnLabel(BroadcastConsolePage.Labels.AgentTools,"T"),menu:getBroadcastAgentToolsBtnMenu()},{id:"BroadcastFormBtnGroupId",xtype:"buttongroup",columns:3,border:false,frame:false,items:[{id:"BroadcastFormBtnId",cls:"bmc-togglebar-left-btn-smart-view-disable",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:BroadcastConsolePage.Labels.BroadcastForm,tooltip:BroadcastConsolePage.Labels.BroadcastForm,enableToggle:true,pressed:true,disabled:((recordId==null||recordId==""||recordId=="new")?true:false),toggleGroup:"BroadcastBtnGroup",handler:BroadcastFormBtnhandler,listeners:{toggle:{fn:function(d,e){if(e){isFocusOnBroadcastForm=true}else{isFocusOnBroadcastForm=false}}}}},{id:"BroadcastReleatedListBtnId",cls:"bmc-togglebar-right-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:BroadcastConsolePage.Labels.RelatedLists,tooltip:BroadcastConsolePage.Labels.RelatedLists,enableToggle:true,disabled:((recordId==null||recordId==""||recordId=="new")?true:false),toggleGroup:"BroadcastBtnGroup",handler:BroadcastRelatedListBtnhandler,listeners:{toggle:{fn:function(d,e){if(e){isFocusOnRelatedList=true}else{isFocusOnRelatedList=false}}}}}]},{xtype:"tbfill"},{id:"LockRecord",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:BroadcastConsolePage.Labels.LockRecord,tooltip:_ServerLabels.LockRecordToolTip,hidden:true,disabled:!_ServerVariables.ObjectMetadata.isUpdateable},{id:"UnlockRecord",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:BroadcastConsolePage.Labels.UnlockRecord,tooltip:_ServerLabels.UnlockRecordToolTip,hidden:true,disabled:!_ServerVariables.ObjectMetadata.isUpdateable},{xtype:"tbspacer",width:5},{id:"LockRecordIcon",xtype:"label",hidden:true,cls:"d-icon-lock lock-color lock-icon",autoEl:{title:BroadcastConsolePage.Labels.LockedRecord}},{id:"LockRecordLbl",xtype:"label",text:BroadcastConsolePage.Labels.Locked,hidden:true,cls:"recordLockText"},{id:"UnlockRecordIcon",xtype:"label",hidden:true,cls:"d-icon-lock_open lock-icon",autoEl:{title:BroadcastConsolePage.Labels.UnlockedRecord}},{xtype:"tbspacer",width:0},{xtype:"tbseparator",id:"helpIconSeparator"},{xtype:"tbspacer",width:0},{xtype:"label",html:'<a href="#" onclick="OpenHelppage(\'Detail\');" title="'+_ServerLabels.Help+'" class="d-icon-question_circle help-icon"></a>'},{xtype:"tbspacer",width:10}]})}var BroadcastFormBtnhandler=function(a,b){startWaitMsgBar();Ext.getCmp("BroadcastFormBtnId").toggle(true);var c=document.getElementById("broadcastRelatedListFrameId");hideDiv(c);var d=document.getElementById("broadcastDetailsFrameId");if(d.src==""||isNeedToRefreshBroadcast==true){loadBroadcastDetail(recordId)}else{showDiv(d);if(isBroadcastFormFrameLoaded){stopWaitMsgBar()}}};var BroadcastRelatedListBtnhandler=function(b,d){Ext.getCmp("BroadcastReleatedListBtnId").toggle(true);startWaitMsgBar();var a=document.getElementById("broadcastDetailsFrameId");hideDiv(a);var c=document.getElementById("broadcastRelatedListFrameId");if(c.src==""||isNeedToRefreshRelatedList==true){loadBroadcastRelatedList(recordId)}else{showDiv(c);if(isBroadcastRelatedListFrameLoaded){stopWaitMsgBar()}}};function getDetailViewPanel(){var a=Ext.create("Ext.Panel",{id:"detailViewChildPanelId",cls:"detail-view-position-fixed",border:false,hidden:(recordId==""),width:"100%",anchor:"0 0",layout:{type:"anchor"},tbar:getDetailVeiwToolBar(),items:[Ext.create("Ext.Panel",{border:false,anchor:"0 0",width:"100%",contentEl:"DetailFormDiv"})]});waitMsgBar=new Ext.LoadMask(a,{floating:{shadow:false},msgCls:"d-loader-container",msg:'<ul class="d-loading"><li class="d-loading__stick d-loading__stick_1"></li><li class="d-loading__stick d-loading__stick_2"></li><li class="d-loading__stick d-loading__stick_3"></li><li class="d-loading__stick d-loading__stick_4"></li><li class="d-loading__stick d-loading__stick_5"></li><li class="d-loading__stick d-loading__stick_6"></li><li class="d-loading__stick d-loading__stick_7"></li><li class="d-loading__stick d-loading__stick_8"></li><li class="d-loading__stick d-loading__stick_9"></li><li class="d-loading__stick d-loading__stick_10"></li><li class="d-loading__stick d-loading__stick_11"></li><li class="d-loading__stick d-loading__stick_12"></li></ul><div>'+_ServerLabels.PleaseWaitMsg+"</div>"});return a}function LoadRecord(a){if(verifyChange()){var b=LoadRecordFunc;showCloseWarning(b,a)}else{LoadRecordFunc(a)}}function LoadRecordFunc(a){console.log("Loading record...");console.log(a);recordId=a;startWaitMsgBar();if(recordId==null||recordId==""){loadBroadcastDetail(null)}else{isNeedToRefreshRelatedList=true;loadBroadcastDetail(a)}}function showDiv(a){a.style.display="block";a.style.height="100%";a.style.width="100%";var c=/chrome/i.test(navigator.userAgent);if(c){var b=a.clientHeight+2;b=(b/a.clientHeight)*100;a.style.height=b+"%"}}function hideDiv(a){a.style.display="none";a.style.height="0px";a.style.width="0px"}function LoadHandlerForAgentItem(){var a;knowledgeSearchBtnHandler=function(b,c){screenHeight=400;screenWidth=671;a=window.open("/apex/KnowledgeSearch?enableSelfClosing=false&calledFromForm=true&standardLayout=true&isCalledFromConsole=true&objectName=Broadcasts&search="+encodeURIComponent(desc)+"&KMbroadcastID="+recordId+"&isServiceCloudConsole="+isServiceCloudConsole+"&isRFConsoleDetailForm="+isRFConsoleDetailForm,"KnowledgeSearch","status = 1, height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1, scrollbars=no");if(a.focus){a.focus()}}}function getBroadcastAgentToolsBtnMenu(){return Ext.create("Ext.menu.Menu",{id:"AgentToolsMenu",baseCls:"bmc-menu",shadow:false,items:AgentMenuItem,listeners:{mouseleave:{element:"el",delay:5000,fn:function(){this.hide()}}}})}function loadBroadcastRelatedList(c){isFocusOnBroadcastForm=false;isFocusOnRelatedList=true;isIncRelatedListFrameLoaded=false;var a=document.getElementById("broadcastDetailsFrameId");hideDiv(a);var b=document.getElementById("broadcastRelatedListFrameId");b.src="/apex/consolebroadcastRelatedList?id="+c+"&isdtp=vw";addOnLoadEvent(b,afterBroadcastRelatedListFrameLoad);showDiv(b)}function refreshBroadcast(){if(isFocusOnBroadcastForm){loadBroadcastDetail(recordId);isNeedToRefreshRelatedList=true}else{loadBroadcastRelatedList(recordId);isNeedToRefreshBroadcast=true;refreshBroadcastFormTimeOut()}}function loadBroadcastDetail(b){isBroadcastFormFrameLoaded=false;isFocusOnRelatedList=false;isFocusOnBroadcastForm=true;var c=document.getElementById("broadcastRelatedListFrameId");hideDiv(c);var d=document.getElementById("broadcastDetailsFrameId");if(b==null||b==""||isCloneRequest=="true"){isNewBroadcastForm=true;isNewRecordLock=true;if(isCloneRequest=="true"){isCloneRequest="false";d.src="/apex/ConsoleBroadcastDetail?oldBroadcastId="+b;clickedOnce=true;handleChange()}else{d.src="/apex/ConsoleBroadcastDetail?clientId="+_ServerVariables.PageParams.clientid}}else{isNewBroadcastForm=false;d.src="/apex/ConsoleBroadcastDetail?id="+b}addOnLoadEvent(d,afterBroadcastDetailFrameLoad);if(isNewBroadcastForm){Ext.getCmp("helpIconSeparator").hide();Ext.getCmp("detailViewToolbarId").doLayout()}else{addOptionalToolbarItems();Ext.getCmp("helpIconSeparator").show();Ext.getCmp("detailViewToolbarId").doLayout()}showDiv(d);var a=Ext.getCmp("detailViewChildPanelId");a.show()}function afterBroadcastDetailFrameLoad(){if(isNewBroadcastForm){afterNewFormLoad()}else{afterDetailFormLoad()}isNeedToRefreshBroadcast=false;isBroadcastFormFrameLoaded=true;if(isDeleted){disableDetailFormButtons()}isDeleted=false}function afterBroadcastRelatedListFrameLoad(){stopWaitMsgBar();isBroadcastRelatedListFrameLoaded=true}function afterNewFormLoad(){removeBroadcastData();AttRefGeneratorId="";disableActionMenuItems(true);disableAgentMenuItems(true);if(isServiceCloudConsole=="true"){sforce.console.setTabTitle(LabelNew)}Ext.getCmp("saveId").setDisabled(false);if(Ext.getCmp("viewActionHistoryId")!=undefined&&Ext.getCmp("viewActionHistoryId")!=null){Ext.getCmp("viewActionHistoryId").setDisabled(true)}Ext.getCmp("BroadcastFormBtnId").toggle(false);Ext.getCmp("BroadcastReleatedListBtnId").toggle(false);Ext.getCmp("BroadcastFormBtnId").setDisabled(true);Ext.getCmp("BroadcastReleatedListBtnId").setDisabled(true);isNewBroadcastForm=false;stopWaitMsgBar()}function afterDetailFormLoad(){if(functionArray[0]!="undefined"&&functionArray[0]!=null&&functionArray[0]!="null"&&functionArray[0]!=""){var a=functionArray[0]();var p=recordId;var k="";BRTooltipName=a.Name;if(isRFConsoleDetailForm&&isSaveForSingleConsole){var h=BroadcastConsolePage.Labels.BroadcastRecordPrefix+": ";if(a.Name.length>11){k=h+a.Name.substring(0,8).replace(/^\s+|\s+$/g,"")+"..."}else{k=h+a.Name}window.parent.changeTabTitle(tabId,k);isSaveForSingleConsole=false;window.parent.updateDirtyFlag(tabId,false);if(p==null||p==""){window.parent.changeTabItemId(a.Id,tabId)}}if(p==null||p==""){enableCustomActions()}getBroadcastData(a);var q=BRTooltipName;if(isServiceCloudConsole!="true"){if(BRTooltipName!=""){if(window.parent!=undefined&&window.parent.TabPanel!=undefined){var m=window.parent.TabPanel.items;for(var o=0;o<m.length;o++){if(m.items[o].id==tabId){m.items[o].tab.setTooltip(q)}}}}}Ext.getCmp("refreshId").setDisabled(false);if(Ext.getCmp("viewActionHistoryId")!=undefined&&Ext.getCmp("viewActionHistoryId")!=null){Ext.getCmp("viewActionHistoryId").setDisabled(false)}if(isServiceCloudConsole=="true"){var u="";if(BroadcastConsolePage.Labels.New!=a.Name){u=BroadcastConsolePage.Labels.BroadcastRecordPrefix+": "}sforce.console.setTabTitle(u+a.Name);SconsoletabName=a.Name;sforce.console.getFocusedPrimaryTabId(addSConsoleTabComplete)}var b=Ext.getCmp("BroadcastStatusId");if(b){b.update(a.Stage__c)}if(isFocusOnBroadcastForm){Ext.getCmp("BroadcastFormBtnId").toggle(true)}Ext.getCmp("BroadcastFormBtnId").setDisabled(false);Ext.getCmp("BroadcastReleatedListBtnId").setDisabled(false);disableActionMenuBtn(false);var e=Ext.getCmp("closeButtonId");var c=Ext.getCmp("reopenButtonId");var g=Ext.getCmp("addNoteId");var r=Ext.getCmp("newActionId");var j=Ext.getCmp("attachFileId");var d=Ext.getCmp("cloneButtonId");var n=Ext.getCmp("printId");var t=Ext.getCmp("printPDFId");var l=Ext.getCmp("viewActionHistoryId");var f=Ext.getCmp("knowledgeSearchButtonId");var s=Ext.getCmp("Submitforapproval");if(recordState=="true"){if(_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(false);if(e!=undefined&&e!=null){e.setDisabled(false)}if(r!=undefined&&r!=null){r.setDisabled(false)}checkApprovalstatus();if(typeof(recordLock)!="undefined"&&recordLock!=null&&recordLock!="Off"){if(!isSAVE||(isSAVE&&initialRecordState=="true")){if(typeof(isRecordLock)!="undefined"&&isRecordLock!=null&&isRecordLock.indexOf("false")>-1){if(recordLock=="Explicit"){if(isRecordLock.indexOf("##")>-1){recordLockedIcons("")}else{recordUnlockedIcons()}}else{if(recordLock=="Implicit"){getRecordLockedValue("recordLock")}}}else{enableRecordReadModeMsg(isRecordLock)}}isSAVE=false}}else{Ext.getCmp("saveId").setDisabled(true);if(e!=undefined&&e!=null){e.setDisabled(true)}if(r!=undefined&&r!=null){r.setDisabled(true)}}if(f!=undefined&&f!=null){f.setDisabled(false)}if(c!=undefined&&c!=null){c.setDisabled(true)}if(_ServerVariables.ObjectMetadata.isUpdateable||_ServerVariables.ObjectMetadata.isCreateable){if(g!=undefined&&g!=null){g.setDisabled(false)}if(j!=undefined&&j!=null){j.setDisabled(false)}}else{if(g!=undefined&&g!=null){g.setDisabled(true)}if(j!=undefined&&j!=null){j.setDisabled(true)}}}else{disableAllrecordLockIcons();if(f!=undefined&&f!=null){f.setDisabled(true)}if(e!=undefined&&e!=null){e.setDisabled(true)}if(g!=undefined&&g!=null){g.setDisabled(true)}if(r!=undefined&&r!=null){r.setDisabled(true)}if(s!=undefined&&s!=null){s.setDisabled(true)}if(_ServerVariables.ObjectMetadata.isUpdateable){if(c!=undefined&&c!=null){c.setDisabled(false)}}else{if(c!=undefined&&c!=null){c.setDisabled(true)}}}if(n!=undefined&&n!=null){n.setDisabled(false)}if(t!=undefined&&t!=null){t.setDisabled(false)}refreshBroadcastListTimeOut();refreshBroadcastRelatedListTimeOut();if(_ServerVariables.ObjectMetadata.isCreateable){if(d!=undefined&&d!=null){d.setDisabled(false)}}else{if(d!=undefined&&d!=null){d.setDisabled(true)}}}stopWaitMsgBar()}function refreshBroadcastListTimeOut(){if(isNeedToRefreshBroadcastList&&isServiceCloudConsole!="true"){isNeedToRefreshBroadcastList=false;if(isRFConsoleDetailForm=="true"&&typeof(window.parent)!="undefined"&&typeof(window.parent)!=undefined){setTimeout(function(){window.parent.refreshListView("Broadcasts__c")},2000)}else{setTimeout(function(){doRefresh()},2000)}}}function refreshBroadcastRelatedListTimeOut(){if(isNeedToRefreshRelatedList){setTimeout(function(){isNeedToRefreshRelatedList=false;isBroadcastRelatedListFrameLoaded=false;var a=document.getElementById("broadcastRelatedListFrameId");a.src="/apex/consolebroadcastRelatedList?id="+recordId+"&isdtp=vw";addOnLoadEvent(a,afterBroadcastRelatedListFrameLoad)},2000)}}function refreshBroadcastFormTimeOut(){if(isNeedToRefreshBroadcast){setTimeout(function(){isNeedToRefreshBroadcast=false;var a=document.getElementById("broadcastDetailsFrameId");a.src="/apex/ConsoleBroadcastDetail?id="+recordId},2000)}}function getBroadcastData(a){recordId=a.Id;BroadcastName=a.Name;recordState=a.state__c;status=a.Stage__c;desc=a.broadcastDescription__c;isRecordLock=a.isRecordLock}function pasteResolution(a,b){Visualforce.remoting.Manager.invokeAction(_RemotingActions.pasteResolution,recordId,a,b,function(c,d){if(d.type==="exception"){alert(d.message)}else{refreshBroadcast()}},{escape:true})}function removeBroadcastData(){recordId=null;BroadcastName=BroadcastConsolePage.Labels.New;recordState="";status=""}function startWaitMsgBar(){if(waitMsgBar!=""){waitMsgBar.setVisible(true)}}function setIsNeedToRefreshRelatedList(a){isNeedToRefreshRelatedList=a}function stopWaitMsgBar(){if(waitMsgBar!=""&&waitMsgBar.isVisible()){waitMsgBar.setVisible(false)}}function disableDetailFormButtons(){Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("refreshId").setDisabled(true);Ext.getCmp("BroadcastFormBtnId").setDisabled(true);Ext.getCmp("BroadcastReleatedListBtnId").setDisabled(true);Ext.getCmp("agentToolsBtnId").setDisabled(true);disableActionMenuBtn(true)}function BroadcastConsolePageinReadMode(){Ext.getCmp("saveId").setDisabled(true);if(Ext.getCmp("closeButtonId")!=undefined&&Ext.getCmp("closeButtonId")!=null){Ext.getCmp("closeButtonId").setDisabled(true)}if(Ext.getCmp("reopenButtonId")!=undefined&&Ext.getCmp("reopenButtonId")!=null){Ext.getCmp("reopenButtonId").setDisabled(true)}if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(true)}}function RTFEnabledPage(){if(isRTFEnabledBroadcastPage=="true"){return true}else{return false}}function afterSaveSucceed(){if(!isDeleted){isNeedToRefreshBroadcastList=true;isNeedToRefreshRelatedList=true;addOptionalToolbarItems();afterBroadcastDetailFrameLoad()}else{isNeedToRefreshBroadcastList=true;refreshBroadcastListTimeOut()}clickedOnce=false;if(isServiceCloudConsole=="true"){sforce.console.setTabUnsavedChanges(false)}Ext.getCmp("helpIconSeparator").show();Ext.getCmp("detailViewToolbarId").doLayout()}function setTabUnsavedChanges(){if(isServiceCloudConsole=="true"){sforce.console.setTabUnsavedChanges(true)}}function hideMenu(){var b=Ext.getCmp("mainMenu");if(b!="undefined"&&b!=null&&b!=""){Ext.getCmp("mainMenu").hide()}var a=Ext.getCmp("AgentToolsMenu");if(a!="undefined"&&a!=null&&a!=""){Ext.getCmp("AgentToolsMenu").hide()}}function disableActionMenuBtn(a){if(disableActionBtn){Ext.getCmp("actionButton").setDisabled(true)}else{Ext.getCmp("actionButton").setDisabled(a)}}function disableActionMenuItems(a){if(Ext.getCmp("closeButtonId")!=undefined&&Ext.getCmp("closeButtonId")!=null){Ext.getCmp("closeButtonId").setDisabled(a)}if(Ext.getCmp("reopenButtonId")!=undefined&&Ext.getCmp("reopenButtonId")!=null){Ext.getCmp("reopenButtonId").setDisabled(a)}if(Ext.getCmp("addNoteId")!=undefined&&Ext.getCmp("addNoteId")!=null){Ext.getCmp("addNoteId").setDisabled(a)}if(Ext.getCmp("newActionId")!=undefined&&Ext.getCmp("newActionId")!=null){Ext.getCmp("newActionId").setDisabled(a)}if(Ext.getCmp("cloneButtonId")!=undefined&&Ext.getCmp("cloneButtonId")!=null){Ext.getCmp("cloneButtonId").setDisabled(a)}if(Ext.getCmp("viewActionHistoryId")!=undefined&&Ext.getCmp("viewActionHistoryId")!=null){Ext.getCmp("viewActionHistoryId").setDisabled(a)}if(Ext.getCmp("printId")!=undefined&&Ext.getCmp("printId")!=null){Ext.getCmp("printId").setDisabled(a)}if(Ext.getCmp("printPDFId")!=undefined&&Ext.getCmp("printPDFId")!=null){Ext.getCmp("printPDFId").setDisabled(a)}if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(a)}}function disableAgentMenuItems(a){if(Ext.getCmp("knowledgeSearchButtonId")!=undefined&&Ext.getCmp("knowledgeSearchButtonId")!=null){Ext.getCmp("knowledgeSearchButtonId").setDisabled(a)}}function refreshRelatedLists(){isNeedToRefreshRelatedList=true;refreshBroadcastRelatedListTimeOut()}function truncateRecordId(a){if(a!="undefined"&&a!=null&&a!=""&&a.length>15){return a.substring(0,12).replace(/^\s+|\s+$/g,"")+"..."}else{return a}}function addSConsoleTab(c,b){try{SconsoletabName=b;sforce.console.openPrimaryTab(null,c,true," ",addSConsoleTabComplete)}catch(a){}}function addSConsoleTabComplete(a){try{if(a.success==true){var c=new Date();c.setYear(c.getFullYear()+10);document.cookie=SconsoletabName+"="+a.id+";expires="+c.toUTCString()+";path=/;SameSite=None;Secure"}else{if(Ext.util.Cookies.get(SconsoletabName)!=null){sforce.console.focusPrimaryTabById(Ext.util.Cookies.get(SconsoletabName))}}}catch(b){}}function enableCustomActions(){var b=Ext.getCmp("mainMenu").items;if(b!="undefined"&&b!=null&&b!=""){for(var d=0;d<b.length;d++){var a=b.items[d];if(a.id!="undefined"&&a.openIn!="undefined"&&typeof(a.openIn)!="undefined"){Ext.getCmp(a.id).setDisabled(false)}}}var c=Ext.getCmp("AgentToolsMenu").items;if(c!="undefined"&&c!=null&&c!=""){for(var d=0;d<c.length;d++){var a=c.items[d];if(a.id!="undefined"&&a.openIn!="undefined"&&typeof(a.openIn)!="undefined"){Ext.getCmp(a.id).setDisabled(false)}}}}function addOptionalToolbarItems(){if(!isOptionalItemsAdded){var a=Ext.getCmp("detailViewToolbarId");var b=0;a.insert(++b,{xtype:"label",id:"BroadcastStatusId",cls:"recordStage",text:status,width:"auto"});a.insert(++b,{xtype:"tbspacer",width:5});a.insert(++b,"-");a.insert(++b,{xtype:"tbspacer",width:10});isOptionalItemsAdded=true}}function addOnLoadEvent(b,a){if(b.addEventListener){b.addEventListener("load",a)}else{if(b.attachEvent){b.attachEvent("onload",a)}}}document.onkeydown=function(g){var c,a,d;d=0;if(isRFConsoleDetailForm=="true"){c=window.parent;d=window.parent.count}a=window.self;var f=document.getElementById("broadcastDetailsFrameId");var b="";if(f.src==""){b="ListViewNewButton"}else{if((typeof(f)!="undefined"&&f!=null)&&f.src!=""){b="newId"}}if(!window.isRFHotkeysDisabled){handleShortcuts(g,c,a,d,isRFConsoleDetailForm,b)}};