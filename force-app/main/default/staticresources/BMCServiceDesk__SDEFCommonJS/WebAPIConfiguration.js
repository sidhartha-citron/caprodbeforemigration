var comingFromCopy=false;var inactiveCheckBox;var paramList="";var idSetString="";var savedparam=false;var ReqCertificateChkBoxValue=false;var clickedMethodOnce=false;var savedServicetype="";var savefirstTime;Ext.onReady(function(){Ext.QuickTips.init();loadPage();var c=function(j,k){activeAllWindowFlag=false;window.parent.addTab("WebAPIConfiguration",webAPIConfigurationHeader,webAPIConfigurationHeader)};var i=function(j,k){validate();if(saveSuccessful){Ext.getCmp("saveId").setDisabled(true);waitbox(0);inactiveCheckBox=Ext.getCmp("idInactive").getValue();getBodyFromParam();save(inactiveCheckBox,paramList);Ext.getCmp("saveId").setDisabled(false);savedparam=false;paramList="";if(savefirstTime==true){disableNextPreviousBtn()}else{enableNextPreviousBtn()}}};var a=function(j,k){activeAllWindowFlag=false;callCopyPage()};var b=function(j,k){resetWebAPICongiguration()};var g=function(j,k){showDeleteMsg()};var f=function(j,k){};var d=function(j,k){};var h=function(j,k){if(document.getElementById("nextId").disabled!=true){createWACSet();nextBtnWACHandler(idSetString)}};var e=function(j,k){if(document.getElementById("prevId").disabled!=true){createWACSet();previousBtnWACHandler(idSetString)}};Ext.create("Ext.toolbar.Toolbar",{title:"",cls:"toolSpCls",height:35,id:"rf-webapi-toolbar",renderTo:"btnToolbar",items:[{xtype:"button",scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:tooltipNew,scope:this,id:"newId",handler:c},{scale:"medium",iconCls:"bmcSave",tooltipType:"title",id:"saveId",scope:this,tooltip:tooltipSave,handler:i},{scale:"medium",tooltipType:"title",tooltip:tooltipCopy,iconCls:"bmcCopy",scope:this,id:"copyId",handler:a},{xtype:"tbseparator",id:"tbseparatorId"},{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:tooltipDelete,scope:this,id:"deleteId",handler:g},{scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:tooltipRefresh,id:"resetId",handler:b},"->",{id:"idInactive",xtype:"checkbox",width:93,align:"top",checked:false,cls:"chkStyle",boxLabel:InactiveLabelWithStyle,listeners:{render:function(j){Ext.QuickTips.register({target:j.inputId,dismissDelay:20000,text:InactiveLabelWithStyle})}}},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:(b_previous),title:tooltipPreviousRecord},cls:"cursorCls",listeners:{render:function(j){j.el.on("click",e)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:b_next,title:tooltipNextRecord},cls:"cursorSpaceCls",listeners:{render:function(j){j.el.on("click",h)}}}]});if(WebAPIConfigurationId==null||WebAPIConfigurationId==""){savefirstTime=true;Ext.getCmp("saveId").setDisabled(!isCreateable);Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconCls("bmcDeleteDisable");Ext.getCmp("newId").setDisabled(!isCreateable);Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);disableNextPreviousBtn();changeContentType(initialServieType)}else{Ext.getCmp("saveId").setDisabled(!isEditable);Ext.getCmp("deleteId").setDisabled(!isDeletable);Ext.getCmp("deleteId").setIconCls("bmcDelete");Ext.getCmp("copyId").setDisabled(!isCreateable);Ext.getCmp("newId").setDisabled(!isCreateable);Ext.getCmp("resetId").setDisabled(false);if(WACset.length<=1){disableNextPreviousBtn()}else{enableNextPreviousBtn()}savefirstTime=false}Ext.getCmp("idInactive").setValue(inActiveValue);enbaleWebAPISetting();handleElemEvent();setLeftPropertyOfToolbar();previousBtnAlign();if(Ext.ieVersion=="10"){document.getElementById("InactiveLabel").className="checkbocLabelClsforIE10"}});var errormsg;function callCopyPage(){window.parent.addTab("WebAPIConfiguration?copyId="+copyWebConfigID,webAPIConfigurationHeader,webAPIConfigurationHeader);comingFromCopy=true}function closeWindow(){window.parent.refreshList();window.parent.closeTab(wid)}function chkForSavedParameter(){if(savedparam){setParameterValue();savedparam=false}}function loadParameters(a){if(document.getElementById(a)!=null){getParameter()}if(document.getElementById(a).value==savedSOAPMethod){savedparam=true}}function showParameters(){if(parameter!=null&&parameter==NonPrimitiveData){Ext.MessageBox.show({msg:NonPrimitiveData,buttons:Ext.MessageBox.OK,width:350})}else{document.getElementById("ParameterLabel").style.display="";document.getElementById("BasicGrid").style.display=""}}function disableServiceType(){document.getElementById("loadMethods").style.display="";document.getElementById("ServicesLabel").style.display="none";document.getElementById("WebCallingMethod").style.display="none";document.getElementById("RestService").style.display="none";document.getElementById("methodList").style.display="none";document.getElementById("ParameterLabel").style.display="none";document.getElementById("BasicGrid").style.display="none";document.getElementById("RequestHeader").style.display="none";document.getElementById("RequestBody").style.display="none";document.getElementById("SOAPEnvelope").style.display="none"}function setDefaultContentType(){document.getElementById("ForRestUrlButton").style.display="none";document.getElementById("contentType").style.display="none";document.getElementById("methodConfigBtn").disabled=false}function enableForWebAdvance(){document.getElementById("SOAPEnvelope").style.display="";document.getElementById("loadMethods").style.display="none"}function enableForWebBasic(){document.getElementById("WebCallingMethod").style.display="";document.getElementById("methodList").style.display="";showParameters();changeIdForRepeatEle();if(dataPresent==true){setParameterValue()}}function enableForRest(){document.getElementById("ServicesLabel").style.display="";document.getElementById("RestService").style.display="";document.getElementById("RequestBody").style.display="";document.getElementById("RequestHeader").style.display="";document.getElementById("loadMethods").style.display="none"}function changeContentType(c){var b;var a=c;if(dataPresent==false||a.indexOf("WebAPIForm")>=0){if(document.getElementById(c)!=null){b=document.getElementById(c).value}}else{if(dataPresent==true){b=c}}if(b=="SoapBasic"){setDefaultContentType();disableServiceType();enableForWebBasic();if(dataPresent==true){if(savedServicetype==b){document.getElementById("methodConfigBtn").disabled=false}else{document.getElementById("methodConfigBtn").disabled=true;enbaleWebAPISetting()}}else{if(dataPresent==false&&clickedMethodOnce){document.getElementById("methodConfigBtn").disabled=false}else{document.getElementById("methodConfigBtn").disabled=true;enbaleWebAPISetting()}}}else{if(b=="SoapAdvance"){setDefaultContentType();disableServiceType();enableForWebAdvance();document.getElementById("methodConfigBtn").disabled=false}else{if(b=="RestService"){document.getElementById("contentType").style.display="";document.getElementById("ForRestUrlButton").style.display="";disableServiceType();enableForRest();document.getElementById("methodConfigBtn").disabled=false}}}}function disableAllSecurityType(){document.getElementById("service_Identity").style.display="none";document.getElementById("service_Passphrase").style.display="none";document.getElementById("is_sandbox").style.display="none";document.getElementById("API_Key").style.display="none";document.getElementById("Secret_Key").style.display="none";document.getElementById("Required_Certificate").style.display="inherit";document.getElementById("Certificate_Name").style.display="none";if(ReqCertificateChkBoxValue){document.getElementById("Certificate_Name").style.display="inherit"}}function getAuthenticationBody(c){var b;disableAllSecurityType();var a=c;if(dataPresent==false||a.indexOf("WebAPIForm")>=0){if(document.getElementById(c)!=null){b=document.getElementById(c).value}}else{if(dataPresent==true){b=c}}if(b=="Basic"){document.getElementById("service_Identity").style.display="inherit";document.getElementById("service_Passphrase").style.display="inherit"}else{if(b=="Salesforce"){document.getElementById("is_sandbox").style.display="inherit";document.getElementById("service_Identity").style.display="inherit";document.getElementById("service_Passphrase").style.display="inherit";document.getElementById("Required_Certificate").style.display="none";document.getElementById("Certificate_Name").style.display="none"}else{if(b=="API Key"){document.getElementById("API_Key").style.display="inherit";document.getElementById("Secret_Key").style.display="inherit"}}}}function enbaleWebAPISetting(){document.getElementById("methodConfiguration").style.display="none";document.getElementById("methodConfigBtn").className="btnStyle WACbuttoncls";document.getElementById("WebAPISetting").style.display="inherit";document.getElementById("webAPISettingBtn").className="btnStyle WACbuttonOnClickcls"}function enableMethodCongiuration(){document.getElementById("methodConfiguration").style.display="inherit";document.getElementById("methodConfigBtn").className="btnStyle WACbuttonOnClickcls";document.getElementById("WebAPISetting").style.display="none";document.getElementById("webAPISettingBtn").className="btnStyle WACbuttoncls"}var HTTPHeaders;function openMeargeFieldPopUp(a){HTTPHeaders=document.getElementById(a);var b=window.open("/apex/InsertField","InsertField","width=800, height=250,top=400, left=400,scrollbars=yes")}function hideHours(b){var c;var a=b;if(dataPresent==false||a.indexOf("WebAPIForm")>=0){if(document.getElementById(b)!=null){c=document.getElementById(b).checked}}else{if(dataPresent==true){if(b=="true"){c=true}else{c=false}}}if(c){document.getElementById("Hours").style.display="inherit"}else{document.getElementById("Hours").style.display="none"}}function createWACSet(){idSetString="";var a=0;while(WACset.length>a){if(idSetString==""){idSetString=WACset[a]}else{idSetString=idSetString+","+WACset[a]}a++}}function loadPage(){if((WebAPIConfigurationNameObj!=""&&WebAPIConfigurationNameObj!=null)||(serviceTypeObj!=""&&serviceTypeObj!=null)){dataPresent=true}else{dataPresent=false}if(comingFromCopy){dataPresent=true}if(dataPresent){clickedMethodOnce=true;document.getElementById("methodConfigBtn").disabled=false}else{clickedMethodOnce=false;document.getElementById("methodConfigBtn").disabled=true}savedServicetype=serviceTypeObj;changeContentType(serviceTypeObj);getAuthenticationBody(securityTypeObj);enableCertificate(Required_CertificateObj);hideHours(hoursObj)}function enableCertificate(a){var c;var b=a;if(dataPresent==false||b.indexOf("WebAPIForm")>=0){if(document.getElementById(a)!=null){c=document.getElementById(a).checked}}else{if(dataPresent==true){if(a=="true"){c=true}else{c=false}}}if(c){document.getElementById("Certificate_Name").style.display="inherit";ReqCertificateChkBoxValue=true}else{document.getElementById("Certificate_Name").style.display="none";ReqCertificateChkBoxValue=false}}function validate(){var g=false;saveSuccessful=true;getVarsOfPage();if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}serviceUrl=serviceUrl.trim();WACName=WACName.trim();if(password!=null&&password!=""){if(passwordObj!=null&&passwordObj!=""&&passwordObj!=password){g=true}}if(WACName==""||WACName==null){Ext.MessageBox.show({msg:nameEmptyLMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}else{if(serviceUrl==""||serviceUrl==null){Ext.MessageBox.show({msg:serviceUrlEmptyMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}else{if(document.getElementById(hoursTextBoxValue).value===""&&document.getElementById(taskClosed).checked===true){Ext.MessageBox.show({msg:HoursValidationMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}else{if(securityType=="Basic"||securityType=="Salesforce"){if((username==""||username==null)||(password==""||password==null)){Ext.MessageBox.show({msg:userNamePasswordEmptyMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}}else{if(serviceType==""||serviceType==null){Ext.MessageBox.show({msg:serviceTyeEmptyMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}else{if(document.getElementById(reqCertificate).checked==true&&((document.getElementById(certificateTextBox).value==null)||(document.getElementById(certificateTextBox).value==""))){Ext.MessageBox.show({msg:enterCertificateMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}else{if(serviceUrl!=""||serviceUrl!=null){var f=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i;var b=serviceUrl;if(!f.test(b)){Ext.MessageBox.show({msg:serviceUrlEmptyMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}}else{savedServicetype=serviceType;if(securityType=="None"){username="";password=""}if(securityType=="Salesfroce"){document.getElementById(reqCertificate).value="";document.getElementById(certificateTextBox).value=""}if(serviceType=="SoapBasic"||serviceType=="SoapAdvance"){document.getElementById(restMethod).value=""}if(serviceType=="SoapBasic"){clickedMethodOnce=true;dataPresent=true}if(!(document.getElementById(taskClosed).checked)){document.getElementById(hoursTextBoxValue).value=""}}}}}}}}var a=document.getElementById(hoursTextBoxValue).value;var e=document.getElementById(certificateTextBox).value.trim();var d=/^(?=\S+)(?=[a-zA-Z0-9\_\-\&\s,.'-]*$).*(?=\S).$/;if(WACName!=""){if(!d.test(WACName)){Ext.MessageBox.show({msg:WACNameValidationMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}}if(e!=""){if(!d.test(e)){Ext.MessageBox.show({msg:CertificateNameValidationMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}}if(a!=""){var c=/^[0-9]{1,10}$/;if(!c.test(a)){Ext.MessageBox.show({msg:HoursDigitValidationMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false}}}function buttonValidator(){getNewTitle();if((newTitle!=null&&newTitle!="")&&(errormsg==null||errormsg==""||errormsg==SavedSuccessfully)){Ext.getCmp("deleteId").setDisabled(!isDeletable);Ext.getCmp("deleteId").setIconCls("bmcDelete");Ext.getCmp("copyId").setDisabled(!isCreateable);Ext.getCmp("resetId").setDisabled(false)}}function updateList(){window.parent.refreshList()}function enableSaveButton(){Ext.getCmp("saveId").setDisabled(false)}function showDeleteMsg(){Ext.MessageBox.confirm(tooltipDelete,deleteConfirm,function(a){if(a==="yes"){deleteWebAPIConfiguration()}})}function callMergeFeild(c){var b=c.id;var a=b.replace("button","textBox");openMeargeFieldPopUp(a)}function changeIdForRepeatEle(){var b=document.getElementsByName("textBoxNameRepeat");var a=document.getElementsByName("buttonNameRepeat");for(itreator=0;itreator<b.length;itreator++){if(b.item(itreator).nodeType==1){b.item(itreator).id=b.item(itreator).id+itreator}if(a.item(itreator).nodeType==1){a.item(itreator).id=a.item(itreator).id+itreator}}firstClick=false}function showMethods(b){getVarsOfPage();if(securityType=="Basic"&&((username==""||username==null)||(password==""||password==null))){Ext.MessageBox.show({msg:userNamePasswordEmptyMsg,buttons:Ext.MessageBox.OK,width:200});saveSuccessful=false;return}if(document.getElementById(b)!=null){var a=document.getElementById(b).value;if(a!=null&&a!=""){loadMethods();waitbox(0)}else{Ext.MessageBox.show({msg:serviceUrlEmptyMsg,buttons:Ext.MessageBox.OK,width:350})}}}function setParsingStatus(){getVarsOfPage();if(IsParserFailed=="true"){document.getElementById("WebCallingMethod").style.display="none";document.getElementById("methodList").style.display="none";document.getElementById("ParameterLabel").style.display="none";document.getElementById("BasicGrid").style.display="none";Ext.MessageBox.show({msg:WSDLParsingFailedMsg,buttons:Ext.MessageBox.OK,width:200});document.getElementById("methodConfigBtn").disabled=true;enbaleWebAPISetting()}else{document.getElementById("methodConfigBtn").disabled=false;document.getElementById("WebCallingMethod").style.display="";document.getElementById("methodList").style.display="";document.getElementById("ParameterLabel").style.display="none";document.getElementById("BasicGrid").style.display="none";clickedMethodOnce=true}}function getBodyFromParam(){var a;var b=document.getElementsByName("textBoxNameRepeat");for(itreator=0;itreator<b.length;itreator++){if(b.item(itreator).nodeType==1){a=b.item(itreator).id;paramList=paramList+document.getElementById(a).value+";"}}}function setParameterValue(){var c=parameter.split(";");var a;var b=document.getElementsByName("textBoxNameRepeat");for(itreator=0;itreator<b.length;itreator++){if(b.item(itreator).nodeType==1){a=b.item(itreator).id;document.getElementById(a).value=c[itreator]}}}function enableNextPreviousBtn(){if(Ext.isIE8){if(document.getElementById("prevId")!=null){document.getElementById("prevId").style.filter="alpha(opacity=100)";document.getElementById("prevId").style.cursor="pointer"}if(document.getElementById("nextId")!=null){document.getElementById("nextId").style.filter="alpha(opacity=100)";document.getElementById("nextId").style.cursor="pointer"}}else{Ext.getCmp("prevId").setDisabled(false);Ext.getCmp("nextId").setDisabled(false)}}function disableNextPreviousBtn(){if(Ext.isIE8){if(document.getElementById("prevId")!=null){document.getElementById("prevId").className=document.getElementById("prevId").className+" x-item-disabled";document.getElementById("prevId").disabled=true}if(document.getElementById("nextId")!=null){document.getElementById("nextId").className=document.getElementById("nextId").className+" x-item-disabled";document.getElementById("nextId").disabled=true}}else{Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true)}}function setLeftPropertyOfToolbar(){var d=document.getElementById("saveId");var f=document.getElementById("copyId");var c=document.getElementById("resetId");var a=document.getElementById("tbseparatorId");var e=document.getElementById("deleteId");var b;if(d!=null&&d!=""){b=parseInt(d.style.left,10);d.style.left=(b-2)+"px"}if(f!=null&&f!=""){b=parseInt(f.style.left,10);f.style.left=(b-3)+"px"}if(a!=null&&a!=""){b=parseInt(a.style.left,10);a.style.left=(b-4)+"px"}if(e!=null&&e!=""){b=parseInt(e.style.left,10);e.style.left=(b-2)+"px"}if(c!=null&&c!=""){b=parseInt(c.style.left,10);c.style.left=(b-6)+"px"}}function previousBtnAlign(){var a=document.getElementById("prevId").style.left;a=a.toString().slice(0,-2);a=parseInt(a,10);a=a+2;a=a.toString();a=a+"px";document.getElementById("prevId").style.left=a};