var clickedOnce=false;var idset;var networklatency="";var emailFlag="";var CIFlag=1,CAFlag=1;function handleChange(){if(!clickedOnce){clickedOnce=true;window.parent.registerChange(wid)}}function handleResetChange(){if(clickedOnce){clickedOnce=false;window.parent.registerSave(wid)}}function NextBtnHandler(){if(document.getElementById("nextId").disabled!=true){var b="";var a=0;if(idset.length>0){b=idset}nextApprovalBtnHandler(b)}}function PreviousBtnHandler(){if(document.getElementById("prevId").disabled!=true){var b="";var a=0;if(idset.length>0){b=idset}previousApprovalBtnHandler(b)}}Ext.onReady(function(){windowloaddate=new Date();networklatencystart=windowloaddate.getTime();networklatency=networklatencystart-networkstart;data+=ChangeApprovalPage.Labels.NetwokLatency;data+=networklatency;data+="<br>";Ext.QuickTips.init();var b=function(j,k){window.parent.ApprovalNeedsRefresh=true;var l="Approve";ApproveChange(l)};var e=function(j,k){window.parent.ApprovalNeedsRefresh=true;var l="Reject";RejectChange(l)};var g=Ext.extend(Ext.Panel,{renderTo:"CAToolBarTD",defaults:{bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"}});new g({title:"",cls:"toolSpCls",bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;",tbar:[{scale:"medium",iconCls:"bmcApprove",tooltipType:"title",tooltip:ChangeApprovalPage.Labels.Approve,id:"approveId",handler:b}," ",{scale:"medium",iconCls:"bmcReject",tooltipType:"title",tooltip:ChangeApprovalPage.Labels.Reject,id:"rejectId",handler:e}," ","-"," ",{scale:"medium",iconCls:"bmcCIExplorer",tooltipType:"title",tooltip:ChangeApprovalPage.Labels.LaunchCIExplorer,id:"CIExpId",listeners:{mouseover:function(){this.setIconClass("bmcCIExplorerOn")},mouseout:function(){this.setIconClass("bmcCIExplorer")}},handler:ShowCIExplorer},new Ext.Toolbar.Fill(),{xtype:"box",id:"prevId",autoEl:{tag:"img",src:(getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif"),title:ChangeApprovalPage.Labels.PreviousRecord},cls:"cursorCls",listeners:{render:function(j){j.el.on("click",PreviousBtnHandler)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:ChangeApprovalPage.Labels.NextRecord},cls:"cursorSpaceCls",listeners:{render:function(j){j.el.on("click",NextBtnHandler)}}}]});var c=new Ext.Panel({header:true,id:"approverInformationPanel",title:ChangeApprovalPage.Labels.ApproverInformation,renderTo:"ApproverInformationDiv",height:130,width:"100%",contentEl:"ApproverInfoPanel",labelStyle:"clsRowBlueBgPanel",border:false,collapsible:true,collapsed:true});getIncidentInformationPanel();var f=new Ext.Panel({header:true,id:"approvalpanel",title:ChangeApprovalPage.Labels.ChangeRequestApproval,renderTo:"changeApprovalInfoDiv1",width:"100%",contentEl:"approvalInfo",labelStyle:"clsRowBlueBgPanel",border:false,collapsible:true,collapsed:false,listeners:{expand:function(j){if(CIFlag==1&&CAFlag==0){Ext.getCmp("approvalpanel").setHeight(150);Ext.getCmp("infopanelInc").setHeight(250);document.getElementById(ChangeApprovalPageComp.ComponentVars.ApproverComments).style.height=85+"px";changeTextareaHeight("85px")}else{if(CIFlag==0&&CAFlag==0){Ext.getCmp("approvalpanel").setHeight(380);document.getElementById(ChangeApprovalPageComp.ComponentVars.ApproverComments).style.height=315+"px"}}CAFlag=1},collapse:function(j){if(CIFlag==1&&CAFlag==1){Ext.getCmp("infopanelInc").setHeight(480);changeTextareaHeight("310px")}CAFlag=0}}});if(recordType=="Incident__c"){f.setTitle(ChangeApprovalPage.Labels.IncidentApproval)}if(recordType=="Change_Request__c"){Ext.getCmp("infopanelInc").setTitle(ChangeApprovalPage.Labels.ChangeRequestInformation)}var a=new Ext.Panel({id:"actionButtonPanel",title:"",renderTo:"actionButtonsDiv",width:"100%",border:false,items:[{id:"approveBtn",xtype:"tbbutton",cls:"bgBtnGrey",icon:getSDFStylesResPath()+"/SDEFicons/icon_approve_change.png",text:ChangeApprovalPage.Labels.Approve,tooltip:ChangeApprovalPage.Labels.Approve,tooltipType:"title",handler:b},{id:"rejectBtn",xtype:"tbbutton",cls:"bgBtnGrey",icon:getSDFStylesResPath()+"/SDEFicons/icon_reject_change.png",text:ChangeApprovalPage.Labels.Reject,tooltip:ChangeApprovalPage.Labels.Reject,tooltipType:"title",handler:e}]});applyPermissions();emailFlag=getEmailLinkFlag();if(emailFlag!="true"){checkIDSet();handleElemEvent()}data+=ChangeApprovalPage.Labels.PageLoad;var d=new Date();var i=d.getTime();var h=(i-networklatencystart);data+=h});function getIncidentInformationPanel(){componentFlag=1;renderUI();var a=new Ext.Panel({header:true,id:"infopanelInc",title:ChangeApprovalPage.Labels.IncidentApproveInformation,renderTo:"changeApprovalInfoDiv",height:265,width:"100%",labelStyle:"clsRowBlueBgPanel",border:false,contentEl:ChangeApprovalPageComp.ComponentVars.incidentInformation,collapsible:true,collapsed:false,listeners:{expand:function(b){if(CIFlag==0&&CAFlag==1){Ext.getCmp("infopanelInc").setHeight(265);Ext.getCmp("approvalpanel").setHeight(150);document.getElementById(ChangeApprovalPageComp.ComponentVars.ApproverComments).style.height=85+"px";changeTextareaHeight("85px")}else{if(CIFlag==0&&CAFlag==0){Ext.getCmp("infopanelInc").setHeight(480);changeTextareaHeight("310px")}}CIFlag=1},collapse:function(b){if(CIFlag==1&&CAFlag==1){Ext.getCmp("approvalpanel").setHeight(380);document.getElementById(ChangeApprovalPageComp.ComponentVars.ApproverComments).style.height=315+"px"}CIFlag=0}}})}function applyPermissions(){var a=getPermission();if(a=="true"){Ext.getCmp("approveBtn").enable();Ext.getCmp("rejectBtn").enable();Ext.getCmp("approveId").enable();Ext.getCmp("rejectId").enable();document.getElementById(ChangeApprovalPageComp.ComponentVars.ApproverComments).readonly=false}else{Ext.getCmp("approveBtn").disable();Ext.getCmp("rejectBtn").disable();Ext.getCmp("approveId").disable();Ext.getCmp("rejectId").disable();Ext.getCmp("approveId").setIconClass("bmcApproveDisable");Ext.getCmp("rejectId").setIconClass("bmcRejectDisable");document.getElementById(ChangeApprovalPageComp.ComponentVars.ApproverComments).readOnly=true;document.getElementById(ChangeApprovalPageComp.ComponentVars.ApproverComments).className="clsCommentsInputTextAreaReadOnly"}if(getEnableCILinkBtn()){Ext.getCmp("CIExpId").setDisabled(false);Ext.getCmp("CIExpId").setIconClass("bmcCIExplorer")}else{Ext.getCmp("CIExpId").setDisabled(true);Ext.getCmp("CIExpId").setIconClass("bmcCIExplorerDisable")}document.getElementById(ChangeApprovalPageComp.ComponentVars.LastName).readOnly=true;document.getElementById(ChangeApprovalPageComp.ComponentVars.FirstName).readOnly=true;document.getElementById(ChangeApprovalPageComp.ComponentVars.Phone).readOnly=true;document.getElementById(ChangeApprovalPageComp.ComponentVars.Extension).readOnly=true;document.getElementById(ChangeApprovalPageComp.ComponentVars.Approver).readOnly=true;document.getElementById(ChangeApprovalPageComp.ComponentVars.Queue).readOnly=true;emailFlag=getEmailLinkFlag();if(emailFlag=="true"){Ext.getCmp("CIExpId").setDisabled(true);Ext.getCmp("CIExpId").setIconClass("bmcCIExplorerDisable");Ext.getCmp("nextId").setDisabled(true);Ext.getCmp("prevId").setDisabled(true)}var b=getNavFlag();if(b=="TRUE"){Ext.getCmp("prevId").setDisabled(false);Ext.getCmp("nextId").setDisabled(false)}else{Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true)}}function ShowCIExplorerJS(d,c){var a,b;if(recordType=="Change_Request__c"){a=escape("CIExplorerLauncher?Module=Change_Request__c&RecordSequence="+ChangeRequestid+"&id="+ChangeRequestid);b="NavigatorPage?title="+d+"&target="+a;window.parent.parent.addNewTab("CIExplorerLauncher",c,b)}if(recordType=="Incident__c"){a=escape("CIExplorerLauncher?Module=Incident__c&RecordSequence="+ChangeRequestid+"&id="+ChangeRequestid);b="NavigatorPage?title="+d+"&target="+a;window.parent.parent.addNewTab("CIExplorerLauncher",c,b)}}function closeWindow(){if(emailFlag=="true"){Ext.getCmp("approveBtn").disable();Ext.getCmp("rejectBtn").disable();Ext.getCmp("approveId").disable();Ext.getCmp("rejectId").disable();Ext.getCmp("approveId").setIconClass("bmcApproveDisable");Ext.getCmp("rejectId").setIconClass("bmcRejectDisable");document.getElementById(ChangeApprovalPageComp.ComponentVars.ApproverComments).readOnly=true;document.getElementById(ChangeApprovalPageComp.ComponentVars.ApproverComments).className="clsCommentsInputTextAreaReadOnly"}else{window.parent.refreshList();window.parent.closeTab(wid)}};