function resetDateText(a){document.getElementById(a).value="";return false}function assignApexErrorMessage(){msgvalue="";var a=document.getElementById("testPanelDiv");if(a!=null&&a.firstChild!=null){var b=a.firstChild;msgvalue=RemedyForceHTMLProcessor.getText(b.firstChild);Ext.MessageBox.show({msg:msgvalue,buttons:Ext.MessageBox.OK})}}function getUrlParameter(d){d=d.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+d+"=([^&#]*)";var b=new RegExp(c);var a=b.exec(window.location.href);if(a==null){return""}else{return a[1]}}function showDateTimePicker(b){var a=document.getElementById(b);_datePicker.Show(a)}function showDatePicker(b){var a=document.getElementById(b);_datePicker.Show(a)}if(typeof(SDEDateFormat)=="undefined"||SDEDateFormat==null||SDEDateFormat==""){this.SDEDateFormat="m/d/Y h:i A"}Date.useStrict=true;var dataModifiedFlag=0;var cdateFormat="";FilterDatePickerPopup=function(){};FilterDatePickerPopup.prototype={dateFormat:SDEDateFormat,selectHandler:function(e,d){this.TextField.dom.value=d.format(SDEDateFormat);var a=this.TextField.dom.id;if(a.indexOf("inputDate1")>0){var b=document.getElementById(a).value;var c=b.split(" ");cdateFormat=c[1];this.TextField.dom.value=c[0].replace(",","")}dataModifiedFlag=1;this.TextField=null;e.hide();e.winHandle.close()},Show:function(b){this.TextField=Ext.get(b);var g=new Ext.DatePicker({startDay:1,listeners:{select:this.selectHandler.createDelegate(this)}});try{var c=Date.parseDate(this.TextField.dom.value,this.dateFormat);g.setValue(c)}catch(f){}var a=this.TextField.getRegion();var d=new Ext.Window({x:a.right-80,y:a.top-100,cls:"CMDBWindow",animCollapse:true,header:true,modal:true,autoHeight:true,autoWidth:true,layout:"fit",frame:false});d.add(g);g.winHandle=d;d.show();d.tools.close.setStyle({display:"none"});d._checkCloseClick=function(j){try{var h=j.getPageX(),l=j.getPageY(),i=this.getBox();if(h<i.x||h>i.x+i.width||l<i.y||l>i.y+i.height){if(this.rendered){this.mun(Ext.getBody(),"click",this._checkCloseClick,this);this.close()}}}catch(k){}};setTimeout(function(){d.mon(Ext.getBody(),"click",d._checkCloseClick,d)},500)}};var _datePicker=new FilterDatePickerPopup();var lookupObject="",NONPRINT="¬";function getFilterId(d,c,b){if((b.indexOf("FKClosedBy__c")!=-1)||(b.indexOf("FKClosed_By__c")!=-1)||(b.indexOf("FKOpenBy__c")!=-1)||(b.indexOf("FKStaff__c")!=-1)){return escape("active_standard")+"&addlFilterId=staffusers"}if(c=="User"){return escape("active_standard")}if(c=="AllUser"){lookupObject="User";return escape("active_standard")}if(c=="Account"){if(d=="Incident__c"){if(showRFAccountByDefault){return"active_custom&addlFilterId=acc_rf"}else{return escape("active_custom")}}else{return escape("active_custom")}}if(c=="Impact__c"||c=="Priority__c"||c=="Urgency__c"){return escape("active_custom")}if(c=="Broadcasts__c"||c=="Task__c"||c=="Incident__c"||c=="Release__c"||c=="Change_Request__c"||c=="Problem__c"){return escape("active_custom")}if(c=="Category__c"){if(d=="Incident__c"){return escape("active_custom")+"&addlFilterId=cat_in"}else{if(d=="Task__c"){return escape("active_custom")+"&addlFilterId=cat_ta"}else{if(d=="Problem__c"){return escape("active_custom")+"&addlFilterId=cat_pr"}else{if(d=="Change_Request__c"){return escape("active_custom")+"&addlFilterId=cat_cr"}else{if(d=="Release__c"){return escape("active_custom")+"&addlFilterId=cat_rm"}else{if(d=="Broadcasts__c"){return escape("active_custom")+"&addlFilterId=cat_br"}else{return escape("active_custom")}}}}}}}if(c=="BMC_BaseElement__c"&&d=="Incident__c"){if(b.indexOf("FKBusinessService__c")!=-1){lookupObject="BMC_BusinessService__c";return getBSFilterId(b,true)}else{if(b.indexOf("FKServiceOffering__c")!=-1){lookupObject="BMC_BusinessService__c";return getBSFilterId(b,true)}}}if(c=="SYSTemplate__c"){if(d=="Incident__c"){return escape("active_custom")+"&addlFilterId=temp_in"}else{if(d=="Task__c"){return escape("active_custom")+"&addlFilterId=temp_ta"}else{if(d=="Problem__c"){return escape("active_custom")+"&addlFilterId=temp_pr"}else{if(d=="Change_Request__c"){return escape("active_custom")+"&addlFilterId=temp_cr"}else{if(d=="Release__c"){return escape("active_custom")+"&addlFilterId=temp_rm"}else{if(d=="Broadcasts__c"){return escape("active_custom")+"&addlFilterId=temp_br"}else{return escape("active_custom")}}}}}}}else{if(c=="Status__c"){if(d=="Incident__c"){return escape("active_custom")+"&addlFilterId=status_close_in"}else{if(d=="Task__c"){return escape("active_custom")+"&addlFilterId=status_close_ta"}else{if(d=="Problem__c"){return escape("active_custom")+"&addlFilterId=status_close_pr"}else{if(d=="Change_Request__c"){return escape("active_custom")+"&addlFilterId=status_close_cr"}else{if(d=="Release__c"){return escape("active_custom")+"&addlFilterId=status_close_rm"}else{if(d=="Broadcasts__c"){return escape("active_custom")+"&addlFilterId=status_close_br"}}}}}}}}if(c=="Group"){var a="";if(d=="Incident__c"){a="obj_in"}else{if(d=="Task__c"){a="obj_ta"}else{if(d=="Problem__c"){a="obj_pr"}else{if(d=="Change_Request__c"){a="obj_cr"}else{if(d=="Release__c"){a="obj_rm"}else{if(d=="Broadcasts__c"){a="obj_br"}}}}}}return escape(a)+"&addlFilterId=queues"}return""}function getBSFilterId(b,f){var c="";if(b.indexOf("FKServiceOffering__c")!=-1){if(serviceId){var a=document.getElementById(serviceId);if(a){var e=a.value;if(e&&e.trim()!=""){if(hiddenServiceId){var d=document.getElementById(hiddenServiceId);if(d){buisnessServiceId=d.value}else{buisnessServiceId=""}}}else{buisnessServiceId=""}}}if(buisnessServiceId!=null&&buisnessServiceId!=""&&buisnessServiceId!="undefined"&&buisnessServiceId!="000000000000000"){if(isFlattenedCmdb){c="active_be&addlFilterId=flat_offering_bsid&param1="+encodeURIComponent(buisnessServiceId)}else{c="active_be_parent&addlFilterId=offering_bsid&param1="+encodeURIComponent(buisnessServiceId)}}else{if(isFlattenedCmdb){c="active_be&addlFilterId=flat_offering"}else{c="active_be_parent&addlFilterId=offering"}}}else{if(b.indexOf("FKBusinessService__c")!=-1){if(!f&&isFlattenedCmdb){c="active_be&addlFilterId=flat_service"}else{c="active_be_parent&addlFilterId=service"}}}return c}function openRFLookupFromClose(c,a,e){var d=parseInt((screen.availWidth/2)-(e/2));var b=parseInt((screen.availHeight/2)-(a/2));window.open(c,"lookup","width="+e+",height="+a+",toolbar=no,status=no,left= "+d+",top="+b+",directories=no,menubar=no,resizable=yes,scrollable=no, true")}function createFilterFieldMap(){for(var a=0;a<filterStr.length;a++){var b=new Object();b.key=filterStr[a].key;b.value=filterStr[a].value;b.filterId=filterStr[a].filterId;filterFieldsMap[filterStr[a].key]=b}}function getFilterQueryString(a){var d="";try{var b=filterFieldsMap[a];if(b){d=b.filterId}d=encodeURIComponent(d)}catch(c){d=""}return d}function showLookupPopup(h,n,k,i,a,f,b){lookupObject=k;var m=(n.toLowerCase().replace(orgNamespace.toLowerCase(),""));var c=getFilterQueryString(m);var j=document.getElementById(a).value;if(j){j=j.trim();j=encodeURIComponent(j);if(j!=""&&j.length<2){alert(searchErrorMsg);return}}var g="";var l=getFilterId(f,lookupObject,n);isCustomLookup=false;var e="";if(n&&n.toLowerCase().indexOf(orgNamespace.toLowerCase())==-1){isCustomLookup=true}if(lookupObject=="Category__c"){if(f&&f=="Incident__c"){baseURL="/apex/"+orgNamespace+"StdLayoutCategoryTree?txt="+i+"&popupId="+b+"&objectName="+f+"&state=true&serviceRequest="+isServiceRequest+"&stdForm=false&standardLayout=true&filterId="+l+"&frm="+escapeUTF("closepage")+"&idValstr="+c+"&searchLookUpStr="+j}else{baseURL="/apex/"+orgNamespace+"StdLayoutCategoryTree?txt="+i+"&popupId="+b+"&objectName="+f+"&state=true&stdForm=false&standardLayout=true&filterId="+l+"&frm="+escapeUTF("closepage")+"&idValstr="+c+"&searchLookUpStr="+j}}else{if(f=="Incident__c"&&n.indexOf("FKBMC_BaseElement__c")!=-1){var o="";baseURL="/apex/"+orgNamespace+"SearchAndLink?txt="+i+"&isFromCloseForm=true";baseURL=baseURL+"&filterObjectId="+incidentId+"&parentName="+f+"&childName="+lookupObject+"&isLookUp="+lookupObject+"&NewLookUpType="+g+"&filterId=active_be&FKBusinessService__c="+o+"&clientId="+clientId+"&accountId="+accountId+e+"&idValstr="+c+"&searchLookUpStr="+j}else{if(f=="Incident__c"&&n.indexOf("FKBusinessService__c")!=-1){e="&type=service"}baseURL="/apex/"+orgNamespace+"SearchAndLink?txt="+i+"&isFromCloseForm=true";baseURL=baseURL+"&filterObjectId=&parentName="+f+"&childName="+lookupObject+"&isLookUp="+lookupObject+"&NewLookUpType="+g+"&filterId="+l+"&searchLookUpStr="+j+"&isCustomLookup="+isCustomLookup+e+"&idValstr="+c}}if(f&&(f=="Incident__c"||f=="Change_Request__c"||f=="Task__c")){if(MultiPageLayoutEnabled&&MultiPageLayoutEnabled=="true"){baseURL=baseURL+"&MultiPageLayoutEnabled=true&recType="+encodeURIComponent(layoutId)}}openRFLookupFromClose(baseURL,"480","800");var d=h.previousSibling.previousSibling;setPopUpValueID(d.id)}function getFilterCondition(f,c,e,d,b){if(c=="User"&&(b==staffId||b==closedById)){return("staffusers"+NONPRINT+"active_standard")}if((currentConsole=="Task"||currentConsole=="Change Request")&&c=="User"){return"active_standard"}if(c=="User"){return"active_standard"}if(e&&e=="StandardUserLookup"){lookupObject="User";return"active_standard"}if(e&&e=="CustomerSuccessUserLookup"){lookupObject="User";return"active_standard"}if(c=="AllUser"){lookupObject="User";return"active_standard"}if(c=="Account"){if(currentConsole=="Incident"){if(showRFAccountByDefault){return"active_custom"+NONPRINT+"acc_rf"}else{return escape("active_custom")}}else{return"active_custom"}}if(c=="Impact__c"||c=="Priority__c"||c=="Urgency__c"){return"active_custom"}if(c=="Broadcasts__c"||c=="Task__c"||c=="Incident__c"||c=="Release__c"||c=="Change_Request__c"||c=="Problem__c"){return"active_custom"}if(c=="Category__c"){if(currentConsole=="Incident"){if(IncidentSegregationEnabled){if(isServiceRequest){return"active_custom"+NONPRINT+"cat_sr_seg"}else{return"active_custom"+NONPRINT+"cat_in_seg"}}return"active_custom"+NONPRINT+"cat_in"}else{if(currentConsole=="Task"){return"active_custom"+NONPRINT+"cat_ta"}else{if(currentConsole=="Problem"){return"active_custom"+NONPRINT+"cat_pr"}else{if(currentConsole=="Change Request"){return"active_custom"+NONPRINT+"cat_cr"}else{if(currentConsole=="Release"){return"active_custom"+NONPRINT+"cat_rm"}else{if(currentConsole=="Broadcast"){return"active_custom"+NONPRINT+"cat_br"}else{return"active_custom"}}}}}}}if(c=="BMC_BaseElement__c"){if(currentConsole=="Incident"){if(d.indexOf("FKBusinessService__c")!=-1||d.indexOf("FKServiceOffering__c")!=-1){lookupObject="BMC_BusinessService__c";return getFilterClauseForBE(d,f)}if(!f&&d.indexOf("FKBMC_BaseElement__c")!=-1){return"active_be"}}if(!f){return"active_be"}}if(c=="SYSTemplate__c"){if(currentConsole=="Incident"){return"active_custom"+NONPRINT+"temp_in"}else{if(currentConsole=="Task"){return"active_custom"+NONPRINT+"temp_ta"}else{if(currentConsole=="Problem"){return"active_custom"+NONPRINT+"temp_pr"}else{if(currentConsole=="Change Request"){return"active_custom"+NONPRINT+"temp_cr"}else{if(currentConsole=="Release"){return"active_custom"+NONPRINT+"temp_rm"}else{if(currentConsole=="Broadcast"){return"active_custom"+NONPRINT+"temp_br"}else{return"active_custom"}}}}}}}else{if(c=="Status__c"){if(currentConsole=="Incident"){return"active_custom"+NONPRINT+"status_close_in"}else{if(currentConsole=="Task"){return"active_custom"+NONPRINT+"status_close_ta"}else{if(currentConsole=="Problem"){return"active_custom"+NONPRINT+"status_close_pr"}else{if(currentConsole=="Change Request"){return"active_custom"+NONPRINT+"status_close_cr"}else{if(currentConsole=="Release"){return"active_custom"+NONPRINT+"status_close_rm"}else{if(currentConsole=="Broadcast"){return"active_custom"+NONPRINT+"status_close_br"}else{return"active_custom"}}}}}}}}if(c=="Group"){var a="";if(currentConsole=="Incident"){a="obj_in"}else{if(currentConsole=="Task"){a="obj_ta"}else{if(currentConsole=="Problem"){a="obj_pr"}else{if(currentConsole=="Change Request"){a="obj_cr"}else{if(currentConsole=="Release"){a="obj_rm"}else{if(currentConsole=="Broadcast"){a="obj_br"}}}}}}return a+NONPRINT+"queues"}if(typeof(c)!="undefined"&&c!="User"&&c!="Account"&&c.indexOf("__c")<0){return""}}function getFilterClauseForBE(b,f){var c="";if(b.indexOf("FKServiceOffering__c")!=-1){if(serviceId){var a=document.getElementById(serviceId);if(a){var e=a.value;if(e&&e.trim()!=""){if(hiddenServiceId){var d=document.getElementById(hiddenServiceId);if(d){buisnessServiceId=d.value}else{buisnessServiceId=""}}}else{buisnessServiceId=""}}}if(buisnessServiceId!=null&&buisnessServiceId!=""&&buisnessServiceId!="undefined"&&buisnessServiceId!="000000000000000"){if(isFlattenedCmdb){c="active_be¬flat_offering_bsid¬"+buisnessServiceId}else{c="active_be_parent¬offering_bsid¬"+buisnessServiceId}}else{if(isFlattenedCmdb){c="active_be¬flat_offering"}else{c="active_be_parent¬offering"}}}else{if(b.indexOf("FKBusinessService__c")!=-1){if(!f&&isFlattenedCmdb){c="active_be¬flat_service"}else{c="active_be_parent¬service"}}}return c}var IsConsoleClosedForm=true,typeAheadDivId="autocompleteDiv";function VIPClientIcon(a){}function setDivPosition(d){var c=[d.offsetLeft,d.offsetTop];var b;while(d.offsetParent!=null){var a=d.offsetParent;c[0]+=a.offsetLeft-a.scrollLeft;b=a.offsetTop-a.scrollTop;if(b<0){b=0}c[1]+=b;d=a}return c}function fetchTypeAheadData(b,h,g,i){try{if(b&&b.value==""){b.nextSibling.nextSibling.value="";b.nextSibling.nextSibling.nextSibling.value="";return}var f=b.nextSibling.nextSibling.nextSibling;setPopUpValueID(f.id);var c=(g.toLowerCase().replace(orgNamespace.toLowerCase(),""));var a=getFilterQueryString(c);queryData(b,h,i,a)}catch(d){}};