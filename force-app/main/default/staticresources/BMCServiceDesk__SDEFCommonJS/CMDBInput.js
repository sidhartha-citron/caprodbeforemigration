var lookupId,lookupName;var bubbleDisableTimer;function checkPrimaryClientRemoved(a,b,c){if(a.value==""&&c!=""&&a.value!=c&&(b=="PRIMARYCLIENT__C"||(!b.match("^primaryclient__c")&&b.match("primaryclient__c$")))){showPrimaryClientWarningMessage()}}function showPrimaryClientWarningMessage(){GetMessageBox("bmc-message").show({title:warningMessage,msg:_ServerValues.PCchangeMsg,buttons:Ext.Msg.OK,maxWidth:300,})}function checkBeforeLookup(j,a,g,n,i){var h="active_standard";var b=parseInt((screen.availWidth/2)-(1000/2));var k=parseInt((screen.availHeight/2)-(600/2));var l=encodeURIComponent(document.getElementById(a).value);if(l!=""&&l.length<2){l=""}var d="";if(filterStr){d=getFilterQueryString(g.toLowerCase())}if(n&&n.toLowerCase()=="businesshours"){var f=j.previousSibling.previousSibling;setPopUpValueID(f.id);var c="SearchAndLink?txt="+a+"&parentName=BMC_BaseElement__c&childName="+n+"&isLookUp="+n+"&filterId="+h+"&searchLookUpStr="+l+"&idValstr="+d;window.open(c,"lookup","status = 1,height =600, width = 1000,left= "+b+",top="+k+", resizable = yes,scrollbars=no")}else{var h="";var e="";var c="SearchAndLink?txt=changelookupValues&frm="+encodeURIComponent("{!$Component.CMDBGenericForm}")+"&parentName=BMC_BaseElement__c&childName="+n+"&isLookUp="+n+"&filterId=";if(n.toLowerCase()=="BMC_BaseElement__c".toLowerCase()){h="active_be";if(currentLookupId.toLowerCase()==("LookupIdBtn"+orgNamespace+"fkbusinessservice__c").toLowerCase()){h="no_filter&citype=subservice";e=getUrlParameter("InstanceID")}if(currentLookupId.toLowerCase()==("LookupIdBtn"+orgNamespace+"fklocation__c").toLowerCase()){h="no_filter&citype=location";e=getUrlParameter("InstanceID")}}if(n.toLowerCase()=="Model__c".toLowerCase()){h="active_custom&className="+currentClassName}if(n.toLowerCase()=="User".toLowerCase()){h="active_standard"}if(n.toLowerCase()=="Account".toLowerCase()){if(g==(orgNamespace+"vendor__c").toLowerCase()){h="active_custom&addlFilterId=acc_ven"}else{if(g==(orgNamespace+"Service_Provider__c").toLowerCase()){h="active_custom&addlFilterId=acc_sp"}else{h="active_custom"}}}c+=h+"&param1="+e+"&searchLookUpStr="+l+"&isCustomLookup=false&idValstr="+d;var m="";lkpApiName=g;if((g=="PRIMARYCLIENT__C"||(!g.match("^primaryclient__c")&&g.match("primaryclient__c$")))&&l!=""&&existingValue!=""){GetMessageBox("bmc-message").show({title:warningMessage,msg:_ServerValues.PCchangeMsg,buttons:Ext.Msg.OKCANCEL,maxWidth:300,fn:function(o){if(o=="ok"){window.open(c,"lookup","status = 1,height =600, width = 1000,left= "+b+",top="+k+", resizable = yes,scrollbars=no")}}})}else{window.open(c,"lookup","status = 1,height =600, width = 1000,left= "+b+",top="+k+", resizable = yes,scrollbars=no")}}}var lookupFilterMap={};function getLookupFilterData(){lookupFilterMap={};filterStr=filterStr;for(var a=0;a<filterStr.length;a++){var b=new Object();b.key=filterStr[a].key;b.value=filterStr[a].value;b.filterId=filterStr[a].filterId;lookupFilterMap[filterStr[a].key]=b}}var PE="П";var NONPRINT="¬";function getFilterQueryString(g){var h="";g=g.replace(orgNamespace.toLowerCase(),"");var f=lookupFilterMap[g];if(f){h=f.filterId+"«";var e=f.value;if(e){var d=e.split(PE);for(var c=0;c<d.length;c++){if(d[c]!=null&&d[c]!=""){var b=d[c].split(NONPRINT);h=h+b[0]+NONPRINT+getInputValue(b[1],b[2])+"«"}}}var a=h.length;if(a>0){h=h.substring(0,a-1)}h=encodeURIComponent(h)}return h}function getInputValue(h,d){var b=getHTMLInputID(h.toLowerCase());var g="";var c;var a=document.getElementsByName(b);if(a&&a[0]){g=a[0].value}if(d.indexOf("boolean")!=-1&&g.trim()==""){g="null"}else{if(d.indexOf("datetime")!=-1){var f=new Date();try{f=DateUtil.getDateTimeFromUserLocale(g)}catch(e){f=new Date(g)}g=getSOQLDateTimeString(f)}else{if(d.indexOf("date")!=-1){var f=new Date();try{f=DateUtil.getDateFromUserLocale(g)}catch(e){f=new Date(g)}g=getSOQLDateString(f)}else{if(d.indexOf("number")!=-1||d.indexOf("currency")!=-1||d.indexOf("percent")!=-1){if(g==null||g=="null"||g.trim()==""){g=0}}}}}return g}function getSOQLDateTimeString(a){return a.getUTCFullYear()+"-"+pad(a.getUTCMonth()+1)+"-"+pad(a.getUTCDate())+"T"+pad(a.getUTCHours())+":"+pad(a.getUTCMinutes())+":"+pad(a.getUTCSeconds())+"Z"}function getSOQLDateString(a){return a.getFullYear()+"-"+pad(a.getMonth()+1)+"-"+pad(a.getDate())}function pad(a){return a<10?"0"+a:a}function getHTMLInputID(b){var a=modelAttrMap[orgNamespace.toLowerCase()+b]?modelAttrMap[orgNamespace.toLowerCase()+b]:modelAttrMap[orgNamespace.toLowerCase()+b+"lkp"];if(a){return a.htmlId}a=modelAttrMap[b]?modelAttrMap[b]:modelAttrMap[b+"lkp"];if(a){return a.htmlId}return""}function callUserInfoDetail(eventObject,apiName,recId,clientType){if(recId!=""&&recId!="null"){if(prevTTUserID!=recId){eval(orgNamespace.replace("__","")).ConsoleRemoteActions.getClientInfo(recId,clientType,"isFromCMDBInstance",function(result,event){if(event.status){tooltipHtmlResult="";var fieldLabels=result.oblectFieldLabels;var fieldDisplayLabels=result.displayFieldLabels;if(result!=""&&result!=null){createUserInfoTooltip(result,apiName,recId,eventObject);prevTTUserID=recId;userInfoTooltipData=result;userInfoTooltip.update(generateUserTooltipInfoHTML(result,apiName,recId));userInfoTooltip.show()}}else{if(event.type==="exception"){alert(event.message)}}},{escape:true})}else{userInfoTooltip.setTarget(eventObject.target.id);userInfoTooltip.show()}}}function createUserInfoTooltip(a,c,d,b){if(typeof userInfoTooltip==="undefined"){userInfoTooltip=Ext.create("Ext.tip.ToolTip",{target:b.target.id,anchor:"left",shadow:false,autoWidth:true,autoHide:false,baseCls:"rfDPL-tooltip-container",bodyCls:"rfDPL-tooltip-body",html:null});userInfoTooltip.on("show",function(){var e;userInfoTooltip.getEl().on("mouseout",function(){e=window.setTimeout(function(){userInfoTooltip.hide()},500)});userInfoTooltip.getEl().on("mouseover",function(){window.clearTimeout(e)});Ext.get(userInfoTooltip.target).on("mouseover",function(){window.clearTimeout(e)});Ext.get(userInfoTooltip.target).on("wheel",function(){userInfoTooltip.hide()});Ext.get(userInfoTooltip.target).on("mouseout",function(){e=window.setTimeout(function(){if(userInfoTooltip){userInfoTooltip.hide()}},500)})})}else{userInfoTooltip.setTarget(b.target.id)}}function generateUserTooltipInfoHTML(q,u,E){var o=q.oblectFieldLabels;var v=q.displayFieldLabels;var d=false;var A="";var H=String.fromCharCode(172);var B=o.split(";");var G=v.split(H);var a=document.createElement("table");a.setAttribute("cellpadding","4");a.setAttribute("cellspacing","3");a.setAttribute("border","0");a.className="bubbleTableFont";for(var C=0;C<B.length-1;C++){if(q[B[C]]!=undefined){if(B[C]=="SmallPhotoUrl"){d=true}else{if(B[C]=="Name"){var k=document.createElement("tr");var y=document.createElement("td");y.className="bubbleTableRow";y.setAttribute("style","padding: 5px;");var e=document.createElement("A");var c=document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(G[C]));y.appendChild(c);k.appendChild(y);var x=document.createElement("td");x.setAttribute("style","padding :5px; white-space:nowrap; font-weight:bold;");var D=document.createTextNodeElement(RemedyForceHTMLProcessor.htmlDecoder(q[B[C]]));x.appendChild(D);k.appendChild(x);a.appendChild(k)}else{if(B[C]=="Username"){var j=document.createElement("tr");var w=document.createElement("td");w.setAttribute("style","padding: 5px;");w.className="bubbleTableRow";var m=document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(G[C]));var t=document.createElement("td");t.setAttribute("style","padding :5px; white-space:nowrap;");var e=document.createElement("A");e.setAttribute("href","#");e.setAttribute("class","CIlookupAnchorTag");if(typeof StdWorkspacesPage!="undefined"){e.setAttribute("onclick","window.open('"+StdWorkspacesPage+"&id="+E+"&node=ClientPage&fromstdCI=true');")}var b=document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(q[B[C]]));e.appendChild(b);w.appendChild(m);t.appendChild(e);j.appendChild(w);j.appendChild(t);a.appendChild(j)}else{if(B[C]=="Email"){var h=document.createElement("tr");var r=document.createElement("td");r.setAttribute("style","padding: 5px;");r.className="bubbleTableRow";var z=document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(G[C]));r.appendChild(z);var p=document.createElement("td");p.className="clsCmdLinkTooltip";p.setAttribute("style","padding: 5px; white-space:nowrap;");var g=document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(q[B[C]]));p.appendChild(g);h.appendChild(r);h.appendChild(p);a.appendChild(h)}else{if(B[C]!="AccountId"||hideAccount!="true"){var f=document.createElement("tr");var n=document.createElement("td");n.setAttribute("style","padding: 5px;");n.className="bubbleTableRow";var F=document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(G[C]));n.appendChild(F);var l=document.createElement("td");l.setAttribute("style","padding: 5px; white-space:nowrap;");var s=document.createTextNode(RemedyForceHTMLProcessor.htmlDecoder(q[B[C]]));l.appendChild(s);f.appendChild(n);f.appendChild(l);a.appendChild(f)}}}}}}}if(d){A+='<table class="rfDPL-tooltip-mainTable"><tbody><tr>';A+='<td class="rfDPL-tooltip-image-td"><img src="'+q.SmallPhotoUrl+'" class="rfDPL-tooltip-icon" /> </td>';A+='<td class="rfDPL-tooltip-content-td">'+a.outerHTML+"</td>"}else{A=a.outerHTML}return A}function removeHiddenValue(c){if(c.value==null||c.value==""){var f=c.id;if(f!=null&&f!=""){var e=f.split("_id_");var b=e[1].split("__x_");b[1]=parseInt(b[1])+1;var d;if(e[0].toUpperCase()=="BMC_BUSINESSSERVICE__C"){d=e[0]+"_id_fkbmc_baseelement__c__x_"+b[1]}else{d=e[0]+"_id_id__x_"+b[1]}var a=document.getElementById(d);a.value=""}if(currentTooltipId){document.getElementById(currentTooltipId).setAttribute("style","display:none")}}}function showdataCMDB(a,b){if(b.toLowerCase()=="service_owner__c"){showalldata(a,"",escape("IsStaffUser__c=true"))}else{if(b.toLowerCase()=="vendor__c"){showalldata(a,"",escape("vendor__c=true"))}else{if(b.toLowerCase()=="fkbusinessservice__c"){showalldata(a,"","SUBSERVICELOOKUPINSTANCEID"+BE_InstanceID)}else{if(b.toLowerCase()=="service_provider__c"){showalldata(a,"",escape("ServiceProvider__c=true"))}else{showalldata(a,"","")}}}}}function changeLookupId(b){if(b.value==""||b.value==null){var a=document.getElementById(b.id+"__hidden");if(a!=null){a.value=""}}}function checksubserviceoflabel(d,b,e){if(d.toUpperCase()=="SERVICETYPE__C"||d==b+"servicetype__c"){if(e.value.toUpperCase()=="OFFERING"){if(subserviceoflabel!=null&&subserviceoflabel!="undefined"){var a=document.createElement("label");var f=document.createAttribute("class");f.value="requiredField";a.setAttributeNode(f);a.appendChild(document.createTextNode("("+RequiredLabel+")"));subserviceoflabel.appendChild(a);renderstar=true}}else{var c=RemedyForceHTMLProcessor.getText(subserviceoflabel).split("("+RequiredLabel+")");RemedyForceHTMLProcessor.clearHTML(subserviceoflabel);subserviceoflabel.appendChild(document.createTextNode(c[0]));renderstar=false}}}function setCmdbInputText(c){var a=document.getElementById(c);if(a!=null){var b=a.disabled;if(b==true){a.readOnly=true}}}function setIdForHiddenVar(b,c,a,d){if(document.getElementById(b)!=null){document.getElementById(b).id=c}if(document.getElementById(a)!=null){document.getElementById(a).id=d}}var serviceTyepId="";function setServiceTypeforSRD(){setServiceType(serviceTyepId)}function setServiceType(b){if(serviceTyepId!=b){serviceTyepId=b}if(document.getElementById(b)!=null){var a=document.getElementById(b);if(ciType=="ServiceOffering"){a.selectedIndex=4;a.disabled=true}if(ciType=="BusinessService"){a.remove(4)}}}function setSubService(d,b,a,c){subserviceNameId=d;subserviceValId=b;if(a!=""&&document.getElementById(d)!=null){document.getElementById(d).value=a}if(c!=""&&document.getElementById(b)!=null){document.getElementById(b).value=c}}function setInstanceNameId(a){instanceNameTxtBoxID=a}function callGeneralInfoDetail(eventObject,apiName,recId){if(recId!=""&&recId!="null"){if(prevLocationID!=recId){var pageName="";var objectApiName="";if(apiName!=undefined){if(apiName.toLowerCase()==orgNamespace.toLowerCase()+"fklocation__c"||apiName.toLowerCase()=="fklocation__c"){pageName="AdminLocationPage";objectApiName="BMC_BaseElement__c"}else{if(apiName.toLowerCase()==orgNamespace.toLowerCase()+"fkmodel__c"||apiName.toLowerCase()=="fkmodel__c"){pageName="AdminModelPage";objectApiName="Model__c"}}}if(objectApiName!=""){eval(orgNamespace.replace("__","")).ConsoleRemoteActions.getObjectBubbleInfo(recId,objectApiName,"",function(result,event){if(event.status){prevLocationID=recId;if(result!=""&&result!=null){generalInfoTooltipData=result;generalInfoTooltipData.pageName=pageName;createGeneralInfoTooltip(result,apiName,recId,pageName,eventObject);generalInfoTooltip.update(generateGeneralInfoTooltipHTML(result,apiName,recId,pageName));generalInfoTooltip.show()}}else{if(event.type==="exception"){alert(event.message)}}},{escape:true})}}else{generalInfoTooltip.setTarget(eventObject.target.id);generalInfoTooltip.show()}}}function createGeneralInfoTooltip(b,d,e,a,c){if(typeof generalInfoTooltip=="undefined"){generalInfoTooltip=Ext.create("Ext.tip.ToolTip",{target:c.target.id,id:"tooltip"+e,anchor:"left",shadow:false,autoWidth:true,autoHide:false,baseCls:"rfDPL-tooltip-container",bodyCls:"rfDPL-tooltip-body",html:null});generalInfoTooltip.on("show",function(){var f;generalInfoTooltip.getEl().on("mouseout",function(){f=window.setTimeout(function(){generalInfoTooltip.hide()},500)});generalInfoTooltip.getEl().on("mouseover",function(){window.clearTimeout(f)});Ext.get(generalInfoTooltip.target).on("mouseover",function(){window.clearTimeout(f)});Ext.get(generalInfoTooltip.target).on("wheel",function(){generalInfoTooltip.hide()});Ext.get(generalInfoTooltip.target).on("mouseout",function(){f=window.setTimeout(function(){if(generalInfoTooltip){generalInfoTooltip.hide()}},500)})})}else{generalInfoTooltip.setTarget(c.target.id)}}function generateGeneralInfoTooltipHTML(p,s,B,j){var n=p.oblectFieldLabels;var t=p.displayFieldLabels;var y=n.split(";");var C=t.split("ф");var e=p.isFormulaHTMLFormatted.split(",");var a=document.createElement("table");a.setAttribute("cellpadding","4");a.setAttribute("cellspacing","3");a.setAttribute("border","0");a.className="bubbleTableFont";for(var z=0;z<y.length;z++){if(p[y[z]]!=undefined){if(y[z]=="Name__c"||y[z]=="Name"||y[z].toLowerCase()==orgNamespace.toLowerCase()+"name__c"){var l=document.createElement("tr");var w=document.createElement("td");w.className="bubbleTableRow";w.setAttribute("style","padding: 5px;");w.setAttribute("colspan","2");var d=document.createElement("A");if(s.indexOf("fkmodel__c")!=-1){d.setAttribute("href","javascript:openiframepopupWithExt4('"+j+"?id="+B+"&isReadOnly=true',650,900,'"+p[y[z]]+"')")}else{d.setAttribute("href","#");d.setAttribute("onclick","window.open('/apex/CMDBManager?cmdbRecordId="+B+"&isReadOnly=true','CMDB"+B+"')")}d.setAttribute("class","CIlookupAnchorTag");var c=document.createTextNode(jsInHTMLDecode(Sfdc.String.unescapeHtml(p[y[z]])));d.appendChild(c);w.appendChild(d);l.appendChild(w);var k=document.createElement("tr");var v=document.createElement("td");v.setAttribute("colspan","2");var A=document.createElement("HR");v.appendChild(A);k.appendChild(v);a.appendChild(l);a.appendChild(k)}else{if(y[z]=="Email"){var h=document.createElement("tr");var u=document.createElement("td");u.setAttribute("style","padding: 5px;");u.className="bubbleTableRow";var m=document.createTextNode(C[z]);var r=document.createElement("td");r.setAttribute("style","padding: 5px; word-wrap:break-word;");r.className="clsCmdLinkTooltip";var b=document.createTextNode(p[y[z]]);u.appendChild(m);r.appendChild(b);h.appendChild(u);h.appendChild(r);a.appendChild(h)}else{if(y[z]=="AccountId"&&hideAccount=="true"){}else{var g=document.createElement("tr");var q=document.createElement("td");q.setAttribute("style","padding: 5px;");q.className="bubbleTableRow";var x=document.createTextNode(C[z]);var o=document.createElement("td");o.setAttribute("style","padding: 5px; word-wrap:break-word;");var f;if(e[z].toLowerCase()=="true"){f=document.createElement("div");f.setAttribute("class","rfDPL-tooltip-content-anchor-tag-td");f.innerHTML=Sfdc.String.unescapeHtml(p[y[z]])}else{f=document.createTextNode(Sfdc.String.unescapeHtml(p[y[z]]))}q.appendChild(x);o.appendChild(f);g.appendChild(q);g.appendChild(o);a.appendChild(g)}}}}}return a.outerHTML}function callToolTipVisible(b){var a=document.getElementById("spanTTUserInfo"+b);if(a!=undefined){visibleTooltip=b;if(a.className!=undefined){if(a.className.indexOf("tooltipDisable")!=-1){a.className=a.className.replace("tooltipDisable","tooltipVisible")}else{if(a.className.indexOf("tooltipVisible")==-1){a.className=a.className+" tooltipVisible"}}}}}function callToolTipDisable(b){if(visibleTooltip==b){visibleTooltip=""}var a=document.getElementById("spanTTUserInfo"+b);if(a!=undefined){if(a.className!=undefined){if(a.className.indexOf("tooltipVisible")!=-1){a.className=a.className.replace("tooltipVisible","tooltipDisable")}else{if(a.className.indexOf("tooltipDisable")==-1){a.className=a.className+" tooltipDisable"}}}}}function setDisableTimer(a){if(a!=undefined&&a!=""){if(bubbleDisableTimer!=undefined){clearTimeout(bubbleDisableTimer)}bubbleDisableTimer=setTimeout(function(){if(visibleTooltip==a){callToolTipDisable(a)}},3000)}};