var servertime="",taskdata="",changeDone=false,clickedOnce=false,userHasAccesToInc,taboutFlag=true,selectedModuleName,keyName,keyValue,dueDateOpt,ownerIdString,doSave=false,saveFunctionRef,networklatencystart="",windowloaddate="",addStageProgression=window.parent.addStageProgression,taskCategory,taskId,taskState,taskName,closedStage,errormsg,chkBoxValue,isTaskPriorityChanged,impact,urgency,isCalcPriority,previousPriority="",currentPriority="",categoryIdForClose="",taskResolutionForClose="",link_Record,separator,disableTrue=true,isNoteEnableFlag=true,taskIdSet;insideNote=false;document.onclick=activateWindow,hideCustomFieldAccordion=true,recId="",displayIncEle=true,displayChangeEle=true,displayProblemEle=true;isError=false;var objName;Ext.onReady(function(){if(closedStage=="CLOSED"||closedStage=="Closed"){Ext.MessageBox.show({title:Information,msg:ClosedStage,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}getapplyTemplateCheckboxvalue();windowloaddate=new Date();networklatencystart=windowloaddate.getTime();var I=networklatencystart-etime;taskdata+=labelPM_netwokLatency;taskdata+=I;taskdata+="<br>";if(hideCustomFieldAccordion){var E=document.getElementById(TaskPageComp.ComponentVars.additionalFieldsPanelId);if(E!=null){E.style.display="none"}}Ext.QuickTips.init();if(isLookup){separator="";disableTrue=true}else{disableTrue=false;separator="-"}var D=function(e,K){var J=getIsCreateable();var M=getIsDeletable();var L=getIsUpdateable();openPage("TaskPageCustom?isCreateable="+J+"&isDeletable="+M+"&isUpdateable="+L,labelTaskWindowHeaderSearchPage,labelTaskWindowHeaderSearchPage);activeAllWindowFlag=false};var y="True";function j(){y="True";var J=getTaskDuedatetimeId();var e=document.getElementById(J).value}function q(){chkBoxValue=Ext.getCmp("task_inactive__c").getValue();j();if(y=="True"){saveBeforeCloseTask(chkBoxValue)}else{Ext.MessageBox.show({msg:labelValidDateTime,buttons:Ext.MessageBox.OK})}}var p=function(L,J){if(!inProgress){doSave=false;Ext.getCmp("saveId").setDisabled(true);chkBoxValue=Ext.getCmp("task_inactive__c").getValue();var O=getImpactNameId();var P=document.getElementById(O);var N="";if(P!=null){N=P.value}var S=getUrgencyNameId();var e=document.getElementById(S);var M="";if(e!=null){M=e.value}var K=getIsPriorityChangedValId();var R=document.getElementById(K).value;var Q=getDueDateCalculationOptionId();dueDateOpt=document.getElementById(Q);if(R!="false"&&taskId!=""&&taskId!=null&&N!=""&&M!=""){if(!automaticupdateduedate){openPopup("recalculateDueDate",showit,190,300)}else{if(dueDateOpt==null||dueDateOpt=="null"||typeof(dueDateOpt)=="undefined"){var Q=getDueDateCalculationOptionId();dueDateOpt=document.getElementById(Q);dueDateOpt.value=2}else{dueDateOpt.value=2}waitbox(0);saveTask(chkBoxValue)}}else{if(y=="True"){waitbox(0);saveTask(chkBoxValue)}else{Ext.MessageBox.show({msg:labelValidDateTime,buttons:Ext.MessageBox.OK})}}}else{doSave=true}};saveFunctionRef=p;var b=function(e,J){activeAllWindowFlag=false;callCopyPage()};var H=function(e,J){Ext.MessageBox.confirm(labelDelete,labelDeleteTaskPage,function(K){if(K==="yes"){deleteTask()}})};var u=getTaskDuedatetimeId();var m=function(e,J){resetTask()};var t=function(e,J){openPopup("SearchPage?popupId=Client&isLookup=true&filterClause="+escape("IsStaffUser__c=true")+"&isAssignTo=true",preAssignTaskTOStaff)};var r=function(e,J){openPopup("SearchPage?popupId=Client&isLookup=true&filterClause="+escape("profileid='"+profileId+"' And IsStaffUser__c=true")+"&isAssignTo=true",preAssignTaskTOStaff)};var f=function(e,J){selectedModuleName="staff";openPopup("SearchPage?popupId=SuggestedStaff&isLookup=true&isSuggestExpert=true&queueFor=Task__c&isQueurorUser=true&isActiveUser=true&categoryId="+taskCategory+"&filterClause="+escape("FKUser__r.IsStaffUser__c=true"),preAssignTaskTOSuggestedStaff)};var i=function(e,J){waitbox(0);assignTOMyself();handleChange(null)};var z=function(e,J){openPopup("SearchPage?popupId=Queue&isQueurorUser=true&isLookup=true&queueFor=Task__c&isOnlyQueueList=true&filterClause="+escape("sobjectType='"+objName+"'"),preAssignTaskTOQueue)};var a=function(e,J){var K=Ext.getCmp("templateBtnId");if(taskId!=null&&taskId!=""&&overwrite=="true"){Ext.MessageBox.confirm("",OverwriteWarning,function(L){if(L==="yes"){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Task'  and Hasrecurrence__c = false"),fetchTaskTemplates)}})}else{if((taskId!=null&&taskId!=""&&overwrite=="false"&&changeDone==true)||(taskId==null||taskId==""&&overwrite=="false"&&K.disabled==false&&changeDone==true)){Ext.MessageBox.confirm("",replaceUnsaved,function(L){if(L==="yes"){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Task'  and Hasrecurrence__c = false"),fetchTaskTemplates)}})}else{if(K.disabled==false){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Task'  and Hasrecurrence__c = false"),fetchTaskTemplates)}}}};var G=function(e,J){chkBoxValue=Ext.getCmp("task_inactive__c").getValue();waitbox(0);saveBeforeCloseTask(chkBoxValue)};var F=function(e,J){quickCloseTaskNext()};var l=function(e,J){reopenTask()};var d=function(e,J){getNoteIdVal().value="";if(window.parent.changeArray[wid]!=null&&typeof(window.parent.changeArray[wid])!="undefined"&&window.parent.changeArray[wid]!=-1){checkLoseChanges(previousTaskBtnHandler1)}else{if(document.getElementById("prevId").disabled!=true){previousTaskBtnHandler1()}}};var h=function(e,J){getNoteIdVal().value="";if(window.parent.changeArray[wid]!=null&&typeof(window.parent.changeArray[wid])!="undefined"&&window.parent.changeArray[wid]!=-1){checkLoseChanges(nextTaskBtnHandler1)}else{if(document.getElementById("nextId").disabled!=true){nextTaskBtnHandler1()}}};var C=Ext.extend(Ext.Panel,{renderTo:"btnToolbar",defaults:{bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"}});new C({id:"toolBarId",title:"",cls:"toolSpCls",bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;",tbar:[{scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:labelNew,id:"newId",hidden:disableTrue,handler:D}," ",{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:labelSave,id:"saveId",disabled:saveState,handler:p}," ",{scale:"medium",iconCls:"bmcCopy",tooltipType:"title",tooltip:labelCopy,id:"copyId",hidden:disableTrue,handler:b}," ","-"," ",{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:labelDelete,id:"deleteId",handler:H}," ",{scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:labelReset,id:"resetId",hidden:disableTrue,handler:m}," ",separator," ",{id:"assignToId",scale:"medium",iconCls:"bmcAssign1",tooltipType:"title",tooltip:labelAssignTo,hidden:disableTrue,menu:[{text:labelIncidentsStaff,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToStaffButtonId",disabled:assignStaffState,handler:t},{text:labelSuggestedExperts,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToSuggestedStaffButtonId",disabled:assignSuggestedStaffState,handler:f},{text:labelIncidentMyself,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToMyselfButtonId",disabled:assignMyselfState,handler:i},{text:labelIncidentMemberofProfName,id:"assignToMemberOfAdminButtonId",disabled:assignSuggestedStaffState,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:r},{text:labelQueue,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToQueueButtonId",handler:z}]}," ",{id:"actionId",scale:"medium",iconCls:"bmcAction1",tooltipType:"title",tooltip:labelActions,hidden:disableTrue,menu:[{text:labelIncidentClose,id:"closeButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",disabled:closeState,handler:G},{text:labelIncidentQuickClose,id:"quickCloseButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",disabled:closeState,handler:F},{text:labelReopenTask,id:"reopenButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",disabled:reOpenState,handler:l},{text:Print,disabled:IsNewRecord(taskId),icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printButtonId",handler:PrintBtnHandler},{text:PrintPDF,disabled:IsNewRecord(taskId),icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printPdfButtonId",handler:PrintPDFBtnHandler},"-",customActionJsonString]}," ",{scale:"medium",iconCls:"bmcTemplate",tooltipType:"title",tooltip:labelTemplate,id:"templateBtnId",disabled:templateFlag,hidden:disableTrue,handler:a,listeners:{disable:function(){this.setIconClass("bmcTemplateDisable")},enable:function(){this.setIconClass("bmcTemplate")}}}," ","-"," ",{scale:"medium",iconCls:"bmcCIExplorer",tooltipType:"title",tooltip:labelLaunchCIExplorer,id:"ciExplorerBtn",listeners:{mouseover:function(){this.setIconClass("bmcCIExplorerOn")},mouseout:function(){this.setIconClass("bmcCIExplorer")},disable:function(){this.setIconClass("bmcCIExplorerDisable")},enable:function(){this.setIconClass("bmcCIExplorer")}},handler:ShowCIExplorer},{scale:"medium",iconCls:"bmcEmailMessage",tooltipType:"title",tooltip:labelEmailMessage,id:"emailId",hidden:disableTrue,handler:sendEmailBtnHandler,listeners:{disable:function(){this.setIconClass("bmcEmailMessageDisable")},enable:function(){this.setIconClass("bmcEmailMessage")}}},new Ext.Toolbar.Fill(),{id:"task_inactive__c",xtype:"checkbox",width:93,color:"#004376",align:"top",checked:false,boxLabel:'<span class="checkboxLabelCls">'+labelInactive+"</span>"},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif",title:labelPreviousRecord},cls:"cursorCls",listeners:{render:function(e){e.el.on("click",d)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:labelNextRecord},cls:"cursorSpaceCls",listeners:{render:function(e){e.el.on("click",h)}}}]});new Ext.ToolTip({target:"task_inactive__c",anchor:"left",html:labelAPMTaskInactive});if(isInactive){Ext.getCmp("task_inactive__c").setDisabled(true)}if(copymetrue){Ext.getCmp("saveId").setDisabled(true)}var v=getTaskInactive();Ext.getCmp("task_inactive__c").setValue(v);taskId=getTaskId();taskState=getTaskState();if(taskId==null||taskId==""){Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("emailId").setDisabled(true)}else{if(taskId!=null&&taskState=="false"){if(typeof(isSILoaded)!="undefined"){disableAll()}}}if(taskId==null||taskId==""){Ext.getCmp("templateBtnId").setDisabled(false)}else{if(taskId!=null){if(setcheckboxvalueforTemplate=="true"){Ext.getCmp("templateBtnId").setDisabled(closeState)}else{Ext.getCmp("templateBtnId").setDisabled(true)}}}checkPermissions();document.getElementById("capsule").style.display="block";var w=new Ext.Panel({layout:"border",height:Ext.isIE7?670:Ext.isIE?674:Ext.isSafari?695:680,border:false,id:"canvasPanelId",cls:"canvasPanelCls",items:[{xtype:"panel",layout:"fit",overflow:"auto",autoScroll:true,split:false,width:"auto",height:485,cls:"northPanelCls",region:"center",contentEl:Ext.isIE?"capsule":taskFormComponent},{xtype:"panel",layout:"fit",overflow:"auto",border:false,id:"southPanelSI",autoScroll:true,split:true,collapsible:true,collapseMode:"mini",width:"auto",height:Ext.isIE?182:180,minHeight:Ext.isIE?120:150,animCollapse:false,region:"south",listeners:{resize:function(L,N,K,J,M){if(typeof(K)=="number"){document.getElementById("detailsDivSI").style.height=K+"px"}var e=document.getElementById("SIIframeID").style.display;if(e!="none"){if(typeof(window.frames.SIIframeID.setSouthPanelHeight)=="function"){window.frames.SIIframeID.setSouthPanelHeight(K,N)}}},collapse:function(){this.setWidth("auto")}},contentEl:"detailsDivSI"}],listeners:{afterlayout:function(e){e.layout.south.miniSplitEl.dom.qtip=labelDragResizeClickCollapse;e.layout.south.getCollapsedEl();e.layout.south.miniCollapsedEl.dom.qtip=labelClickToExpand},single:true}});var B=new Ext.Viewport({layout:"anchor",width:"auto",id:"viewportId",border:false,cls:"viewportCanvasCls",items:[{anchor:"100%",layout:"fit",items:w}]});ChangeBtnStatus(cilink_record);handleElemEvent();converdisabletoreadonly();var s=getNoRightsToViewEditVal();if(isRecordDeleted()){Ext.Msg.alert(Information,DeletedRecord,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}else{if(s){Ext.Msg.alert("",labelMsgNoAccessPerm,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}}if(taskId==null||taskId==""){var c=getUserLastname();var g=document.getElementById(c).value;if(g==null||g==""){try{document.getElementById(c).focus()}catch(A){}}document.getElementById("linkSIAvailTD").style.display="none";document.getElementById("noSIAvailTD").style.display="block"}else{var o=displaySI(cookieName,iFrameSrc);if(!o){displaySI(cookieName,iFrameSrc);if(document.getElementById("noSIAvailTD")!=null){document.getElementById("noSIAvailTD").style.display="none"}if(document.getElementById("noSIAvailTD")!=null){document.getElementById("linkSIAvailTD").style.display="block"}}Ext.getCmp("emailId").setDisabled(closeState)}if(copymetrue){copyCommit(chkBoxValue)}var x=new Date();var n=x.getTime();var k=(n-networklatencystart);taskdata+=labelPM_PageLoad;taskdata+=k;taskdata+="<br>"});function OpenHelpUrl(a){if(a.toLowerCase().indexOf("composeemailpage")!=-1){OpenHelppage("EmailConversationTask","module","form")}}function handleChange(b){if(b!=null){var a=b.target||b.srcElement;if(a!="undefined"&&a.id.match("taskNote__c")==null&&a.id.match("addNoteBt")==null){insideNote=true}}if(!clickedOnce){clickedOnce=true;changeDone=true;window.parent.registerChange(wid)}}function handleResetChange(){if(clickedOnce){clickedOnce=false;changeDone=false;window.parent.registerSave(wid)}}function checkSave(){if(doSave){saveFunctionRef()}}function afterSaveAction(){var b=getModuleName();var a=getParentWid();if(b!=null&&b!=""&&typeof(b)!="undefined"&&a!=null&&a!=""&&typeof(a)!="undefined"&&errormsg==labelSavedSuccessfully){return true}else{showError()}}function afterResetSI(){var b=getModuleName();var a=getParentWid();if(b!=null&&b!=""&&typeof(b)!="undefined"&&a!=null&&a!=""&&typeof(a)!="undefined"&&(errormsg==labelSavedSuccessfully||errormsg=="")){window.parent.registerSave(wid);window.parent.parent.refreshSupportingInformation(a,b)}}function afterDelteAction(){var b=getModuleName();var a=getParentWid();if(b!=null&&b!=""&&typeof(b)!="undefined"&&a!=null&&a!=""&&typeof(a)!="undefined"){window.parent.parent.refreshSupportingInformation(a,b)}}function afterSaveCloseAction(){waitMsg.hide();if(errormsg==labelSavedSuccessfully){openPopupWithTitle("CloseTask?taskId="+getTaskId()+"&isLookup=true&categoryId="+categoryIdForClose+"&taskResolution="+taskResolutionForClose,closeTaskNext,labelCloseTask,380,600)}else{showError()}}function senddata(){var a=taskdata;return a}function FetchUrgency(){FetchUrgencyDetails()}function fetchUrgencyForCategory(){var c=getCategoryNameId();var g=document.getElementById(c).value;var h=getCategoryIdVal();var f=document.getElementById(h).value;var a=getCategoryFKUrgency();var e=document.getElementById(a).value;var d=getUrgencyIdVal();var b=document.getElementById(d).value;if(g!=null&&g!=""&&f!=null&&f!=""&&e!=null&&e!=""&&e!=b){setCategoryNext(g)}}function calculatePriority(){var f=getImpactNameId();var l=document.getElementById(f);var i="";if(l!=null){i=l.value}var b=getUrgencyNameId();var a=document.getElementById(b);var e="";if(a!=null){e=a.value}var h=getImpactIdVal();var d=document.getElementById(h);var k="";if(d!=null){k=d.value}var j=getUrgencyIdVal();var g=document.getElementById(j);var c="";if(g!=null){c=g.value}if(i!=""&&e!=""&&k!=""&&c!=""){calculatePriorityNext()}}function openImpactLookup(a){if(a!=null&&a!=""){setImpactNext(a)}}function openUrgencyLookup(a){if(a!=null&&a!=""){setUrgencyNext(a)}}function selectImpactOnName(){var b=getImpactIdVal();var a=document.getElementById(b).value;if(a!=null&&a!=""){FetchPriorityHTTP()}}function selectUrgencyOnName(){var b=getUrgencyIdVal();var a=document.getElementById(b).value;if(a!=null&&a!=""){calculatePriority()}}function ChangeBtnStatus(a){if(a=="false"){Ext.getCmp("ciExplorerBtn").disable()}else{Ext.getCmp("ciExplorerBtn").enable()}}function ShowCIExplorer(){var c=AssignNewTaskId();var d=labelCIExpCIExplorer;var a=escape("CIExplorerLauncher?Module=Task__c&RecordSequence="+c+"&id="+c);var b="NavigatorPage?title="+d+"&target="+a;window.parent.parent.addNewTab("CIExplorerLauncher",labelConfigurationItemsExplorer,b)}var sendEmailBtnHandler=function(a,b){openPopupWithTitle("ComposeEmailPage?recordId="+taskId+"&isNew=true&objectName=Task__c",composeMailOnCompleteIn,labelComposeEmailPageHeader+taskName,getEmailWinHt(),getEmailWinWidth(),false)};function getTSKid(a,b){if(errormsg==null||errormsg==""||errormsg==labelSavedSuccessfully){if(isLookup){window.frames.SIIframeID.setId(a,b)}else{window.frames.SIIframeID.setId(a,b)}}}function callCopyPage(){var a=getIsCreateable();var c=getIsDeletable();var b=getIsUpdateable();window.parent.addTab("TaskPageCustom?copyId="+taskId+"&isCreateable="+a+"&isDeletable="+c+"&isUpdateable="+b,labelTaskWindowHeaderSearchPage,labelTaskWindowHeaderSearchPage)}function closeWindow(){if(isLookup){window.parent.refreshDocs();window.parent.closePopup()}else{window.parent.refreshList();window.parent.closeTab(wid)}}function showit(b){if(dueDateOpt==null||dueDateOpt=="null"||typeof(dueDateOpt)=="undefined"){var a=getDueDateCalculationOptionId();dueDateOpt=document.getElementById(a);dueDateOpt.value=b}else{dueDateOpt.value=b}var c=Ext.getCmp("task_inactive__c").getValue();waitbox(0);saveTask(c)}function previousTaskBtnHandler1(){var b="";var a=0;while(taskIdSet.length>a){if(b==""){b=taskIdSet[a]}else{b=b+","+taskIdSet[a]}a++}previousTaskBtnHandler(b)}function nextTaskBtnHandler1(){var b="";var a=0;while(taskIdSet.length>a){if(b==""){b=taskIdSet[a]}else{b=b+","+taskIdSet[a]}a++}nextTaskBtnHandler(b)}function showData(d,c,b,a){if(taboutFlag!=true){if(typeof(c)!="undefined"&&typeof(b)!="undefined"){if(typeof(a)!="undefined"){showalldata(d,c,b,a)}else{showalldata(d,c,b)}}else{if(typeof(c)!="undefined"&&typeof(b)=="undefined"){showalldata(d,c)}else{showalldata(d)}}}else{if(typeof(c)!="undefined"){c()}}}function buttonValidator(){if(((categoryRequired=="false")||(taskCategory!=null&&taskCategory!=""))&&(errormsg==null||errormsg==""||errormsg==labelSavedSuccessfully)){Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconClass("bmcDelete");Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("printButtonId").setDisabled(false);Ext.getCmp("printPdfButtonId").setDisabled(false);if(setcheckboxvalueforTemplate=="true"){Ext.getCmp("templateBtnId").setDisabled(false);Ext.getCmp("templateBtnId").setIconClass("bmcTemplate")}else{Ext.getCmp("templateBtnId").setDisabled(true);Ext.getCmp("templateBtnId").setIconClass("bmcTemplateDisable")}Ext.getCmp("emailId").setDisabled(false);Ext.getCmp("resetId").setDisabled(false);var a=document.getElementById("SIIframeID").style.display;if(cookieValue=="true"&&a=="none"){SIComp(iFrameSrc)}else{if(a=="none"){document.getElementById("noSIAvailTD").style.display="none";if(Ext.isChrome){document.getElementById("onDemandSITableId").style.display="inline-table";document.getElementById("linkSIAvailTD").style.display="table-cell"}else{document.getElementById("onDemandSITableId").style.display="block";document.getElementById("linkSIAvailTD").style.display="block"}}}}checkPermissions()}function checkPermissions(){var c=getIsCreateable();var a=getIsDeletable();var d=getIsUpdateable();if(getIsCreateable()=="false"){Ext.getCmp("newId").setDisabled(true);Ext.getCmp("copyId").setDisabled(true)}if(getIsDeletable()=="false"){Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable")}if(getIsUpdateable()=="false"){Ext.getCmp("closeButtonId").setDisabled(true);Ext.getCmp("reopenButtonId").setDisabled(true);Ext.getCmp("quickCloseButtonId").setDisabled(true);Ext.getCmp("assignToMyselfButtonId").setDisabled(true);Ext.getCmp("assignToStaffButtonId").setDisabled(true);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(true);Ext.getCmp("assignToQueueButtonId").setDisabled(true);Ext.getCmp("assignToSuggestedStaffButtonId").setDisabled(true)}if(getIsCreateable()=="false"&&getIsUpdateable()=="false"){Ext.getCmp("saveId").setDisabled(true)}var b=getTaskId();if(getIsCreateable()=="true"&&getIsUpdateable()=="false"&&b!=null&&b!=""){Ext.getCmp("saveId").setDisabled(true)}}function openCategoryPage(a){if(a!=null||a!=""){if(a[0]!=null||a[0]!=""){setCategoryNext(a[0])}if(a[1]!=null||a[1]!=""){setDescriptionNext(a[1])}if(a[2]!=null||a[2]!=""){setResolutionNext(a[2])}}}function reopenTask(){reopenTaskNext()}function showInfoPopup(b,a,f){var e="";var g=b.target;if(g==null){g=b.srcElement}if(f=="staff"){var c=getStaffHiddeninput();e=document.getElementById(c).value;tooltipforstaff()}if(e!=""&&e!=null){var d=new Ext.ToolTip({target:g.id,title:"",anchor:"right",width:200,trackMouse:true,shadow:"sides",bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",dismissDelay:20000,html:document.getElementById(a).innerHTML})}}function callByChild(){var a=getTaskResolutionId();return document.getElementById(a).value}function ellipse(b,a){if(b.length>a){return b.substr(0,a-3)+"..."}return b}function formCSZString(d,c,b){var a="";if(d!=""){a=ellipse(d,33)+", "}if(c!=""){a=a+ellipse(c,33)+" "}if(b!=""){a=a+ellipse(b,33)}return a}function handleSaveJs(a){window.parent.handleSave(wid,a)}function resizeGridProgressionJS(b,c){var a=function a(){if(Ext.getCmp("southPanelSI")!=undefined){Ext.getCmp("southPanelSI").setWidth(Ext.getCmp("southPanelSI").getWidth())}};if(window.parent.refreshGridSI!=undefined){window.parent.refreshGridSI(wid,a)}if(!isLookup){window.parent.addStageProgression(wid,b)}if(isLookup){window.parent.changePopUpTitle(c)}}function taskIdSetJS(b,c,a){if(taskIdSet==null||taskIdSet==""){if(b==""){if(typeof(window.parent.returnListOfId)=="function"){taskIdSet=window.parent.returnListOfId()}}else{if(typeof(window.parent.parent.getIdArray)=="function"){taskIdSet=window.parent.parent.getIdArray()}handleSave(c,a)}}}function checkLoogedInUserHasAccessJS(a){if(a=="false"&&taskId!=""&&taskId!=null&&taskId!="null"){window.parent.refreshList();window.parent.closeTab(wid)}}function assignNewTaskIdJS(a){return a}function checkEnableJS(g,f,b,e,d,a,c){if((errormsg==null||errormsg==""||errormsg==labelSavedSuccessfully)&&!isError){Ext.getCmp("assignToMyselfButtonId").setDisabled(g);Ext.getCmp("assignToQueueButtonId").setDisabled(f);Ext.getCmp("assignToStaffButtonId").setDisabled(b);Ext.getCmp("assignToSuggestedStaffButtonId").setDisabled(e);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(e);Ext.getCmp("quickCloseButtonId").setDisabled(d);Ext.getCmp("closeButtonId").setDisabled(d);Ext.getCmp("reopenButtonId").setDisabled(c);Ext.getCmp("emailId").setDisabled(d)}Ext.getCmp("saveId").setDisabled(a);Ext.getCmp("templateBtnId").setDisabled(getApplyTemplate(a))}function initTaskJS(b,e,d,i,f,c,g,a,j,h){taskName=b;taskCategory=e;taskId=d;isTaskPriorityChanged=i;impact=f;urgency=c;isCalcPriority=g;currentPriority=a;categoryIdForClose=j;taskResolutionForClose=h}function setSelectedModuleName(a){selectedModuleName=a}function refreshRelatedPortletsJS(){if(typeof(window.parent.parent.refreshPortletByTitle)=="function"){window.parent.parent.refreshPortletByTitle("Action Items")}}function resetSupportingInformationJS(d,b,c){var a=document.getElementById("SIIframeID").style.display;if(a!="none"){if(!d){window.frames.SIIframeID.disableAll()}else{window.frames.SIIframeID.enableAll()}getTSKid(b,c)}}function changeTitleAddStageProgressionJS(d,b,a,c){if(d==a){d=c}window.parent.changeTitle(wid,d,d);window.parent.addStageProgression(wid,b);window.parent.needsRefresh=true}function tooltipforstaffJS(f,a,e,c,b,d){strSingleLineText=document.getElementById("userAddressforttdivId").innerHTML.replace(new RegExp("\\n","g")," ");document.getElementById("userAddressforttdivId").innerHTML=ellipse(strSingleLineText,33);document.getElementById("userNameforttdivId").innerHTML=ellipse(f,50);document.getElementById("userTitleforttdivId").innerHTML=ellipse(a,40);document.getElementById("userCSZforttdivId").innerHTML=e;document.getElementById("userCountryforttdivId").innerHTML=ellipse(c,33);document.getElementById("userPhoneforttdivId").innerHTML=ellipse(b,33);document.getElementById("userEmailforttdivId").innerHTML='<a href="'+d+'" class="clsCmdLinkTooltip">'+ellipse(d,33)+"</a>"}function setAssignedToJS(){taboutFlag=false;if(ownerIdString!=null&&ownerIdString!=""&&ownerIdString!="undefined"){setAssignedTo(ownerIdString)}}function setTaskDataJS(a){servertime=taboutservertime+vservertime+siservertime+(a-taskstart);taskdata+=servertime;taskdata+="<br>"}function writeCookie(){if(document.getElementById("configureSIId").checked){createSICookie(cookieName,"true");var a=displaySI(cookieName,iFrameSrc)}}function afterAddNote(){var a=document.getElementById("SIIframeID").style.display;if(cookieValue!="true"&&a=="none"){SIComp(iFrameSrc)}else{if(a!="none"){window.frames.SIIframeID.refreshDocs()}}}function siControlBack(){var b=Ext.util.Cookies.get(cookieName);var a=document.getElementById("SIIframeID").style.display;if((b==null||b=="false")&&a=="none"){afterResetSI()}}function SetTaskCategory(b){var a=getCategoryNameId();if(b!=null&&b!=""){taskCategory=document.getElementById(a).value}}function preAssignTaskTOStaff(a){waitbox(0);assignTaskTOStaff(a);if(a!=null&&a!="undefined"&&a!=""){handleChange(null)}}function preAssignTaskTOSuggestedStaff(a){waitbox(0);if(selectedModuleName=="queue"){assignTaskTOQueue(a)}else{assignTaskTOSuggestedStaff(a)}if(a!=null&&a!="undefined"&&a!=""){handleChange(null)}}function preAssignTaskTOQueue(a){waitbox(0);assignTaskTOQueue(a);if(a!=null&&a!="undefined"&&a!=""){handleChange(null)}}function getClientTypeAndRecordId(){if(document.getElementById(userId)!=null){recId=document.getElementById(userId).value}clientType="User";if(recId==""){if(document.getElementById(contactId)!=null){recId=document.getElementById(contactId).value}clientType="Contact"}if(recId==""){if(document.getElementById(leadId)!=null){recId=document.getElementById(leadId).value}clientType="Lead"}}function showClientDetails(eventObject){var target=eventObject.target;if(target==null){target=eventObject.srcElement}getClientTypeAndRecordId();var tooltipHtmlResult="";if(!remoteCallFlag&&recId!=""){remoteCallFlag=true;eval(orgNamespace).ClientInfo.getClientInfo(recId,clientType,accName,function(result,event){if(event.status){tooltipHtmlResult="";if(result!=""&&result!=null){var fieldLabels=result.oblectFieldLabels;var fieldDisplayLabels=result.displayFieldLabels;var delimiter=String.fromCharCode(172);tooltipHtmlResult='<table cellpadding=4 cellspacing=3 border=0 width="290" style="table-layout:fixed; font-size:11px;">';var fieldListArray=fieldLabels.split(";");var fieldDisplayArray=fieldDisplayLabels.split(delimiter);var i=0;for(i=0;i<fieldListArray.length-1;i++){if(result[fieldListArray[i]]!=undefined){if(fieldListArray[i]=="Name"){tooltipHtmlResult+='<tr><td width="40%" style="font-weight:bold; word-wrap:break-word;">'+fieldDisplayArray[i]+'</td><td style="white-space:normal; font-weight:bold; word-wrap:break-word;">'+result[fieldListArray[i]]+"</td></tr>"}else{if(fieldListArray[i]=="Email"){tooltipHtmlResult+='<tr><td style="font-weight:bold; word-wrap:break-word;" >'+fieldDisplayArray[i]+'</td><td style="word-wrap:break-word;" class="clsCmdLinkTooltip">'+result[fieldListArray[i]]+"</td></tr>"}else{tooltipHtmlResult+='<tr><td style="font-weight:bold; word-wrap:break-word;" >'+fieldDisplayArray[i]+'</td><td style="word-wrap:break-word;">'+result[fieldListArray[i]]+"</td></tr>"}}}}tooltipHtmlResult+="</table>";tooltipforclient=new Ext.QuickTip({target:target.id,anchor:"left",width:Ext.isIE?Ext.isIE7?305:295:308,trackMouse:false,bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",hideDelay:3000,dismissDelay:5000,html:tooltipHtmlResult});Ext.sequence(Ext.QuickTip.prototype,"afterRender",function(){this.mon(this.el,"mouseover",function(){this.clearTimer("hide");this.clearTimer("dismiss")},this);this.mon(this.el,"mouseout",function(){this.clearTimer("show");if(this.autoHide!==false){this.delayHide()}},this)});tooltipforclient.show()}}else{if(event.type==="exception"){alert(event.message)}}},{escape:true})}else{if(tooltipforclient!=null){tooltipforclient.show()}}}function getCustomActionURL(customId){var taskId=getTaskId();eval(orgNamespace).JSRemoteActions.getCustomActionURL("Task",taskId,customId,function(result,event){if(event.status){if(result!=""&&result!=null){urlStringVar=result;openUrl()}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:true})}function OpenRecord(a){var c=getWID();var e;var b=getModuleName();var d;if(a=="IncidentPage"){e=getIncId();getIncNameEle().style.color="#800080";d=a+escape("?id="+e+"&parentWid="+c+"&moduleName="+b+"&isDirect=true&columnField=name&direction=DESC");if(e!=null&&e!="undefined"&&typeof(e)!="undefined"){window.parent.parent.addNewTab(a,labelIncidentPlural,"NavigatorPage?title="+getIncidentName()+"&tabTitle="+getIncidentName()+"&target="+d)}}else{if(a=="ChangeRequestPage"){e=getCRId();getCRNameEle().style.color="#800080";d=a+escape("?id="+e+"&parentWid="+c+"&moduleName="+b+"&isDirect=true&columnField=name&direction=DESC");if(e!=null&&e!="undefined"&&typeof(e)!="undefined"){window.parent.parent.addNewTab(a,labelCRPlural,"NavigatorPage?title="+getCRName()+"&tabTitle="+getCRName()+"&target="+d)}}else{if(a=="ProblemPage"){e=getProblemId();getProblemNameEle().style.color="#800080";d=a+escape("?id="+e+"&parentWid="+c+"&moduleName="+b+"&isDirect=true&columnField=name&direction=DESC");if(e!=null&&e!="undefined"&&typeof(e)!="undefined"){window.parent.parent.addNewTab(a,labelProblemPlural,"NavigatorPage?title="+getProblemName()+"&tabTitle="+getProblemName()+"&target="+d)}}}}}function hideIncChangeProbEle(){var c=document.getElementById("incidentEle");if(displayIncEle&&c!=null){c.style.display="none"}var a=document.getElementById("changeEle");if(displayChangeEle&&a!=null){a.style.display="none"}var b=document.getElementById("problemEle");if(displayProblemEle&&b!=null){b.style.display="none"}}function getApplyTemplate(a){if(taskId!=null&&taskId!=""){if(setcheckboxvalueforTemplate=="true"){return(a)}else{return true}}return true}function composeMailOnCompleteIn(){var a=document.getElementById("SIIframeID").style.display;if(window.frames.SIIframeID!=null&&typeof(window.frames.SIIframeID)!="undefined"){if(a!="none"){document.getElementById("SIIframeID").contentWindow.composeMailOnComplete()}}}function refreshDesc(){var a=document.getElementById("task_taskDescription__c");if(a!=null&&typeof(a)!="undefined"){a.value=taskDesc;a.nextSibling.value=taskDesc}}function refreshResolution(){var a=document.getElementById("task_taskResolution__c");if(a!=null&&typeof(a)!="undefined"){a.value=taskResolution;a.nextSibling.value=taskResolution}};