var g_loadTime=new Date(),startTime=new Date(),test="",durationError=0,serverTime="39",networklatencystart="",windowloaddate="",v1,doSave=false,saveFunctionRef,clickedOnce=false,taboutFlag=true,keyName,keyValue,reqDtlsId="",selectedModuleName,incidentclientId,ownerIdString,priorityString,priorityNameString,isValid="True",CI_value,service_value,stgName,CI_state,userHasAccesToInc,clientID,categoryId,orgId,incidentId,clientName,incidentCategory,errormsg,chkBoxValue,incidentCategoryId="",separator,disableTrue=true,isDormantSection=false,idset,NoRightsToViewEdit,timeoutreturn,objName,isServiceRequest,loggedInUserId="",loggedInUserFirstName="",loggedInUserLastName="",primaryCI="",pageloadstartdate=new Date();insideNote=false;isNoteEnableFlag=true;changeDone=false;var incnState=true;var OfferingClause="";var soqlDateClause;var businessServiceClause;document.onclick=activateWindow;var resizeGrid=function resizeGrid(){if(Ext.getCmp("southPanelSI")!=undefined){Ext.getCmp("southPanelSI").setWidth(Ext.getCmp("southPanelSI").getWidth())}};function RequestDetailId(a){document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value=a;renderRequestDetails(a)}function initFunc_1(){if(window.parent.refreshGridSI!=undefined){window.parent.refreshGridSI(wid,resizeGrid)}if(isLookup){window.parent.changePopUpTitle("{!objLabel}")}}function setSelectedModuleName(a){selectedModuleName=a}function ShowCIExplorerJS(d,c){var a=escape("CIExplorerLauncher?Module=Incident__c&RecordSequence="+incidentId+"&id="+incidentId);var b="NavigatorPage?title="+d+"&target="+a;window.parent.parent.addNewTab("CIExplorerLauncher",c,b)}function ChangeCIExpBtnStatusJS(b,a){CI_value=document.getElementById(b).value.trim();if(0==CI_value.length){document.getElementById(a).disabled=true}else{document.getElementById(a).disabled=false}}function DisableCIExpBtnJS(c,a){var b=document.getElementById(c).value.trim();if((CI_value!=b)||(0==b.length)){document.getElementById(a).disabled=true}}function handleResetChange(){if(clickedOnce){clickedOnce=false;changeDone=false;window.parent.registerSave(wid2)}}function handleChange(b){if(b!=null){var a=b.target||b.srcElement;if(a!="undefined"&&a.id.match("incidentNote__c")==null&&a.id.match("addNoteBt")==null){insideNote=true}}if(!clickedOnce){clickedOnce=true;changeDone=true;window.parent.registerChange(wid2)}}function setIncForCategoryEnabledJS(a){var b="";if(document.getElementById(a)!=null&&document.getElementById(a)!=""){b=document.getElementById(a).value}if(b!=null&&b!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}}function checkIDSet(){if(idset==null||idset==""){if(getIsDirect()==""){if(typeof(window.parent.returnListOfId)=="function"){idset=window.parent.returnListOfId()}}else{if(typeof(window.parent.parent.getIdArray)=="function"){idset=window.parent.parent.getIdArray()}window.parent.handleSave(getWID(),getID())}}}function senddata(){return data}function setClientDetailsJS(a){setClientNext(returnvalue);if(returnvalue!=null){document.getElementById(a).value=returnvalue}}function afterSaveCloseAction(){waitMsg.hide();if(errormsg==IncidentPage.Labels.SavedSuccessfully){closeIncident()}else{showError()}}var showit=function(a){document.getElementById(dueDateCalculationOptionJS).value=a;saveRecords()};function disableRequestDetailBtn(){var b=document.getElementById(IncidentPageComp.ComponentVars.reqDefinationID).value;var a=document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value;if((b==null||b=="")&&(a==null||a=="")){document.getElementById("reqDetailBtn").disabled=true}else{document.getElementById("reqDetailBtn").disabled=false}}Ext.onReady(function(){primaryCI=document.getElementById(IncidentPageComp.ComponentVars.BaseElementIDName).value;if(stgName=="CLOSED"||stgName=="Closed"){Ext.MessageBox.show({title:IncidentPage.Labels.Information,msg:IncidentPage.Labels.ClosedStage,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}getapplyTemp();createControlMap();renderElementsByType();windowloaddate=new Date();networklatencystart=windowloaddate.getTime();var h=networklatencystart-etime;data+=IncidentPage.Labels.PM_netwokLatency;data+=h;data+="<br>";Ext.QuickTips.init();if(isLookup){disableTrue=true;separator=""}else{disableTrue=false;separator="-"}var p=function(e,P){openPage("IncidentPage",IncidentPage.Labels.IncidentWindowHeaderSearchPage,IncidentPage.Labels.IncidentWindowHeaderSearchPage);activeAllWindowFlag=false};var r=function(e,P){followIncidentToggler()};var s=function(T,P){var W=ValidateForm();if(W==true){if(!inProgress){doSave=false;var R=document.getElementById(IncidentPageComp.ComponentVars.IncidentDescription).value;var aa=document.getElementById(IncidentPageComp.ComponentVars.IncidentResolution).value;var Z=document.getElementById(IncidentPageComp.ComponentVars.IsPriorityChanged).value;var X=document.getElementById(IncidentPageComp.ComponentVars.DueDateCalculationOption).value;var Y=document.getElementById(IncidentPageComp.ComponentVars.ImpactIDName);var V="";if(Y!=null){V=Y.value}var e=document.getElementById(IncidentPageComp.ComponentVars.UrgencyIDName);var U="";if(e!=null){U=e.value}var Q=R.length;if(!Ext.isIE&&R!=null){if(null!=R.match(/[^\n]*\n[^\n]*/gi)){Q=Q+R.match(/[^\n]*\n[^\n]*/gi).length}}var S=aa.length;if(!Ext.isIE&&aa!=null){if(null!=aa.match(/[^\n]*\n[^\n]*/gi)){S=S+aa.match(/[^\n]*\n[^\n]*/gi).length}}if(Q<=32000&&S<=32000){if(Z=="true"&&incidentId!=""&&incidentId!=null&&V!=""&&U!=""&&isDueDateOverridenByServiceTarget()==false){if(!automaticupdateduedate){openPopup("recalculateDueDate",showit,190,300)}else{document.getElementById(dueDateCalculationOptionJS).value=2;saveRecords()}}else{saveRecords()}}else{if(Q>32000){Ext.MessageBox.show({msg:IncidentPage.Labels.Description+": "+IncidentPage.Labels.TextAreaOverflow,width:300,buttons:Ext.MessageBox.OK})}else{if(S>32000){Ext.MessageBox.show({msg:IncidentPage.Labels.Resolution+": "+IncidentPage.Labels.TextAreaOverflow,width:300,buttons:Ext.MessageBox.OK})}}}}else{doSave=true}}};saveFunctionRef=s;var o=function(e,P){updateDescription();KMdescription=KMdescription.replace(/</g,"&lt;");KMdescription=encodeURIComponent(KMdescription);openPopupforKM("KnowledgeSearch?calledFromForm=true&search="+KMdescription+"&KMincidentID="+incidentId,"",globalSearch,615,680)};var I=function(e,P){openPopupForServiceTarget("SearchPage?popupId=IncidentServiceTarget&isLookup=true&amp;filterClause="+escape("FKIncident__c='"+incidentId+"'"),("#"+incidentName+" "+IncidentPage.Labels.ServiceTargets))};var c=function(e,P){openPopupWithTitle("ComposeEmailPage?recordId="+incidentId+"&isNew=true&objectName=Incident__c",composeMailOnCompleteIn,IncidentPage.Labels.ComposeEmailPageHeader+incidentName,getEmailWinHt(),getEmailWinWidth(),false)};var H=function(e,P){clearIncident();Ext.getCmp("incident_inactive__c").setValue(false)};var f=function(e,P){activeAllWindowFlag=false;callCopyPage()};var E=function(e,P){document.getElementById(IncidentPageComp.ComponentVars.DueDateTime).value="";resetIncident()};var u=function(e,P){Ext.MessageBox.confirm(IncidentPage.Labels.Delete,IncidentPage.Labels.DeleteIncidentPage,function(Q){if(Q==="yes"){deleteIncident()}})};var G=function(e,P){AssignedToStaff()};var M=function(e,P){openPopup("SearchPage?popupId=Client&isLookup=true&additional_columns= name,username,firstname,lastname,phone,extension,email,ProfileId,Profile.Name&filterClause="+escape("profileid='"+getProfileID()+"'And IsStaffUser__c=true ")+"&isAssignTo=true",preSetAssignedToStaffNext)};var b=function(e,P){AssignToSuggestedStaff()};var m=function(e,P){AssignedToMyself()};var x=function(e,P){openPopup("SearchPage?popupId=Queue&isQueurorUser=true&isLookup=true&queueFor=Incident__c&isOnlyQueueList=true&additional_columns=Queue.Name,QueueId&filterClause="+escape("sobjectType='"+objName+"'"),preSetAssignedToSuggestedStaffNext)};var v=function(e,P){AssignedToClear()};var J=function(e,P){saveBeforeCloseRecords()};var i=function(e,P){quickCloseIncident()};var C=function(e,P){reopenIncident()};var d=function(e,P){incidentForClient()};var d=function(e,P){incidentForClient()};var t=function(e,P){incidentForCatagory()};var q=function(e,P){window.parent.registerChange(wid2);respondedBtnHandler()};var B=function(e,P){myselfBtnHandler()};var F=function(e,P){callCounterBtnHandler()};var O=function(e,P){if(window.parent.changeArray[wid2]!=null&&typeof(window.parent.changeArray[wid2])!="undefined"&&window.parent.changeArray[wid2]!=-1){checkLoseChanges(previousIncidentBtnHandler1)}else{if(document.getElementById("prevId").disabled!=true){previousIncidentBtnHandler1()}}};var j=function(e,P){if(window.parent.changeArray[wid2]!=null&&typeof(window.parent.changeArray[wid2])!="undefined"&&window.parent.changeArray[wid2]!=-1){checkLoseChanges(nextIncidentBtnHandler1)}else{if(document.getElementById("nextId").disabled!=true){nextIncidentBtnHandler1()}}};var n=function(e,P){getIncProcBtnHandler()};var l=function(e,P){var Q=Ext.getCmp("templatebutton");if(incidentId!=null&&incidentId!=""&&overwrite=="true"){Ext.MessageBox.confirm("",IncidentPage.Labels.OverwriteWarning,function(R){if(R==="yes"){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Incident' and Hasrecurrence__c = false"),fetchIncidentTemplates,500,625)}})}else{if((incidentId!=null&&incidentId!=""&&overwrite=="false"&&changeDone==true)||(incidentId==null||incidentId==""&&Q.disabled==false&&overwrite=="false"&&changeDone==true)){Ext.MessageBox.confirm("",IncidentPage.Labels.replaceUnsaved,function(R){if(R==="yes"){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Incident'  and Hasrecurrence__c = false"),fetchIncidentTemplates,500,625)}})}else{if(Q.disabled==false){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Incident'  and Hasrecurrence__c = false"),fetchIncidentTemplates,500,625)}}}};var a=Ext.extend(Ext.Panel,{renderTo:"btnToolbar",defaults:{bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"}});new a({title:"",cls:"toolSpCls",bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;",tbar:[{scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:IncidentPage.Labels.New,id:"newId",hidden:disableTrue,handler:p}," ",{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:IncidentPage.Labels.Save,disabled:getSaveState(),id:"saveId",handler:s}," ",{scale:"medium",iconCls:"bmcCopy",tooltipType:"title",tooltip:IncidentPage.Labels.Copy,id:"copyId",hidden:disableTrue,handler:f}," ","-"," ",{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:IncidentPage.Labels.Delete,id:"deleteId",handler:u}," ",{scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:IncidentPage.Labels.Reset,id:"resetId",hidden:disableTrue,handler:E}," ",separator," ",{scale:"medium",iconCls:"bmcView1",tooltipType:"title",tooltip:IncidentPage.Labels.ViewOpenIncidentsFor,id:"viewId",hidden:disableTrue,menu:[{text:IncidentPage.Labels.IncidentsforClient,id:"IncidentsforClientId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:d},{text:IncidentPage.Labels.IncidentsforCategory,id:"IncidentsforCategoryId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:t}]}," ",{scale:"medium",iconCls:"bmcAssign1",tooltipType:"title",tooltip:IncidentPage.Labels.AssignTo,id:"assignedToId",hidden:disableTrue,menu:[{text:IncidentPage.Labels.IncidentsStaff,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToStaffButtonId",disabled:getAssignStaffState(),handler:G},{text:IncidentPage.Labels.SuggestedExperts,disabled:"true",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToSuggestedStaffButtonId",disabled:getAssignSuggestedStaffState(),handler:b},{text:IncidentPage.Labels.IncidentMyself,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToMyselfButtonId",disabled:getAssignMyselfState(),handler:m},{text:IncidentPage.Labels.IncidentMemberof+" "+getProfileName(),id:"assignToMemberOfAdminButtonId",disabled:getAssignMemberOfAdminState(),icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:M},{text:IncidentPage.Labels.Queue,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToQueueButtonId",disabled:getAssignQueueState(),handler:x}]}," ",{scale:"medium",iconCls:"bmcAction1",id:"actionButton",tooltipType:"title",tooltip:IncidentPage.Labels.Actions,hidden:disableTrue,menu:[{text:IncidentPage.Labels.IncidentClose,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"closeButtonId",disabled:getCloseState(),handler:J},{text:IncidentPage.Labels.IncidentQuickClose,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"quickCloseButtonId",disabled:getCloseState(),handler:i},{text:IncidentPage.Labels.IncidentReopenIncident,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"reopenButtonId",disabled:getReOpenState(),handler:C},{text:IncidentPage.Labels.IncidentIncrementCallCounter,disabled:getCloseState(),id:"incrementCallButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:F},{text:IncidentPage.Labels.IncidentResponded,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"respondedButtonId",disabled:getRespondedState(),handler:q},{text:Print,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printButtonId",disabled:IsNewRecord(incidentId),handler:PrintBtnHandler},{text:PrintPDF,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printPdfButtonId",disabled:IsNewRecord(incidentId),handler:PrintPDFBtnHandler},"-",customActionJsonString]}," ",{scale:"medium",iconCls:"bmcTemplate",tooltipType:"title",tooltip:IncidentPage.Labels.Template,id:"templatebutton",disabled:getFlagForTemplate(),hidden:disableTrue,handler:l,listeners:{disable:function(){this.setIconClass("bmcTemplateDisable")},enable:function(){this.setIconClass("bmcTemplate")}}},{scale:"medium",iconCls:"bmcAPM",tooltipType:"title",tooltip:IncidentPage.Labels.IncidentMgmtProcess,id:"incProcButton",handler:n}," ",{scale:"medium",iconCls:"bmcEmailMessage",tooltipType:"title",tooltip:IncidentPage.Labels.Email,id:"emailId",hidden:disableTrue,handler:c,listeners:{disable:function(){this.setIconClass("bmcEmailMessageDisable")},enable:function(){this.setIconClass("bmcEmailMessage")}}}," ",{scale:"medium",iconCls:"bmcServiceTargets",tooltipType:"title",tooltip:IncidentPage.Labels.ServiceTargets,id:"servicetargets",disabled:!hasServiceTargets,listeners:{disable:function(){this.setIconClass("bmcServiceTargetsDisable")},enable:function(){this.setIconClass("bmcServiceTargets")}},handler:I}," ",{scale:"medium",iconCls:"bmcKMSearch",tooltipType:"title",tooltip:KMSearchLabel,id:"incidentKMSearch",disabled:getSaveState(),listeners:{disable:function(){this.setIconClass("bmcKMSearchDisable")},enable:function(){this.setIconClass("bmcKMSearch")}},handler:o}," ","-"," ",{scale:"medium",iconCls:"bmcCIExplorer",tooltipType:"title",tooltip:IncidentPage.Labels.LaunchCIExplorer,id:"CIExpBut",listeners:{disable:function(){this.setIconClass("bmcCIExplorerDisable")},enable:function(){this.setIconClass("bmcCIExplorer")}},handler:ShowCIExplorer},new Ext.Toolbar.Fill(),{id:"incident_inactive__c",xtype:"checkbox",width:93,color:"#004376",align:"top",checked:false,boxLabel:'<span class="checkboxLabelCls" style="font-family: Tahoma, MS Sans Serif;font-size: 11px;">'+IncidentPage.Labels.Inactive+"</span>",listeners:{render:function(){Ext.QuickTips.register({target:this,text:IncidentPage.Labels.TooltipIncidentInactive,dismissDelay:20000})}}},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:(getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif"),title:IncidentPage.Labels.PreviousRecord},cls:"cursorCls",listeners:{render:function(e){e.el.on("click",O)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:IncidentPage.Labels.NextRecord},cls:"cursorSpaceCls",listeners:{render:function(e){e.el.on("click",j)}}}]});if(isInactive){Ext.getCmp("incident_inactive__c").setDisabled(true)}if(copymetrue){Ext.getCmp("saveId").setDisabled(true)}Ext.getCmp("incident_inactive__c").setValue(getInactive());incidentId=getIncidentID();incidentState=getStateVar();if(incidentId==null||incidentId==""){Ext.getCmp("emailId").setDisabled(true);Ext.getCmp("emailId").setIconClass("bmcEmailMessageDisable");Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("copyId").setIconClass("bmcCopyDisable");Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("IncidentsforClientId").setDisabled(true);Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}else{if(incidentId!=null){Ext.getCmp("saveId").setDisabled(!incnState);Ext.getCmp("closeButtonId").setDisabled(!incnState);Ext.getCmp("quickCloseButtonId").setDisabled(!incnState);Ext.getCmp("reopenButtonId").setDisabled(incnState);Ext.getCmp("emailId").setDisabled(!incnState)}}if(incidentId==null||incidentId==""){Ext.getCmp("templatebutton").setDisabled(false);Ext.getCmp("templatebutton").setIconClass("bmcTemplate");if(document.getElementById("linkSIAvailTD")!=null){document.getElementById("linkSIAvailTD").style.display="none"}if(document.getElementById("noSIAvailTD")!=null){document.getElementById("noSIAvailTD").style.display="block"}}else{if(incidentId!=null){if(setcheckforTemplate=="true"){Ext.getCmp("templatebutton").setDisabled(!incnState)}else{Ext.getCmp("templatebutton").setDisabled(true);Ext.getCmp("templatebutton").setIconClass("bmcTemplateDisable")}var N=displaySI(cookieName,iFrameSrc);if(!N){if(document.getElementById("noSIAvailTD")!=null){document.getElementById("noSIAvailTD").style.display="none"}if(document.getElementById("linkSIAvailTD")!=null){document.getElementById("linkSIAvailTD").style.display="block"}}}}EnableAdditionalCILink();document.getElementById("capsule").style.display="block";var g=new Ext.Panel({layout:"border",height:Ext.isIE7?670:Ext.isIE?674:Ext.isSafari?695:680,border:false,id:"canvasPanelId",cls:"canvasPanelCls",items:[{xtype:"panel",layout:"fit",overflow:"auto",autoScroll:true,split:false,width:"auto",height:480,cls:"northPanelCls",region:"center",contentEl:Ext.isIE?"capsule":IncidentPageComp.ComponentVars.IncidentForm},{xtype:"panel",layout:"fit",overflow:"auto",border:false,id:"southPanelSI",autoScroll:true,split:true,collapsible:true,collapseMode:"mini",width:"auto",height:Ext.isIE?205:210,minHeight:Ext.isIE?120:150,animCollapse:false,region:"south",listeners:{resize:function(R,T,Q,P,S){if(typeof(Q)=="number"){document.getElementById("detailsDivSI").style.height=Q+"px"}var e=document.getElementById("SIIframeID").style.display;if(e!="none"){if(typeof(window.frames.SIIframeID.setSouthPanelHeight)=="function"){window.frames.SIIframeID.setSouthPanelHeight(Q,T)}}},collapse:function(){this.setWidth("auto")}},contentEl:"detailsDivSI"}],listeners:{afterlayout:function(e){e.layout.south.miniSplitEl.dom.qtip=IncidentPage.Labels.DragResizeClickCollapse;e.layout.south.getCollapsedEl();e.layout.south.miniCollapsedEl.dom.qtip=IncidentPage.Labels.ClickToExpand},single:true}});var D=new Ext.Viewport({layout:"anchor",width:"auto",id:"viewportId",border:false,cls:"viewportCanvasCls",items:[{anchor:"100%",layout:"fit",items:g}]});handleElemEvent();disabledatefield();converdisabletoreadonly();if(incidentId==null||incidentId==""){var k=document.getElementById(IncidentPageComp.ComponentVars.UserLastName).value;if(k==null||k==""){try{document.getElementById(IncidentPageComp.ComponentVars.UserLastName).focus()}catch(K){}}}var L=getNoRightsToViewEdit();if(isRecordDeleted()){Ext.Msg.alert(IncidentPage.Labels.Information,IncidentPage.Labels.DeletedRecord,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}else{if(L){Ext.Msg.alert("",labelMsgNoAccessPerm,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}}pageloadstartdate=0;pageloadstartdate=new Date();var A=pageloadstartdate.getTime();var z=windowloaddate.getTime();var y=(A-renderingstartitme);data+=IncidentPage.Labels.PM_PageLoad;data+=y;var w=getPortelTemplateId();if(w!=null&&typeof(w)!="undefined"&&w!=""){fetchIncidentTemplates(w)}ChangeServiceTargetButtonState();UpdateDueDateFieldState();updateKM();ChangeCIExpBtnStatus(cilink_record)});function UpdateDueDateFieldState(){if(!(typeof(document.getElementById(IncidentPageComp.ComponentVars.DueDateTime))=="undefined"||document.getElementById(IncidentPageComp.ComponentVars.DueDateTime)==null)){if(isDueDateOverridenByServiceTarget()==true){document.getElementById(IncidentPageComp.ComponentVars.DueDateTime).disabled=true;document.getElementById(IncidentPageComp.ComponentVars.DueDateTime).readOnly=true;document.getElementById(IncidentPageComp.ComponentVars.DueDateTime).className="clsPanelInputTextboxReadOnly"}else{document.getElementById(IncidentPageComp.ComponentVars.DueDateTime).disabled=false;document.getElementById(IncidentPageComp.ComponentVars.DueDateTime).readOnly=false;document.getElementById(IncidentPageComp.ComponentVars.DueDateTime).className="clsPanelInputTextbox"}}}function ChangeServiceTargetButtonState(){if(typeof(Ext.getCmp("servicetargets"))!="undefined"&&Ext.getCmp("servicetargets")!=null){if(!hasServiceTargets){Ext.getCmp("servicetargets").disable()}else{Ext.getCmp("servicetargets").enable()}}}function writeCookie(){if(document.getElementById("configureSIId").checked){createSICookie(cookieName,"true");var a=displaySI(cookieName,iFrameSrc)}}function checkSave(){if(doSave){saveFunctionRef()}}function handleResetChange(){if(clickedOnce){clickedOnce=false;window.parent.registerSave(wid2)}}function openCategoryPage(a){if(a!=null||a!=""){if(a[0]!=null||a[0]!=""){var b=a[3];categoryName=a[0];setIncForCategoryEnabled();checkSave();if(a[4]!=null&&a!="undefined"){document.getElementById(IncidentPageComp.ComponentVars.CategoryFKUrgency).value=a[4]}setCatData(b,categoryName)}if(a[1]!=null||a[1]!=""){setDescriptionNext(a[1])}if(a[2]!=null||a[2]!=""){setResolutionNext(a[2])}}}function openImpactLookup(d,a){var c=a.split("П");for(var e=0;e<c.length;e++){var b=c[e].split(":");var b=c[e].split(":");var f=b[1]!="null"?b[1]:"";f=decodeSpecialChar(f);if(b[0]=="name"){document.getElementById(IncidentPageComp.ComponentVars.ImpactIDName).value=f}if(b[0]=="id"){document.getElementById(IncidentPageComp.ComponentVars.ImpactID).value=f}}if(d!=null&&d!=""){FetchPriorityHTTP()}}function previousIncidentBtnHandler1(){var b="";var a=0;while(idset.length>a){if(b==""){b=idset[a]}else{b=b+","+idset[a]}a++}previousIncidentBtnHandler(b)}function nextIncidentBtnHandler1(){var b="";var a=0;while(idset.length>a){if(b==""){b=idset[a]}else{b=b+","+idset[a]}a++}nextIncidentBtnHandler(b)}function AssignedToStaff(){openPopup("SearchPage?popupId=Client&isLookup=true&additional_columns=name,username,firstname,lastname,phone,extension,email,ProfileId,Profile.Name&filterClause="+escape("IsStaffUser__c=true")+"&isAssignTo=true",preSetAssignedToStaffNext)}function AssignToSuggestedStaff(){selectedModuleName="staff";openPopup("SearchPage?popupId=SuggestedStaff&isSuggestExpert=true&isLookup=true&queueFor=Incident__c&isQueurorUser=true&isActiveUser=true&additional_columns=FKUser__r.firstname,FKUser__r.lastname,FKUser__r.phone,FKUser__r.extension,FKUser__r.email,FKUser__r.ProfileId,FKUser__r.Profile.Name,QueueName__c,QueueId__c,FKUser__r.Id&categoryId="+incidentCategory+"&filterClause="+escape("FKUser__r.IsStaffUser__c=true"),preSetAssignedToSuggestedStaffNext)}function AssignedToMyself(){Ext.getCmp("assignToMyselfButtonId").setDisabled(true);toggleStaffTooltipState(true);document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=loggedInUserId;document.getElementById(IncidentPageComp.ComponentVars.staff_firstname).value=loggedInUserFirstName;document.getElementById(IncidentPageComp.ComponentVars.staff_laststname).value=loggedInUserLastName;document.getElementById(IncidentPageComp.ComponentVars.staff_phone).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_extension).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_profilename).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value="";handleChange(null)}function deleteIncident(){deleteIncidentNext()}function quickCloseIncident(){quickCloseIncidentNext()}function reopenIncident(){reopenIncidentNext()}function closeWindow(){if(isLookup){window.parent.refreshDocs();window.parent.closePopup()}else{window.parent.refreshList();window.parent.closeTab(wid)}}function isValidDate(){isValid="True";var a=document.getElementById(IncidentPageComp.ComponentVars.DueDateTime).value}function DisableCIExpBtn(){var b=document.getElementById(IncidentPageComp.ComponentVars.BaseElementIDName).value;var a=document.getElementById(IncidentPageComp.ComponentVars.serviceIDName).value;if((b!=null&&b!="")||(a!=null&&a!="")){Ext.getCmp("CIExpBut").setDisabled(false)}else{Ext.getCmp("CIExpBut").setDisabled(true)}}function setIncForCategoryEnabled(){if(getcategoryName()!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}}function setClientDetails(a){setClientNext(a);if(a!=null){document.getElementById(IncidentPageComp.ComponentVars.UserID).value=a}}function incidentForClient(){var a=document.getElementById(IncidentPageComp.ComponentVars.UserName).value;var b=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;if(a!=null&&a!=""){openPopup("SearchPage?popupId=Incident&filterObj=1&clientId="+b+"&isLookup=true",setIncidentNext)}}function incidentForCatagory(){var a=getcategoryName();if(a!=""){a=encodeURIComponent(a);openPopup("SearchPage?popupId=Incident&filterObj=3&categoryId="+a+"&isLookup=true",setIncidentNext)}}function setIncidentForMenu(){var b=document.getElementById(IncidentPageComp.ComponentVars.UserName).value;var a=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;if(a!=null&&a!=""&&b!=""&&b!=null){Ext.getCmp("IncidentsforClientId").setDisabled(false)}else{Ext.getCmp("IncidentsforClientId").setDisabled(true)}if(getcategoryName()!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}}function FetchUrgency(){var b=document.getElementById(IncidentPageComp.ComponentVars.UserName).value;var a=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;if(a!=null&&a!=""&&b!=""&&b!=null){Ext.getCmp("IncidentsforClientId").setDisabled(false)}else{Ext.getCmp("IncidentsforClientId").setDisabled(true)}if(getcategoryName()!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}FetchUrgencyDetails(a)}function getcategoryName(){var a="";if(document.getElementById(IncidentPageComp.ComponentVars.CategoryIDName)!=null&&document.getElementById(IncidentPageComp.ComponentVars.CategoryIDName)!=""){a=document.getElementById(IncidentPageComp.ComponentVars.CategoryIDName).value}return a}function FetchUrgencyForCategoryTabOut(){var a=document.getElementById(IncidentPageComp.ComponentVars.UserName).value;var c=document.getElementById(IncidentPageComp.ComponentVars.CategoryFKUrgency).value;if(a!=null&&a!=""){Ext.getCmp("IncidentsforClientId").setDisabled(false)}else{Ext.getCmp("IncidentsforClientId").setDisabled(true)}if(getcategoryName()!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}var b=document.getElementById(IncidentPageComp.ComponentVars.UrgencyIDName).value}function ChangeCIExpBtnStatus(a){CI_value=document.getElementById(IncidentPageComp.ComponentVars.BaseElementIDName).value.trim();service_value=document.getElementById(IncidentPageComp.ComponentVars.serviceIDName).value.trim();if((0==CI_value.length)&&(0==service_value.length)&&(a=="false"||typeof(a)=="undefined")){Ext.getCmp("CIExpBut").setDisabled(true)}else{Ext.getCmp("CIExpBut").setDisabled(false)}}function clientLookUp(){showalldata(event,IncidentPageComp.ComponentVars.PBarItemIDCD);FetchUrgencyName()}function copyIncident(){}function selectBroadcast(){var a=document.getElementById(IncidentPageComp.ComponentVars.BroadcastIDName).value;if(a==""){setBroadcastNextFromTabout(a)}}function saveRecords(){chkBoxValue=Ext.getCmp("incident_inactive__c").getValue();isValidDate();if(isValid=="True"){waitbox(0);Ext.getCmp("saveId").setDisabled(true);saveIncident(chkBoxValue,ownerIdString,KMids)}else{Ext.MessageBox.show({msg:IncidentPage.Labels.ValidDateTime,buttons:Ext.MessageBox.OK})}}function saveBeforeCloseRecords(){chkBoxValue=Ext.getCmp("incident_inactive__c").getValue();isValidDate();waitbox(0);if(isValid=="True"){saveBeforeCloseIncident(chkBoxValue,KMids)}else{Ext.MessageBox.show({msg:IncidentPage.Labels.ValidDateTime,buttons:Ext.MessageBox.OK})}}function getINCid(a,b){if(errormsg==null||errormsg==""||errormsg==IncidentPage.Labels.SavedSuccessfully){setId(a,b)}else{setId(a,b)}}function buttonValidator(){if((incidentClient!=null&&incidentClient!="")&&(((categoryRequired=="false")||(incidentCategory!=null&&incidentCategory!=""))||copymetrue)&&(errormsg==null||errormsg==""||errormsg==IncidentPage.Labels.SavedSuccessfully)){if(setcheckforTemplate=="true"){Ext.getCmp("templatebutton").setDisabled(false);Ext.getCmp("templatebutton").setIconClass("bmcTemplate")}else{Ext.getCmp("templatebutton").setDisabled(true);Ext.getCmp("templatebutton").setIconClass("bmcTemplateDisable")}Ext.getCmp("saveId").setDisabled(!incnState);Ext.getCmp("emailId").setDisabled(!incnState);copymetrue=false;Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconClass("bmcDelete");Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("resetId").setDisabled(false);Ext.getCmp("viewId").setDisabled(false);Ext.getCmp("printButtonId").setDisabled(false);Ext.getCmp("printPdfButtonId").setDisabled(false);Ext.getCmp("copyId").setIconClass("bmcCopy");Ext.getCmp("viewId").setIconClass("bmcView1");var a=document.getElementById("SIIframeID").style.display;if(cookieValue=="true"&&a=="none"){SIComp("/apex/SIContainerPage?oid="+incidentId+"&otype=Incident__c&wid="+wid+"&stateofIncident="+closeState+"&isChangeCreatable="+getIsChangeCreatable()+"&isInactive="+isIncInactive)}else{if(a=="none"){document.getElementById("noSIAvailTD").style.display="none";if(Ext.isChrome){document.getElementById("onDemandSITableId").style.display="inline-table";document.getElementById("linkSIAvailTD").style.display="table-cell"}else{document.getElementById("onDemandSITableId").style.display="block";document.getElementById("linkSIAvailTD").style.display="block"}}}var b=getIncidentFeed();if(b!=null&&b=="true"){}}if((incidentClient!=null||incidentClient!="")&&(incidentCategory==null||incidentCategory=="")){Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("copyId").setIconClass("bmcCopy")}EnableAdditionalCILink()}function closedRelatedBroadcasts(){if(hasRelatedBRD){isclosebroadcast=false;Ext.MessageBox.confirm("",IncidentPage.Labels.IncidentRelatedBroadcastsChanges,function(a){if(a==="yes"){isclosebroadcast=true;closeBroadcasts(isclosebroadcast)}else{closeBroadcasts(isclosebroadcast)}})}}var windownameflag=0;function showData(d,c,b,a){if(isAutocomplete){return}if(taboutFlag!=true){if(typeof(c)!="undefined"&&typeof(b)!="undefined"){if(typeof(a)!="undefined"){showalldata(d,c,b,a)}else{showalldata(d,c,b)}}else{if(typeof(c)!="undefined"&&typeof(b)=="undefined"){showalldata(d,c)}else{showalldata(d)}}}else{if(typeof(c)!="undefined"){c()}}}function ellipse(b,a){if(b.length>a){return b.substr(0,a-3)+"..."}return b}function formCSZString(d,c,b){var a="";if(d!=""){a=ellipse(d,33)+", "}if(c!=""){a=a+ellipse(c,33)+" "}if(b!=""){a=a+ellipse(b,33)}return a}function afterResetSI(){var b=getModName();var a=getParentWid();if(b!=null&&b!=""&&typeof(b)!="undefined"&&a!=null&&a!=""&&typeof(a)!="undefined"&&errormsg==IncidentPage.Labels.SavedSuccessfully){window.parent.registerSave(wid);window.parent.parent.refreshSupportingInformation(a,b)}}function afterAddNote(){var a=document.getElementById("SIIframeID").style.display;if(cookieValue!="true"&&(a=="none")){SIComp(iFrameSrc)}else{if(a!="none"){window.frames.SIIframeID.refreshDocs()}}}function renderPrbId(b,a){document.getElementById(IncidentPageComp.ComponentVars.ProblemIDName).value=a;document.getElementById(IncidentPageComp.ComponentVars.ProblemID).value=b}function afterSaveAction(){var b=getModName();var a=getParentWid();if(b!=null&&b!=""&&typeof(b)!="undefined"&&a!=null&&a!=""&&typeof(a)!="undefined"&&errormsg==IncidentPage.Labels.SavedSuccessfully){return true}else{showError()}}function tooltipforclientJS(d,g,f,b,c,e){document.getElementById("clientNameforttdivId").innerHTML=ellipse(clientFirstName,25)+" "+ellipse(clientLastName,25);document.getElementById("clientTitleforttdivId").innerHTML=ellipse(g,40);var a=document.getElementById("clientAddressforttdivId").innerHTML.replace(new RegExp("\\n","g")," ");document.getElementById("clientAddressforttdivId").innerHTML=ellipse(a,33);document.getElementById("clientCSZforttdivId").innerHTML=f;document.getElementById("clientCountryforttdivId").innerHTML=ellipse(b,33);document.getElementById("clientPhoneforttdivId").innerHTML=ellipse(c,33);document.getElementById("clientEmailforttdivId").innerHTML='<a href="'+e+'" class="clsCmdLinkTooltip">'+ellipse(e,33)+"</a>"}function tooltipforstaffJS(f,a,e,c,b,d){strSingleLineText=document.getElementById("userAddressforttdivId").innerHTML.replace(new RegExp("\\n","g")," ");document.getElementById("userAddressforttdivId").innerHTML=ellipse(strSingleLineText,33);document.getElementById("userNameforttdivId").innerHTML=ellipse(f,50);document.getElementById("userTitleforttdivId").innerHTML=ellipse(a,40);document.getElementById("userCSZforttdivId").innerHTML=e;document.getElementById("userCountryforttdivId").innerHTML=ellipse(c,33);document.getElementById("userPhoneforttdivId").innerHTML=ellipse(b,33);document.getElementById("userEmailforttdivId").innerHTML='<a href="'+d+'" class="clsCmdLinkTooltip">'+ellipse(d,33)+"</a>"}function getIncProcBtnHandler(){var a="NavigatorPage?title="+IncidentPage.Labels.IncidentProcess+"&target=IncProcMgmtPage?id=1001";window.parent.parent.addNewTab("Incident Process",IncidentPage.Labels.AlignabilityProcessModel,a,"false")}function setElHeight(b,a){if(b.style.height=="0pt"){b.style.height="25pt";b.value=""}else{if(b.style.height=="25pt"&&b.value==""){b.style.height="0pt";b.value=a}}}function composeMailOnCompleteIn(){var a=document.getElementById("SIIframeID").style.display;if(window.frames.SIIframeID!=null&&typeof(window.frames.SIIframeID)!="undefined"){if(a!="none"){document.getElementById("SIIframeID").contentWindow.composeMailOnComplete()}}}function refreshChatterFeed(){refreshFeed()}function shareTextPost(a){if(a.length>1000){Ext.MessageBox.show({msg:IncidentPage.Labels.TextAreaOverflowForChatter,buttons:Ext.MessageBox.OK});return false}waitbox(0);shareStatusPost(a)}function deleteCommentFromFeed(b,a){Ext.MessageBox.confirm(IncidentPage.Labels.ConfirmHomePage,IncidentPage.Labels.ChatterDeleteComment,function(c){if(c==="yes"){deleteComment(b,a)}})}function deleteFeedPost(b,a){Ext.MessageBox.confirm(IncidentPage.Labels.ConfirmHomePage,IncidentPage.Labels.ChatterDeletePost,function(c){if(c==="yes"){deletePost(b,a)}})}function setDisplay(b,a){document.getElementById(b).style.display=a}function createNewComment(b,c){var a=b.getElementsByTagName("input")[0];if(a.value.length>1000){Ext.MessageBox.show({msg:IncidentPage.Labels.TextAreaOverflowForChatterComment,buttons:Ext.MessageBox.OK});return false}else{if(a.value.trim().length<=0){Ext.MessageBox.show({msg:IncidentPage.Labels.EmptyValueForChatterComment,buttons:Ext.MessageBox.OK});b.getElementsByTagName("input")[0].focus();return false}else{waitbox(0);NewCommentValue(a.value,c)}}}function renderAddNoteAfterClose_JS(b,c){if(b!=null){b.disabled=true;b.className="clsInputTextAreaDisabledNote";var a=document.getElementById("addNoteBtn");a.disabled=true;a.className="AddButtonOff"}if(c!=null){c.disabled=true;c.className="clsDurationTextBoxDisable"}}function renderAddNoteButton_JS(c,e,b){if(c!=null){var a=document.getElementById("addNoteBtn");var d=c.value.trim();if(incidentId==null||incidentId==""||d==null||d==""||b=="false"){a.disabled=true;a.className="AddButtonOff"}else{a.disabled=false;a.className="AddButton"}if(incidentId==null||incidentId==""||b=="false"){c.disabled=true;c.className="clsInputTextAreaDisabledNote";e.disabled=true;e.className="clsDurationTextBoxDisable"}else{if(isNoteEnableFlag){c.value="";isNoteEnableFlag=false}c.disabled=false;c.className="clsInputTextAreaNote";e.disabled=false;e.className="clsDurationTextBox"}}}function validateDuration_JS(d){if(d!=""){var b=d.split(":");if(b[0].length==1){d="0"+d;document.getElementById(IncidentPageComp.ComponentVars.IncidentDuration).value=d;durationError=0}var a=/^([0-9]{2}):([0-9]{2})$/;var c=d.match(a);if(c==null){durationError=1;Ext.MessageBox.show({msg:IncidentPage.Labels.DurationError,buttons:Ext.MessageBox.OK});document.getElementById(IncidentPageComp.ComponentVars.IncidentDuration).value="00:00"}}}function enableAddNote_JS(){if((errormsg!=""&&errormsg!=null)||errormsg==IncidentPage.Labels.DurationError){var a=document.getElementById("addNoteBtn");a.disabled=false;a.className="AddButton";var b=document.getElementById(IncidentPageComp.ComponentVars.IncidentNotes);b.disabled=false;b.className="clsInputTextAreaNote";var c=document.getElementById(IncidentPageComp.ComponentVars.IncidentDuration);c.disabled=false;c.className="clsDurationTextBox";c.value="00:00"}}function disableAddNote_JS(c,b){validateDuration_JS(b);if(durationError!=1){if(c.length>32000){Ext.MessageBox.show({msg:IncidentPage.Labels.Note+": "+IncidentPage.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK})}else{var a=document.getElementById("addNoteBtn");a.disabled=true;a.className="AddButtonOff";saveNote(c,b)}}durationError=0}function renderIncidentNote_JS(){if((errormsg!=""&&errormsg!=null)||errormsg==IncidentPage.Labels.DurationError){Ext.MessageBox.show({msg:errormsg,buttons:Ext.MessageBox.OK})}else{var a=document.getElementById(IncidentPageComp.ComponentVars.IncidentNotes);if(a!=null){a.disabled=false;a.className="clsInputTextAreaNote";a.value="";if(insideNote==false){clickedOnce=true;handleResetChange()}}var b=document.getElementById(IncidentPageComp.ComponentVars.IncidentDuration);if(b!=null){b.disabled=false;b.value="00:00"}}}function loadChatterFeeds(){if(!this.FeedsVisible){showChatterFeeds();this.FeedsVisible=true}}function siControlBack(){var b=Ext.util.Cookies.get(cookieName);var a=document.getElementById("SIIframeID").style.display;if((b==null||b=="false")&&a=="none"){afterResetSI()}if(incidentCloseState=="true"&&errormsg!=IncidentPage.Labels.SavedSuccessfully){Ext.getCmp("saveId").setDisabled(false)}}function SetIncidentCategory(a){if(a!=null&&a!=""){incidentCategory=document.getElementById(IncidentPageComp.ComponentVars.CategoryIDName).value}}function DisplayChatterLimitMessage(){var a=getChatterLimitErrorMessage();if(a!=""&&a!=null&&a.length>0){Ext.MessageBox.show({msg:a,buttons:Ext.MessageBox.OK})}}function preSetAssignedToStaffNext(f,a){waitbox(0);if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0].toLowerCase()=="firstname"){document.getElementById(IncidentPageComp.ComponentVars.staff_firstname).value=e}if(b[0].toLowerCase()=="lastname"){document.getElementById(IncidentPageComp.ComponentVars.staff_laststname).value=e}if(b[0].toLowerCase()=="phone"){document.getElementById(IncidentPageComp.ComponentVars.staff_phone).value=e}if(b[0].toLowerCase()=="extension"){document.getElementById(IncidentPageComp.ComponentVars.staff_extension).value=e}if(b[0].toLowerCase()=="profile.name"){document.getElementById(IncidentPageComp.ComponentVars.staff_profilename).value=e}if(b[0].toLowerCase()=="queue"){document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value=e}}}if(f!=null&&f!=""){document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=f;document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value="";toggleStaffTooltipState(true);Ext.getCmp("assignToMyselfButtonId").setDisabled(false);handleChange(null)}waitMsg.hide()}function toggleStaffTooltipState(a){document.getElementById("staffInfobtn").disabled=a}function preSetAssignedToSuggestedStaffNext(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0].toLowerCase()=="fkuser__r.firstname"){document.getElementById(IncidentPageComp.ComponentVars.staff_firstname).value=e}if(b[0].toLowerCase()=="fkuser__r.lastname"){document.getElementById(IncidentPageComp.ComponentVars.staff_laststname).value=e}if(b[0].toLowerCase()=="fkuser__r.phone"){document.getElementById(IncidentPageComp.ComponentVars.staff_phone).value=e}if(b[0].toLowerCase()=="fkuser__r.extension"){document.getElementById(IncidentPageComp.ComponentVars.staff_extension).value=e}if(b[0].toLowerCase()=="fkuser__r.profile.name"){document.getElementById(IncidentPageComp.ComponentVars.staff_profilename).value=e}if(b[0].toLowerCase()=="queuename__c"){document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value=e}if(b[0].toLowerCase()=="queueid__c"){document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=e;toggleStaffTooltipState(true)}if(b[0].toLowerCase()=="queue.name"){document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value=e}if(b[0].toLowerCase()=="queueid"){document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=e;document.getElementById(IncidentPageComp.ComponentVars.staff_firstname).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_laststname).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_phone).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_extension).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_profilename).value="";toggleStaffTooltipState(true)}if(b[0].toLowerCase()=="fkuser__r.id"){document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=e;document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value="";toggleStaffTooltipState(true)}}Ext.getCmp("assignToMyselfButtonId").setDisabled(false);handleChange(null)}}function oncompleteForCILookup(){DisableCIExpBtn();converdisabletoreadonly()}function convertUserCalledToInt(){if(document.getElementById(IncidentPageComp.ComponentVars.usercalledID).value!=null&&document.getElementById(IncidentPageComp.ComponentVars.usercalledID).value!=""){var a=parseInt(document.getElementById(IncidentPageComp.ComponentVars.usercalledID).value);document.getElementById(IncidentPageComp.ComponentVars.usercalledID).value=a}}function copyResolutionAndCloseIncident(a){document.getElementById(IncidentPageComp.ComponentVars.IncidentResolution).value=a;quickCloseIncident()}function updateInactive(){Ext.getCmp("incident_inactive__c").setValue(isIncInactive);createControlMap();renderElementsByType()}function refreshRelatedPortlets(){if(typeof(window.parent.parent.refreshActionItemsPortlet)=="function"){window.parent.parent.refreshActionItemsPortlet("Action Items","INC")}if((getIsChildTempExist()=="true"||getIsChildTempExist()==true)&&typeof(window.parent.parent.refreshActionItemsPortlet)=="function"){window.parent.parent.refreshActionItemsPortlet("Action Items","TASK")}clearTimeout(timeoutreturn)}function refreshBroadcastReleatedPortlets(){if(typeof(window.parent.parent.refreshPortletByTitle)=="function"){window.parent.parent.refreshPortletByTitle("Broadcasts")}if(typeof(window.parent.parent.refreshActionItemsPortlet)=="function"){window.parent.parent.refreshActionItemsPortlet("Action Items","BROAD")}}function callFetchUrgencyHTTPJS(a,b,d,c){if(a==""&&b==""){return false}else{if(a==""&&b!=""&&c!=""){return true}else{if(a!=""&&b==""&&d!=""){return true}else{if(a!=""&&b!=""){if(c!=""||d!=""){return true}else{return false}}}}}return false}function disableSIMenu(){if(document.getElementById(IncidentPageComp.ComponentVars.StatusId).value=="CLOSED"){window.frames.SIIframeID.disableAll()}}function reopenedRelatedBroadcasts(){if(hasRelatedBRD){isclosebroadcast=false;Ext.MessageBox.confirm("",IncidentPage.Labels.IncidentRelatedBroadcastsChanges,function(a){if(a==="yes"){isclosebroadcast=true;reopenBroadcasts(isclosebroadcast)}else{reopenBroadcasts(isclosebroadcast)}})}}function renderSIComponent(){if(cookieValue==true||cookieValue=="true"){SIComp("/apex/SIContainerPage?oid="+incidentId+"&otype=Incident__c&wid="+wid+"&stateofIncident="+closeState+"&isChangeCreatable="+getIsChangeCreatable()+"&isInactive="+isIncInactive)}else{removeSI("/apex/SIContainerPage?oid="+incidentId+"&otype=Incident__c&wid="+wid+"&stateofIncident="+closeState+"&isChangeCreatable="+getIsChangeCreatable()+"&isInactive="+isIncInactive)}}function checkEnable(){if(errormsg==null||errormsg==""||errormsg==IncidentPage.Labels.SavedSuccessfully){hasRelatedBRD=getHasRelatedBroadcasts();templateEnable=getFlagForTemplate();Ext.getCmp("assignToMyselfButtonId").setDisabled(getAssignMyselfState());Ext.getCmp("assignToStaffButtonId").setDisabled(!incnState);Ext.getCmp("assignToSuggestedStaffButtonId").setDisabled(!incnState);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(!incnState);Ext.getCmp("quickCloseButtonId").setDisabled(!incnState);Ext.getCmp("closeButtonId").setDisabled(!incnState);Ext.getCmp("reopenButtonId").setDisabled(incnState);Ext.getCmp("assignToQueueButtonId").setDisabled(!incnState);Ext.getCmp("incrementCallButtonId").setDisabled(!incnState);Ext.getCmp("respondedButtonId").setDisabled(!incnState);Ext.getCmp("emailId").setDisabled(!incnState)}Ext.getCmp("saveId").setDisabled(!incnState);Ext.getCmp("incidentKMSearch").setDisabled(!incnState);Ext.getCmp("templatebutton").setDisabled(!incnState)}function updateKM(){if(getSaveState()==false){Ext.getCmp("incidentKMSearch").setDisabled(false);Ext.getCmp("incidentKMSearch").setIconClass("bmcKMSearch")}else{Ext.getCmp("incidentKMSearch").setDisabled(true);Ext.getCmp("incidentKMSearch").setIconClass("bmcKMSearchDisable")}}function getCustomActionURL(customId){var incId=getIncidentIDForPrb();eval(orgNamespace).JSRemoteActions.getCustomActionURL("Incident",incId,customId,function(result,event){if(event.status){if(result!=""&&result!=null){urlStringVar=result;openUrl()}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:false})}function OpenHelpUrl(a){if(a.toLowerCase().indexOf("incidentservicetarget")!=-1){OpenHelppage("ServiceTransaction","module","form")}else{if(a.toLowerCase().indexOf("servicerequestdetail")!=-1){OpenHelppage("ServiceRequestDetail","module","form")}else{if(a.toLowerCase().indexOf("composeemailpage")!=-1){OpenHelppage("EmailConversation","module","form")}}}}function disableSRDlookup(){if(isServiceRequest!=null&&isServiceRequest!=""&&isServiceRequest==IncidentPage.Labels.ExtjsMessageYes){var a=document.getElementById("reqDefLookupBtn");if(a!=null){a.disabled=true}var b=getSRDtitle();if(b!=null){b.disabled=true;b.style.backgroundColor="#D4D0C8";b.style.color="#000000";if(Ext.isIE){b.style.width="195px";b.className="clsPanelInputTextboxReadOnly"}}}}function setServiceClauses(a){if(!isFlattenedCmdb){if(a=="offering"){var b=document.getElementById(IncidentPageComp.ComponentVars.businessServiceID).value;if(b!=null&&b!=""&&b!="undefined"){OfferingClause=escape("(serviceType__c = 'Offering') And (FKBusinessService__c ='"+b+"')  And (end_date__c = null or end_date__c >="+soqlDateClause+") AND FKBMC_BaseElement__r.MarkAsDeleted__c = false")}else{OfferingClause=escape("(serviceType__c = 'Offering') And (end_date__c = null or end_date__c >="+soqlDateClause+") AND FKBMC_BaseElement__r.MarkAsDeleted__c = false")}}else{if(a=="businessService"){businessServiceClause=escape("(serviceType__c != 'Offering') And (end_date__c = null or end_date__c >="+soqlDateClause+") AND FKBMC_BaseElement__r.MarkAsDeleted__c = false")}}}else{if(a=="offering"){var b=document.getElementById(IncidentPageComp.ComponentVars.businessServiceID).value;if(b!=null&&b!=""&&b!="undefined"){OfferingClause=escape("(serviceType__c = 'Offering') And (FKBusinessService__c ='"+b+"')  And (enddate__c = null or enddate__c >="+soqlDateClause+") AND MarkAsDeleted__c = false")}else{OfferingClause=escape("(serviceType__c = 'Offering') And (enddate__c = null or enddate__c >="+soqlDateClause+") AND MarkAsDeleted__c = false")}}else{if(a=="businessService"){businessServiceClause=escape("(serviceType__c != 'Offering') And (enddate__c = null or enddate__c >="+soqlDateClause+") AND MarkAsDeleted__c = false")}}}}function openSRDpopUp(){var a=document.getElementById(IncidentPageComp.ComponentVars.CategoryID).value;var c=document.getElementById(IncidentPageComp.ComponentVars.CategoryIDName).value;var b=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;if(c!=null&&c!=""){openPopup("SearchPage?isLookup=true&popupId=SRM_RequestDefinition&clientIdforSrm="+b+"&catIdForSrd="+a,setSelectedSRD)}else{openPopup("SearchPage?isLookup=true&popupId=SRM_RequestDefinition&clientIdforSrm="+b,setSelectedSRD)}}function openSRDetailpopUp(){var e=document.getElementById(IncidentPageComp.ComponentVars.reqDefinationID).value;var c=document.getElementById(IncidentPageComp.ComponentVars.serviceRequestTitle).value;var b=document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value;var d=getIncidentIDForSRD();var a=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;if((e!=null&&typeof(e)!="undefined"&&e!=""&&c!="")||((b!=null&&b!="")&&(d!=null&&d!=""))){openPopupWithTitle("ServiceRequestDetail?incidentId="+d+"&isLookup=true&reqDefId="+e+"&reqDtlsId="+b+"&clientId="+a,null,IncidentPage.Labels.ServiceRequestLabel,563,650)}}function callRequestDetailTooltip(eventObject){var requestDetailId=getRequestDetailID();var target=eventObject.target;if(target==null){target=eventObject.srcElement}if(requestDetailId!=""){eval(orgNamespace).ClientInfo.getRequestDetailInfo(requestDetailId,function(result,event){if(event.status){tooltipHtmlResult="";var fieldLabels=result.objectFieldLabels;var fieldDisplayLabels=result.displayFieldLabels;tooltipHtmlResult='<table cellpadding=4 cellspacing=3 width="290" border=0 style="table-layout:fixed; font-size:11px;">';if(result!=""&&result!=null){var fieldListArray=fieldLabels.split(";");var fieldDisplayArray=fieldDisplayLabels.split(";");var i=0;for(i=0;i<fieldListArray.length-1;i++){tooltipHtmlResult+='<tr><td width="40%" style="font-weight:bold; word-wrap:break-word;">'+fieldListArray[i]+'</td><td style="white-space:normal; font-weight:bold; word-wrap:break-word;">'+fieldDisplayArray[i].replace(undefined,"").replace(null,"")+"</td></tr>"}tooltipHtmlResult+="</table>";tooltipforclientstaff=new Ext.QuickTip({target:target.id,anchor:"left",width:Ext.isIE?Ext.isIE7?305:295:308,trackMouse:false,bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",hideDelay:200,dismissDelay:5000,html:tooltipHtmlResult});Ext.sequence(Ext.QuickTip.prototype,"afterRender",function(){this.mon(this.el,"mouseover",function(){this.clearTimer("hide");this.clearTimer("dismiss")},this);this.mon(this.el,"mouseout",function(){this.clearTimer("show");if(this.autoHide!==false){this.delayHide()}},this)});tooltipforclientstaff.show()}}else{if(event.type==="exception"){alert(event.message)}}},{escape:true})}else{return}}function setClientRelatedFields(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<=c.length-2;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="firstname"){document.getElementById(clFname).value=e}if(b[0]=="lastname"){document.getElementById(clLname).value=e}if(b[0]=="username"){document.getElementById(clUname).value=e}if(b[0]=="id"){document.getElementById(IncidentPageComp.ComponentVars.UserID).value=e;document.getElementById(IncidentPageComp.ComponentVars.TipUserID).value=e}if(b[0]=="phone"){document.getElementById(clPhone).value=e}if(b[0]=="extension"){document.getElementById(clExtension).value=e}if(b[0]=="contact.accountid"){if(e!=null&&e!=""){document.getElementById(incAccountId).value=e}}if(b[0]=="contact.account.name"){if(e!=null&&e!=""){document.getElementById(accname).value=e;document.getElementById(clAccname).value=e}}if(b[0]=="Account_ID__c"){if(e!=null&&e!=""){document.getElementById(incAccountId).value=e}}if(b[0]=="Account_Name__c"){if(e!=null&&e!=""){document.getElementById(accname).value=e;document.getElementById(clAccname).value=e}}}}FetchUrgencyHTTP();converdisabletoreadonly()}function setAccountNext(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="name"){document.getElementById(accname).value=e}else{if(b[0]=="id"){document.getElementById(incAccountId).value=e}}}}}function setStatusField(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="name"){document.getElementById(IncidentPageComp.ComponentVars.StatusId).value=e}else{if(b[0]=="id"){document.getElementById(IncidentPageComp.ComponentVars.Status_Id).value=e}else{if(b[0]=="stage__c"){document.getElementById(IncidentPageComp.ComponentVars.StatusStage).value=e}}}}}}function setUrgencyField(f,a){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="name"){document.getElementById(IncidentPageComp.ComponentVars.UrgencyIDName).value=e}if(b[0]=="id"){document.getElementById(IncidentPageComp.ComponentVars.UrgencyID).value=e}}if(f!=null&&f!=""){FetchPriorityHTTP()}}function resetSRDtldVal(){var a=document.getElementById(IncidentPageComp.ComponentVars.reqDefinationID);if(a!=null&&typeof(a)!="undefined"&&a!=""){if(reqDtlsId==""){reqDtlsId=a.value}else{if(a.value!=reqDtlsId){reqDtlsId=a.value;document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value=""}}}else{document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value=""}}function setServiceRelatedFields(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="instance_name__c"){document.getElementById(IncidentPageComp.ComponentVars.serviceIDName).value=e;DisableCIExpBtn()}else{if(b[0]=="fkbmc_baseelement__c"){document.getElementById(IncidentPageComp.ComponentVars.businessServiceID).value=e}}}}}function setServiceOfferingRelatedValues(e,b){if(b!=null&&b!=undefined){var d=b.split("П");for(var f=0;f<d.length;f++){var c=d[f].split(":");var h=c[1]!="null"?c[1]:"";h=decodeSpecialChar(h);if(c[0]=="instance_name__c"){document.getElementById(IncidentPageComp.ComponentVars.offeringNameEleID).value=h}else{if(c[0]=="fkbmc_baseelement__c"){document.getElementById(IncidentPageComp.ComponentVars.offeringIdEleID).value=h}}}}var a=document.getElementById(IncidentPageComp.ComponentVars.serviceIDName).value;var g=document.getElementById(IncidentPageComp.ComponentVars.businessServiceID).value;if(a==""||g==""){setServiceOffering(e)}}function linkCIIncidentJS(a){if(window.frames.SIIframeID.linkCIIncident!="undefined"&&window.frames.SIIframeID.linkCIIncident!=null){window.frames.SIIframeID.linkCIIncident(a)}else{linkCIIncident(a)}}function EnableAdditionalCILink(){primaryCI=document.getElementById(IncidentPageComp.ComponentVars.BaseElementIDName).value;var a=document.getElementById(IncidentPageComp.ComponentVars.serviceIDName).value;if((primaryCI!=null&&primaryCI!=""||a!=null&&a!="")&&incidentId!=""&&incidentId!=null){document.getElementById("linkAddCILink").style.display="block";DisableCIExpBtn()}}function selectBroadcastNextFromTabout(){var a=document.getElementById(IncidentPageComp.ComponentVars.BroadcastID).value;if(a!=null&&a!=""){setBroadcastNextJS(a)}}function setBroadcastNextJS(c){var i=document.getElementById(clLname).value;var g=document.getElementById(clFname).value;var f=document.getElementById(clUname).value;var h=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;var m=document.getElementById(accname).value;var d=document.getElementById(incAccountId).value;var p=document.getElementById(IncidentPageComp.ComponentVars.serviceRequestTitle).value;var r=document.getElementById(IncidentPageComp.ComponentVars.reqDefinationID).value;var a=document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value;var j=document.getElementById(IncidentPageComp.ComponentVars.IncidentDescription).value;var o=document.getElementById(IncidentPageComp.ComponentVars.IncidentResolution).value;var q=document.getElementById(IncidentPageComp.ComponentVars.StatusId).value;var b=document.getElementById(IncidentPageComp.ComponentVars.Status_Id).value;var k=document.getElementById(IncidentPageComp.ComponentVars.ImpactIDName).value;var n=document.getElementById(IncidentPageComp.ComponentVars.ImpactID).value;var l=document.getElementById(IncidentPageComp.ComponentVars.UrgencyIDName).value;var e=document.getElementById(IncidentPageComp.ComponentVars.UrgencyID).value;setBroadcastNext(c,i,g,f,h,m,d,p,r,a,j,o,q,b,k,n,l,e)};