var grid,dataStore,view,waitMask;var logWinHeight=175;Ext.onReady(function(){generateGrid();scanWinheight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;logWinHeight=parseInt(scanWinheight*0.3);generateCollapsiblePannel();generateToolbar();view=new Ext.Viewport({layout:"border",items:[toolbar,grid,AdvActionPanel]});if(exceptionErrMsg!=""){showLightningPopup("toast",errMsgHeader,exceptionErrMsg,"","","","","error")}hideLoadingMask()});function generateToolbar(){toolbar=new Ext.Toolbar({id:"toolBarId",region:"north",border:false,autoWidth:true,height:35,autoEl:true,items:[{xtype:"label",html:ACScannedDevices+'<br><label class="ACScannedDevicesCls">('+doubleClickRowToViewLog+")</label>",id:"lblScnannedDevices",margin:"0 0 0 10"},"->",{xtype:"label",text:scanStatus,id:"lblScnannerStatus",margin:"0 0 0 10"},"->",{xtype:"label",text:Status+":",margin:"0 0 0 10",cls:"statusLabelCls"},{xtype:"tbspacer",width:15},{xtype:"label",text:done+":"},{xtype:"label",text:doneCount},{xtype:"tbspacer",width:15},{xtype:"label",text:ACUnreachable+":"},{xtype:"label",text:unreachableCount},{xtype:"tbspacer",width:15},{xtype:"label",text:Initial+": "},{xtype:"label",text:initialCount},{xtype:"tbspacer",width:15},{xtype:"label",text:InProgress+": "},{xtype:"label",text:inProgressCount},{xtype:"tbspacer",width:15}]})}function generateCollapsiblePannel(){AdvActionPanel=Ext.create("Ext.panel.Panel",{id:"AdvActionPanel",region:"south",collapsible:true,collapsed:true,tbar:tbar,split:true,collapseMode:"mini",floatable:true,minHeight:logWinHeight,autoScroll:true,resizable:false,html:'<div id="LogDiv" ></div>',animCollapse:false,flex:1})}function generateGrid(){var deviceLogColumns=eval(strColumns);var deviceLogFields=eval(strFields);if(userLanguage=="iw"){deviceLogFields.reverse();deviceLogColumns.reverse()}Ext.define("Devices",{extend:"Ext.data.Model",fields:[{name:"ipAddress",type:"string"},{name:"macAddress",type:"string"},{name:"executionStart",type:"string"},{name:"name",type:"string"},{name:"osName",type:"string"},{name:"status",type:"string"},{name:"detail",type:"string"},{name:"ssh",type:"string"},{name:"smb",type:"string"},{name:"wmi",type:"string"},{name:"snmp",type:"string"},{name:"sshOs",type:"string"},{name:"smbOs",type:"string"},{name:"wmiOs",type:"string"},{name:"snmpOs",type:"string"},{name:"nmapOs",type:"string"},{name:"sshSoftware",type:"string"},{name:"smbSoftware",type:"string"},{name:"wmiSoftware",type:"string"},{name:"sshHardware",type:"string"},{name:"wmiHardware",type:"string"},{name:"snmpHardware",type:"string"},{name:"snmpConnectivity",type:"string"},{name:"executionStop",type:"string"}]});dataStore=Ext.create("Ext.data.Store",{fields:deviceLogFields,data:proxyData,model:"Devices",proxy:{type:"memory",reader:{type:"json",root:"items"}}});grid=Ext.create("Ext.grid.Panel",{id:"grid",sortableColumns:false,region:"center",columns:deviceLogColumns,store:dataStore,autoScroll:true,listeners:{afterrender:function(p){p.getView().getEl().on("scroll",function(e,t){var currentScrollPos=p.getView().getEl().getScroll().top;var scrollHeight=p.getView().getEl().dom.scrollHeight;if(typeof(currentScrollPos)!="undefined"&&currentScrollPos!=null&&typeof(scrollHeight)!="undefined"&&scrollHeight!=null&&offset<(totalScannedDevices-100)&&(currentScrollPos>(scrollHeight*0.8)-600)&&gridPreviosCount+100==grid.getStore().getCount()){showLoadingMask();gridPreviosCount=grid.getStore().getCount();offset=offset+100;getScannedDevice(offset,orderBy,isByAscending)}},this);changeGridDirectionForRTL("grid-body")},itemdblclick:function(dv,record,item,index,e){Ext.getCmp("macAddressId").setText(record.data.macAddress);var AdvActionPanel=Ext.getCmp("AdvActionPanel");if(typeof(AdvActionPanel)!="undefined"&&AdvActionPanel!=null){Ext.getCmp("AdvActionPanel").setTitle(ScanLogsFor+" : "+record.data.ipAddress)}getScannedDeviceLog(record.data.ipAddress,record.data.executionStart,record.data.executionStop);if(typeof(AdvActionPanel)!="undefined"&&AdvActionPanel!=null){AdvActionPanel.expand()}}},columnLines:true,viewConfig:{stripeRows:true,trackOver:false,preserveScrollOnRefresh:true,preserveScrollOnReload:true}})}function insertLogData(){var d=document.getElementById("LogDiv");if(d){while(d.hasChildNodes()){d.removeChild(d.lastChild)}}if(typeof(scannedDeviceLog)!="undefined"&&scannedDeviceLog!=null&&scannedDeviceLog!=""&&typeof(d)!="undefined"&&d!=null&&d!=""){var b=scannedDeviceLog.split("\\n");for(i=0;i<b.length;i++){var e=b[i].split("\\t");for(j=0;j<e.length;j++){var f=document.createTextNode(e[j]);var a=document.createTextNode("\u00A0");d.appendChild(f);d.appendChild(a);d.appendChild(a)}var c=document.createElement("br");d.appendChild(c)}}if(typeof(executionStop)!="undefined"&&executionStop!=null){Ext.getCmp("ScanEndId").setText(executionStop)}else{Ext.getCmp("ScanEndId").setText("")}if(typeof(executionStart)!="undefined"&&executionStart!=null){Ext.getCmp("ScanStartId").setText(executionStart)}else{Ext.getCmp("ScanStartId").setText("")}}var tbar={height:35,id:"logToolbar",items:[{xtype:"label",text:ScanStart+": ",padding:"0 0 0 10px",style:"font-weight:bold"},{xtype:"label",id:"ScanStartId"},{xtype:"tbfill"},{xtype:"label",text:ACScanEnd+": ",style:"font-weight:bold"},{xtype:"label",id:"ScanEndId"},{xtype:"tbfill"},{xtype:"label",text:MACAddress+": ",style:"font-weight:bold"},{xtype:"tbspacer"},{xtype:"label",id:"macAddressId",padding:"0 20px 0 0"}]};function AddRecordsToGrid(){if(typeof(dataStore)!=undefined&&dataStore!=null&&dataStore.totalCount>0){dataStore.loadData(proxyData,true)}hideLoadingMask()}function AddRecordsToGridAfterSorting(){if(typeof(dataStore)!=undefined&&dataStore!=null&&dataStore.totalCount>0){var a=Ext.getCmp("grid").getStore();a.removeAll();dataStore.add(proxyData);hideLoadingMask()}}function doOnLoadActivity(){isFirstLoading=true}function changeGridDirectionForRTL(a){var b=document.getElementById(a);if(userLanguage=="iw"&&b!=null&&b!=undefined){b.dir="ltr"}else{return}};