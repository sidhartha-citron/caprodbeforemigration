var tb,strFields,proxyData,strColumns,dataStore,gridVar,isGridRequired,Help,tbfill,helpLink,acActionHandler,menuItems,msgStr,waitMask,errorCode="",gridMask,AdvActionMenu,incidentOrBEId,incidentId,AdvActionPanel,SubPanel,DescPanel,MainPanel,isAuthRequired;var CurrentPage,PageSize,offset,pageCount,actionsMenu,truncatedName,popUpWindow,rowIndex="",msgStrCommon="",strInstanceName;var parentWindow=window.parent;tbfill={xtype:"tbfill"};helpLink={xtype:"label",html:'<a href="#" style="text-decoration: none !important;" onclick="OpenHelppage();"><span style="font-size: 16px;cursor:pointer; color:black" title="'+Help+'" id="helpImpactAnalysisList" class="d-icon-question_circle"></a>'};acActionHandler=function(a,b){parentWindow.acActionHandler(a,b)};AdvActionMenu={id:"AdvAction",text:AdvActionLabel,disabled:!showAdvanceTab,handler:acActionHandler,baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",listeners:{render:function(){if(DisabledText!=""&&!showAdvanceTab){new Ext.ToolTip({target:"AdvAction",anchor:"left",html:DisabledText})}}}};function calculatePageCount(){pageCount=Math.ceil(TotalRecords/PageSize);return pageCount}function calculateOffset(){offset=PageSize*(CurrentPage-1);calculatePageCount();return offset}function ChangeListViewPageRecords(a){PageSize=a;calculatePageCount();CurrentPage=1;offset=calculateOffset();getCurrentPageRecords()}function addNoActionsMenu(){var a=new Ext.menu.Item({id:"noAcActionsMenu",baseCls:"bmc-menu-item",overCls:"bmc-menu-item-over",disabled:true,text:noActionsAvail});actionsMenu.add(a);stopWaitMask()}function selectrow(){if(rowIndex!=null||rowIndex!="undefined"||rowIndex!=""){gridVar.getSelectionModel().select(rowIndex)}}function showMenu(){if(msgStr==null||msgStr==""||msgStr=="undefined"){actionsMenu.show()}}function ACtabPanel(){Ext.QuickTips.init();truncatedName=parentWindow.truncatedName;strInstanceName=parentWindow.strInstanceName;actionsMenu=Ext.create("Ext.menu.Menu",{id:"AgentToolsMenu",baseCls:"bmc-menu",autoWidth:true,});addMenuItems();Ext.define("ProcessSort",{extend:"Ext.data.Model",fields:[{name:"ProcessOwner",type:"string"},{name:"ProcessName",type:"string"},{name:"ProcessPath",type:"string"},{name:"ProcessCurrentCpu",type:"string"},{name:"ProcessID",type:"int"},{name:"ProcessParentID",type:"int"},{name:"ProcessMemoryVirtual",type:"int"},{name:"ProcessMemoryUsed",type:"int"},{name:"ProcessThreadsCount",type:"int"}]});tb=Ext.create("Ext.toolbar.Toolbar",{id:"detailViewToolbarId",region:"north",height:40,border:false,autoWidth:true,autoHeight:true,autoEl:true,items:[{xtype:"tbspacer",width:5},{iconCls:"refresh",border:false,scale:"medium",tooltipType:"title",tooltip:Refresh,id:"refreshBtn",listeners:{click:function(){getCurrentPageRecords()}}},{xtype:"tbspacer",width:5},{xtype:"tbseparator"},{xtype:"tbspacer",width:5},{id:"ciActionsMenu",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",text:actions,tooltipType:"title",tooltip:actions,menu:actionsMenu,listeners:{click:function(){var d=window.location.pathname;if(d.indexOf("apex/AcDevices")!=-1){actionsMenu.removeAll();actionsMenu.hide();startWaitMask();if(parentWindow.cntxAssemblyId!=null&&parentWindow.cntxAssemblyId!=""&&parentWindow.cntxAssemblyId!="undefined"){if(parentWindow.mapDeviceIdVsActionsMenu!="undefined"&&typeof(parentWindow.mapDeviceIdVsActionsMenu[parentWindow.cntxAssemblyId])!="undefined"){stopWaitMask();addMenuItems();actionsMenu.show()}else{if(isConsoleAuthRequired){stopWaitMask();var c=ACFPLaunchWindowHeader;if(isDiscoveryEnabled){c=RFDisclaunchWindowHeader}popUpWindow=new Ext.Window({height:Ext.isIE?242:218,width:495,title:c,x:10,y:5,modal:true,resizable:false,frame:false,style:{borderRadius:0},cls:"popUpWindowClass",constrain:true,viewConfig:{forceFit:true},html:'<iframe frameborder="0" scrolling="no" src ="/apex/ACFPUserCredentialPage" style="width:100%;height:100%;border:none;"/>'});popUpWindow.show();popUpWindow.center()}else{checkUserAuthentication(true)}}}else{addNoActionsMenu();if(msgStr==null||msgStr==""||msgStr=="undefined"){actionsMenu.show()}}}}}},{xtype:"tbseparator"}]});if(isGridRequired==true){if(actionContext=="Processes"){dataStore=Ext.create("Ext.data.Store",{fields:strFields,data:proxyData,model:"ProcessSort",pageSize:PageSize,proxy:{type:"memory",reader:{type:"json",root:"items"}}})}else{dataStore=Ext.create("Ext.data.Store",{fields:strFields,data:proxyData,pageSize:PageSize,proxy:{type:"memory",reader:{type:"json",root:"items"}}})}var b;gridVar=Ext.create("Ext.grid.Panel",{id:"gridId",store:dataStore,columns:strColumns,region:"center",flex:3,stripeRows:true,autoScroll:true,viewConfig:{forceFit:true},listeners:{viewready:function(g){var c=0;var e=0;if(typeof(incidentOrBEId)!="undefined"&&incidentOrBEId!=""){var f=window.location.pathname;var d=f.indexOf("apex/AcDevices");if(d!=-1){this.setOverflowXY(undefined,"auto")}}},select:function(e,c,d){if(typeof(gridRowClickEvent)!="undefined"&&typeof(gridRowClickEvent)=="function"){gridRowClickEvent(e,c)}}}});if(isPaginationRequired=="true"){CurrentPage=1;PageSize=15;calculatePageCount();b=getPagingToolbar();gridVar.addDocked(b);addChildDockItem();updateTotalRecordCount()}}if(typeof(incidentId)!="undefined"&&incidentId!=""){var a;AdvActionPanel=Ext.create("Ext.panel.Panel",{id:"AdvActionPanel",region:"east",collapsible:true,collapsed:true,floatable:false,height:gridVar.height,title:AdvActionLabel,resizable:true,collapsedCls:"collapsed_class",html:'<iframe id="ORpage" style="width:100%;height:100%;border:none;"/>',animCollapse:false,listeners:{beforeexpand:function(){if(parentWindow.cntxAssemblyId==null||parentWindow.cntxAssemblyId==""||parentWindow.cntxAssemblyId.indexOf("AC:CS:-")!=0){msgStr=AcInvalidDeviceMsg;ShowMessageBox();return false}},expand:function(){if(parentWindow.cntxAssemblyId!=null&&parentWindow.cntxAssemblyId!=""&&parentWindow.cntxAssemblyId.indexOf("AC:CS:-")==0){if(document.getElementById("ORpage").src==""){a="ACAdvanceActions?standardLayout=true&stdForm=true&forAdvAction=true&IncId="+incidentId;this.update('<iframe src ="/apex/'+a+'" style="width:100%;height:100%;border:none;"/>');this.setDisabled(false)}}}}});if(showAdvanceTab){parentWindow.AdvActionPanel=AdvActionPanel}}}function addMenuItems(){var a=parentWindow.cntxAssemblyId;if(typeof(parentWindow.mapDeviceIdVsActionsMenu)!="undefined"&&typeof(parentWindow.mapDeviceIdVsActionsMenu[a])!="undefined"){menuItems=parentWindow.mapDeviceIdVsActionsMenu[a]}if(actionsMenu!=null&&actionsMenu!=""&&actionsMenu!="undefined"){actionsMenu.removeAll();if(IsMenurequired==true){actionsMenu.add({text:DefaultMenuItem+truncatedName,index:0,tooltip:DefaultMenuItem+strInstanceName,disabled:true});actionsMenu.add(menuItems)}else{actionsMenu.add(menuItems)}}if(typeof(incidentId)!="undefined"&&incidentId!=""){actionsMenu.add(AdvActionMenu)}}function addChildDockItem(){gridVar.child("[dock=bottom]").add([{text:TotalRecords,xtype:"label",id:"totalRecordId"},"->",{text:Records_per_page,xtype:"label"},Ext.create("Ext.form.ComboBox",{store:Ext.create("Ext.data.Store",{fields:["value","label"],data:PageSizeOptionsData}),queryMode:"local",displayField:"label",valueField:"value",editable:false,forceSelection:true,typeAhead:true,width:60,listeners:{afterrender:function(){this.setValue(PageSize)},change:function(d,c,a,b){if(typeof(a)!="undefined"&&a!=null){ChangeListViewPageRecords(c)}}}})])}function updateTotalRecordCount(){var b=Ext.getCmp("totalRecordId");var a;if(b!=null&&b!=""&&b!="undefined"){if(TotalRecords=="0"){a="&nbsp;&nbsp;&nbsp;"+NoRecordFoundMsg;b.setText(a,false)}else{a="&nbsp;&nbsp;&nbsp;<span>"+TotalRecords+"</span>&nbsp;<span>"+Records+"</span>";b.setText(a,false)}}}function checkUserAuthentication(a){if(a!=null&&a){isConsoleAuthRequired=false;getSupportedActionsForDevice(parentWindow.cntxAssemblyId)}}function getCurrentPageRecords(){startWaitMask();if(typeof(getPageRecords)!="undefined"){getPageRecords(offset,PageSize)}else{window.location.reload()}}function moveNext(){CurrentPage++;offset=calculateOffset();getCurrentPageRecords()}function movePrevious(){CurrentPage--;offset=calculateOffset();getCurrentPageRecords()}function moveFirst(){CurrentPage=1;offset=calculateOffset();getCurrentPageRecords()}function moveLast(){CurrentPage=pageCount;offset=calculateOffset();getCurrentPageRecords()}function doRefresh(){getCurrentPageRecords()}var PageSizeOptionsData=[{value:15,label:"15"},{value:25,label:"25"},{value:35,label:"35"},{value:45,label:"45"}];function getPagingToolbar(){var a=new Ext.PagingToolbar({id:"pagingToolbarId",store:dataStore,dock:"bottom",pageSize:PageSize,moveNext:moveNext,movePrevious:movePrevious,moveFirst:moveFirst,moveLast:moveLast,doRefresh:doRefresh,refreshText:PageRefresh,nextText:PageNext,firstText:PageFirst,lastText:PageLast,prevText:PagePrevious,beforePageText:Page,afterPageText:Of,cls:"PagingToolbarClass",listeners:{beforechange:function(c,b){CurrentPage=b;offset=calculateOffset();getCurrentPageRecords()},afterrender:function(b){b.items.get(2).el.setStyle("margin","0px 15px 0px 5px");b.items.get(6).el.setStyle("margin","0px 5px 0px 15px");b.child("#first").el.setStyle("margin-right","15px");b.child("#last").el.setStyle("margin-left","15px")}},getPageData:function(){var b={currentPage:CurrentPage,pageCount:pageCount,total:TotalRecords,PageSize:PageSize};return b}});a.child("#first").setIconCls("d-icon-angles_left");a.child("#prev").setIconCls("d-icon-angle_left");a.child("#next").setIconCls("d-icon-angle_right");a.child("#last").setIconCls("d-icon-angles_right");a.child("#refresh").setIconCls("d-icon-restart");a.child("#first").setWidth(15);a.child("#prev").setWidth(15);a.child("#next").setWidth(15);a.child("#last").setWidth(15);a.child("#refresh").setWidth(30);a.child("#refresh").addCls("bmc-btn-refresh");return a}function OpenHelppage(){parentWindow.OpenHelppage()}function ShowMessageBox(){if(msgStrCommon!=""||msgStr!=""){var a="";if(msgStrCommon!=""){a=msgStrCommon}else{if(msgStr!=""){a=msgStr}}if(a!=""){GetMessageBox("bmc-message").show({msg:a,title:strMessage,width:400,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}msgStr="";msgStrCommon=""}}function stopWaitMask(){if(typeof(waitMask)!="undefined"&&waitMask!=null&&waitMask!=""){waitMask.hide()}}function startWaitMask(){waitMask=new Ext.LoadMask(Ext.getBody(),{floating:{shadow:false},msgCls:"d-loader-container",msg:'<ul class="d-loading"><li class="d-loading__stick d-loading__stick_1"></li><li class="d-loading__stick d-loading__stick_2"></li><li class="d-loading__stick d-loading__stick_3"></li><li class="d-loading__stick d-loading__stick_4"></li><li class="d-loading__stick d-loading__stick_5"></li><li class="d-loading__stick d-loading__stick_6"></li><li class="d-loading__stick d-loading__stick_7"></li><li class="d-loading__stick d-loading__stick_8"></li><li class="d-loading__stick d-loading__stick_9"></li><li class="d-loading__stick d-loading__stick_10"></li><li class="d-loading__stick d-loading__stick_11"></li><li class="d-loading__stick d-loading__stick_12"></li></ul><div>'+pleasewait+"</div>"});if(typeof(waitMask)!="undefined"&&waitMask!=null&&waitMask!=""){waitMask.show()}}function fillGrid(){Ext.getCmp("gridId").getStore().loadRawData(proxyData);Ext.getCmp("gridId").getView().refresh()}function refreshGrid(){getCurrentPageRecords()}function addTbSpacer(){tb.add({xtype:"tbspacer",width:5})}function addTbSeperator(){tb.add({xtype:"tbseparator"})}function addRightTools(){tb.add(tbfill);tb.add(helpLink);tb.add({xtype:"tbspacer",width:10});tb.doLayout()}function showMsgWithParam(a){if(a!=""&&a!="undefined"){GetMessageBox("bmc-message").show({msg:a,title:strMessage,width:400,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}}function checkUserAuth(){if(isAuthRequired==true){openAuthDialog()}}function reloadActionTab(){startWaitMask();window.location.reload()}function openAuthDialog(){var a=ACFPLaunchWindowHeader;if(isDiscoveryEnabled){a=RFDisclaunchWindowHeader}popUpWindow=new Ext.Window({height:Ext.isIE?242:218,width:495,title:a,x:10,y:5,modal:true,resizable:false,frame:false,style:{borderRadius:0},cls:"popUpWindowClass",constrain:true,viewConfig:{forceFit:true},html:'<iframe frameborder="0" scrolling="no" src ="/apex/ACFPUserCredentialPage" style="width:100%;height:100%;border:none;"/>'});popUpWindow.show();popUpWindow.center()}function setPopUpVar(){reloadActionTab()}function GetMessageBox(a){if(typeof(WinMsg)=="undefined"||WinMsg==null){WinMsg=Ext.create("Ext.window.MessageBox")}WinMsg.baseCls=a;return WinMsg};