var clickedOnce=false,isCustomPage=true,renderSI=false,widParam,doReloadSI=true,siTabClicked=false,chTabclicked=false,ciRelTabClicked=false,isNewOrClone=true;if(BE_RECORD_ID!=null&&BE_RECORD_ID!=""&&BE_RECORD_ID!="null"){isNewOrClone=false}var ownerNameLookupEle,ownerIdLookupEle,ownerIdLookupBtn;var disableForSRD=true;var WinMsg;var HelpHandler=function(a,b){window.open(wikiHelp)};if(isFromSRD=="true"){disableForSRD=false}function showWaitMsgBar(){waitMsg=new Ext.LoadMask(document.getElementById("capsule"),{floating:{shadow:false},msgCls:"d-loader-container",msg:'<ul class="d-loading"><li class="d-loading__stick d-loading__stick_1"></li><li class="d-loading__stick d-loading__stick_2"></li><li class="d-loading__stick d-loading__stick_3"></li><li class="d-loading__stick d-loading__stick_4"></li><li class="d-loading__stick d-loading__stick_5"></li><li class="d-loading__stick d-loading__stick_6"></li><li class="d-loading__stick d-loading__stick_7"></li><li class="d-loading__stick d-loading__stick_8"></li><li class="d-loading__stick d-loading__stick_9"></li><li class="d-loading__stick d-loading__stick_10"></li><li class="d-loading__stick d-loading__stick_11"></li><li class="d-loading__stick d-loading__stick_12"></li></ul><div>'+pleaseWaitMsg+"</div>"});if(typeof(waitMsg)!="undefined"&&waitMsg!=null&&waitMsg!=""){waitMsg.show()}}function applyChatterFeedIframeStyle(){var c=document.getElementById("ChatterFeedDiv");var d=document.getElementById("chf");if(c&&d){var b=Ext.getBody().getViewSize().width;d.style.width=(b+15)+"px";var a=Ext.getBody().getViewSize().height;d.style.height=(a-50)+"px"}}function clearLocation(){var d=modelAttrMap[orgNamespace.toLocaleLowerCase()+"fklocation__ctxt"];var b=modelAttrMap[orgNamespace.toLocaleLowerCase()+"fklocation__clkp"];if(d){var c=d.htmlId;var a=document.getElementsByName(c);if(a!=null&&a!=undefined){a[0].value=""}}if(b){var c=b.htmlId;var a=document.getElementsByName(c);if(a!=null&&a!=undefined){a[0].value=""}}}function postExtOnReady(){var g=[{xtype:"tbspacer",width:5},{scale:"medium",tooltipType:"title",tooltip:_ServerValues.New,id:"newCIInstanceBtn",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:_ServerValues.New,listeners:{mouseover:function(){this.setIconCls("bmcNewOn")},mouseout:function(){this.setIconCls("bmcNew")}},handler:function(){NewCI()}},{xtype:"tbspacer",width:5},{xtype:"button",scale:"medium",border:false,tooltipType:"title",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:_ServerValues.Clone,tooltip:_ServerValues.Clone,id:"cloneButton",disabled:isNewOrClone,listeners:{mouseover:function(){this.setIconCls("bmcNewOn")},mouseout:function(){this.setIconCls("bmcNew")}},handler:function(){CloneCI()}},{xtype:"tbspacer",width:5},{scale:"medium",border:false,tooltipType:"title",tooltip:_ServerValues.Save,id:"saveId",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",text:_ServerValues.Save,listeners:{mouseover:function(){this.setIconCls("bmcSaveOn")},mouseout:function(){this.setIconCls("bmcSave")},disable:function(){this.setIconCls("bmcSaveDisable")}},handler:function(){if(ValidateForm()){showWaitMsgBar();Ext.getCmp("saveId").setDisabled(true);SaveClick()}}},{xtype:"tbspacer",width:5},"-",{xtype:"tbspacer",width:5},{xtype:"button",autoEl:{title:_ServerValues.LaunchCIExplorerLabel},scale:"medium",iconCls:"bmcCIExplorer",disabled:isNewOrClone,id:"ciExplorerBtn",listeners:{disable:function(){this.setIconCls("bmcCIExplorer disablecss")},enable:function(){this.setIconCls("bmcCIExplorer")}},handler:function(){if(isFromSRD=="true"){ShowCIExplorerFromRD(BE_InstanceID)}else{window.parent.ShowCIExplorer(BE_InstanceID,Classname)}}},"->",{xtype:"box",id:"helpId",hidden:disableForSRD,autoEl:{tag:"img",src:helpIcon,title:helpLabel},cls:"cursorSpaceCls",listeners:{render:function(e){e.el.on("click",HelpHandler)}}}];if(userLanguage=="iw"){g.reverse()}var d=new Ext.Toolbar({id:"toolBarId",renderTo:"ToolBarTD",cls:"toolSpCls",border:false,autoWidth:true,items:g});if(flattenedCMDB){enableDisableNewAndSaveBtn()}else{d.items.get("newCIInstanceBtn").setDisabled(!(_ServerValues.isCreateEnabled))}if(BE_RECORD_ID!=""&&!(_ServerValues.isSaveEnabled)){d.items.get("saveId").setDisabled(true)}if(isFromSRD!=null&&isFromSRD!=""&&isFromSRD=="true"){d.items.get("newCIInstanceBtn").hide();d.items.get("cloneButton").hide()}else{if((isACEnabled||isDiscoveryEnabled)&&typeof(assemblyId)!="undefined"&&assemblyId!=null&&assemblyId.indexOf("AC:CS:-")==0){var b=getACMenu();var a=acActionLabel;if(isDiscoveryEnabled){a=CIAction}var c=8;if(userLanguage=="iw"){c=3}else{d.insert(7,"-")}d.insert(c,{baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",menu:b,text:_ServerValues.Actions,tooltipType:"title",tooltip:a,listeners:{click:function(k,i,j,h){Ext.getCmp("actionMenu").show()}}});d.doLayout(true,true)}}setSizeOnWindowResize();try{window.parent.ActiveInstanceReference=this}catch(f){}}function functionextonreadypagecall(){if(_ServerValues.savestatusMessage==recordNotAccessible){GetMessageBox("bmc-message").show({msg:recordNotAccessible,width:400,height:"auto",buttons:Ext.MessageBox.OK,title:_ServerValues.Error,icon:Ext.MessageBox.ERROR});return}windowloaddate=new Date();networklatencystart=windowloaddate.getTime();var e=networklatencystart-etime;data+=_ServerValues.NetwokLatencyLabel;data+=e;data+="<br>";var b=new Date();var a=b.getTime();Ext.QuickTips.init();ExtOnReady();if(lookupId&&document.getElementById(lookupName).value==""){document.getElementById(lookupId).value=userId;document.getElementById(lookupName).value=userName}data+=_ServerValues.PageLoadLabel;var g=new Date();var f=g.getTime();var d=windowloaddate.getTime();var c=(f-a);data+=c;handleElemEvent()}function handleChange(){if(!clickedOnce){clickedOnce=true;if(typeof(window.parent.parent.registerChange)!="undefined"&&typeof(window.parent.parent.registerChange)!=null){window.parent.parent.registerChange(getWID())}}}function GetQueryString(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+b+"=([^&#]*)";var d=new RegExp(a);var c=d.exec(window.location.href);if(c==null){return""}else{return c[1]}}function cloneCIPanel(){var a=currentClassName;showWaitMsgBar();window.location="/apex/cmdbgenericpage?className="+urlencode(a)+"&InstanceID="+urlencode(BE_InstanceID)+"&classNameTitle="+urlencode(classNameTitle)+"&tabName="+urlencode(tabName)+"&isClone="+urlencode("true")}function CloneCI(){var a=getDataModifiedFlag();if(a){GetMessageBox("bmc-message").show({title:window.parent._ServerValues.closeWindowTitle,msg:window.parent._ServerValues.closeWindowMessage,width:400,buttons:Ext.Msg.YESNO,fn:function(b){if(b=="yes"){cloneCIPanel()}},icon:Ext.MessageBox.WARNING})}else{cloneCIPanel()}}function NewCI(){var a=getDataModifiedFlag();if(a){GetMessageBox("bmc-message").show({title:window.parent._ServerValues.closeWindowTitle,msg:window.parent._ServerValues.closeWindowMessage,width:400,buttons:Ext.Msg.YESNO,fn:function(b){if(b=="yes"){openNewCIPanel()}},icon:Ext.MessageBox.WARNING})}else{openNewCIPanel()}}function urlencode(a){return encodeURIComponent(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function openNewCIPanel(){var a=currentClassName;showWaitMsgBar();window.location="/apex/cmdbgenericpage?className="+urlencode(a)+"&InstanceID=&classNameTitle="+urlencode(classNameTitle)+"&tabName="+tabName}var InRGrid;function onSaveComplete(){if(BE_RECORD_ID!=null&&BE_RECORD_ID!=""&&BE_RECORD_ID!="null"){isNewOrClone=false}if(!isNewOrClone){Ext.getCmp("ciExplorerBtn").setDisabled(false);Ext.getCmp("ciRelPanel").setDisabled(false);Ext.getCmp("chatterPanel").setDisabled(false);Ext.getCmp("siPanel").setDisabled(false)}MainPanelRender();if(_ServerValues.savestatus=="true"){siTabClicked=false;chTabclicked=false;ciRelTabClicked=false;setDataModifiedFlag();var a=window.parent.instanceFramePanel;if(window.parent.instanceFramePanel!=null&&typeof(window.parent.instanceFramePanel)!="undefined"){setInstanceFramePanelTitle(instName)}if(isFromSRD=="true"){var d=document.getElementById(instanceNameTxtBoxID).value;d=d;var c=parent.document.getElementById("headerTextVFpage");if(c){c.innerText=d}GetMessageBox("bmc-message").show({title:"",msg:savedSuccessful,buttons:Ext.Msg.OK,fn:function(e){setServiceTypeforSRD();window.parent.setPopUpVar(BE_RECORD_ID,"")}})}else{ShowInlineSaveMessage()}}else{if(_ServerValues.savestatusMessage!=null&&_ServerValues.savestatusMessage!=""){var b=getEncodedMessageForRecon(_ServerValues.savestatusMessage);GetMessageBox("bmc-message").alert("",b)}}}var ChangeVisibilityVar;function ShowInlineSaveMessage(){var d=1;CloseSavePopUp();if(strWarningMessageforFieldsNotUpdated){var g=document.getElementById("WarningMessageDiv");if(g!=null&&g!="undefined"){var i,b,a;g.setAttribute("style","visibility:hidden;width:auto;position: absolute;");i=document.getElementById("ToolBarTD").clientWidth;b=g.clientWidth;var h=document.getElementById("warningMessageId");var f=document.createTextNode(strFieldsNotUpdatedDueToPriorityRules);var e=document.createTextNode(strWarningMessageforFieldsNotUpdated);if(h){while(h.firstChild){h.removeChild(h.firstChild)}h.appendChild(f);h.appendChild(document.createElement("br"));h.appendChild(e)}if(i!=null&&typeof(i)!="undefined"&&b!=null&&typeof(b)!="undefined"){a=parseInt((i/2)-(b/2)-100)}g.setAttribute("style","display:flex; position: absolute; z-index:100;-webkit-animation: dialog-flyin .5s;animation: dialog-flyin .5s;left: "+a+"px;margin-top:28px;");setTimeout(function(){CloseSavePopUp()},10000)}}else{var c=document.getElementById("SaveMessageDiv");if(c!=null&&c!="undefined"){var i,b,a;c.setAttribute("style","visibility:hidden;width:auto;position: absolute;");i=document.getElementById("ToolBarTD").clientWidth;b=c.clientWidth;if(i!=null&&i!="undefined"&&b!=null&&b!="undefined"){a=parseInt((i/2)-(b/2)-25)}ChangeVisibilityOfMeassge(-24,0,c,d,a)}}}function ChangeVisibilityOfMeassge(e,c,a,d,b){ChangeVisibilityVar=setTimeout(function(){a.setAttribute("style","display:flex; position: absolute; z-index:100;left: "+b+"px;margin-top:"+e+"px;");if(d<28){if(d<14){e=e+2}else{e=e-2}d++;if(d!=15){ChangeVisibilityOfMeassge(e,80,a,d,b)}else{ChangeVisibilityOfMeassge(e,1000,a,d,b)}}else{CloseSavePopUp()}},c)}function CloseSavePopUp(){clearTimeout(ChangeVisibilityVar);document.getElementById("SaveMessageDiv").setAttribute("style","display:none;");var a=document.getElementById("warningMessageId");if(a){while(a.firstChild){a.removeChild(a.firstChild)}}document.getElementById("WarningMessageDiv").setAttribute("style","display:none;")}var isCMDBClassPermissionsEnable=false,fallBackToFresh=false,readAccessClassIds="";function handleCMDBClassPermissions(){var c=window.parent;if(c&&c.isCMDBClassPermissionsEnable){isCMDBClassPermissionsEnable=true;if(c.getClassLevelPermissions){var a=c.getClassLevelPermissions(currentClassName);if(a){_ServerValues.isCreateEnabled=a.Permissions.isCreateable;_ServerValues.isSaveEnabled=a.Permissions.isUpdateable}}if(typeof(c.readAccessClassIdsArr)!="undefined"){readAccessClassIds=c.readAccessClassIdsArr.toString()}}else{if(c&&typeof(c.fallBackToFresh)!="undefined"&&c.fallBackToFresh){fallBackToFresh=true;if(c.getBaseElementObjectPermission){var b=c.getBaseElementObjectPermission();if(b){_ServerValues.isCreateEnabled=b.isCreateable;_ServerValues.isSaveEnabled=b.isUpdateable}}}}}function ExtOnReady(){MainPanelRender();handleCMDBClassPermissions();if(typeof(postExtOnReady)!="undefined"&&postExtOnReady!=null){postExtOnReady()}}function MainPanelRender(){createControlMap();renderElementsByType();renderTabs()}function renderTabs(){var o=Ext.getBody().getViewSize().height-50;var g=null;if(_ServerValues.isCustomAvailable=="true"){if(_ServerValues.tabDerivedInfoTitleTabTip!=""&&_ServerValues.tabDerivedInfoTitleTabTip!="undefined"&&_ServerValues.tabDerivedInfoTitleTabTip!=null){g=[{contentEl:"tabBaseInfo",title:_ServerValues.tabBaseInfoTitle,id:"generalTab",autoWidth:true,layout:"fit"},{contentEl:"tabDerivedInfo",title:_ServerValues.tabDerivedInfoTitle,tabTip:_ServerValues.tabDerivedInfoTitleTabTip,id:"specificationTab",layout:"fit"},{contentEl:"tabCustomInfo",title:_ServerValues.CMDBCustomTitle,id:"customFieldsTab",layout:"fit"}]}else{g=[{contentEl:"tabBaseInfo",title:_ServerValues.tabBaseInfoTitle,id:"generalTab",autoWidth:true,layout:"fit"},{contentEl:"tabDerivedInfo",title:_ServerValues.tabDerivedInfoTitle,id:"specificationTab",layout:"fit"},{contentEl:"tabCustomInfo",title:_ServerValues.CMDBCustomTitle,id:"customFieldsTab",layout:"fit"}]}}else{if(_ServerValues.tabDerivedInfoTitleTabTip!=""&&_ServerValues.tabDerivedInfoTitleTabTip!="undefined"&&_ServerValues.tabDerivedInfoTitleTabTip!=null){g=[{contentEl:"tabBaseInfo",title:_ServerValues.tabBaseInfoTitle,id:"generalTab",autoWidth:true,layout:"fit"},{contentEl:"tabDerivedInfo",title:_ServerValues.tabDerivedInfoTitle,tabTip:_ServerValues.tabDerivedInfoTitleTabTip,id:"specificationTab"}]}else{g=[{contentEl:"tabBaseInfo",title:_ServerValues.tabBaseInfoTitle,id:"generalTab",autoWidth:true,layout:"fit"},{contentEl:"tabDerivedInfo",title:_ServerValues.tabDerivedInfoTitle,id:"specificationTab",autoWidth:true,layout:"fit"}]}}var n=new Ext.create("Ext.tab.Panel",{activeTab:0,tabPosition:userlocale=="iw"?"right":"left",minTabWidth:180,height:o,cls:"MainPanel",defaults:{autoScroll:true},items:g,id:"MainPanelId",autoWidth:true,layout:"fit"});var d=new Ext.Panel({contentEl:"AttributesDiv",title:_ServerValues.AttributeTitle,autoWidth:true,autoHeight:true,layout:"fit",items:n});var b=renderChatterSection();var k=[d,{id:"ciRelPanel",disabled:isNewOrClone,contentEl:"CMDBRelationshipsDiv",title:_ServerValues.RelationshipsTile,layout:"fit",autoWidth:true,height:o},{id:"chatterPanel",hidden:!isChatterFeed,disabled:isNewOrClone,contentEl:"ChatterFeedDiv",title:_ServerValues.ChatterFeedTitle,layout:"fit",autoWidth:true,height:o},{id:"siPanel",disabled:isNewOrClone,contentEl:"configDetailsDiv",title:_ServerValues.Details,layout:"fit",autoWidth:true,height:o}];if(userlocale=="iw"){k=k.reverse()}var l=new Ext.TabPanel({id:"ciTabPanel",renderTo:"mainDivId",activeTab:isCalledFromReport?1:0,autoWidth:true,border:false,cls:"centralTabPanelCls",deferredRender:true,tabBar:{layout:{pack:(userlocale=="iw")?"end":"start"}},autoWidth:true,layout:"fit",height:o,items:k,listeners:{tabchange:function(i,p){if(p.id=="siPanel"){if(!isNewOrClone&&!siTabClicked){showWaitMsgBar();var q=document.getElementById("SIIframeID");q.style.visibility="visible";q.src=iFrameSrc;siTabClicked=true}}else{if(p.id=="chatterPanel"){if(!isNewOrClone&&!chTabclicked){showWaitMsgBar();var q=document.getElementById("chf");q.style.visibility="visible";chTabclicked=true;q.src=chtrSrc}}else{if(p.id=="ciRelPanel"){if(!isNewOrClone&&!ciRelTabClicked){showWaitMsgBar();var q=document.getElementById("ciRelListFrame");q.style.visibility="visible";q.src=ciRelSrc;ciRelTabClicked=true}}}}}}});if(userlocale=="iw"){Ext.getCmp("ciTabPanel").setActiveTab(3)}if(!isChatterFeed){var m=Ext.getCmp("chatterPanel");m.tab.hide()}if(typeof(isFromSRD)!="undefined"&&isFromSRD=="true"){var m=Ext.getCmp("ciRelPanel");m.tab.hide()}var a=l.items;if(isNewOrClone&&Ext.isIE){for(var f=1;f<4;f++){var h=l.getTabEl(f);if(h!=null&&h!="undefined"){var c=new Ext.Element(h);var j=document.getElementById(c.id);if(j.hasChildNodes()){var e=0.4;j.lastChild.style.filter="alpha(opacity="+e*100+")"}}}}}function renderChatterSection(){var a=new Ext.Panel({id:"chatterPanel",disabled:isNewOrClone,title:_ServerValues.ChatterFeedTitle,layout:"fit",autoWidth:true,border:false,items:new Ext.Panel({contentEl:"ChatterFeedDiv",border:false})});return a}var InstancesGrid;var isSource=false;var isDestination=true;var strSourceInstanceID;var strDestinationInstanceID;function ExplorerItemClickHandler(a){getInstanceListStore(a)}function SIComp(a){}function getInstanceListStore(b){if(typeof(b)=="undefined"){if(typeof(this.RelClassName)!="undefined"){b=this.RelClassName}}this.RelClassName=b;var c="/apex/CMDBJSONGenerator?type=instancelistfornewcirelationship&ClassName="+b+"&InstanceID="+_ServerValues.InstanceID+"&PageNumber="+this.Paging_PageNumber+"&sortdirection="+this.sortdirection+"&sortfield="+this.sortfield;var a=new Ext.data.JsonStore({url:c,root:"data",idPath:"InstanceID",fields:["InstanceID","Name","Description","Dataset"],sortInfo:{field:sortfield,direction:sortdirection}});a.load();a.on("load",function(){InstancesGrid.reconfigure(a,InstancesGrid.colModel);try{this.enableDisablePagingButtons()}catch(d){}}.createDelegate(this));return a}function enableDisablePagingButtons(){if(InstancesGrid.store.reader.jsonData.hasPrevious){Ext.getCmp("PreviousPageButton").enable()}else{Ext.getCmp("PreviousPageButton").disable()}if(InstancesGrid.store.reader.jsonData.hasNext){Ext.getCmp("NextPageButton").enable()}else{Ext.getCmp("NextPageButton").disable()}this.Paging_PageNumber=this.InstancesGrid.store.reader.jsonData.pageNumber}function assignApexErrorMessage(){var b=document.getElementById("apexMessageErrorPanelDiv");if(isFromSRD=="true"){setServiceTypeforSRD()}if(b!=null&&b.firstChild!=null){var c=b.firstChild;var a=RemedyForceHTMLProcessor.getText(c.firstChild);a=getEncodedMessageForRecon(a);GetMessageBox("bmc-message").show({title:_ServerValues.Error,msg:a,icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK})}if(instName){Ext.getCmp("cloneButton").setDisabled(false)}enableDisableNewAndSaveBtn()}function checkACError(){if(acError!=""){GetMessageBox("bmc-message").show({msg:acError,width:300,height:"auto",buttons:Ext.MessageBox.OK})}else{launchConsole()}}function ShowCIExplorerFromRD(c){var b="/apex/CIExplorerLauncher?Module=CI&RecordSequence="+c+"&id="+c+"&stdForm=true";var a="status = 1,height = "+stdLayoutScreenHeight+", width = "+stdLayoutScreenWidth+",left="+stdScreenLeft()+",top="+stdScreenTop()+", resizable = 1,scrollbars=no";window.open(b,"RDCIExplorer",a)}function openOwnerLookupForBE(){openOwnerLookup("OWNER","BMC_BaseElement__c")}function openOwnerLookup(i,d,a){var e=i;var b=parseInt((screen.availWidth/2)-(1000/2));var c=parseInt((screen.availHeight/2)-(600/2));var h=1000;var f=600;var g="width="+h+",height="+f+",status=1,resizable=1,scrollbars=no,left="+b+",top="+c;window.open("/apex/SuggestionPage?parentObjectName="+d+"&fromInciOwnerLkup=true&ownerType="+e,"lookup",g)}function setOwnerLookupEle(a){if(a!=null){ownerIdLookupBtn=a}}function assignOwnerfields(a,d,c,b){if(lookupId&&lookupName){ownerIdLookupEle=document.getElementById(lookupId);ownerNameLookupEle=document.getElementById(lookupName)}if(ownerIdLookupEle&&ownerNameLookupEle){if(c!=null&&c.length>0){ownerNameLookupEle.value=b;ownerIdLookupEle.value=c}else{if(a!=null&&d.length>0){ownerNameLookupEle.value=d;ownerIdLookupEle.value=a}}}}var isAutocomplete=false;var currentConsole="CMDB_InstanceEditor";function getFilterCondition(e,b,d,c,a){if(b=="User"||b=="AllUser"){return escape("Isactive = true ")}if(b=="Impact__c"||b=="Priority__C"||b=="Urgency__c"||b=="Category__c"||b=="Status__c"){return escape("Inactive__c = false")}if(b=="Broadcasts__c"||b=="Task__c"||b=="Incident__c"||b=="Release__c"||b=="Change_Request__c"||b=="Problem__c"){return escape("Inactive__c = false AND state__c = true")}if(b=="BMC_BaseElement__c"||b=="BMC_BusinessService__c"){return escape("MarkAsDeleted__c=false ")}if(b=="SYSTemplate__c"){return escape("Inactive__c = false and systemTemplate__c = false")}if(typeof(b)!="undefined"&&b!="User"&&b!="Account"&&b.indexOf("__c")<0){return""}}function setDivPosition(d){var c=[d.offsetLeft,d.offsetTop];var b;while(d.offsetParent!=null){var a=d.offsetParent;c[0]+=a.offsetLeft-a.scrollLeft;b=a.offsetTop-a.scrollTop;c[1]+=b;d=a}return c}function applyModelAttribute(b){showWaitMsgBar();var a="";Visualforce.remoting.Manager.invokeAction(_RemotingActions.getModelAttributeMap,b,a,function(c,d){if(d.type==="exception"){alert(d.message)}else{setAttributeValue(c)}},{escape:false})}function setAttributeValue(p){var e=p.modAttrList;for(var h=0;h<e.length;h++){var c=e[h];var n=c.split(":");var g=n[0];var d="";var o=n.length;var m=n[o-1];if(o>3){n.splice(o-1,1);n.splice(0,1);d=n.join(":")}else{d=n[1]}if(g!=null&&g!=""){var j=modelAttrMap[g];if(m!=null&&m!="null"&&m!=""){j=modelAttrMap[g+"txt"];if(j){var l=j.htmlId;var k=document.getElementsByName(l);if(k!=null&&k!=undefined){k[0].value=d}}j=modelAttrMap[g+"lkp"];if(j){l=j.htmlId;var b=document.getElementsByName(l);if(b!=null&&b!=undefined){b[0].value=m}}}else{if(j){var l=j.htmlId;var f=j.type;var a=document.getElementById(l);if(f=="checkbox"){if(d=="true"){a.checked=true}else{a.checked=false}}if(a!=null&&a!=undefined){a.value=d}}}setupTooltipIcon(g)}}hideWaitMsgBar()}function setupTooltipIcon(a){var c="userInfo"+a.toLowerCase();var b=document.getElementById(c);if(b){b.setAttribute("style","display:inline-block")}}var lkpApiName="";function changelookupValues(e,c){var d="";if(lkpApiName.toUpperCase().indexOf("__FKMODEL__C")!=-1){applyModelAttribute(e)}if(e!=""&&e!=null){var g=modelAttrMap[lkpApiName+"txt"];if(g){var b=g.htmlId;var a=document.getElementsByName(b);if(a!=null&&a!=undefined){a[0].value=c}}g=modelAttrMap[lkpApiName+"lkp"];if(g){var b=g.htmlId;var f=document.getElementsByName(b);if(f!=null&&f!=undefined){d=f[0].value;f[0].value=e}}}if(d!=e){dataModifiedFlag=1}setupTooltipIcon(lkpApiName)}function enableDisableNewAndSaveBtn(){var b=Ext.getCmp("toolBarId");var a=b.items.get("cloneButton");if(isCMDBClassPermissionsEnable||fallBackToFresh){var d=b.items.get("newCIInstanceBtn");var c=b.items.get("saveId").setDisabled(false);if(_ServerValues.isCreateEnabled){d.setDisabled(false);c.setDisabled(false);a.setDisabled(false)}else{d.setDisabled(true);a.setDisabled(true)}}else{if(_ServerValues.isCreateEnabled){if(isAssetManagementEnabled&&isCIManagementEnabled){if(instanceType.toLowerCase()=="ci"){if(updateCI){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}else{if(instanceType.toLowerCase()=="asset"){if(updateAsset){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}else{if(instanceType.toLowerCase()=="ci / asset"){if(tabName.toLowerCase()=="ci"){if(updateCI){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}else{if(tabName.toLowerCase()=="asset"){if(updateAsset){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}else{if(CMDBClassType.toLowerCase()=="ci"){if(updateCI){b.items.get("newCIInstanceBtn").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);a.setDisabled(true)}}else{if(CMDBClassType.toLowerCase()=="asset"){if(updateAsset){b.items.get("newCIInstanceBtn").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);a.setDisabled(true)}}else{if(updateCI&&updateAsset){b.items.get("newCIInstanceBtn").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);a.setDisabled(true)}}}if(updateCI&&updateAsset){b.items.get("saveId").setDisabled(false)}else{b.items.get("saveId").setDisabled(true)}}}}else{if(CMDBClassType.toLowerCase()=="ci"){if(updateCI){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}else{if(CMDBClassType.toLowerCase()=="asset"){if(updateAsset){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}else{if(CMDBClassType.toLowerCase()=="ci and asset"){if(tabName.toLowerCase()=="ci"){if(updateCI){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}else{if(tabName.toLowerCase()=="asset"){if(updateAsset){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}else{if(updateAsset&&updateCI){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}}}}}}}}}else{if(!isAssetManagementEnabled&&isCIManagementEnabled){if(updateCI){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}else{if(isAssetManagementEnabled&&!isCIManagementEnabled){if(updateAsset){b.items.get("newCIInstanceBtn").setDisabled(false);b.items.get("saveId").setDisabled(false);a.setDisabled(false)}else{b.items.get("newCIInstanceBtn").setDisabled(true);b.items.get("saveId").setDisabled(true);a.setDisabled(true)}}}}}else{b.items.get("newCIInstanceBtn").setDisabled(true);a.setDisabled(true)}}if(instName==""){a.setDisabled(true)}}function GetMessageBox(a){if(WinMsg==null){WinMsg=Ext.create("Ext.window.MessageBox")}WinMsg.baseCls=a;return WinMsg}function hideWaitMsgBar(){hideWaitMsg()}function getEncodedMessageForRecon(a){var b=a;if(isReconEnable&&b&&b.indexOf("<br/>")>-1){b=b.replace(/<br\/>/g,"##Token_To_Replace##");b=Ext.util.Format.htmlEncode(b);b=b.replace(/##Token_To_Replace##/g,"<br/>")}return b}function setSizeOnWindowResize(){try{var a=Ext.getBody().getViewSize().width-2;var j=Ext.getBody().getViewSize().height-40;var c=document.getElementById("capsule");var h=Ext.getCmp("ciTabPanel");if(c){c.style.width=" "+a+"px"}a=a-2;var h=Ext.getCmp("ciTabPanel");if(h){h.setWidth(a);h.setHeight(j)}var d=Ext.getCmp("MainPanelId");if(d){d.setWidth(a);d.setHeight(j)}var b=Ext.getCmp("ciRelPanel");if(b){b.setWidth(a);b.setHeight(j)}var i=Ext.get("CMDBRelationshipsDiv");if(i){i.setWidth(a);i.setHeight(j)}var f=Ext.get("configDetailsDiv");if(f){f.setWidth(a);f.setHeight(j)}applyChatterFeedIframeStyle()}catch(g){console.log(g)}}Ext.EventManager.onWindowResize(function(){setSizeOnWindowResize()});