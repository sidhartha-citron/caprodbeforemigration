var lastModifiedByLocking="";var initialRecordState="";var incidentName=IncidentConsolePage.Labels.New;var LabelNew=IncidentConsolePage.Labels.New_Incident;var tabName=IncidentConsolePage.Labels.IncidentRecordPrefix+": "+IncidentConsolePage.Labels.New;var OwnerChangeSaveErrorMsg=IncidentConsolePage.Labels.OwnerChangeSaveErrorMsg.replace(":",".");var recordState="";var isRecordLock="";var broadcast="";var categoryId="";var status="";var clientId="";var accountId="";var desc="";var ServiceTargetStatus="";var isDeleted=false;var selectedUserId="";var selectedCategoryId="";var disableActionBtn=false;var disableAgentBtn=false;var incidentTypeafterSave="";var iscalledAfterSave=false;var LKFId;var isApproved;var isNeedToRefreshIncident=false;var isNeedToRefreshRelatedList=false;var isNeedToRefreshSmartView=false;var isFocusOnIncidentForm=true;var isFocusOnRelatedList=false;var isFocusOnSmartView=false;var isNewIncidentForm=false;var isNeedToRefreshIncList=false;var waitMsgBar="";var isIncidentFormFrameLoaded=true;var isIncRelatedListFrameLoaded=true;var isIncSmartViewFrameLoaded=true;var clickedOnce=false;var isNeedToCloseRltedBraodcast=false;var isNeedToReopenRltedBraodcast=false;var fromQuickclose=false;var saveFromQuickClose=false;var isNewRecordLock=false;var isResponded=false;var isSaveForSingleConsole=true;var isSAVE=false;var screenWidth=671;var screenHeight=400;var ServiceTargetsBtnHandlerWindow;var SconsoletabName="";var addNoteHandler;var cloneBtnHandler;var CloseBtnHandler;var ReopenBtnHandler;var RespondedBtnHandler;var QuickCloseBtnHandler;var sendEmailBtnHandler;var MatchingIncidentBtnHandler;var newActionHandler;var viewActionHistoryBtnHandler;var FulfillRequestHandler;var isOptionalItemsAdded=false;var IncidentManifestBtnHandler;var ServiceTargetsBtnHandler;var SuggestedTemplatesBtnHandler;var MatchingIncidentBtnHandler;var CIExplorerBtnHandler;var SuggestwedOwnersBtnHandler;var CiActionsBtnHandler;var knowledgeSearchBtnHandler;var createKABtnHandler;var linkArticleIds="";var textArticleIds="";function screenLeft(a){return parseInt((screen.availWidth/2)-(a/2))}function screenTop(b){if(Ext.isChrome){var a=parseInt((screen.availHeight/2)-(b/2));return(a-25)}else{return parseInt((screen.availHeight/2)-(b/2))}}var left=screenLeft();var functionArray=new Array();function setIncidentData(a){functionArray[0]=a}function saveIncident(a){functionArray[1]=a}function assignSR(a){functionArray[2]=a}function assignRFLookupFilter(a){functionArray[3]=a}function getLookupFilterQuery(a){return functionArray[3](a)}function assignLKFilterCondition(a){functionArray[4]=a}function getFilterCondition(e,b,d,c,a){return functionArray[3](e,b,d,c,a)}function saveSR(){functionArray[2]()}function responded(){if(verifyChange()){handleSave()}isResponded=true;functionArray[1]()}function quickClose(){if(verifyChange()){handleSave()}fromQuickclose=true;functionArray[1]();saveFromQuickClose=true}function pasteResolution(a,b){Visualforce.remoting.Manager.invokeAction(_RemotingActions.pasteResolution,recordId,a,b,function(c,d){if(d.type==="exception"){alert(d.message)}else{refreshIncident()}},{escape:true})}function reopenIncident(){if(verifyChange()){handleSave()}Visualforce.remoting.Manager.invokeAction(_RemotingActions.reopenIncident,recordId,isNeedToReopenRltedBraodcast,function(a,b){if(b.type==="exception"){alert(b.message);stopWaitMsgBar()}else{stopWaitMsgBar();if(isFocusOnIncidentForm){loadIncidentDetail(recordId)}if(isFocusOnRelatedList){loadIncidentDetail(recordId);loadIncidentRelatedList(recordId)}if(isFocusOnSmartView){loadIncidentDetail(recordId);loadIncidentRelatedList(recordId);loadIncidentSmartView(recordId)}isNeedToRefreshRelatedList=true;isNeedToRefreshIncList=true;isNeedToRefreshSmartView=true;if(isServiceCloudConsole!="true"&&isRFConsoleDetailForm&&window.parent.MultiPageLayout&&window.parent.MultiPageLayout.isEnabledForIN){UndoBtnHandler()}}},{escape:true})}var openCloneRecordTabHandler=function(a){if(isSegregationEnabled&&_ServerVariables.ObjectName!=null&&_ServerVariables.ObjectName!=""&&typeof(_ServerVariables.ObjectName)!="undefined"&&_ServerVariables.ObjectName=="Incident__c"){if(_ServerVariables.inctype=="ServiceRequest"){window.parent.addTab(recordId,"","Incident__c",true,"","","ServiceRequest")}else{if(_ServerVariables.inctype=="Incident"){window.parent.addTab(recordId,"","Incident__c",true,"","","Incident",a)}else{window.parent.addTab(recordId,"","Incident__c",true,"","","",a)}}}else{window.parent.addTab(recordId,"","Incident__c",true,"","","",a)}};function LoadHandlerForActionItem(){cloneBtnHandler=function(h,i){var j=window.location.hash=!!window.MSInputMethodContext;if(Ext.isIE||j){hideMenu()}if(isServiceCloudConsole=="true"){sforce.console.openPrimaryTab(null,incidentConsole+"&record_id="+recordId+"&isCloneRequest=true&isServiceCloudConsole=true&ran="+new Date().getTime(),true,IncidentConsolePage.Labels.New);return false}else{if(isRFConsoleDetailForm=="true"){if(_ServerVariables.inctype!="ServiceRequest"&&incidentTypeafterSave!="ServiceRequest"&&previousFormLayoutId&&window.parent.MultiPageLayout&&window.parent.MultiPageLayout.isEnabledForIN){window.parent.hasFormLayoutAccessCloneMessage(openCloneRecordTabHandler,previousFormLayoutId,"in")}else{openCloneRecordTabHandler("")}}else{if(verifyChange()){var k=cloneBtnHandler;showCloseWarning(k,null)}else{isCloneRequest="true";startWaitMsgBar();loadIncidentDetail(recordId)}}}};var c;CloseBtnHandler=function(i,k){if(verifyChange()){Ext.Msg.defaultButton=1;Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:IncidentConsolePage.Labels.closeConfirmMsg,buttons:Ext.Msg.OK,buttonText:{ok:IncidentConsolePage.Labels.ServiceTargetsOK},icon:Ext.MessageBox.INFO})}else{screenHeight=450;screenWidth=871;var m=new Object;m.setIsNeedToRefreshRelatedList=setIsNeedToRefreshRelatedList;m.loadIncidentDetail=loadIncidentDetail;m.setIsNeedToRefreshIncList=setIsNeedToRefreshIncList;m.startWaitMsgBar=startWaitMsgBar;m.refreshIncident=refreshIncident;m.isRFConsoleDetailForm=isRFConsoleDetailForm;var h="dialogWidth:"+screenWidth+"px;dialogHeight:"+screenHeight+"px;status;resizable;scrollbars:no;center:yes;dialogLeft:"+screenLeft(screenWidth)+"px;;dialogTop:"+screenTop(screenHeight)+"px;";var l=window.location.hash=!!window.MSInputMethodContext;if(broadcast!=""){var j=confirm(IncidentConsolePage.Labels.ConsoleIncidentRelatedBroadcastsChanges);if(j==true){if(!c||c.closed){if(window.showModalDialog&&(Ext.isIE||l)){c=window.showModalDialog("/apex/CloseIncidentPage?incidentId="+recordId+"&IncidentCat="+categoryId+"&calledFrom=rfconsole&action=closeIncidentandBroadcast",m,h)}else{h="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=yes,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);c=window.open("/apex/CloseIncidentPage?incidentId="+recordId+"&IncidentCat="+categoryId+"&calledFrom=rfconsole&action=closeIncidentandBroadcast","_blank",h)}}}else{if(!c||c.closed){if(window.showModalDialog&&(Ext.isIE||l)){c=window.showModalDialog("/apex/CloseIncidentPage?incidentId="+recordId+"&IncidentCat="+categoryId+"&calledFrom=rfconsole&action=closeIncidentOnly",m,h)}else{h="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=yes,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);c=window.open("/apex/CloseIncidentPage?incidentId="+recordId+"&IncidentCat="+categoryId+"&calledFrom=rfconsole&action=closeIncidentOnly","_blank",h)}}}}else{if(!c||c.closed){if(window.showModalDialog&&(Ext.isIE||l)){c=window.showModalDialog("/apex/CloseIncidentPage?incidentId="+recordId+"&IncidentCat="+categoryId+"&calledFrom=rfconsole",m,h)}else{h="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=yes,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);c=window.open("/apex/CloseIncidentPage?incidentId="+recordId+"&IncidentCat="+categoryId+"&calledFrom=rfconsole","_blank",h)}}}if(c!=""&&typeof(c)!="undefined"&&c.focus){c.focus()}}};ReopenBtnHandler=function(h,j){startWaitMsgBar();if(broadcast!=""){var i=confirm(IncidentConsolePage.Labels.ConsoleIncidentRelatedBroadcastsChanges);if(i==true){isNeedToReopenRltedBraodcast=true}else{isNeedToReopenRltedBraodcast=false}}reopenIncident()};RespondedBtnHandler=function(h,i){startWaitMsgBar();responded()};QuickCloseBtnHandler=function(h,j){startWaitMsgBar();if(broadcast!=""){var i=confirm(IncidentConsolePage.Labels.ConsoleIncidentRelatedBroadcastsChanges);if(i==true){isNeedToCloseRltedBraodcast=true}else{isNeedToCloseRltedBraodcast=false}}quickClose()};var f;sendEmailBtnHandler=function(i,j){screenHeight=700;screenWidth=910;left=screenLeft(screenWidth);var h="dialogWidth:"+screenWidth+"px;dialogHeight:"+screenHeight+"px;status;resizable;scrollbars:no;center:yes;dialogLeft:"+screenLeft(screenWidth)+"px;;dialogTop:"+screenTop(screenHeight)+"px;";if(!f||f.closed){if(window.showModalDialog&&Ext.isIE){var k=new Object;k.isFocusOnRelatedList=isFocusOnRelatedList;k.loadIncidentRelatedList=loadIncidentRelatedList;k.startWaitMsgBar=startWaitMsgBar;k.setIsNeedToRefreshRelatedList=setIsNeedToRefreshRelatedList;if(_ServerVariables.inctype=="ServiceRequest"){f=window.showModalDialog("/apex/ComposeEmailPage?enableSelfClosing=false&recordId="+recordId+"&isNew=true&objectName=Incident__c&isServiceRequest=true&isConsolePage=true&popupHeader="+incidentName,k,h)}else{f=window.showModalDialog("/apex/ComposeEmailPage?enableSelfClosing=false&recordId="+recordId+"&isNew=true&objectName=Incident__c&isServiceRequest=false&isConsolePage=true&popupHeader="+incidentName,k,h)}}else{h="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=yes,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);if(_ServerVariables.inctype=="ServiceRequest"){f=window.open("/apex/ComposeEmailPage?enableSelfClosing=false&recordId="+recordId+"&isNew=true&objectName=Incident__c&isServiceRequest=true&isConsolePage=true&popupHeader="+incidentName,"_blank",h)}else{f=window.open("/apex/ComposeEmailPage?enableSelfClosing=false&recordId="+recordId+"&isNew=true&objectName=Incident__c&isServiceRequest=false&isConsolePage=true&popupHeader="+incidentName,"_blank",h)}}}if(f!=""&&typeof(f)!="undefined"&&f.focus){f.focus()}};var d;MatchingIncidentBtnHandler=function(i,j){var h="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=no,left="+screenLeft()+",top="+screenTop();if(!d||d.closed){d=window.open("/apex/SearchAndLink?filterObjectId="+recordId+"&parentName=Matching&childName=Incident__c&isIncidentConsole=true","_blank",h)}if(d.focus){d.focus()}};var b;addNoteHandler=function(h,i){if(!b||b.closed){b=window.open("/apex/stdlayoutincidentaddnotepage?id="+recordId+"&fromconsole=true","addNote","width=600,height=400,resizable = 0,scrollbars=no,status=1,top=350,left=350")}if(b.focus){b.focus()}};var e;newActionHandler=function(h,i){e=window.open("/apex/searchPage?popupId=Action&isLookup=true&objectType=IncidentHistory__c&isCalledFromConsole=true&enableSelfClosing=false&standardLayout=true&parentId="+recordId+"&filterClause=appliesToIncident__c%3Dtrue%20and%20system__c%3Dfalse","newAction","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=no");if(e.focus){e.focus()}};var g;viewActionHistoryBtnHandler=function(h,i){screenWidth=671;screenHeight=400;e=window.open("/apex/ViewAllActions?ObjectId="+recordId+"&objectName=Incident&recordState="+recordState+"&recordName="+incidentName,"actionHistory","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=yes");if(e.focus){e.focus()}};var a;FulfillRequestHandler=function(h,i){screenWidth=1000;screenHeight=600;if(!a||a.closed){a=window.open("/apex/SearchAndLink?filterObjectId="+recordId+"&txt=&type=FulfillReqLookup&childName=BMC_BaseElement__c&idValstr="+LKFId,"HandlerWindow","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = yes, scrollbars=no")}else{if(typeof(a)!="undefined"&&a.focus){a.focus()}}}}var openInVar="";var customActionJsonString="";var urlStringVar="";var custionActionObj="";function customActionHandler(a){openInVar=a.openIn;custionActionObj=a;getCustomActionURL(a.id)}function openUrl(){if(openInVar.indexOf("Remedyforce")!=-1){window.parent.parent.addNewTab(custionActionObj.id,customActionHeaderLabel,"NavigatorPage?title="+custionActionObj.encodedText+"&isCustomActionLink=true&target="+urlStringVar)}else{if(openInVar.toLowerCase().indexOf("window")!=-1){var a="resizable=1,scrollbars=1,fullscreen=1,toolbar=1,menubar=1,location=1,height="+screen.height+",width="+screen.width+",top = 0,left = 0";window.open(urlStringVar,"",a)}else{window.open(urlStringVar)}}}function getCustomActionURL(customId){var incId=recordId;eval(orgNamespace).JSRemoteActions.getCustomActionURL("Incident",incId,customId,function(result,event){if(event.status){if(result!=""&&result!=null){urlStringVar=result;openUrl()}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:false})}function getDetailViewActionMenu(){if(ActionMenuItem=="-"){ActionMenuItem=""}var a=false;if(recordId==null||recordId==""){a=true}return Ext.create("Ext.menu.Menu",{id:"mainMenu",baseCls:"bmc-menu",shadow:false,items:ActionMenuItem})}function loadMultiPageLayoutMenu(){return isServiceCloudConsole!="true"&&_ServerVariables.inctype!="ServiceRequest"&&incidentTypeafterSave!="ServiceRequest"&&isRFConsoleDetailForm&&window.parent.MultiPageLayout.isEnabledForIN&&window.parent.MultiPageLayout.details["in"].length>1}function getIncidentPageLayoutMenu(){if(loadMultiPageLayoutMenu()){return Ext.create("Ext.menu.Menu",{id:"pageLayoutMenuItems",baseCls:"bmc-menu",shadow:false,items:window.parent.getPageLayoutMenuItems(IncidentFromNewBtnHandler,"in"),maxHeight:"310",listeners:{mouseleave:{element:"el",fn:function(){Ext.getCmp("pageLayoutMenuItems").hide()}}}})}else{return""}}var IncidentFromNewBtnHandler=function(a,b){var c=window.location.hash=!!window.MSInputMethodContext;if(Ext.isIE||c){hideMenu()}if(isRFConsoleDetailForm=="true"){if(isSegregationEnabled&&_ServerVariables.ObjectName!=null&&_ServerVariables.ObjectName!=""&&typeof(_ServerVariables.ObjectName)!="undefined"&&_ServerVariables.ObjectName=="Incident__c"){if(_ServerVariables.inctype=="ServiceRequest"){window.parent.addTab(null,"","Incident__c","","","","ServiceRequest")}else{if(_ServerVariables.inctype=="Incident"){window.parent.addTab(null,"","Incident__c","","","","Incident",this.optionId)}else{window.parent.addTab(null,"","Incident__c","","","","",this.optionId)}}}else{window.parent.addTab(null,"","Incident__c","","","","",this.optionId)}}else{if(isServiceCloudConsole=="true"){sforce.console.openPrimaryTab(null,incidentConsole+"&record_id=&isServiceCloudConsole=true&ran="+new Date().getTime(),true,IncidentConsolePage.Labels.New);return false}else{if(verifyChange()){var d=IncidentFromNewBtnHandler;showCloseWarning(d,null)}else{startWaitMsgBar();loadIncidentDetail(null);disableAgentMenuItems(true);disableActionMenuItems(true)}}}};var IncidentRelatedListBtnhandler;var UndoBtnHandler=function(b,c){if(verifyChange()){var a=UndoBtnHandler;showCloseWarning(a)}else{startWaitMsgBar();formLayoutId=previousFormLayoutId;if(isFocusOnIncidentForm){loadIncidentDetail(recordId)}else{if(isFocusOnRelatedList){loadIncidentRelatedList(recordId)}else{if(isFocusOnSmartView){loadIncidentSmartView(recordId)}else{loadIncidentDetail(null)}}}}};function getDetailVeiwToolBar(){var a=function(f,h){var d=functionArray[0]();startWaitMsgBar();Ext.getCmp("IncidenFormBtnId").toggle(true);Ext.getCmp("actionButton").setDisabled(false);Ext.getCmp("agentToolsBtnId").setDisabled(false);if(isRecordLock&&isRecordLock.indexOf("true")>-1){Ext.getCmp("saveId").setDisabled(true)}else{Ext.getCmp("saveId").setDisabled(false)}if(!_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(true)}getIncidentData(d);changeAssigntomeButtonState(d);var g=document.getElementById("incidentRelatedListFrameId");hideDiv(g);var e=document.getElementById("incidentDetailsFrameId");if(e.src==""||isNeedToRefreshIncident==true){loadIncidentDetail(recordId)}else{showDiv(e);resizeincidentDetailsFrameForIEEDGE();if(isActivityFeedEnabled==true){showActivityFeed()}if(isCISidebarEnabled==true){showRelatedCI()}if(isIncidentFormFrameLoaded){stopWaitMsgBar()}if(!isServiceRequest&&frames[0]!=undefined&&frames[0].showSmartSuggestions==false){setTimeout(c,500)}}};function c(){frames[0].document.getElementById("formoutputpanel").style.height="100%"}IncidentRelatedListBtnhandler=function(f,g){var d=functionArray[0]();Ext.getCmp("IncidenReleatedListBtnId").toggle(true);Ext.getCmp("actionButton").setDisabled(false);Ext.getCmp("agentToolsBtnId").setDisabled(false);if(isRecordLock&&isRecordLock.indexOf("true")>-1){Ext.getCmp("saveId").setDisabled(true)}else{Ext.getCmp("saveId").setDisabled(false)}if(!_ServerVariables.ObjectMetadata.isUpdateable){Ext.getCmp("saveId").setDisabled(true)}getIncidentData(d);changeAssigntomeButtonState(d);startWaitMsgBar();var i=document.getElementById("incidentDetailsFrameId");hideDiv(i);hideActivityFeed();hideRelatedCI();var h=document.getElementById("incidentSmartViewFrameId");hideDiv(h);var e=document.getElementById("incidentRelatedListFrameId");if(e.src==""||isNeedToRefreshRelatedList==true){loadIncidentRelatedList(recordId)}else{showDiv(e);if(isIncRelatedListFrameLoaded){stopWaitMsgBar()}}};IncidentSmartViewBtnhandler=function(f,g){var d=functionArray[0]();Ext.getCmp("SmartViewBtnId").toggle(true);Ext.getCmp("actionButton").setDisabled(true);Ext.getCmp("agentToolsBtnId").setDisabled(true);getIncidentData(d);changeAssigntomeButtonState(d);Ext.getCmp("saveId").setDisabled(true);startWaitMsgBar();var h=document.getElementById("incidentDetailsFrameId");hideDiv(h);hideActivityFeed();hideRelatedCI();var e=document.getElementById("incidentRelatedListFrameId");hideDiv(e);if(hasActivityFeedPermission!=undefined){if(hasActivityFeedPermission==true){loadContentsInSmartViews()}else{showSmartViewsError(isLoggedInUserAdmin)}stopWaitMsgBar()}else{checkSmartViewAccess(false)}};var b=function(e,f){if(isRFConsoleDetailForm){isSAVE=true}if(_ServerVariables.inctype=="ServiceRequest"&&functionArray[2]!=null&&functionArray[2]!=undefined){functionArray[2]()}else{functionArray[1]()}if(isRFConsoleDetailForm){isSaveForSingleConsole=true}Ext.getCmp("IncidenFormBtnId").toggle(true);var d=document.getElementById("incidentDetailsFrameId");showDiv(d);var g=document.getElementById("incidentRelatedListFrameId");if(typeof(g)!="undefined"&&g!=null){hideDiv(g)}};return Ext.create("Ext.toolbar.Toolbar",{id:"detailViewToolbarId",items:[{xtype:"tbspacer",width:5},getToolbarNewBtn(),{xtype:"tbspacer",width:5},{id:"refreshId",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:IncidentConsolePage.Labels.Undo,tooltip:IncidentConsolePage.Labels.Undo_Consolebtn_Tooltip,handler:UndoBtnHandler},{xtype:"tbspacer",width:5},{id:"saveId",baseCls:"bmc-btn-primary",disabledCls:"bmc-btn-primary-disabled",focusCls:"bmc-btn-primary-focus",overCls:"bmc-btn-primary-over",pressedCls:"bmc-btn-primary-pressed",text:IncidentConsolePage.Labels.Save,tooltip:returnLabel(IncidentConsolePage.Labels.Save,"S"),disabled:!_ServerVariables.ObjectMetadata.isUpdateable,handler:b},{xtype:"tbspacer",width:5},"-",{id:"actionButton",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",text:IncidentConsolePage.Labels.Actions,tooltip:returnLabel(IncidentConsolePage.Labels.Actions,"A"),menu:getDetailViewActionMenu()},{id:"agentToolsBtnId",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"bmc-btn-dropdown-focus",overCls:"bmc-btn-dropdown-over",pressedCls:"bmc-btn-dropdown-pressed",text:IncidentConsolePage.Labels.AgentTools,tooltip:returnLabel(IncidentConsolePage.Labels.AgentTools,"T"),menu:getIncidentAgentToolsBtnMenu()},{id:"IncidenFormBtnGroupId",xtype:"buttongroup",columns:3,border:false,frame:false,items:[{id:"IncidenFormBtnId",cls:(!isRFConsoleDetailForm||parent.hideSmartViewbtn())?"bmc-togglebar-left-btn-smart-view-disable":"bmc-togglebar-left-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:((_ServerVariables.inctype=="ServiceRequest")?IncidentConsolePage.Labels.ServiceRequestForm:IncidentConsolePage.Labels.IncidentForm),tooltip:((_ServerVariables.inctype=="ServiceRequest")?IncidentConsolePage.Labels.ServiceRequestForm:IncidentConsolePage.Labels.IncidentForm),enableToggle:true,pressed:true,disabled:((recordId==null||recordId==""||recordId=="new")?true:false),toggleGroup:"incidentBtnGroup",handler:a,listeners:{toggle:{fn:function(d,e){if(e){isFocusOnIncidentForm=true}else{isFocusOnIncidentForm=false}}}}},{id:"IncidenReleatedListBtnId",cls:(!isRFConsoleDetailForm||parent.hideSmartViewbtn())?"bmc-togglebar-right-btn":"bmc-togglebar-center-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:IncidentConsolePage.Labels.RelatedLists,tooltip:IncidentConsolePage.Labels.RelatedLists,enableToggle:true,disabled:((recordId==null||recordId==""||recordId=="new")?true:false),toggleGroup:"incidentBtnGroup",handler:IncidentRelatedListBtnhandler,listeners:{toggle:{fn:function(d,e){if(e){isFocusOnRelatedList=true}else{isFocusOnRelatedList=false}}}}},{id:"SmartViewBtnId",cls:"bmc-togglebar-right-btn",baseCls:"bmc-togglebar-btn-base",disabledCls:"bmc-togglebar-btn-disabled",focusCls:"bmc-togglebar-btn-focus",overCls:"bmc-togglebar-btn-over",pressedCls:"pressed",text:IncidentConsolePage.Labels.SmartView,tooltip:IncidentConsolePage.Labels.SmartView,enableToggle:true,disabled:((recordId==null||recordId==""||recordId=="new"||isCloneRequest=="true")?true:false),toggleGroup:"incidentBtnGroup",handler:IncidentSmartViewBtnhandler,hidden:(!isRFConsoleDetailForm||parent.hideSmartViewbtn()),listeners:{toggle:{fn:function(d,e){if(e){isFocusOnSmartView=true}else{isFocusOnSmartView=false}}}}}]},{xtype:"tbfill"},{id:"LockRecord",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:IncidentConsolePage.Labels.LockRecord,tooltip:_ServerLabels.LockRecordToolTip,hidden:true,disabled:!_ServerVariables.ObjectMetadata.isUpdateable},{id:"UnlockRecord",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:IncidentConsolePage.Labels.UnlockRecord,tooltip:_ServerLabels.UnlockRecordToolTip,hidden:true,disabled:!_ServerVariables.ObjectMetadata.isUpdateable},{xtype:"tbspacer",width:5},{id:"LockRecordIcon",xtype:"label",hidden:true,cls:"d-icon-lock lock-color lock-icon",autoEl:{title:IncidentConsolePage.Labels.LockedRecord}},{id:"LockRecordLbl",xtype:"label",text:IncidentConsolePage.Labels.Locked,hidden:true,cls:"recordLockText"},{id:"UnlockRecordIcon",xtype:"label",hidden:true,cls:"d-icon-lock_open lock-icon",autoEl:{title:IncidentConsolePage.Labels.UnlockedRecord}},{xtype:"tbspacer",width:0},"-",{xtype:"tbspacer",width:0},{xtype:"label",html:'<a href="#" onclick="OpenHelppage(\'Detail\');" title="'+_ServerLabels.Help+'" class="d-icon-question_circle help-icon"></a>'},{xtype:"tbspacer",width:10}]})}function getDetailViewPanel(){var a=Ext.create("Ext.Panel",{id:"detailViewChildPanelId",border:false,hidden:(recordId==""),width:"100%",anchor:"0 0",layout:{type:"anchor"},tbar:getDetailVeiwToolBar(),items:[Ext.create("Ext.Panel",{border:false,anchor:"0 0",width:"100%",contentEl:"DetailFormDiv"})]});waitMsgBar=new Ext.LoadMask(a,{floating:{shadow:false},msgCls:"d-loader-container",msg:'<ul class="d-loading"><li class="d-loading__stick d-loading__stick_1"></li><li class="d-loading__stick d-loading__stick_2"></li><li class="d-loading__stick d-loading__stick_3"></li><li class="d-loading__stick d-loading__stick_4"></li><li class="d-loading__stick d-loading__stick_5"></li><li class="d-loading__stick d-loading__stick_6"></li><li class="d-loading__stick d-loading__stick_7"></li><li class="d-loading__stick d-loading__stick_8"></li><li class="d-loading__stick d-loading__stick_9"></li><li class="d-loading__stick d-loading__stick_10"></li><li class="d-loading__stick d-loading__stick_11"></li><li class="d-loading__stick d-loading__stick_12"></li></ul><div>'+_ServerLabels.PleaseWaitMsg+"</div>"});return a}function LoadHandlerForAgentItem(){var h;var c;var a;var g;IncidentManifestBtnHandler=function(i,j){screenWidth=1100;screenHeight=650;windowFeatures="status = 1,height = "+screenHeight+", width = "+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = no,scrollbars=no";g=window.open("/apex/ReleaseManifest?id="+recordId+"&stdForm=true&objectName=incident__c&formLayoutId="+formLayoutId+"&isRFConsoleDetailForm="+isRFConsoleDetailForm,"Manifest",windowFeatures);if(g.focus){g.focus()}};ServiceTargetsBtnHandler=function(i,j){screenHeight=400;screenWidth=1087;var k="FKIncident__c='"+recordId+"'";a=window.open("/apex/SearchPage?popupId=IncidentServiceTarget&isLookup=true&filterClause="+escape(k)+"&standardLayout=true&iscalledFromConsole=true&popupFor=ServiceTargets&popupHeader="+incidentName,"ServiceTarget","status = 1,height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=no");if(a.focus){a.focus()}};SuggestedTemplatesBtnHandler=function(i,j){screenHeight=600;screenWidth=1000;h=window.open("/apex/SuggestionPage?suggestObjectName=SYSTemplate__c&parentObjectId="+recordId+"&parentObjectName=Incident__c&iscalledFromConsole=true","SuggestedTemplate","status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=yes");if(h.focus){h.focus()}};var b;MatchingIncidentBtnHandler=function(j,k){screenHeight=600;screenWidth=1000;var i="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=no,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);if(recordId==null||recordId==""){if(_ServerVariables.inctype=="ServiceRequest"){b=window.open("/apex/SearchAndLink?filterObjectId="+recordId+"&parentName=Matching&childName=Incident__c&isServiceRequest=true&isCalledFromConsole=true&clientId="+escape(selectedUserId)+"&categoryId="+escape(selectedCategoryId),"IncidentMatching",i)}else{b=window.open("/apex/SearchAndLink?filterObjectId="+recordId+"&parentName=Matching&childName=Incident__c&isServiceRequest=false&isCalledFromConsole=true&clientId="+escape(selectedUserId)+"&categoryId="+escape(selectedCategoryId),"IncidentMatching",i)}}else{if(_ServerVariables.inctype=="ServiceRequest"){b=window.open("/apex/SearchAndLink?filterObjectId="+recordId+"&parentName=Matching&childName=Incident__c&isServiceRequest=true&isCalledFromConsole=true","IncidentMatching",i)}else{b=window.open("/apex/SearchAndLink?filterObjectId="+recordId+"&parentName=Matching&childName=Incident__c&isServiceRequest=false&isCalledFromConsole=true","IncidentMatching",i)}}if(b.focus){b.focus()}};var f;CIExplorerBtnHandler=function(j,k){screenWidth=1200;screenHeight=650;var i="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=no,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);f=window.open("/apex/CIExplorerLauncher?Module=Incident__c&RecordSequence="+recordId+"&id="+recordId+"&stdForm=true&isCalledFromConsole=true","ciExplorer",i);if(f.focus){f.focus()}};var e;SuggestwedOwnersBtnHandler=function(j,k){screenHeight=600;screenWidth=1000;var i="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=yes,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);e=window.open("/apex/SuggestionPage?suggestObjectName=Suggested_Owner_Mapping__c&parentObjectId="+recordId+"&parentObjectName=Incident__c&iscalledFromConsole=true","SuggestedOwner",i);if(e.focus){e.focus()}};var d;CiActionsBtnHandler=function(m,n){if(acVersion!=null&&acVersion!=""&&acVersion!="undefined"&&acVersion.toUpperCase()=="TRUE"){var j=1198,o=659;var k=parseInt((screen.availWidth/2)-(j/2));var l=parseInt((screen.availHeight/2)-(o/2));window.open("/apex/AcActions?incidentId="+recordId+"&showJapaneseHelp="+showJapaneseHelp,"","status = 1, height ="+o+",width ="+j+",left="+k+",top="+l+", resizable = 1, scrollbars=no")}else{screenHeight=356;screenWidth=410;var i="width="+screenWidth+",height="+screenHeight+",status,resizable,scrollbars=no,left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight);d=window.open("/apex/AcActionsStdLayout?reqContextId="+recordId+"&objectType=Incident__c&isCalledFromConsole=true","CI_Action_"+recordId,i);if(d.focus){d.focus()}}};knowledgeSearchBtnHandler=function(i,j){screenHeight=400;screenWidth=671;c=window.open("/apex/KnowledgeSearch?enableSelfClosing=false&calledFromForm=true&standardLayout=true&isCalledFromConsole=true&objectName=Incidents&search="+encodeURIComponent(desc)+"&KMincidentID="+recordId+"&isServiceCloudConsole="+isServiceCloudConsole+"&isRFConsoleDetailForm="+isRFConsoleDetailForm,"KnowledgeSearch","status = 1, height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1, scrollbars=no");if(c.focus){c.focus()}};createKABtnHandler=function(i,j){screenHeight=170;screenWidth=475;createKABtnHandlerWindow=window.open("/apex/CreateKnowledgePage?isCalledFromConsole=true&incidentid="+recordId,"CreateKnowledgeArticle","status = 1, height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1, scrollbars=no");if(createKABtnHandlerWindow.focus){createKABtnHandlerWindow.focus()}}}function getIncidentAgentToolsBtnMenu(){var a=false;if(recordId==null||recordId==""){a=true}return Ext.create("Ext.menu.Menu",{id:"AgentToolsMenu",baseCls:"bmc-menu",shadow:false,items:AgentMenuItem})}function LoadRecord(a){if(verifyChange()){var b=LoadRecordFunc;showCloseWarning(b,a)}else{LoadRecordFunc(a)}}function LoadRecordFunc(a){console.log("Loading record...");console.log(a);recordId=a;startWaitMsgBar();if(recordId==null||recordId==""){loadIncidentDetail(null)}else{isNeedToRefreshRelatedList=true;loadIncidentDetail(a)}}function showDiv(a){a.style.display="block";a.style.height="100%";a.style.width="100%";var c=/chrome/i.test(navigator.userAgent);if(c){var b=a.clientHeight+2;b=(b/a.clientHeight)*100;a.style.height=b+"%"}}function hideDiv(a){a.style.display="none";a.style.height="0px";a.style.width="0px"}function loadIncidentRelatedList(d){isFocusOnIncidentForm=false;isFocusOnRelatedList=true;isIncRelatedListFrameLoaded=false;var c=document.getElementById("incidentDetailsFrameId");hideDiv(c);hideActivityFeed();hideRelatedCI();var a=document.getElementById("incidentSmartViewFrameId");hideDiv(a);var b=document.getElementById("incidentRelatedListFrameId");b.src="/apex/consoleIncidentRelatedList?id="+d+"&isdtp=vw";addOnLoadEvent(b,afterIncRelatedListFrameLoad);showDiv(b)}function loadIncidentSmartView(d){isFocusOnIncidentForm=false;isFocusOnSmartView=true;isIncSmartViewFrameLoaded=false;LoadHandlerForActionItem=false;var c=document.getElementById("incidentDetailsFrameId");hideDiv(c);hideActivityFeed();hideRelatedCI();var b=document.getElementById("incidentRelatedListFrameId");hideDiv(b);var a=document.getElementById("incidentSmartViewFrameId");a.src="/apex/DeepView?id="+d+"&isEmbeddedMode=true";addOnLoadEvent(a,afterIncSmartViewFrameLoad);showDiv(a)}function refreshIncident(){handleSave();if(isFocusOnIncidentForm){loadIncidentDetail(recordId);isNeedToRefreshRelatedList=true}else{loadIncidentRelatedList(recordId);isNeedToRefreshIncident=true;refreshIncidentFormTimeOut()}}function loadIncidentDetail(d){var a=document.getElementById("incidentDetailsFrameId");if(d==null||d==""||isCloneRequest=="true"){isNewIncidentForm=true;isNewRecordLock=true;if(isCloneRequest=="true"){isCloneRequest="false";a.src="/apex/ConsoleIncidentDetail?oldIncidentId="+d+"&inctype="+_ServerVariables.inctype+"&isRFConsoleDetailForm="+isRFConsoleDetailForm+"&formLayoutId="+formLayoutId;clickedOnce=true;handleChange()}else{a.src="/apex/ConsoleIncidentDetail?clientId="+_ServerVariables.PageParams.clientid+"&inctype="+_ServerVariables.inctype+"&ObjID="+_ServerVariables.PageParams.ObjID+"&ObjName="+_ServerVariables.PageParams.ObjName+"&isRFConsoleDetailForm="+isRFConsoleDetailForm+"&formLayoutId="+formLayoutId+"&templateId="+templateId+"&isLayoutChanged="+isLayoutChanged}}else{isNewIncidentForm=false;a.src="/apex/ConsoleIncidentDetail?id="+d+"&inctype="+_ServerVariables.inctype+"&isRFConsoleDetailForm="+isRFConsoleDetailForm+"&formLayoutId="+formLayoutId+"&templateId="+templateId+"&isLayoutChanged="+isLayoutChanged}addOnLoadEvent(a,afterIncidentDetailFrameLoad);var c=document.getElementById("incidentRelatedListFrameId");hideDiv(c);if(isNewIncidentForm){if(isRFConsoleDetailForm!=="true"){addOptionalToolbarItems()}}else{addOptionalToolbarItems()}isIncidentFormFrameLoaded=false;isFocusOnIncidentForm=true;isFocusOnRelatedList=false;Ext.getCmp("detailViewToolbarId").doLayout();showDiv(a);var b=Ext.getCmp("detailViewChildPanelId");b.show();if(isActivityFeedEnabled==true&&isNewIncidentForm!=true&&isCloneRequest!="true"&&isFocusOnIncidentForm==true){displayActivityFeed=true}if(isCISidebarEnabled==true&&isNewIncidentForm!=true&&isCloneRequest!="true"&&isFocusOnIncidentForm==true){displayCISidebar=true}}function afterIncidentDetailFrameLoad(){if(isNewIncidentForm){afterNewFormLoad()}else{afterDetailFormLoad()}isNeedToRefreshIncident=false;isIncidentFormFrameLoaded=true;if(isDeleted){disableDetailFormButtons()}isDeleted=false;resizeincidentDetailsFrameForIEEDGE();if((isRFConsoleDetailForm!=="")&&(document.getElementById("detailViewChildPanelId")!==null)){document.getElementById("detailViewChildPanelId").style.position="fixed"}}function resizeincidentDetailsFrameForIEEDGE(){if(checkIsIEBrowser()||(/Edge\/\d./i.test(navigator.userAgent))){if(isRFConsoleDetailForm==="true"){var a=document.getElementById("incidentDetailsFrameId");a.style.position="fixed";a.style.height="92%"}else{document.getElementById("incidentDetailsFrameId").style.position="absolute"}}else{if((navigator.userAgent.toLowerCase().indexOf("firefox/")>-1)&&(isRFConsoleDetailForm==="true")){document.getElementById("incidentDetailsFrameId").style.position="absolute"}}}function afterIncRelatedListFrameLoad(){var a=document.getElementById("incidentRelatedListFrameId");if(a&&a.src!=""){stopWaitMsgBar()}isIncRelatedListFrameLoaded=true}function afterIncSmartViewFrameLoad(){var a=document.getElementById("incidentSmartViewFrameId");if(a&&a.src!=""){stopWaitMsgBar()}isIncSmartViewFrameLoaded=true}function afterNewFormLoad(){removeIncidentData();AttRefGeneratorId="";if(chatAttachmentID!="undefined"&&chatAttachmentID!=null&&chatAttachmentID!="null"&&chatAttachmentID!=""){setAttRefGeneratorId(chatAttachmentID)}Ext.getCmp("saveId").setDisabled(false);Ext.getCmp("refreshId").setDisabled(false);if(Ext.getCmp("viewActionHistoryId")!=undefined&&Ext.getCmp("viewActionHistoryId")!=null){Ext.getCmp("viewActionHistoryId").setDisabled(true)}disableActionMenuItems(true);disableAgentMenuItems(true);if(isServiceCloudConsole=="true"){sforce.console.setTabTitle(LabelNew)}if((typeof(isServiceRequest)!="undefined"&&isServiceRequest!=null&&isServiceRequest!="")||!iscalledAfterSave){}else{}if(isRFConsoleDetailForm!=="true"){if((typeof(isServiceRequest)!=="undefined"&&isServiceRequest!==null&&isServiceRequest!=="")||!iscalledAfterSave){if(isServiceRequest||_ServerVariables.inctype==="ServiceRequest"){Ext.getCmp("IncNameId").update(IncidentConsolePage.Labels.newServiceRequest)}else{Ext.getCmp("IncNameId").el.dom.style.display="block";Ext.getCmp("IncNameId").update(LabelNew)}}else{Ext.getCmp("IncNameId").update(LabelNew)}showHideToolbarItems(false);Ext.getCmp("IncStatusId").update(status);ChangeServiceTargetButtonState(ServiceTargetStatus);changeServiceTargetIcons(Ext.getCmp("servicetargets").getEl(),ServiceTargetStatus)}Ext.getCmp("IncidenFormBtnId").toggle(false);Ext.getCmp("IncidenReleatedListBtnId").toggle(false);Ext.getCmp("IncidenFormBtnId").setDisabled(true);Ext.getCmp("IncidenReleatedListBtnId").setDisabled(true);isNewIncidentForm=false;stopWaitMsgBar()}function afterDetailFormLoad(){if(functionArray[0]!="undefined"&&functionArray[0]!=null&&functionArray[0]!="null"&&functionArray[0]!=""){stopWaitMsgBar();var b=functionArray[0]();var t=recordId;if(isRFConsoleDetailForm&&isSaveForSingleConsole){if((!iscalledAfterSave&&_ServerVariables.inctype=="ServiceRequest")||(typeof(incidentTypeafterSave)!="undefined"&&incidentTypeafterSave!=""&&incidentTypeafterSave!=null&&incidentTypeafterSave=="ServiceRequest")){window.parent.changeTabTitle(tabId,window.parent.SingleConsolePage.Labels.ServiceRequestPrefix+b.Name)}else{window.parent.changeTabTitle(tabId,window.parent.SingleConsolePage.Labels.IncidentRecordPrefix+b.Name)}isSaveForSingleConsole=false;window.parent.updateDirtyFlag(tabId,false);if(t==null||t==""){window.parent.changeTabItemId(b.Id,tabId)}}if(t==null||t==""){enableCustomActions()}getIncidentData(b);changeAssigntomeButtonState(b);Ext.getCmp("refreshId").setDisabled(false);if(Ext.getCmp("viewActionHistoryId")!=undefined&&Ext.getCmp("viewActionHistoryId")!=null){Ext.getCmp("viewActionHistoryId").setDisabled(false)}if(isServiceCloudConsole=="true"){var A="";if(IncidentConsolePage.Labels.New!=b.Name){if(_ServerVariables.inctype=="ServiceRequest"){A=IncidentConsolePage.Labels.ServiceRequestPrefix}else{A=IncidentConsolePage.Labels.IncidentRecordPrefix}}sforce.console.setTabTitle(A+b.Name);SconsoletabName=b.Name;sforce.console.getFocusedPrimaryTabId(addSConsoleTabComplete)}if(isRFConsoleDetailForm!=="true"){showHideToolbarItems(true);if((!iscalledAfterSave&&_ServerVariables.inctype==="ServiceRequest")||(typeof(incidentTypeafterSave)!=="undefined"&&incidentTypeafterSave!==""&&incidentTypeafterSave!==null&&incidentTypeafterSave==="ServiceRequest")){Ext.getCmp("IncNameId").update(IncidentConsolePage.Labels.ServiceRequestPrefix+b.Name)}else{Ext.getCmp("IncNameId").update(IncidentConsolePage.Labels.IncidentRecordPrefix+b.Name)}}var n=Ext.getCmp("IncStatusId");if(n){n.update(b.Stage__c)}if(isFocusOnSmartView){disableActionMenuBtn(true)}else{disableActionMenuBtn(false)}if(isFocusOnIncidentForm){Ext.getCmp("IncidenFormBtnId").toggle(true)}Ext.getCmp("IncidenFormBtnId").setDisabled(false);Ext.getCmp("IncidenReleatedListBtnId").setDisabled(false);if(isFocusOnSmartView){disableAgentMenuBtn(true)}else{disableAgentMenuBtn(false)}var s=Ext.getCmp("respondedButtonId");var i=Ext.getCmp("closeButtonId");var c=Ext.getCmp("quickCloseButtonId");var e=Ext.getCmp("reopenButtonId");var l=Ext.getCmp("addNoteId");var u=Ext.getCmp("emailId");var w=Ext.getCmp("newActionId");var j=Ext.getCmp("knowledgeSearchButtonId");var k=Ext.getCmp("suggestedTemplatesButtonId");var a=Ext.getCmp("SuggestwedOwnersButtonId");var d=Ext.getCmp("ServiceTargetsButtonId");var m=Ext.getCmp("IncidentMatchingButtonId");var o=Ext.getCmp("CiActionsButtonId");var v=document.getElementById("CiActionsButtonId_slider");var h=Ext.getCmp("cloneButtonId");var r=Ext.getCmp("printId");var z=Ext.getCmp("printPDFId");var p=Ext.getCmp("attachFileId");var x=Ext.getCmp("createKnowledgeArticleButtonId");var q=Ext.getCmp("CiExplorerButtonId");var g=Ext.getCmp("IncidentManifestButtonId");var y=Ext.getCmp("Submitforapproval");var f=Ext.getCmp("FulfillRequestId");if(recordState=="true"){if(_ServerVariables.ObjectMetadata.isUpdateable){if(s!=undefined&&s!=null){s.setDisabled(false)}if(isFocusOnSmartView){Ext.getCmp("saveId").setDisabled(true)}else{Ext.getCmp("saveId").setDisabled(false)}if(i!=undefined&&i!=null){i.setDisabled(false)}if(c!=undefined&&c!=null){c.setDisabled(false)}if(u!=undefined&&u!=null){u.setDisabled(false)}if(w!=undefined&&w!=null){w.setDisabled(false)}if(typeof(f)!="undefined"&&f!=null){if(isApproved==true&&LKFId!=null&&LKFId!=""){f.setDisabled(false)}else{f.setDisabled(true)}}checkApprovalstatus();if(typeof(recordLock)!="undefined"&&recordLock!=null&&recordLock!="Off"){if(!isSAVE||(isSAVE&&initialRecordState=="true")){if(typeof(isRecordLock)!="undefined"&&isRecordLock!=null&&isRecordLock.indexOf("false")>-1){if(recordLock=="Explicit"){if(isRecordLock.indexOf("##")>-1){recordLockedIcons("")}else{recordUnlockedIcons()}}else{if(recordLock=="Implicit"){getRecordLockedValue("recordLock")}}}else{enableRecordReadModeMsg(isRecordLock)}}isSAVE=false}}else{if(s!=undefined&&s!=null){s.setDisabled(true)}if(i!=undefined&&i!=null){i.setDisabled(true)}if(c!=undefined&&c!=null){c.setDisabled(true)}if(u!=undefined&&u!=null){u.setDisabled(true)}Ext.getCmp("saveId").setDisabled(true);if(w!=undefined&&w!=null){w.setDisabled(true)}if(typeof(f)!="undefined"&&f!=null){f.setDisabled(true)}}if(e!=undefined&&e!=null){e.setDisabled(true)}if(_ServerVariables.ObjectMetadata.isUpdateable||_ServerVariables.ObjectMetadata.isCreateable){if(l!=undefined&&l!=null){l.setDisabled(false)}if(p!=undefined&&p!=null){p.setDisabled(false)}if(a!=undefined&&a!=null){a.setDisabled(false)}}else{if(l!=undefined&&l!=null){l.setDisabled(true)}if(p!=undefined&&p!=null){p.setDisabled(true)}if(a!=undefined&&a!=null){a.setDisabled(true)}}if(j!=undefined&&j!=null){j.setDisabled(false)}if(g!=undefined&&g!=null){g.setDisabled(false)}if(m!=undefined&&m!=null){m.setDisabled(false)}if(_ServerVariables.Enablesuggestedtemplate&&_ServerVariables.ObjectMetadata.isUpdateable){if(k!=undefined&&k!=null){k.setDisabled(false)}}else{if(k!=undefined&&k!=null){k.setDisabled(true)}}if((_ServerVariables.assetCoreActive||_ServerVariables.discoveryActive)&&_ServerVariables.ObjectMetadata.isUpdateable){if(o!=undefined&&o!=null){o.setDisabled(false)}if(v){v.disabled=false}}else{if(o!=undefined&&o!=null){o.setDisabled(true)}if(v){v.disabled=true}}}else{disableAllrecordLockIcons();if(s!=undefined&&s!=null){s.setDisabled(true)}if(i!=undefined&&i!=null){i.setDisabled(true)}if(c!=undefined&&c!=null){c.setDisabled(true)}if(l!=undefined&&l!=null){l.setDisabled(true)}if(u!=undefined&&u!=null){u.setDisabled(true)}if(w!=undefined&&w!=null){w.setDisabled(true)}if(y!=undefined&&y!=null){y.setDisabled(true)}if(typeof(f)!="undefined"&&f!=null){f.setDisabled(true)}if(_ServerVariables.ObjectMetadata.isUpdateable){if(e!=undefined&&e!=null){e.setDisabled(false)}}else{if(e!=undefined&&e!=null){e.setDisabled(true)}}if(j!=undefined&&j!=null){j.setDisabled(true)}if(k!=undefined&&k!=null){k.setDisabled(true)}if(a!=undefined&&a!=null){a.setDisabled(true)}if(o!=undefined&&o!=null){o.setDisabled(true)}if(v!=undefined&&v!=null){v.disabled=true}if(m!=undefined&&m!=null){m.setDisabled(false)}}if(r!=undefined&&r!=null){r.setDisabled(false)}if(z!=undefined&&z!=null){z.setDisabled(false)}if(x!=undefined&&x!=null){x.setDisabled(false)}if(q!=undefined&&q!=null){q.setDisabled(false)}if(ChangeServiceTargetButtonState!=undefined&&ChangeServiceTargetButtonState!=null){ChangeServiceTargetButtonState(ServiceTargetStatus)}refreshIncidentListTimeOut();refreshIncRelatedListTimeOut();if(_ServerVariables.ObjectMetadata.isCreateable){if(h!=undefined&&h!=null){h.setDisabled(false)}}else{if(h!=undefined&&h!=null){h.setDisabled(true)}}}stopWaitMsgBar()}function refreshIncidentListTimeOut(){if(isNeedToRefreshIncList&&isServiceCloudConsole!="true"){isNeedToRefreshIncList=false;var a=false;if(isRFConsoleDetailForm=="true"&&typeof(window.parent)!="undefined"&&typeof(window.parent)!=undefined){setTimeout(function(){if(_ServerVariables.inctype=="ServiceRequest"){a=true}window.parent.refreshListView("Incident__c",a)},2000)}else{setTimeout(function(){doRefresh()},2000)}}}function refreshIncRelatedListTimeOut(){if(isNeedToRefreshRelatedList){var a=isFocusOnFormTab();setTimeout(function(){isNeedToRefreshRelatedList=false;isIncRelatedListFrameLoaded=false;var b=document.getElementById("incidentRelatedListFrameId");b.src="/apex/consoleIncidentRelatedList?id="+recordId+"&isdtp=vw";addOnLoadEvent(b,afterIncRelatedListFrameLoad);if(isActivityFeedEnabled==true&&recordId){loadContentsInActivityFeed(a)}if(isCISidebarEnabled==true&&recordId){loadContentsInRelatedCIs(a)}getRecordLockedValue("UpdateLastModified")},2000)}}function getIncidentData(a){recordId=a.Id;incidentName=a.Name;recordState=a.state__c;broadcast=a.FKBroadcast__c;categoryId=a.FKCategory__c;status=a.Stage__c;clientId=a.FKClient__c;accountId=a.FKAccount__c;desc=a.incidentDescription__c;if(desc!=null&&desc!=""&&desc.length>500){desc=desc.substring(0,500)}ServiceTargetStatus=a.ServiceTargetStatus;isRecordLock=a.isRecordLock;LKFId=a.lookupFilterId;isApproved=a.Approved__c}function removeIncidentData(){recordId=null;incidentName=IncidentConsolePage.Labels.New;recordState="";broadcast="";categoryId="";status="";clientId="";accountId="";ServiceTargetStatus=""}function ChangeServiceTargetButtonState(a){var c=Ext.getCmp("servicetargets");var b=Ext.getCmp("ServiceTargetsButtonId");if(typeof(b!="undefined")&&b!=null){if(a==""){if(b!=undefined&&b!=null){b.setDisabled(true)}}else{if(b!=undefined&&b!=null){b.setDisabled(false)}}}if(typeof(c!="undefined")&&c!=null){if(a==""){c.disable()}else{c.enable()}}}function changeAssigntomeButtonState(c,e){var f=Ext.getCmp("AssigntomeButtonId");if((typeof f!="undefined")&&f!=null){if(typeof c=="undefined"||c==null){c=[]}if(typeof e=="undefined"){e=false}var b="";var a="";var d=window.frames.incidentDetailsFrame;f.setTooltip(IncidentConsolePage.Labels.Assigntome);if(isRFConsoleDetailForm!=="true"||isRFConsoleDetailForm===""||isServiceCloudConsole=="true"){f.hide();Ext.getCmp("tbspacec1").previousNode().hide()}else{f.show();Ext.getCmp("tbspacec1").previousNode().show()}if(isRecordLock&&isRecordLock.indexOf("true")>-1||c.state__c=="false"||!_ServerVariables.ObjectMetadata.isUpdateable||isFocusOnSmartView==true){f.removeCls("d-icon-user_check");f.setIconCls("d-icon-user_arrow_circle assign-to-me assign-to-me-closed-color");f.setDisabled(true)}else{if(e||(d.enableQueueAndUserAssignment&&currentUser==c.FKOpenBy__c)||(!d.enableQueueAndUserAssignment&&currentUser==c.ownerId)){f.removeCls("d-icon-user_arrow_circle");f.setIconCls("d-icon-user_check_circle assign-to-me assign-to-me-logged-in-color");f.setTooltip(IncidentConsolePage.Labels.LblAssignedToMe);f.setDisabled(true)}else{f.removeCls("d-icon-user_check");f.setIconCls("d-icon-user_arrow_circle assign-to-me assign-to-me-color");f.setDisabled(false)}}}}function changeServiceTargetIcons(b,a){b.replaceCls("serviceTargetsEmpty","serviceTargetsDisable");b.replaceCls("serviceTargetsEnable","serviceTargetsDisable");b.replaceCls("serviceTargetsWarning","serviceTargetsDisable");b.replaceCls("serviceTargetsMissed","serviceTargetsDisable");if(a==IncidentConsolePage.Labels.ServiceTargetsOK){b.replaceCls("serviceTargetsDisable","serviceTargetsEnable")}else{if(a==IncidentConsolePage.Labels.ServiceTargetsMissed){b.replaceCls("serviceTargetsDisable","serviceTargetsMissed")}else{if(a==IncidentConsolePage.Labels.ServiceTargetsWarning){b.replaceCls("serviceTargetsDisable","serviceTargetsWarning")}}}if(isNewIncidentForm){b.replaceCls("serviceTargetsDisable","serviceTargetsEmpty")}else{b.dom.title=IncidentConsolePage.Labels.ServiceTargets}}function handleServiceTargets(){screenHeight=400;screenWidth=1087;var a="FKIncident__c='"+recordId+"'";if(!ServiceTargetsBtnHandlerWindow||ServiceTargetsBtnHandlerWindow.closed){ServiceTargetsBtnHandlerWindow=window.open("/apex/SearchPage?popupId=IncidentServiceTarget&isLookup=true&filterClause="+escape(a)+"&standardLayout=true&iscalledFromConsole=true&popupFor=ServiceTargets&popupHeader="+incidentName,null,"status = 1,height ="+screenHeight+", width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 1,scrollbars=no")}if(ServiceTargetsBtnHandlerWindow.focus){ServiceTargetsBtnHandlerWindow.focus()}}function startWaitMsgBar(){if(waitMsgBar!=""){waitMsgBar.setVisible(true)}}function setIsNeedToRefreshRelatedList(a){isNeedToRefreshRelatedList=a}function setIsNeedToRefreshIncList(a){isNeedToRefreshIncList=a}function stopWaitMsgBar(){if(waitMsgBar!=""&&waitMsgBar.isVisible()){waitMsgBar.setVisible(false)}}function disableDetailFormButtons(){Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("refreshId").setDisabled(true);disableActionMenuBtn(true);Ext.getCmp("IncidenFormBtnId").setDisabled(true);Ext.getCmp("IncidenReleatedListBtnId").setDisabled(true);Ext.getCmp("SmartViewBtnId").setDisabled(true);disableAgentMenuBtn(true)}function IncidentPageinReadMode(){Ext.getCmp("saveId").setDisabled(true);if(Ext.getCmp("closeButtonId")!=undefined&&Ext.getCmp("closeButtonId")!=null){Ext.getCmp("closeButtonId").setDisabled(true)}if(Ext.getCmp("quickCloseButtonId")!=undefined&&Ext.getCmp("quickCloseButtonId")!=null){Ext.getCmp("quickCloseButtonId").setDisabled(true)}if(Ext.getCmp("reopenButtonId")!=undefined&&Ext.getCmp("reopenButtonId")!=null){Ext.getCmp("reopenButtonId").setDisabled(true)}if(Ext.getCmp("respondedButtonId")!=undefined&&Ext.getCmp("respondedButtonId")!=null){Ext.getCmp("respondedButtonId").setDisabled(true)}if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(true)}}function RTFEnabledPage(){if(isSegregationEnabled&&_ServerVariables.inctype=="ServiceRequest"){if(isRTFEnabledSRPage=="true"){return true}else{return false}}else{if(isRTFEnabledIncidentPage=="true"){return true}else{if(isServiceCloudConsole!="true"&&isRFConsoleDetailForm&&window.parent.MultiPageLayout&&window.parent.MultiPageLayout.isEnabledForIN){var a=getLayoutKey();if(isRTFEnabledIncidentPage.indexOf(a+",")>-1){return true}else{return false}}else{return false}}}}function getLayoutKey(){var a="";if(formLayoutId&&formLayoutId.indexOf(NONPRINT)>-1){var b=formLayoutId.split(NONPRINT);if(b.length>1){a=b[0];return a}}if(window.parent.MultiPageLayout&&window.parent.MultiPageLayout.defaultLayoutIN){a=window.parent.MultiPageLayout.defaultLayoutIN}return a}function afterSaveSucceed(){if(!isDeleted){previousFormLayoutId=formLayoutId;isNeedToRefreshIncList=true;isNeedToRefreshRelatedList=true;addOptionalToolbarItems();afterIncidentDetailFrameLoad()}else{isNeedToRefreshIncList=true;refreshIncidentListTimeOut()}if(isActivityFeedEnabled==true){displayActivityFeed=true}if(isCISidebarEnabled==true){displayCISidebar=true}Ext.getCmp("SmartViewBtnId").setDisabled(false);clickedOnce=false;layoutTypeClickedOnce=false;isLayoutChanged=false;if(isServiceCloudConsole=="true"){sforce.console.setTabUnsavedChanges(false)}var a=Ext.getCmp("detailViewToolbarId").items;for(var b=0;b<9;b++){a.items[b].el.show()}reloadToolbarNewButton();Ext.getCmp("detailViewToolbarId").doLayout()}function reloadToolbarNewButton(){var a=0;var b=Ext.getCmp("detailViewToolbarId");for(;a<b.items.length;a++){if("newId"===b.items.items[a].id){break}}b.remove("newId",true);b.insert(a,getToolbarNewBtn())}function getToolbarNewBtn(){var a=function(b,c){if(!loadMultiPageLayoutMenu()){IncidentFromNewBtnHandler(b,c)}};return{id:"newId",baseCls:"bmc-btn-small",disabledCls:"bmc-btn-disabled",focusCls:"bmc-btn-focus",overCls:"bmc-btn-over",pressedCls:"bmc-btn-pressed",text:IncidentConsolePage.Labels.New,menu:getIncidentPageLayoutMenu(),arrowCls:"d-icon-angle_down",tooltip:returnLabel(IncidentConsolePage.Labels.New,"N"),disabled:!_ServerVariables.ObjectMetadata.isCreateable,handler:a}}function hideMenu(){var b=Ext.getCmp("mainMenu");if(b!="undefined"&&b!=null&&b!=""){Ext.getCmp("mainMenu").hide()}var a=Ext.getCmp("AgentToolsMenu");if(a!="undefined"&&a!=null&&a!=""){Ext.getCmp("AgentToolsMenu").hide()}var c=Ext.getCmp("pageLayoutMenuItems");if(typeof(c)!="undefined"&&c){Ext.getCmp("pageLayoutMenuItems").hide()}}function disableAgentMenuBtn(a){if(disableAgentBtn){Ext.getCmp("agentToolsBtnId").setDisabled(true)}else{Ext.getCmp("agentToolsBtnId").setDisabled(a)}}function disableActionMenuBtn(a){if(disableActionBtn){Ext.getCmp("actionButton").setDisabled(true)}else{Ext.getCmp("actionButton").setDisabled(a)}}function disableAgentMenuItems(a){if(Ext.getCmp("knowledgeSearchButtonId")!=undefined&&Ext.getCmp("knowledgeSearchButtonId")!=null){Ext.getCmp("knowledgeSearchButtonId").setDisabled(a)}if(Ext.getCmp("createKnowledgeArticleButtonId")!=undefined&&Ext.getCmp("createKnowledgeArticleButtonId")!=null){Ext.getCmp("createKnowledgeArticleButtonId").setDisabled(a)}if(Ext.getCmp("CiExplorerButtonId")!=undefined&&Ext.getCmp("CiExplorerButtonId")!=null){Ext.getCmp("CiExplorerButtonId").setDisabled(a)}if(Ext.getCmp("CiActionsButtonId")!=undefined&&Ext.getCmp("CiActionsButtonId")!=null){Ext.getCmp("CiActionsButtonId").setDisabled(a)}var b=document.getElementById("CiActionsButtonId_slider");if(b){b.disabled=a}if(Ext.getCmp("IncidentMatchingButtonId")!=undefined&&Ext.getCmp("IncidentMatchingButtonId")!=null){Ext.getCmp("IncidentMatchingButtonId").setDisabled(a)}if(Ext.getCmp("suggestedTemplatesButtonId")!=undefined&&Ext.getCmp("suggestedTemplatesButtonId")!=null){Ext.getCmp("suggestedTemplatesButtonId").setDisabled(a)}if(Ext.getCmp("SuggestwedOwnersButtonId")!=undefined&&Ext.getCmp("SuggestwedOwnersButtonId")!=null){Ext.getCmp("SuggestwedOwnersButtonId").setDisabled(a)}if(Ext.getCmp("ServiceTargetsButtonId")!=undefined&&Ext.getCmp("ServiceTargetsButtonId")!=null){Ext.getCmp("ServiceTargetsButtonId").setDisabled(a)}if(Ext.getCmp("IncidentManifestButtonId")!=undefined&&Ext.getCmp("IncidentManifestButtonId")!=null){Ext.getCmp("IncidentManifestButtonId").setDisabled(a)}}function disableActionMenuItems(a){if(Ext.getCmp("cloneButtonId")!=undefined&&Ext.getCmp("cloneButtonId")!=null){Ext.getCmp("cloneButtonId").setDisabled(a)}if(Ext.getCmp("closeButtonId")!=undefined&&Ext.getCmp("closeButtonId")!=null){Ext.getCmp("closeButtonId").setDisabled(a)}if(Ext.getCmp("quickCloseButtonId")!=undefined&&Ext.getCmp("quickCloseButtonId")!=null){Ext.getCmp("quickCloseButtonId").setDisabled(a)}if(Ext.getCmp("reopenButtonId")!=undefined&&Ext.getCmp("reopenButtonId")!=null){Ext.getCmp("reopenButtonId").setDisabled(a)}if(Ext.getCmp("respondedButtonId")!=undefined&&Ext.getCmp("respondedButtonId")!=null){Ext.getCmp("respondedButtonId").setDisabled(a)}if(Ext.getCmp("addNoteId")!=undefined&&Ext.getCmp("addNoteId")!=null){Ext.getCmp("addNoteId").setDisabled(a)}if(Ext.getCmp("emailId")!=undefined&&Ext.getCmp("emailId")!=null){Ext.getCmp("emailId").setDisabled(a)}if(Ext.getCmp("printId")!=undefined&&Ext.getCmp("printId")!=null){Ext.getCmp("printId").setDisabled(a)}if(Ext.getCmp("printPDFId")!=undefined&&Ext.getCmp("printPDFId")!=null){Ext.getCmp("printPDFId").setDisabled(a)}if(Ext.getCmp("newActionId")!=undefined&&Ext.getCmp("newActionId")!=null){Ext.getCmp("newActionId").setDisabled(a)}if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(a)}if(Ext.getCmp("FulfillRequestId")!=undefined&&Ext.getCmp("FulfillRequestId")!=null){Ext.getCmp("FulfillRequestId").setDisabled(a)}}function enableCustomActions(){var b=Ext.getCmp("mainMenu").items;if(b!="undefined"&&b!=null&&b!=""){for(var d=0;d<b.length;d++){var a=b.items[d];if(a.id!="undefined"&&a.openIn!="undefined"&&typeof(a.openIn)!="undefined"){Ext.getCmp(a.id).setDisabled(false)}}}var c=Ext.getCmp("AgentToolsMenu").items;if(c!="undefined"&&c!=null&&c!=""){for(var d=0;d<c.length;d++){var a=c.items[d];if(a.id!="undefined"&&a.openIn!="undefined"&&typeof(a.openIn)!="undefined"){Ext.getCmp(a.id).setDisabled(false)}}}}function refreshRelatedLists(){isNeedToRefreshRelatedList=true;refreshIncRelatedListTimeOut()}function setTabUnsavedChanges(){if(isServiceCloudConsole=="true"){sforce.console.setTabUnsavedChanges(true)}}function addSConsoleTab(c,b){try{SconsoletabName=b;sforce.console.openPrimaryTab(null,c,true," ",addSConsoleTabComplete)}catch(a){}}function addSConsoleTabComplete(a){try{var c=new Date();c.setYear(c.getFullYear()+10);if(a.success==true){document.cookie="SconsoletabName="+a.id+";path=/;SameSite=None;Secure;expires="+c.toUTCString()}else{if(Ext.util.Cookies.get(SconsoletabName)!=null){sforce.console.focusPrimaryTabById(Ext.util.Cookies.get(SconsoletabName))}}}catch(b){}}document.onkeydown=function(g){var c,a,d;d=0;if(isRFConsoleDetailForm=="true"){c=window.parent;d=window.parent.count}a=window.self;var f=document.getElementById("incidentDetailsFrameId");var b="";if(f.src==""){b="ListViewNewButton"}else{if((typeof(f)!="undefined"&&f!=null)&&f.src!=""){b="newId"}}if(!isRFHotkeysDisabled){handleShortcuts(g,c,a,d,isRFConsoleDetailForm,b)}};function refreshIncidentFormTimeOut(){if(isNeedToRefreshIncident){var a=isFocusOnFormTab();setTimeout(function(){isNeedToRefreshIncident=false;var b=document.getElementById("incidentDetailsFrameId");b.src="/apex/ConsoleIncidentDetail?id="+recordId+"&inctype="+_ServerVariables.inctype+"&isRFConsoleDetailForm="+isRFConsoleDetailForm+"&formLayoutId="+formLayoutId+"&templateId="+templateId+"&isLayoutChanged="+isLayoutChanged;if(isActivityFeedEnabled==true){loadContentsInActivityFeed(a)}if(isCISidebarEnabled==true&&recordId){loadContentsInRelatedCIs(a)}},2000)}}function saveIncAfterSR(){functionArray[1]();if(isRFConsoleDetailForm){isSaveForSingleConsole=true}Ext.getCmp("IncidenFormBtnId").toggle(true);var b=document.getElementById("incidentDetailsFrameId");showDiv(b);if(isActivityFeedEnabled==true&&recordId!=null){var a=isFocusOnFormTab();loadContentsInActivityFeed(a);showActivityFeed()}if(isCISidebarEnabled==true&&recordId!=null){loadContentsInRelatedCIs(a);showRelatedCI()}}function loadContentsInActivityFeed(a){if(isCalledFromActivityFeed!=true){activityFeedRefreshStarted();var b=document.getElementById("incidentSmartViewSidebarFrameId");if(typeof b!="undefined"&&b!=null){b.src="/apex/DeepView?id="+recordId+"&showSidebarOnly=true&moduleName=Incident__c"}}isCalledFromActivityFeed=false;if(a){enableActivityFeed()}}function loadContentsInRelatedCIs(a){if(isBaseElementAccessible==true&&isServicesAndCISliderEnabled==true){RelatedCIRefreshStarted();var b=document.getElementById("relatedCISmartViewSidebarFrameId");if(typeof b!="undefined"&&b!=null){b.src="/apex/CIAssetSlideIn?id="+recordId+"&objName=Incident__c"}if(a){enableRelatedCI()}}}function AssignRecordsToUser(c){if(isRFConsoleDetailForm=="true"){startWaitMsgBar();var b=[];console.log(b);if(typeof(c)!="undefined"&&c!="undefined"&&c!=null){b.push(c)}var e="";var a=new Object();a.isFromListView="false";var d=window.frames.incidentDetailsFrame;d.clearMsgs();Visualforce.remoting.Manager.invokeAction(_RemotingActions.AssignRecordsToUser,e,b,a,function(f,g){console.log(f);stopWaitMsgBar();if(g.status){if(typeof(f.ExceptionMessage)!="undefined"||f.ExceptionMessage!=null){d.showMsg(f.ExceptionMessage)}else{if(f.Result=="CHANGEOWNER"){Ext.Msg.baseCls="bmc-message";Ext.Msg.show({msg:OwnerChangeSaveErrorMsg,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}else{if(f.Result=="SUCCESS"){if(d.enableQueueAndUserAssignment==true){d.ownerType="STAFF"}else{d.ownerType="OWNER"}d.assignOwnerfields("","",currentUser,d.RemedyForceHTMLProcessor.htmlDecoder(f.CurrentUserName),true);changeAssigntomeButtonState(null,true)}}}}else{if(g.type==="exception"){console.log(g.message)}}},{escape:true})}}function showHideToolbarItems(a){Ext.getCmp("IncStatusId").setVisible(a);Ext.getCmp("IncStatusSpace").setVisible(a);Ext.getCmp("IncStatusSeparator").setVisible(a);Ext.getCmp("servicetargets").setVisible(a);Ext.getCmp("servicetargetsSeparator").setVisible(a);Ext.getCmp("servicetargetsSpace").setVisible(a)}function addOptionalToolbarItems(){if(!isOptionalItemsAdded){var a=Ext.getCmp("detailViewToolbarId");var c=LabelNew;if(_ServerVariables.inctype=="ServiceRequest"){c=IncidentConsolePage.Labels.newServiceRequest}var b=0;if(isRFConsoleDetailForm!=="true"){a.insert(++b,{xtype:"label",id:"IncNameId",cls:"recordNumber",text:c,hidden:isRFConsoleDetailForm?true:false});a.insert(++b,{xtype:"tbspacer",width:5,hidden:isRFConsoleDetailForm?true:false});a.insert(++b,"-");a.insert(++b,{xtype:"tbspacer",width:5,hidden:isRFConsoleDetailForm?true:false})}a.insert(++b,{xtype:"label",id:"IncStatusId",cls:"recordStage",text:status});a.insert(++b,{xtype:"tbspacer",id:"IncStatusSpace",width:5});a.insert(++b,{xtype:"tbseparator",id:"IncStatusSeparator"});a.insert(++b,{xtype:"label",autoEl:{tag:"label",width:"25px",title:(recordId==null||recordId==""||recordId=="new")?"":IncidentConsolePage.Labels.ServiceTargets},cls:"serviceTargetsEmpty",border:false,id:"servicetargets",disabled:(ServiceTargetStatus==""),listeners:{disable:function(d){changeServiceTargetIcons(d.getEl(),ServiceTargetStatus)},enable:function(d){changeServiceTargetIcons(d.getEl(),ServiceTargetStatus)},render:function(d){d.getEl().on({click:function(e){if(ServiceTargetStatus!=""){handleServiceTargets()}},scope:d})}}});a.insert(++b,{xtype:"tbseparator",id:"servicetargetsSeparator",hidden:(recordId=="new"||isCloneRequest=="true"||isServiceCloudConsole=="true")?true:false});a.insert(++b,{xtype:"tbspacer",id:"servicetargetsSpace",width:1,hidden:(recordId=="new"||isCloneRequest=="true"||isServiceCloudConsole=="true")?true:false});a.insert(++b,{xtype:"button",scale:"medium",top:"5px !important",autoEl:{style:{"font-size":"18px !important",border:"0px",background:"none !important","padding-top":"4px !important"},},id:"AssigntomeButtonId",title:(recordId==null||recordId==""||recordId=="new")?"":IncidentConsolePage.Labels.Assigntome,iconCls:"assign-to-me",hidden:(recordId==null||recordId==""||recordId=="new"||isCloneRequest=="true"||isServiceCloudConsole=="true"||isRFConsoleDetailForm==="")?true:false,border:false,listeners:{click:{element:"el",fn:function(){if(!Ext.getCmp("AssigntomeButtonId").isDisabled()){AssignRecordsToUser(recordId)}}}}});a.insert(++b,{xtype:"tbspacer",width:5,id:"tbspacec1",hidden:(recordId==null||recordId==""||recordId=="new"||isCloneRequest=="true"||isServiceCloudConsole=="true"||isRFConsoleDetailForm==="")?true:false});isOptionalItemsAdded=true}}function loadContentsInSmartViews(){var a=document.getElementById("incidentSmartViewFrameId");if(typeof((a)!="undefined"&&a.src=="")||isNeedToRefreshSmartView==true){loadIncidentSmartView(recordId)}else{showDiv(a);if(isIncSmartViewFrameLoaded){stopWaitMsgBar()}}}function addOnLoadEvent(b,a){if(b.addEventListener){b.addEventListener("load",a)}else{if(b.attachEvent){b.attachEvent("onload",a)}}}function changeLayout(a,b){startWaitMsgBar();formLayoutId=a;if(b){templateId=b}isLayoutChanged=true;loadIncidentDetail(recordId)};