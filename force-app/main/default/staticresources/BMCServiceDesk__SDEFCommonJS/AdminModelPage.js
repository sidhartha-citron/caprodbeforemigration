var ruleOrderIndex=1;var waitMask;var warningIcon=Ext.MessageBox.WARNING;var gridStore,ruleGrid,fieldSelComboBox,fieldListStore,selectFieldsCombo,highlightFieldsCombo,popUpWindow,updateRecordIndex;var applySTStr="";var isPageMessage=false;var isErrorMessage=false;var permissions={isModelCreateable:(typeof(_ObjectPermissions)!="undefined"&&_ObjectPermissions!=null)?_ObjectPermissions.isModelCreateable:true,isModelUpdateable:(typeof(_ObjectPermissions)!="undefined"&&_ObjectPermissions!=null)?_ObjectPermissions.isModelUpdateable:true,isModelDeletable:(typeof(_ObjectPermissions)!="undefined"&&_ObjectPermissions!=null)?_ObjectPermissions.isModelDeletable:true};Ext.onReady(function(){Ext.override(Ext.grid.header.Container,{sortAscText:strAscending,sortDescText:strDescending});createTopToolbar();createRuleToolbar();createRuleGrid();prepareDropdownOnLoad();setTypeAheadForLookups();if((!(recordId!=null&&recordId!=""))||(copyRecordId!=null&&copyRecordId!="")){Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);var a=Ext.getCmp("syncId");if(a){a.setDisabled(true);a.setIconCls("SyncCIDisabled")}selectFieldsCombo.setValue(lblAll)}if((recordId!=undefined&&recordId!=""&&!permissions.isModelUpdateable)||(recordId==""&&!permissions.isModelCreateable)){Ext.getCmp("saveId").setDisabled(true)}createSupportingInformation();if(isReadOnly!=undefined&&isReadOnly.toUpperCase()=="TRUE"){makeOnlyReadOnlyField()}recordNavigationValidation();setAddUpdateOnClick(null);handleElemEvent();Ext.getCmp("fieldSelComboBox").setValue(fieldSelComboBox.getStore().getAt(0));if(isfromNormExcep!=undefined&&isfromNormExcep=="true"){addManufacturer(orgNamespace+"Manufacturer__c",manufacturerField.value)}});var renderBtn=false;var ruleGridHt=300;if(isfromNormExcep!=undefined&&isfromNormExcep=="true"){renderBtn=true;ruleGridHt=200}function createTopToolbar(){Ext.create("Ext.toolbar.Toolbar",{cls:"toolSpCls",height:35,id:"rf-model-tbar",renderTo:"btnToolbar",items:[{xtype:"button",scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:tooltipNew,scope:this,hidden:renderBtn,id:"newId",disabled:!permissions.isModelCreateable,handler:function(){window.parent.addTab("AdminModelPage",headerWinTab,headerWinTab)}},{scale:"medium",iconCls:"bmcSave",tooltipType:"title",id:"saveId",scope:this,tooltip:tooltipSave,handler:SaveBtnHandler},{scale:"medium",tooltipType:"title",tooltip:tooltipCopy,iconCls:"bmcCopy",scope:this,hidden:renderBtn,id:"copyId",disabled:!permissions.isModelCreateable,handler:function(){window.parent.addTab("AdminModelPage?copyId="+recordId+"",headerWinTab,headerWinTab)}},{xtype:"tbseparator",hidden:renderBtn,id:"tbseparatorId"},{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:tooltipDelete,scope:this,disabled:!permissions.isModelDeletable,hidden:renderBtn,id:"deleteId",handler:DeleteBtnHandler},{scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:tooltipRefresh,hidden:renderBtn,id:"resetId",handler:RefreshBtnHandler},{xtype:"tbseparator",hidden:true,id:"tbseparatorId"},{scale:"medium",iconCls:"SyncCI",tooltipType:"title",tooltip:tooltipSyncCI,hidden:renderBtn,disabledCls:"SyncCIDisabled",id:"syncId",handler:SyncCIBtnHandler},new Ext.toolbar.Fill(),{id:"idInactive",xtype:"checkbox",width:75,color:"#004376",align:"top",hidden:renderBtn,checked:false,boxLabel:InactiveLabelWithStyle,listeners:{render:function(){new Ext.ToolTip({target:"idInactive",anchor:"left",html:tooltipInactive})}}},{xtype:"box",id:"prevId",hidden:renderBtn,autoEl:{tag:"img",src:b_previous,title:tooltipPreviousRecord},listeners:{render:function(a){a.el.on("click",PreviuosBtnHandler)}}},{xtype:"box",id:"nextId",hidden:renderBtn,autoEl:{tag:"img",src:b_next,title:tooltipNextRecord},listeners:{render:function(a){a.el.on("click",NextBtnHandler)}}},{xtype:"tbspacer",width:10}]});if(isInactive!=null){Ext.getCmp("idInactive").setValue(isInactive)}}function createRuleGrid(){Ext.define("CriteriaModel",{extend:"Ext.data.Model",fields:[{name:"operandFieldLabel",type:"string"},{name:"operandValue",type:"string"},{name:"operatorFieldAPIName",type:"string",hidden:true},{name:"operandFieldType",type:"string",hidden:true},{name:"lookupFieldID",type:"string",hidden:true}]});gridStore=Ext.create("Ext.data.Store",{model:"CriteriaModel"});ruleGrid=new Ext.grid.GridPanel({id:"gridId",store:gridStore,columns:[{dataIndex:"operandFieldLabel",text:FieldLabel,sortable:true,width:180,renderer:function(a){return Ext.util.Format.htmlEncode(a)}},{dataIndex:"operandValue",text:Value,sortable:false,width:180,renderer:function(a){return Ext.util.Format.htmlEncode(a)}},{dataIndex:"operatorFieldAPIName",hidden:true},{dataIndex:"operandFieldType",hidden:true},{dataIndex:"lookupFieldID",hidden:true}],columnLines:true,enableColumnHide:false,enableColumnResize:true,enableColumnMove:false,height:ruleGridHt,forceFit:true,layout:"fit",border:true,stripeRows:true,viewConfig:{stripeRows:false,forceFit:true,scrollOffset:0,getRowClass:function(a){var b=a.get("operatorFieldAPIName");if(b==orgNamespace+"manufacturername__c"){return"cssReadOnlyRow"}}},listeners:{itemclick:function(a,h,q,l,m){var r="false";if(r=="false"||r==""){rowIndex=l;var o=Ext.getCmp("gridId").store.getAt(rowIndex);var b=o.get("operandFieldLabel");var p=o.get("operatorFieldAPIName");var c=o.get("operandValue");var g=o.get("operatorValue");var n=o.get("groupingOperator");var j=o.get("operandFieldType");if(p!=null&&p!="undefined"){if(p==orgNamespace+"manufacturername__c"){fieldSelComboBox.setValue("");setVisibilityOnClick(p,b,j,null)}else{fieldSelComboBox.setValue(p);var f=fetchQualificationComboFieldLabel();var d=f.get("type");if(d!=null&&d.indexOf(":")>0){var k=d.split(":")[1];if(k!=null&&typeof(k)!="undefined"&&k!=""){selectedTextAreaLength=k}}setVisibilityData(p,b,j,c,g,n)}}}}}});ruleGrid.render("gridDiv");loadDataToGrids()}function createRuleToolbar(){fieldListStore=new Ext.data.JsonStore({id:"fieldsStore",fields:["id","type","label","e"],data:fldData,proxy:new Ext.data.MemoryProxy(fldData),sortInfo:{field:"label",direction:"ASC"}});fieldSelComboBox=Ext.create("Ext.form.field.ComboBox",{id:"fieldSelComboBox",store:fieldListStore,queryMode:"local",displayField:"label",valueField:"id",renderTo:"fieldSelDiv",listConfig:{minWidth:195},editable:true,typeAhead:true,width:210,height:13,tpl:'<tpl for="." ><li role="option" class="x-boundlist-item">{label:htmlEncode}</li></tpl>',listeners:{select:function(f,e,c){document.getElementById("autocompleteDiv").style.visibility="hidden";var b=document.getElementById("selectAutoOptions");if(b){RemedyForceHTMLProcessor.clearHTML(b)}var a=e[0].get("type");if(a.indexOf(":")>0){a=a.split(":")[0]}else{if(a.indexOf(EF)>0){a=a.split(EF)[0]}}apiName=e[0].get("id");label=e[0].get("label");type=e[0].get("type");for(var d=0;d<gridStore.data.length;d++){if(gridStore.getAt(d).get("operatorFieldAPIName")==apiName){ruleGrid.getSelectionModel().select(d);ruleGrid.getView().highlightItem(d)}}rowIndex=-1;setVisibilityData(apiName,label,type)}}});pickListComboStore=Ext.create("Ext.data.ArrayStore",{id:"pickListFieldStore",data:[["SERVER","Server"],["DESKTOP","Desktop"],["LAPTOP","Laptop"]],fields:["id","val"],sortInfo:{field:"val",direction:"ASC"}});pickListComboBx=Ext.create("Ext.form.ComboBox",{id:"pickListFieldCombo",store:pickListComboStore,queryMode:"local",forceSelection:true,valueField:"id",displayField:"val",selectOnFocus:true,editable:true,typeAhead:true,renderTo:"picklistCombo",tpl:'<tpl for="." ><li role="option" class="x-boundlist-item">{val:htmlEncode}</li></tpl>',hidden:true,width:204,listWidth:100});booleanComboStore=Ext.create("Ext.data.ArrayStore",{id:"booleanFieldStore",data:[["true","True"],["false","False"]],fields:["id","val"],sortInfo:{field:"val",direction:"ASC"}});booleanComboBx=Ext.create("Ext.form.ComboBox",{id:"booleanFieldCombo",store:booleanComboStore,queryMode:"local",valueField:"id",displayField:"val",selectOnFocus:true,editable:false,renderTo:"booleanCombo",hidden:true,width:204,listWidth:150})}function showLoadingMask(a){waitMask=new Ext.LoadMask(Ext.getBody(),{msg:a});if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.show()}}function hideLoadingMask(){if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.hide()}}function updateTitle(){if(modelname!=""){window.parent.changeTitle(wid,modelname,headerWinTab)}}function showMessage(a){Ext.Msg.show({msg:a,buttons:Ext.Msg.OK,minWidth:300,maxWidth:360,minHeight:110,icon:warningIcon})}function loadDataToGrids(){if(listData.length>0){document.getElementById("removeRuleButtonId").disabled=false;var b=listData[0];for(var a=0;a<b.length;a++){b[a]=decodeVal(b[a])}}else{document.getElementById("removeRuleButtonId").disabled=true}gridStore.loadData(listData);ruleOrderIndex=listData.length+1}var SaveBtnHandler=function(){var d=validateData();if(d!=""){return showPageMsg(d)}else{document.getElementById("jsscripterrorId").setAttribute("style","display:none;")}var b;setConditionsData();showLoadingMask(saveMaskMsg);var c=Ext.getCmp("cmbclassFields");if(typeof(c)!="undefined"&&c.getValue()!=null){b=c.findRecordByValue(c.getValue());modelClass=b.get("Id")}var a=Ext.getCmp("idInactive").getValue();SaveRecord(modelClass,a)};function afterSave(){hideLoadingMask();if(isSavedSuccessfully){if(isfromNormExcep.toLowerCase()=="true"){Ext.MessageBox.show({msg:normalizationExceptionLinkModelWarningMsg,width:300,title:models,buttons:Ext.MessageBox.OK,fn:function(b){ShowInlineMessage("SaveMessageDiv","rf-model-tbar",-50)}})}else{ShowInlineMessage("SaveMessageDiv","rf-model-tbar",-50)}if(isfromNormExcep.toLowerCase()!="true"){window.parent.refreshList();updateTitle();copyRecordId="";refreshSupportingInfo();fieldSelComboBox.setValue("");assignVisibility("inline","none","none","none","none","none","none",null,1);setAddUpdateOnClick(null);handleSave();if(recordId!=null&&recordId!=""&&recordId!=undefined){if(highlightFieldsCombo!=undefined){highlightFieldsCombo.setDisabled(true);highlightFieldsCombo.addCls("InputVirtualReadOnly")}if(selectFieldsCombo!=undefined){Ext.getCmp("cmbSelectFields").setValue(lblAll);selectFieldsCombo.setDisabled(true);selectFieldsCombo.addCls("InputVirtualReadOnly")}}Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("resetId").setDisabled(false);var a=Ext.getCmp("syncId");if(a){a.setDisabled(false);a.setIconCls("SyncCI")}window.parent.handleSave(wid,recordId)}}applySTStr=""}var DeleteBtnHandler=function(){Ext.Msg.show({title:deleteToolTip,msg:delCnfrmMsg,minWidth:300,maxWidth:360,minHeight:110,buttons:Ext.Msg.YESNO,icon:Ext.MessageBox.WARNING,fn:function(a){if(a=="yes"){DeleteRecord()}}})};function postDeleteAction(){window.parent.refreshList();window.parent.closeTab(wid)}var RefreshBtnHandler=function(){refreshModelRecordHandler()};function generateObjPreFixMap(b){var d=b.prefixList;for(var c=0;c<d.length;c++){ObjectPrefixMap[c]=new Array(2);var a=d[c];var e=a.split(":");ObjectPrefixMap[c][0]=e[0];ObjectPrefixMap[c][1]=e[1]}ObjectPrefixMap[d.length]=new Array(2);ObjectPrefixMap[d.length][0]="005";ObjectPrefixMap[d.length][1]="User";ObjectPrefixMap[d.length+1]=new Array(2);ObjectPrefixMap[d.length+1][0]="StandardUserLookup";ObjectPrefixMap[d.length+1][1]="User";prefixMap=ObjectPrefixMap}function openLookup(c,d,o,l){if(isReadOnly==undefined||isReadOnly.toUpperCase()!="TRUE"){var f=c.split("&");var b="";if(f.length>2){var p=c.search("lkpr=")>0?f[2].split("="):f[1].split("=");b=p[1];currentField=document.getElementById(b);isFromLookup=true}for(var k=0;k<f.length;k++){if(f[k]!=undefined){urlArr2=f[k].split("=");if(urlArr2[0]=="lktp"){lookupType=urlArr2[1]}}}for(var k=0;k<ObjectPrefixMap.length;k++){if(lookupType==ObjectPrefixMap[k][0]){lookupObject=ObjectPrefixMap[k][1];break}}var n="";l=decodeURIComponent((l+"").replace(/\+/g,"%20"));var m=l.split("=");if(m.length==2){n=m[1];if(n!=null){n=n.trim();n=encodeURIComponent(n);if(n!=""&&n.length<2){n=""}}}var a=parseInt((screen.availWidth/2)-(670/2));var j=parseInt((screen.availHeight/2)-(480/2));var g="";if(lookupType=="StandardUserLookup"){lookupObject="User";g="active_standard"}var e=true;var h="";c="/apex/"+orgNamespace+"SearchAndLink?txt="+b;c=c+"&filterObjectId=a1FA0000002p3Or&parentName=Model__c &childName="+lookupObject+"&isLookUp="+lookupObject+"&NewLookUpType="+h+"&filterId="+g+"&searchLookUpStr="+n+"&isCustomLookup="+e;openPopup(c,"lookup",350,480,"width=1000,height=600,toolbar=no,status=no,left= "+a+",top="+j+",directories=no,menubar=no,resizable=yes,scrollable=no",true)}}function openCIClsNameLookup(){openPopupTitle("SearchPage?popupId=CMDB_Class&isLookup=true&idNameForPopUp=true",onCompl,600,840,"ciclasslookup")}function onCompl(a){var b=a.split(EF);if(b[0]!=null&&b[0]!=""){CMDBClassName=b[1]}Ext.getCmp("gridId").getStore().removeAll(false);ruleOrderIndex=1;populateFields(CMDBClassName)}function openPopupTitle(e,g,a,d,c,f){onCompleteFunction=g;var b=checkCustomPage();if(a!=null&&d!=null){popUpWindow=new Ext.Window({height:a,width:d,x:10,y:5,id:"popUpWindow",modal:true,resizable:false,constrain:true,cls:b.popUpWindowClassName,frame:b.isFrame,viewConfig:{forceFit:true},html:'<iframe frameborder="0" src ="/apex/'+e+'" style="width:100%;height:100%;border:none"/>'});popUpWindow.show()}}function checkCustomPage(){var a={popUpWindowClassName:"",isFrame:true};if(typeof isCustomPage!="undefined"||typeof window.parent.isCustomPage!="undefined"){a={popUpWindowClassName:"popUpWindowClass",isFrame:false}}return a}function setPopUpVar(b,a){if(b!=null&&b!=""&&onCompleteFunction!=null){onCompleteFunction(b,a)}}function removeRuleData(){if(getRemoveBtnEle().src.indexOf("b_remove_disabled")==-1){var a=Ext.getCmp("gridId").getStore().getAt(rowIndex);if(rowIndex!=-1){Ext.getCmp("gridId").getStore().remove(a)}ruleOrderIndex=gridStore.data.length+1;rowIndex=-1;getRemoveBtnEle().src=getSDFStylesResPath()+"/SDEFbuttons/b_remove_disabled.png";getRemoveBtnEle().disabled=true;fieldSelComboBox.setValue("");getInputTxtEle().value="";assignVisibility("inline","none","none","none","none","none","none",null,1);setAddUpdateOnClick(null);divErrorMsg.innerText=""}Ext.getCmp("gridId").getSelectionModel().deselectAll();Ext.getCmp("fieldSelComboBox").setValue(fieldSelComboBox.getStore().getAt(0))}function addRuleQData(){var a=validateValue();if(a){lookupSelectedValue="";lookupSelectedId="";addUpdateRuleQData();Ext.getCmp("fieldSelComboBox").setValue(fieldSelComboBox.getStore().getAt(0))}}function validateAttributeValue(){return validateValue()}function validateValue(){if(popUpString!=""){var b=getInputTxtEle().value;var a=document.getElementById("referenceID").value;if(b==""||a==""||b!=lookupSelectedValue||a!=lookupSelectedId){RemedyForceHTMLProcessor.clearHTML(divErrorMsg);divErrorMsg.appendChild(document.createTextNode(invalidLookupStringMsg));return false}else{RemedyForceHTMLProcessor.clearHTML(divErrorMsg);return true}}else{return true}}function addUpdateRuleQData(h){var b="";var d=fetchRuleComboFieldLabel();if(d!=null&&d!=""&&d!="undefined"){var e=d.get("label");if(e!=null&&e!=""&&e!="undefined"){var a=d.get("type");if(a!=null&&a.indexOf(":")>0){a=a.split(":")[0]}}}else{showExtMsg(SelectFieldErrMsg);return}var l;if(compTypeNo=="1"||compTypeNo=="10"||compTypeNo=="11"||compTypeNo=="7"||compTypeNo=="8"||compTypeNo=="9"||compTypeNo=="5"){var k=getInputTxtEle();if(k!=null&&k!="undefined"){l=k.value}}else{if(compTypeNo=="2"){l=booleanComboBx.getValue()}else{if(compTypeNo=="3"){var j=getInputTextAreaEle();if(j!=null&&j!="undefined"){l=j.value}}else{if(compTypeNo=="4"){l=pickListComboBx.getValue()}else{if(compTypeNo=="12"){l=getDateTimeInputEle().value}else{if(compTypeNo=="13"){l=getDateInputEle().value}}}}}}var c;if(l!=null&&l!=""&&l!="undefined"){c=validateAttributeData(l);if(c){return}else{assignVisibility("inline","none","none","none","none","none","none",null,1)}}else{showExtMsg(EnterValMsg);return}b=document.getElementById("referenceID").value;if(h==null||h=="undefined"||typeof(h)=="undefined"){gridStore.add(new CriteriaModel({operandFieldLabel:e,operandValue:l,operatorFieldAPIName:d.get("id"),operandFieldType:a,lookupFieldID:b}));if(gridStore.data.items.length>0){document.getElementById("removeRuleButtonId").disabled=false}ruleOrderIndex=ruleOrderIndex+1;clearRuleCriteria()}else{h.set("operandValue",l);if(h.data.operandFieldType.indexOf("ф")){var f=h.data.operandFieldType.split("ф");if(typeof(f)!=undefined&&f!=null&&f.length==2&&h.data.operandFieldType.split("ф")[0].toLowerCase()=="reference"){h.set("lookupFieldID",b)}}}Ext.getCmp("gridId").getSelectionModel().deselectAll();ruleGrid.getView().refresh();var g=gridStore.indexOf(h);if(g!=-1){ruleGrid.getView().focusRow(g)}else{ruleGrid.getView().focusRow(gridStore.getCount()-1)}}function validateAttributeData(e){var c=false;if(compTypeNo!=0){if(compTypeNo==7){if(isNaN(e)){c=true;Ext.MessageBox.show({width:250,msg:lblInvalidNumber,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==8){var a=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!e.match(a)){c=true;Ext.MessageBox.show({width:250,msg:lblInvalidEmailAddress,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==9){if(isNaN(e)||e<0||e>100){c=true;Ext.MessageBox.show({width:250,msg:lblInvalidPercent,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==11){var b=/^-?\d+(\.\d+)?$/;if(!e.match(b)){c=true;Ext.MessageBox.show({width:250,msg:lblInvalidCurrency,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==10){var d=/^[-]?\d*?\d*$/;if(!e.match(d)){c=true;Ext.MessageBox.show({width:250,msg:lblInvalidPhone,buttons:Ext.MessageBox.OK})}}}}}}}return c}function setVisibilityData(b,j,f,g,d,h){ciLookup=b;isInList=false;var a=fldData.length;selectedApiName=b;selectedLabel=j;var e=0;while(gridStore.data.length>e){applySTStr=applySTStr+gridStore.getAt(e).get("operatorFieldAPIName")+nonPrint+gridStore.getAt(e).get("operandValue")+nonPrint+gridStore.getAt(e).get("operandFieldType")+nonPrint+gridStore.getAt(e).get("lookupFieldID")+nonPrint+PE;e++}var k=applySTStr.split(PE);applySTStr="";if(k.length!=0){for(i=0;i<k.length;i++){var c=k[i].split(nonPrint);if(c[0]==selectedApiName){isInList=true;value=c[1];updateRecordIndex=i;rowIndex=i;setVisibilityOnClick(selectedApiName,selectedLabel,f,value);break}}}if(isInList==false){if(f.indexOf(":")>0){selectedTextAreaLength=f.split(":")[1];f=f.split(":")[0]}else{if(f.indexOf(EF)>0){popUpString=f.split(EF)[1];f=f.split(EF)[0]}}if(f=="text"){assignVisibility("inline","none","none","none","none","none","none",null,1,g)}else{if(f=="phone"){assignVisibility("inline","none","none","none","none","none","none",null,10,g)}else{if(f=="currency"){assignVisibility("inline","none","none","none","none","none","none",null,11,g)}else{if(f=="percent"){assignVisibility("inline","none","none","none","none","none","none",null,9,g)}else{if(f=="email"){assignVisibility("inline","none","none","none","none","none","none",null,8,g)}else{if(f=="number"){assignVisibility("inline","none","none","none","none","none","none",null,7,g)}else{if(f=="boolean"){assignVisibility("none","none","none","inline","none","none","none",null,2,g)}else{if(f=="textarea"){assignVisibility("none","inline","none","none","none","none","none",null,3,g)}else{if(f=="picklist"){setPickListOptions(selectedApiName);assignVisibility("none","none","none","none","inline","none","none",null,4,g)}else{if(f=="reference"){assignVisibility("inline","none","inline","none","none","none","none",b,5,g)}else{if(f=="reference1"){assignVisibility("inline","none","inline1","none","none","none","none",b,6,g)}else{if(f=="datetime"){assignVisibility("none","none","none","none","none","inline","none",null,12,g)}else{if(f=="date"){assignVisibility("none","none","none","none","none","none","inline",null,13,g)}}}}}}}}}}}}}setAddUpdateOnClick(g)}}function setVisibilityOnClick(b,c,f,a,e,d){ciLookup=b;var g=fldData.length;selectedApiName=b;selectedLabel=c;if(f.indexOf(":")>0){selectedTextAreaLength=f.split(":")[1];f=f.split(":")[0]}else{if(f.indexOf(EF)>0){popUpString=f.split(EF)[1];f=f.split(EF)[0]}}if(f=="text"){assignVisibility("inline","none","none","none","none","none","none",null,1,a)}else{if(f=="phone"){assignVisibility("inline","none","none","none","none","none","none",null,10,a)}else{if(f=="currency"){assignVisibility("inline","none","none","none","none","none","none",null,11,a)}else{if(f=="percent"){assignVisibility("inline","none","none","none","none","none","none",null,9,a)}else{if(f=="email"){assignVisibility("inline","none","none","none","none","none","none",null,8,a)}else{if(f=="number"){assignVisibility("inline","none","none","none","none","none","none",null,7,a)}else{if(f=="boolean"){assignVisibility("none","none","none","inline","none","none","none",null,2,a)}else{if(f=="textarea"){assignVisibility("none","inline","none","none","none","none","none",null,3,a)}else{if(f=="picklist"){setPickListOptions(selectedApiName);assignVisibility("none","none","none","none","inline","none","none",null,4,a)}else{if(f=="reference"){assignVisibility("inline","none","inline","none","none","none","none",b,5,a)}else{if(f=="reference1"){assignVisibility("inline","none","inline1","none","none","none","none",b,6,a)}else{if(f=="datetime"){assignVisibility("none","none","none","none","none","inline","none",null,12,a)}else{if(f=="date"){assignVisibility("none","none","none","none","none","none","inline",null,13,a)}}}}}}}}}}}}}setAddUpdateOnClick(a)}function assignVisibility(h,q,n,l,d,b,r,c,m,g){if(n!="inline"&&n!="inline1"){popUpString=""}var e=getInputTxtEle();var s=getInputTextAreaEle();var f=getDateTimeInputEle();var k=getDateTimePickerImg();var o=getDateInputEle();var p=getDatePickerImg();var t=getLookupEle();var a=Ext.getCmp("booleanFieldCombo");var j=document.getElementById("inputTxtAreaButtonEle");var u=Ext.getCmp("pickListFieldCombo");if(e!=null&&typeof(e)!="undefined"){e.style.display=h;if(h=="inline"&&g!=null&&g!="undefined"){e.value=g}else{e.value=""}e.disabled=false}if(s!=null&&typeof(s)!="undefined"){s.style.display=q;if(j!=null&&typeof(j)!="undefined"){if(q=="inline"){j.style.display="block"}else{j.style.display="none"}if(q=="inline"&&g!=null&&g!="undefined"){s.value=g}else{s.value=""}}}if(f!=null&&typeof(f)!="undefined"){f.style.display=b;if(k!=null&&typeof(k)!="undefined"){k.style.display=b}if(b=="inline"&&g!=null&&g!="undefined"){f.value=g}else{f.value=""}}if(o!=null&&typeof(o)!="undefined"){o.style.display=r;if(p!=null&&typeof(p)!="undefined"){p.style.display=r}if(r=="inline"&&g!=null&&g!="undefined"){o.value=g}else{o.value=""}}if(a!=null&&typeof(a)!="undefined"){if(l=="inline"){a.setVisible(true)}else{a.hide()}if(l=="inline"&&g!=null&&g!="undefined"){a.setValue(g)}else{a.value=""}}if(u!=null&&typeof(u)!="undefined"){if(d=="inline"){u.setVisible(true)}else{u.hide();u.reset()}if(d=="inline"&&g!=null&&g!="undefined"){setPickListOptions(selectedApiName);u.setValue(g)}else{u.value=""}}if(n=="inline"){if(t!=null&&typeof(t)!="undefined"){t.disabled=false;t.style.visibility="visible";t.style.display="inline"}popUpEnable=true}else{if(t!=null&&typeof(t)!="undefined"){t.style.visibility="hidden";t.style.display="none";t.disabled=true}}if(n=="inline1"){t.style.display="none";e.value="";popUpEnable=true}compTypeNo=m}function setAddUpdateOnClick(a){if(isReadOnly==undefined||isReadOnly.toUpperCase()!="TRUE"){if(a!=null&&a!="undefined"){getUpdateBtnEle().style.display="inline";getUpdateBtnEle().style.visibility="visible";getAddBtnEle().style.display="none";getAddBtnEle().style.visibility="hidden";getRemoveBtnEle().disabled=false;getRemoveBtnEle().src=getSDFStylesResPath()+"/SDEFbuttons/b_remove.png"}else{getUpdateBtnEle().style.display="none";getUpdateBtnEle().style.visibility="hidden";getAddBtnEle().style.display="inline";getAddBtnEle().style.visibility="visible";getRemoveBtnEle().disabled=true;getRemoveBtnEle().src=getSDFStylesResPath()+"/SDEFbuttons/b_remove_disabled.png"}}else{getAddBtnEle().style.display="inline";getAddBtnEle().style.visibility="visible";getAddBtnEle().disabled=true;getAddBtnEle().style.color="grey";getRemoveBtnEle().style.display="inline";getRemoveBtnEle().style.visibility="visible";getRemoveBtnEle().disabled=true;getRemoveBtnEle().style.color="grey"}}if(typeof(SDEDateFormat)=="undefined"||SDEDateFormat==null||SDEDateFormat==""){this.SDEDateFormat="m/d/Y h:i A"}FilterDatePickerPopup=function(){};FilterDatePickerPopup.prototype={dateFormat:SDEDateFormat,Show:function(c){var a=Ext.get(c);var b=a.getRegion();var d=Ext.create("Ext.window.Window",{height:230,width:280,x:b.right-255,y:b.top-235,layout:"fit",items:{xtype:"datepicker",handler:function(j,h){a.dom.value=Ext.Date.format(h,SDEDateFormat);var e=a.dom.id;if(e.indexOf("inputDate")>0){var f=document.getElementById(e).value;var g=f.split(" ");a.dom.value=g[0].replace(",","")}dataModifiedFlag=1;a=null;d.close()}}}).show()}};var _datePicker=new FilterDatePickerPopup();function showDateTimePicker(){var a=getDateTimeInputEle();_datePicker.Show(a)}function fetchRuleComboFieldLabel(){var b=fieldSelComboBox.getValue();if(b=="Select"){return null}for(var a=0;a<fieldListStore.data.length;a++){if(b==fieldListStore.getAt(a).get("id")){return fieldListStore.getAt(a)}}return""}function clearRuleCriteria(){if(compTypeNo=="1"||compTypeNo=="10"||compTypeNo=="11"||compTypeNo=="7"||compTypeNo=="8"||compTypeNo=="9"||compTypeNo=="5"){var e=getInputTxtEle();if(e!=null&&e!="undefined"){e.value=""}}else{if(compTypeNo=="2"){operandVal=booleanComboBx.setValue("")}else{if(compTypeNo=="3"){var d=getInputTextAreaEle();if(d!=null&&d!="undefined"){d.value=""}}else{if(compTypeNo=="4"){operandVal=pickListComboBx.setValue("")}else{if(compTypeNo=="12"){var f=getDateTimeInputEle();if(f!=null&&f!="undefined"){f.value=""}}else{if(compTypeNo=="13"){var a=getDateInputEle();if(a!=null&&a!="undefined"){a.value=""}}else{if(compTypeNo=="6"){var b=getInputTxtEle();if(b!=null&&typeof(b)!="undefined"){b.value="";var c=document.getElementById("referenceID");if(c!=null&&typeof(c)!="undefined"){c.value=""}}}}}}}}}fieldSelComboBox.setValue("");RemedyForceHTMLProcessor.clearHTML(divErrorMsg)}function fetchQualificationComboFieldLabel(){var b=fieldSelComboBox.getValue();for(var a=0;a<fieldListStore.data.length;a++){if(b==fieldListStore.getAt(a).get("id")){return fieldListStore.getAt(a)}}return""}function setPickListOptions(b){var c=Ext.getCmp("pickListFieldCombo");if(c!=null){var d=getPickListOptions(b);pickListArray=[];for(var a=0;a<d.length;a++){if(d[a]!=""){pickListArray[a]=[d[a],d[a]]}}pickListComboBx.store.removeAll();pickListComboBx.store.loadData(pickListArray);pickListComboBx.setVisible(true)}}function getPickListOptions(b){for(var c=0;c<fldData.length;c++){var a=fldData[c];var f=a.e.split(EF);var d=f[0];if(d==b){var e=f[1].split(DZHE);return e}}return null}function openQualLookup(){var f="";var d=parseInt((screen.availWidth/2)-(670/2));var b=parseInt((screen.availHeight/2)-(480/2));var a="";var c=true;var e="";var g=getInputTxtEle().value;var a="";if(g.length>0&&g.length<2){Ext.MessageBox.show({width:250,msg:lblLookupValueLength,buttons:Ext.MessageBox.OK})}else{if(popUpString=="BMC BaseElement"){popUpString="BMC_BaseElement"}else{if(popUpString=="User"||popUpString=="Group"){a="active_standard";f="/apex/"+orgNamespace+"SearchAndLink?txt=modelattrlookup";f=f+"&filterObjectId=&parentName=Model__c&childName=User&isLookUp=User&NewLookUpType="+e+"&filterId="+a+"&searchLookUpStr="+encodeURIComponent(g)+"&isCustomLookup=false";openPopup(f,"lookup",500,500,"width=1000,height=600,toolbar=no,status=no,left= "+d+",top="+b+",directories=no,menubar=no,resizable=yes,scrollable=no",true)}else{if(popUpString=="BMC_BaseElement__c"){if(selectedApiName.toLowerCase()==(orgNamespace+"fklocation__c").toLowerCase()){a="&citype=location"}else{if(selectedApiName.toLowerCase()==(orgNamespace+"fkbusinessservice__c").toLowerCase()){a="&citype=subservice"}}f="/apex/"+orgNamespace+"SearchAndLink?txt=modelattrlookup";f=f+"&filterObjectId=&parentName=Model__c&childName="+popUpString+"&isLookUp="+popUpString+"&NewLookUpType="+e+"&filterId="+a+"&searchLookUpStr="+encodeURIComponent(g)+"&isCustomLookup=false";openPopup(f,"lookup",500,500,"width=1000,height=600,toolbar=no,status=no,left= "+d+",top="+b+",directories=no,menubar=no,resizable=yes,scrollable=no",true)}else{if(popUpString=="BusinessHours"){f="/apex/SearchPage?moduleId="+orgNamespace+"service_hours__c&InstanceID=&isLookup=true&popupId=null&moduleName=BMC_BASEELEMENT__c&ifFromModelMapping=true"}else{f="/apex/"+orgNamespace+"SearchAndLink?txt=modelattrlookup";f=f+"&filterObjectId=&parentName=Model__c&childName="+popUpString+"&isLookUp="+popUpString+"&NewLookUpType="+e+"&filterId="+a+"&searchLookUpStr="+encodeURIComponent(g)+"&isCustomLookup="+c}openPopup(f,"lookup",500,500,"width=1000,height=600,toolbar=no,status=no,left= "+d+",top="+b+",directories=no,menubar=no,resizable=yes,scrollable=no",true)}}}}}function setReferenceToVal(c){if(c.indexOf(EF)>0){referenceId=c.split(EF)[0];referenceName=c.split(EF)[1]}referenceName=decodeVal(referenceName);var b=getInputTxtEle();if(b!=null&&typeof(b)!="undefined"){b.value=referenceName;var a=getlookupFieldIdEle();if(a!=null&&typeof(a)!="undefined"){a.value=referenceId}}}function decodeVal(a){a=a.replace(/&gt;/g,">");a=a.replace(/&lt;/g,"<");a=a.replace(/&quot;/g,'"');a=a.replace(/&amp;/g,"&");a=a.replace(/&#39;/g,"'");a=a.replace(/&nbsp;/g," ");return a}function upadateRuleData(){var b=validateValue();if(b){if(updateRecordIndex!=null&&updateRecordIndex!=undefined&&updateRecordIndex>-1){var a=Ext.getCmp("gridId").store.getAt(updateRecordIndex)}else{var a=Ext.getCmp("gridId").store.getAt(rowIndex)}addUpdateRuleQData(a);setAddUpdateOnClick(null);Ext.getCmp("gridId").getSelectionModel().clearSelections();clearRuleCriteria();assignVisibility("inline","none","none","none","none","none","none",null,1)}}function setConditionsData(){var b=0;while(gridStore.data.length>b){applySTStr=applySTStr+gridStore.getAt(b).get("operatorFieldAPIName")+nonPrint+gridStore.getAt(b).get("operandValue")+nonPrint+gridStore.getAt(b).get("operandFieldType")+nonPrint+gridStore.getAt(b).get("lookupFieldID")+nonPrint+PE;b++}var a=getApplySTStrEle();a.value=applySTStr}function prepareDropdownOnLoad(){var a=new Ext.data.ArrayStore({fields:["id"],data:classTypeJson});if(isDisplayClassType){selectFieldsCombo=Ext.create("Ext.form.ComboBox",{store:a,displayField:"id",valueField:"id",value:filterType,typeAhead:false,mode:"local",selectOnFocus:true,renderTo:"classType",editable:false,loading:true,emptyText:lblAll,width:204,id:"cmbSelectFields",listeners:{select:function(e,c,d){highlightFieldsCombo.clearValue();handleChange();if(e.getValue()==lblAll){showLoadingMask(lblLoading);selectedfilterType=lblAll;fetchclasses(selectedfilterType);reloadStore(serAllclass)}else{if(e.getValue()==lblCIClass){showLoadingMask(lblLoading);selectedfilterType="CI";fetchclasses(selectedfilterType);reloadStore(serCIclass)}else{if(e.getValue()==lblAssetClass){showLoadingMask(lblLoading);selectedfilterType="ASSET";fetchclasses(selectedfilterType);reloadStore(serAssetclass)}}}}}})}var b=new Ext.data.ArrayStore({fields:[orgNamespace+"ClassName__c",orgNamespace+"Class__c","Id"]});highlightFieldsCombo=Ext.create("Ext.form.ComboBox",{store:b,id:"cmbclassFields",editable:true,typeAhead:true,emptyText:lblNone,queryMode:"local",displayField:orgNamespace+"Class__c",valueField:orgNamespace+"ClassName__c",forceSelection:true,width:204,tpl:new Ext.XTemplate('<tpl for="."><div title="{'+orgNamespace+'Class__c:htmlEncode}" class="x-boundlist-item">{'+orgNamespace+"Class__c:this.ellipsify}</div></tpl>",{ellipsify:function(c){return Ext.util.Format.htmlEncode(Ext.util.Format.ellipsis(c,20))}}),renderTo:"CMDBclass",listeners:{select:function(e,c,d){showLoadingMask(lblLoading);CMDBClassName=e.getValue();populateFields(CMDBClassName);handleChange()},afterrender:function(c){reloadStore(serAllclass);if(typeof(modelClass)!="undefined"&&modelClass!=""){c.setValue(modelClass);CMDBClassName=c.getValue()}},blur:function(e,c,d){if(CMDBClassName!=e.getValue()&&e.findRecordByValue(e.getValue())){showLoadingMask(lblLoading);CMDBClassName=e.getValue();populateFields(CMDBClassName)}}}});if(recordId!=null&&recordId!=""&&recordId!=undefined){if(typeof(selectFieldsCombo)!="undefined"&&selectFieldsCombo!=undefined){Ext.getCmp("cmbSelectFields").setValue(lblAll);selectFieldsCombo.setDisabled(true);selectFieldsCombo.addCls("InputVirtualReadOnly")}if(typeof(highlightFieldsCombo)!="undefined"&&highlightFieldsCombo!=undefined){highlightFieldsCombo.setDisabled(true);highlightFieldsCombo.addCls("InputVirtualReadOnly")}}else{if(typeof(isfromNormExcep)!="undefined"&&isfromNormExcep!=undefined&&isfromNormExcep=="true"){if(typeof(selectFieldsCombo)!="undefined"&&selectFieldsCombo!=undefined){Ext.getCmp("cmbSelectFields").setValue(lblAll);selectFieldsCombo.setDisabled(true);selectFieldsCombo.addCls("InputVirtualReadOnly")}}}}function reloadStore(jsonClasses){var highlightFieldsComboStore=Ext.getCmp("cmbclassFields").getStore();highlightFieldsComboStore.removeAll();highlightFieldsComboStore.loadData(eval(jsonClasses));hideLoadingMask();var highlightFieldsCombo=Ext.getCmp("cmbclassFields");if(typeof(highlightFieldsCombo)!="undefined"&&(highlightFieldsCombo.getValue()==""||highlightFieldsCombo.getValue()==null)){highlightFieldsCombo.setValue("BMC_BaseElement");CMDBClassName=highlightFieldsCombo.getValue()}}function openExtPopup(c,f,a,b,e,d){if(e==true){idNameForPopUp=e}if(d==null){d=false}return openPopupTitle(c,f,a,b,"",d)}function closeExtPopup(){if(popUpWindow!=null&&popUpWindow!=undefined){popUpWindow.close()}}function makeOnlyReadOnlyField(){var e=document.getElementById("btnToolbar");if(e!=undefined){e.style.display="none"}if(selectFieldsCombo!=undefined){selectFieldsCombo.setDisabled(true)}if(highlightFieldsCombo!=undefined){highlightFieldsCombo.setDisabled(true)}if(fieldSelComboBox!=undefined){fieldSelComboBox.setDisabled(true)}var c=document.getElementsByTagName("input");var h=document.getElementsByTagName("select");var b=document.getElementsByTagName("textarea");var a=[];if(c!=undefined){a.push(c)}if(h!=undefined){a.push(h)}if(b!=undefined){a.push(b)}if(a!=undefined){for(var d=0;d<a.length;++d){var g=a[d];if(g!=undefined){for(var f=0;f<g.length;f++){g[f].disabled=true}}}}}function createSupportingInformation(){Ext.create("Ext.panel.Panel",{layout:{type:"vbox",align:"stretch",pack:"start",split:true,collapsible:true},id:"mainPanel",height:700,width:"auto",items:[{xtype:"panel",layout:"fit",overflowX:"hidden",overflowY:"auto",flex:0.7,border:false,contentEl:"northcontent"},{xtype:"splitter",id:"SplitTab",collapsible:true,collapseTarget:"next",animate:true,width:85,height:10,layout:"stretch"},{xtype:"panel",id:"childPanel",layout:"fit",height:100,flex:0.3,html:'<iframe id= "SIIframeID" src="" style="width:100%;height:100%;display:none;border: none" scrolling="no"></iframe>',title:"",collapsible:true,collapseDirection:"bottom",animCollapse:false,headerPosition:"top",listeners:{resize:function(g,f,b,d,h,e){var c=window.frames.SIIframeID.contentWindow;if(c!=""&&c!=undefined&&c.detailsPanel!=""&&c.detailsPanel!=undefined){if(b<100){c.detailsPanel.setHeight(90)}else{c.detailsPanel.setHeight(b-30)}}}}}],renderTo:"content-div"});var a=Ext.getCmp("childPanel");resizePanels();a.collapse();a.setTitle(labelModelSupportingInformation);refreshSupportingInfo();a.on("expand",resizepanelsexpand,this,{});a.on("collapse",resizepanelscollapse,this,{});a.on("resize",resize,this,{})}function refreshSupportingInfo(){if(copyRecordId!=null&&copyRecordId!=""){Ext.getCmp("childPanel").setDisabled(true)}else{if(recordId!=null&&recordId!=""){Ext.getCmp("childPanel").setDisabled(false);getInfoPane(recordId)}else{Ext.getCmp("childPanel").setDisabled(true)}}}function getInfoPane(d){var b="";var a="/apex/SIContainerPage?oid="+d+"&otype=Model__c&wid=&isInactive=false&filterClause="+b+"&isCIExplorer=true";var c=document.getElementById("SIIframeID");if(c!=undefined){c.style.display="none";c.src=a;c.style.display="block"}}function resizePanels(){var c={};c.width=Ext.getBody().getViewSize().width;c.height=Ext.getBody().getViewSize().height;var b=Ext.getCmp("mainPanel");b.setSize(c.width,c.height);document.getElementById("northcontent").style.width=c.width+"px";if(isChildPanelCollapsed){resizepanelscollapse()}else{resizepanelsexpand()}Ext.getCmp("rf-model-tbar").setWidth(c.width);var a=window.frames.SIIframeID.contentWindow;if(a!=""&&a!=undefined&&a.detailsPanel!=""&&a.detailsPanel!=undefined){a.detailsPanel.setWidth(c.width-23)}Ext.getCmp("gridId").setWidth(c.width-30)}Ext.EventManager.onWindowResize(function(){resizePanels()});function resizepanelsexpand(){isChildPanelCollapsed=false;var a=document.getElementById("childPanel").style.height;childpanelheight=parseInt(a,10);document.getElementById("northcontent").style.height=(Ext.getBody().getViewSize().height-(childpanelheight+65))+"px";Ext.getCmp("gridId").setHeight(110)}function resizepanelscollapse(){isChildPanelCollapsed=true;document.getElementById("northcontent").style.height="100%";Ext.getCmp("gridId").setHeight(ruleGridHt)}function resize(){if(isChildPanelCollapsed){resizepanelscollapse()}else{resizepanelsexpand()}}var NextBtnHandler=function(a,b){if(document.getElementById("nextId").disabled!=true){nextModelBtnHandler()}};var PreviuosBtnHandler=function(a,b){if(document.getElementById("prevId").disabled!=true){previousModeolBtnHandler()}};function nextModelBtnHandler(){var b="";var a=0;while(modelIdSet.length>a){if(b==""){b=modelIdSet[a]}else{b=b+","+modelIdSet[a]}a++}modelString_ele.value=b;nextModelRecordHandler()}function recordNavigationValidation(){if(modelIdSet!=null&&recordId!=null&&recordId!=""){var a=0;Ext.getCmp("nextId").setDisabled(false);Ext.getCmp("prevId").setDisabled(false);document.getElementById("nextId").style.opacity=1;document.getElementById("prevId").style.opacity=1;for(var b=0;modelIdSet.length>b;b++){if(modelIdSet[b]==recordId){a=b}}if(a==0){Ext.getCmp("prevId").setDisabled(true);document.getElementById("prevId").style.opacity=0.3}if(a==(modelIdSet.length-1)){Ext.getCmp("nextId").setDisabled(true);document.getElementById("nextId").style.opacity=0.3}}else{Ext.getCmp("prevId").setDisabled(true);document.getElementById("prevId").style.opacity=0.3;Ext.getCmp("nextId").setDisabled(true);document.getElementById("nextId").style.opacity=0.3}}function previousModeolBtnHandler(){var b="";var a=0;while(modelIdSet.length>a){if(b==""){b=modelIdSet[a]}else{b=b+","+modelIdSet[a]}a++}modelString_ele.value=b;previousModelRecordHandler()}function RefreshWholeModelPage(){loadDataToGrids();getInfoPane(recordId);updateTitle();if(isInactive!=null){Ext.getCmp("idInactive").setValue(isInactive)}recordNavigationValidation()}function showTextEditor(g,f,l,k,d,h,b,c,j){if(h==null||h=="undefined"){h=450}if(b==null||b=="undefined"){b=580}var a=new Ext.form.FormPanel({baseCls:"x-plain",labelWidth:55,layout:{type:"vbox",align:"stretch"},defaults:{xtype:"textfield"},items:[{xtype:"textarea",id:"formTextId",fieldLabel:"Message text",hideLabel:true,border:false,enableKeyEvents:true,name:"msg",flex:1,listeners:{keyup:function(m,n){var o=m.getValue();if(o.length>l){m.setValue(o.substr(0,l))}}}}]});var e=new Ext.Window({title:f,id:"windowId",width:b,height:h,minWidth:300,minHeight:200,layout:"fit",modal:true,plain:true,cls:"TextEditorWindowCls",buttonAlign:"left",items:a,defaultButton:"formTextId",buttons:[{text:k,width:60,cls:"windowBtnCls",handler:function(){if(g!=null&&g!="undefined"){document.getElementById(g).focus();document.getElementById(g).value=Ext.getCmp("formTextId").getValue();if(typeof(c)!="undefined"&&c!=""&&c!=null&&typeof(c)=="function"){c()}}else{if(j!=null&&j!="undefined"){j.focus();j.value=Ext.getCmp("formTextId").getValue()}else{if(approvalComments!=null&&approvalComments!="undefined"){var m=Ext.getCmp("formTextId").getValue();approvalComments(m,c)}}}e.close()}},{text:d,width:60,cls:"windowBtnCls",handler:function(){e.close()}}]});e.show();if(g!=null&&g!="undefined"){Ext.getCmp("formTextId").focus();Ext.getCmp("formTextId").setValue(document.getElementById(g).value)}else{if(j!=null&&j!="undefined"){Ext.getCmp("formTextId").focus();Ext.getCmp("formTextId").setValue(j.value)}}}function handleSave(){window.parent.handleSave(wid,recordId);window.parent.registerSave(wid)}var clickedOnce=false;function handleChange(){if(!clickedOnce){clickedOnce=true;window.parent.registerChange(wid)}}var lookupSelectedValue="";var lookupSelectedId="";var isAutocomplete=false;var currentConsole="model";function getFilterCondition(e,b,d,c,a){if(b=="User"||b=="AllUser"||b=="Account"){return escape("Isactive = true ")}if(typeof(b)!="undefined"&&b!="User"&&b!="Account"&&b.indexOf("__c")<0){return""}}function setDivPosition(d){var c=[d.offsetLeft,d.offsetTop];var b;while(d.offsetParent!=null){var a=d.offsetParent;c[0]+=a.offsetLeft-a.scrollLeft;b=a.offsetTop-a.scrollTop;if(b<0){b=0}c[1]+=b;d=a}return c}function escSpeChars(a){a=replaceAll(a,"\\","?");a=replaceAll(a,"?","\\");a=replaceAll(a,"?","?");a=replaceAll(a,"?","\\?");a=replaceAll(a,"^","?");a=replaceAll(a,"?","\\^");a=replaceAll(a,"$","?");a=replaceAll(a,"?","\\$");a=replaceAll(a,"(","?");a=replaceAll(a,"?","\\(");a=replaceAll(a,")","?");a=replaceAll(a,"?","\\)");a=replaceAll(a,"[","?");a=replaceAll(a,"?","\\[");a=replaceAll(a,"]","?");a=replaceAll(a,"?","\\]");a=replaceAll(a,"{","?");a=replaceAll(a,"?","\\}");a=replaceAll(a,"*","?");a=replaceAll(a,"?","\\*");a=replaceAll(a,"+","?");a=replaceAll(a,"?","\\+");a=replaceAll(a,"|","?");a=replaceAll(a,"?","\\|");return a}function replaceAll(e,c,d){var a=e;var b=a.indexOf(c);while(b!=-1){a=a.replace(c,d);b=a.indexOf(c)}return a}function validateData(){var c="";var f;var b;var d;for(var a in mandatoryFields){f=mandatoryFields[a];b=document.getElementById(a);if(b!=null&&b!="null"){d=f.split(nonPrint);var e=b.value;if(d[1]==""&&e==""){c+=d[0]+", "}}}if(c!=""){c=c.substring(0,c.length-2);c=mandatoryFieldValueValidationMsg+": \n"+c;isErrorMessage=true;isPageMessage=false}else{isPageMessage=true;isErrorMessage=false}return c}function showPageMsg(f){var b=document.getElementById("thpage:modelForm:errorMsg");if(b!=null&&typeof(b)!="undefined"){document.getElementById("thpage:modelForm:errorMsg").style.display="none"}var a=document.getElementById("errorDescId");RemedyForceHTMLProcessor.clearHTML(a);var c=document.createElement("span");c.setAttribute("style","color:#cc0000");var e=document.createElement("h4");RemedyForceHTMLProcessor.setText(e,Errors);c.appendChild(e);a.appendChild(c);var d=document.createTextNode(f);a.appendChild(d);applyMarginToErrorMessage()}function applyMarginToErrorMessage(){if(isErrorMessage){document.getElementById("jsscripterrorId").setAttribute("style","display:block; margin-top :5px !important; margin-bottom : 5px !important;")}if(isPageMessage){document.getElementById("thpage:theForm:errorMsg").setAttribute("style","display:block; margin-top :5px !important; margin-bottom : 5px !important;")}}function addManufacturer(c,a){if(c==orgNamespace+"Manufacturer__c"&&a!=""&&a!=null){var d=-1;for(var b=0;b<gridStore.data.length;b++){if(gridStore.getAt(b).get("operatorFieldAPIName")==orgNamespace+"manufacturername__c"){d=b}}if(d>=0){gridStore.getAt(d).set("operandValue",a)}else{gridStore.insert(0,new CriteriaModel({operandFieldLabel:manufacturerName,operandValue:a,operatorFieldAPIName:orgNamespace+"manufacturername__c",operandFieldType:"Text",lookupFieldID:""}))}}}function clearSelection(){Ext.getCmp("gridId").getSelectionModel().deselectAll();clearRuleCriteria();Ext.getCmp("fieldSelComboBox").setValue(fieldSelComboBox.getStore().getAt(0));assignVisibility("inline","none","none","none","none","none","none",null,1)}function getFilterQueryString(a){}function validateLength(a,b){var c=document.getElementById(a).value;if(c.length>b){document.getElementById(a).value=c.substr(0,b)}}var SyncCIBtnHandler=function(){Ext.Msg.show({title:tooltipSyncCI,msg:modelSyncWarningMsg,minWidth:300,maxWidth:360,minHeight:120,buttons:Ext.Msg.OKCANCEL,icon:Ext.MessageBox.WARNING,fn:function(a){if(a=="ok"){if(recordId!=null&&recordId!=undefined){SyncModelAttributes(recordId)}}else{return}}})};