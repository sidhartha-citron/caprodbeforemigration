var AssessmentId,inactiveChkBox,errormsg,idset,windownameflag=0,startTime=new Date(),networklatencystart="",networklatency="",windowloaddate="",taboutFlag=false;var clickedOnce=false;function handleChange(){if(!clickedOnce){clickedOnce=true;window.parent.registerChange(wid)}}function handleResetChange(){if(clickedOnce){clickedOnce=false;window.parent.registerSave(wid)}}function ShowCIExplorerJS(d,c){var a=escape("CIExplorerLauncher?Module=Change_Request__c&RecordSequence="+ChangeRequestid+"&id="+ChangeRequestid);var b="NavigatorPage?title="+d+"&target="+a;window.parent.parent.addNewTab("CIExplorerLauncher",c,b)}function senddata(){return data}Ext.onReady(function(){windowloaddate=new Date();networklatencystart=windowloaddate.getTime();networklatency=networklatencystart-networkstart;Ext.QuickTips.init();document.getElementById(ChangeAssessmentPageComp.ComponentVars.UserPhone).readOnly=true;document.getElementById(ChangeAssessmentPageComp.ComponentVars.UserExtension).readOnly=true;document.getElementById(ChangeAssessmentPageComp.ComponentVars.AssessmentCompletionDate).readOnly=true;function m(){if(!inProgress){inactiveChkBox=Ext.getCmp("change_assessment_inactive").getValue();var p=document.getElementById(ChangeAssessmentPageComp.ComponentVars.Username);if(p!=null){if(p.value.trim()==""){showMsg("",ChangeAssessmentPage.Labels.AssessorIDError);return}}var n=document.getElementById(ChangeAssessmentPageComp.ComponentVars.BenefitsOfChange).value.trim();var o=document.getElementById(ChangeAssessmentPageComp.ComponentVars.Comments).value.trim();if(o.length>32000){showMsg("",ChangeAssessmentPage.Labels.TextCommentsOverflow);return}if(n.length>255){showMsg("",ChangeAssessmentPage.Labels.TextBenefitsOfChangeOverflow);return}Ext.getCmp("saveId").setDisabled(true);waitbox(0);saveAssessment(inactiveChkBox)}}function c(){callCopyPage()}function d(){resetAssessment()}function g(){if(document.getElementById("prevId").disabled!=true){var o="";var n=0;while(idset.length>n){if(o==""){o=idset[n]}else{o=o+","+idset[n]}n++}previousAssessmentBtnHandler(o)}}function l(){if(document.getElementById("nextId").disabled!=true){var o="";var n=0;while(idset.length>n){if(o==""){o=idset[n]}else{o=o+","+idset[n]}n++}nextAssessmentBtnHandler(o)}}var h=Ext.extend(Ext.Panel,{renderTo:"btnToolbar",defaults:{bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"}});new h({title:"",cls:"toolSpCls",bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;",tbar:[{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:ChangeAssessmentPage.Labels.Save,id:"saveId",listeners:{mouseover:function(){this.setIconClass("bmcSaveOn")},mouseout:function(){this.setIconClass("bmcSave")}},handler:m}," ",{scale:"medium",iconCls:"bmcCopy",tooltipType:"title",tooltip:ChangeAssessmentPage.Labels.Copy,id:"copyId",listeners:{mouseover:function(){this.setIconClass("bmcCopyOn")},mouseout:function(){this.setIconClass("bmcCopy")}},handler:c}," ","-"," ",{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:ChangeAssessmentPage.Labels.Delete,id:"deleteId",listeners:{mouseover:function(){this.setIconClass("bmcDeleteOn")},mouseout:function(){this.setIconClass("bmcDelete")}},handler:DeleteBtnHandler}," ",{scale:"medium",iconCls:"bmcReset",tooltipType:"title",tooltip:ChangeAssessmentPage.Labels.Reset,id:"resetId",listeners:{mouseover:function(){this.setIconClass("bmcResetOn")},mouseout:function(){this.setIconClass("bmcReset")}},handler:d}," ","-"," ",{scale:"medium",iconCls:"bmcCIExplorer",tooltipType:"title",tooltip:ChangeAssessmentPage.Labels.LaunchCIExplorer,id:"CIExpId",listeners:{mouseover:function(){this.setIconClass("bmcCIExplorerOn")},mouseout:function(){this.setIconClass("bmcCIExplorer")}},handler:ShowCIExplorer},new Ext.Toolbar.Fill(),{id:"change_assessment_inactive",xtype:"checkbox",width:93,align:"top",checked:false,cls:"chkStyle",boxLabel:'<span class="checkboxLabelCls">'+ChangeAssessmentPage.Labels.Inactive+"</span>"},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:(getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif"),title:ChangeAssessmentPage.Labels.PreviousRecord},cls:"cursorCls",listeners:{render:function(n){n.el.on("click",g)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:ChangeAssessmentPage.Labels.NextRecord},cls:"cursorSpaceCls",listeners:{render:function(n){n.el.on("click",l)}}}]});new Ext.ToolTip({target:"change_assessment_inactive",anchor:"left",html:ChangeAssessmentPage.Labels.InactiveTooltip});Ext.getCmp("change_assessment_inactive").setValue(getInactiveChkBox());AssessmentId=getChangeAssessmentID();inactiveChkBox=getInactiveChkBox();wid=getWID();if(isRecordDeleted()){Ext.Msg.alert(ChangeAssessmentPage.Labels.Information,ChangeAssessmentPage.Labels.DeletedRecord,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}else{if(getNoRightsToViewEdit()){Ext.Msg.alert("",ChangeAssessmentPage.Labels.MsgNoAccessPerm,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}}var b=1,j=1;document.getElementById(ChangeAssessmentPageComp.ComponentVars.Comments).style.display="none";var a=new Ext.Panel({header:true,id:"infopanel",title:ChangeAssessmentPage.Labels.ChangeInformation,renderTo:"changeAssessmentInfoDiv",height:250,width:"100%",contentEl:"changeAssessmentComponent",labelStyle:"clsRowBlueBgPanel",border:false,collapsible:true,collapsed:false,listeners:{expand:function(n){if(b==0&&j==1){Ext.getCmp("infopanel").setHeight(250);Ext.getCmp("assessmentpanel").setHeight(250);document.getElementById(ChangeAssessmentPageComp.ComponentVars.BenefitsOfChange).style.height=90+"px";document.getElementById(ChangeAssessmentPageComp.ComponentVars.Comments).style.height=90+"px";changeTextareaHeight("75px")}else{if(b==0&&j==0){Ext.getCmp("infopanel").setHeight(480);changeTextareaHeight("315px")}}b=1},collapse:function(n){if(b==1&&j==1){Ext.getCmp("assessmentpanel").setHeight(480);document.getElementById(ChangeAssessmentPageComp.ComponentVars.BenefitsOfChange).style.height=320+"px";document.getElementById(ChangeAssessmentPageComp.ComponentVars.Comments).style.height=320+"px"}b=0}}});var f=new Ext.Panel({header:true,id:"assessmentpanel",title:ChangeAssessmentPage.Labels.ChangeAssessment,renderTo:"changeAssessmentInfoDiv",width:"100%",height:250,contentEl:"assessmentInfo",labelStyle:"clsRowBlueBgPanel",border:false,collapsible:true,collapsed:false,listeners:{expand:function(n){if(b==1&&j==0){Ext.getCmp("assessmentpanel").setHeight(250);Ext.getCmp("infopanel").setHeight(250);document.getElementById(ChangeAssessmentPageComp.ComponentVars.BenefitsOfChange).style.height=90+"px";document.getElementById(ChangeAssessmentPageComp.ComponentVars.Comments).style.height=90+"px";changeTextareaHeight("75px")}else{if(b==0&&j==0){Ext.getCmp("assessmentpanel").setHeight(480);document.getElementById(ChangeAssessmentPageComp.ComponentVars.BenefitsOfChange).style.height=320+"px";document.getElementById(ChangeAssessmentPageComp.ComponentVars.Comments).style.height=320+"px"}}j=1},collapse:function(n){if(b==1&&j==1){Ext.getCmp("infopanel").setHeight(480);changeTextareaHeight("315px")}j=0}}});buttonValidator();checkIDSet();handleElemEvent();var e=new Date();var i=e.getTime();var k=(i-networklatencystart);data+=ChangeAssessmentPage.Labels.PM_netwokLatency;data+=networklatency;data+="<br>";data+=ChangeAssessmentPage.Labels.PM_PageLoad;data+=k});var DeleteBtnHandler=function(a,b){Ext.MessageBox.confirm(ChangeAssessmentPage.Labels.Delete,ChangeAssessmentPage.Labels.DeleteIncidentPage,function(c){if(c==="yes"){deleteChangeAssesmentRecord()}})};function showData(d,c,b,a){if(taboutFlag!=true){if(typeof(c)!="undefined"&&typeof(b)!="undefined"){if(typeof(a)!="undefined"){showalldata(d,c,b,a)}else{showalldata(d,c,b)}}else{if(typeof(c)!="undefined"&&typeof(b)=="undefined"){showalldata(d,c)}else{showalldata(d)}}}else{if(typeof(c)!="undefined"){c()}}}function callCopyPage(){window.parent.addTab("ChangeAssessmentPage?copyId="+AssessmentId,ChangeAssessmentPage.Labels.ChangeAssessment,ChangeAssessmentPage.Labels.ChangeAssessment)}function assignBenefitsOrCommentsValue(a){if(a=="BenefitsOfChange"){document.getElementById(ChangeAssessmentPageComp.ComponentVars.Comments).style.display="none";document.getElementById(ChangeAssessmentPageComp.ComponentVars.BenefitsOfChange).style.display="";document.getElementById("BenefitsOfChange").className="clickedButton";document.getElementById("Comment").className="AddButton"}else{if(a=="Comment"){document.getElementById(ChangeAssessmentPageComp.ComponentVars.BenefitsOfChange).style.display="none";document.getElementById(ChangeAssessmentPageComp.ComponentVars.Comments).style.display="";document.getElementById("BenefitsOfChange").className="AddButton";document.getElementById("Comment").className="clickedButton"}}}function userInfoComplete(){}function showMsg(a,b){Ext.MessageBox.show({width:250,title:a,msg:b,buttons:Ext.MessageBox.OK})}function closeWindow(){window.parent.refreshList();window.parent.closeTab(wid)}function checkIDSet(){if(idset==null||idset==""){if(getIsDirect()==""){if(typeof(window.parent.returnListOfId)=="function"){idset=window.parent.returnListOfId()}}else{if(typeof(window.parent.parent.getIdArray)=="function"){idset=window.parent.parent.getIdArray()}window.parent.handleSave(getWID(),getID())}}}function buttonValidator(){if(AssessmentId==null||AssessmentId==""){Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true);Ext.getCmp("saveId").setDisabled(false);if(getEnableCILinkBtn()){Ext.getCmp("CIExpId").setDisabled(false)}else{Ext.getCmp("CIExpId").setDisabled(true);Ext.getCmp("CIExpId").setIconClass("bmcCIExplorerDisable")}}else{if(getEnableDeleteCopyBtn()){Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconClass("bmcDelete")}else{Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable")}if(getEnableCopyBtn()){Ext.getCmp("copyId").setDisabled(false)}else{Ext.getCmp("copyId").setDisabled(true)}if(getEnableSaveBtn()){Ext.getCmp("saveId").setDisabled(false)}else{Ext.getCmp("saveId").setDisabled(true)}if(getEnableCILinkBtn()){Ext.getCmp("CIExpId").setDisabled(false)}else{Ext.getCmp("CIExpId").setDisabled(true);Ext.getCmp("CIExpId").setIconClass("bmcCIExplorerDisable")}Ext.getCmp("resetId").setDisabled(false);Ext.getCmp("prevId").setDisabled(false);Ext.getCmp("nextId").setDisabled(false)}document.getElementById(ChangeAssessmentPageComp.ComponentVars.AssessmentCompletionDate).readOnly=true}function enableSaveButton(){if(getEnableSaveBtn()){Ext.getCmp("saveId").setDisabled(false)}};