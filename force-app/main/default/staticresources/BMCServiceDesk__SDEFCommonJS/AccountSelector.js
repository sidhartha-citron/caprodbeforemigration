var accLeftStoreData;var accRightStoreData;var leftStore;var rightStore;function radioAllAccounts(){hasAccounts=true;isGridDisabled=true;csvAccountListparam="AllAccounts";var b=Ext.getCmp("abc");b.getEl().mask();var a=Ext.getCmp("paginationToolbar");a.getEl().mask()}function radioSelectedAccounts(){csvAccountListparam="";var b=Ext.getCmp("abc");b.getEl().unmask();var a=Ext.getCmp("paginationToolbar");a.getEl().unmask()}function onSaveClick(){var array=rightStore.data;var listData=[];var param="";var tempArr1="";var tempArr;var resulset;for(i=0;i<array.length;i++){tempArr=new Array(2);tempArr[1]=rightStore.getAt(i).get("elID");param=param+rightStore.getAt(i).get("elID");if(i<array.length-1){param=param+",";tempArr1=tempArr1+"\n"}}if(orgNamespace!=""&&orgNamespace!=null&&orgNamespace!="undefined"&&orgNamespace!="null"){eval(orgNamespace).UpdateAccountBranding.UpdAccountBranding(param,themeid,function(result,event){if(event.status){if(result!=""&&result!=null){resulset=result;Ext.Msg.alert("",resulset[1])}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:true})}else{UpdateAccountBranding.UpdAccountBranding(param,themeid,function(result,event){if(event.status){if(result!=""&&result!=null){resulset=result;Ext.Msg.alert("",resulset[1])}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:true})}}function onOKClick(){if(isLightningAction){var b=document.getElementById("DisplayInSS").checked;if(typeof(csvAccountListparam)!=undefined&&csvAccountListparam.toLowerCase()!="allaccounts"){if(rightStore.data.items.length==0){Ext.MessageBox.show({msg:labelErr1,buttons:Ext.MessageBox.OK})}else{var a=getSelectedAccountIds(rightStore);saveKAInfo(a,b)}}else{saveKAInfo(csvAccountListparam,b)}}else{if((isForAllAccount=="true"&&csvAccountListparam.toLowerCase()=="allaccounts")||(isForKA==true&&csvAccountListparam.toLowerCase()=="allaccounts")){if(getUrlParameter("stdForm")){window.opener.openAccountSelector(rightStore,true);window.close()}else{window.parent.setPopUpVar(rightStore,true)}}else{if(getUrlParameter("stdForm")){if(isForKA==true&&rightStore.data.items.length==0){Ext.MessageBox.show({msg:labelErr1,buttons:Ext.MessageBox.OK})}else{window.opener.openAccountSelector(rightStore);window.close()}}else{window.parent.setPopUpVar(rightStore)}}window.parent.closePopupRF()}}function getSelectedAccountIds(c){var b=c.data;var d="";var a;for(i=0;i<b.length;i++){a=new Array(2);a[0]=c.getAt(i).get("Name");a[1]=c.getAt(i).get("elID");d=d+c.getAt(i).get("elID");if(i<b.length-1){d=d+","}}return d}function onCancelClick(){if(isLightningAction){postMessageToLightningComponent()}else{if(getUrlParameter("stdForm")){window.close()}else{window.parent.closePopupRF()}}}function refreshAccountsList(){var e;var f=document.getElementById("txtSrch").value;e=parseInt(f.length-1);if(f[e]=="*"){f=f.replace("*","");document.getElementById("txtSrch").value=f}if(f==labelSrch){f=""}var c="";var h=0;var b=Ext.getCmp("rightStore").store;while(b.data.length>h){c=c+b.getAt(h).get("elID")+",";h++}var g=false;var a=f;var d=a.length;while(a.charAt(d-1)=="\\"){a=a.substring(0,d-1);d=a.length}getSearchAccounts(a,c,g)}var displayMessageBox=false;function msgbox(d,c,b){var a=Ext.MessageBox.INFO;if(c==null){c=""}if(b==3){a=Ext.MessageBox.QUESTION;if(c==""){c=labelQuestion}}else{if(b==2){a=Ext.MessageBox.WARNING;if(c==""){c=labelWarning}}else{if(b==1){a=Ext.MessageBox.ERROR;if(c==""){c=labelError}}}}if(c==""){c=labelInfo}Ext.MessageBox.show({title:c,msg:d,width:300,buttons:Ext.MessageBox.OK,icon:a})}function loadLeftData(){Ext.getCmp("accBtnPrevId").setDisabled(getPreFirstBtn());Ext.getCmp("accBtnNextId").setDisabled(getNextLastBtn());tempAccLeftStore=new Ext.data.ArrayStore({data:accLeftStoreData,fields:["elID","Name","display"],sortInfo:{field:"Name",direction:"ASC"}});leftStore.removeAll();var a=tempAccLeftStore.getTotalCount();if(a==0){if(displayMessageBox==true){msgbox(labelNoRecord,"",2);resetSearch()}}else{for(var b=0;b<tempAccLeftStore.getTotalCount();b++){leftStore.add(tempAccLeftStore.getAt(b))}}displayMessageBox=false}function isCJKChar(c){var b=/[\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/;var a=b.test(c);return(a)}function blurfun(){checkforsearch=false;var a=document.getElementById("txtSrch").value.trim();if(a.length<2&&!isCJKChar(a)){checkforsearch=true}}function txtSearch(){var e;var f=document.getElementById("txtSrch").value;e=parseInt(f.length-1);if(f[e]=="*"){f=f.replace("*","");document.getElementById("txtSrch").value=f}blurfun();if(checkforsearch){if(isForKA==true){msgbox(labelMinChar,"",2);return}if(f==labelSrch){msgbox(labelMinChar,"",2);return}checkforsearch=false}else{if(f==labelSrch){return}}var c="";var h=0;var b=Ext.getCmp("rightStore").store;while(b.data.length>h){c=c+b.getAt(h).get("elID")+",";h++}displayMessageBox=true;var g=true;var a=f;var d=a.length;while(a.charAt(d-1)=="\\"){a=a.substring(0,d-1);d=a.length}getSearchAccounts(a,c,g)}var PrevBtnHandler=function(c,e){if(document.getElementById("accBtnPrevId").disabled!=true){var b="";var d=0;var a=Ext.getCmp("rightStore").store;while(a.data.length>d){b=b+"'"+a.getAt(d).get("elID")+"',";d++}prevAccounts(b)}};var NextBtnHandler1=function(c,e){if(document.getElementById("accBtnNextId").disabled!=true){var b="";var d=0;var a=Ext.getCmp("rightStore").store;while(a.data.length>d){b=b+"'"+a.getAt(d).get("elID")+"',";d++}nextAccounts(b)}};function resetSearch(){var c="";var b="";var e=0;var a=Ext.getCmp("rightStore").store;while(a.data.length>e){b=b+a.getAt(e).get("elID")+",";e++}var d=true;getSearchAccounts(c,b,d);document.getElementById("txtSrch").value=labelSrch}Ext.onReady(function(){var c=new Ext.Toolbar({renderTo:"toolbar",cls:"toolSpCls",id:"paginationToolbar",bodyStyle:"padding-left:15px;padding-bottom:10px;width:200px;",items:[{scale:"medium",xtype:"textfield",tooltipType:"title",emptyText:labelSrch,flex:3,id:"txtSrch",listeners:{specialkey:function(f,d){if(d.getKey()==d.ENTER){if(d.preventDefault()){d.preventDefault()}else{d.returnValue=false}txtSearch()}}}},"",{iconCls:"bmcSearch",tooltip:labelSrch,tooltipType:"title",flex:1,id:"searchBtn",handler:txtSearch},{scale:"medium",iconCls:"bmcResetOn",tooltip:labelRefresh,tooltipType:"title",flex:1,id:"accBtnResetId",handler:resetSearch},"->",{xtype:"box",flex:1,id:"accBtnPrevId",disabled:getPreFirstBtn(),autoEl:{tag:"img",src:(getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif"),title:labelPrevious},cls:"cursorCls",listeners:{render:function(d){d.el.on("click",PrevBtnHandler)}}},{xtype:"box",flex:1,id:"accBtnNextId",disabled:getNextLastBtn(),autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:labelNext},cls:"cursorSpaceCls",listeners:{render:function(d){d.el.on("click",NextBtnHandler1)}}}]});leftStore=new Ext.data.ArrayStore({data:accLeftStoreData,fields:["elID","Name","display"],sortInfo:{field:"Name",direction:"ASC"}});rightStore=new Ext.data.ArrayStore({data:accRightStoreData,fields:["elID","Name","display"]});var b={id:"abc",xtype:"itemselector",name:"itemselector",fieldLabel:"",iconLeft:"b_darrow_L_disable_custom.gif",iconRight:"b_darrow_R_disable_custom.gif",imagePath:getSDFStylesResPath()+"/SDEFbuttons/",drawTopIcon:false,drawBotIcon:false,drawUpIcon:false,drawDownIcon:false,width:490,listeners:{change:function(){var d=Ext.getCmp("leftStore").getValue();var e=Ext.getCmp("rightStore").getValue();if(d!=null&&d!=undefined&&e==""){var f=d.length;if(f=="0"){refreshAccountsList()}}else{if(e!=null&&e!=undefined&&d==""){var g=e.length;if(g=="0"){refreshAccountsList()}}}}},multiselects:[{id:"leftStore",width:202,height:isLightningAction?300:400,draggable:false,droppable:false,store:leftStore,displayField:"display",valueField:"elID",multiSelect:true,legend:false,listeners:{render:function(d){new Ext.ToolTip({target:d.el,renderTo:document.body,delegate:"dl",trackMouse:true,anchor:"right",listeners:{beforeshow:function(e){var f=d.view.getRecord(e.triggerElement);e.body.dom.textContent=f.get("Name")}}})},click:function(h){if(isForKA){Ext.getCmp("rightStore").setValue("");var d=Ext.getCmp("rightStore").store;var f=Ext.getCmp("leftStore").getValue();var e,g=0;if(f.indexOf(",")>0){e=f.split(",")}if(e!=undefined&&e!="undefined"&&e!=null){selectionLength=e.length;g=d.data.length+selectionLength}if(g<=100&&d.data.length<100){document.getElementById("iconRightId").src=getSDFStylesResPath()+"/SDEFbuttons/b_darrow_R_new.gif"}else{document.getElementById("iconRightId").src=getSDFStylesResPath()+"/SDEFbuttons/b_darrow_R_disable_custom.gif";msgbox(LinkMaximum100Accounts,"",2)}}else{document.getElementById("iconRightId").src=getSDFStylesResPath()+"/SDEFbuttons/b_darrow_R_new.gif"}if(this.view.getSelectedIndexes().length==0){document.getElementById("iconLeftId").src=getSDFStylesResPath()+"/SDEFbuttons/b_darrow_L_disable_custom.gif"}}}},{id:"rightStore",width:202,height:isLightningAction?300:400,draggable:false,droppable:false,store:rightStore,displayField:"display",valueField:"elID",multiSelect:true,legend:false,listeners:{render:function(d){new Ext.ToolTip({target:d.el,renderTo:document.body,delegate:"dl",trackMouse:true,anchor:"right",listeners:{beforeshow:function(e){var f=d.view.getRecord(e.triggerElement);e.body.dom.textContent=f.get("Name")}}})},click:function(d){Ext.getCmp("leftStore").setValue("");if(this.view.getSelectedIndexes().length==0){document.getElementById("iconRightId").src=getSDFStylesResPath()+"/SDEFbuttons/b_darrow_R_disable_custom.gif"}document.getElementById("iconLeftId").src=getSDFStylesResPath()+"/SDEFbuttons/b_darrow_L_new.gif"}}}]};var a=new Ext.Panel({items:[b],border:false,unstyled:true,height:"auto",layout:"fit",renderTo:"listView"});if(isLightningAction){if(selectedAccountsForKA==null||selectedAccountsForKA==""||selectedAccountsForKA=="all accounts"){document.getElementById("selectRadio:0").checked=true;radioAllAccounts()}else{document.getElementById("selectRadio:1").checked=true;radioSelectedAccounts()}}else{if(isForAllAccount=="true"){if(window.parent.csvAccountListparam==null||window.parent.csvAccountListparam==""||window.parent.csvAccountListparam.toLowerCase()=="allaccounts"){document.getElementById("selectRadio:0").checked=true;radioAllAccounts()}else{document.getElementById("selectRadio:1").checked=true;radioSelectedAccounts()}}else{if(isForKA==true){if(window.opener.csvAccountListparam==null||window.opener.csvAccountListparam==""||window.opener.csvAccountListparam.toLowerCase()=="all accounts"){document.getElementById("selectRadio:0").checked=true;radioAllAccounts()}else{document.getElementById("selectRadio:1").checked=true;radioSelectedAccounts()}}}}});function postMessageToLightningComponent(){if(isLightningAction){var a={data:"com.remedyforce.closelightningaction",vfHost:window.location.origin};console.log("article updated - sending message to component");parent.postMessage(a,"*")}};