var fldData="[]",offeringClause,fkService,flag,selectedLabel,selectedApiName,listData,isInList=false,selectedTextAreaLength=0,disableMilestoneTab,popUpString="",popUpEnable=false,isCustomPage=true,compTypeNo=0,fieldsComboStore,fieldsEditor,pickListArray=new Array(),pickListComboStore,pickListComboBx,booleanComboStore,booleanComboBx,booleanArray=[["True","True"],["False","False"]],labelField,labelOperator,comparisonOperator,daysSpinner,hoursSpinner,minutesSpinner,businessDaysSpinner,isInBusinessDays,startOpComboBx,pasueOpComboBx,stopOpComboBx,moduleName,DZHE,EF,referenceId,referenceName,startClockGrid,startClockStore,listDataForStartClockGrid=new Array(),pauseClockGrid,pauseClockStore,listDataForPasueClockGrid=new Array(),stopClockGrid,stopClockStore,listDataForStopClockGrid=new Array(),idset,logicalOperator,qualificationGridStore,QualificationGrid,mutualExcWhereClause="",filterClauseforStopClock="",startlogOpComboBx,pauselogOpComboBx,stoplogOpComboBx,logOpeStore,sltId,selectedRowIndexStart,selectedRowIndexPause,selectedRowIndexStop,milestonetore,milestoneGrid,actionStore,actionGrid,JsonMilestone,JsonAction,selectedRowMilestone,selectedRowAction,milestoneToolbar,actionToolbar,isCopied=false,qualificationOrderIndex=1,serviceTargetWindow,clickedOnce=false,isMilestoneCreatable,isMilestoneDeletable,isMilestoneActionDeletable,isMilestoneUpdateble;isUpdateble=true;ciLookup="";var compStore=new Object();function getServiceId(){if(window.parent.getServiceId!=null&&typeof(window.parent.getServiceId)=="function"){fkService=window.parent.getServiceId();if(fkService!=null&&fkService!=""){OfferingClause=escape("(serviceType__c = 'Offering') And (FKBusinessService__c ='"+fkService+"')")}}}function handleModuleChange(a){populateTargetTypeFields(a.value)}var SaveBtnHandler=function(e,a){Ext.getCmp("saveId").setDisabled(true);if(validateCriteria()){Ext.getCmp("saveId").setDisabled(false);return}setConditionsData();if(validateBlankCondition()){Ext.getCmp("saveId").setDisabled(false);return}var k=Ext.getCmp("st_inactive__c").getValue();var h="";var g="";var d=grid.getSelectionModel().getSelections();for(var c=0;c<d.length;c++){var f=d[c];h+=","+f.get("Id")}if(h!=""){h=h.substring(1)}var b=grid_staff.getSelectionModel().getSelections();for(var c=0;c<b.length;c++){var j=b[c];g+=","+j.get("Id")}if(g!=""){g=g.substring(1)}save(k,h,g,defQID)};function checkIDSet(){if(idset==null||idset==""){if(typeof(window.parent.frames.SLTframe.returnListOfId)=="function"){idset=window.parent.frames.SLTframe.returnListOfId()}}}var ResetBtnHandler=function(b,c){var a=window.location.href;if(a.indexOf("&id=")==-1&&a.indexOf("?id=")==-1&&Id!=null&&Id!=""){a=a+"&id="+Id}window.location.replace(a)};var PreviuosBtnHandler=function(a,b){if(document.getElementById("prevId").disabled!=true){previousSLTBtnHandler()}};var NextBtnHandler=function(a,b){if(document.getElementById("nextId").disabled!=true){nextSLTBtnHandler()}};function previousSLTBtnHandler(){var b="";var a=0;while(idset.length>a){if(b==""){b=idset[a]}else{b=b+","+idset[a]}a++}previousSLT(b)}function nextSLTBtnHandler(){var b="";var a=0;while(idset.length>a){if(b==""){b=idset[a]}else{b=b+","+idset[a]}a++}nextSLT(b)}function setConditionsData(){var e="";var c="";var b="";var d="";var f=0;while(qualificationGridStore.data.length>f){e=e+qualificationGridStore.getAt(f).get("orderIndex")+nonPrint+qualificationGridStore.getAt(f).get("operatorFieldAPIName")+nonPrint+qualificationGridStore.getAt(f).get("operatorValue")+nonPrint+Ext.util.Format.htmlDecode(qualificationGridStore.getAt(f).get("operandValue"))+nonPrint+qualificationGridStore.getAt(f).get("operandFieldType")+nonPrint+qualificationGridStore.getAt(f).get("groupingOperator")+nonPrint+qualificationGridStore.getAt(f).get("qualId")+PE;f++}var a=getApplySTStrEle();a.value=e}Ext.onReady(function(){var b=new Ext.Toolbar({renderTo:"toolBar",cls:"toolSpCls",id:"SLToolbar",items:[{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:SuggestedOwnerMappingCriteriaPage.Labels.Save,id:"saveId",handler:SaveBtnHandler},"",{scale:"medium",iconCls:"bmcResetOn",tooltipType:"title",tooltip:SuggestedOwnerMappingCriteriaPage.Labels.Reset,id:"resetId",handler:ResetBtnHandler},"->",{id:"st_inactive__c",xtype:"checkbox",width:93,color:"#004376",align:"top",checked:inActive,boxLabel:'<span class="checkboxLabelCls" style="font-family: Tahoma, MS Sans Serif;font-size: 11px;">'+SuggestedOwnerMappingCriteriaPage.Labels.Inactive+"</span>",autoCreate:{tag:"input",type:"checkbox",title:SuggestedOwnerMappingCriteriaPage.Labels.Inactive}}]});logOpeStore=new Ext.data.SimpleStore({id:"logOpeStore",data:[["AND",labelAND],["OR",labelOR],["NONE",labelNONE]],fields:["logOpeValue","logOpeName"]});logicalOperator=new Ext.form.ComboBox({id:"logicalOperatorCombo",store:logOpeStore,mode:"local",triggerAction:"all",valueField:"logOpeValue",displayField:"logOpeName",selectOnFocus:true,renderTo:"qualLogicalOperatorCombo",editable:false,width:130,listWidth:130,height:13,emptyText:labelLogicalOperator});compStore.text=[["=","="],["!=","!="],["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];compStore.phone=[["=","="],["!=","!="]];compStore.currency=[["=","="],["!=","!="]];compStore.percent=[[">",">"],[">=",">="],["=","="],["!=","!="],["<","<"],["<=","<="]];compStore.number=[[">",">"],[">=",">="],["=","="],["!=","!="],["<","<"],["<=","<="]];compStore.booleanVar=[["=","="],["!=","!="]];compStore.email=[["=","="],["!=","!="],["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];compStore.reference=[["=","="],["!=","!="]];compStore.dateTime=[[">",">"],[">=",">="],["=","="],["!=","!="],["<","<"],["<=","<="]];compStore.textArea=[["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];compStore.picklist=[["=","="],["!=","!="],["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];comparisonOperator=new Ext.form.ComboBox({id:"compareOpCombo",store:compStore.text,mode:"local",triggerAction:"all",renderTo:"compareOpDiv",valueField:"comOpeValue",displayField:"comOpeName",editable:false,width:120,listWidth:120,height:13,proxy:new Ext.data.MemoryProxy(compStore),emptyText:labelOperator});fieldsComboStore=new Ext.data.JsonStore({id:"fieldsStore",data:fldData,proxy:new Ext.data.MemoryProxy(fldData),fields:["id","type","label","e"],sortInfo:{field:"label",direction:"ASC"}});fieldsEditor=new Ext.form.ComboBox({id:"fieldsCombo",store:fieldsComboStore,mode:"local",triggerAction:"all",valueField:"id",displayField:"label",renderTo:"extFieldList",editable:false,listWidth:270,width:270,height:13,emptyText:labelField,listeners:{select:function(k,j,g){comparisonOperator.store.removeAll();var d=j.get("type");if(d.indexOf(":")>0){d=d.split(":")[0]}else{if(d.indexOf(EF)>0){d=d.split(EF)[0]}}var e=this.store.getAt(g).get("id");var f=this.store.getAt(g).get("label");var h=this.store.getAt(g).get("type");setComparisonOperatorStore(d);setAddUpdateOnClick(null);setVisibilityData(e,f,h)}}});pickListComboStore=new Ext.data.ArrayStore({id:"pickListFieldStore",data:pickListArray,fields:["id","val"],sortInfo:{field:"val",direction:"ASC"}});pickListComboBx=new Ext.form.ComboBox({id:"pickListFieldCombo",store:pickListComboStore,mode:"local",triggerAction:"all",valueField:"id",displayField:"val",selectOnFocus:true,editable:false,renderTo:"picklistCombo",hidden:true,width:150,listWidth:150});booleanComboStore=new Ext.data.ArrayStore({id:"booleanFieldStore",data:booleanArray,fields:["id","val"]});booleanComboBx=new Ext.form.ComboBox({id:"booleanFieldCombo",store:booleanComboStore,mode:"local",triggerAction:"all",valueField:"id",displayField:"val",selectOnFocus:true,editable:false,renderTo:"booleanCombo",hidden:true,width:150,listWidth:150});var a=new Ext.grid.ColumnModel({header:true,columns:[{dataIndex:"orderIndex",header:SuggestedOwnerMappingCriteriaPage.Labels.servicetargetOrder,sortable:false,width:50},{dataIndex:"operandFieldLabel",header:SuggestedOwnerMappingCriteriaPage.Labels.FieldName,sortable:false,width:175},{dataIndex:"operatorValue",header:SuggestedOwnerMappingCriteriaPage.Labels.serviceTargetOperator,sortable:false,width:80},{dataIndex:"operandValue",header:SuggestedOwnerMappingCriteriaPage.Labels.operandValue,sortable:false,width:190},{dataIndex:"groupingOperator",header:SuggestedOwnerMappingCriteriaPage.Labels.LogicalOperator,sortable:false,width:80},{dataIndex:"operatorFieldAPIName",hidden:true},{dataIndex:"operandFieldType",hidden:true},{dataIndex:"qualId",hidden:true}]});qualificationGridStore=new Ext.data.SimpleStore({fields:["orderIndex","operandFieldLabel","operatorValue","operandValue","groupingOperator","operatorFieldAPIName","operandFieldType","qualId"]});var c=window.parent.naviframe1.SLTframe.grid.getWidth();QualificationGrid=new Ext.grid.GridPanel({id:"qualificationCriteriaGrid",store:qualificationGridStore,cm:a,columnLines:true,enableHdMenu:false,enableColumnResize:false,enableColumnMove:false,width:c-20,height:220,border:false,stripeRows:true,viewConfig:{forceFit:true,scrollOffset:0},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),listeners:{rowClick:function(d,g,f){setInputDataAndElementsOnRowClick(g)}}});QualificationGrid.render("qualificationGridDiv");loadDataToGrids();if(isRecDeleted){Ext.Msg.alert(SuggestedOwnerMappingCriteriaPage.Labels.Information,SuggestedOwnerMappingCriteriaPage.Labels.DeletedRecord,function(){var d=window.parent.Ext.getCmp("popupWindowId1");if((typeof(d)!="undefined")&&(typeof(d)!="undefined")){d.close()}})}handleElemEvent();if(strMappingID==null||strMappingID==""){Ext.getCmp("resetId").setDisabled(true)}});function EnableAddRemovebtns(){var b=Ext.getCmp("btnRemove");var a=Ext.getCmp("btnEdit");if(milestonetore.data.length<=0){b.setDisabled(true);b.setIconClass("bmcDeleteSLTDisable");a.setDisabled(true);a.setIconClass("bmcEditSLTDisable")}else{b.setDisabled(false);b.setIconClass("bmcDeleteSLT");a.setDisabled(false);a.setIconClass("bmcEditSLT");flag=true}}function disableDeletebtn(){var a=Ext.getCmp("btnRemoveAct");a.setDisabled(true);a.setIconClass("bmcDeleteSLTDisable")}function getWaitbox(){var a=new Ext.Window({id:"waitMsggId",height:100,width:200,resizable:false,closable:false,header:false,frame:false,shadow:false,modal:true,items:[{xtype:"panel",height:100,modal:false,width:200,bodyStyle:"background-color:transparent;border:none;",html:'<div align="center"><img src="'+extJsResource+'/resources/images/default/shared/blue-loading.gif"/></div>'}]})}function showWaitbox(){if(Ext.getCmp("waitMsggId")!=null){Ext.getCmp("waitMsggId").show()}}function hideWaitbox(){if(Ext.getCmp("waitMsggId")!=null){Ext.getCmp("waitMsggId").hide()}}function disableMilestoneAndActionTab(){var a=document.getElementById("milestones_actions_id");if(a!=null){if(disableMilestoneTab){document.getElementById("milestones_actions_id").style.color="#808080";a.disabled=true}else{a.disabled=false;document.getElementById("milestones_actions_id").style.color="#004376"}}}function getMiletoneToolbar(){milestoneToolbar=new Ext.Toolbar({id:"milestoneToolbarId",cls:"toolSpCls",items:[{scale:"medium",iconCls:"bmcNewSLT",tooltipType:"title",tooltip:SuggestedOwnerMappingCriteriaPage.Labels.labelAdd,id:"btnAdd",handler:function(){window.parent.openPopupWithTitle("SLAMilestonePage?appliesToId="+escape(appliesTo)+"&SLTId="+escape(sltId),reloadMilestones,labelMilestoneandActionsTitle+" - "+SLTTitle,490,720,false)}},{scale:"medium",iconCls:"bmcEditSLT",tooltipType:"title",tooltip:SuggestedOwnerMappingCriteriaPage.Labels.labelEdit,id:"btnEdit",handler:function(){window.parent.openPopupWithTitle("SLAMilestonePage?appliesToId="+escape(appliesTo)+"&SLTId="+escape(sltId)+"&Id="+getcurrSelectedMilestoneID().value,reloadMilestones,labelMilestoneandActionsTitle+" - "+SLTTitle,490,720)}},{scale:"medium",iconCls:"bmcDeleteSLT",tooltipType:"title",tooltip:SuggestedOwnerMappingCriteriaPage.Labels.labelDelete,id:"btnRemove",handler:ConfrimDeleteMilestone}]});milestoneToolbar.render("milestoneToolbardiv")}function getActionToolbar(){actionToolbar=new Ext.Toolbar({cls:"toolSpCls",id:"actionToolBarId",items:[{xtype:"button",scale:"medium",iconCls:"bmcDeleteSLTDisable",tooltipType:"title",tooltip:SuggestedOwnerMappingCriteriaPage.Labels.labelDelete,id:"btnRemoveAct",handler:ConfrimDeleteAction}]});actionToolbar.render("actionToolbardiv")}function renderTooltip(e,b,a,f,d,c){b.attr='title="'+e+'"';return e}function addToolTip(e,a,b,f,d,c){a.attr='title="'+Ext.util.Format.htmlEncode(b.data.Action)+'"';return e}function setAddOrUpdateButton(c){var a=QualificationGrid.store.getCount();for(var e=0;e<a;e++){var g=QualificationGrid.store.getAt(e);var d=g.get("operatorFieldAPIName");if(d==c){QualificationGrid.getSelectionModel().selectRow(e,false,false);var f=QualificationGrid.getSelectionModel().getSelected();setAddUpdateOnClick(true);return f}}var b;setAddUpdateOnClick(b);return b}function getRemoveBtnEle(){return document.getElementById("removeButtonId")}function setVisibilityData(b,c,f,a,e,d){ciLookup=b;isInList=false;var g=fldData.length;selectedApiName=b;selectedLabel=c;if(isInList==false){if(f.indexOf(":")>0){selectedTextAreaLength=f.split(":")[1];f=f.split(":")[0]}else{if(f.indexOf(EF)>0){popUpString=f.split(EF)[1];f=f.split(EF)[0]}}if(f=="text"){assignVisibility("inline","none","none","none","none","none","none",null,1,a)}else{if(f=="phone"){assignVisibility("inline","none","none","none","none","none","none",null,10,a)}else{if(f=="currency"){assignVisibility("inline","none","none","none","none","none","none",null,11,a)}else{if(f=="percent"){assignVisibility("inline","none","none","none","none","none","none",null,9,a)}else{if(f=="email"){assignVisibility("inline","none","none","none","none","none","none",null,8,a)}else{if(f=="number"){assignVisibility("inline","none","none","none","none","none","none",null,7,a)}else{if(f=="boolean"){assignVisibility("none","none","none","inline","none","none","none",null,2,a)}else{if(f=="textarea"){assignVisibility("none","inline","none","none","none","none","none",null,3,a)}else{if(f=="picklist"){setPickListOptions(selectedApiName);assignVisibility("none","none","none","none","inline","none","none",null,4,a)}else{if(f=="reference"){assignVisibility("inline","none","inline","none","none","none","none",b,5,a)}else{if(f=="reference1"){assignVisibility("inline","none","inline1","none","none","none","none",b,6,a)}else{if(f=="datetime"){assignVisibility("none","none","none","none","none","inline","none",null,12,a)}else{if(f=="date"){assignVisibility("none","none","none","none","none","none","inline",null,13,a)}}}}}}}}}}}}}setAddUpdateOnClick(a)}setComparisonOperatorStore(f);if(e!=null&&e!="undefined"){comparisonOperator.setValue(e)}if(d!=null&&d!="undefined"){logicalOperator.setValue(d)}}function setAddUpdateOnClick(a){if(a!=null&&a!="undefined"){getUpdateBtnEle().style.display="inline";getUpdateBtnEle().style.visibility="visible";getAddBtnEle().style.display="none";getAddBtnEle().style.visibility="hidden";getRemoveBtnEle().disabled=false;getRemoveBtnEle().src=getSDFStylesResPath()+"/SDEFbuttons/b_remove.png"}else{getUpdateBtnEle().style.display="none";getUpdateBtnEle().style.visibility="hidden";getAddBtnEle().style.display="inline";getAddBtnEle().style.visibility="visible";getRemoveBtnEle().disabled=true;getRemoveBtnEle().src=getSDFStylesResPath()+"/SDEFbuttons/b_remove_disabled.png"}}function assignVisibility(h,q,n,l,d,b,r,c,m,g){var e=getInputTxtEle();var s=getInputTextAreaEle();var f=getDateTimeInputEle();var k=getDateTimePickerImg();var o=getDateInputEle();var p=getDatePickerImg();var t=getLookupEle();var a=Ext.getCmp("booleanFieldCombo");var j=document.getElementById("inputTxtAreaButtonEle");var u=Ext.getCmp("pickListFieldCombo");if(e!=null&&typeof(e)!="undefined"){e.style.display=h;if(h=="inline"&&g!=null&&g!="undefined"){e.value=g}else{e.value=""}e.disabled=false}if(s!=null&&typeof(s)!="undefined"){s.style.display=q;if(j!=null&&typeof(j)!="undefined"){if(q=="inline"){j.style.display="block"}else{j.style.display="none"}if(q=="inline"&&g!=null&&g!="undefined"){s.value=g}else{s.value=""}}}if(f!=null&&typeof(f)!="undefined"){f.style.display=b;if(k!=null&&typeof(k)!="undefined"){k.style.display=b}if(b=="inline"&&g!=null&&g!="undefined"){f.value=g}else{f.value=""}}if(o!=null&&typeof(o)!="undefined"){o.style.display=r;if(p!=null&&typeof(p)!="undefined"){p.style.display=r}if(r=="inline"&&g!=null&&g!="undefined"){o.value=g}else{o.value=""}}if(a!=null&&typeof(a)!="undefined"){if(l=="inline"){a.setVisible(true)}else{a.hide()}if(l=="inline"&&g!=null&&g!="undefined"){a.setValue(g)}else{a.value=""}}if(u!=null&&typeof(u)!="undefined"){if(d=="inline"){u.setVisible(true)}else{u.hide();u.reset()}if(d=="inline"&&g!=null&&g!="undefined"){setPickListOptions(selectedApiName);u.setValue(g)}else{u.value=""}}if(n=="inline"){if(t!=null&&typeof(t)!="undefined"){t.disabled=false;t.style.visibility="visible";t.style.display="inline"}if(g!=null&&g!="undefined"){e.disabled=g}e.disabled=true;popUpEnable=true}else{if(t!=null&&typeof(t)!="undefined"){t.style.visibility="hidden";t.style.display="none";t.disabled=true}}if(n=="inline1"){t.style.display="none";e.disabled=true;e.value="";popUpEnable=true}compTypeNo=m}function displayTabPanel(c){var a=new Array(4);a[0]={btnId:"Service_target_Id",textAreaCompId:"serviceTargetPanel"};a[1]={btnId:"qualification_id",textAreaCompId:"qualificationPanel"};a[2]={btnId:"measurement_id",textAreaCompId:"measurementPanel"};a[3]={btnId:"milestones_actions_id",textAreaCompId:"milestoneActionPanel"};activeBtnId=c.id;for(var b=0;b<a.length;b++){if(activeBtnId==a[b].btnId){document.getElementById(a[b].btnId).style.fontWeight="bold";document.getElementById(a[b].textAreaCompId).style.display="block"}else{document.getElementById(a[b].btnId).style.fontWeight="normal";document.getElementById(a[b].textAreaCompId).style.display="none"}}QualificationGrid.getView().refresh();startClockGrid.getView().refresh()}function getPickListOptions(b){for(var c=0;c<fldData.length;c++){var a=fldData[c];var f=a.e.split(EF);var d=f[0];if(d==b){var e=f[1].split(DZHE);return e}}return null}function setPickListOptions(b){var c=Ext.getCmp("pickListFieldCombo");if(c!=null){var d=getPickListOptions(b);pickListArray=new Array();for(var a=0;a<d.length;a++){if(d[a]!=""){pickListArray[a]=[d[a],d[a]]}}pickListComboStore.removeAll();pickListComboStore.loadData(pickListArray);pickListComboBx.setVisible(true)}}function populateQualFieldsData(){fieldsComboStore.removeAll();fieldsComboStore.loadData(fldData);assignVisibility("inline","none","none","none","none","none","none",null,1);fieldsEditor.reset();pickListComboBx.reset();booleanComboBx.reset();comparisonOperator.reset();loadDataToGrids();hideStopClockPanel()}if(typeof(SDEDateFormat)=="undefined"||SDEDateFormat==null||SDEDateFormat==""){this.SDEDateFormat="m/d/Y h:i A"}Date.useStrict=true;var dataModifiedFlag=0;var cdateFormat="";function getDataModifiedFlag(){return dataModifiedFlag}function setDataModifiedFlag(){dataModifiedFlag=0}QualDatePickerPopup=function(){};QualDatePickerPopup.prototype={dateFormat:SDEDateFormat,selectHandler:function(e,d){this.TextField.dom.value=d.format(e.format);var a=this.TextField.dom.id;if(a.indexOf("inputDate")>0){var b=document.getElementById(a).value;var c=b.split(" ");cdateFormat=c[1];this.TextField.dom.value=c[0].replace(",","")}dataModifiedFlag=1;this.TextField=null;e.hide();e.winHandle.close()},Show:function(b){this.TextField=Ext.get(b);var g=new Ext.DatePicker({startDay:1,listeners:{select:this.selectHandler.createDelegate(this)}});try{var c=Date.parseDate(this.TextField.dom.value,this.dateFormat);g.setValue(c)}catch(f){}var a=this.TextField.getRegion();var d=new Ext.Window({x:a.right-180,y:a.top-110,cls:"CMDBWindow",animCollapse:true,header:true,modal:true,autoHeight:true,width:177,layout:"fit",frame:false,closable:false});d.add(g);g.winHandle=d;d.show()}};var _datePicker=new QualDatePickerPopup();function changedateformat(){if(document.getElementById("{!$Component.custominputDate}")){var a=document.getElementById("{!$Component.inputDate}").value;var b=a.split(" ");document.getElementById("{!$Component.inputDate}").value=b[0]}}function openQualLookup(){if(popUpString=="BMC BaseElement"){popUpString="BMC_BaseElement"}else{if(popUpString=="User"||popUpString=="Group"){openPopupRF("SearchPage?popupId=Client&isQueurorUser=true&isLookup=true&idNameForPopUp=true",setReferenceToVal,450,600,true)}else{if(popUpString=="SYSTemplate__c"){openPopupRF("SearchPage?popupId=SYSTemplate__c&isLookup=true&idNameForPopUp=true&referenceObjectName=SYSTemplate__c&filterClause="+escape("templateFor__c='Incident'"),setReferenceToVal,450,600,true)}else{if(popUpString=="BMC_BaseElement__c"){if(ciLookup=="fkbusinessservice__c"||ciLookup=="fkserviceoffering__c"){if(ciLookup=="fkbusinessservice__c"){if(isFlattenedCmdb){OfferingClause=escape("(serviceType__c != 'Offering') AND (MarkAsDeleted__c = false)")}else{OfferingClause=escape("(serviceType__c != 'Offering') AND (FKBMC_BaseElement__r.MarkAsDeleted__c = false)")}}else{if(ciLookup=="fkserviceoffering__c"){if(isFlattenedCmdb){OfferingClause=escape("(serviceType__c = 'Offering') AND (MarkAsDeleted__c = false)")}else{OfferingClause=escape("(serviceType__c = 'Offering') AND (FKBMC_BaseElement__r.MarkAsDeleted__c = false)")}}}openPopupRF("SearchPage?popupId=BMC_BusinessService__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BusinessService__c&filterClause="+OfferingClause,setReferenceToVal,450,600,true)}else{if(ciLookup=="fkbmc_baseelement__c"){OfferingClause=escape("(MarkAsDeleted__c = false)");openPopupRF("SearchPage?popupId=BMC_BaseElement__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BaseElement__c&filterClause="+OfferingClause,setReferenceToVal,450,600,true)}else{openPopupRF("SearchPage?popupId=BMC_BaseElement__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BaseElement__c",setReferenceToVal,450,600,true)}}}else{if(popUpString=="ConsoleLayoutDetail__c"){openPopupRF("SearchPage?popupId="+popUpString+"&isLookup=true&idNameForPopUp=true&referenceObjectName="+popUpString+"&templateFor=Incident",setReferenceToVal,450,700,true)}else{openPopupRF("SearchPage?popupId="+popUpString+"&isLookup=true&idNameForPopUp=true&referenceObjectName="+popUpString,setReferenceToVal,450,700,true)}}}}}}function setReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}referenceName=decodeVal(referenceName);var a=getInputTxtEle();if(a!=null&&typeof(a)!="undefined"){a.value=referenceName;var c=document.getElementById("referenceID");if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function decodeVal(a){a=a.replace("&gt;",">","g");a=a.replace("&lt;","<","g");a=a.replace("&quot;",'"',"g");a=a.replace("&amp;","&","g");return a}function padNumberToTwodigit(a){return(a<10?"0":"")+a}function getDuration(){var e=padNumberToTwodigit(daysSpinner.getValue()),a=padNumberToTwodigit(hoursSpinner.getValue()),b=padNumberToTwodigit(minutesSpinner.getValue()),c=padNumberToTwodigit(businessDaysSpinner.getValue());var d=e+" "+SuggestedOwnerMappingCriteriaPage.Labels.Days+" "+a+":"+b+" "+SuggestedOwnerMappingCriteriaPage.Labels.HHMM;if(isInBusinessDays){d=c+" "+SuggestedOwnerMappingCriteriaPage.Labels.BusinessDays}return d}function setCatData(e,a,d){var b=getInputTxtEle();b.value=a;var c=document.getElementById("referenceID");c.value=e}function setDescriptionNext(){}function setResolutionNext(){}function addSLTQData(){addUpdateSLTQData()}function addUpdateSLTQData(g){var h;if(g==null||g=="undefined"||typeof(g)=="undefined"){h=new Ext.data.Record();h.set("orderIndex",qualificationOrderIndex)}else{h=g}var c=fetchQualificationComboFieldLabel();if(c!=null&&c!=""&&c!="undefined"){var e=c.get("label");if(e!=null&&e!=""&&e!="undefined"){h.set("operandFieldLabel",e);h.set("operatorFieldAPIName",c.get("id"));var a=c.get("type");if(a!=null&&a.indexOf(":")>0){a=a.split(":")[0]}h.set("operandFieldType",a)}}else{showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.SelectFieldErrMsg);return}var d=comparisonOperator.getValue();if(d!=null&&d!=""&&d!="undefined"){h.set("operatorValue",d)}else{showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.SelectCmpOpMsg);return}var f=logicalOperator.getValue();if(f!=null&&f!=""&&f!="undefined"){h.set("groupingOperator",f)}else{showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.SelectLogOpMsg);return}var l;if(compTypeNo=="1"||compTypeNo=="10"||compTypeNo=="11"||compTypeNo=="7"||compTypeNo=="8"||compTypeNo=="9"||compTypeNo=="5"){var k=getInputTxtEle();if(k!=null&&k!="undefined"){l=k.value}}else{if(compTypeNo=="2"){l=booleanComboBx.getValue()}else{if(compTypeNo=="3"){var j=getInputTextAreaEle();if(j!=null&&j!="undefined"){l=j.value}}else{if(compTypeNo=="4"){l=pickListComboBx.getValue()}else{if(compTypeNo=="12"){l=getDateTimeInputEle().value}else{if(compTypeNo=="13"){l=getDateInputEle().value}}}}}}var b;if(l!=null&&l!=""&&l!="undefined"){b=validateData(l);if(b){return}else{h.set("operandValue",Ext.util.Format.htmlEncode(l))}}else{showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.EnterValMsg);return}if(g==null||g=="undefined"||typeof(g)=="undefined"){qualificationGridStore.add(h);qualificationOrderIndex=qualificationOrderIndex+1;clearQualificationCriteria()}QualificationGrid.getView().refresh()}function fetchQualificationComboFieldLabel(){var b=fieldsEditor.getValue();for(var a=0;a<fieldsComboStore.data.length;a++){if(b==fieldsComboStore.getAt(a).get("id")){return fieldsComboStore.getAt(a)}}return""}function removeSLTQData(){var c=QualificationGrid.getSelectionModel().getSelected();if(c!=null&&c!="undefined"){QualificationGrid.store.remove(c);qualificationOrderIndex=qualificationOrderIndex-1;var a=QualificationGrid.store.getCount();for(var b=0;b<a;b++){var d=QualificationGrid.store.getAt(b);d.set("orderIndex",b+1)}QualificationGrid.render("qualificationGridDiv");getRemoveBtnEle().src=getSDFStylesResPath()+"/SDEFbuttons/b_remove_disabled.png";getRemoveBtnEle().disabled=true;fieldsEditor.setValue("");comparisonOperator.setValue("");logicalOperator.setValue("");pickListComboStore.removeAll();pickListComboBx.setValue("");getInputTxtEle().value="";assignVisibility("inline","none","none","none","none","none","none",null,1);setAddUpdateOnClick(null)}}function clearQualificationCriteria(){if(compTypeNo=="1"||compTypeNo=="10"||compTypeNo=="11"||compTypeNo=="7"||compTypeNo=="8"||compTypeNo=="9"||compTypeNo=="5"){var e=getInputTxtEle();if(e!=null&&e!="undefined"){e.value=""}}else{if(compTypeNo=="2"){operandVal=booleanComboBx.setValue("")}else{if(compTypeNo=="3"){var d=getInputTextAreaEle();if(d!=null&&d!="undefined"){d.value=""}}else{if(compTypeNo=="4"){operandVal=pickListComboBx.setValue("")}else{if(compTypeNo=="12"){var f=getDateTimeInputEle();if(f!=null&&f!="undefined"){f.value=""}}else{if(compTypeNo=="13"){var a=getDateInputEle();if(a!=null&&a!="undefined"){a.value=""}}else{if(compTypeNo=="6"){var b=getInputTxtEle();if(b!=null&&typeof(b)!="undefined"){b.value="";var c=document.getElementById("referenceID");if(c!=null&&typeof(c)!="undefined"){c.value=""}}}}}}}}}fieldsEditor.setValue("");comparisonOperator.setValue("");logicalOperator.setValue("")}function addRecordToStartClockGrid(){var d=startOpComboBx.getValue();if(d==null||d==""||d=="undefined"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.SelectCmpOpMsg);return}var e=getStartStatusEle().value;if(e==null||e==""||e=="undefined"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.EnterValMsg);return}var a=startlogOpComboBx.getValue();if(a==null||a==""||a=="undefined"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.SelectLogOpMsg);return}var b=Ext.getCmp("startClockGridId").store;var c=b.data.length;listDataForStartClockGrid[c]=new Array(6);listDataForStartClockGrid[c][0]=c+1;listDataForStartClockGrid[c][1]=getStartStatusLabelEle().value;listDataForStartClockGrid[c][2]=startOpComboBx.getValue();listDataForStartClockGrid[c][3]=getStartStatusEle().value;listDataForStartClockGrid[c][4]=startlogOpComboBx.getValue();listDataForStartClockGrid[c][5]=null;loadDatatoStartClockStore();setDefaultValueToStartClockFields()}function addRecordToPauseClockGrid(){var d=pasueOpComboBx.getValue();if(d==null||d==""||d=="undefined"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.SelectCmpOpMsg);return}var e=getPauseStatusEle().value;if(e==null||e==""||e=="undefined"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.EnterValMsg);return}var a=pauselogOpComboBx.getValue();if(a==null||a==""||a=="undefined"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.SelectLogOpMsg);return}var b=Ext.getCmp("pauseClockGridId").store;var c=b.data.length;listDataForPasueClockGrid[c]=new Array(6);listDataForPasueClockGrid[c][0]=c+1;listDataForPasueClockGrid[c][1]=getPauseStatusLabelEle().value;listDataForPasueClockGrid[c][2]=pasueOpComboBx.getValue();listDataForPasueClockGrid[c][3]=getPauseStatusEle().value;listDataForPasueClockGrid[c][4]=pauselogOpComboBx.getValue();listDataForPasueClockGrid[c][5]=null;loadDatatoPauseClockStore();setDefaultValueToPauseClockFields()}function addRecordToStopClockGrid(){var d=stopOpComboBx.getValue();if(d==null||d==""||d=="undefined"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.SelectCmpOpMsg);return}var e=getStopStatusEle().value;if(e==null||e==""||e=="undefined"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.EnterValMsg);return}var a=stoplogOpComboBx.getValue();if(a==null||a==""||a=="undefined"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.SelectLogOpMsg);return}var b=Ext.getCmp("stopClockGridId").store;var c=b.data.length;listDataForStopClockGrid[c]=new Array(6);listDataForStopClockGrid[c][0]=c+1;listDataForStopClockGrid[c][1]=getStopStatusLabelEle().value;listDataForStopClockGrid[c][2]=stopOpComboBx.getValue();listDataForStopClockGrid[c][3]=getStopStatusEle().value;listDataForStopClockGrid[c][4]=stoplogOpComboBx.getValue();listDataForStopClockGrid[c][5]=null;loadDatatoStopClockStore();setDefaultValueToStopClockFields()}function loadDatatoStartClockStore(){startClockStore.removeAll();Ext.getCmp("startClockGridId").getView().refresh();startClockStore.loadData(listDataForStartClockGrid);Ext.getCmp("startClockGridId").getView().refresh();disableStartRemoveBtn()}function loadDatatoPauseClockStore(){pauseClockStore.removeAll();Ext.getCmp("pauseClockGridId").getView().refresh();pauseClockStore.loadData(listDataForPasueClockGrid);Ext.getCmp("pauseClockGridId").getView().refresh();disablePauseRemoveBtn()}function loadDatatoStopClockStore(){stopClockStore.removeAll();Ext.getCmp("stopClockGridId").getView().refresh();stopClockStore.loadData(listDataForStopClockGrid);Ext.getCmp("stopClockGridId").getView().refresh();disableStopRemoveBtn()}function showExtMsg(a){Ext.MessageBox.show({width:250,msg:a,buttons:Ext.MessageBox.OK})}function openStartStatusLookUp(){createMutuallyExclusiveCriteria();if(moduleName=="Incident__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToIncident__c = true and State__c = true ")+"&mutualExclusionFilter="+mutualExcWhereClause,setStartReferenceToVal,450,600)}else{if(moduleName=="Change_Request__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToChange__c = true and State__c = true ")+"&mutualExclusionFilter="+mutualExcWhereClause,setStartReferenceToVal,450,600)}else{if(moduleName=="Problem__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToProblem__c = true and State__c = true ")+"&mutualExclusionFilter="+mutualExcWhereClause,setStartReferenceToVal,450,600)}}}}function setStartReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}var a=getStartStatusEle();if(a!=null&&typeof(a)!="undefined"){if(typeof(referenceName)!="undefined"&&referenceName!=null){referenceName=decodeVal(referenceName);a.value=referenceName}var c=document.getElementById("startReferenceID");if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function openPauseStatusLookUp(){createMutuallyExclusiveCriteria();if(moduleName=="Incident__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToIncident__c = true and State__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setPauseReferenceToVal,450,600)}else{if(moduleName=="Change_Request__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToChange__c = true and State__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setPauseReferenceToVal,450,600)}else{if(moduleName=="Problem__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToProblem__c = true and State__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setPauseReferenceToVal,450,600)}}}}function setPauseReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}var a=getPauseStatusEle();if(a!=null&&typeof(a)!="undefined"){if(typeof(referenceName)!="undefined"&&referenceName!=null){referenceName=decodeVal(referenceName);a.value=referenceName}var c=document.getElementById("pauseReferenceID");if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function openStopStatusLookUp(){createMutuallyExclusiveCriteria();if(moduleName=="Incident__c"){openPopup("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToIncident__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setStopReferenceToVal,450,600)}else{if(moduleName=="Change_Request__c"){openPopup("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToChange__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setStopReferenceToVal,450,600)}else{if(moduleName=="Problem__c"){openPopup("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToProblem__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setStopReferenceToVal,450,600)}}}}function setStopReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}var a=getStopStatusEle();if(a!=null&&typeof(a)!="undefined"){if(typeof(referenceName)!="undefined"&&referenceName!=null){referenceName=decodeVal(referenceName);a.value=referenceName}var c=document.getElementById("stopReferenceID");if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function createMutuallyExclusiveCriteria(){mutualExcWhereClause="";var h=startClockStore.data.length;var b="";var g="";var e="";for(var c=0;c<=h-1;c++){var d=startClockGrid.getStore().getAt(c);var a=d.get("value");b+=encodeURIComponent(a)+nonPrint}var f=pauseClockStore.data.length;for(var c=0;c<=f-1;c++){var d=pauseClockGrid.getStore().getAt(c);var a=d.get("pvalue");g+=encodeURIComponent(a)+nonPrint}var j=stopClockStore.data.length;for(var c=0;c<=j-1;c++){var d=stopClockGrid.getStore().getAt(c);var a=d.get("stvalue");e+=encodeURIComponent(a)+nonPrint}mutualExcWhereClause=b+g+e;mutualExcWhereClause=mutualExcWhereClause.substring(0,mutualExcWhereClause.length-1);return mutualExcWhereClause}function setSupportHoursReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}var a=getSupportHoursEle();if(a!=null&&typeof(a)!="undefined"){a.value=referenceName;var c=getSupportHoursHiddenEle();if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function setInputDataAndElementsOnRowClick(h){var k=QualificationGrid.store.getAt(h);var a=k.get("operandFieldLabel");var l=k.get("operatorFieldAPIName");var b=Ext.util.Format.htmlDecode(k.get("operandValue"));var e=k.get("operatorValue");var j=k.get("groupingOperator");var f=k.get("operandFieldType");if(l!=null&&l!="undefined"){fieldsEditor.setValue(l);var d=fetchQualificationComboFieldLabel();var c=d.get("type");if(c!=null&&c.indexOf(":")>0){var g=c.split(":")[1];if(g!=null&&typeof(g)!="undefined"&&g!=""){selectedTextAreaLength=g}}}setVisibilityData(l,a,f,b,e,j)}function setComparisonOperatorStore(a){if(a.indexOf(":")>0){a=a.split(":")[0]}else{if(a.indexOf(EF)>0){a=a.split(EF)[0]}}if(a=="reference"){comparisonOperator.store.loadData(compStore.reference)}else{if(a=="datetime"){comparisonOperator.store.loadData(compStore.dateTime)}else{if(a=="date"){comparisonOperator.store.loadData(compStore.dateTime)}else{if(a=="textarea"){comparisonOperator.store.loadData(compStore.textArea)}else{if(a=="text"){comparisonOperator.store.loadData(compStore.text)}else{if(a=="phone"){comparisonOperator.store.loadData(compStore.phone)}else{if(a=="currency"){comparisonOperator.store.loadData(compStore.currency)}else{if(a=="percent"){comparisonOperator.store.loadData(compStore.percent)}else{if(a=="number"){comparisonOperator.store.loadData(compStore.number)}else{if(a=="boolean"){comparisonOperator.store.loadData(compStore.booleanVar)}else{if(a=="email"){comparisonOperator.store.loadData(compStore.email)}else{if(a=="picklist"){comparisonOperator.store.loadData(compStore.picklist)}}}}}}}}}}}}comparisonOperator.reset()}function getUpdateBtnEle(){return document.getElementById("updateButtonId")}function getAddBtnEle(){return document.getElementById("addButtonId")}function reomveRecordFromStartClockGrid(){var a=startClockGrid.getSelectionModel().getSelected();listDataForStartClockGrid.splice(selectedRowIndexStart,1);startClockGrid.store.remove(a);var b=startClockStore.data.length;for(var c=0;c<b;c++){var d=a.store.getAt(c);d.set("condition",c+1);listDataForStartClockGrid[c][0]=c+1;d.commit()}disableStartRemoveBtn();setDefaultValueToStartClockFields();document.getElementById("updateStart_id").style.display="none";document.getElementById("addStart_id").style.display="inline"}function reomveRecordFromPauseClockGrid(){var a=pauseClockGrid.getSelectionModel().getSelected();listDataForPasueClockGrid.splice(selectedRowIndexPause,1);pauseClockGrid.store.remove(a);var b=pauseClockStore.data.length;for(var c=0;c<b;c++){var d=a.store.getAt(c);d.set("condition",c+1);listDataForPasueClockGrid[c][0]=c+1;d.commit()}disablePauseRemoveBtn();setDefaultValueToPauseClockFields();document.getElementById("updatePause_id").style.display="none";document.getElementById("addPause_id").style.display="inline"}function reomveRecordFromStopClockGrid(){var a=stopClockGrid.getSelectionModel().getSelected();listDataForStopClockGrid.splice(selectedRowIndexStop,1);stopClockGrid.store.remove(a);var b=stopClockStore.data.length;for(var c=0;c<b;c++){var d=a.store.getAt(c);d.set("condition",c+1);listDataForStopClockGrid[c][0]=c+1;d.commit()}disableStopRemoveBtn();setDefaultValueToStopClockFields();document.getElementById("updateStop_id").style.display="none";document.getElementById("addStop_id").style.display="inline"}function enableStartRemoveBtn(){document.getElementById("removeStart_id").disabled=false;document.getElementById("removeStart_id").src=getSDFStylesResPath()+"/SDEFbuttons/b_remove.png"}function enablePauseRemoveBtn(){document.getElementById("removePause_id").disabled=false;document.getElementById("removePause_id").src=getSDFStylesResPath()+"/SDEFbuttons/b_remove.png"}function enableStopRemoveBtn(){document.getElementById("removeStop_id").disabled=false;document.getElementById("removeStop_id").src=getSDFStylesResPath()+"/SDEFbuttons/b_remove.png"}function upadateSLTQData(){var a=QualificationGrid.getSelectionModel().getSelected();addUpdateSLTQData(a);setAddUpdateOnClick(null);QualificationGrid.getSelectionModel().clearSelections();clearQualificationCriteria()}function resetSLTForm(){daysSpinner.setValue(targetInDays);hoursSpinner.setValue(targetInHours);minutesSpinner.setValue(targetInMinutes);businessDaysSpinner.setValue(targetInBusinessDays);EnablingAndDisablingButtons();initTargetFields();setDefaultValueToStartClockFields();setDefaultValueToStopClockFields();setDefaultValueToPauseClockFields();loadDataToGrids();hideStopClockPanel()}function validateData(e){var c=false;if(compTypeNo!=0){if(compTypeNo==7){if(isNaN(e)){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Number : "+e,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==8){var a=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!e.match(a)){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Email address : "+e,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==9){if(isNaN(e)||e<0||e>100){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Percent : "+e,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==11){var b=/^-?\d+(\.\d+)?$/;if(!e.match(b)){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Currency :  "+e,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==10){var d=/^[-]?\d*?\d*$/;if(!e.match(d)){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Phone : "+e,buttons:Ext.MessageBox.OK})}}}}}}}return c}function gridHasDupesNONE(f){var c=f.store;var b=f.id;var e,d,h;h=c.data.length;for(e=0;e<h;e++){for(d=e+1;d<h;d++){var a=c.getAt(e);var g=c.getAt(d);if(f.id=="startClockGridId"){if(a.get("logicalOperator")==g.get("logicalOperator")&&a.get("logicalOperator")=="NONE"){return true}}else{if(f.id=="pauseClockGridId"){if(a.get("plogicalOperator")==g.get("plogicalOperator")&&a.get("plogicalOperator")=="NONE"){return true}}else{if(f.id=="stopClockGridId"){if(a.get("stlogicalOperator")==g.get("stlogicalOperator")&&a.get("stlogicalOperator")=="NONE"){return true}}else{if(f.id=="qualificationCriteriaGrid"){if(a.get("groupingOperator")==g.get("groupingOperator")&&a.get("groupingOperator")=="NONE"){return true}}}}}}}return false}function validateCriteria(){if(!getsuggestedOwnerTitleEle().value.trim()){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.suggestedOwnerTitleEmpty);return true}if(gridHasDupesNONE(QualificationGrid)){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.ValidateLogicalOperatorForQual);return true}var b=QualificationGrid.getStore().getAt(qualificationGridStore.data.length-1);if(b!=null&&b!=""&&typeof(b)!="undefined"){var a=b.get("groupingOperator");if(a!="NONE"){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.ValidateLogicalOperatorForQual);return true}}return false}function loadDataToGrids(){qualificationGridStore.loadData(listData);qualificationOrderIndex=listData.length+1}function updateRecordOfStartClockGrid(){listDataForStartClockGrid[selectedRowIndexStart][0]=selectedRowIndexStart+1;listDataForStartClockGrid[selectedRowIndexStart][1]=getStartStatusLabelEle().value;listDataForStartClockGrid[selectedRowIndexStart][2]=startOpComboBx.getValue();listDataForStartClockGrid[selectedRowIndexStart][3]=getStartStatusEle().value;listDataForStartClockGrid[selectedRowIndexStart][4]=startlogOpComboBx.getValue();listDataForStartClockGrid[selectedRowIndexStart][5]=startClockStore.getAt(selectedRowIndexStart).get("sfRecord");loadDatatoStartClockStore();setDefaultValueToStartClockFields();document.getElementById("updateStart_id").style.display="none";document.getElementById("addStart_id").style.display="inline"}function updateRecordOfPauseClockGrid(){listDataForPasueClockGrid[selectedRowIndexPause][0]=selectedRowIndexPause+1;listDataForPasueClockGrid[selectedRowIndexPause][1]=getPauseStatusLabelEle().value;listDataForPasueClockGrid[selectedRowIndexPause][2]=pasueOpComboBx.getValue();listDataForPasueClockGrid[selectedRowIndexPause][3]=getPauseStatusEle().value;listDataForPasueClockGrid[selectedRowIndexPause][4]=pauselogOpComboBx.getValue();listDataForPasueClockGrid[selectedRowIndexPause][5]=pauseClockStore.getAt(selectedRowIndexPause).get("psfRecord");loadDatatoPauseClockStore();setDefaultValueToPauseClockFields();document.getElementById("updatePause_id").style.display="none";document.getElementById("addPause_id").style.display="inline"}function updateRecordOfStopClockGrid(){var a=stopClockGrid.getSelectionModel().getSelected();listDataForStopClockGrid[selectedRowIndexStop][0]=selectedRowIndexStop+1;listDataForStopClockGrid[selectedRowIndexStop][1]=getStopStatusLabelEle().value;listDataForStopClockGrid[selectedRowIndexStop][2]=stopOpComboBx.getValue();listDataForStopClockGrid[selectedRowIndexStop][3]=getStopStatusEle().value;listDataForStopClockGrid[selectedRowIndexStop][4]=stoplogOpComboBx.getValue();listDataForStopClockGrid[selectedRowIndexStop][5]=stopClockStore.getAt(selectedRowIndexStop).get("stsfRecord");loadDatatoStopClockStore();setDefaultValueToStopClockFields();document.getElementById("updateStop_id").style.display="none";document.getElementById("addStop_id").style.display="inline"}function populateValuesOnRowClick(a,c,b){if(a!=null&&typeof(a)!="undefined"&&c!=null&&typeof(c)!="undefined"){c[0].value=a[0];document.getElementById(c[1]).style.display="inline";document.getElementById(c[2]).style.display="none"}if(b!=null&&typeof(b)!="undefined"){b[0].setValue(a[1]);b[1].setValue(a[2])}}function RefreshGrid(){startClockGrid.getView().refresh();stopClockGrid.getView().refresh();pauseClockGrid.getView().refresh()}function toggleAdvanceExpression(b,a){document.getElementById(b).style.display="none";document.getElementById(a).style.display="block"}function populateTextArea(c,d){var b=c;var e=document.getElementById(d);var f="";for(i=0;i<b.data.length;i++){var a=b.getAt(i);f=f+a.get("orderIndex")+" "+a.get("groupingOperator")+" "}e.value=f}function validateInput(b){var a=(b.which)?b.which:b.keyCode;if(a<=41&&a>=35){return true}return false}function populateAdvExpTextArea(d,e){var c=d.store;var f=document.getElementById(e);var g="";var b=d.id;for(i=0;i<c.data.length;i++){var a=c.getAt(i);if(d.id=="startClockGridId"){g=g+a.get("condition")+" "+a.get("logicalOperator")+" "}else{if(d.id=="pauseClockGridId"){g=g+a.get("pcondition")+" "+a.get("plogicalOperator")+" "}else{if(d.id=="stopClockGridId"){g=g+a.get("stcondition")+" "+a.get("stlogicalOperator")+" "}}}}f.value=g}function ConfrimDeleteMilestone(){if(!Ext.getCmp("btnRemove").disabled){Ext.MessageBox.confirm(SuggestedOwnerMappingCriteriaPage.Labels.labelDelete,SuggestedOwnerMappingCriteriaPage.Labels.labelDeleteMilestone,function(a){if(a==="yes"){deleteMilestonefromStore()}})}}function ConfrimDeleteAction(){if(!Ext.getCmp("btnRemoveAct").disabled){var a="";if(selectedRowAction.length==1){a=SuggestedOwnerMappingCriteriaPage.Labels.labelDeleteAction}else{a=SuggestedOwnerMappingCriteriaPage.Labels.labelDeleteActions}Ext.MessageBox.confirm(SuggestedOwnerMappingCriteriaPage.Labels.labelDelete,a,function(b){if(b==="yes"){deleteActionfromStore()}})}}function deleteMilestonefromStore(){milestoneGrid.store.remove(selectedRowMilestone);milestoneGrid.getView().refresh();actionGrid.store.removeAll();actionGrid.getView().refresh();delMilestone();milestoneGrid.getSelectionModel().selectFirstRow();if(milestonetore.data.length<=0){Ext.getCmp("btnRemove").setDisabled(true);Ext.getCmp("btnRemove").setIconClass("bmcDeleteSLTDisable");Ext.getCmp("btnEdit").setDisabled(true);Ext.getCmp("btnEdit").setIconClass("bmcEditSLTDisable")}}function deleteActionfromStore(){for(i=0;i<selectedRowAction.length;i++){actionGrid.store.remove(selectedRowAction[i])}actionGrid.getView().refresh();delAction()}function ChangeActionLabel(){if(milestonetore.getCount()==0){var a=getActionLabel();RemedyForceHTMLProcessor.clearHTML(a);a.appendChild(document.createTextNode(SuggestedOwnerMappingCriteriaPage.Labels.labelAction+" : "))}}function validateQAdvExpression(){var c="";var d=0;while(qualificationGridStore.data.length>d){c=c+qualificationGridStore.getAt(d).get("orderIndex")+nonPrint+qualificationGridStore.getAt(d).get("operatorFieldAPIName")+nonPrint+qualificationGridStore.getAt(d).get("operatorValue")+nonPrint+Ext.util.Format.htmlDecode(qualificationGridStore.getAt(d).get("operandValue"))+nonPrint+qualificationGridStore.getAt(d).get("operandFieldType")+nonPrint+qualificationGridStore.getAt(d).get("groupingOperator")+nonPrint+qualificationGridStore.getAt(d).get("qualId")+PE;d++}var b=getApplySTStrEle();b.value=c;var a=getQAdvExprTextArea();a.value=a.value;validateAdvExpression("0")}function resetQAdvExpression(){populateTextArea(QualificationGrid.store,getQAdvExprTextArea().id)}function milestoneInvalidated(){if(errorFlag==true){Ext.Msg.alert("",SuggestedOwnerMappingCriteriaPage.Labels.milestoneInvalidated,function(){DisplayAfterSaveMessage()})}else{DisplayAfterSaveMessage()}}function DisplayAfterSaveMessage(){Ext.getCmp("saveId").setDisabled(false);if(errormsg==SuggestedOwnerMappingCriteriaPage.Labels.labelSavedSuccessfully){Ext.getCmp("resetId").setDisabled(false);if(!isUpdateble&&sltId!=null&&sltId!=""){Ext.getCmp("saveId").setDisabled(true)}}showError()}function updateTitle(){var a=window.parent.Ext.getCmp("popupWindowId1");var b=Ext.util.Format.ellipsis(ServiceTargetHeader+getServiceTitleValue(),80);if(a!=null&&typeof(a)!="undefined"&&b!=""){a.setTitle(b)}}function refreshSLTList(){window.parent.naviframe1.SLTframe.pageRefresh();window.parent.naviframe1.grid.hide();window.parent.naviframe1.grid_staff.hide()}function validateInputFF(b){if(!Ext.isIE){var a=(b.which)?b.which:b.keyCode;if(a<=41&&a>=35){return true}return false}return}function validateInputIE(b){if(Ext.isIE){var a=(b.which)?b.which:b.keyCode;if((a<=41&&a>=35)||(a==57||a==48)){return true}return false}return}function EnablingAndDisablingButtons(){var b=Ext.getCmp("resetId");var a=Ext.getCmp("nextId");var c=Ext.getCmp("prevId");var d=Ext.getCmp("saveId");if(getSLACopyId()!=null&&getSLACopyId()!=""){b.setDisabled(true);a.setDisabled(true);c.setDisabled(true);d.setDisabled(true)}else{if(sltId==null||sltId==""||isCopied==true){getDurationFieldEle().value=getDuration();b.setDisabled(true);a.setDisabled(true);c.setDisabled(true);d.setDisabled(false)}else{getAppliesToEle().disabled=true;Ext.getCmp("st_inactive__c").setValue(getSLTInactive());getAppliesToEle().disabled=true;b.setDisabled(false);a.setDisabled(false);c.setDisabled(false);d.setDisabled(false)}}if(!isUpdateble&&sltId!=null&&sltId!=""){d.setDisabled(true)}isCopied=false}function callInitMilestone(a){initMilestone()}function setDefaultValueToStartClockFields(){startOpComboBx.setValue("");startlogOpComboBx.setValue("NONE");getStartStatusEle().value=""}function setDefaultValueToStopClockFields(){stopOpComboBx.setValue("");stoplogOpComboBx.setValue("NONE");getStopStatusEle().value=""}function setDefaultValueToPauseClockFields(){pasueOpComboBx.setValue("");pauselogOpComboBx.setValue("NONE");getPauseStatusEle().value=""}function handleResetChange(){if(clickedOnce){clickedOnce=false}}function handleChange(a){if(!clickedOnce){clickedOnce=true}}var store_staff=new Ext.data.ArrayStore({fields:[{name:"Id"},{name:"Staff"}]});var store=new Ext.data.ArrayStore({fields:[{name:"Id"},{name:"Queue"}]});var sm=new Ext.grid.CheckboxSelectionModel({listeners:{selectionchange:function(a){}}});var cm=new Ext.grid.ColumnModel([sm,{id:"Queue",header:lblQueue,sortable:true,dataIndex:"Queue",forceFit:true}]);var grid=new Ext.grid.GridPanel({store:store,cm:cm,sm:sm,viewConfig:{forceFit:true,scrollOffset:0},stripeRows:true,height:300,width:200,enableHdMenu:false,forceFit:true,listeners:{afterrender:function(){setSelectedRows("Queue",grid)},delay:1000}});var sm1=new Ext.grid.CheckboxSelectionModel({listeners:{selectionchange:function(a){}}});var cm1=new Ext.grid.ColumnModel([sm1,{id:"ID",header:"ID",sortable:true,dataIndex:"ID",hidden:true},{id:"Staff",header:lblStaff,sortable:true,dataIndex:"Staff",forceFit:true}]);var grid_staff=new Ext.grid.GridPanel({store:store_staff,cm:cm1,sm:sm1,viewConfig:{forceFit:true,scrollOffset:0},stripeRows:true,height:300,width:200,enableHdMenu:false,forceFit:true,listeners:{afterrender:function(){setSelectedRows("Staff",grid_staff)},delay:1000}});function setSelectedRows(e,d){var a="";if(e=="Queue"){a=selectedQueueIds}else{a=selectedStaffIds}var c=d.getStore();for(var b=0;b<c.getCount();b++){if(a.indexOf(c.getAt(b).get("Id"))!=-1){d.getSelectionModel().selectRow(b,true)}}}function renderUserGrid(){var c=window.parent.naviframe1.SLTframe.grid.getWidth();c=c/2;store.loadData(resultSet);store_staff.loadData(resultSetUser);grid.render("queueID");grid_staff.render("userID");grid.setWidth(c-10);grid_staff.setWidth(c-10);var b=store.findExact("Id",defQID);var a=document.getElementById(defQComp);if(b>=0){defQName=store.getAt(b).get("Queue");defQName=Ext.util.Format.htmlDecode(defQName);if(a!=null){a.value=defQName}}else{if(a!=null){a.value=""}}}function openQueueOnlyPopUp(){openPopupRF("SearchPage?popupId=Queue&isQueurorUser=true&isLookup=true&idNameForPopUp=true&queueFor=Incident__c&isOnlyQueueList=true&filterClause="+escape("sobjectType='"+objName+"'"),oncomp)}function oncomp(a){if(typeof(a)!="undefined"&&a!=null){a=a.split("")}defQName=a[1];defQName=Ext.util.Format.htmlDecode(defQName);document.getElementById(defQComp).value=defQName;defQID=a[0]}function validateBlankCondition(){if(document.getElementById(defQComp)!=null){var b=document.getElementById(defQComp).value;if(b!=null&&b!=""){var a=getApplySTStrEle().value;if(a==""){showExtMsg(SuggestedOwnerMappingCriteriaPage.Labels.validateCondIfQueue);return true}else{return false}}return false}return false}function updateSuggTitle(){var a=getServiceTitleValue();if(a!=""&&a!=null){window.parent.changeTitle(getWID(),a,SuggestedOwnerMappingCriteriaPage.Labels.SuggOwnerHeader)}};