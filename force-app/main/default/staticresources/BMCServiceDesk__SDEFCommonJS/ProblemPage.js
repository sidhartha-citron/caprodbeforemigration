var disableTrue=false,isDormantSection=false;var idset;var problemState;var assignedToMyselfState=true;var loggedInUserId="",problemOwnerId="",disableNextPrev=false;var duration=0,closedStageVar,insideNote=false,clickedOnce=false,isNoteEnableFlag=true,durationError=0;document.onclick=activateWindow;var windowloaddate=0,pagerenderstart=0,networklatencystart=0;var resizeGrid=function resizeGrid(){if(Ext.getCmp("southPanelSI")!=undefined){Ext.getCmp("southPanelSI").setWidth(Ext.getCmp("southPanelSI").getWidth())}};function saveFunction(c){if(getIsPriorityChanged()=="true"&&isNewRecord()=="false"){if(!automaticupdateduedate){openPopup("recalculateDueDate",showit,190,300)}else{setDueDateOption(2);var e=Ext.getCmp("problem_inactive__c").getValue();waitbox(0);c(e)}}else{var a=document.getElementById(ProblemPageComp.ComponentVars.ProblemFormDescription).value.trim();var b=document.getElementById(ProblemPageComp.ComponentVars.ProblemFormResolution).value.trim();var d=document.getElementById(ProblemPageComp.ComponentVars.ProblemFormWorkAround).value.trim();if(a.length>32000){Ext.MessageBox.show({msg:labelDescription+": "+AddNote.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK});return}if(b.length>32000){Ext.MessageBox.show({msg:labelResolution+": "+AddNote.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK});return}if(d.length>255){Ext.MessageBox.show({msg:labelWorkAround+": "+AddNote.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK});return}var e=Ext.getCmp("problem_inactive__c").getValue();waitbox(0);c(e)}}var showit=function(a){setDueDateOption(a);var b=Ext.getCmp("problem_inactive__c").getValue();save(b)};Ext.onReady(function(){if(closedStageVar=="CLOSED"||closedStageVar=="Closed"){Ext.MessageBox.show({title:Information,msg:ClosedStage,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}var p=networklatencystart-LatencyStart;data+=labelPM_netwokLatency;data+=p;windowloaddate=new Date();pagerenderstart=windowloaddate.getTime();Ext.QuickTips.init();var y=function(B,C){openPage("ProblemPage",ProblemRequestHeader,ProblemRequestHeader);activeAllWindowFlag=false};var m=function(B,C){saveFunction(save)};var a=function(B,C){callCopyPage();activeAllWindowFlag=false};var z=function(B,C){Ext.MessageBox.confirm(labelDelete,DeletedRecord,function(D){if(D==="yes"){deleteProblem()}})};var j=function(B,C){reset()};var q=function(B,C){openPopup("SearchPage?popupId=Client&isLookup=true&filterClause="+escape("IsStaffUser__c=true")+"&isAssignTo=true",preAssignedToStaff)};var r=function(B,C){openPopup("SearchPage?popupId=Client&isLookup=true&filterClause="+escape("profileid='"+getProfileID()+"'And IsStaffUser__c=true ")+"&isAssignTo=true",preAssignedToStaff)};var f=function(B,C){waitbox(0);assignedToMyself();handleChange()};var v=function(B,C){openPopup("SearchPage?popupId=Queue&isQueurorUser=true&isLookup=true&queueFor=Problem__c&isOnlyQueueList=true&filterClause="+escape("sobjectType='"+objName+"'"),preAssignTOQueue)};var A=function(B,C){closeProblem()};var h=function(B,C){reopenProblem()};var s=function(B,C){getProblemProcBtnHandler()};updateTitle();handleElemEvent();function d(){if(idset==null||idset==""){if(getIsDirect()==""){if(typeof(window.parent.returnListOfId)=="function"){idset=window.parent.returnListOfId()}}else{if(typeof(window.parent.parent.getIdArray)=="function"){idset=window.parent.parent.getIdArray()}window.parent.handleSave(getWID(),getID())}}}d();var c=function(B,C){if(window.parent.changeArray[wid2]!=null&&typeof(window.parent.changeArray[wid2])!="undefined"&&window.parent.changeArray[wid2]!=-1){checkLoseChanges(i)}else{if(document.getElementById("prevId").disabled!=true){i()}}};var e=function(B,C){if(window.parent.changeArray[wid2]!=null&&typeof(window.parent.changeArray[wid2])!="undefined"&&window.parent.changeArray[wid2]!=-1){checkLoseChanges(k)}else{if(document.getElementById("nextId").disabled!=true){k()}}};function i(){var C="";var B=0;while(idset.length>B){if(C==""){C=idset[B]}else{C=C+","+idset[B]}B++}previousProblemBtnHandler(C)}function k(){var C="";var B=0;while(idset.length>B){if(C==""){C=idset[B]}else{C=C+","+idset[B]}B++}nextProblemBtnHandler(C)}var x=Ext.extend(Ext.Panel,{renderTo:"btnToolbar",defaults:{bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"}});new x({id:"toolBarId",title:"",cls:"toolSpCls",bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;",tbar:[{scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:labelNew,hidden:disableTrue,handler:y}," ",{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:labelSave,id:"saveId",disabled:saveState,handler:m}," ",{scale:"medium",iconCls:"bmcCopy",tooltipType:"title",tooltip:labelCopy,id:"copyId",hidden:disableTrue,handler:a}," ","-"," ",{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:labelDelete,id:"deleteId",handler:z}," ",{scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:labelReset,id:"resetId",hidden:disableTrue,handler:j}," ","-",{id:"assignToId",scale:"medium",iconCls:"bmcAssign1",tooltipType:"title",tooltip:labelAssignTo,hidden:disableTrue,menu:[{text:labelIncidentsStaff,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToStaffButtonId",disabled:!problemState,handler:q},{text:labelIncidentMyself,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToMyselfButtonId",disabled:!problemState,handler:f},{text:labelIncidentMemberofProfName,id:"assignToMemberOfAdminButtonId",disabled:!problemState,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:r},{text:labelQueue,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToQueueButtonId",disabled:!problemState,handler:v}]}," ",{id:"actionId",scale:"medium",iconCls:"bmcAction1",tooltipType:"title",tooltip:labelActions,hidden:disableTrue,menu:[{text:labelIncidentClose,id:"closeButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",disabled:!problemState,handler:A},{text:labelReopenProblem,id:"reopenButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",disabled:problemState,handler:h},{xtype:"menuseparator",id:"separaterAction"},{text:Print,disabled:IsNewRecord(problemId),icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printButtonId",handler:PrintBtnHandler},{text:PrintPDF,disabled:IsNewRecord(problemId),icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printPdfButtonId",handler:PrintPDFBtnHandler},"-",customActionJsonString]}," ",{scale:"medium",iconCls:"bmcAPM",tooltipType:"title",tooltip:labelProblemMgmtProcess,id:"problemProcButton",handler:s}," ","-"," ",{scale:"medium",iconCls:"bmcCIExplorer",tooltipType:"title",tooltip:labelLaunchCIExplorer,id:"ciExplorerBtn",listeners:{mouseover:function(){this.setIconClass("bmcCIExplorerOn")},mouseout:function(){this.setIconClass("bmcCIExplorer")},disable:function(){this.setIconClass("bmcCIExplorerDisable")},enable:function(){this.setIconClass("bmcCIExplorer")}},handler:ShowCIExplorer},{scale:"medium",iconCls:"bmcEmailMessage",tooltipType:"title",tooltip:labelEmailMessage,id:"emailId",hidden:disableTrue,handler:sendEmailBtnHandler,listeners:{disable:function(){this.setIconClass("bmcEmailMessageDisable")},enable:function(){this.setIconClass("bmcEmailMessage")}}},new Ext.Toolbar.Fill(),{id:"problem_inactive__c",xtype:"checkbox",width:93,color:"#004376",align:"top",checked:false,boxLabel:'<span class="checkboxLabelCls">'+labelInactive+"</span>",autoCreate:{tag:"input",type:"checkbox",title:labelTooltipProblemInactive,tooltip:labelTooltipProblemInactive}},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif",title:labelPreviousRecord},cls:"cursorCls",listeners:{render:function(B){B.el.on("click",c)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:labelNextRecord},cls:"cursorSpaceCls",listeners:{render:function(B){B.el.on("click",e)}}}]});document.getElementById("capsule").style.display="block";var t=new Ext.Panel({layout:"border",height:Ext.isIE7?670:Ext.isIE?674:Ext.isSafari?695:680,border:false,id:"canvasPanelId",cls:"canvasPanelCls",items:[{xtype:"panel",layout:"fit",overflow:"auto",autoScroll:true,split:false,width:"auto",height:435,cls:"northPanelCls",region:"center",contentEl:Ext.isIE?"capsule":ProblemPageComp.ComponentVars.ProblemForm},{xtype:"panel",layout:"fit",overflow:"auto",border:false,id:"southPanelSI",autoScroll:true,split:true,collapsible:true,collapseMode:"mini",width:"auto",height:Ext.isIE?230:240,minHeight:Ext.isIE?120:150,animCollapse:false,region:"south",listeners:{resize:function(E,G,D,C,F){if(typeof(D)=="number"){document.getElementById("detailsDivSI").style.height=D+"px"}var B=document.getElementById("SIIframeID").style.display;if(B!="none"){if(typeof(window.frames.SIIframeID.setSouthPanelHeight)=="function"){window.frames.SIIframeID.setSouthPanelHeight(D)}}},collapse:function(){this.setWidth("auto")}},contentEl:"detailsDivSI"}],listeners:{afterlayout:function(B){B.layout.south.miniSplitEl.dom.qtip=labelDragResizeClickCollapse;B.layout.south.getCollapsedEl();B.layout.south.miniCollapsedEl.dom.qtip=labelClickToExpand},single:true}});var w=new Ext.Viewport({layout:"anchor",width:"auto",id:"viewportId",border:false,cls:"viewportCanvasCls",items:[{anchor:"100%",layout:"fit",items:t}]});if(isRecordDeleted()){Ext.Msg.alert(Information,labelRecordDeleted,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}problemId=getProblemID();ChangeBtnStatus(cilink_record);if(problemId==null||problemId==""){Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("copyId").setIconClass("bmcCopyDisable");Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("assignToMyselfButtonId").setDisabled(true);Ext.getCmp("closeButtonId").setDisabled(true);Ext.getCmp("reopenButtonId").setDisabled(true);Ext.getCmp("emailId").setDisabled(true)}else{if(problemId!=null){checkEnable()}}if(problemId==null||problemId==""){document.getElementById("linkSIAvailTD").style.display="none";document.getElementById("noSIAvailTD").style.display="block"}else{var l=displaySI(cookieName,iFrameSrc);if(!l){if(document.getElementById("noSIAvailTD")!=null){document.getElementById("noSIAvailTD").style.display="none"}if(document.getElementById("linkSIAvailTD")!=null){document.getElementById("linkSIAvailTD").style.display="block"}}}renderAddNoteButton();if(typeof(getIsCopySaved)=="function"&&getIsCopySaved()=="false"){var b=getproblemInactive();Ext.getCmp("saveId").setDisabled(true);save(b)}var n=getproblemInactive();Ext.getCmp("problem_inactive__c").setValue(n);var u=new Date();var o=u.getTime();var g=(o-pagerenderstart);data+="<br>";data+=labelPM_PageLoad;data+=g;if(window.parent.refreshGridSI!=undefined){window.parent.refreshGridSI(wid,resizeGrid)}});function problemFormBtnHandler(e,d){var a=new Array(3);a[0]={btnId:"problem_description",textAreaCompId:ProblemPageComp.ComponentVars.ProblemFormDescription,textLabel:labelProblemDescription};a[1]={btnId:"problem_resolution",textAreaCompId:ProblemPageComp.ComponentVars.ProblemFormResolution,textLabel:labelProblemResolution};a[2]={btnId:"work_around",textAreaCompId:ProblemPageComp.ComponentVars.ProblemFormWorkAround,textLabel:labelWorkAround};var c=e.id;txtSize=d;for(var b=0;b<a.length;b++){if(c==a[b].btnId){activeBtnTitle=a[b].textLabel;activeTextAreaId=a[b].textAreaCompId;document.getElementById(a[b].btnId).style.fontWeight="bold";document.getElementById(a[b].textAreaCompId).style.display="block"}else{document.getElementById(a[b].btnId).style.fontWeight="normal";document.getElementById(a[b].textAreaCompId).style.display="none"}}}function knowErrorChkHandler(a){if(document.getElementById(a).checked){document.getElementById("problem_description").disabled=false;document.getElementById("problem_resolution").disabled=false;document.getElementById("problem_description").style.color="#004376";document.getElementById("problem_resolution").style.color="#004376"}}function writeCookie(){if(document.getElementById("configureSIId").checked){createSICookie(cookieName,"true");var a=displaySI(cookieName,iFrameSrc)}}function getProblemProcBtnHandler(){var a="NavigatorPage?title="+ProblemProcess+"&target=ProblemProcMgmtPage?id=1003";window.parent.parent.addNewTab(ProblemProcess,AlignabilityProcessModel,a,"false")}function closeWindow(){window.parent.refreshList();window.parent.closeTab(wid)}function handleResetChange(){if(clickedOnce){clickedOnce=false;window.parent.registerSave(wid2)}}function updateFieldsOnSave(a){a="#"+a;if(a=="#"){a=ProblemRequestHeader}window.parent.changeTitle(wid,a,a)}function refreshparentList(){window.parent.needsRefresh=true}function OpenHelpUrl(a){if(a.toLowerCase().indexOf("composeemailpage")!=-1){OpenHelppage("EmailConversationProblem","module","form")}}function ChangeBtnStatus(a){if(a=="true"){Ext.getCmp("ciExplorerBtn").enable()}else{Ext.getCmp("ciExplorerBtn").disable()}}function ShowCIExplorer(){var c=getProblemID();var d=labelCIExpCIExplorer;var a=escape("CIExplorerLauncher?Module=Problem__c&RecordSequence="+c+"&id="+c);var b="NavigatorPage?title="+d+"&target="+a;window.parent.parent.addNewTab("CIExplorerLauncher",labelConfigurationItemsExplorer,b)}var sendEmailBtnHandler=function(a,b){openPopupWithTitle("ComposeEmailPage?recordId="+problemId+"&isNew=true&objectName=Problem__c",composeMailOnCompleteIn,labelComposeEmailPageHeader+probName,getEmailWinHt(),getEmailWinWidth(),false)};function renderAddNoteAfterClose_JS(b,c){if(b!=null){b.disabled=true;b.className="clsInputTextAreaDisabledNote";var a=document.getElementById("addNoteBtn");a.disabled=true;a.className="AddButtonOff"}if(c!=null){c.disabled=true;c.className="clsDurationTextBoxDisable"}}function renderAddNoteButton_JS(c,f,d,b){if(c!=null){var a=document.getElementById("addNoteBtn");var e=c.value.trim();if(b==null||b==""||e==null||e==""||!d){a.disabled=true;a.className="AddButtonOff"}else{a.disabled=false;a.className="AddNoteButton"}if(b==null||b==""||!d){c.disabled=true;c.className="clsInputTextAreaDisabledNote";f.disabled=true;f.className="clsDurationTextBoxDisable"}else{if(isNoteEnableFlag){c.value=" ";isNoteEnableFlag=false}c.disabled=false;c.className="clsInputTextAreaNote";f.disabled=false;f.className="clsDurationTextBox"}}}function validateDuration_JS(e){var d=e.value;if(d!=""){var b=d.split(":");if(b[0].length==1){d="0"+d;e.value=d;durationError=0}var a=/^([0-9]{2}):([0-9]{2})$/;var c=d.match(a);if(c==null){durationError=1;Ext.MessageBox.show({msg:AddNote.Labels.DurationError,buttons:Ext.MessageBox.OK});e.value="00:00"}}}function enableAddNote_JS(){if(errormsg==AddNote.Labels.DurationError){var a=document.getElementById("addNoteBtn");a.disabled=false;a.className="AddNoteButton";var b=document.getElementById(AddNoteComp.ComponentVars.Notes);b.disabled=false;b.className="clsInputTextAreaNote";var c=document.getElementById(AddNoteComp.ComponentVars.Duration);c.disabled=false;c.className="clsDurationTextBox";c.value="00:00"}}function disableAddNote_JS(b,c){validateDuration(c);if(durationError!=1){if(b.length>32000){Ext.MessageBox.show({msg:AddNote.Labels.Note+": "+AddNote.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK})}else{var a=document.getElementById("addNoteBtn");a.disabled=true;a.className="AddButtonOff";saveNote()}}durationError=0}function renderNote_JS(){if(errormsg==AddNote.Labels.DurationError){Ext.MessageBox.show({msg:errormsg,buttons:Ext.MessageBox.OK})}else{var a=document.getElementById(AddNoteComp.ComponentVars.Notes);if(a!=null){a.disabled=false;a.className="clsInputTextAreaNote";a.value="";if(insideNote==false){clickedOnce=true;handleResetChange()}}var b=document.getElementById(AddNoteComp.ComponentVars.Duration);if(b!=null){b.disabled=false;b.value="00:00"}}}function afterAddNote(){var a=document.getElementById("SIIframeID").style.display;if(cookieValue!="true"&&(a=="none")){SIComp(iFrameSrc)}else{if(a!="none"){window.frames.SIIframeID.refreshDocs()}}}function showInfoPopup(b,a,f){var e="";var g=b.target;if(g==null){g=b.srcElement}if(f=="staff"){var c=getStaffHiddeninput();e=document.getElementById(c).value;tooltipforstaff()}if(e!=""&&e!=null){var d=new Ext.ToolTip({target:g.id,title:"",anchor:"right",width:200,trackMouse:true,shadow:"sides",bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",dismissDelay:15000,html:document.getElementById(a).innerHTML})}}function tooltipforstaffJS(f,a,e,c,b,d){strSingleLineText=document.getElementById("userAddressforttdivId").innerHTML.replace(new RegExp("\\n","g")," ");document.getElementById("userAddressforttdivId").innerHTML=ellipse(strSingleLineText,33);document.getElementById("userNameforttdivId").innerHTML=ellipse(f,50);document.getElementById("userTitleforttdivId").innerHTML=ellipse(a,40);document.getElementById("userCSZforttdivId").innerHTML=e;document.getElementById("userCountryforttdivId").innerHTML=ellipse(c,33);document.getElementById("userPhoneforttdivId").innerHTML=ellipse(b,33);document.getElementById("userEmailforttdivId").innerHTML='<a href="'+d+'" class="clsCmdLinkTooltip">'+ellipse(d,33)+"</a>"}function ellipse(b,a){if(b.length>a){return b.substr(0,a-3)+"..."}return b}function formCSZString(d,c,b){var a="";if(d!=""){a=ellipse(d,33)+", "}if(c!=""){a=a+ellipse(c,33)+" "}if(b!=""){a=a+ellipse(b,33)}return a}function buttonValidator(){if(problemId!=null&&problemId!=""){Ext.getCmp("printButtonId").setDisabled(false);Ext.getCmp("printPdfButtonId").setDisabled(false);Ext.getCmp("saveId").setDisabled(!problemState);Ext.getCmp("emailId").setDisabled(!problemState);var a=document.getElementById("SIIframeID").style.display;cookieValue=Ext.util.Cookies.get(cookieName);if(cookieValue=="true"&&a=="none"){SIComp("/apex/SIContainerPage?oid="+problemId+"&otype=Problem__c&wid="+wid+"&stateofIncident="+problemState+"&isChangeCreatable="+getIsChangeCreatable()+"&isInactive="+isInactive)}else{if(a=="none"){document.getElementById("noSIAvailTD").style.display="none";if(Ext.isChrome){document.getElementById("onDemandSITableId").style.display="inline-table";document.getElementById("linkSIAvailTD").style.display="table-cell"}else{document.getElementById("onDemandSITableId").style.display="block";document.getElementById("linkSIAvailTD").style.display="block"}}}}}function senddata(){return data}function handleChange(){if(!clickedOnce){clickedOnce=true;window.parent.registerChange(wid2)}}function setWorkAroundEnableDisable(){if(document.getElementById(ProblemPageComp.ComponentVars.ProblemFormKnowError).checked==false){document.getElementById("work_around").disabled=true;document.getElementById("work_around").style.color="#808080"}}function displayTextEditor(){var a=document.getElementById(ProblemPageComp.ComponentVars.ProblemFormKnowError).checked;if(!a&&labelWorkAround==activeBtnTitle){return}else{showTextEditor(activeTextAreaId,activeBtnTitle,txtSize,labelOK,labelCancel)}}function openCategoryPage(a){if(a!=null||a!=""){if(a[0]!=null||a[0]!=""){var b=a[3];categoryName=a[0];if(a[4]!=null&&a!="undefined"){document.getElementById(ProblemPageComp.ComponentVars.CategoryFKUrgency).value=a[4]}setCatData(b,categoryName)}}}function FetchProblemUrgencyHTTPJS(c,m,q,l,f,b,e,d,j,o,g){var k=document.getElementById(o);var a=new Ext.data.Connection(),n=c,p,i,h=document.getElementById(m).value;if(q!=null){clid=document.getElementById(q).value}else{clid=null}iid=document.getElementById(l).value;if(f!=null){bid=document.getElementById(f).value}else{bid=null}if(o!=null){p=document.getElementById(o).value}else{p=null}if(j!=null){i=document.getElementById(j).value}else{i=null}a.request({url:"FetchUrgencyData",method:"POST",params:{id:n,fkcat:h,fkcl:clid,fkb:bid,fki:iid,fetchUrgency:true},callback:function(u,w,r){if(w){var v=Ext.DomQuery,s=r.responseXML,t=v.selectNode("urgencyname",s);if(document.getElementById(b)!=null&&t.firstChild!=null){document.getElementById(b).value=decodeURIComponent(t.firstChild.nodeValue)}t=v.selectNode("urgencyid",s);if(t.firstChild==null){return}if(document.getElementById(e)!=null&&t.firstChild!=null){document.getElementById(e).value=decodeURIComponent(t.firstChild.nodeValue)}t=v.selectNode("priorityname",s);if(document.getElementById(d)!=null&&t.firstChild!=null){document.getElementById(d).value=decodeURIComponent(t.firstChild.nodeValue)}if(g!=null&&document.getElementById(g)!=null){if(t.firstChild!=null){document.getElementById(g).value=decodeURIComponent(t.firstChild.nodeValue)}else{document.getElementById(g).value=""}}t=v.selectNode("priorityid",s);if(document.getElementById(j)!=null&&t.firstChild!=null){document.getElementById(j).value=decodeURIComponent(t.firstChild.nodeValue);var x=decodeURIComponent(t.firstChild.nodeValue);if(i!=x){if(k!=null){setIsPriorityChanged("true")}}else{if(k!=null){setIsPriorityChanged("false")}}}if(t.firstChild==null&&g!=null){document.getElementById(j).value="";document.getElementById(g).value="";document.getElementById(d).value=""}return}}})}function FetchProblemPriorityHTTPJS(h,c,b,e,i,d){var a=new Ext.data.Connection();var g;if(e!=null){g=document.getElementById(e).value}var f=document.getElementById(i);a.request({url:"FetchPriorityPage",method:"POST",params:{fki:h,fku:c,fetchPriority:true},callback:function(m,o,j){if(o){var n=Ext.DomQuery;var k=j.responseXML;var l=n.selectNode("priorityname",k);if(document.getElementById(b)!=null&&l.firstChild!=null){document.getElementById(b).value=decodeURIComponent(l.firstChild.nodeValue)}if(d!=null&&document.getElementById(d)!=null){if(l.firstChild!=null){document.getElementById(d).value=decodeURIComponent(l.firstChild.nodeValue)}else{document.getElementById(d).value=""}}l=n.selectNode("priorityid",k);if(document.getElementById(e)!=null&&l.firstChild!=null){document.getElementById(e).value=decodeURIComponent(l.firstChild.nodeValue);var p=decodeURIComponent(l.firstChild.nodeValue);if(g!=p){if(f!=null){setIsPriorityChanged("true")}}else{if(f!=null){setIsPriorityChanged("false")}}}if(l.firstChild==null&&d!=null){document.getElementById(e).value="";document.getElementById(d).value="";document.getElementById(b).value=""}return}}})}function preAssignedToStaff(a){waitbox(0);assignedToStaff(a);if(a!=null&&a!="undefined"&&a!=""){handleChange()}}function preAssignTOQueue(a){waitbox(0);assignTOQueue(a);if(a!=null&&a!="undefined"&&a!=""){handleChange()}}function getCustomActionURL(customId){var probId=getProblemID();eval(orgNamespace).JSRemoteActions.getCustomActionURL("Problem__c",probId,customId,function(result,event){if(event.status){if(result!=""&&result!=null){urlStringVar=result;openUrl()}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:true})}function composeMailOnCompleteIn(){var a=document.getElementById("SIIframeID").style.display;if(window.frames.SIIframeID!=null&&typeof(window.frames.SIIframeID)!="undefined"){if(a!="none"){document.getElementById("SIIframeID").contentWindow.composeMailOnComplete()}}}function afterSaveAndClose(){if(errormsg==labelSavedSuccessfully){checkEnable();closePopup()}else{showError();document.getElementById(ProblemPageComp.ComponentVars.closedByID).value=prevCloseClosedById;document.getElementById(ProblemPageComp.ComponentVars.ProblemFormResolution).value=prevcloseResolution;document.getElementById(ProblemPageComp.ComponentVars.CategoryIDName).value=prevcloseCategoryId;document.getElementById(ProblemPageComp.ComponentVars.statusIdName).value=prevcloseStatusId;document.getElementById(ProblemPageComp.ComponentVars.closeDateID).value=prevcloseCloseDate}}function saveAndCloseJS(c,l,m,k,j,g,f,b,i){var n=document.getElementById(ProblemPageComp.ComponentVars.closedByID);prevCloseClosedById=n.value;n.value=c;var h=document.getElementById(ProblemPageComp.ComponentVars.ProblemFormResolution);prevcloseResolution=h.value;h.value=l;var a=document.getElementById(ProblemPageComp.ComponentVars.CategoryIDName);prevcloseCategoryId=a.value;a.value=m;var d=document.getElementById(ProblemPageComp.ComponentVars.statusIdName);prevcloseStatusId=d.value;d.value=k;var e=document.getElementById(ProblemPageComp.ComponentVars.closeDateID);prevcloseCloseDate=e.value;e.value=j;document.getElementById(ProblemPageComp.ComponentVars.updateStandDescId).value=g;document.getElementById(ProblemPageComp.ComponentVars.updateStandResId).value=f;document.getElementById(ProblemPageComp.ComponentVars.isCloseTasksId).value=b;document.getElementById(ProblemPageComp.ComponentVars.isCloseIncidentsId).value=i;saveFunction(saveAndCloseAction)}function checkEnable(){var b=getProblemID();if(errormsg==null||errormsg==""||errormsg==labelSavedSuccessfully){Ext.getCmp("assignToStaffButtonId").setDisabled(!problemState);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(!problemState);Ext.getCmp("emailId").setDisabled(!problemState);Ext.getCmp("closeButtonId").setDisabled(!problemState);Ext.getCmp("reopenButtonId").setDisabled(problemState);Ext.getCmp("assignToQueueButtonId").setDisabled(!problemState);Ext.getCmp("emailId").setDisabled(!problemState);var a=getAssignedToMyselfState();if(a||!problemState){Ext.getCmp("assignToMyselfButtonId").setDisabled(true)}else{Ext.getCmp("assignToMyselfButtonId").setDisabled(false)}}Ext.getCmp("saveId").setDisabled(!problemState)}function enableCpDelRes(){Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconClass("bmcDelete");Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("copyId").setIconClass("bmcCopy");if(!disableNextPrev){Ext.getCmp("prevId").setDisabled(false);Ext.getCmp("nextId").setDisabled(false)}Ext.getCmp("resetId").setDisabled(false)}function getAssignedToMyselfState(){if(problemOwnerId==""){return false}else{if(problemOwnerId!=null&&loggedInUserId!=problemOwnerId){return false}else{if(problemOwnerId!=null&&loggedInUserId==problemOwnerId){return true}}}};