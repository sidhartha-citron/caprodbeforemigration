var moduleCount="7";var progressBarScan;function submitAction(a){if(beforeUploadValidation(a)==false){var b=document.getElementById("loadingStatusDiv");if(b){b.style.display="inline"}submitFile()}}function beforeUploadValidation(b){if(b.files==undefined){return false}if(b.files.length==0){return true}if(b.files.length>0){var a=b.files[0].name;if(a.substr(a.length-".zip".length)!=".zip"){alert(ImportBestPracticeDataOnlyZipFile);return true}}if(b.files.length>0&&b.files[0].size>MaxFileSizeinBytes){alert(ImportBestPracticeDataFileSizeError);return true}return false}Ext.onReady(function(){parent.addHelpOnPage(document.getElementById("helpDiv"),"import_best_practices.htm",wikiUrl);if(currentStep=="SCANNING"&&currentScanSubStep==1){doScan()}Ext.create("Ext.button.Button",{text:importBtnLabel,id:"ImportBtn",disabled:"true",cls:"buttonCl1",renderTo:"next",handler:function(){Ext.getCmp("ImportBtn").disable();beforeImportValidationFunc(reuseService,reuseCategory,reuseTemplate,reuseSRD,reuseSLA)}});setFileUploaderForIE()});function doScan(){if(currentStep=="SCANNING"){hideOrShowEle("Scan_Section","show");var a=currentScanSubStep/moduleCount;if(currentScanSubStep==1){progressBarScan=new Ext.ProgressBar({style:"width: 60%",id:"progressBarScan",cls:"custom",textEl:"progress",renderTo:"progressBarScan"})}if(currentScanSubStep<=moduleCount){startScanFunc();progressBarScan.updateProgress(a,Math.round(100*a)+"%")}}else{if(currentStep=="SCANRESULT"){hideOrShowEle("Scan_Section","hide");Ext.getCmp("ImportBtn").enable();setRadioOnLoad()}else{if(currentStep=="FILEUPLOAD"){hideOrShowEle("Scan_Section","hide");setFileUploaderForIE()}}}}function beforeImportValidationFinish(){if(currentStep=="IMPORTING"){importStart()}if(currentStep=="SCANRESULT"){Ext.getCmp("ImportBtn").enable();hideOrShowEle("footerDivId","show");setRadioOnLoad()}}function importStart(){hideOrShowEle("downloadBestPracticesText","hide");hideOrShowEle("footerDivId","hide");var b=document.getElementById("frameBorderId");if(b){b.style.height="100%"}var a=document.getElementById("majorStep");if(a){RemedyForceHTMLProcessor.setText(a,importStep)}startImportFunc()}function importFinish(){Ext.getCmp("ImportBtn").hide()}function hideOrShowEle(a,c){var b=document.getElementById(a);if(b){if(c=="show"){b.style.display="block"}else{if(c=="hide"){b.style.display="none"}}}}function disableEnablePrefixField(){if(prefixRequired!="true"){var d=document.getElementsByTagName("input");var b=true;for(i=0;i<d.length;i++){if(d[i].id!=undefined&&d[i].id!=null&&d[i].id.indexOf("radioCreateNew")>-1&&d[i].checked==true){b=false;break}}var a=document.getElementById(prefixId);if(a){if(b==true){a.disabled="disabled"}else{a.removeAttribute("disabled")}}var c=document.getElementById("artistick");if(c){if(b==true){RemedyForceHTMLProcessor.setText(c," ")}else{RemedyForceHTMLProcessor.setText(c,"*")}}}}function setRadioOnLoad(){if(reuseService=="true"){setRadioFn("Bso_radioReuse")}else{setRadioFn("Bso_radioCreateNew")}if(reuseCategory=="true"){setRadioFn("Cat_radioReuse")}else{setRadioFn("Cat_radioCreateNew")}if(reuseTemplate=="true"){setRadioFn("Temp_radioReuse")}else{setRadioFn("Temp_radioCreateNew")}if(reuseSRD=="true"){setRadioFn("Srd_radioReuse")}else{setRadioFn("Srd_radioCreateNew")}if(reuseSLA=="true"){setRadioFn("Sla_radioReuse")}else{setRadioFn("Sla_radioCreateNew")}disableEnablePrefixField()}function setRadioFn(a){var b=document.getElementById(a);if(b){b.setAttribute("checked","true")}}function setFileUploaderForIE(){if(Ext.isIE||getIEVerGreaterThan10()){var a=document.getElementById(inputFileEle);if(a){a.style.width="78px"}}}function getIEVerGreaterThan10(){var a=false;if(navigator.userAgent.indexOf("Trident")!=-1){if((isNaN(navigator.userAgent.match(/(Trident.*rv[ :])([0-9]+)/)))&&(parseInt(navigator.userAgent.match(/(Trident.*rv[ :])([0-9]+)/)[2])>=11)){a=true}}return a};