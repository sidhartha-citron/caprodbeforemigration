var layoutTypeClickedOnce=false;function verifyParentWindows(){if(window.parent&&window.parent!=null&&typeof(window.parent)!="undefined"){if(window.parent.parent&&window.parent.parent!=null&&typeof(window.parent.parent)!="undefined"){return true}}return false}function handleChange(){if(isRFConsoleDetailForm){if(verifyParentWindows()){if(window.parent.TabPanel&&window.parent.TabPanel!=null&&typeof(window.parent.TabPanel)!="undefined"){if(window.parent.TabPanel.getActiveTab()!=null&&typeof(window.parent.TabPanel.getActiveTab())!="undefined"){var b=window.parent.TabPanel.getActiveTab();b.dirty=true;var a=b.title;if(!a.startsWith("*")){a="*"+a}window.parent.changeTabTitle(tabId,a);window.parent.updateDirtyFlag(tabId,true)}}}}}function handleSave(){clickedOnce=false;layoutTypeClickedOnce=false;if(isRFConsoleDetailForm){if(verifyParentWindows()){if(window.parent.TabPanel&&window.parent.TabPanel!=null&&typeof(window.parent.TabPanel)!="undefined"){if(window.parent.TabPanel.getActiveTab()!=null&&typeof(window.parent.TabPanel.getActiveTab())!="undefined"){var b=window.parent.TabPanel.getActiveTab();b.dirty=false;var a=b.title.replace("*","");window.parent.changeTabTitle(tabId,a);window.parent.updateDirtyFlag(tabId,false)}}}}}function showCloseWarning(b,a){Ext.Msg.defaultButton=2;Ext.Msg.baseCls="bmc-message";Ext.Msg.show({title:ConsoleCommonLabels.Labels.ConfirmAction,msg:ConsoleCommonLabels.Labels.labelcloseWindowLabel,buttons:Ext.Msg.YESNO,buttonText:{yes:ConsoleCommonLabels.Labels.Yes,no:ConsoleCommonLabels.Labels.No},fn:function(c){if(c=="yes"){handleSave();if(a&&a!=null&&typeof(a)!="undefined"){b(a)}else{b()}}},icon:Ext.MessageBox.WARNING});return false}function verifyChange(){return(clickedOnce||layoutTypeClickedOnce)}var submitForApproval=function(){var a=null;for(var c=0;c<window.frames.frames.length;c++){var b=window.frames.frames[c].name;if(b==="relatedListFrame"||b==="incidentRelatedListFrame"||b==="releaseRelatedListFrame"||b==="changeRelatedListFrame"||b==="problemRelatedListFrame"){a=window.frames.frames[c];break}}if(a!==null&&typeof a.SubmitforApproval=="undefined"){setTimeout(submitForApproval,1000)}else{a.SubmitforApproval();startWaitMsgBar()}};var submitforapprovalHandler=function(a,b){if(verifyChange()){confirmMsg()}else{submitForApproval()}};var sidebarPositionAttribute="right";if(userLanguage!=undefined&&userLanguage=="iw"){sidebarPositionAttribute="left"}function checkApprovalstatus(a){Visualforce.remoting.Manager.invokeAction(_RemotingActions.ISPendingApproval,recordId,function(b,c){if(c.type==="exception"){alert(c.message)}else{if(b==true){if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(true)}}else{if(Ext.getCmp("Submitforapproval")!=undefined&&Ext.getCmp("Submitforapproval")!=null){Ext.getCmp("Submitforapproval").setDisabled(false)}}if(a==true){stopWaitMsgBar();if(typeof isFocusOnIncidentForm!=="undefined"&&isFocusOnIncidentForm){startWaitMsgBar();loadIncidentDetail(recordId)}if(typeof isFocusOnChangeForm!=="undefined"&&isFocusOnChangeForm){startWaitMsgBar();loadChangeDetail(recordId)}if(typeof isFocusOnProblemForm!=="undefined"&&isFocusOnProblemForm){startWaitMsgBar();loadProblemDetail(recordId)}if(typeof isFocusOnReleaseForm!=="undefined"&&isFocusOnReleaseForm){startWaitMsgBar();loadReleaseDetail(recordId)}if(typeof isFocusOnBroadcastForm!=="undefined"&&isFocusOnBroadcastForm){startWaitMsgBar();loadBroadcastDetail(recordId)}if(typeof isFocusOnForm!=="undefined"&&isFocusOnForm){startWaitMsgBar();loadTaskDetail(recordId)}}}},{escape:true})}var isSidebarInExpandedMode=false;var isSidebarActionClicked=false;var displayActivityFeed=false;var displayCISidebar=false;var isCalledFromActivityFeed=false;var isActivityFeedInExpandedMode=false;function showsmartview(){if(hasActivityFeedPermission!=undefined){if(hasActivityFeedPermission==true){makeActivityFeedVisible()}else{showSmartViewsError(isLoggedInUserAdmin)}}else{checkSmartViewAccess(true)}hideCISmartview();var b=document.getElementById("relatedCIExpandCollapseIcon");if(b){b.style.display="none"}var a=document.getElementById("relatedCIExpandCollapseIcon2");if(a&&isBaseElementAccessible==true){if(isCISidebarEnabled==true){a.style.display="block"}else{a.style.display="none"}}}function hidesmartview(){var f=document.getElementById("DetailFormDiv");var c=document.getElementById("sidebarcontainer");var e=document.getElementById("relatedCIExpandCollapseIcon");if(e){e.style.display="block"}var b=0;if(typeof f!=="undefined"&&f!=null&&typeof c!="undefined"&&c!=null){if(isSidebarInExpandedMode==true){b=(f.offsetWidth)*0.75}else{b=(f.offsetWidth)*0.37}c.style[sidebarPositionAttribute]="-"+b.toString()+"px";var d=document.getElementById("relatedCIExpandCollapseIcon2");if(d){d.style.display="none"}}var a=document.getElementById("hidebuttonSmartView");if(a!=undefined&&a!=null){a.style.display="none"}var g=document.getElementById("activityFeedExpandCollapseIcon");if(g!=undefined&&g!=null){g.style.display="block"}if(displayActivityFeed==true){showActivityFeed()}hideMask();setSidebarUserPreference(false);isActivityFeedInExpandedMode=false}function collapseSideBar(){var d=document.getElementById("DetailFormDiv");var c=document.getElementById("sidebarWrapper");var b=document.getElementById("activityFeedHeaderRow");if(typeof d!="undefined"&&d!=null&&typeof c!="undefined"&&c!=null){var a=(d.offsetWidth)*0.37;c.style.width=a.toString()+"px";if(b!=undefined&&b!=undefined){b.style.width=a.toString()+"px"}}isSidebarInExpandedMode=false}function expandSideBar(){var d=document.getElementById("DetailFormDiv");var c=document.getElementById("sidebarWrapper");var b=document.getElementById("activityFeedHeaderRow");if(typeof d!="undefined"&&d!=null&&typeof c!="undefined"&&c!=null){var a=(d.offsetWidth)*0.75;c.style.width=a.toString()+"px";if(b!=undefined&&b!=undefined){b.style.width=a.toString()+"px"}}isSidebarInExpandedMode=true}function enableActivityFeed(){if(isActivityFeedEnabled==true){var a=getSidebarUserPreference();if(a=="true"){var b=document.getElementById("activityFeedExpandCollapseIcon2");if(b){b.style.display="block"}var c=false;if(verifyParentWindows()){if(window.parent.TabPanel&&window.parent.TabPanel!=null&&typeof(window.parent.TabPanel)!="undefined"){if(window.parent.TabPanel.getActiveTab()!=null&&typeof(window.parent.TabPanel.getActiveTab())!="undefined"){var d=window.parent.TabPanel.getActiveTab();c=d.dirty}}}if(c==true){hidesmartview()}else{showsmartview()}}else{hidesmartview()}resizeActivityFeed()}}function isFocusOnFormTab(){if((typeof(isFocusOnIncidentForm)!="undefined"&&isFocusOnIncidentForm)||(typeof(isFocusOnChangeForm)!="undefined"&&isFocusOnChangeForm)||(typeof(isFocusOnProblemForm)!="undefined"&&isFocusOnProblemForm)||(typeof(isFocusOnReleaseForm)!="undefined"&&isFocusOnReleaseForm)||(typeof(isFocusOnForm)!="undefined"&&isFocusOnForm)){return true}else{return false}}function hideActivityFeed(){var a=document.getElementById("sidebarcontainer");if(a!=undefined&&a!=null){a.style.display="none"}displayActivityFeed=false}function showActivityFeed(){var a=document.getElementById("sidebarcontainer");if(a!=undefined&&a!=null){a.style.display="block"}}function makeActivityFeedVisible(){var c=document.getElementById("activityFeedExpandCollapseIcon");if(c!=undefined&&c!=null){c.style.display="none"}var b=document.getElementById("sidebarcontainer");if(b!=undefined&&b!=null){b.style[sidebarPositionAttribute]="0px"}setSidebarUserPreference(true);isActivityFeedInExpandedMode=true;if(displayActivityFeed==true){showActivityFeed()}var a=document.getElementById("hidebuttonSmartView");if(a!=undefined&&a!=null){a.style.display="block"}if(typeof hideSmartsuggestions=="function"){hideSmartsuggestions()}if(isSidebarActionClicked==true){showMask()}}function showMask(){var b=document.getElementById("maskActivityFeedParentFrame");if(typeof b!=="undefined"&&b!=null){var a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;b.style.width=a.toString()+"px";b.style.display="block"}}function hideMask(){var a=document.getElementById("maskActivityFeedParentFrame");if(typeof a!=="undefined"&&a!=null){a.style.display="none"}}function setSidebarUserPreference(b){var a=new Date();var c=new Date(a.getTime()+(365*24*60*60*1000)*10);document.cookie="isActivityFeedExpanded="+b+";expires="+c.toUTCString()+";path=/;SameSite=None;Secure"}function getSidebarUserPreference(){if(Ext.util.Cookies.get("isActivityFeedExpanded")!=null){return Ext.util.Cookies.get("isActivityFeedExpanded")}else{return false}}function resizeActivityFeed(){var d=document.getElementById("DetailFormDiv");var e=document.getElementById("sidebarWrapper");var c=document.getElementById("activityFeedHeaderRow");if(typeof d!="undefined"&&d!=null&&typeof e!="undefined"&&e!=null){var a=d.innerWidth||d.clientWidth;if(isSidebarInExpandedMode==true){a=(a)*0.75}else{a=(a)*0.37}var b=document.getElementById("sidebarcontainer");if(isActivityFeedInExpandedMode==true){b.style[sidebarPositionAttribute]="0px"}else{b.style[sidebarPositionAttribute]="-"+a.toString()+"px"}e.style.width=a.toString()+"px";if(c!=undefined&&c!=undefined){c.style.width=a.toString()+"px"}}}function createSLASubIcon(d,b,a){while(d.firstChild){d.removeChild(d.firstChild)}var c=document.createElement("i");if(b==a.Labels.ServiceTargetsMissed){c.className="ServiceTargetSubIcon ServiceTargetMissedSubIcon d-icon-cross_circle "}else{if(b==a.Labels.ServiceTargetsWarning){c.className="ServiceTargetSubIcon ServiceTargetWarningSubIcon d-icon-exclamation_triangle "}}d.appendChild(c)}function activityFeedRefreshStarted(){var b=document.getElementById("sidebarWrapper");if(typeof b!="undefined"&&b!=null){b.style.display="none"}var a=document.getElementById("sideBarloader");if(typeof a!="undefined"&&a!=null){a.style.display="block"}}function activityFeedDataLoadStarted(){var b=document.getElementById("sidebarWrapper");if(typeof b!="undefined"&&b!=null){b.style.display="block"}var a=document.getElementById("sideBarloader");if(typeof a!="undefined"&&a!=null){a.style.display="none"}}function RelatedCIRefreshStarted(){var a=document.getElementById("ciSidebarWrapper");if(typeof a!="undefined"&&a!=null){a.style.display="none"}var b=document.getElementById("ciSideBarloader");if(typeof b!="undefined"&&b!=null){b.style.display="block"}}function RelatedCIDataLoadStarted(){var a=document.getElementById("ciSidebarWrapper");if(typeof a!="undefined"&&a!=null){a.style.display="block"}var b=document.getElementById("ciSideBarloader");if(typeof b!="undefined"&&b!=null){b.style.display="none"}}if(!String.prototype.startsWith){String.prototype.startsWith=function(a,b){return this.substr(!b||b<0?0:+b,a.length)===a}}var isCIFeedInExpandedMode=false;function setSidebarUserPreferenceForCi(b){var a=new Date();var c=new Date(a.getTime()+(365*24*60*60*1000)*10);document.cookie="isCIFeedExpanded="+b+";expires="+c.toUTCString()+";path=/;SameSite=None;Secure"}function getSidebarUserPreferenceForCi(){if(Ext.util.Cookies.get("isCIFeedExpanded")!=null){return Ext.util.Cookies.get("isCIFeedExpanded")}else{return false}}function showCISmartview(){if(isBaseElementAccessible==true){hidesmartview();makeRelatedCIVisible();var a=document.getElementById("activityFeedExpandCollapseIcon2");if(a){if(isActivityFeedEnabled==true){a.style.display="block"}else{a.style.display="none"}}var b=document.getElementById("ciSidebarcontainer");if(b!=undefined&&b!=null){b.style.top="0px"}}}function makeRelatedCIVisible(){var c=document.getElementById("relatedCIExpandCollapseIcon");if(c!=undefined&&c!=null){c.style.display="none"}var b=document.getElementById("ciSidebarcontainer");if(b!=undefined&&b!=null){b.style[sidebarPositionAttribute]="0px"}setSidebarUserPreferenceForCi(true);isCIFeedInExpandedMode=true;if(displayCISidebar==true){showRelatedCI()}var a=document.getElementById("hidebuttonCISmartView");if(a!=undefined&&a!=null){a.style.display="block"}if(typeof hideSmartsuggestions=="function"){hideSmartsuggestions()}if(isSidebarActionClicked==true){showMask()}}function showRelatedCI(){var a=document.getElementById("ciSidebarcontainer");if(a!=undefined&&a!=null){a.style.display="block"}}function hideCISmartview(){var f=document.getElementById("ciSidebarcontainer");var e=document.getElementById("ciSidebarWrapper");if(typeof f!="undefined"&&f!=null&&e){f.style[sidebarPositionAttribute]="-"+e.offsetWidth+"px";var c=document.getElementById("activityFeedExpandCollapseIcon2");if(isActivityFeedEnabled==true){f.style.top="150px"}else{f.style.top="0px"}c.style.display="none"}var d=document.getElementById("relatedCIExpandCollapseIcon");var b=getSidebarUserPreference();if(d){if(b=="true"){d.style.display="none"}else{d.style.display="block"}}var a=document.getElementById("hidebuttonCISmartView");if(a!=undefined&&a!=null){a.style.display="none"}if(displayCISidebar==true){showRelatedCI()}hideMask();setSidebarUserPreferenceForCi(false);isCIFeedInExpandedMode=false}function showRelatedCI(){if(isBaseElementAccessible&&(typeof isFocusOnRelatedList==="undefined"||!isFocusOnRelatedList)&&(typeof isFocusOnSmartView==="undefined"||!isFocusOnSmartView)){var a=document.getElementById("ciSidebarcontainer");if(a!=undefined&&a!=null){a.style.display="block"}var b=document.getElementById("ciSidebarWrapper");if(typeof b!="undefined"&&b!=null){b.style.display="block"}}}function hideRelatedCI(){var a=document.getElementById("ciSidebarcontainer");if(a!=undefined&&a!=null){a.style.display="none"}displayCISidebar=false}function enableRelatedCI(){if(isCISidebarEnabled==true){var a=getSidebarUserPreferenceForCi();if(a=="true"){var b=false;if(verifyParentWindows()){if(window.parent.TabPanel&&window.parent.TabPanel!=null&&typeof(window.parent.TabPanel)!="undefined"){if(window.parent.TabPanel.getActiveTab()!=null&&typeof(window.parent.TabPanel.getActiveTab())!="undefined"){var c=window.parent.TabPanel.getActiveTab();b=c.dirty}}}if(b==true){hideCISmartview()}else{showCISmartview()}}else{hideCISmartview()}resizeRelatedCI()}}function resizeRelatedCI(){var d=document.getElementById("DetailFormDiv");var e=document.getElementById("ciSidebarWrapper");var c=document.getElementById("relatedCIHeaderRow");if(typeof d!="undefined"&&d!=null&&typeof e!="undefined"&&e!=null){var a=d.innerWidth||d.clientWidth;if(isSidebarInExpandedMode==true){a=(a)*0.75}else{a=(a)*0.37}var b=document.getElementById("ciSidebarcontainer");if(isCIFeedInExpandedMode==true){b.style[sidebarPositionAttribute]="0px"}else{b.style[sidebarPositionAttribute]="-"+a.toString()+"px"}e.style.width=a.toString()+"px";if(c!=undefined&&c!=undefined){c.style.width=a.toString()+"px"}}}function addAnimation(b){var a;if(b=="activity"){a=document.getElementById("sidebarcontainer")}else{a=document.getElementById("ciSidebarcontainer")}if(a){a.style["-webkit-transition-duration"]="1s";a.style["-moz-transition-duration"]="1s";a.style["transition-duration"]="1s";a.style["-o-transition-duration"]="1s"}}function removeAnimation(c){var a=document.getElementById("sidebarcontainer");if(a){a.style["-webkit-transition-duration"]="0s";a.style["-moz-transition-duration"]="0s";a.style["transition-duration"]="0s";a.style["-o-transition-duration"]="0s"}var b=document.getElementById("ciSidebarcontainer");if(b){b.style["-webkit-transition-duration"]="0s";b.style["-moz-transition-duration"]="0s";b.style["transition-duration"]="0s";b.style["-o-transition-duration"]="0s"}}function refreshCISlider(){var a=document.getElementById("relatedCISmartViewSidebarFrameId");if(a){a.contentWindow.refreshAll()}};