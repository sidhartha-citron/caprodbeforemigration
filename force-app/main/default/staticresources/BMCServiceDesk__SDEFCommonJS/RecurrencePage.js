var endDateTooltip;var tempRecType;Ext.onReady(function(){Ext.QuickTips.init();Ext.define("RecurrenceFieldModel",{extend:"Ext.data.Model",fields:[{name:"value",type:"string"},{name:"label",type:"string"}]});var u=Ext.create("Ext.data.Store",{model:"RecurrenceFieldModel",data:RecTypeJSON});var o=Ext.create("Ext.form.ComboBox",{id:"recTypeCombo",store:u,queryMode:"local",displayField:"label",valueField:"value",renderTo:"recurrenceTypeDiv",style:"font: 11px Tahoma,MS sans-serif",editable:false,forceSelection:true,width:190,listeners:{select:function(y,D,E){recType=D[0].get(y.valueField);adjustRecurrenceFrequency(recType.charAt(0));if(recType=="daily"){var B=document.getElementsByName("recd");for(var C=0;C<B.length;C++){if(B[C].checked){recType=B[C].value;if(recType=="d0"){recInterval=Ext.getCmp("recDailyIntervalText").getValue();setRecurrenceValues("d0")}else{recDayOfWeekMask="12345";setRecurrenceValues("d1")}}}}else{if(recType=="weekly"){recinterval=Ext.getCmp("recWeekIntervalText").getValue();recDayOfWeekMask="";for(var C=0;C<7;C++){var z=C.toString();var G=document.getElementById(z);if(G.checked){recDayOfWeekMask+=G.id}}if(recDayOfWeekMask=="0123456"){recType="wd1";setRecurrenceValues("wd1")}else{recType="wd0";setRecurrenceValues("wd0")}}else{if(recType=="monthly"){recinterval=Ext.getCmp("recMonIntervalText").getValue();var F=document.getElementsByName("recm");for(var C=0;C<F.length;C++){if(F[C].checked&&F[C].value=="m0"){recType="m0";recDayOfMonth=Ext.getCmp("recMonDayText").getValue();setRecurrenceValues("m0")}else{if(F[C].checked&&F[C].value=="m1"){recType="m1";recInstance=Ext.getCmp("monRecDayInstCombo").getValue();recDayOfWeekMask=Ext.getCmp("monRecDayOfWeekCombo").getValue();setRecurrenceValues("m1")}}}}else{if(recType=="yearly"){var A=document.getElementsByName("recy");for(var C=0;C<A.length;C++){if(A[C].checked&&A[C].value=="y0"){recType="y0";recMonthOfYear=Ext.getCmp("yearRecMonthCombo").getValue();recDayOfMonth=Ext.getCmp("yearRecDayOfMonText").getValue();setRecurrenceValues("y0")}else{if(A[C].checked&&A[C].value=="y1"){recType="y1";recInstance=Ext.getCmp("yearRecDayInstCombo").getValue();recDayOfWeekMask=Ext.getCmp("yearRecDayOfWeekCombo").getValue();recMonthOfYear=Ext.getCmp("recYearDayInstanceMonthCombo").getValue();setRecurrenceValues("y1")}}}}}}}}}});var r=Ext.create("Ext.form.field.Number",{id:"recDailyIntervalText",value:1,minValue:1,maxValue:99,renderTo:"recDailyIntervalDiv",editable:true,allowDecimals:false,width:40,listeners:{change:function(A,B,y,z){if(B>0&&B<=99){recInterval=B;document.getElementById("d0").checked=true;setRecurrenceValues("d0")}else{this.setValue(y)}}}});var l=Ext.create("Ext.form.field.Number",{id:"recWeekIntervalText",value:1,minValue:1,maxValue:52,renderTo:"recWeekIntervalDiv",editable:true,allowDecimals:false,width:40,listeners:{change:function(A,B,y,z){if(B>0&&B<=52){recInterval=B}else{this.setValue(y)}}}});var a=Ext.create("Ext.form.field.Number",{id:"recMonIntervalText",value:1,minValue:1,maxValue:12,renderTo:"recMonIntervalDiv",editable:true,allowDecimals:false,width:40,listeners:{change:function(A,B,y,z){if(B>0&&B<=12){recInterval=B}else{this.setValue(y)}}}});var w=Ext.create("Ext.form.field.Number",{id:"recMonDayText",value:1,minValue:1,maxValue:31,renderTo:"recMonDayDiv",editable:true,allowDecimals:false,width:40,listeners:{change:function(A,B,y,z){if(B>0&&B<=31){document.getElementById("m0").checked=true;recType="m0";recDayOfMonth=B;setRecurrenceValues("m0")}else{this.setValue(y)}}}});var p=Ext.create("Ext.data.Store",{model:"RecurrenceFieldModel",data:RecInstanceJSON});var e=Ext.create("Ext.form.ComboBox",{id:"monRecDayInstCombo",store:p,queryMode:"local",displayField:"label",valueField:"value",renderTo:"recMonDayInstance",style:"font: 11px Tahoma,MS sans-serif",editable:false,forceSelection:true,width:100,listeners:{select:function(A,y,z){document.getElementById("m1").checked=true;recType="m1";recInstance=A.getValue();setRecurrenceValues("m1")}}});var k=Ext.create("Ext.data.Store",{model:"RecurrenceFieldModel",data:RecDayOfWeekListJSON});var x=Ext.create("Ext.form.ComboBox",{id:"monRecDayOfWeekCombo",store:k,queryMode:"local",displayField:"label",valueField:"value",renderTo:"recMonDayOfWeek",style:"font: 11px Tahoma,MS sans-serif",editable:false,forceSelection:true,width:100,listeners:{select:function(A,y,z){document.getElementById("m1").checked=true;recType="m1";recDayOfWeekMask=A.getValue();setRecurrenceValues("m1")}}});var q=Ext.create("Ext.data.Store",{model:"RecurrenceFieldModel",data:RecMonthOfYearJSON});var f=Ext.create("Ext.form.ComboBox",{id:"yearRecMonthCombo",store:q,queryMode:"local",displayField:"label",valueField:"value",renderTo:"recYearMonth",style:"font: 11px Tahoma,MS sans-serif",editable:false,forceSelection:true,width:140,listeners:{select:function(A,y,z){document.getElementById("y0").checked=true;recMonthOfYear=A.getValue();recType="y0";setRecurrenceValues("y0")}}});var j=Ext.create("Ext.form.field.Number",{id:"yearRecDayOfMonText",value:1,minValue:1,maxValue:31,renderTo:"recYearMonthDayDiv",editable:true,allowDecimals:false,width:40,listeners:{change:function(A,B,y,z){if(B>0&&B<=31){document.getElementById("y0").checked=true;recDayOfMonth=B;recType="y0";setRecurrenceValues("y0")}else{this.setValue(y)}}}});var c=Ext.create("Ext.data.Store",{model:"RecurrenceFieldModel",data:RecInstanceJSON});var s=Ext.create("Ext.form.ComboBox",{id:"yearRecDayInstCombo",store:c,queryMode:"local",displayField:"label",valueField:"value",renderTo:"recYearDayInstance",style:"font: 11px Tahoma,MS sans-serif",editable:false,forceSelection:true,width:115,listeners:{select:function(A,y,z){document.getElementById("y1").checked=true;recInstance=A.getValue();recType="y1";setRecurrenceValues("y1")}}});var n=Ext.create("Ext.data.Store",{model:"RecurrenceFieldModel",data:RecDayOfWeekListJSON});var b=Ext.create("Ext.form.ComboBox",{id:"yearRecDayOfWeekCombo",store:n,queryMode:"local",displayField:"label",valueField:"value",renderTo:"recYearDayOfWeek",style:"font: 11px Tahoma,MS sans-serif",editable:false,width:95,forceSelection:true,listeners:{select:function(A,y,z){document.getElementById("y1").checked=true;recDayOfWeekMask=A.getValue();recType="y1";setRecurrenceValues("y1")}}});var t=Ext.create("Ext.data.Store",{model:"RecurrenceFieldModel",data:RecMonthOfYearJSON});var h=Ext.create("Ext.form.ComboBox",{id:"recYearDayInstanceMonthCombo",store:t,queryMode:"local",displayField:"label",valueField:"value",renderTo:"recYearDayInstanceMonth",style:"font: 11px Tahoma,MS sans-serif",editable:false,forceSelection:true,width:95,listeners:{select:function(A,y,z){document.getElementById("y1").checked=true;recMonthOfYear=A.getValue();recType="y1";setRecurrenceValues("y1")}}});var m=Ext.create("Ext.form.field.Number",{id:"recTimeHrsText",minValue:0,maxValue:12,maxLength:2,renderTo:"recurrenceTimeHrsDiv",editable:true,allowDecimals:false,width:40,listeners:{change:function(A,B,y,z){if(B>=0&&B<=12){recTimeHrs=B}else{this.setValue(y)}}}});if(isNewRec){m.setValue(8)}else{m.setValue(recTimeHrs)}var v=Ext.create("Ext.form.field.Number",{id:"recTimeMinText",minValue:0,maxValue:59,maxLength:2,renderTo:"recurrenceTimeMinDiv",editable:true,allowDecimals:false,width:40,listeners:{change:function(A,B,y,z){if(B==""||B==null){this.setValue(0);recTimeMin=0}if(B>=0&&B<=59){recTimeMin=B}else{this.setValue(y)}}}});if(isNewRec){v.setValue(0)}else{v.setValue(recTimeMin)}var d=Ext.create("Ext.data.Store",{model:"RecurrenceFieldModel",data:RecAMPMListJSON});var g=Ext.create("Ext.form.ComboBox",{id:"recTimeFrameCombo",store:d,queryMode:"local",displayField:"label",valueField:"value",renderTo:"recurrenceTimeFrameDiv",style:"font: 11px Tahoma,MS sans-serif",editable:false,forceSelection:true,width:45,listConfig:{minWidth:45},listeners:{select:function(A,y,z){recTimeFrame=A.getValue()}}});x.setValue("1");e.setValue("1");f.setValue("1");s.setValue("1");b.setValue("1");h.setValue("1");g.setValue(recTimeFrame);if(isNewRec){o.setValue("weekly");adjustRecurrenceFrequency("wd0");setRecurrenceValues(recType)}else{setUiEleValuesAsPerRecurrenceOnLoad()}waitMask=new Ext.LoadMask("mainDiv",{msg:"Please Wait..."});endDateTooltip=new Ext.ToolTip({target:"fieldInfobtn",title:"",anchor:"right",width:200,trackMouse:true,shadow:"sides",bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",dismissDelay:20000,html:calculateEndDateTip})});function refreshParentOnSave(){waitMask.hide();showMsg();if(isSavedSuccessfully){window.parent.resetTemplate()}else{if(!isSavedSuccessfully){setRecValues()}}}function refreshParentOnRemove(){waitMask.hide();if(message!=""){showMsg()}else{window.parent.resetOnRecurrenceRemove();window.parent.closePopup()}}function adjustRecurrenceFrequency(d){var c="dwmy";for(i=0;i<c.length;i++){var f=document.getElementById(c.charAt(i));if(f!=null){f.style.display="none"}}f=document.getElementById(d.charAt(0));if(f!=null){f.style.display=""}rectype=d}function setWeekDayVal(a){recDayOfWeekMask=getDaysOfWeekMaskForWeeklyRec();if(recDayOfWeekMask=="0123456"){recType="wd1"}else{recType="wd0"}}function getDaysOfWeekMaskForWeeklyRec(){var b="";for(var c=0;c<7;c++){var a=c.toString();var d=document.getElementById(a);if(d.checked){b+=d.id}}return b}function saveBtnHandler(){if(availableInSS!=""){message=errorStrForSS;showMsg();return}tempRecType=recType;if(recType=="wd0"&&recDayOfWeekMask==""){message=errorStrForWeeklyRec;showMsg()}else{waitMask.show();saveRecurrence(recType,recInterval,recDayOfWeekMask,recDayOfMonth,recInstance,recMonthOfYear,recTimeHrs,recTimeMin,recTimeFrame)}}function removeRecurrence(){waitMask.show();removeTemplateRecurrence()}function setRecurrenceValues(a){if(a=="d0"){recType="d0";recInterval=Ext.getCmp("recDailyIntervalText").getValue();recDayOfWeekMask="";recDayOfMonth="";recInstance="";recMonthOfYear=""}else{if(a=="d1"){recType="d1";recInterval="";recDayOfWeekMask="12345";recDayOfMonth="";recInstance="";recMonthOfYear=""}else{if(a=="wd0"){recType="wd0";recInterval=Ext.getCmp("recWeekIntervalText").getValue();recDayOfWeekMask=getDaysOfWeekMaskForWeeklyRec();recDayOfMonth="";recInstance="";recMonthOfYear=""}else{if(a=="wd1"){recType="wd1";recInterval=Ext.getCmp("recWeekIntervalText").getValue();recDayOfWeekMask="0123456";recDayOfMonth="";recInstance="";recMonthOfYear=""}else{if(a=="m0"){recType="m0";recInterval=Ext.getCmp("recMonIntervalText").getValue();recDayOfWeekMask="";recDayOfMonth=Ext.getCmp("recMonDayText").getValue();recInstance="";recMonthOfYear=""}else{if(a=="m1"){recType="m1";recInterval=Ext.getCmp("recMonIntervalText").getValue();recDayOfWeekMask=Ext.getCmp("monRecDayOfWeekCombo").getValue();recDayOfMonth="";recInstance=Ext.getCmp("monRecDayInstCombo").getValue();recMonthOfYear=""}else{if(a=="y0"){recType="y0";recInterval="";recDayOfWeekMask="";recDayOfMonth=Ext.getCmp("yearRecDayOfMonText").getValue();if(isNewRec){recMonthOfYear=Ext.getCmp("yearRecMonthCombo").getValue()}recInstance=""}else{if(a=="y1"){recType="y1";recInterval="";recDayOfWeekMask=Ext.getCmp("yearRecDayOfWeekCombo").getValue();recDayOfMonth="";recInstance=Ext.getCmp("yearRecDayInstCombo").getValue();recMonthOfYear=Ext.getCmp("recYearDayInstanceMonthCombo").getValue()}}}}}}}}}waitMask=new Ext.LoadMask("mainDiv",{msg:"Please Wait..."});function showMsg(){var c=50;var a=300;if(message!=null&&message.length>60){c=70}var b=Ext.Msg.show({title:"",msg:message,width:a,height:c,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}function setUiEleValuesAsPerRecurrenceOnLoad(){if(recType=="d0"){Ext.getCmp("recDailyIntervalText").setValue(recInterval);Ext.getCmp("recTypeCombo").setValue("daily");adjustRecurrenceFrequency("d")}else{if(recType=="d1"||recType=="wd0"||recType=="wd1"){for(var c=0;c<recDayOfWeekMask.length;c++){var a=recDayOfWeekMask.charAt(c);document.getElementById(a).checked=true}if(recType=="d1"){Ext.getCmp("recTypeCombo").setValue("daily");adjustRecurrenceFrequency("d")}else{if(recType=="wd0"){Ext.getCmp("recWeekIntervalText").setValue(recInterval);Ext.getCmp("recTypeCombo").setValue("weekly");adjustRecurrenceFrequency("w")}else{if(recType=="wd1"){Ext.getCmp("recTypeCombo").setValue("weekly");adjustRecurrenceFrequency("w")}}}}else{if(recType=="m0"){Ext.getCmp("recTypeCombo").setValue("monthly");Ext.getCmp("recMonIntervalText").setValue(recInterval);Ext.getCmp("recMonDayText").setValue(recDayOfMonth);adjustRecurrenceFrequency("m")}else{if(recType=="m1"){Ext.getCmp("recTypeCombo").setValue("monthly");Ext.getCmp("recMonIntervalText").setValue(recInterval);Ext.getCmp("monRecDayOfWeekCombo").setValue(recDayOfWeekMask);Ext.getCmp("monRecDayInstCombo").setValue(recInstance);adjustRecurrenceFrequency("m")}else{if(recType=="y0"){Ext.getCmp("recTypeCombo").setValue("yearly");Ext.getCmp("yearRecDayOfMonText").setValue(recDayOfMonth);Ext.getCmp("yearRecMonthCombo").setValue(recMonthOfYear);adjustRecurrenceFrequency("y")}else{if(recType=="y1"){Ext.getCmp("recTypeCombo").setValue("yearly");Ext.getCmp("yearRecDayOfWeekCombo").setValue(recDayOfWeekMask);Ext.getCmp("yearRecDayInstCombo").setValue(recInstance);Ext.getCmp("recYearDayInstanceMonthCombo").setValue(recMonthOfYear);adjustRecurrenceFrequency("y")}}}}}}var b=document.getElementById(recType);if(b!=null){b.checked=true}}function assignApexErrorMessage(){var c=document.getElementById("apexMessageErrorPanelDiv");if(c!=null&&c.firstChild!=null){var e=c.firstChild;var a="";for(var b=0;b<e.childNodes.length;b++){var d=e.childNodes[b];a+=d.innerText}setRecValues();Ext.Msg.show({msg:a,buttons:Ext.MessageBox.OK,icon:Ext.Msg.INFO});isError=true}else{isError=false}}function showInfoPopup(){endDateTooltip.show()}function fieldInfo_out(a){document.getElementById(a.id).src=infoIconSrc}function calcEndDate(){if(recType=="wd0"&&recDayOfWeekMask==""){message=errorStrForWeeklyRec;showMsg()}else{tempRecType=recType;waitMask.show();calculateRecurrenceEndDate(recType,recInterval,recDayOfWeekMask,recDayOfMonth,recInstance,recMonthOfYear,recTimeHrs,recTimeMin,recTimeFrame)}}function setRecValues(){recType=tempRecType;if(recType!=null){setRecurrenceValues(recType)}recTimeHrs=Ext.getCmp("recTimeHrsText").getValue();recTimeMin=Ext.getCmp("recTimeMinText").getValue();recTimeFrame=Ext.getCmp("recTimeFrameCombo").getValue()};