var tb,skyWindow,splitButton,saveButton,addButton,SaveBtnHandler,index=1,windowIndex=0,tabIndex=0,splitIndex=0,counter=0,maximizedArray=new Array(),minimizedArray=new Array(),isQVRefreshing=false,wSequence=0,refreshQuickViewArray=new Array(),xOnMove=0;yOnMove=0;widgetsSequence=new Array();function setPopUpVar(a){if(a!=null&&a!=""&&onCompleteFunction!=null){onCompleteFunction(a)}}function openPopup(a,b){onCompleteFunction=b;popUpWindow=new Ext.Window({height:550,width:670,modal:true,constrain:true,viewConfig:{forceFit:true},html:'<iframe src ="/apex/'+a+'" style="width:100%;height:100%;border:none"/>'});popUpWindow.show()}function closePopup(){popUpWindow.close()}function activateWindow(a){if(a!=null&&a!=""){Ext.getCmp(a).show()}}function activateBtn(){var a=document.getElementById("btnID");if(a!=null&&Ext.isIE8){a.style.background="white";a.fireEvent("onclick")}}function pressTabForIE8(a){if(a!=null&&a!=""){colorChange(a);Ext.getCmp(a).toFront();activateAddBtn()}}function activateAddBtn(){var a=document.getElementById("addButtonId");if(a!=null&&Ext.isIE8){a.fireEvent("onmouseover")}}function activateBtnForIE(b,a){refreshQuickViewArray[b]=a}function addTab(f,b,a,j,g,h,c,i,e){counter++;if(i==null){i=false}if(e==null){e=false}tempIndexTab=index++;if(window.parent.getQVWidgetViews(c)==null){window.parent.setQVWidgetViews(c,"tableView")}var d=getTabTitle(h);if(Ext.get("tabId"+g)==null){tb.add({id:"tabId"+g,text:d,tooltipType:"title",tooltip:h,width:92,enableToggle:true,listeners:{toggle:onItemToggle},pressed:true});tb.add({id:"spacerId"+g,xtype:"spacer",width:5});if(Ext.get("splitId"+g)==null){splitButton.menu.add({id:"splitId"+g,text:h,checked:false,group:"sBtnItemGroup",handler:onItemCheck})}}tb.doLayout(true,true);openPanel(f,b,a,j,g,h,c,i,e)}function openPanel(f,c,b,h,g,i,d,l,e){var f=parseInt(f);var c=parseInt(c);var a=parseInt(b);var m=parseInt(h);var k=i;var j="/apex/QuickViewPage?queryName="+d+"&widgetId="+g;win2=new Ext.Window({id:g,title:i,renderTo:skyWindow.body,constrain:true,maximizable:true,minimizable:true,resizable:true,height:m,width:a,cls:"headerBlue",x:f,y:c,frame:false,shadow:false,xOnMove:xOnMove,yOnMove:yOnMove,tools:[{id:"help",handler:function(){if(wikiUrl!=null&&wikiUrl!=""&&typeof(wikiUrl)!="undefined"&&isNewContextpage()){window.open(wikiUrl)}else{OpenHelppage("DashBoard","module","form")}}}],defaultButton:"tabId"+g,html:'<iframe id="container" src="'+j+'" name="'+g+'" style="width:100%;height:100%;border:none"></iframe>',listeners:{close:function(){counter--;var q=Ext.getCmp("tabId"+g);var n=Ext.getCmp("spacerId"+g);var p=Ext.getCmp("splitButtonId");if(q.xtbHidden==true){tb.getLayout().unhideItem(q)}if(n.xtbHidden==true){tb.getLayout().unhideItem(n)}tb.remove(q,true);p.menu.remove("splitId"+g,true);tb.remove(n,true);for(var o in widgetsSequence){if(widgetsSequence[o][0]==g){delete widgetsSequence[o]}}window.parent.setQVWidgetViews(d,null);tb.doLayout(true,true)},minimize:function(){minimizedArray.push(this.id);var n=0;while(maximizedArray.length>n){if(this.id==maximizedArray[n]){maximizedArray.splice(n,1);break}n++}this.setAnimateTarget(this.defaultButton);this.hide()},maximize:function(){var n=0;while(minimizedArray.length>n){if(this.id==minimizedArray[n]){minimizedArray.splice(n,1);break}n++}maximizedArray.push(this.id);this.focus();db=this.defaultButton;Ext.getCmp(db);this.setAnimateTarget(Ext.getCmp(db));if(refreshQuickViewArray[this.id]!=null){refreshQuickViewArray[this.id]()}this.tools.restore.dom.style.display="inline";this.tools.maximize.dom.style.display="none"},restore:function(){var n=0;while(maximizedArray.length>n){if(this.id==maximizedArray[n]){maximizedArray.splice(n,1);break}n++}this.focus();if(refreshQuickViewArray[this.id]!=null){refreshQuickViewArray[this.id]()}this.tools.maximize.dom.style.display="inline";this.tools.restore.dom.style.display="none"},resize:function(){tb.doLayout(true,true);tb.doLayout(true,true);var n=getWindowTitle(k,this.getWidth());this.setTitle(n)},move:function(){if(isBrowserWindowMaximized()){this.xOnMove=this.x;this.yOnMove=this.y}},show:function(){var n=0;while(minimizedArray.length>n){if(this.id==minimizedArray[n]){minimizedArray.splice(n,1);break}n++}}}});skyWindow.add(win2);win2.on("activate",function(){var o=false;for(var n in widgetsSequence){if(widgetsSequence[n][0]==this.id){widgetsSequence[n][1]=wSequence;wSequence=wSequence+1;o=true;break}}if(o==false){widgetsSequence[wSequence]=new Array(2);widgetsSequence[wSequence][0]=this.id;widgetsSequence[wSequence][1]=wSequence;wSequence=wSequence+1}var p=this.id;colorChange(p);this.focus()});applyToolTipOnWinHeaderBtn();if(l==false&&e==false){win2.show()}else{if(l==true){win2.minimize()}if(e==true){win2.maximize();win2.show()}}}function setWindowPosition(){Ext.WindowMgr.each(function(a){if(a.xOnMove!=0){a.setPosition(a.xOnMove,a.yOnMove)}})}function applyToolTipOnWinHeaderBtn(){new Ext.ToolTip({target:win2.tools.close,trackMouse:true,anchor:"top",anchorOffset:10,html:labelTooltipClose,dismissDelay:15000});new Ext.ToolTip({target:win2.tools.minimize,trackMouse:true,anchor:"top",html:labelTooltipMinimize,dismissDelay:15000});new Ext.ToolTip({target:win2.tools.maximize,trackMouse:true,anchor:"top",html:labelTooltipMaximize,dismissDelay:15000});new Ext.ToolTip({target:win2.tools.restore,trackMouse:true,anchor:"top",html:labelTooltipRestore,dismissDelay:15000});new Ext.ToolTip({target:win2.tools.help,trackMouse:true,anchor:"top",html:labelTooltipHelp,dismissDelay:15000})}function onItemToggle(e,g){var d=e.id;resTokens=d.split("tabId");Ext.getCmp(resTokens[1]).show();var b=wListStr;b=b.substring(1,b.length-1);var f=b.split(",");var a=0;while(a<f.length){var c=f[a];if(c!=null){c=c.replace(/^\s*|\s*$/g,"")}var h=Ext.getCmp(c);if(h!=null){if(c==resTokens[1]){(h).removeClass("headerLightBlue");(h).removeClass("headerBlue");(h).addClass("headerBlue")}else{(h).removeClass("headerBlue");(h).removeClass("headerLightBlue");(h).addClass("headerLightBlue")}}a++}}function colorChange(h){var a=wListStr;a=a.substring(1,a.length-1);var f=a.split(",");var g=0;var j=f.length;while(j>=0){var d=f[j];if(d!=null){d=d.replace(/^\s*|\s*$/g,"")}var c=Ext.getCmp(d);if(c!=null){if(d==h){c.removeClass("headerDefault");c.removeClass("headerLightBlue");c.removeClass("headerBlue");c.addClass("headerBlue");if(Ext.getCmp("splitId"+d)!=null){Ext.getCmp("splitId"+d).setChecked(true)}}else{c.removeClass("headerDefault");c.removeClass("headerBlue");c.removeClass("headerLightBlue");c.addClass("headerLightBlue")}}var e="tabId"+d;var b=Ext.get(e);if(b!=null){if(e=="tabId"+h){b.removeClass("bgGrey");b.removeClass("bgBlue");b.addClass("bgBlue")}else{b.removeClass("bgBlue");b.removeClass("bgGrey");b.addClass("bgGrey")}}j--}}function onItemCheck(m,l){var e=m.id;resTokens=e.split("splitId");var a=wListStr;a=a.substring(1,a.length-1);var d=a.split(",");if(m.id=="splitCascadeId"){var k=0;var j=0;for(var f=0;f<=100;f++){var b=d[f];if(b!=null){b=b.replace(/^\s*|\s*$/g,"")}if(Ext.getCmp(b)!=null){if(Ext.getCmp(b).maximized==true){Ext.getCmp(b).restore()}Ext.getCmp(b).setPosition(k,j);Ext.getCmp(b).show();k=k+40;j=j+50}}}if(m.id=="splitTileId"){var h=skyWindow.getHeight();var g=0;var n=skyWindow.getWidth()/2;if(counter==2){g=h}else{if((counter%2)==0){g=(h/counter)*2}else{g=(h/(counter+1))*2}}var k=0;var j=0;var c=0;for(var f=0;f<=100;f++){var b=d[f];if(b!=null){b=b.replace(/^\s*|\s*$/g,"")}if(Ext.getCmp(b)!=null){if(Ext.getCmp(b).maximized==true){Ext.getCmp(b).restore()}Ext.getCmp(b).setPosition(k,j);Ext.getCmp(b).setHeight(g-6);Ext.getCmp(b).setWidth(n-3);Ext.getCmp(b).show();c++;k=k+n+2;if((c%2)==0){k=0;j=j+g}}}}if(m.id!="splitTileId"&&m.id!="splitCascadeId"){Ext.getCmp(resTokens[1]).show()}}function getTabTitle(b){var a="";if(b!=null&&b!=""){if(b.length>15){a=b.substring(0,15)+"..."}else{a=b}}return a}function getWindowTitle(c,b){var a="";if(c!=null&&c!=""){chars=(b-110)/11;if(c.length>chars){a=c.substring(0,chars-8)+"..."}else{a=c}}return a}refreshBtnHandler=function(a,b){window.location.reload()};SaveBtnHandler=function(a,b){saveList()};function saveList(){var d;var g;var c=0;for(var h=0;h<frames.length;h++){if(frames[h].name!="timeoutframe"&&frames[h].name!=""&&frames[h].name!=null){var k=0;d=false;g=false;while(maximizedArray.length>k){if(maximizedArray[k]==frames[h].name){d=true;break}k++}k=0;while(minimizedArray.length>k){if(minimizedArray[k]==frames[h].name){g=true;break}k++}for(var f in widgetsSequence){if(widgetsSequence[f][0]==frames[h].name){c=widgetsSequence[f][1];break}}frames[h].saveQvState(g,d,c)}}var m=new Array();var a=wListStr;a=a.substring(1,a.length-1);var e=a.split(",");var l=e.length-1;var h=0;while(l>=0){var b=e[l];if(b!=null){b=b.replace(/^\s*|\s*$/g,"")}if(Ext.getCmp(b)!=null){m.push(Ext.getCmp(b).getId());Ext.getCmp(b).setDisabled(false);Ext.getCmp("tabId"+Ext.getCmp(b).getId()).setDisabled(false);m.push("#")}(m);l--;h++}saveState(m+"");enablePage()}function enablePage(){if(Ext.getCmp("splitButtonId").disabled==true){Ext.getCmp("splitButtonId").setDisabled(false)}if(Ext.getCmp("addButtonId").disabled==true){Ext.getCmp("addButtonId").setDisabled(false)}}function addTabBtn(){var a=window.parent.getQuiickviewId();if(a!=null&&a!=""){document.getElementById("thePage:theForm:isQVDeleted").value=false;addToList(a);window.parent.setQVWidgetViews(a,"tableView")}else{showMessage(labelSelectQuickViewMessage)}}function addQVOnDashboard(){if(isQVDeleted==true){showMessage(labelQuickViewDeletedMessage)}else{addTab(200,200,455,400,lastId,lastQuickView,lastQuickViewId,false,false)}document.getElementById("theForm:isQVDeleted").value=false}function dragQV(a){if(a!=null&&a!=""){document.getElementById("thePage:theForm:isQVDeleted").value=false;addToList(a);window.parent.setQVWidgetViews(a,"tableView")}}Ext.onReady(function(){Ext.QuickTips.init();tb=new Ext.Toolbar({id:"tbId",width:"auto",height:"35",renderTo:"menubar",cls:"tBarCls"});var e=Ext.isIE7?735:Ext.isIE8?716:Ext.isSafari?735:722;var g=screen.height;if(g<=1024){e=Ext.isIE7?735:Ext.isIE8?716:Ext.isSafari?735:720}else{if((g>1024)&&(g<1200)){e=Ext.isIE7?755:Ext.isIE8?755:Ext.isSafari?770:760}else{e=Ext.isIE7?900:Ext.isIE8?890:Ext.isSafari?905:895}}skyWindow=new Ext.Window({id:"parentSkyWindow",renderTo:"skyWind",baseCls:"sky",width:"98%",shadow:false,resizable:false,closable:false,height:e,bodyStyle:{"background-color":"FFFFFF"},listeners:{afterlayout:function(){tb.doLayout();setWindowPosition()}}});splitButton=new Ext.Button({id:"splitButtonId",cls:"splitButtonCls",tooltipType:"title",tooltip:labellayout,iconCls:"blist",menu:{cls:"splitMenuCls",items:[{id:"splitCascadeId",text:labelButtonCascade,checked:false,group:"sBtnItemGroup",handler:onItemCheck},{id:"splitTileId",text:labelButtonTile,checked:false,group:"sBtnItemGroup",handler:onItemCheck},"-"]},listeners:{mouseover:function(){this.setIconClass("blistOn")},mouseout:function(){this.setIconClass("blist")}}});saveButton=new Ext.Button({id:"saveButtonId",text:"",scale:"medium",iconCls:"bmcSave",handler:SaveBtnHandler,tooltipType:"title",tooltip:labelsave,listeners:{mouseover:function(){this.setIconClass("bmcSaveOn")},mouseout:function(){this.setIconClass("bmcSave")}}});addButton=new Ext.Button({text:"",id:"addButtonId",handler:addTabBtn,scale:"medium",iconCls:"bmcAddQV",tooltipType:"title",tooltip:labeladdQuickView,listeners:{mouseover:function(){this.setIconClass("bmcAddQVOn")},mouseout:function(){this.setIconClass("bmcAddQV")}}});refreshButton=new Ext.Button({text:"",id:"refreshButtonId",handler:refreshBtnHandler,scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:labelrefresh,listeners:{mouseover:function(){this.setIconClass("bmcRefreshDasboardOn")},mouseout:function(){this.setIconClass("bmcRefreshDasboard")}}});tb.add(addButton);tb.add(saveButton);tb.add(refreshButton);tb.add({xtype:"spacer",width:2});tb.add("-");tb.add({xtype:"spacer",width:2});tb.add(splitButton);tb.add({xtype:"spacer",width:2});tb.add("-");tb.add({xtype:"spacer",width:1});tb.doLayout(true,true);var d=document.getElementById("skyWind");var c=346;var a=353;var b=344;var f=353;if(g<=1024){c=342;a=378;b=344;f=353}else{if((g>1024)&&(g<1200)){c=365;a=388;b=365;f=370}else{c=433;a=462;b=431;f=438}}if(d){if(Ext.isIE7){d.style.marginTop=a+"px"}else{if(Ext.isIE8){d.style.marginTop=b+"px"}else{if(Ext.isSafari){d.style.marginTop=f+"px"}else{d.style.marginTop=c+"px"}}}}skyWindow.show();repeatListOfWidgetsPage()});