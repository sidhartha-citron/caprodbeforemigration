var CMDBClassChooser=function(a,c,b){this.displayStyle=a;this.classViewStore=c;this.ItemClickHandler=b;return this.getElement()};var tempgrid;CMDBClassChooser.prototype={lookup:{},getElement:function(){this.initTemplates();this.store=this.classViewStore;if(selectedTab=="All"){this.stringlength=15}else{this.stringlength=33}var b=function(d){if(d.Name=="BMC_BaseElement"&&selectedTab=="All"){var c=d.DisplayName;c=c.substring(0,c.indexOf("("));d.shortName=c}else{d.shortName=d.DisplayName.ellipse(this.stringlength)}this.lookup[d.Name]=d;return d};var a=null;if(this.displayStyle=="list"){a="div.list-wrap";this.stringlength=30}else{a="div.thumb-wrap"}this.view=new Ext.DataView({id:"img-chooser-view",tpl:this.thumbTemplate,singleSelect:true,border:0,overCls:"bmc-btn-over",itemSelector:a,store:this.store,listeners:{selectionchange:{fn:this.showDetails,scope:this,buffer:100},loadexception:{fn:this.onLoadException,scope:this},afterrender:function(c){tempgrid=c}},prepareData:b.createDelegate(this)});return this.view},initTemplates:function(){if(this.displayStyle=="list"){this.thumbTemplate=new Ext.XTemplate('<tpl for=".">','<div class="list-wrap" id="{Name}">','<div class="list"><img  title="{Name}"></div>',"<span>{shortName}</span></div>","</tpl>");this.thumbTemplate.compile()}else{if(selectedTab=="All"){this.thumbTemplate=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap" id="{Name}" title="{DisplayName}">','<tpl if="((Image.length == 15 || Image.length == 18) && pattern.test(Image))">','<div class="thumb"><img  src="/servlet/servlet.FileDownload?file={Image}"></div>',"</tpl>",'<tpl if="!((Image.length == 15 || Image.length == 18) && pattern.test(Image))">','<div class="thumb"><img  src="'+CIFORCE_RES_PATH+'/images/ci/{Image}_32.svg"></div>',"</tpl>",'<span style="width:90px;">{shortName}</span>','<span style="width:90px; height:12px; text-align:center;">(',"<tpl if=\"(Name == 'BMC_BaseElement')\">",""+_ServerValues.BaseElement,"</tpl>","<tpl if=\"(Name != 'BMC_BaseElement' && CMDBClassType == 'CI')\">",""+_ServerValues.CMDB_TAB_CIs,"</tpl>","<tpl if=\"(Name != 'BMC_BaseElement' && CMDBClassType == 'Asset')\">",""+_ServerValues.CMDB_TAB_Assets,"</tpl>","<tpl if=\"(Name != 'BMC_BaseElement' && CMDBClassType == 'CI and Asset')\">",""+_ServerValues.CIAndAsset,"</tpl>",")</span></div>","</tpl>")}else{this.thumbTemplate=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap" id="{Name}" title="{DisplayName}">','<tpl if="((Image.length == 15 || Image.length == 18) && pattern.test(Image))">','<div class="thumb"><img  src="{[getSFDocumentURL(values.Image)]}"></div>',"</tpl>",'<tpl if="!((Image.length == 15 || Image.length == 18) && pattern.test(Image))">','<div class="thumb"><img  src="'+CIFORCE_RES_PATH+'/images/ci/{Image}_32.svg"></div>',"</tpl>",'<span style="width:90px;height:27px;">{shortName}</span></div>',"</tpl>")}this.thumbTemplate.compile()}},showDetails:function(){var b=this.view.getSelectedNodes();if(b&&b.length>0){b=b[0];var a=this.lookup[b.id];if(selectedTab=="Asset"&&a.Name=="BMC_BaseElement"){isabstract=true}else{isabstract=a.Abstract}if(isabstract||(typeof(iscreatable)!="undefined"&&iscreatable!="undefined"&&iscreatable!=null&&!iscreatable)){if(Ext.getCmp("newInstanceBtn")!=null&&Ext.getCmp("newInstanceBtn")!="undefined"){Ext.getCmp("newInstanceBtn").disable();Ext.getCmp("newInstanceBtn").setIconCls("bmcNewDisable")}}else{if(typeof(iscreatable)!="undefined"&&iscreatable!="undefined"&&iscreatable!=null&&iscreatable){if(Ext.getCmp("newInstanceBtn")!=null&&Ext.getCmp("newInstanceBtn")!="undefined"){Ext.getCmp("newInstanceBtn").enable();Ext.getCmp("newInstanceBtn").setIconCls("bmcNew")}}}if(this.ItemClickHandler){selectedClsType=a.CMDBClassType;RuleClass=a.Ruleclass;if(typeof(RuleClass)!="undefined"&&RuleClass!=null&&RuleClass!=""){isRBAClass=true}this.ItemClickHandler(a.Name)}}},onLoadException:function(a,b){this.view.getEl().update('<div style="padding:10px;">Error loading data.</div>')}};String.prototype.ellipse=function(a){if(this.length>a){return this.substr(0,a-3)+"..."}return this};var CMDBTypeIcons=function(a){this.ItemClickHandler=a;return this.getElement()};CMDBTypeIcons.prototype={lookup:{},getElement:function(){var e=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap" id="{name}" title="{tooltip}">','<div class="{name}ViewTabHeader" id="{name}Id">&nbsp;</div>',"</div>","</tpl>");e.compile();var a=[{name:"tile",index:0,tooltip:_ServerValues.TileViewLabel},{name:"list",index:1,tooltip:_ServerValues.ListViewLabel},{name:"tree",index:2,tooltip:_ServerValues.TreeViewLabel}];var b=new Ext.data.JsonStore({data:a,autoDestroy:true,idProperty:"name",fields:["name","index","tooltip"]});var d=function(f){this.lookup[f.name]=f;return f};var c="div.thumb-wrap";this.view=new Ext.DataView({id:"ClassViewChoser",tpl:e,singleSelect:true,border:0,height:30,overCls:"x-view-over",itemSelector:c,store:b,listeners:{selectionchange:{fn:this.showDetails,scope:this,buffer:100},afterrender:function(h){var g=Ext.util.Cookies.get(userId);var f;if(g!=null){if(g=="tile"){f=0}else{if(g=="tree"){f=2}else{f=1}}}else{f=1}h.select(f)}},prepareData:d.createDelegate(this)});return this.view},showDetails:function(){var b=this.view.getSelectedNodes();if(b&&b.length>0){b=b[0];var a=this.lookup[b.id];if(this.ItemClickHandler){this.ItemClickHandler(a.name,a.index)}}}};var CMDBTabChooser=function(a){this.ItemClickHandler=a;return this.getElement()};CMDBTabChooser.prototype={lookup:{},getElement:function(){var d=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap" id="{name}" title="{tooltip}">','<div class="{name}TabHeader" id="{name}Id">{tooltip}</div>',"</div>","</tpl>");d.compile();var a=[{name:"CI",index:0,tooltip:_ServerValues.CMDB_TAB_CIs},{name:"Asset",index:1,tooltip:_ServerValues.CMDB_TAB_Assets},{name:"All",index:2,tooltip:_ServerValues.CMDB_TAB_All}];if(userLanguage=="iw"){a=a.reverse()}var e=new Ext.data.JsonStore({data:a,autoDestroy:true,idProperty:"name",fields:["name","index","tooltip"]});var c=function(f){this.lookup[f.name]=f;return f};var b="div.thumb-wrap";this.view=new Ext.DataView({id:"CMDBTabChooser",tpl:d,singleSelect:true,border:0,height:30,style:{paddingLeft:"5px",paddingTop:"5px"},overCls:"x-view-over",itemSelector:b,store:e,listeners:{selectionchange:{fn:this.showDetails,scope:this,buffer:100},afterrender:function(f){var g=Ext.util.Cookies.get("apex__"+userId+"TabName");var h;if(g!=null){if(g=="CI"){h=(userLanguage=="iw")?2:0}else{if(g=="Asset"){h=1}else{h=(userLanguage=="iw")?0:2}}}else{h=(userLanguage=="iw")?2:0}f.select(h)}},prepareData:c.createDelegate(this)});return this.view},showDetails:function(){var b=this.view.getSelectedNodes();if(b&&b.length>0){b=b[0];var a=this.lookup[b.id];if(this.ItemClickHandler){this.ItemClickHandler(a.name)}}if(typeof(hideNode)!="undefined"){hideNode()}}};