var fldData="[]",offeringClause,fkService,flag,selectedLabel,selectedApiName,listData,isInList=false,selectedTextAreaLength=0,disableMilestoneTab,popUpString="",popUpEnable=false,isCustomPage=true,compTypeNo=0,fieldsComboStore,fieldsEditor,pickListArray=new Array(),pickListComboStore,pickListComboBx,booleanComboStore,booleanComboBx,booleanArray=[["True","True"],["False","False"]],labelField,labelOperator,clockStatus,comparisonOperator,daysSpinner,hoursSpinner,minutesSpinner,businessDaysSpinner,isInBusinessDays,startOpComboBx,pasueOpComboBx,stopOpComboBx,moduleName,DZHE,EF,referenceId,referenceName,startClockGrid,startClockStore,listDataForStartClockGrid=new Array(),pauseClockGrid,pauseClockStore,listDataForPasueClockGrid=new Array(),stopClockGrid,stopClockStore,listDataForStopClockGrid=new Array(),idset,logicalOperator,qualificationGridStore,QualificationGrid,mutualExcWhereClause="",filterClauseforStopClock="",startlogOpComboBx,pauselogOpComboBx,stoplogOpComboBx,logOpeStore,sltId,selectedRowIndexStart,selectedRowIndexPause,selectedRowIndexStop,milestonetore,milestoneGrid,actionStore,actionGrid,JsonMilestone,JsonAction,selectedRowMilestone,selectedRowAction,milestoneToolbar,actionToolbar,isCopied=false,qualificationOrderIndex=1,serviceTargetWindow,clickedOnce=false,isMilestoneCreatable,isMilestoneDeletable,isMilestoneActionDeletable,isMilestoneUpdateble;isUpdateble=true;var compStore=new Object();function getServiceId(){if(window.parent.getServiceId!=null&&typeof(window.parent.getServiceId)=="function"){fkService=window.parent.getServiceId();if(fkService!=null&&fkService!=""){OfferingClause=escape("(serviceType__c = 'Offering') And (FKBusinessService__c ='"+fkService+"')")}}}function handleModuleChange(a){if(a.value=="Incident__c"){getUserAccountBusinessHoursId().disabled=false}else{getUserAccountBusinessHoursId().checked=false;getUserAccountBusinessHoursId().disabled=true}populateTargetTypeFields(a.value)}var SaveBtnHandler=function(d,f){Ext.getCmp("saveId").setDisabled(true);showLoadingMask();var a=getDaysTargetHiddenEle(),b=getHoursTargetHiddenEle(),g=getMinutesTargetHiddenEle(),c=getBusinessDaysTargetHiddenEle();a.value=daysSpinner.getValue();b.value=hoursSpinner.getValue();g.value=minutesSpinner.getValue();c.value=businessDaysSpinner.getValue();if(validateCriteria()){hideLoadingMask();Ext.getCmp("saveId").setDisabled(false);return}if(!validateOwnerCondition()){showOLAMessage(FilterLogicValidationForOwnerId);hideLoadingMask();Ext.getCmp("saveId").setDisabled(false);return}setConditionsData();var h=Ext.getCmp("st_inactive__c").getValue();var e=(isAdvRulePresent)?document.getElementById("filterLogic").value:"";save(h,e,isAdvRulePresent,qualificationClockStatus)};function checkIDSet(){if(idset==null||idset==""){if(typeof(window.parent.frames.SLTframe.returnListOfId)=="function"){idset=window.parent.frames.SLTframe.returnListOfId()}}}checkIDSet();var ResetBtnHandler=function(a,b){reset()};var PreviuosBtnHandler=function(a,b){if(document.getElementById("prevId").disabled!=true){previousSLTBtnHandler()}};var NextBtnHandler=function(a,b){if(document.getElementById("nextId").disabled!=true){nextSLTBtnHandler()}};function previousSLTBtnHandler(){var b="";var a=0;while(idset.length>a){if(b==""){b=idset[a]}else{b=b+","+idset[a]}a++}previousSLT(b)}function nextSLTBtnHandler(){var b="";var a=0;while(idset.length>a){if(b==""){b=idset[a]}else{b=b+","+idset[a]}a++}nextSLT(b)}function setConditionsData(){var f="";var a="";var c="";var e="";var d=0;while(qualificationGridStore.data.length>d){if(isAdvRulePresent){if(qualificationGridStore.data.length-1==d){qualificationGridStore.getAt(d).set("groupingOperator","NONE")}else{qualificationGridStore.getAt(d).set("groupingOperator","AND")}}f=f+qualificationGridStore.getAt(d).get("orderIndex")+nonPrint+qualificationGridStore.getAt(d).get("operatorFieldAPIName")+nonPrint+qualificationGridStore.getAt(d).get("operatorValue")+nonPrint+qualificationGridStore.getAt(d).get("operandValue")+nonPrint+qualificationGridStore.getAt(d).get("operandFieldType")+nonPrint+qualificationGridStore.getAt(d).get("groupingOperator")+nonPrint+qualificationGridStore.getAt(d).get("qualId")+PE;d++}var j=getApplySTStrEle();j.value=f;d=0;while(startClockStore.data.length>d){a=a+startClockStore.getAt(d).get("condition")+nonPrint+"fkStatus__c"+nonPrint+startClockStore.getAt(d).get("operator")+nonPrint+startClockStore.getAt(d).get("value")+nonPrint+"reference"+nonPrint+startClockStore.getAt(d).get("logicalOperator")+nonPrint+startClockStore.getAt(d).get("sfRecord")+PE;d++}var b=getStartClockStrEle();b.value=a;d=0;while(stopClockStore.data.length>d){c=c+stopClockStore.getAt(d).get("stcondition")+nonPrint+"fkStatus__c"+nonPrint+stopClockStore.getAt(d).get("stoperator")+nonPrint+stopClockStore.getAt(d).get("stvalue")+nonPrint+"reference"+nonPrint+stopClockStore.getAt(d).get("stlogicalOperator")+nonPrint+stopClockStore.getAt(d).get("stsfRecord")+PE;d++}var h=getStopClockStrEle();h.value=c;d=0;while(pauseClockStore.data.length>d){e=e+pauseClockStore.getAt(d).get("pcondition")+nonPrint+"fkStatus__c"+nonPrint+pauseClockStore.getAt(d).get("poperator")+nonPrint+pauseClockStore.getAt(d).get("pvalue")+nonPrint+"reference"+nonPrint+pauseClockStore.getAt(d).get("plogicalOperator")+nonPrint+pauseClockStore.getAt(d).get("psfRecord")+PE;d++}var g=getPauseClockStrEle();g.value=e}Ext.onReady(function(){var b=new Ext.Toolbar({renderTo:"toolBar",cls:"toolSpCls",id:"SLToolbar",items:[{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:ServiceTargetPage.Labels.Save,id:"saveId",handler:SaveBtnHandler},"",{scale:"medium",iconCls:"bmcResetOn",tooltipType:"title",tooltip:ServiceTargetPage.Labels.Reset,id:"resetId",handler:ResetBtnHandler},"->",{id:"st_inactive__c",xtype:"checkbox",width:93,color:"#004376",align:"top",checked:false,boxLabel:'<span class="checkboxLabelCls" style="font-family: Tahoma, MS Sans Serif;font-size: 11px;'+inactiveLblStyle+'">'+ServiceTargetPage.Labels.Inactive+"</span>",autoCreate:{tag:"input",type:"checkbox",title:ServiceTargetPage.Labels.TooltipIncidentInactive}},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:(getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif"),title:ServiceTargetPage.Labels.PreviousRecord},cls:"cursorCls",listeners:{render:function(c){c.el.on("click",PreviuosBtnHandler)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:ServiceTargetPage.Labels.NextRecord},cls:"cursorSpaceCls",listeners:{render:function(c){c.el.on("click",NextBtnHandler)}}}]});daysSpinner=new Ext.ux.form.SpinnerField({id:"daysSpinner",value:targetInDays,minValue:0,maxValue:99,width:55,maxLength:2,allowDecimals:false,autoCreate:{tag:"input",type:"text",autocomplete:"off",maxlength:"2"},renderTo:"days-ct",enableKeyEvents:true,listeners:{spin:function(){getDurationFieldEle().value=getDuration()},keyup:function(d,c){validateSpinnerField(d,c);getDurationFieldEle().value=getDuration()},keydown:function(d,c){if(c.getKey()==109){c.stopEvent()}}}});hoursSpinner=new Ext.ux.form.SpinnerField({id:"hoursSpinner",value:targetInHours,minValue:0,maxValue:23,width:55,maxLength:2,allowDecimals:false,autoCreate:{tag:"input",type:"text",autocomplete:"off",maxlength:"2"},renderTo:"hours-ct",enableKeyEvents:true,listeners:{spin:function(){getDurationFieldEle().value=getDuration()},keyup:function(d,c){validateSpinnerField(d,c);getDurationFieldEle().value=getDuration()},keydown:function(d,c){if(c.getKey()==109){c.stopEvent()}}}});minutesSpinner=new Ext.ux.form.SpinnerField({id:"minutesSpinner",value:targetInMinutes,minValue:0,maxValue:59,width:55,maxLength:2,allowDecimals:false,autoCreate:{tag:"input",type:"text",autocomplete:"off",maxlength:"2"},renderTo:"minutes-ct",enableKeyEvents:true,listeners:{spin:function(){getDurationFieldEle().value=getDuration()},keyup:function(d,c){validateSpinnerField(d,c);getDurationFieldEle().value=getDuration()},keydown:function(d,c){if(c.getKey()==109){c.stopEvent()}}}});businessDaysSpinner=new Ext.ux.form.SpinnerField({id:"businessDaysSpinner",value:targetInBusinessDays,minValue:0,maxValue:99,width:55,maxLength:5,allowDecimals:true,decimalPrecision:2,incrementValue:0.25,autoCreate:{tag:"input",type:"text",autocomplete:"off",maxlength:"5"},renderTo:"businessdays-ct",enableKeyEvents:true,listeners:{spin:function(){getDurationFieldEle().value=getDuration()},keyup:function(d,c){validateSpinnerField(d,c);getDurationFieldEle().value=getDuration()},keydown:function(d,c){if(c.getKey()==109){c.stopEvent()}}}});if(copyId!=null&&copyId!=""){isCopied=true}EnablingAndDisablingButtons();initTargetFields();hideStopClockPanel();logOpeStore=new Ext.data.SimpleStore({id:"logOpeStore",data:[["AND",labelAND],["OR",labelOR],["NONE",labelNONE]],fields:["logOpeValue","logOpeName"]});logicalOperator=new Ext.form.ComboBox({id:"logicalOperatorCombo",store:logOpeStore,mode:"local",triggerAction:"all",valueField:"logOpeValue",displayField:"logOpeName",selectOnFocus:true,renderTo:"qualLogicalOperatorCombo",editable:false,width:103,listWidth:120,height:13,emptyText:labelLogicalOperator});logicalOperator.setValue("AND");compStore.text=[["=","="],["!=","!="],["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];compStore.phone=[["=","="],["!=","!="]];compStore.currency=[["=","="],["!=","!="]];compStore.percent=[[">",">"],[">=",">="],["=","="],["!=","!="],["<","<"],["<=","<="]];compStore.number=[[">",">"],[">=",">="],["=","="],["!=","!="],["<","<"],["<=","<="]];compStore.booleanVar=[["=","="],["!=","!="]];compStore.email=[["=","="],["!=","!="],["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];compStore.reference=[["=","="],["!=","!="]];compStore.dateTime=[[">",">"],[">=",">="],["=","="],["!=","!="],["<","<"],["<=","<="]];compStore.textArea=[["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];compStore.picklist=[["=","="],["!=","!="],["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];comparisonOperator=new Ext.form.ComboBox({id:"compareOpCombo",store:compStore.text,mode:"local",triggerAction:"all",renderTo:"compareOpDiv",valueField:"comOpeValue",displayField:"comOpeName",editable:false,width:68,listWidth:85,height:13,proxy:new Ext.data.MemoryProxy(compStore),emptyText:labelOperator});fieldsComboStore=new Ext.data.JsonStore({id:"fieldsStore",data:fldData,proxy:new Ext.data.MemoryProxy(fldData),fields:["id","type","label","e"],sortInfo:{field:"label",direction:"ASC"}});fieldsEditor=new Ext.form.ComboBox({id:"fieldsCombo",store:fieldsComboStore,mode:"local",triggerAction:"all",valueField:"id",displayField:"label",renderTo:"extFieldList",editable:false,listWidth:150,width:133,height:13,emptyText:labelField,tpl:'<tpl for="." ><div class="x-combo-list-item">{label:htmlEncode}</div></tpl>',listeners:{select:function(j,h,f){comparisonOperator.store.removeAll();var c=h.get("type");if(c.indexOf(":")>0){c=c.split(":")[0]}else{if(c.indexOf(EF)>0){c=c.split(EF)[0]}}var d=this.store.getAt(f).get("id");var e=this.store.getAt(f).get("label");var g=this.store.getAt(f).get("type");setComparisonOperatorStore(c);setAddUpdateOnClick(null);setVisibilityData(d,e,g)}},beforeBlur:Ext.emptyFn});pickListComboStore=new Ext.data.ArrayStore({id:"pickListFieldStore",data:pickListArray,fields:["id","val"],sortInfo:{field:"val",direction:"ASC"}});pickListComboBx=new Ext.form.ComboBox({id:"pickListFieldCombo",store:pickListComboStore,mode:"local",triggerAction:"all",valueField:"id",displayField:"val",selectOnFocus:true,editable:false,renderTo:"picklistCombo",hidden:true,width:148,tpl:'<tpl for="." ><div class="x-combo-list-item">{val:htmlEncode}</div></tpl>',listWidth:165});booleanComboStore=new Ext.data.ArrayStore({id:"booleanFieldStore",data:booleanArray,fields:["id","val"]});booleanComboBx=new Ext.form.ComboBox({id:"booleanFieldCombo",store:booleanComboStore,mode:"local",triggerAction:"all",valueField:"id",displayField:"val",selectOnFocus:true,editable:false,renderTo:"booleanCombo",hidden:true,width:148,listWidth:165});createMOperatorCombo();createStartClockGrid();createPauseClockGrid();createStopClockGrid();disableStartRemoveBtn();disablePauseRemoveBtn();disableStopRemoveBtn();var a=new Ext.grid.ColumnModel({header:true,columns:[{dataIndex:"orderIndex",header:ServiceTargetPage.Labels.servicetargetOrder,sortable:false,width:80,renderer:"htmlEncode"},{dataIndex:"operandFieldLabel",header:ServiceTargetPage.Labels.FieldName,sortable:false,width:175,renderer:"htmlEncode"},{dataIndex:"operatorValue",header:ServiceTargetPage.Labels.serviceTargetOperator,sortable:false,width:80,renderer:"htmlEncode"},{dataIndex:"operandValue",header:ServiceTargetPage.Labels.operandValue,sortable:false,width:190,renderer:"htmlEncode"},{dataIndex:"groupingOperator",header:ServiceTargetPage.Labels.LogicalOperator,sortable:false,width:113,renderer:"htmlEncode"},{dataIndex:"operatorFieldAPIName",hidden:true},{dataIndex:"operandFieldType",hidden:true},{dataIndex:"qualId",hidden:true}]});qualificationGridStore=new Ext.data.SimpleStore({fields:["orderIndex","operandFieldLabel","operatorValue","operandValue","groupingOperator","operatorFieldAPIName","operandFieldType","qualId"]});QualificationGrid=new Ext.grid.GridPanel({id:"qualificationCriteriaGrid",store:qualificationGridStore,cm:a,columnLines:true,enableHdMenu:false,enableColumnResize:false,enableColumnMove:false,width:640,height:190,border:false,stripeRows:true,viewConfig:{forceFit:true,scrollOffset:0},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),listeners:{rowClick:function(c,f,d){setInputDataAndElementsOnRowClick(f)}}});QualificationGrid.render("qualificationGridDiv");loadDataToGrids();getMilestonegrid();getMiletoneToolbar();loadDatatoMilestonetore();getActionrid();getActionToolbar();loadDatatoActionstore();getWaitbox();disableMilestoneAndActionTab();if(isRecDeleted){Ext.Msg.alert(ServiceTargetPage.Labels.Information,ServiceTargetPage.Labels.DeletedRecord,function(){var c=window.parent.Ext.getCmp("popupWindowId1");if((typeof(c)!="undefined")&&(typeof(c)!="undefined")){c.close()}})}handleElemEvent();serviceTargetWindow=window.parent.Ext.getCmp("popupWindowId1");serviceTargetWindow.pendingClose=false;serviceTargetWindow.on("beforeclose",function(){if(serviceTargetWindow.pendingClose==false){if(clickedOnce==true){window.parent.confirmClose(serviceTargetWindow);return false}}});if(Ext.isMac&&Ext.isSafari){document.getElementById("extFieldList").firstChild.style.width="135px";document.getElementById("compareOpDiv").firstChild.style.width="85px";document.getElementById("booleanCombo").firstChild.style.width="150px";document.getElementById("qualLogicalOperatorCombo").firstChild.style.width="120px";document.getElementById("startOpComboDiv").firstChild.style.width="85px";document.getElementById("startlogOpComboDiv").firstChild.style.width="85px";document.getElementById("pauseOpComboDiv").firstChild.style.width="85px";document.getElementById("pauselogOpComboDiv").firstChild.style.width="85px";document.getElementById("stopOpComboDiv").firstChild.style.width="85px";document.getElementById("stoplogOpComboDiv").firstChild.style.width="85px";document.getElementById("picklistCombo").firstChild.style.width="150px"}if(Ext.getCmp("qualificationCriteriaGrid").store.data.length>0){document.getElementById("AdvancedFilterSection").style.visibility="visible";if(isAdvRulePresent){toggleAdd(isAdvRulePresent)}}clockStatusStore=new Ext.data.SimpleStore({id:"logOpeStore",data:clockModeOption,fields:["id","value"]});clockStatus=new Ext.form.ComboBox({id:"clockStatusId",store:clockStatusStore,mode:"local",triggerAction:"all",renderTo:"Clock_mode__id",valueField:"id",displayField:"value",value:qualificationClockStatus,editable:false,width:167,listWidth:183,listeners:{select:function(e,d,c){qualificationClockStatus=e.getValue()}}})});function getMilestonegrid(){var a;var b=new Ext.grid.ColumnModel({header:false,columns:[{dataIndex:"Condition",header:"Condition",renderer:renderTooltip,sortable:false,width:260},{dataIndex:"ConditionId",header:"ConditionId",renderer:renderTooltip,sortable:false,hidden:true}]});milestonetore=new Ext.data.SimpleStore({fields:[{name:"Condition",type:"string"},{name:"ConditionId",type:"string"}]});milestoneGrid=new Ext.grid.GridPanel({store:milestonetore,id:"milestoneGridId",cm:b,border:false,listeners:{rowDblClick:function(c,f,d){window.parent.openPopupWithTitle("SLAMilestonePage?appliesToId="+escape(appliesTo)+"&SLTId="+escape(sltId)+"&Id="+getcurrSelectedMilestoneID().value,reloadMilestones,labelMilestoneandActionsTitle+" - "+SLTTitle,Ext.isIE?490:485,662)}},sm:new Ext.grid.RowSelectionModel({singleSelect:true,listeners:{rowselect:function(){showWaitbox();selectedRowMilestone=milestoneGrid.getSelectionModel().getSelected();getcurrSelectedMilestoneID().value=selectedRowMilestone.get("ConditionId");getcurrSelectedMilestoneCondition().value=selectedRowMilestone.get("Condition");var d=getcurrSelectedMilestoneID().value;var c=getcurrSelectedMilestoneCondition().value;getActions(d,c);a=milestoneGrid.store.indexOf(selectedRowMilestone);if(a!=0&&flag){Ext.get(milestoneGrid.getView().getRow(0)).removeClass("x-grid3-row-selected");flag=false}}}}),width:260,height:170,stripeRows:true,viewConfig:{forceFit:true,scrollOffset:0}});milestoneGrid.render("avaiMilestonediv")}function getActionrid(){var a,c;var b=new Ext.grid.ColumnModel({header:false,columns:[{dataIndex:"ActionLabel",header:"Action",renderer:addToolTip,sortable:false,width:360},{dataIndex:"ActionId",header:"ActionId",renderer:addToolTip,sortable:false,hidden:true}]});actionStore=new Ext.data.SimpleStore({fields:[{name:"ActionLabel",type:"string"},{name:"Action",type:"string"},{name:"ActionId",type:"string"}]});actionGrid=new Ext.grid.GridPanel({store:actionStore,id:"actionGridId",cm:b,border:false,sm:new Ext.grid.RowSelectionModel({listeners:{rowselect:function(){if(isMilestoneActionDeletable!=null&&isMilestoneActionDeletable=="false"){Ext.getCmp("btnRemoveAct").setDisabled(true);Ext.getCmp("btnRemoveAct").setIconClass("bmcDeleteSLTDisable")}else{c="";selectedRowAction=actionGrid.getSelectionModel().getSelections();for(a=0;a<selectedRowAction.length;a++){if(a==0){c+=selectedRowAction[a].get("ActionId")}else{c+=","+selectedRowAction[a].get("ActionId")}}getcurrSelectedActionID().value=c;Ext.getCmp("btnRemoveAct").setDisabled(false);Ext.getCmp("btnRemoveAct").setIconClass("bmcDeleteSLT")}}}}),width:360,height:170,stripeRows:true,viewConfig:{forceFit:true,scrollOffset:0}});actionGrid.render("corrActionsdiv")}function loadDatatoMilestonetore(){if(JsonMilestone!=null){milestonetore.removeAll();Ext.getCmp("milestoneGridId").getView().refresh();milestonetore.loadData(JsonMilestone);Ext.getCmp("milestoneGridId").getView().refresh()}if(isMilestoneCreatable!=null&&isMilestoneCreatable=="false"){Ext.getCmp("btnAdd").setDisabled(true);Ext.getCmp("btnAdd").setIconClass("bmcNewSLTDisable");selectedRowMilestone=milestonetore.getAt(0);milestoneGrid.getSelectionModel().selectFirstRow();flag=true}else{Ext.getCmp("btnAdd").setDisabled(false);Ext.getCmp("btnAdd").setIconClass("bmcNewSLT");EnableAddRemovebtns()}if(!isMilestoneUpdateble){Ext.getCmp("btnEdit").setDisabled(true);Ext.getCmp("btnEdit").setIconClass("bmcEditSLTDisable")}if(isMilestoneDeletable!=null&&isMilestoneDeletable=="false"){Ext.getCmp("btnRemove").setDisabled(true);Ext.getCmp("btnRemove").setIconClass("bmcDeleteSLTDisable")}}function loadDatatoActionstore(){if(JsonAction!=null){actionStore.removeAll();Ext.getCmp("actionGridId").getView().refresh();actionStore.loadData(JsonAction);Ext.getCmp("actionGridId").getView().refresh()}disableDeletebtn()}function EnableAddRemovebtns(){var b=Ext.getCmp("btnRemove");var a=Ext.getCmp("btnEdit");if(milestonetore.data.length<=0){b.setDisabled(true);b.setIconClass("bmcDeleteSLTDisable");a.setDisabled(true);a.setIconClass("bmcEditSLTDisable")}else{b.setDisabled(false);b.setIconClass("bmcDeleteSLT");a.setDisabled(false);a.setIconClass("bmcEditSLT");selectedRowMilestone=milestonetore.getAt(0);milestoneGrid.getSelectionModel().selectFirstRow();flag=true}if(!isMilestoneUpdateble){Ext.getCmp("btnEdit").setDisabled(true);Ext.getCmp("btnEdit").setIconClass("bmcEditSLTDisable")}}function disableDeletebtn(){var a=Ext.getCmp("btnRemoveAct");a.setDisabled(true);a.setIconClass("bmcDeleteSLTDisable")}function getWaitbox(){var a=new Ext.Window({id:"waitMsggId",height:100,width:200,resizable:false,closable:false,header:false,frame:false,shadow:false,modal:true,items:[{xtype:"panel",height:100,modal:false,width:200,bodyStyle:"background-color:transparent;border:none;",html:'<div align="center"><img src="'+extJsResource+'/resources/images/default/shared/blue-loading.gif"/></div>'}]})}function showWaitbox(){if(Ext.getCmp("waitMsggId")!=null){Ext.getCmp("waitMsggId").show()}}function hideWaitbox(){if(Ext.getCmp("waitMsggId")!=null){Ext.getCmp("waitMsggId").hide()}}function disableMilestoneAndActionTab(){var a=document.getElementById("milestones_actions_id");if(a!=null){if(disableMilestoneTab){document.getElementById("milestones_actions_id").style.color="#808080";a.disabled=true}else{a.disabled=false;document.getElementById("milestones_actions_id").style.color="#004376"}}}function getMiletoneToolbar(){milestoneToolbar=new Ext.Toolbar({id:"milestoneToolbarId",cls:"toolSpCls",items:[{scale:"medium",iconCls:"bmcNewSLT",tooltipType:"title",tooltip:ServiceTargetPage.Labels.labelAdd,id:"btnAdd",handler:function(){window.parent.openPopupWithTitle("SLAMilestonePage?appliesToId="+escape(appliesTo)+"&SLTId="+escape(sltId),reloadMilestones,labelMilestoneandActionsTitle+" - "+SLTTitle,490,720,false)}},{scale:"medium",iconCls:"bmcEditSLT",tooltipType:"title",tooltip:ServiceTargetPage.Labels.labelEdit,id:"btnEdit",handler:function(){window.parent.openPopupWithTitle("SLAMilestonePage?appliesToId="+escape(appliesTo)+"&SLTId="+escape(sltId)+"&Id="+getcurrSelectedMilestoneID().value,reloadMilestones,labelMilestoneandActionsTitle+" - "+SLTTitle,490,720)}},{scale:"medium",iconCls:"bmcDeleteSLT",tooltipType:"title",tooltip:ServiceTargetPage.Labels.labelDelete,id:"btnRemove",handler:ConfrimDeleteMilestone}]});milestoneToolbar.render("milestoneToolbardiv")}function getActionToolbar(){actionToolbar=new Ext.Toolbar({cls:"toolSpCls",id:"actionToolBarId",items:[{xtype:"button",scale:"medium",iconCls:"bmcDeleteSLTDisable",tooltipType:"title",tooltip:ServiceTargetPage.Labels.labelDelete,id:"btnRemoveAct",handler:ConfrimDeleteAction}]});actionToolbar.render("actionToolbardiv")}function renderTooltip(e,b,a,f,d,c){b.attr='title="'+e+'"';return e}function addToolTip(e,a,b,f,d,c){a.attr='title="'+Ext.util.Format.htmlEncode(b.data.Action)+'"';return e}function setAddOrUpdateButton(c){var a=QualificationGrid.store.getCount();for(var e=0;e<a;e++){var g=QualificationGrid.store.getAt(e);var d=g.get("operatorFieldAPIName");if(d==c){QualificationGrid.getSelectionModel().selectRow(e,false,false);var f=QualificationGrid.getSelectionModel().getSelected();setAddUpdateOnClick(true);return f}}var b;setAddUpdateOnClick(b);return b}function getRemoveBtnEle(){return document.getElementById("removeButtonId")}function setVisibilityData(b,c,f,a,e,d){isInList=false;var g=fldData.length;selectedApiName=b;selectedLabel=c;if(isInList==false){if(f.indexOf(":")>0){selectedTextAreaLength=f.split(":")[1];f=f.split(":")[0]}else{if(f.indexOf(EF)>0){popUpString=f.split(EF)[1];f=f.split(EF)[0]}}if(f=="text"){assignVisibility("inline","none","none","none","none","none","none",null,1,a)}else{if(f=="phone"){assignVisibility("inline","none","none","none","none","none","none",null,10,a)}else{if(f=="currency"){assignVisibility("inline","none","none","none","none","none","none",null,11,a)}else{if(f=="percent"){assignVisibility("inline","none","none","none","none","none","none",null,9,a)}else{if(f=="email"){assignVisibility("inline","none","none","none","none","none","none",null,8,a)}else{if(f=="number"){assignVisibility("inline","none","none","none","none","none","none",null,7,a)}else{if(f=="boolean"){assignVisibility("none","none","none","inline","none","none","none",null,2,a)}else{if(f=="textarea"){assignVisibility("none","inline","none","none","none","none","none",null,3,a)}else{if(f=="picklist"){setPickListOptions(selectedApiName);assignVisibility("none","none","none","none","inline","none","none",null,4,a)}else{if(f=="reference"){assignVisibility("inline","none","inline","none","none","none","none",b,5,a)}else{if(f=="reference1"){assignVisibility("inline","none","inline1","none","none","none","none",b,6,a)}else{if(f=="datetime"){assignVisibility("none","none","none","none","none","inline","none",null,12,a)}else{if(f=="date"){assignVisibility("none","none","none","none","none","none","inline",null,13,a)}}}}}}}}}}}}}setAddUpdateOnClick(a)}setComparisonOperatorStore(f);if(e!=null&&e!="undefined"){comparisonOperator.setValue(e)}if(d!=null&&d!="undefined"){logicalOperator.setValue(d)}}function setAddUpdateOnClick(a){if(a!=null&&a!="undefined"){getUpdateBtnEle().style.display="inline";getUpdateBtnEle().style.visibility="visible";getAddBtnEle().style.display="none";getAddBtnEle().style.visibility="hidden";getRemoveBtnEle().disabled=false;getRemoveBtnEle().src=getSDFStylesResPath()+"/SDEFbuttons/b_remove.png"}else{getUpdateBtnEle().style.display="none";getUpdateBtnEle().style.visibility="hidden";getAddBtnEle().style.display="inline";getAddBtnEle().style.visibility="visible";getRemoveBtnEle().disabled=true;getRemoveBtnEle().src=getSDFStylesResPath()+"/SDEFbuttons/b_remove_disabled.png"}}function assignVisibility(h,q,n,l,d,b,r,c,m,g){var e=getInputTxtEle();var s=getInputTextAreaEle();var f=getDateTimeInputEle();var k=getDateTimePickerImg();var o=getDateInputEle();var p=getDatePickerImg();var t=getLookupEle();var a=Ext.getCmp("booleanFieldCombo");var j=document.getElementById("inputTxtAreaButtonEle");var u=Ext.getCmp("pickListFieldCombo");if(e!=null&&typeof(e)!="undefined"){e.style.display=h;if(h=="inline"&&g!=null&&g!="undefined"){e.value=g}else{e.value=""}e.disabled=false}if(s!=null&&typeof(s)!="undefined"){s.style.display=q;if(j!=null&&typeof(j)!="undefined"){if(q=="inline"){j.style.display="block"}else{j.style.display="none"}if(q=="inline"&&g!=null&&g!="undefined"){s.value=g}else{s.value=""}}}if(f!=null&&typeof(f)!="undefined"){f.style.display=b;if(k!=null&&typeof(k)!="undefined"){k.style.display=b}if(b=="inline"&&g!=null&&g!="undefined"){f.value=g}else{f.value=""}}if(o!=null&&typeof(o)!="undefined"){o.style.display=r;if(p!=null&&typeof(p)!="undefined"){p.style.display=r}if(r=="inline"&&g!=null&&g!="undefined"){o.value=g}else{o.value=""}}if(a!=null&&typeof(a)!="undefined"){if(l=="inline"){a.setVisible(true)}else{a.hide()}if(l=="inline"&&g!=null&&g!="undefined"){a.setValue(g)}else{a.value=""}}if(u!=null&&typeof(u)!="undefined"){if(d=="inline"){u.setVisible(true)}else{u.hide();u.reset()}if(d=="inline"&&g!=null&&g!="undefined"){setPickListOptions(selectedApiName);u.setValue(g)}else{u.value=""}}if(n=="inline"){if(t!=null&&typeof(t)!="undefined"){t.disabled=false;t.style.visibility="visible";t.style.display="inline"}if(g!=null&&g!="undefined"){e.disabled=g}e.disabled=true;popUpEnable=true}else{if(t!=null&&typeof(t)!="undefined"){t.style.visibility="hidden";t.style.display="none";t.disabled=true}}if(n=="inline1"){t.style.display="none";e.disabled=true;e.value="";popUpEnable=true}compTypeNo=m}function displayTabPanel(c){var a=new Array(4);a[0]={btnId:"Service_target_Id",textAreaCompId:"serviceTargetPanel"};a[1]={btnId:"qualification_id",textAreaCompId:"qualificationPanel"};a[2]={btnId:"measurement_id",textAreaCompId:"measurementPanel"};a[3]={btnId:"milestones_actions_id",textAreaCompId:"milestoneActionPanel"};activeBtnId=c.id;for(var b=0;b<a.length;b++){if(activeBtnId==a[b].btnId){document.getElementById(a[b].btnId).style.fontWeight="bold";document.getElementById(a[b].textAreaCompId).style.display="block"}else{document.getElementById(a[b].btnId).style.fontWeight="normal";document.getElementById(a[b].textAreaCompId).style.display="none"}}if(QualificationGrid){QualificationGrid.getView().refresh()}if(startClockGrid){startClockGrid.getView().refresh()}if(activeBtnId=="qualification_id"){initClockModePanel()}}function getPickListOptions(b){for(var c=0;c<fldData.length;c++){var a=fldData[c];var f=a.e.split(EF);var d=f[0];if(d==b){var e=f[1].split(DZHE);return e}}return null}function setPickListOptions(b){var c=Ext.getCmp("pickListFieldCombo");if(c!=null){var d=getPickListOptions(b);pickListArray=new Array();for(var a=0;a<d.length;a++){if(d[a]!=""){pickListArray[a]=[d[a],d[a]]}}pickListComboStore.removeAll();pickListComboStore.loadData(pickListArray);pickListComboBx.setVisible(true)}}function populateQualFieldsData(){fieldsComboStore.removeAll();fieldsComboStore.loadData(fldData);assignVisibility("inline","none","none","none","none","none","none",null,1);fieldsEditor.reset();pickListComboBx.reset();booleanComboBx.reset();comparisonOperator.reset();loadDataToGrids();hideStopClockPanel()}if(typeof(SDEDateFormat)=="undefined"||SDEDateFormat==null||SDEDateFormat==""){this.SDEDateFormat="m/d/Y h:i A"}Date.useStrict=true;var dataModifiedFlag=0;var cdateFormat="";function getDataModifiedFlag(){return dataModifiedFlag}function setDataModifiedFlag(){dataModifiedFlag=0}QualDatePickerPopup=function(){};QualDatePickerPopup.prototype={dateFormat:SDEDateFormat,selectHandler:function(e,d){this.TextField.dom.value=d.format(e.format);var a=this.TextField.dom.id;if(a.indexOf("inputDate")>0){var b=document.getElementById(a).value;var c=b.split(" ");cdateFormat=c[1];this.TextField.dom.value=c[0].replace(",","")}dataModifiedFlag=1;this.TextField=null;e.hide();e.winHandle.close()},Show:function(b){this.TextField=Ext.get(b);var g=new Ext.DatePicker({startDay:1,listeners:{select:this.selectHandler.createDelegate(this)}});try{var c=Date.parseDate(this.TextField.dom.value,this.dateFormat);g.setValue(c)}catch(f){}var a=this.TextField.getRegion();var d=new Ext.Window({x:a.right-180,y:a.top-110,cls:"CMDBWindow",animCollapse:true,header:true,modal:true,autoHeight:true,width:177,layout:"fit",frame:false,closable:false});d.add(g);g.winHandle=d;d.show()}};var _datePicker=new QualDatePickerPopup();function changedateformat(){if(document.getElementById("{!$Component.custominputDate}")){var a=document.getElementById("{!$Component.inputDate}").value;var b=a.split(" ");document.getElementById("{!$Component.inputDate}").value=b[0]}}function openQualLookup(){if(popUpString=="BMC BaseElement"){popUpString="BMC_BaseElement"}else{if(popUpString=="User"||popUpString=="Group"){if(selectedApiName=="fkopenby__c"||selectedApiName=="fkstaff__c"){openPopupRF("SearchPage?popupId=User&isLookup=true&idNameForPopUp=true&filterClause=IsStaffUser__c=true&isFromSLT=true",setReferenceToVal,450,600,true)}else{if(selectedApiName=="fkclient__c"||selectedApiName=="fkinitiator__c"){openPopupRF("SearchPage?popupId=Client&isLookup=true&idNameForPopUp=true&isFromSLT=true",setReferenceToVal,450,600,true)}else{if(strEnableQueueAndUserAssignment==true){openPopupRF("SearchPage?popupId=Queue&isQueurorUser=true&queueFor="+moduleName+"&isOnlyQueueList=true&isLookup=true&idNameForPopUp=true&isFromSLT=true",setReferenceToVal,450,600,true)}else{openPopupRF("SearchPage?popupId=Client&isQueurorUser=true&isLookup=true&queueFor="+moduleName+"&filterClause=IsStaffUser__c=true&idNameForPopUp=true&isFromSLT=true",setReferenceToVal,450,600,true)}}}}else{if(popUpString=="SYSTemplate__c"){var b=getAppliesToEle();if(b!=null&&typeof(b)!="undefined"){var a=b.value;if(a=="Incident__c"){openPopupRF("SearchPage?popupId=SYSTemplate__c&isLookup=true&idNameForPopUp=true&referenceObjectName=SYSTemplate__c&filterClause="+escape("templateFor__c='Incident'"),setReferenceToVal,450,600,true)}else{if(a=="Change_Request__c"){openPopupRF("SearchPage?popupId=SYSTemplate__c&isLookup=true&idNameForPopUp=true&referenceObjectName=SYSTemplate__c&filterClause="+escape("templateFor__c='Change Request'"),setReferenceToVal,450,600,true)}else{if(a=="Task__c"){openPopupRF("SearchPage?popupId=SYSTemplate__c&isLookup=true&idNameForPopUp=true&referenceObjectName=SYSTemplate__c&filterClause="+escape("templateFor__c='Task'"),setReferenceToVal,450,600,true)}}}}}else{if(popUpString=="BMC_BaseElement__c"){var c="";if(selectedApiName=="fkbusinessservice__c"){c+=c=escape("(serviceType__c != 'Offering')");openPopupRF("SearchPage?popupId=BMC_BusinessService__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BusinessService__c&filterClause="+c,setReferenceToVal,450,600,true)}else{if(selectedApiName=="fkserviceoffering__c"){if(window.parent.getServiceId!=null&&typeof(window.parent.getServiceId)=="function"){fkService=window.parent.getServiceId();if(fkService!=null&&fkService!=""){c=escape("(FKBusinessService__c ='"+fkService+"')")}}if(c!=""){c+=c=escape(" and (serviceType__c = 'Offering')")}else{c+=c=escape(" (serviceType__c = 'Offering')")}openPopupRF("SearchPage?popupId=BMC_BusinessService__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BusinessService__c&filterClause="+c,setReferenceToVal,450,600,true)}else{if(selectedApiName=="fkbmc_baseelement__c"){openPopupRF("SearchPage?popupId=BMC_BaseElement__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BaseElement__c",setReferenceToVal,450,600,true)}else{openPopupRF("SearchPage?popupId=BMC_BaseElement__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BaseElement__c",setReferenceToVal,450,600,true)}}}}else{if(popUpString=="ConsoleLayoutDetail__c"){var b=getAppliesToEle();if(b!=null&&typeof(b)!="undefined"){var a=b.value;if(a=="Incident__c"){openPopupRF("SearchPage?popupId="+popUpString+"&isLookup=true&idNameForPopUp=true&referenceObjectName="+popUpString+"&templateFor=Incident",setReferenceToVal,450,650,true)}else{if(a=="Task__c"){openPopupRF("SearchPage?popupId="+popUpString+"&isLookup=true&idNameForPopUp=true&referenceObjectName="+popUpString+"&templateFor=Task",setReferenceToVal,450,650,true)}else{if(a=="Change_Request__c"){openPopupRF("SearchPage?popupId="+popUpString+"&isLookup=true&idNameForPopUp=true&referenceObjectName="+popUpString+"&templateFor=Change Request",setReferenceToVal,450,650,true)}}}}}else{openPopupRF("SearchPage?popupId="+popUpString+"&isLookup=true&idNameForPopUp=true&referenceObjectName="+popUpString,setReferenceToVal,450,650,true)}}}}}}function setReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}referenceName=decodeVal(referenceName);var a=getInputTxtEle();if(a!=null&&typeof(a)!="undefined"){a.value=referenceName;var c=document.getElementById("referenceID");if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function decodeVal(a){a=RemedyForceHTMLProcessor.htmlDecoder(a);return a}function padNumberToTwodigit(a){return(a<10?"0":"")+a}function getDuration(){var e=padNumberToTwodigit(daysSpinner.getValue()),a=padNumberToTwodigit(hoursSpinner.getValue()),b=padNumberToTwodigit(minutesSpinner.getValue()),c=padNumberToTwodigit(businessDaysSpinner.getValue());var d=e+" "+ServiceTargetPage.Labels.Days+" "+a+":"+b+" "+ServiceTargetPage.Labels.HHMM;if(isInBusinessDays){d=c+" "+ServiceTargetPage.Labels.BusinessDays}return d}function setCatData(e,a,d){var b=getInputTxtEle();b.value=a;var c=document.getElementById("referenceID");c.value=e}function setDescriptionNext(){}function setResolutionNext(){}function addSLTQData(){addUpdateSLTQData()}function addUpdateSLTQData(h){var j;var f=false;if(h==null||h=="undefined"||typeof(h)=="undefined"){j=new Ext.data.Record();j.set("orderIndex",qualificationOrderIndex);f=true}else{j=h}var c=fetchQualificationComboFieldLabel();if(c!=null&&c!=""&&c!="undefined"){var e=c.get("label");if(e!=null&&e!=""&&e!="undefined"){j.set("operandFieldLabel",e);j.set("operatorFieldAPIName",c.get("id"));var a=c.get("type");if(a!=null&&a.indexOf(":")>0){a=a.split(":")[0]}j.set("operandFieldType",a)}}else{showExtMsg(ServiceTargetPage.Labels.SelectFieldErrMsg);return}var d=comparisonOperator.getValue();if(d!=null&&d!=""&&d!="undefined"){j.set("operatorValue",d)}else{showExtMsg(ServiceTargetPage.Labels.SelectCmpOpMsg);return}var g=(isAdvRulePresent)?"AND":logicalOperator.getValue();if(g!=null&&g!=""&&g!="undefined"){if(f&&qualificationOrderIndex>1&&qualificationGridStore.getAt(qualificationOrderIndex-2).get("groupingOperator")=="NONE"){qualificationGridStore.getAt(qualificationOrderIndex-2).set("groupingOperator","AND")}j.set("groupingOperator",g)}else{showExtMsg(ServiceTargetPage.Labels.SelectLogOpMsg);return}var m;if(compTypeNo=="1"||compTypeNo=="10"||compTypeNo=="11"||compTypeNo=="7"||compTypeNo=="8"||compTypeNo=="9"||compTypeNo=="5"){var l=getInputTxtEle();if(l!=null&&l!="undefined"){m=l.value}}else{if(compTypeNo=="2"){m=booleanComboBx.getValue()}else{if(compTypeNo=="3"){var k=getInputTextAreaEle();if(k!=null&&k!="undefined"){m=k.value}}else{if(compTypeNo=="4"){m=pickListComboBx.getValue()}else{if(compTypeNo=="12"){m=getDateTimeInputEle().value}else{if(compTypeNo=="13"){m=getDateInputEle().value}}}}}}var b;if(m!=null&&m!=""&&m!="undefined"){b=validateData(m);if(b){return}else{j.set("operandValue",m)}}else{showExtMsg(ServiceTargetPage.Labels.EnterValMsg);return}if(h==null||h=="undefined"||typeof(h)=="undefined"){qualificationGridStore.add(j);qualificationOrderIndex=qualificationOrderIndex+1;clearQualificationCriteria()}QualificationGrid.getView().refresh();if(QualificationGrid.store.data.length>0){document.getElementById("AdvancedFilterSection").style.visibility="visible"}initClockModePanel()}function fetchQualificationComboFieldLabel(){var b=fieldsEditor.getValue();for(var a=0;a<fieldsComboStore.data.length;a++){if(b==fieldsComboStore.getAt(a).get("id")){return fieldsComboStore.getAt(a)}}return""}function removeSLTQData(){var c=QualificationGrid.getSelectionModel().getSelected();if(c!=null&&c!="undefined"){QualificationGrid.store.remove(c);qualificationOrderIndex=qualificationOrderIndex-1;var a=QualificationGrid.store.getCount();for(var b=0;b<a;b++){var d=QualificationGrid.store.getAt(b);d.set("orderIndex",b+1)}QualificationGrid.render("qualificationGridDiv");getRemoveBtnEle().src=getSDFStylesResPath()+"/SDEFbuttons/b_remove_disabled.png";getRemoveBtnEle().disabled=true;fieldsEditor.setValue("");comparisonOperator.setValue("");logicalOperator.setValue("AND");pickListComboStore.removeAll();pickListComboBx.setValue("");getInputTxtEle().value="";assignVisibility("inline","none","none","none","none","none","none",null,1);setAddUpdateOnClick(null)}initClockModePanel()}function clearQualificationCriteria(){if(compTypeNo=="1"||compTypeNo=="10"||compTypeNo=="11"||compTypeNo=="7"||compTypeNo=="8"||compTypeNo=="9"||compTypeNo=="5"){var e=getInputTxtEle();if(e!=null&&e!="undefined"){e.value=""}}else{if(compTypeNo=="2"){operandVal=booleanComboBx.setValue("")}else{if(compTypeNo=="3"){var d=getInputTextAreaEle();if(d!=null&&d!="undefined"){d.value=""}}else{if(compTypeNo=="4"){operandVal=pickListComboBx.setValue("")}else{if(compTypeNo=="12"){var f=getDateTimeInputEle();if(f!=null&&f!="undefined"){f.value=""}}else{if(compTypeNo=="13"){var a=getDateInputEle();if(a!=null&&a!="undefined"){a.value=""}}else{if(compTypeNo=="6"){var b=getInputTxtEle();if(b!=null&&typeof(b)!="undefined"){b.value="";var c=document.getElementById("referenceID");if(c!=null&&typeof(c)!="undefined"){c.value=""}}}}}}}}}fieldsEditor.setValue("");comparisonOperator.setValue("");logicalOperator.setValue("AND")}function createStartClockGrid(){startClockStore=new Ext.data.ArrayStore({fields:["condition","fieldName","operator","value","logicalOperator","sfRecord"],data:[]});startClockGrid=new Ext.grid.GridPanel({renderTo:"startClockGridDiv",id:"startClockGridId",width:"100%",height:170,border:false,sm:new Ext.grid.RowSelectionModel({singleSelect:true}),store:startClockStore,columns:[{id:"colConditionId",header:ServiceTargetPage.Labels.servicetargetOrder,width:80,sortable:false,dataIndex:"condition"},{header:ServiceTargetPage.Labels.FieldName,id:"colfieldNameId",width:175,sortable:false,dataIndex:"fieldName"},{header:ServiceTargetPage.Labels.serviceTargetOperator,id:"colOperatorId",width:80,sortable:false,dataIndex:"operator"},{header:ServiceTargetPage.Labels.operandValue,id:"colValueId",width:190,sortable:false,dataIndex:"value",renderer:"htmlEncode"},{header:ServiceTargetPage.Labels.LogicalOperator,id:"colLogicalOperatorId",width:110,sortable:false,dataIndex:"logicalOperator"},{id:"colSfRecord",width:5,sortable:false,hidden:true,dataIndex:"sfRecord"}],stripeRows:true,columnLines:true,enableHdMenu:false,enableColumnResize:false,enableColumnMove:false,viewConfig:{forceFit:true,scrollOffset:0},listeners:{rowClick:function(f,e,c){var d=f.store.getAt(e);selectedRowIndexStart=e;field=d.get("fieldName");comOperator=d.get("operator");logOperator=d.get("logicalOperator");value=d.get("value");populateValuesOnRowClick([value,comOperator,logOperator],[getStartStatusEle(),"updateStart_id","addStart_id"],[startOpComboBx,startlogOpComboBx]);enableStartRemoveBtn()}}})}function createPauseClockGrid(){pauseClockStore=new Ext.data.ArrayStore({fields:["pcondition","pfieldName","poperator","pvalue","plogicalOperator","psfRecord"],data:[]});pauseClockGrid=new Ext.grid.GridPanel({renderTo:"pauseClockGridDiv",id:"pauseClockGridId",width:"100%",height:170,border:false,sm:new Ext.grid.RowSelectionModel({singleSelect:true}),store:pauseClockStore,columns:[{id:"pcolConditionId",header:ServiceTargetPage.Labels.servicetargetOrder,width:80,sortable:false,dataIndex:"pcondition"},{id:"pcolfieldNameId",header:ServiceTargetPage.Labels.FieldName,width:175,sortable:false,dataIndex:"pfieldName"},{id:"pcolOperatorId",header:ServiceTargetPage.Labels.serviceTargetOperator,width:80,sortable:false,dataIndex:"poperator"},{id:"pcolValueId",header:ServiceTargetPage.Labels.operandValue,width:190,sortable:false,dataIndex:"pvalue",renderer:"htmlEncode"},{id:"colLogicalOperatorId",header:ServiceTargetPage.Labels.LogicalOperator,width:110,sortable:false,dataIndex:"plogicalOperator"},{id:"colSfRecord",width:5,sortable:false,hidden:true,dataIndex:"psfRecord"}],stripeRows:true,columnLines:true,enableHdMenu:false,enableColumnResize:false,enableColumnMove:false,viewConfig:{forceFit:true,scrollOffset:0},listeners:{rowClick:function(f,e,c){var d=f.store.getAt(e);selectedRowIndexPause=e;field=d.get("pfieldName");comOperator=d.get("poperator");logOperator=d.get("plogicalOperator");value=d.get("pvalue");populateValuesOnRowClick([value,comOperator,logOperator],[getPauseStatusEle(),"updatePause_id","addPause_id"],[pasueOpComboBx,pauselogOpComboBx]);enablePauseRemoveBtn()}}})}function createStopClockGrid(){stopClockStore=new Ext.data.ArrayStore({fields:["stcondition","stfieldName","stoperator","stvalue","stlogicalOperator","stsfRecord"],data:[]});stopClockGrid=new Ext.grid.GridPanel({renderTo:"stopClockGridDiv",id:"stopClockGridId",width:"100%",height:170,border:false,sm:new Ext.grid.RowSelectionModel({singleSelect:true}),store:stopClockStore,columns:[{id:"stcolConditionId",header:ServiceTargetPage.Labels.servicetargetOrder,width:80,sortable:false,dataIndex:"stcondition"},{id:"stcolfieldNameId",header:ServiceTargetPage.Labels.FieldName,width:175,sortable:false,dataIndex:"stfieldName"},{id:"stcolOperatorId",header:ServiceTargetPage.Labels.serviceTargetOperator,width:80,sortable:false,dataIndex:"stoperator"},{id:"stcolValueId",header:ServiceTargetPage.Labels.operandValue,width:190,sortable:false,dataIndex:"stvalue",renderer:"htmlEncode"},{id:"stcolLogicalOperatorId",header:ServiceTargetPage.Labels.LogicalOperator,width:110,sortable:false,dataIndex:"stlogicalOperator"},{id:"stcolSfRecord",width:5,sortable:false,hidden:true,dataIndex:"stsfRecord"}],stripeRows:true,columnLines:true,enableHdMenu:false,enableColumnResize:false,enableColumnMove:false,viewConfig:{forceFit:true,scrollOffset:0},listeners:{rowClick:function(f,e,c){var d=f.store.getAt(e);selectedRowIndexStop=e;field=d.get("stfieldName");comOperator=d.get("stoperator");logOperator=d.get("stlogicalOperator");value=d.get("stvalue");value=d.get("stvalue");populateValuesOnRowClick([value,comOperator,logOperator],[getStopStatusEle(),"updateStop_id","addStop_id"],[stopOpComboBx,stoplogOpComboBx]);enableStopRemoveBtn()}}})}function addRecordToStartClockGrid(){var d=startOpComboBx.getValue();if(d==null||d==""||d=="undefined"){showExtMsg(ServiceTargetPage.Labels.SelectCmpOpMsg);return}var e=getStartStatusEle().value;if(e==null||e==""||e=="undefined"){showExtMsg(ServiceTargetPage.Labels.EnterValMsg);return}var a=startlogOpComboBx.getValue();if(a==null||a==""||a=="undefined"){showExtMsg(ServiceTargetPage.Labels.SelectLogOpMsg);return}var b=Ext.getCmp("startClockGridId").store;var c=b.data.length;listDataForStartClockGrid[c]=new Array(6);listDataForStartClockGrid[c][0]=c+1;listDataForStartClockGrid[c][1]=getStartStatusLabelEle().value;listDataForStartClockGrid[c][2]=startOpComboBx.getValue();listDataForStartClockGrid[c][3]=getStartStatusEle().value;listDataForStartClockGrid[c][4]=startlogOpComboBx.getValue();listDataForStartClockGrid[c][5]=null;loadDatatoStartClockStore();setDefaultValueToStartClockFields()}function addRecordToPauseClockGrid(){var d=pasueOpComboBx.getValue();if(d==null||d==""||d=="undefined"){showExtMsg(ServiceTargetPage.Labels.SelectCmpOpMsg);return}var e=getPauseStatusEle().value;if(e==null||e==""||e=="undefined"){showExtMsg(ServiceTargetPage.Labels.EnterValMsg);return}var a=pauselogOpComboBx.getValue();if(a==null||a==""||a=="undefined"){showExtMsg(ServiceTargetPage.Labels.SelectLogOpMsg);return}var b=Ext.getCmp("pauseClockGridId").store;var c=b.data.length;listDataForPasueClockGrid[c]=new Array(6);listDataForPasueClockGrid[c][0]=c+1;listDataForPasueClockGrid[c][1]=getPauseStatusLabelEle().value;listDataForPasueClockGrid[c][2]=pasueOpComboBx.getValue();listDataForPasueClockGrid[c][3]=getPauseStatusEle().value;listDataForPasueClockGrid[c][4]=pauselogOpComboBx.getValue();listDataForPasueClockGrid[c][5]=null;loadDatatoPauseClockStore();setDefaultValueToPauseClockFields()}function addRecordToStopClockGrid(){var d=stopOpComboBx.getValue();if(d==null||d==""||d=="undefined"){showExtMsg(ServiceTargetPage.Labels.SelectCmpOpMsg);return}var e=getStopStatusEle().value;if(e==null||e==""||e=="undefined"){showExtMsg(ServiceTargetPage.Labels.EnterValMsg);return}var a=stoplogOpComboBx.getValue();if(a==null||a==""||a=="undefined"){showExtMsg(ServiceTargetPage.Labels.SelectLogOpMsg);return}var b=Ext.getCmp("stopClockGridId").store;var c=b.data.length;listDataForStopClockGrid[c]=new Array(6);listDataForStopClockGrid[c][0]=c+1;listDataForStopClockGrid[c][1]=getStopStatusLabelEle().value;listDataForStopClockGrid[c][2]=stopOpComboBx.getValue();listDataForStopClockGrid[c][3]=getStopStatusEle().value;listDataForStopClockGrid[c][4]=stoplogOpComboBx.getValue();listDataForStopClockGrid[c][5]=null;loadDatatoStopClockStore();setDefaultValueToStopClockFields()}function loadDatatoStartClockStore(){startClockStore.removeAll();Ext.getCmp("startClockGridId").getView().refresh();startClockStore.loadData(listDataForStartClockGrid);Ext.getCmp("startClockGridId").getView().refresh();disableStartRemoveBtn()}function loadDatatoPauseClockStore(){pauseClockStore.removeAll();Ext.getCmp("pauseClockGridId").getView().refresh();pauseClockStore.loadData(listDataForPasueClockGrid);Ext.getCmp("pauseClockGridId").getView().refresh();disablePauseRemoveBtn()}function loadDatatoStopClockStore(){stopClockStore.removeAll();Ext.getCmp("stopClockGridId").getView().refresh();stopClockStore.loadData(listDataForStopClockGrid);Ext.getCmp("stopClockGridId").getView().refresh();disableStopRemoveBtn()}function createMOperatorCombo(){startOpComboBx=new Ext.form.ComboBox({id:"startOpCombo",store:compStore.reference,mode:"local",triggerAction:"all",renderTo:"startOpComboDiv",valueField:"comOpeValue",displayField:"comOpeName",editable:false,width:75,listWidth:92,proxy:new Ext.data.MemoryProxy(compStore),emptyText:labelOperator});pasueOpComboBx=new Ext.form.ComboBox({id:"pauseOpCombo",store:compStore.reference,mode:"local",triggerAction:"all",renderTo:"pauseOpComboDiv",valueField:"comOpeValue",displayField:"comOpeName",editable:false,width:75,listWidth:92,proxy:new Ext.data.MemoryProxy(compStore),emptyText:labelOperator});stopOpComboBx=new Ext.form.ComboBox({id:"stopOpCombo",store:compStore.reference,mode:"local",triggerAction:"all",renderTo:"stopOpComboDiv",valueField:"comOpeValue",displayField:"comOpeName",editable:false,width:75,listWidth:92,proxy:new Ext.data.MemoryProxy(compStore),emptyText:labelOperator});startlogOpComboBx=new Ext.form.ComboBox({id:"startlogOpComboBx",store:logOpeStore,mode:"local",triggerAction:"all",valueField:"logOpeValue",displayField:"logOpeName",selectOnFocus:true,renderTo:"startlogOpComboDiv",editable:false,width:75,listWidth:92,height:13});startlogOpComboBx.setValue("NONE");pauselogOpComboBx=new Ext.form.ComboBox({id:"pauselogOpComboBx",store:logOpeStore,mode:"local",triggerAction:"all",valueField:"logOpeValue",displayField:"logOpeName",selectOnFocus:true,renderTo:"pauselogOpComboDiv",editable:false,width:75,listWidth:92,height:13});pauselogOpComboBx.setValue("NONE");stoplogOpComboBx=new Ext.form.ComboBox({id:"stoplogOpComboBx",store:logOpeStore,mode:"local",triggerAction:"all",valueField:"logOpeValue",displayField:"logOpeName",selectOnFocus:true,renderTo:"stoplogOpComboDiv",editable:false,width:75,listWidth:92,height:13});stoplogOpComboBx.setValue("NONE")}function showExtMsg(a){Ext.MessageBox.show({width:250,msg:a,buttons:Ext.MessageBox.OK})}function openStartStatusLookUp(){createMutuallyExclusiveCriteria();if(moduleName=="Incident__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToIncident__c = true and State__c = true ")+"&mutualExclusionFilter="+mutualExcWhereClause,setStartReferenceToVal,450,600)}else{if(moduleName=="Change_Request__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToChange__c = true and State__c = true ")+"&mutualExclusionFilter="+mutualExcWhereClause,setStartReferenceToVal,450,600)}else{if(moduleName=="Problem__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToProblem__c = true and State__c = true ")+"&mutualExclusionFilter="+mutualExcWhereClause,setStartReferenceToVal,450,600)}else{if(moduleName=="Task__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToTask__c = true and State__c = true ")+"&mutualExclusionFilter="+mutualExcWhereClause,setStartReferenceToVal,450,600)}}}}}function setStartReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}var a=getStartStatusEle();if(a!=null&&typeof(a)!="undefined"){if(typeof(referenceName)!="undefined"&&referenceName!=null){referenceName=decodeVal(referenceName);a.value=referenceName}var c=document.getElementById("startReferenceID");if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function openPauseStatusLookUp(){createMutuallyExclusiveCriteria();if(moduleName=="Incident__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToIncident__c = true and State__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setPauseReferenceToVal,450,600)}else{if(moduleName=="Change_Request__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToChange__c = true and State__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setPauseReferenceToVal,450,600)}else{if(moduleName=="Problem__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToProblem__c = true and State__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setPauseReferenceToVal,450,600)}else{if(moduleName=="Task__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToTask__c = true and State__c = true ")+"&mutualExclusionFilter="+mutualExcWhereClause,setPauseReferenceToVal,450,600)}}}}}function setPauseReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}var a=getPauseStatusEle();if(a!=null&&typeof(a)!="undefined"){if(typeof(referenceName)!="undefined"&&referenceName!=null){referenceName=decodeVal(referenceName);a.value=referenceName}var c=document.getElementById("pauseReferenceID");if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function openStopStatusLookUp(){createMutuallyExclusiveCriteria();if(moduleName=="Incident__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToIncident__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setStopReferenceToVal,450,600)}else{if(moduleName=="Change_Request__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToChange__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setStopReferenceToVal,450,600)}else{if(moduleName=="Problem__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToProblem__c = true")+"&mutualExclusionFilter="+mutualExcWhereClause,setStopReferenceToVal,450,600)}else{if(moduleName=="Task__c"){openPopupRF("SearchPage?popupId=Status__c&isLookup=true&&idNameForPopUp=true&referenceObjectName=Status__c&filterClause="+escape("inactive__c = false and appliesToTask__c = true  ")+"&mutualExclusionFilter="+mutualExcWhereClause,setStopReferenceToVal,450,600)}}}}}function setStopReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}var a=getStopStatusEle();if(a!=null&&typeof(a)!="undefined"){if(typeof(referenceName)!="undefined"&&referenceName!=null){referenceName=decodeVal(referenceName);a.value=referenceName}var c=document.getElementById("stopReferenceID");if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function createMutuallyExclusiveCriteria(){mutualExcWhereClause="";var h=startClockStore.data.length;var b="";var g="";var e="";for(var c=0;c<=h-1;c++){var d=startClockGrid.getStore().getAt(c);var a=d.get("value");b+=encodeURIComponent(a)+nonPrint}var f=pauseClockStore.data.length;for(var c=0;c<=f-1;c++){var d=pauseClockGrid.getStore().getAt(c);var a=d.get("pvalue");g+=encodeURIComponent(a)+nonPrint}var j=stopClockStore.data.length;for(var c=0;c<=j-1;c++){var d=stopClockGrid.getStore().getAt(c);var a=d.get("stvalue");e+=encodeURIComponent(a)+nonPrint}mutualExcWhereClause=b+g+e;mutualExcWhereClause=mutualExcWhereClause.substring(0,mutualExcWhereClause.length-1);return mutualExcWhereClause}function setSupportHoursReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}var a=getSupportHoursEle();if(a!=null&&typeof(a)!="undefined"){a.value=referenceName;var c=getSupportHoursHiddenEle();if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function setInputDataAndElementsOnRowClick(h){var k=QualificationGrid.store.getAt(h);var a=k.get("operandFieldLabel");var l=k.get("operatorFieldAPIName");var b=k.get("operandValue");var e=k.get("operatorValue");var j=k.get("groupingOperator");var f=k.get("operandFieldType");if(l!=null&&l!="undefined"){fieldsEditor.setValue(l);var d=fetchQualificationComboFieldLabel();var c=d.get("type");if(c!=null&&c.indexOf(":")>0){var g=c.split(":")[1];if(g!=null&&typeof(g)!="undefined"&&g!=""){selectedTextAreaLength=g}}}setVisibilityData(l,a,f,b,e,j)}function setComparisonOperatorStore(a){if(a.indexOf(":")>0){a=a.split(":")[0]}else{if(a.indexOf(EF)>0){a=a.split(EF)[0]}}if(a=="reference"){comparisonOperator.store.loadData(compStore.reference)}else{if(a=="datetime"){comparisonOperator.store.loadData(compStore.dateTime)}else{if(a=="date"){comparisonOperator.store.loadData(compStore.dateTime)}else{if(a=="textarea"){comparisonOperator.store.loadData(compStore.textArea)}else{if(a=="text"){comparisonOperator.store.loadData(compStore.text)}else{if(a=="phone"){comparisonOperator.store.loadData(compStore.phone)}else{if(a=="currency"){comparisonOperator.store.loadData(compStore.currency)}else{if(a=="percent"){comparisonOperator.store.loadData(compStore.percent)}else{if(a=="number"){comparisonOperator.store.loadData(compStore.number)}else{if(a=="boolean"){comparisonOperator.store.loadData(compStore.booleanVar)}else{if(a=="email"){comparisonOperator.store.loadData(compStore.email)}else{if(a=="picklist"){comparisonOperator.store.loadData(compStore.picklist)}}}}}}}}}}}}comparisonOperator.reset()}function getUpdateBtnEle(){return document.getElementById("updateButtonId")}function getAddBtnEle(){return document.getElementById("addButtonId")}function reomveRecordFromStartClockGrid(){var a=startClockGrid.getSelectionModel().getSelected();listDataForStartClockGrid.splice(selectedRowIndexStart,1);startClockGrid.store.remove(a);var b=startClockStore.data.length;for(var c=0;c<b;c++){var d=a.store.getAt(c);d.set("condition",c+1);listDataForStartClockGrid[c][0]=c+1;d.commit()}disableStartRemoveBtn();setDefaultValueToStartClockFields();document.getElementById("updateStart_id").style.display="none";document.getElementById("addStart_id").style.display="inline"}function reomveRecordFromPauseClockGrid(){var a=pauseClockGrid.getSelectionModel().getSelected();listDataForPasueClockGrid.splice(selectedRowIndexPause,1);pauseClockGrid.store.remove(a);var b=pauseClockStore.data.length;for(var c=0;c<b;c++){var d=a.store.getAt(c);d.set("condition",c+1);listDataForPasueClockGrid[c][0]=c+1;d.commit()}disablePauseRemoveBtn();setDefaultValueToPauseClockFields();document.getElementById("updatePause_id").style.display="none";document.getElementById("addPause_id").style.display="inline"}function reomveRecordFromStopClockGrid(){var a=stopClockGrid.getSelectionModel().getSelected();listDataForStopClockGrid.splice(selectedRowIndexStop,1);stopClockGrid.store.remove(a);var b=stopClockStore.data.length;for(var c=0;c<b;c++){var d=a.store.getAt(c);d.set("condition",c+1);listDataForStopClockGrid[c][0]=c+1;d.commit()}disableStopRemoveBtn();setDefaultValueToStopClockFields();document.getElementById("updateStop_id").style.display="none";document.getElementById("addStop_id").style.display="inline"}function hideStopClockPanel(){var b=getTargetTypeEle().value;var a=getStopClockPanelBarEle();if(b=="ResponseTime"){a.style.display="none"}else{a.style.display="block"}}function disableStartRemoveBtn(){document.getElementById("removeStart_id").disabled=true;document.getElementById("removeStart_id").src=getSDFStylesResPath()+"/SDEFbuttons/b_remove_disabled.png"}function disablePauseRemoveBtn(){document.getElementById("removePause_id").disabled=true;document.getElementById("removePause_id").src=getSDFStylesResPath()+"/SDEFbuttons/b_remove_disabled.png"}function disableStopRemoveBtn(){document.getElementById("removeStop_id").disabled=true;document.getElementById("removeStop_id").src=getSDFStylesResPath()+"/SDEFbuttons/b_remove_disabled.png"}function enableStartRemoveBtn(){document.getElementById("removeStart_id").disabled=false;document.getElementById("removeStart_id").src=getSDFStylesResPath()+"/SDEFbuttons/b_remove.png"}function enablePauseRemoveBtn(){document.getElementById("removePause_id").disabled=false;document.getElementById("removePause_id").src=getSDFStylesResPath()+"/SDEFbuttons/b_remove.png"}function enableStopRemoveBtn(){document.getElementById("removeStop_id").disabled=false;document.getElementById("removeStop_id").src=getSDFStylesResPath()+"/SDEFbuttons/b_remove.png"}function upadateSLTQData(){var a=QualificationGrid.getSelectionModel().getSelected();addUpdateSLTQData(a);setAddUpdateOnClick(null);QualificationGrid.getSelectionModel().clearSelections();clearQualificationCriteria()}function resetSLTForm(){daysSpinner.setValue(targetInDays);hoursSpinner.setValue(targetInHours);minutesSpinner.setValue(targetInMinutes);businessDaysSpinner.setValue(targetInBusinessDays);EnablingAndDisablingButtons();initTargetFields();setDefaultValueToStartClockFields();setDefaultValueToStopClockFields();setDefaultValueToPauseClockFields();loadDataToGrids();hideStopClockPanel()}function validateData(e){var c=false;if(compTypeNo!=0){if(compTypeNo==7){if(isNaN(e)){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Number : "+e,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==8){var a=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!e.match(a)){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Email address : "+e,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==9){if(isNaN(e)||e<0||e>100){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Percent : "+e,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==11){var b=/^-?\d+(\.\d+)?$/;if(!e.match(b)){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Currency :  "+e,buttons:Ext.MessageBox.OK})}}else{if(compTypeNo==10){var d=/^[-]?\d*?\d*$/;if(!e.match(d)){c=true;Ext.MessageBox.show({width:250,msg:"Invalid Phone : "+e,buttons:Ext.MessageBox.OK})}}}}}}}return c}function gridHasDupesNONE(f){var c=f.store;var b=f.id;var e,d,h;h=c.data.length;for(e=0;e<h;e++){for(d=e+1;d<h;d++){var a=c.getAt(e);var g=c.getAt(d);if(f.id=="startClockGridId"){if(a.get("logicalOperator")==g.get("logicalOperator")&&a.get("logicalOperator")=="NONE"){return true}}else{if(f.id=="pauseClockGridId"){if(a.get("plogicalOperator")==g.get("plogicalOperator")&&a.get("plogicalOperator")=="NONE"){return true}}else{if(f.id=="stopClockGridId"){if(a.get("stlogicalOperator")==g.get("stlogicalOperator")&&a.get("stlogicalOperator")=="NONE"){return true}}else{if(f.id=="qualificationCriteriaGrid"){if(a.get("groupingOperator")==g.get("groupingOperator")&&a.get("groupingOperator")=="NONE"){return true}}}}}}}return false}function validateCriteria(){var b=getStopClockPanelBarEle();if(getServiceTitleEle().value==""||getServiceTitleEle().value==null){showExtMsg(ServiceTargetPage.Labels.serviceTargetTitleEmpty);return true}if(daysSpinner.getValue()<=0&&hoursSpinner.getValue()<=0&&minutesSpinner.getValue()<=0&&businessDaysSpinner.getValue()<=0&&businessDaysSpinner.getValue()<=0){showExtMsg(ServiceTargetPage.Labels.TargetEmpty);return true}if(!isAdvRulePresent&&gridHasDupesNONE(QualificationGrid)){showExtMsg(ServiceTargetPage.Labels.ValidateLogicalOperatorForQual);return true}else{if(gridHasDupesNONE(startClockGrid)){showExtMsg(ServiceTargetPage.Labels.ValidateLogicalOperatorForMeasurement);return true}else{if(gridHasDupesNONE(stopClockGrid)&&b.style.display!="none"){showExtMsg(ServiceTargetPage.Labels.ValidateLogicalOperatorForMeasurement);return true}else{if(gridHasDupesNONE(pauseClockGrid)){showExtMsg(ServiceTargetPage.Labels.ValidateLogicalOperatorForMeasurement);return true}}}}if(startClockStore.data.length==0){showExtMsg(ServiceTargetPage.Labels.ValidateMandatoryMeasurements);return true}if(stopClockStore.data.length==0&&b.style.display!="none"){showExtMsg(ServiceTargetPage.Labels.ValidateMandatoryMeasurements);return true}if(!isAdvRulePresent){var f=QualificationGrid.getStore().getAt(qualificationGridStore.data.length-1);if(f!=null&&f!=""&&typeof(f)!="undefined"){var e=f.get("groupingOperator");if(e!="NONE"){qualificationGridStore.getAt(qualificationGridStore.data.length-1).set("groupingOperator","NONE")}}}var m=startClockGrid.getStore().getAt(startClockStore.data.length-1);if(m!=null&&m!=""&&typeof(m)!="undefined"){var j=m.get("logicalOperator");if(j!="NONE"){showExtMsg(ServiceTargetPage.Labels.ValidateLogicalOperatorForMeasurement);return true}}var a=stopClockGrid.getStore().getAt(stopClockStore.data.length-1);if(a!=null&&a!=""&&typeof(a)!="undefined"){var k=a.get("stlogicalOperator");if(k!="NONE"&&b.style.display!="none"){showExtMsg(ServiceTargetPage.Labels.ValidateLogicalOperatorForMeasurement);return true}}var d=pauseClockGrid.getStore().getAt(pauseClockStore.data.length-1);if(d!=null&&d!=""&&typeof(d)!="undefined"){var h=d.get("plogicalOperator");if(h!="NONE"){showExtMsg(ServiceTargetPage.Labels.ValidateLogicalOperatorForMeasurement);return true}}if(isAdvRulePresent){var l=document.getElementById("filterLogic").value;l=l.replace(/[)]/g," ) ");l=l.replace(/[(]/g," ( ");l=l.replace(/  +/g," ").trim();document.getElementById("filterLogic").value=l;ruleGridStore=Ext.getCmp("qualificationCriteriaGrid").store;var c=isValidLogicalStatement(l);if(c){var g=checkValidLogic();if(g){if(!validateOwnerCondition()){showOLAMessage(FilterLogicValidationForOwnerId);hideLoadingMask();Ext.getCmp("saveId").setDisabled(false);return true}hideLoadingMask();Ext.MessageBox.show({msg:FilterLogicAddCriteriaValidation,width:310,buttons:Ext.Msg.YESNO,fn:function(n){if(n=="yes"){showLoadingMask();setConditionsData();var p=Ext.getCmp("st_inactive__c").getValue();var o=document.getElementById("filterLogic").value;save(p,o,isAdvRulePresent,qualificationClockStatus)}},icon:Ext.MessageBox.WARNING});return true}else{return false}}else{hideLoadingMask();showExtMsg(FilterLogicValidation);return true}}return false}function loadDataToGrids(){qualificationGridStore.loadData(listData);qualificationOrderIndex=listData.length+1;if(arrayOfSTCBeanForStartClock!=null&&arrayOfSTCBeanForStartClock.size()>0){listDataForStartClockGrid=arrayOfSTCBeanForStartClock;loadDatatoStartClockStore()}if(arrayOfSTCBeanForStopClock!=null&&arrayOfSTCBeanForStopClock.size()>0){listDataForStopClockGrid=arrayOfSTCBeanForStopClock;loadDatatoStopClockStore()}if(arrayOfSTCBeanForPauseClock!=null){listDataForPasueClockGrid=arrayOfSTCBeanForPauseClock;loadDatatoPauseClockStore()}}function updateRecordOfStartClockGrid(){listDataForStartClockGrid[selectedRowIndexStart][0]=selectedRowIndexStart+1;listDataForStartClockGrid[selectedRowIndexStart][1]=getStartStatusLabelEle().value;listDataForStartClockGrid[selectedRowIndexStart][2]=startOpComboBx.getValue();listDataForStartClockGrid[selectedRowIndexStart][3]=getStartStatusEle().value;listDataForStartClockGrid[selectedRowIndexStart][4]=startlogOpComboBx.getValue();listDataForStartClockGrid[selectedRowIndexStart][5]=startClockStore.getAt(selectedRowIndexStart).get("sfRecord");loadDatatoStartClockStore();setDefaultValueToStartClockFields();document.getElementById("updateStart_id").style.display="none";document.getElementById("addStart_id").style.display="inline"}function updateRecordOfPauseClockGrid(){listDataForPasueClockGrid[selectedRowIndexPause][0]=selectedRowIndexPause+1;listDataForPasueClockGrid[selectedRowIndexPause][1]=getPauseStatusLabelEle().value;listDataForPasueClockGrid[selectedRowIndexPause][2]=pasueOpComboBx.getValue();listDataForPasueClockGrid[selectedRowIndexPause][3]=getPauseStatusEle().value;listDataForPasueClockGrid[selectedRowIndexPause][4]=pauselogOpComboBx.getValue();listDataForPasueClockGrid[selectedRowIndexPause][5]=pauseClockStore.getAt(selectedRowIndexPause).get("psfRecord");loadDatatoPauseClockStore();setDefaultValueToPauseClockFields();document.getElementById("updatePause_id").style.display="none";document.getElementById("addPause_id").style.display="inline"}function updateRecordOfStopClockGrid(){var a=stopClockGrid.getSelectionModel().getSelected();listDataForStopClockGrid[selectedRowIndexStop][0]=selectedRowIndexStop+1;listDataForStopClockGrid[selectedRowIndexStop][1]=getStopStatusLabelEle().value;listDataForStopClockGrid[selectedRowIndexStop][2]=stopOpComboBx.getValue();listDataForStopClockGrid[selectedRowIndexStop][3]=getStopStatusEle().value;listDataForStopClockGrid[selectedRowIndexStop][4]=stoplogOpComboBx.getValue();listDataForStopClockGrid[selectedRowIndexStop][5]=stopClockStore.getAt(selectedRowIndexStop).get("stsfRecord");loadDatatoStopClockStore();setDefaultValueToStopClockFields();document.getElementById("updateStop_id").style.display="none";document.getElementById("addStop_id").style.display="inline"}function populateValuesOnRowClick(a,c,b){if(a!=null&&typeof(a)!="undefined"&&c!=null&&typeof(c)!="undefined"){c[0].value=a[0];document.getElementById(c[1]).style.display="inline";document.getElementById(c[2]).style.display="none"}if(b!=null&&typeof(b)!="undefined"){b[0].setValue(a[1]);b[1].setValue(a[2])}}function RefreshGrid(){startClockGrid.getView().refresh();stopClockGrid.getView().refresh();pauseClockGrid.getView().refresh()}function toggleAdvanceExpression(b,a){document.getElementById(b).style.display="none";document.getElementById(a).style.display="block"}function populateTextArea(c,d){var b=c;var e=document.getElementById(d);var f="";for(i=0;i<b.data.length;i++){var a=b.getAt(i);f=f+a.get("orderIndex")+" "+a.get("groupingOperator")+" "}e.value=f}function validateInput(b){var a=(b.which)?b.which:b.keyCode;if(a<=41&&a>=35){return true}return false}function populateAdvExpTextArea(d,e){var c=d.store;var f=document.getElementById(e);var g="";var b=d.id;for(i=0;i<c.data.length;i++){var a=c.getAt(i);if(d.id=="startClockGridId"){g=g+a.get("condition")+" "+a.get("logicalOperator")+" "}else{if(d.id=="pauseClockGridId"){g=g+a.get("pcondition")+" "+a.get("plogicalOperator")+" "}else{if(d.id=="stopClockGridId"){g=g+a.get("stcondition")+" "+a.get("stlogicalOperator")+" "}}}}f.value=g}function ConfrimDeleteMilestone(){if(!Ext.getCmp("btnRemove").disabled){Ext.MessageBox.confirm(ServiceTargetPage.Labels.labelDelete,ServiceTargetPage.Labels.labelDeleteMilestone,function(a){if(a==="yes"){deleteMilestonefromStore()}})}}function ConfrimDeleteAction(){if(!Ext.getCmp("btnRemoveAct").disabled){var a="";if(selectedRowAction.length==1){a=ServiceTargetPage.Labels.labelDeleteAction}else{a=ServiceTargetPage.Labels.labelDeleteActions}Ext.MessageBox.confirm(ServiceTargetPage.Labels.labelDelete,a,function(b){if(b==="yes"){deleteActionfromStore()}})}}function deleteMilestonefromStore(){milestoneGrid.store.remove(selectedRowMilestone);milestoneGrid.getView().refresh();actionGrid.store.removeAll();actionGrid.getView().refresh();delMilestone();milestoneGrid.getSelectionModel().selectFirstRow();if(milestonetore.data.length<=0){var a=Ext.getCmp("btnRemove");if(a){a.setDisabled(true);a.setIconClass("bmcDeleteSLTDisable")}var c=Ext.getCmp("btnEdit");if(c){c.setDisabled(true);c.setIconClass("bmcEditSLTDisable")}var b=Ext.getCmp("btnRemoveAct");if(b){b.setDisabled(true);b.setIconClass("bmcDeleteSLTDisable")}}}function deleteActionfromStore(){for(i=0;i<selectedRowAction.length;i++){actionGrid.store.remove(selectedRowAction[i])}actionGrid.getView().refresh();delAction()}function ChangeActionLabel(){if(milestonetore.getCount()==0){RemedyForceHTMLProcessor.setText(getActionLabel(),ServiceTargetPage.Labels.labelAction+" : ")}}function validateQAdvExpression(){var c="";var d=0;while(qualificationGridStore.data.length>d){c=c+qualificationGridStore.getAt(d).get("orderIndex")+nonPrint+qualificationGridStore.getAt(d).get("operatorFieldAPIName")+nonPrint+qualificationGridStore.getAt(d).get("operatorValue")+nonPrint+qualificationGridStore.getAt(d).get("operandValue")+nonPrint+qualificationGridStore.getAt(d).get("operandFieldType")+nonPrint+qualificationGridStore.getAt(d).get("groupingOperator")+nonPrint+qualificationGridStore.getAt(d).get("qualId")+PE;d++}var b=getApplySTStrEle();b.value=c;var a=getQAdvExprTextArea();a.value=a.value;validateAdvExpression("0")}function resetQAdvExpression(){populateTextArea(QualificationGrid.store,getQAdvExprTextArea().id)}function milestoneInvalidated(){if(errorFlag==true){Ext.Msg.alert("",ServiceTargetPage.Labels.milestoneInvalidated,function(){DisplayAfterSaveMessage()})}else{DisplayAfterSaveMessage()}}function DisplayAfterSaveMessage(){Ext.getCmp("saveId").setDisabled(false);if(errormsg==ServiceTargetPage.Labels.labelSavedSuccessfully){getAppliesToEle().disabled=true;Ext.getCmp("resetId").setDisabled(false);if(!isUpdateble&&sltId!=null&&sltId!=""){Ext.getCmp("saveId").setDisabled(true)}}updateTitle();showError()}function updateTitle(){var a=window.parent.Ext.getCmp("popupWindowId1");var b=Ext.util.Format.ellipsis(ServiceTargetHeader+getServiceTitleValue(),80);if(a!=null&&typeof(a)!="undefined"&&b!=""){a.setTitle(b)}}function refreshSLTList(){window.parent.reloadIframe()}function validateInputFF(b){if(!Ext.isIE){var a=(b.which)?b.which:b.keyCode;if(a<=41&&a>=35){return true}return false}return}function validateInputIE(b){if(Ext.isIE){var a=(b.which)?b.which:b.keyCode;if((a<=41&&a>=35)||(a==57||a==48)){return true}return false}return}function EnablingAndDisablingButtons(){var b=Ext.getCmp("resetId");var a=Ext.getCmp("nextId");var c=Ext.getCmp("prevId");var d=Ext.getCmp("saveId");if(getSLACopyId()!=null&&getSLACopyId()!=""){b.setDisabled(true);a.setDisabled(true);c.setDisabled(true);d.setDisabled(true)}else{if(sltId==null||sltId==""||isCopied==true){getDurationFieldEle().value=getDuration();b.setDisabled(true);a.setDisabled(true);c.setDisabled(true);d.setDisabled(false)}else{getAppliesToEle().disabled=true;Ext.getCmp("st_inactive__c").setValue(getSLTInactive());getAppliesToEle().disabled=true;b.setDisabled(false);a.setDisabled(false);c.setDisabled(false);d.setDisabled(false)}}if(!isUpdateble&&sltId!=null&&sltId!=""){d.setDisabled(true)}isCopied=false}function callInitMilestone(a){initMilestone()}function setDefaultValueToStartClockFields(){startOpComboBx.setValue("");startlogOpComboBx.setValue("NONE");getStartStatusEle().value=""}function setDefaultValueToStopClockFields(){stopOpComboBx.setValue("");stoplogOpComboBx.setValue("NONE");getStopStatusEle().value=""}function setDefaultValueToPauseClockFields(){pasueOpComboBx.setValue("");pauselogOpComboBx.setValue("NONE");getPauseStatusEle().value=""}function handleResetChange(){if(clickedOnce){clickedOnce=false}}function handleChange(a){if(this.id!="Service_target_Id"&&this.id!="qualification_id"&&this.id!="measurement_id"&&this.id!="milestones_actions_id"){if(!clickedOnce){clickedOnce=true}}}function enableDisableTargetFields(){if(document.getElementById("daysSpinner")&&document.getElementById("hoursSpinner")&&document.getElementById("minutesSpinner")&&document.getElementById("businessDaysSpinner")){isInBusinessDays=document.getElementById("bd-radio").checked?true:false;if(isInBusinessDays){daysSpinner.setValue(0);hoursSpinner.setValue(0);minutesSpinner.setValue(0);daysSpinner.setDisabled(true);hoursSpinner.setDisabled(true);minutesSpinner.setDisabled(true);businessDaysSpinner.setDisabled(false);document.getElementById("daysSpinner").readOnly=true;document.getElementById("hoursSpinner").readOnly=true;document.getElementById("minutesSpinner").readOnly=true;document.getElementById("businessDaysSpinner").readOnly=false}else{businessDaysSpinner.setValue(0);daysSpinner.setDisabled(false);hoursSpinner.setDisabled(false);minutesSpinner.setDisabled(false);businessDaysSpinner.setDisabled(true);document.getElementById("daysSpinner").readOnly=false;document.getElementById("hoursSpinner").readOnly=false;document.getElementById("minutesSpinner").readOnly=false;document.getElementById("businessDaysSpinner").readOnly=true}getDurationFieldEle().value=getDuration()}}function initTargetFields(){if(getIsBusinessDays()){document.getElementById("bd-radio").checked=true}else{document.getElementById("dhm-radio").checked=true}enableDisableTargetFields()}function setRuleLogicValue(b){if(b){document.getElementById("filterLogic").value=filterLogic}else{var a="";var c=Ext.getCmp("qualificationCriteriaGrid").store.data.length;for(i=1;i<=c;i++){a+=i+" AND "}a=a.substring(0,a.lastIndexOf(" AND "));document.getElementById("filterLogic").value=a}}function toggleAdd(a){var b=QualificationGrid.getColumnModel();b.setHidden(4,true);QualificationGrid.getView().refresh();document.getElementById("clearFilter").style.display="inline";document.getElementById("exampleText").style.display="inline";document.getElementById("filterLogic").style.display="inline";document.getElementById("addFilter").style.display="none";document.getElementById("qualButtonTD").style.display="none";setRuleLogicValue(a);isAdvRulePresent=true}function toggleClear(){var a=QualificationGrid.getColumnModel();a.setHidden(4,false);a.setColumnWidth(0,80,false);a.setColumnWidth(1,175,false);a.setColumnWidth(2,80,false);a.setColumnWidth(3,190,false);a.setColumnWidth(4,113,false);QualificationGrid.getView().refresh();document.getElementById("clearFilter").style.display="none";document.getElementById("exampleText").style.display="none";document.getElementById("filterLogic").style.display="none";document.getElementById("addFilter").style.display="inline";document.getElementById("qualButtonTD").style.display="";document.getElementById("filterLogic").value="";isAdvRulePresent=false}function showLoadingMask(){waitMask=new Ext.LoadMask(Ext.getBody(),{msg:LoadingTxt});if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.show()}}function hideLoadingMask(){if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.hide()}}function showMessage(a){Ext.Msg.show({msg:a,buttons:Ext.Msg.OK,minWidth:300,maxWidth:360,minHeight:110,icon:warningIcon})}function validateOwnerCondition(){if(isOLA&&isQueueBasedTTEnabled){var k=false;var f=getClockModePicklist();if(f&&f.getValue()!=cancelTheTarget){if(!isAdvRulePresent){var g=0;var c=0;var d=qualificationGridStore!=null&&typeof(qualificationGridStore)!="undefined";if(d){c=qualificationGridStore.data.length}while(d&&c>g){var h=qualificationGridStore.getAt(g);if(h&&(h.get("operatorFieldAPIName")=="ownerid"||h.get("operatorFieldAPIName")=="queue__c")){k=true;break}g++}}else{var a=document.getElementById("filterLogic").value;var j;var e=[];if(a){j=a.split(" ");if(j){j.forEach(function b(m,l){if(!isNaN(m)){e.push(m)}});if(e){e.forEach(function b(n,l){var o=QualificationGrid!=null&&typeof(QualificationGrid)!="undefined";if(o){var m=QualificationGrid.store.getAt(parseInt(n)-1);if(m&&(m.get("operatorFieldAPIName")=="ownerid"||m.get("operatorFieldAPIName")=="queue__c")){k=true}}})}}}}}else{if(f&&f.getValue()==cancelTheTarget){k=true}}return k}return true}function initClockModePanel(){if(isOLA){if(!isQueueBasedTTEnabled){disabledClockStatus();document.getElementById("linkToOptIn").classList.add("displayIcon");document.getElementById("warnMsg").classList.add("hideIcon")}else{var f=0;var d=false;var b=0;var e=qualificationGridStore!=null&&typeof(qualificationGridStore)!="undefined";if(e){f=qualificationGridStore.data.length}while(e&&f>b){var c=qualificationGridStore.getAt(b);if(c&&(c.get("operatorFieldAPIName")=="ownerid"||c.get("operatorFieldAPIName")=="queue__c")){d=true;break}b++}if(!d){disabledClockStatus();document.getElementById("linkToOptIn").classList.remove("displayIcon");document.getElementById("warnMsg").classList.remove("hideIcon");document.getElementById("linkToOptIn").classList.add("hideIcon");document.getElementById("warnMsg").classList.add("displayIcon")}else{var a=getClockModePicklist();a.setDisabled(false);document.getElementById("linkToOptIn").classList.remove("displayIcon");document.getElementById("warnMsg").classList.remove("displayIcon");document.getElementById("linkToOptIn").classList.add("hideIcon");document.getElementById("warnMsg").classList.add("hideIcon")}}}}function getClockModePicklist(){return Ext.getCmp("clockStatusId")}function disabledClockStatus(){var a=getClockModePicklist();a.setValue(cancelTheTarget);a.setDisabled(true);qualificationClockStatus=cancelTheTarget}function refreshStatusPicklist(){qualificationClockStatus=refreshQualClockStatusValue();var a=getClockModePicklist();a.setValue(qualificationClockStatus);initClockModePanel()}function showOLAMessage(a){Ext.Msg.show({minWidth:300,maxWidth:360,minHeight:110,msg:a,buttons:Ext.Msg.OK})};