var isDirty=false;function closeIt(){if(!isDirty){return}else{return warningMsgForCloseClient}}function setDirtyFlag(){isDirty=true}function initiateSelfClosing(){window.onbeforeunload=closeIt}window.onload=function(){initiateSelfClosing()};function initLoadData(){timezoneFieldStore=new Ext.data.ArrayStore({fields:["key","value"],data:timeZoneData});localeFieldStore=new Ext.data.ArrayStore({fields:["key","value"],data:localeData});languageFieldStore=new Ext.data.ArrayStore({fields:["key","value"],data:languageData});roleFieldStore=new Ext.data.ArrayStore({fields:["key","value"],data:roleData});fetchComboFieldStore();moduleFieldCombo=new Ext.form.ComboBox({id:"timezoneFieldCombo",store:timezoneFieldStore,width:Ext.isIE7?198:204,height:Ext.isIE7?19:17,displayField:"value",renderTo:"timezoneCombo",valueField:"value",typeAhead:true,mode:"local",forceSelection:true,triggerAction:"all",tpl:'<tpl for="." ><div class="x-combo-list-item" id="{value}" ext:qtip="{value}">{value}</div></tpl>',selectOnFocus:true,editable:false,value:timezonevalue,cls:"timzoneCls",listeners:{select:function(d,b,c){comboFldIndex=c;document.getElementById(ClientPageComp.ComponentVars.userTimeZone).value=b.get("key")},change:function(){setDirtyFlag()}}});localeFieldCombo=new Ext.form.ComboBox({id:"localeFieldCombo",store:localeFieldStore,width:Ext.isIE7?198:204,height:Ext.isIE7?19:17,displayField:"value",renderTo:"localeCombo",valueField:"value",typeAhead:true,mode:"local",forceSelection:true,triggerAction:"all",tpl:'<tpl for="." ><div class="x-combo-list-item" id="{value}" ext:qtip="{value}">{value}</div></tpl>',selectOnFocus:true,editable:false,value:localevalue,cls:"timzoneCls",listeners:{select:function(d,b,c){comboFldIndex=c;document.getElementById(ClientPageComp.ComponentVars.userLocale).value=b.get("key")},change:function(){setDirtyFlag()}}});languageFieldCombo=new Ext.form.ComboBox({id:"languageFieldCombo",store:languageFieldStore,width:Ext.isIE7?198:204,height:Ext.isIE7?19:17,displayField:"value",renderTo:"languageCombo",valueField:"value",typeAhead:true,mode:"local",forceSelection:true,triggerAction:"all",tpl:'<tpl for="." ><div class="x-combo-list-item" id="{value}" ext:qtip="{value}">{value}</div></tpl>',selectOnFocus:true,editable:false,value:languagevalue,cls:"timzoneCls",listeners:{select:function(d,b,c){comboFldIndex=c;document.getElementById(ClientPageComp.ComponentVars.userLanguage).value=b.get("key")},change:function(){setDirtyFlag()}}});roleFieldCombo=new Ext.form.ComboBox({id:"roleFieldCombo",store:roleFieldStore,width:Ext.isIE7?132:136,height:Ext.isIE7?19:17,displayField:"value",renderTo:"roleCombo",valueField:"key",typeAhead:true,mode:"local",disabled:disableRole,forceSelection:true,triggerAction:"all",tpl:'<tpl for="." ><div class="x-combo-list-item" id="{value:htmlEncode}" title="{value:htmlEncode}">{value:htmlEncode}</div></tpl>',selectOnFocus:true,editable:false,value:roleFldvalue,cls:"clsClientSelectList",listeners:{select:function(d,b,c){comboFldIndex=c;document.getElementById(ClientPageComp.ComponentVars.roleListId).value=b.get("key")},change:function(c,d,b){currentSelectedRole=d;selectedRoleHaveUser(currentSelectedRole)}}});setAccountRoleAsMandatory();var a=document.getElementById(ClientPageComp.ComponentVars.account_id_name);if(disableRole&&a.value!=null&&a.value!=""){showWarningMsgForFirstClient()}}function showWarningMsgForFirstClientOfSelectedRole(){Ext.Msg.defaultButton=2;Ext.Msg.show({title:ConfirmAction,msg:warningMsgForFirstClientForSelectedRole,buttons:Ext.Msg.YESNO,buttonText:{yes:YesLabel,no:NoLabel},fn:function(a){if(a=="no"){Ext.getCmp("roleFieldCombo").setValue(rolevalue)}},icon:Ext.MessageBox.WARNING})}function showWarningMsgForFirstClient(){alertMsg=Ext.Msg.show({msg:warningMsgForFirstClient,buttons:Ext.Msg.OK,width:400,frame:false,icon:Ext.Msg.INFO})}function fetchComboFieldStore(){if(timezonevalue!=""){var a=0;while(timezoneFieldStore.data.length>a){if(timezoneFieldStore.getAt(a).get("key")==timezonevalue){timezonevalue=timezoneFieldStore.getAt(a).get("value");break}a++}}else{if(timezoneFieldStore.data.length>0){timezonevalue=timezoneFieldStore.getAt(0).get("value")}}if(localevalue!=""){var a=0;while(localeFieldStore.data.length>a){if(localeFieldStore.getAt(a).get("key")==localevalue){localevalue=localeFieldStore.getAt(a).get("value");break}a++}}else{if(localeFieldStore.data.length>0){localevalue=localeFieldStore.getAt(0).get("value")}}if(languagevalue!=""){var a=0;while(languageFieldStore.data.length>a){if(languageFieldStore.getAt(a).get("key")==languagevalue){languagevalue=languageFieldStore.getAt(a).get("value");break}a++}}else{if(languageFieldStore.data.length>0){languagevalue=languageFieldStore.getAt(0).get("value")}}if(rolevalue!=""){var a=0;var b=rolevalue;while(roleFieldStore.data.length>a){if(roleFieldStore.getAt(a).get("key")==rolevalue){roleFldvalue=roleFieldStore.getAt(a).get("value");break}else{roleFldvalue=roleFieldStore.getAt(0).get("value")}a++}}else{if(roleFieldStore.data.length>0){roleFldvalue=roleFieldStore.getAt(0).get("value")}}}function setComboStoreJS(){timezoneFieldStore.removeAll();Ext.getCmp("timezoneFieldCombo").store.loadData(timeZoneData);if(timezonevalue!=""){var a=0;while(timezoneFieldStore.data.length>a){if(timezoneFieldStore.getAt(a).get("key")==timezonevalue){Ext.getCmp("timezoneFieldCombo").setValue(timezoneFieldStore.getAt(a).get("value"));break}a++}}localeFieldStore.removeAll();Ext.getCmp("localeFieldCombo").store.loadData(localeData);if(localevalue!=""){var a=0;while(localeFieldStore.data.length>a){if(localeFieldStore.getAt(a).get("key")==localevalue){Ext.getCmp("localeFieldCombo").setValue(localeFieldStore.getAt(a).get("value"));break}a++}}languageFieldStore.removeAll();Ext.getCmp("languageFieldCombo").store.loadData(languageData);if(languagevalue!=""){var a=0;while(languageFieldStore.data.length>a){if(languageFieldStore.getAt(a).get("key")==languagevalue){Ext.getCmp("languageFieldCombo").setValue(languageFieldStore.getAt(a).get("value"));break}a++}}setRoleOptions()}function setRoleOptions(){roleFieldStore.removeAll();Ext.getCmp("roleFieldCombo").store.loadData(roleData);if(rolevalue!=""){var a=0;while(roleFieldStore.data.length>a){if(roleFieldStore.getAt(a).get("key")==rolevalue){Ext.getCmp("roleFieldCombo").setValue(roleFieldStore.getAt(a).get("value"));break}else{Ext.getCmp("roleFieldCombo").setValue(roleFieldStore.getAt(0).get("value"))}a++}}else{Ext.getCmp("roleFieldCombo").setValue(roleFieldStore.getAt(0).get("value"))}Ext.getCmp("roleFieldCombo").setDisabled(disableRole);if(isStaffManager||(!isStaffManager&&(!isStaffUser&&!isSysAdmin))){Ext.getCmp("btnSave").setDisabled(false)}if(!isEditable){Ext.getCmp("btnSave").setDisabled(true)}setAccountRoleAsMandatory();var b=document.getElementById(ClientPageComp.ComponentVars.account_id_name);if(disableRole&&b.value!=null&&b.value!=""){showWarningMsgForFirstClient()}}function saveUserAccountLink(){var a=document.getElementById(ClientPageComp.ComponentVars.account_id);if(!isPortalUser&&clientId!=null&&clientId!=""&&a!=null&&a!=""){saveUserAccount()}}function setAccountRoleAsMandatory(){role_astric=document.getElementById(ClientPageComp.ComponentVars.role_label_astric);account_astric=document.getElementById(ClientPageComp.ComponentVars.account_label_astric);if(role_astric!=null){if(isPortalUser){role_astric.style.display="inline";account_astric.style.display="inline"}else{role_astric.style.display="none";account_astric.style.display="none"}}}function getModuleName(){return"Clients"};