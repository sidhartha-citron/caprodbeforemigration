var lookupFieldStore,selectFieldStore,FilerListViewStore,filterId,CriteriaViewStore,criteriaGrid,comparisonOperator,pickListArray=[],pickListComboStore,pickListComboBx,booleanComboStore,booleanComboBx,booleanArray=[{id:"True",val:LookupFilter.Labels.labelTrue},{id:"False",val:LookupFilter.Labels.labelFalse}],popUpString="",onCompleteFunction,popUpWindow,lookupFieldCombo,selectFieldCombo,fieldValueStore,selectedTextAreaLength,apiName,label,type,isNew,isDeleted,picklistStr,OfferingClause,tempArray=[];Ext.onReady(function(){isNew=true;createConsoleFilterGrid();createCriteriaGrid();buildCriteriaCondtions();if(isFromCMDB){if(isCIManagementEnabled&&isAssetManagementEnabled){createClassTypeComboBox()}createClassNameComboBox();createFieldStore()}else{createConsolePicklist();createConsoleLookupFieldPicklist()}createFilterTypeComboBox();getWaitbox()});function createConsoleFilterGrid(){if(isFromCMDB){Ext.define("FilterModel",{extend:"Ext.data.Model",fields:[{name:"Id",type:"string"},{name:"ClassType",type:"string"},{name:"ClassName",type:"string"},{name:"filterFor",type:"string"},{name:"filterType",type:"string"},{name:"inactive",type:"string"}]})}else{Ext.define("FilterModel",{extend:"Ext.data.Model",fields:[{name:"Id",type:"string"},{name:"Console",type:"string"},{name:"filterFor",type:"string"},{name:"filterType",type:"string"},{name:"inactive",type:"string"}]})}FilerListViewStore=Ext.create("Ext.data.Store",{model:"FilterModel",data:FilterGridData,proxy:{type:"memory",reader:{idProperty:"Id",type:"json",root:"attributes"}}});var a=[];if(isFromCMDB){a=[{id:"Id",width:1,text:"Id",hidden:true,menuDisabled:true,dataIndex:"Id"},{id:"classtype",flex:0.3,text:cmdbClassType,menuDisabled:true,dataIndex:"ClassType"},{id:"classname",flex:0.3,text:cmdbClassName,menuDisabled:true,dataIndex:"ClassName"},{id:"filterfor",flex:0.3,text:LookupFilter.Labels.FilterFor,menuDisabled:true,dataIndex:"filterFor"},{id:"filtertype",flex:0.3,text:LookupFilter.Labels.FilterType,menuDisabled:true,dataIndex:"filterType"},{id:"inactive",flex:0.1,text:LookupFilter.Labels.Inactive,menuDisabled:true,renderer:renderInactiveChk,dataIndex:"inactive"}]}else{a=[{id:"Id",width:1,text:"Id",hidden:true,menuDisabled:true,dataIndex:"Id"},{id:"console",flex:0.3,text:LookupFilter.Labels.Console,menuDisabled:true,dataIndex:"Console"},{id:"filterfor",flex:0.3,text:LookupFilter.Labels.FilterFor,menuDisabled:true,dataIndex:"filterFor"},{id:"filtertype",flex:0.3,text:LookupFilter.Labels.FilterType,menuDisabled:true,dataIndex:"filterType"},{id:"inactive",flex:0.1,text:LookupFilter.Labels.Inactive,menuDisabled:true,renderer:renderInactiveChk,dataIndex:"inactive"}]}var b=Ext.create("Ext.grid.Panel",{id:"filterGrid",renderTo:"filterGrid",stripeRows:true,border:false,forceFit:true,store:FilerListViewStore,height:250,autoScroll:true,columns:a,listeners:{select:function(e,d,f,h,g){isNew=false;if(!fireChangeEvent){return}fireChangeEvent=false;var c=document.getElementById("del-filter-btn");c.removeAttribute("disabled");filterId=d.get("Id");showWaitbox();changeEditSecTitle(d);clearCriteriaFields();if(isFromCMDB){loadLookupFilterRecCMDB(filterId)}else{loadLookupFilterRec(filterId)}}}})}function createCriteriaGrid(){Ext.define("CriteriaModel",{extend:"Ext.data.Model",fields:[{name:"Id",type:"string"},{name:"Criterion",type:"string"},{name:"fieldName",type:"string"},{name:"fieldAPIName",type:"string"},{name:"Operator",type:"string"},{name:"FieldValue",type:"string"},{name:"value",type:"string"},{name:"valueAPI",type:"string"},{name:"valueDataType",type:"string"},{name:"RefValueDataType",type:"string"}]});CriteriaViewStore=Ext.create("Ext.data.Store",{model:"CriteriaModel",data:CriteriaGridData,proxy:{type:"memory",reader:{idProperty:"Id",type:"json",root:"attributes"}}});criteriaGrid=Ext.create("Ext.grid.Panel",{id:"criteriaGrid",renderTo:"criteriaGrid",height:125,forceFit:true,border:false,store:CriteriaViewStore,columns:[{id:"1",width:1,text:"Id",hidden:true,menuDisabled:true,dataIndex:"Id",sortable:false},{id:"criterionId",flex:0.1,text:LookupFilter.Labels.Criterion,menuDisabled:true,dataIndex:"Criterion",sortable:false,renderer:"htmlEncode"},{id:"fieldnameId",flex:0.3,text:LookupFilter.Labels.FieldName,menuDisabled:true,dataIndex:"fieldName",sortable:false,renderer:"htmlEncode"},{id:"fieldAPINameId",flex:0.3,text:LookupFilter.Labels.FieldName,menuDisabled:true,dataIndex:"fieldAPIName",hidden:true,sortable:false,renderer:"htmlEncode"},{id:"operatorId",flex:0.125,text:LookupFilter.Labels.Operator,menuDisabled:true,dataIndex:"Operator",sortable:false,renderer:"htmlEncode"},{id:"fieldValueId",flex:0.125,text:LookupFilter.Labels.Operator,menuDisabled:true,dataIndex:"FieldValue",hidden:true,sortable:false,renderer:"htmlEncode"},{id:"opvalueId",flex:0.3,text:LookupFilter.Labels.operandValue,menuDisabled:true,dataIndex:"value",sortable:false,renderer:"htmlEncode"},{id:"opvalueAPIId",flex:0.3,text:LookupFilter.Labels.operandValue,menuDisabled:true,dataIndex:"valueAPI",hidden:true,sortable:false,renderer:"htmlEncode"},{id:"opvalueDataTypeId",flex:0.3,text:LookupFilter.Labels.operandValue,menuDisabled:true,dataIndex:"valueDataType",hidden:true,sortable:false,renderer:"htmlEncode"}],listeners:{itemclick:function(b,a,c,f,e){lookupFieldCombo.reset();if(lookupFieldStore.find("label",a.get("fieldName").trim())<=-1){Ext.getCmp("compareOpCombo").reset();selectFieldCombo.reset();openCriteriaDeleteMessage();setAddUpdateOnClick(false)}else{var d=document.getElementById("DelCriteriaBtnId");d.removeAttribute("disabled");populateCriteriaFields(a);setAddUpdateOnClick(true)}}}})}function addUpdateCriteriaGrid(b){var j=CriteriaViewStore.data.length;var c=lookupFieldCombo.getValue();var m=lookupFieldCombo.getRawValue();var f=fieldValueOperator.getValue();var k,q;if(c==null||c==""||typeof(c)=="undefined"){showExtMsg(LookupFilter.Labels.SelectFieldErrMsg);return false}var r=comparisonOperator.getValue();if(r==null||r==""||typeof(r)=="undefined"){showExtMsg(LookupFilter.Labels.SelectCompOpMessage);return false}var l=selectFieldCombo.getValue();var o,d,e,a;if(f=="Field"){if(l==null||l==""||typeof(l)=="undefined"){showExtMsg(LookupFilter.Labels.EnterValMsg);return false}o=selectFieldCombo.getRawValue();d=selectFieldCombo.findRecordByValue(l);e=d.get("type");if(e.indexOf(":")>0){e=e.split(":")[0]}else{if(e.indexOf(EF)>0){e=e.split(EF)[0]}}k=lookupFieldCombo.findRecordByValue(c);q=k.get("type");if(q.indexOf(":")>0){q=q.split(":")[0]}else{if(q.indexOf(EF)>0){q=q.split(EF)[0]}}if(e!=q){if(q=="text"||(e=="text"&&q=="textarea")||(e=="textarea"&&q=="text")){}else{if((e=="datetime"&&q=="date")||(e=="date"&&q=="datetime")){if(e=="datetime"&&q=="date"){e=q}}else{if((e.indexOf("reference")!=-1)&&q.indexOf("reference")==-1){e=e.substring(0,9)}else{if((q.indexOf("reference")!=-1)&&e.indexOf("reference")==-1){q=q.substring(0,9)}}var n=LookupFilter.Labels.CompatibleErrorMsg;var h=e.substr(0,1).toUpperCase()+e.substr(1);n=n.replace("{0}",h);n=n.replace("{1}",q);showExtMsg(n);return false}}}}else{if(f=="Value"){d=lookupFieldCombo.findRecordByValue(c);e=d.get("type");if(e.indexOf(":")>0){e=e.split(":")[0]}else{if(e.indexOf(EF)>0){a=e;e=e.split(EF)[0]}}if(e=="text"||e=="phone"||e=="currency"||e=="email"||e=="percent"||e=="number"||e=="reference"){var g=getInputTxtEle();if(g!=null&&g!="undefined"){l=o=g.value}if(e=="reference"){var p=document.getElementById("referenceID");if(p!=null&&p!="undefined"){refId=p.value;if(refId!=null&&refId!=""){l=refId}else{if(b!=null&&b!=""&&b!="undefined"){l=b.get("valueAPI")}}}}}else{if(e=="reference"){o=booleanComboBx.getValue();l=booleanComboBx.getRawValue()}else{if(e=="boolean"){o=booleanComboBx.getRawValue();l=booleanComboBx.getValue()}else{if(e.indexOf("textarea")!=-1){var s=getInputTextAreaEle();if(s!=null&&s!="undefined"){l=o=s.value}}else{if(e=="picklist"){o=pickListComboBx.getRawValue();l=pickListComboBx.getValue()}else{if(e=="datetime"){l=o=getDateTimeInputEle().value}else{if(e=="date"){l=o=getDateInputEle().value}}}}}}}}}if(e.indexOf("reference")!=-1&&q=="text"){dataType=q}else{dataType=e}if(b==null||b=="undefined"||typeof(b)=="undefined"){CriteriaViewStore.add(new CriteriaModel({Id:"newId",Criterion:j+1,fieldName:m,fieldAPIName:c,Operator:r,FieldValue:f,value:o,valueAPI:l,valueDataType:dataType,RefValueDataType:a}));clearCriteriaFields();if(isNew){setLogicalStatement()}else{if(j<2){setLogicalStatement()}}}else{b.set("fieldName",m);b.set("fieldAPIName",c);b.set("Operator",r);b.set("FieldValue",f);b.set("value",o);b.set("valueAPI",l);b.set("valueDataType",dataType);b.set("RefValueDataType",a);b.commit();setAddUpdateOnClick(false);clearCriteriaFields()}document.getElementById("AddBtnId").disabled=true}function deleteFromCriteriaGrid(){var a=LookupFilter.Labels.DeleteConfirmMessage;Ext.Msg.confirm(LookupFilter.Labels.Delete,a,function(b){if(b==="yes"){deleteCriteria()}})}function deleteCriteria(){var c=criteriaGrid.getView().getSelectionModel().getSelection()[0];if(c){CriteriaViewStore.remove(c)}var a=CriteriaViewStore.data.length;for(var b=0;b<a;b++){var e=CriteriaViewStore.getAt(b);e.set("Criterion",b+1);e.commit()}var d=document.getElementById("DelCriteriaBtnId");d.setAttribute("disabled","disabled");setAddUpdateOnClick(false);clearCriteriaFields();isDeleted=true;setLogicalStatement()}function addToCriteriaGrid(){addUpdateCriteriaGrid()}function openCriteriaDeleteMessage(){Ext.Msg.show({title:LookupFilter.Labels.lblInvalidCondition,msg:LookupFilter.Labels.lblErrorMsgEncryptedFldInCondition,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR,fn:function(a){if(a=="ok"){deleteCriteria()}}})}function populateCriteriaFields(a){lookupFieldCombo.reset();lookupFieldCombo.setValue(a.get("fieldAPIName"));fieldValueOperator.setValue(a.get("FieldValue"));type=a.get("valueDataType");refType=a.get("RefValueDataType");if(type.indexOf(":")>0){selectedTextAreaLength=type.split(":")[1];type=type.split(":")[0]}else{if(type.indexOf(EF)>0){popUpString=type.split(EF)[1];type=type.split(EF)[0]}else{if(refType.indexOf(EF)!=-1){popUpString=refType.split(EF)[1];type=refType.split(EF)[0]}}}setComparisonOperatorStore(type);comparisonOperator.setValue(a.get("Operator"));if(a.get("FieldValue")=="Field"){Ext.getCmp("selectFieldCombo").show();selectFieldCombo.setValue(a.get("valueAPI"));setVisibilityData("none","none","none")}else{if(a.get("FieldValue")=="Value"){Ext.getCmp("selectFieldCombo").hide();apiName=a.get("fieldAPIName");label=a.get("fieldName");elementVal=a.get("value");opVal=a.get("Operator");if(type=="picklist"){showWaitbox();elementVal=a.get("valueAPI");tempArray=[apiName,label,type,elementVal,opVal];getPicklistValues(apiName)}else{setVisibilityData(apiName,label,type,elementVal,opVal)}}}}function upadateCriteriaGrid(){var b=criteriaGrid.getView().getSelectionModel().getSelection()[0];var a=addUpdateCriteriaGrid(b);if(a!=false){setAddUpdateOnClick(false);criteriaGrid.getSelectionModel().clearSelections()}}function clearCriteriaFields(){lookupFieldCombo.setValue("");comparisonOperator.setValue("");fieldValueOperator.setValue(fieldValueOperator.store.getAt(0).get("fieldName"));selectFieldCombo.setValue("");Ext.getCmp("selectFieldCombo").show();Ext.getCmp("criteriaGrid").getSelectionModel().deselectAll();var a=document.getElementById("referenceID");if(a!=null&&a!="undefined"){a.value=null}setVisibilityData("none","none","none")}function buildCriteriaCondtions(){lookupFieldStore=Ext.create("Ext.data.Store",{id:"lookupFieldStore",data:fieldStr,fields:["id","type","label","e"],sorters:[{property:"label",direction:"ASC"}]});lookupFieldCombo=Ext.create("Ext.form.field.ComboBox",{id:"lookupFieldCombo",store:lookupFieldStore,queryMode:"local",valueField:"id",displayField:"label",renderTo:"lookupFieldCombo",typeAhead:true,width:215,tpl:'<tpl for="."><li class="x-boundlist-item classLabelWrap" title="{label:htmlEncode}">{label:htmlEncode}</li></tpl>',matchFieldWidth:false,listConfig:{width:215},listeners:{select:function(e,c,b){comparisonOperator.store.removeAll();var a=c[0].get("type");if(a.indexOf(":")>0){a=a.split(":")[0]}else{if(a.indexOf(EF)>0){a=a.split(EF)[0]}}apiName=c[0].get("id");label=c[0].get("label");type=c[0].get("type");setAddBtnStatus();setComparisonOperatorStore(a);var d=fieldValueOperator.getValue();if(d=="Value"){setVisibilityData(apiName,label,type)}if(type=="picklist"){showWaitbox();getPicklistValues(apiName)}}}});selectFieldStore=Ext.create("Ext.data.Store",{id:"selectFieldStore",data:ConsolefieldStr,fields:["id","type","label","e"],sorters:{property:"label",direction:"ASC"}});selectFieldCombo=Ext.create("Ext.form.field.ComboBox",{id:"selectFieldCombo",store:selectFieldStore,queryMode:"local",triggerAction:"all",valueField:"id",displayField:"label",selectOnFocus:true,renderTo:"selectFieldCombo",editable:true,width:215,listWidth:200,height:22,matchFieldWidth:false,listConfig:{width:215},tpl:'<tpl for="."><div title="{label:htmlEncode}" class="x-boundlist-item classLabelWrap">{label:htmlEncode}</div></tpl>',listeners:{select:function(c,b,a){setAddBtnStatus()}}});fieldValueStore=Ext.create("Ext.data.Store",{id:"fieldValueStore",data:[{fieldValue:"Field",fieldName:LookupFilter.Labels.labelField},{fieldValue:"Value",fieldName:LookupFilter.Labels.labelValue}],fields:["fieldValue","fieldName"]});fieldValueOperator=Ext.create("Ext.form.field.ComboBox",{id:"fieldValueCombo",store:fieldValueStore,queryMode:"local",triggerAction:"all",valueField:"fieldValue",displayField:"fieldName",selectOnFocus:true,renderTo:"fieldValueCombo",typeAhead:true,typeAheadDelay:5,editable:true,width:65,listWidth:120,height:13,listConfig:{minWidth:65},listeners:{select:function(d,c,b){var a=d.getValue();if(a=="Field"){Ext.getCmp("selectFieldCombo").show();pickListComboBx.setVisible(false);setVisibilityData("none","none","none")}else{if(apiName!=null&&typeof(apiName)!="undefined"&&label!=null&&typeof(label)!="undefined"&&type!=null&&typeof(type)!="undefined"){Ext.getCmp("selectFieldCombo").hide();setVisibilityData(apiName,label,type);if(type=="picklist"){pickListComboBx.setVisible(true)}}document.getElementById("AddBtnId").disabled=false}}}});fieldValueOperator.setValue(fieldValueOperator.store.getAt(0).get("fieldName"));if(fieldValueOperator.store.getAt(0).get("fieldValue")=="Field"){Ext.getCmp("selectFieldCombo").show()}else{Ext.getCmp("selectFieldCombo").hide()}compStore.text=[["=","="],["!=","!="],["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];compStore.phone=[["=","="],["!=","!="]];compStore.currency=[["=","="],["!=","!="],[">",">"],[">=",">="],["<","<"],["<=","<="]];compStore.percent=[[">",">"],[">=",">="],["=","="],["!=","!="],["<","<"],["<=","<="]];compStore.number=[[">",">"],[">=",">="],["=","="],["!=","!="],["<","<"],["<=","<="]];compStore.booleanVar=[["=","="],["!=","!="]];compStore.email=[["=","="],["!=","!="],["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];compStore.reference=[["=","="],["!=","!="]];compStore.dateTime=[[">",">"],[">=",">="],["=","="],["!=","!="],["<","<"],["<=","<="]];compStore.textArea=[["LIKE","LIKE"],["NOT LIKE","NOT LIKE"]];compStore.picklist=[["=","="],["!=","!="]];comparisonOperator=Ext.create("Ext.form.field.ComboBox",{id:"compareOpCombo",store:compStore.text,queryMode:"local",renderTo:"compareOpDiv",valueField:"comOpeValue",displayField:"comOpeName",editable:false,width:105,listWidth:85,height:13,emptyText:labelOperator,listeners:{select:function(c,b,a){setAddBtnStatus()}}});pickListComboStore=Ext.create("Ext.data.Store",{id:"pickListFieldStore",data:pickListArray,fields:["id","val"],sorters:{property:"val",direction:"ASC"}});pickListComboBx=Ext.create("Ext.form.field.ComboBox",{id:"pickListFieldCombo",store:pickListComboStore,queryMode:"local",valueField:"id",displayField:"val",editable:false,renderTo:"picklistCombo",hidden:true,width:215,listWidth:165});booleanComboStore=Ext.create("Ext.data.Store",{id:"booleanFieldStore",data:booleanArray,fields:["id","val"]});booleanComboBx=Ext.create("Ext.form.field.ComboBox",{id:"booleanFieldCombo",store:booleanComboStore,queryMode:"local",triggerAction:"all",valueField:"id",displayField:"val",value:"True",selectOnFocus:true,editable:false,renderTo:"booleanCombo",hidden:true,width:215,listWidth:165})}if(typeof(SDEDateFormat)=="undefined"||SDEDateFormat==null||SDEDateFormat==""){this.SDEDateFormat="m/d/Y h:i A"}FilterDatePickerPopup=function(){};FilterDatePickerPopup.prototype={dateFormat:SDEDateFormat,Show:function(c){var a=Ext.get(c);var b=a.getRegion();var d=Ext.create("Ext.window.Window",{height:230,width:280,x:b.right-255,y:b.top-235,layout:"fit",items:{xtype:"datepicker",handler:function(j,h){a.dom.value=Ext.Date.format(h,SDEDateFormat);var e=a.dom.id;if(e.indexOf("inputDate")>0){var f=document.getElementById(e).value;var g=f.split(" ");a.dom.value=g[0].replace(",","")}dataModifiedFlag=1;a=null;d.close()}}}).show()}};var _datePicker=new FilterDatePickerPopup();function setComparisonOperatorStore(a){if(a.indexOf(":")>0){a=a.split(":")[0]}else{if(a.indexOf(EF)>0){a=a.split(EF)[0]}}if(a=="reference"){comparisonOperator.store.loadData(compStore.reference)}else{if(a=="datetime"){comparisonOperator.store.loadData(compStore.dateTime)}else{if(a=="date"){comparisonOperator.store.loadData(compStore.dateTime)}else{if(a=="textarea"){comparisonOperator.store.loadData(compStore.textArea)}else{if(a=="text"){comparisonOperator.store.loadData(compStore.text)}else{if(a=="phone"){comparisonOperator.store.loadData(compStore.phone)}else{if(a=="currency"){comparisonOperator.store.loadData(compStore.currency)}else{if(a=="percent"){comparisonOperator.store.loadData(compStore.percent)}else{if(a=="number"){comparisonOperator.store.loadData(compStore.number)}else{if(a=="boolean"){comparisonOperator.store.loadData(compStore.booleanVar)}else{if(a=="email"){comparisonOperator.store.loadData(compStore.email)}else{if(a=="picklist"){comparisonOperator.store.loadData(compStore.picklist)}}}}}}}}}}}}comparisonOperator.reset()}function getPickListOptions(a){var b=picklistStr.split(DZHE);return b}function setPickListOptions(c){var d=Ext.getCmp("pickListFieldCombo");if(d!=null){var e=getPickListOptions(c);pickListArray=[];for(var b=0;b<e.length;b++){if(e[b]!=""){var a=e[b].split(EF);pickListArray.push({id:a[1],val:a[0]})}}pickListComboStore.loadData(pickListArray);pickListComboBx.setValue(pickListComboStore.first().get("id"));if(tempArray!=null&&tempArray.length>0){setVisibilityData(tempArray[0],tempArray[1],tempArray[2],tempArray[3],tempArray[4]);tempArray=[]}}hideWaitbox()}function setVisibilityData(b,c,e,a,d){isInList=false;var f=fieldStr.length;selectedApiName=b;selectedLabel=c;if(isInList==false){if(e.indexOf(":")>0){selectedTextAreaLength=e.split(":")[1];e=e.split(":")[0]}else{if(e.indexOf(EF)>0){popUpString=e.split(EF)[1];if(b=="FKBusinessService__c"){popUpString="BMC_BusinessService__c"}else{if(b=="FKServiceOffering__c"){popUpString="BMC_ServiceOffering__c"}}e=e.split(EF)[0]}}if(e=="text"){assignVisibility("inline","none","none","none","none","none","none",null,1,a)}else{if(e=="phone"){assignVisibility("inline","none","none","none","none","none","none",null,10,a)}else{if(e=="currency"){assignVisibility("inline","none","none","none","none","none","none",null,11,a)}else{if(e=="percent"){assignVisibility("inline","none","none","none","none","none","none",null,9,a)}else{if(e=="email"){assignVisibility("inline","none","none","none","none","none","none",null,8,a)}else{if(e=="number"){assignVisibility("inline","none","none","none","none","none","none",null,7,a)}else{if(e=="boolean"){assignVisibility("none","none","none","inline","none","none","none",null,2,a)}else{if(e=="textarea"){assignVisibility("none","inline","none","none","none","none","none",null,3,a)}else{if(e=="picklist"){assignVisibility("none","none","none","none","inline","none","none",null,4,a)}else{if(e=="reference"){assignVisibility("inline","none","inline","none","none","none","none",b,5,a)}else{if(e=="reference1"){assignVisibility("inline","none","inline1","none","none","none","none",b,6,a)}else{if(e=="datetime"){assignVisibility("none","none","none","none","none","inline","none",null,12,a)}else{if(e=="date"){assignVisibility("none","none","none","none","none","none","inline",null,13,a)}else{if(e=="none"){assignVisibility("none","none","none","none","none","none","none",null,13,a)}}}}}}}}}}}}}}}if(d!=null&&d!="undefined"){comparisonOperator.setValue(d)}}function assignVisibility(h,q,n,l,d,b,r,c,m,g){var e=getInputTxtEle();var s=getInputTextAreaEle();var f=getDateTimeInputEle();var k=getDateTimePickerImg();var o=getDateInputEle();var p=getDatePickerImg();var t=getLookupEle();var a=Ext.getCmp("booleanFieldCombo");var j=document.getElementById("inputTxtAreaButtonEle");var u=Ext.getCmp("pickListFieldCombo");if(e!=null&&typeof(e)!="undefined"){e.style.display=h;if(h=="inline"&&g!=null&&g!="undefined"){e.value=g}else{e.value=""}e.disabled=false}if(s!=null&&typeof(s)!="undefined"){s.style.display=q;if(j!=null&&typeof(j)!="undefined"){if(q=="inline"){j.style.display=""}else{j.style.display="none"}if(q=="inline"&&g!=null&&g!="undefined"){s.value=g}else{s.value=""}}}if(f!=null&&typeof(f)!="undefined"){f.style.display=b;if(k!=null&&typeof(k)!="undefined"){k.style.display=b}if(b=="inline"&&g!=null&&g!="undefined"){f.value=g}else{f.value=""}}if(o!=null&&typeof(o)!="undefined"){o.style.display=r;if(p!=null&&typeof(p)!="undefined"){p.style.display=r}if(r=="inline"&&g!=null&&g!="undefined"){o.value=g}else{o.value=""}}if(a!=null&&typeof(a)!="undefined"){if(l=="inline"){a.setVisible(true)}else{a.hide()}if(l=="inline"&&g!=null&&g!=""&&g!="undefined"){a.setValue(g)}}if(u!=null&&typeof(u)!="undefined"){if(d=="inline"){u.setVisible(true)}else{u.hide();u.reset()}if(d=="inline"&&g!=null&&g!=""&&g!="undefined"){u.setValue(g)}}if(n=="inline"){if(t!=null&&typeof(t)!="undefined"){t.disabled=false;t.style.visibility="visible";t.style.display="inline"}if(g!=null&&g!="undefined"){e.disabled=g}e.disabled=true;popUpEnable=true}else{if(t!=null&&typeof(t)!="undefined"){t.style.visibility="hidden";t.style.display="none";t.disabled=true}}if(n=="inline1"){t.style.display="none";e.disabled=true;e.value="";popUpEnable=true}compTypeNo=m}function getWaitbox(){var a=new Ext.LoadMask(Ext.getBody(),{msg:LookupFilter.Labels.PleaseWait,id:"waitMsggId"})}function showWaitbox(){if(Ext.getCmp("waitMsggId")!=null){Ext.getCmp("waitMsggId").show()}}function hideWaitbox(){if(Ext.getCmp("waitMsggId")!=null){Ext.getCmp("waitMsggId").hide()}}function isDuplicateFilter(){if(isFilterExists){showExtMsg(LookupFilter.Labels.FilterExists);lookupFieldStore.removeAll();var a=Ext.getCmp("lookupFieldCombo");if(a){a.inputEl.dom.placeholder="";a.setValue("")}return false}}function populateLookupFieldsData(){if(fieldStr!=null&&fieldStr!=""){lookupFieldStore.removeAll();lookupFieldStore.loadData(fieldStr)}if(ConsolefieldStr!=null&&ConsolefieldStr!=""){selectFieldStore.removeAll();selectFieldStore.loadData(ConsolefieldStr)}}function getValue(b){var a=ConsolePicklistDOM.value;getFieldValues(a)}function checkForEncryptedOrDeletedField(){var a=CriteriaViewStore.data.length;for(var b=0;b<a;b++){var c=CriteriaViewStore.getAt(b);if(lookupFieldStore.getById(c.get("fieldAPIName").trim())<=-1){hideWaitbox();Ext.MessageBox.alert(LookupFilter.Labels.lblInvalidCondition,LookupFilter.Labels.lblQVEncryptionError);return false}}return true}function callSave(){if(!checkForEncryptedOrDeletedField()){return}setCriteriaGridData();var c=getFilterLogicObj();var b=isValidLogicalStatement(c.value);if(b){var a=checkValidLogic();if(a){hideWaitbox();Ext.MessageBox.show({msg:LookupFilter.Labels.FilterLogicAddCriteriaValidation,width:310,buttons:Ext.Msg.YESNO,fn:function(d){if(d=="yes"){showWaitbox();save()}},icon:Ext.MessageBox.WARNING})}else{if(isDeleted&&(temporaryArray.length==CriteriaViewStore.data.length)){hideWaitbox();Ext.MessageBox.show({msg:LookupFilter.Labels.FilterLogicModifyCriteriaValidation,width:310,buttons:Ext.Msg.YESNO,fn:function(d){if(d=="yes"){showWaitbox();save()}else{isDeleted=false}},icon:Ext.MessageBox.WARNING})}else{save()}}}}function afterSave(){isNew=false;isDeleted=false;fireChangeEvent=false;filterId=consoleFilterId}function setCriteriaGridData(){var a="";var c=0;while(CriteriaViewStore.data.length>c){a=a+CriteriaViewStore.getAt(c).get("Criterion")+nonPrint+CriteriaViewStore.getAt(c).get("fieldAPIName")+nonPrint+CriteriaViewStore.getAt(c).get("Operator")+nonPrint+CriteriaViewStore.getAt(c).get("FieldValue")+nonPrint+CriteriaViewStore.getAt(c).get("value")+nonPrint+CriteriaViewStore.getAt(c).get("valueAPI")+nonPrint+CriteriaViewStore.getAt(c).get("valueDataType")+nonPrint+CriteriaViewStore.getAt(c).get("Id")+PE;c++}var b=getCriteriaGridStrEle();b.value=a}function getfieldsOfLookupFor(){var a=picklistDOM.value;getFilterForFields(a)}function reloadConsoleFilterGrid(){var b=document.getElementById("del-filter-btn");b.setAttribute("disabled","disabled");setAddUpdateOnClick(false);FilerListViewStore.removeAll();FilerListViewStore.loadData(FilterGridData);var c=FilerListViewStore.find("Id",consoleFilterId);if(c!=-1){Ext.getCmp("filterGrid").getSelectionModel().select(c);var b=document.getElementById("del-filter-btn");b.removeAttribute("disabled");var a=FilerListViewStore.getAt(c);changeEditSecTitle(a)}}function changeEditSecTitle(a){var d=getEditFilterObj();var b="";var c="";RemedyForceHTMLProcessor.clearHTML(d);if(a!=null&&a!=undefined){if(isFromCMDB){b=a.get("ClassName");c=cmdbClassName}else{b=a.get("Console");c=LookupFilter.Labels.Console}d.appendChild(document.createTextNode(LookupFilter.Labels.EditFilter+" - "+c+": "));var f=document.createElement("span");f.setAttribute("style","font-weight:normal;");f.appendChild(document.createTextNode(" "+b+",  "));d.appendChild(f);d.appendChild(document.createTextNode(" "+LookupFilter.Labels.FilterFor+": "));var e=document.createElement("span");e.setAttribute("style","font-weight:normal;");e.appendChild(document.createTextNode(" "+a.get("filterFor")));d.appendChild(e)}else{d.appendChild(document.createTextNode(LookupFilter.Labels.NewFilter))}}function reloadCriteriaGrid(){var b=document.getElementById("DelCriteriaBtnId");b.setAttribute("disabled","disabled");setAddUpdateOnClick(false);clearCriteriaFields();CriteriaViewStore.loadData(CriteriaGridData);if(consoleFilterId!=null&&consoleFilterId!=""){if(!isFromCMDB){Ext.getCmp("ConsolePicklistCombo").setDisabled(true);Ext.getCmp("ConsoleLookupFieldsPicklistCombo").setDisabled(true)}else{var a=Ext.getCmp("classType");if(a){a.setDisabled(true)}Ext.getCmp("className").setDisabled(true);Ext.getCmp("filterForCMDB").setDisabled(true)}}else{Ext.getCmp("filterGrid").getSelectionModel().deselectAll()}Ext.getCmp("filterType").setValue(cmdbFilterType)}function clearCriteriaGrid(){CriteriaViewStore.removeAll();getFilterLogicObj().value=""}var RemoveAttachment=function(){Ext.MessageBox.show({title:LookupFilter.Labels.Delete,msg:LookupFilter.Labels.DeleteConfirmMessage,width:310,buttons:Ext.Msg.OKCANCEL,fn:deleteFilterHandler,icon:Ext.MessageBox.WARNING,closable:true,draggable:false,shadow:false,bodyBorder:false});return false};var deleteFilterHandler=function(a,b){if(a==="ok"){showWaitbox();deleteConsoleFilter(filterId);document.getElementById("del-filter-btn").setAttribute("disabled","disabled");changeEditSecTitle(null)}else{return}};function clearLookupAndSelectFieldCombo(){var d=Ext.getCmp("lookupFieldCombo");var b=Ext.getCmp("selectFieldCombo");var c=Ext.getCmp("fieldValueCombo");lookupFieldStore.removeAll();selectFieldStore.removeAll();Ext.getCmp("compareOpCombo").setValue("");c.select("Field");var a=c.getStore().findRecord("fieldValue","Field");c.fireEvent("select",c,[a]);if(d){d.inputEl.dom.placeholder="";d.setValue("")}if(b){b.inputEl.dom.placeholder="";b.setValue("")}}function renderInactiveChk(b,c,a){var b=b.trim();if(b=="true"){return'<input type="checkbox" disabled="true" checked="true"/>'}else{return'<input type="checkbox" disabled="true" />'}}function showExtMsg(a){Ext.MessageBox.show({msg:a,buttons:Ext.MessageBox.OK,cls:"rf-msg-cls"})}function setAddUpdateOnClick(a){var d=document.getElementById("AddBtnId");var c=document.getElementById("UpdateBtnId");var b=document.getElementById("DelCriteriaBtnId");if(a){c.style.display="inline";c.style.visibility="visible";d.style.display="none";d.style.visibility="hidden";b.removeAttribute("disabled")}else{c.style.display="none";c.style.visibility="hidden";d.style.display="inline";d.style.visibility="visible";b.setAttribute("disabled","disabled")}}function openQualLookup(){if(popUpString=="BMC BaseElement"){popUpString="BMC_BaseElement"}else{if(popUpString=="User"||popUpString=="Group"){openPopup("SearchPage?popupId=Client&isQueurorUser=true&isLookup=true&idNameForPopUp=true&isFromSLT=true",setReferenceToVal,450,600,true)}else{if(popUpString=="SYSTemplate__c"){var b=ConsolePicklistDOM;if(b!=null&&typeof(b)!="undefined"){var a=b.value;if(a=="Incident__c"){openPopup("SearchPage?popupId=SYSTemplate__c&isLookup=true&idNameForPopUp=true&referenceObjectName=SYSTemplate__c&filterClause="+escape("templateFor__c='Incident'"),setReferenceToVal,450,600,true)}else{if(a=="Change_Request__c"){openPopup("SearchPage?popupId=SYSTemplate__c&isLookup=true&idNameForPopUp=true&referenceObjectName=SYSTemplate__c&filterClause="+escape("templateFor__c='Change Request'"),setReferenceToVal,450,600,true)}}}}else{if(popUpString=="BMC_BaseElement__c"){var d=lookupFieldCombo.getValue();if(d=="FKLocation__c"){openPopup("SearchPage?popupId=BMC_BaseElement__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BaseElement__c&filterClause="+escape("ClassName__c='BMC_PhysicalLocation'"),setReferenceToVal,450,600,true)}else{openPopup("SearchPage?popupId=BMC_BaseElement__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BaseElement__c",setReferenceToVal,450,600,true)}}else{if(popUpString=="BMC_BusinessService__c"){openPopup("SearchPage?popupId=BMC_BusinessService__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BusinessService__c",setReferenceToVal,450,600,true)}else{if(popUpString=="BMC_ServiceOffering__c"){OfferingClause=escape("(serviceType__c = 'Offering')");openPopup("SearchPage?popupId=BMC_BusinessService__c&isLookup=true&idNameForPopUp=true&referenceObjectName=BMC_BusinessService__c&filterClause="+OfferingClause,setReferenceToVal,450,600,true)}else{if(popUpString=="CMDB_Class__c"){var d=lookupFieldCombo.getValue();var c="";if(d=="FKAssetRuleClass__c"){c="RBA"}else{if(d=="CMDB_Class__c"){c="NONRBA"}}openPopup("SearchPage?popupId="+popUpString+"&isLookup=true&idNameForPopUp=true&referenceObjectName="+popUpString+"&filterBy="+c,setReferenceToVal,450,1100,true)}else{openPopup("SearchPage?popupId="+popUpString+"&isLookup=true&idNameForPopUp=true&referenceObjectName="+popUpString,setReferenceToVal,450,650,true)}}}}}}}}function setReferenceToVal(b){if(b.indexOf(EF)>0){referenceId=b.split(EF)[0];referenceName=b.split(EF)[1]}referenceName=decodeVal(referenceName);var a=getInputTxtEle();if(a!=null&&typeof(a)!="undefined"){a.value=referenceName;var c=document.getElementById("referenceID");if(c!=null&&typeof(c)!="undefined"){c.value=referenceId}}}function changePopUpTitle(a){if(popUpWindow!=null&&popUpWindow!="undefined"){popUpWindow.setTitle(a)}}function closePopup(){if(popUpWindow!=null&&popUpWindow!=undefined){popUpWindow.close()}}function decodeVal(a){a=a.replace("&gt;",">","g");a=a.replace("&lt;","<","g");a=a.replace("&quot;",'"',"g");a=a.replace("&amp;","&","g");return a}function setPopUpVar(a){if(a!=null&&a!=""&&onCompleteFunction!=null){onCompleteFunction(a)}}function openPopup(c,d,a,b){return openPopupTitle(c,d,a,b,"")}function openPopupTitle(d,e,a,c,b){onCompleteFunction=e;if(a!=null&&c!=null){popUpWindow=Ext.create("Ext.Window",{height:a,width:c,x:10,y:5,modal:true,resizable:false,constrain:true,viewConfig:{forceFit:true},html:'<iframe frameborder="0" src ="/apex/'+d+'" style="width:100%;height:100%;border:none"/>'});popUpWindow.show()}else{popUpWindow=Ext.create("Ext.Window",{height:550,width:670,x:10,y:5,modal:true,resizable:false,constrain:true,viewConfig:{forceFit:true},html:'<iframe frameborder="0" src ="/apex/'+d+'" style="width:100%;height:100%;border:none"/>',tools:[{id:"lookuppm",handler:function(){var f;if(window.frames[0].document.getElementById("lookupdataval").value){f=window.frames[0].document.getElementById("lookupdataval").value}var g=new Ext.QuickTip({target:this,title:"",anchor:"right",width:200,shadow:"sides",bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",dismissDelay:1500000,html:f});g.show()}}]});popUpWindow.show()}}function isValidLogicalStatement(c){temporaryArray=[];temporaryArray=c.match(/(-?\d[\d\.\*]*)/g);if(temporaryArray!=null&&temporaryArray.length>0){for(i=0;i<temporaryArray.length;i++){if(temporaryArray[i]>CriteriaViewStore.data.length||temporaryArray[i]<=0){hideWaitbox();showExtMsg(LookupFilter.Labels.FilterLogicValidation);return false}}}if(c!=null&&c.trim().length==1&&parseInt(c.trim())==1){return true}var a=/\(\s*[+-]?\d+(?:(?:\s+AND\s+[+-]?\d+)+|(?:\s+OR\s+[+-]?\d+)+)\s*\)/ig;var b=/^\s*[+-]?\d+(?:(?:\s+AND\s+[+-]?\d+)+|(?:\s+OR\s+[+-]?\d+)+)\s*$/ig;while(c.search(a)!==-1){c=c.replace(a,"0")}if(c.search(b)===0){return true}else{hideWaitbox();showExtMsg(LookupFilter.Labels.FilterLogicValidation)}return false}function setLogicalStatement(){var b=criteriaGrid.store;var f=b.data.length;var a=" ";for(var d=0;d<f;d++){var e=CriteriaViewStore.getAt(d);var c=e.get("Criterion");if(d!=f-1){a=a+c+" AND "}else{a=a+c}if(a.length>255){CriteriaViewStore.remove(e);showExtMsg(LookupFilter.Labels.FilterLogicLimitExceeded);return}}getFilterLogicObj().value=a}function showTextEditor(g,f,k,j,d,h,b,c){if(h==null||h=="undefined"){h=450}if(b==null||b=="undefined"){b=580}var a=new Ext.form.FormPanel({baseCls:"x-plain",labelWidth:55,layout:{type:"vbox",align:"stretch"},defaults:{xtype:"textfield"},items:[{xtype:"textarea",id:"formTextId",fieldLabel:"Message text",hideLabel:true,border:false,enableKeyEvents:true,name:"msg",flex:1,listeners:{keyup:function(l,m){var n=l.getValue();if(n.length>k){l.setValue(n.substr(0,k))}}}}]});var e=new Ext.Window({title:f,id:"windowId",width:b,height:h,minWidth:300,minHeight:200,layout:"fit",modal:true,plain:true,cls:"TextEditorWindowCls",buttonAlign:"left",items:a,defaultButton:"formTextId",buttons:[{text:j,width:60,cls:"windowBtnCls",handler:function(){if(g!=null&&g!="undefined"){document.getElementById(g).focus();document.getElementById(g).value=Ext.getCmp("formTextId").getValue();if(typeof(c)!="undefined"&&c!=""&&c!=null&&typeof(c)=="function"){c()}}else{if(approvalComments!=null&&approvalComments!="undefined"){var l=Ext.getCmp("formTextId").getValue();approvalComments(l,c)}}e.close()}},{text:d,width:60,cls:"windowBtnCls",handler:function(){e.close()}}]});e.show();if(g!=null&&g!="undefined"){Ext.getCmp("formTextId").focus();Ext.getCmp("formTextId").setValue(document.getElementById(g).value)}}function validateLength(a,b){var c=document.getElementById(a).value;if(c.length>b){document.getElementById(a).value=c.substr(0,b)}}function callCancel(){Ext.MessageBox.show({title:LookupFilter.Labels.Cancel,msg:LookupFilter.Labels.cancelConfirm,width:310,buttons:Ext.Msg.OKCANCEL,fn:cancelHandler,icon:Ext.MessageBox.WARNING,closable:true,draggable:false,shadow:false,bodyBorder:false});return false}var cancelHandler=function(a,b){if(a==="ok"){clearCriteriaFields();reloadCriteriaGrid()}else{return}};function CallNew(){showWaitbox();isNew=true;clearLookupAndSelectFieldCombo();resetComboboxes();changeEditSecTitle(null);clearCriteriaFields();createNewLookup();document.getElementById("AddBtnId").disabled=true}function checkValidLogic(){var b=temporaryArray.toString();for(i=0;i<CriteriaViewStore.data.length;i++){var c=CriteriaViewStore.getAt(i);var a=c.get("Criterion");if(b.indexOf(a)==-1){return true}}return false}function hideShowSScheckbox(a){if(a=="incident__c"&&isSwitchToSSNewUI=="true"){document.getElementById("SelfServicecheckboxid").style.visibility="visible";document.getElementById("SelfServicecheckboxid").style.display=""}else{document.getElementById("SelfServicecheckboxid").style.visibility="hidden";document.getElementById("SelfServicecheckboxid").style.display="none"}}function setAddBtnStatus(){var a=lookupFieldCombo.getValue();var b=comparisonOperator.getValue();var e=fieldValueOperator.getValue();var c=selectFieldCombo.getValue();var d=true;if(e=="Field"){if(a!=""&&a!=null&&b!=""&&b!=null&&c!=""&&c!=null){d=false}}else{if(a!=""&&a!=null&&b!=""&&b!=null){d=false}}document.getElementById("AddBtnId").disabled=d}function toggleCISSFilters(){if(CIAllFilterId.checked){CIClientFilterId.disabled=true;CIAccountFilterId.disabled=true;CIClientFilterId.checked=false;CIAccountFilterId.checked=false}if(!CIAllFilterId.checked&&!CIAccountFilterId.checked&&!CIClientFilterId.checked){CIClientFilterId.checked=true;CIClientFilterId.disabled=false;CIAccountFilterId.disabled=false}}function showCIFilters(){if(lookupFilterConsole=="incident__c"&&SScheckboxId.checked&&showCISettings){document.getElementById("SettingsToShowCIS").style.visibility="visible";document.getElementById("SettingsToShowCIS").style.display=""}else{document.getElementById("SettingsToShowCIS").style.visibility="hidden";document.getElementById("SettingsToShowCIS").style.display="none"}toggleCISSFilters()}function setComboboxValues(){fireChangeEvent=false;if(isFromCMDB){var f=Ext.getCmp("classType");if(f){f.setDisabled(true);f.setValue(CMDBClassTypeCombo)}var e=Ext.getCmp("className");if(e){e.setDisabled(true);e.setValue(CMDBClassNameCombo)}var g=Ext.getCmp("filterForCMDB");if(g){var a=namespacePrefix.toLowerCase();if(g.store.data.items.length==0){g.store.loadData(fieldsStoreData)}g.setDisabled(true);g.setValue(a+filterForField);var d=g.getValue();if(!d){g.setValue(filterForField)}}}else{var h=Ext.getCmp("ConsolePicklistCombo");if(h){h.setDisabled(true);h.setValue(lookupFilterConsole)}var c=Ext.getCmp("ConsoleLookupFieldsPicklistCombo");var a=namespacePrefix.toLowerCase();if(c){c.store.loadData(consoleLookupFieldsStore);c.setDisabled(true);c.setValue(a+lookupFilterConsoleLookupField);if(!c.getValue()){c.setValue(lookupFilterConsoleLookupField)}}}fireChangeEvent=true;var b=Ext.getCmp("filterType");if(b){b.setValue(cmdbFilterType)}hideWaitbox()}function resetComboboxes(){fireChangeEvent=false;if(isFromCMDB){var c=Ext.getCmp("classType");if(c){c.setValue("CI");c.setDisabled(false)}var b=Ext.getCmp("className");if(b){b.setValue("");b.setDisabled(false)}var d=Ext.getCmp("filterForCMDB");if(d){d.store.removeAll();d.setValue("");d.setDisabled(false)}fireChangeEvent=true}else{var e=Ext.getCmp("ConsolePicklistCombo");if(e){e.setValue("");e.setDisabled(false)}var a=Ext.getCmp("ConsoleLookupFieldsPicklistCombo");if(a){a.store.removeAll();a.setValue("");a.setDisabled(false)}fireChangeEvent=true;var d=Ext.getCmp("filterType");if(d){d.setValue(cmdbFilterTypeDefaultValue)}}hideWaitbox()}function createClassNameComboBox(){var a=Ext.create("Ext.data.Store",{fields:["Id",namespacePrefix+"ClassName__c",namespacePrefix+"Activate__c",namespacePrefix+"Class_Label__c",namespacePrefix+"CMDBClassType__c",namespacePrefix+"FKCMDB_Class__r",namespacePrefix+"ShortDescription__c"],sorters:[{property:namespacePrefix+"Class_Label__c",direction:"ASC"}],data:classStoreData,listeners:{load:function(d){var g=d.queryBy(function(j,k){return(j.get(namespacePrefix+"CMDBClassType__c")=="Asset"&&j.get(namespacePrefix+"Activate__c"))});for(i=0;i<g.length;i++){var c=g.get(i);var h=c.get(namespacePrefix+"ShortDescription__c");if(!h){h=NoClassRulesDefined}var e=c.get(namespacePrefix+"FKCMDB_Class__r");var f="\t"+RuleBasedAsset+"\n"+BasedonCIClass+" : "+e[namespacePrefix+"Class__c"]+"\n"+CMDBAssetRule+" : "+h;c.set(namespacePrefix+"ShortDescription__c",f)}}}});var b=Ext.create("Ext.form.ComboBox",{id:"className",store:a,queryMode:"local",hiddenName:"classNameCombo",displayField:namespacePrefix+"Class_Label__c",valueField:namespacePrefix+"ClassName__c",value:CMDBClassNameCombo,fieldLabel:cmdbClassName,disabledCls:"increasedOpacityCls",forceSelection:true,labelAlign:"right",labelWidth:"auto",selectOnFocus:true,typeAhead:true,typeAheadDelay:500,renderTo:"spanCMDBClassName",listConfig:{tpl:'<tpl for="."><div class="x-boundlist-item classLabelWrap" title="{'+namespacePrefix+'Class_Label__c:htmlEncode}">{'+namespacePrefix+'Class_Label__c:htmlEncode}<tpl if="('+namespacePrefix+"Activate__c == true && "+namespacePrefix+'CMDBClassType__c == \'Asset\')"><img id="RBATooltip" title="{'+namespacePrefix+'ShortDescription__c}" src="'+SDEFStylesResource+'/SDEFicons/url.png" style="float: right;margin-top: -1px;"/></tpl></div></tpl>'},listeners:{change:function(g,f,c){if(f&&f!=c){clearLookupAndSelectFieldCombo();if(g&&g.displayTplData){document.querySelector('input[id*="CMDBClass"]').value=g.displayTplData[0].Id;document.querySelector('input[id*="ClassName"]').value=f;var d=g.displayTplData[0][namespacePrefix+"Class_Label__c"];Ext.getCmp("selectFieldCombo").inputEl.dom.placeholder=d+": "+LookupFilter.Labels.CMDBAttributeTitle}var e=Ext.getCmp("filterForCMDB");if(e){e.store.removeAll();e.setValue("")}if(fireChangeEvent){CriteriaGridData="";CriteriaViewStore.loadData(CriteriaGridData);showWaitbox();fetchClassFields(f)}if(g&&g.valueModels){selectedClassId=g.valueModels[0].raw.Id}}},afterrender:function(c){if(isCIManagementEnabled&&isAssetManagementEnabled){if(!CMDBClassTypeCombo){Ext.getCmp("classType").setValue("CI")}else{c.store.clearFilter(true);c.store.filter(namespacePrefix+"CMDBClassType__c",CMDBClassTypeCombo)}if(CMDBClassId){selectedClassId=CMDBClassId}}hideWaitbox()}}})}function ReloadFieldStore(){var a=Ext.getCmp("filterForCMDB");if(a!=null){a.store.removeAll();a.store.loadData(fieldsStoreData)}}function createFieldStore(){var b=Ext.create("Ext.data.Store",{fields:["label","fieldApiName","RelationshipName"],sorters:[{property:"label",direction:"ASC"}],data:fieldsStoreData});var a=Ext.create("Ext.form.ComboBox",{id:"filterForCMDB",fieldLabel:LookupFilter.Labels.FilterFor,store:b,queryMode:"local",displayField:"label",valueField:"fieldApiName",disabledCls:"increasedOpacityCls",labelAlign:"right",labelWidth:"auto",forceSelection:true,tpl:'<tpl for="."><div title="{label:htmlEncode}" class="x-boundlist-item classLabelWrap" >{label:htmlEncode} </div></tpl>',selectOnFocus:true,renderTo:"FilterForCMDB",listeners:{change:function(k,j,f){if(j&&j!=f&&k.displayTplData[0]){var e=k.displayTplData[0].label;var d=k.displayTplData[0].fieldApiName;var g=k.displayTplData[0].RelationshipName;var h=namespacePrefix.toLowerCase()+"bmc_baseelement__c";var c="";if(g==h){c=e+": "+LookupFilter.Labels.CMDBAttributeTitle}else{c=e+": "+LookupFilter.Labels.Fields}Ext.getCmp("lookupFieldCombo").inputEl.dom.placeholder=c;if(fireChangeEvent){showWaitbox();getFieldsForSelectedFieldCMDB(d)}}}}})}function createClassTypeComboBox(){var b=Ext.create("Ext.data.Store",{fields:["value","name"],data:[{value:"CI",name:CI},{value:"Asset",name:Asset},{value:"CI and Asset",name:CIandAsset}]});var a=Ext.create("Ext.form.ComboBox",{id:"classType",fieldLabel:cmdbClassType,store:b,queryMode:"local",hiddenName:"classTypeCombo",disabledCls:"increasedOpacityCls",displayField:"name",valueField:"value",value:CMDBClassTypeCombo,forceSelection:true,selectOnFocus:true,labelAlign:"right",labelWidth:"auto",renderTo:"CMDBClassType",listeners:{change:function(h,g,c){showWaitbox();clearLookupAndSelectFieldCombo();var e=Ext.getCmp("className");if(e){e.clearValue();selectedClassId="";var d=Ext.getCmp("className").store;d.clearFilter(true);if(classStoreData){var j=classStoreData.filter(function(k){return k[namespacePrefix+"CMDBClassType__c"]==g});d.loadData(j)}d.filter(namespacePrefix+"CMDBClassType__c",g);var f=Ext.getCmp("filterForCMDB");if(f){f.store.removeAll();f.setValue("")}if(fireChangeEvent){CriteriaGridData="";CriteriaViewStore.loadData(CriteriaGridData)}hideWaitbox()}}}})}function createFilterTypeComboBox(){var b=Ext.create("Ext.data.Store",{fields:["Value","Label"],data:cmdbFilterTypeStore});var a=Ext.create("Ext.form.ComboBox",{id:"filterType",fieldLabel:filterTypeFieldLabel,store:b,queryMode:"local",hiddenName:"filterTypeCombo",displayField:"Label",valueField:"Value",disabledCls:"increasedOpacityCls",value:cmdbFilterType,forceSelection:true,selectOnFocus:true,editable:false,labelAlign:"right",labelWidth:"auto",renderTo:"FilterTypeCMDB",listeners:{change:function(e,d,c){document.querySelector('input[id*="cmdbFilterType"]').value=d}}})}function setSelectPlaceHolderFieldCombo(c,b){if(b=="selectFieldCombo"){clearLookupAndSelectFieldCombo()}if(c.selectedOptions[0]){var a=c.selectedOptions[0].innerText+": "+LookupFilter.Labels.Fields;Ext.getCmp(b).inputEl.dom.placeholder=a}}function createConsolePicklist(){var b=Ext.create("Ext.data.Store",{fields:["value","name"],data:[{name:LookupFilter.Labels.None1,value:"None"},{name:LookupFilter.Labels.Incident,value:"incident__c"},{name:LookupFilter.Labels.Task,value:"task__c"},{name:LookupFilter.Labels.ChangeRequest,value:"change_request__c"},{name:LookupFilter.Labels.Release,value:"release__c"},{name:LookupFilter.Labels.Problem,value:"problem__c"}]});var a=Ext.create("Ext.form.ComboBox",{id:"ConsolePicklistCombo",fieldLabel:LookupFilter.Labels.ConsolePicklistLabel,store:b,queryMode:"local",disabledCls:"increasedOpacityCls",displayField:"name",valueField:"value",value:lookupFilterConsole,forceSelection:true,labelWidth:"auto",selectOnFocus:true,labelAlign:"right",renderTo:"ConsolePicklist",listeners:{change:function(f,e,d){hideShowSScheckbox(e);if(e&&e!=d){if(f.displayTplData[0]){var c=f.displayTplData[0].name;Ext.getCmp("selectFieldCombo").inputEl.dom.placeholder=c+":"+LookupFilter.Labels.Fields}if(fireChangeEvent){showWaitbox();Ext.getCmp("ConsoleLookupFieldsPicklistCombo").setValue("");clearCriteriaGrid();getFieldValues(e)}}}}})}function createConsoleLookupFieldPicklist(){var b=Ext.create("Ext.data.Store",{fields:["fieldAPIName","fieldLabel"],data:consoleLookupFieldsStore});var a=Ext.create("Ext.form.ComboBox",{id:"ConsoleLookupFieldsPicklistCombo",fieldLabel:LookupFilter.Labels.ConsoleFilterForLabel,store:b,queryMode:"local",disabledCls:"increasedOpacityCls",displayField:"fieldLabel",valueField:"fieldAPIName",tpl:'<tpl for="."><li class="x-boundlist-item classLabelWrap" title="{fieldLabel:htmlEncode}">{fieldLabel:htmlEncode}</li></tpl>',forceSelection:true,selectOnFocus:true,labelAlign:"right",labelWidth:"auto",renderTo:"FilterForConsole",listeners:{change:function(f,e,d){if(e&&e!=d){var c=f.displayTplData[0].fieldLabel;Ext.getCmp("lookupFieldCombo").inputEl.dom.placeholder=c+":"+LookupFilter.Labels.Fields;if(fireChangeEvent){showWaitbox();clearCriteriaGrid();getFieldsForSelectedField(e)}}}}})}function populatelookupFieldStore(){var a=Ext.getCmp("ConsoleLookupFieldsPicklistCombo");if(a){a.store.loadData(consoleLookupFieldsStore)}};