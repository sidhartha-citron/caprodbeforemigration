var paginationInfoText;var pageNumber=1;var fromStdLayout=false;var LinkedCiId="";var helpLink;var waitMask,msgStr;var AdvActionPanel;var ORPanelHeight=document.documentElement.clientHeight;var AcInvalidDeviceMsg,AdvActionLabel,AcORReqMsg,pleasewait;var toolbar;function addToolBar(){Ext.QuickTips.init();toolbar=new Ext.Toolbar({id:"toolBarId",renderTo:"ToolBarTD",cls:"toolSpCls",region:"north",height:40,border:false,autoWidth:true,autoHeight:true,autoEl:true,items:[]})}function setPaginationText(){if(totalPages==0||totalPages==pageNumber){paginationInfoText=ACDeviceSummaryPage.Labels.PageLabel+" "+totalPages+" "+ACDeviceSummaryPage.Labels.OfLabel+" "+totalPages;Ext.getCmp("nextBtnId").setDisabled(true);Ext.getCmp("lastBtnId").setDisabled(true)}else{paginationInfoText=ACDeviceSummaryPage.Labels.PageLabel+" "+pageNumber+" "+ACDeviceSummaryPage.Labels.OfLabel+" "+totalPages;Ext.getCmp("nextBtnId").setDisabled(false);Ext.getCmp("lastBtnId").setDisabled(false)}}Ext.onReady(function(){Ext.data.Store.prototype.sortData=function(r,s){s=s||"ASC";var p=this.fields.get(r).sortType;var q=function(u,t){var w=p(u.data[r]),v=p(t.data[r]);if(w.toLowerCase){w=w.toLowerCase();v=v.toLowerCase()}return w>v?1:(w<v?-1:0)};this.data.sort(s,q);if(this.snapshot&&this.snapshot!=this.data){this.snapshot.sort(s,q)}};helpLink={xtype:"label",html:'<a href="#" onclick="OpenHelppage();"><img title="Help" height="17" width="17" id="helpConsoleList" src="'+imageHelp+'/SDEFbuttons/b_console_help.png"></a>'};addToolBar();gridName="Hardware";paginationInfoText=ACDeviceSummaryPage.Labels.PageLabel+" "+totalPages+" "+ACDeviceSummaryPage.Labels.OfLabel+" "+totalPages;tabs=new Ext.TabPanel({id:"centralTabPanel",region:"center",cls:"centralTabPanelCls",activeTab:0,plain:true,style:"overflow:hidden",defaults:{autoScroll:true,hideMode:"offsets"},tabBar:{height:30,defaults:{height:29}},items:[getGrid("Hardware",ACDeviceSummaryPage.Labels.HardwareTab),getSoftWareGrid("Software",ACDeviceSummaryPage.Labels.SoftwareTab)],listeners:{tabchange:function(p,r,q){if(r.id.indexOf("disabled")==-1){Ext.getCmp(r.id).getStore().removeAll()}if(r.id=="Security"){gridName="Security";selectedTabName=r.id;if(q.id.indexOf("disabled")==-1){Ext.getCmp(q.id).reconfigure(Ext.getCmp(q.id).getStore(),[])}if(typeof(securityJson.Response[0])=="undefined"){startWaitMask();fetchSecurityDetails()}else{refreshTabValues()}}else{if(r.id=="Hardware"){if(gridName!="Hardware"){gridName="Hardware";selectedTabName=r.id;if(q.id.indexOf("disabled")==-1){Ext.getCmp(q.id).reconfigure(Ext.getCmp(q.id).getStore(),[])}if(typeof(HWJson.Response[0])=="undefined"){startWaitMask();fetchHardwareDetails()}else{refreshTabValues()}}}else{if(r.id=="Financial"){gridName="Financial";selectedTabName=r.id;if(q.id.indexOf("disabled")==-1){Ext.getCmp(q.id).reconfigure(Ext.getCmp(q.id).getStore(),[])}if(typeof(financeJson.Response[0])=="undefined"){startWaitMask();fetchFinalcialDetails()}else{refreshTabValues()}}else{if(r.id=="Software"){gridName="Software";selectedTabName=r.id;if(q.id.indexOf("disabled")==-1){Ext.getCmp(q.id).reconfigure(Ext.getCmp(q.id).getStore(),[])}if(typeof(softwareData.Response[0])=="undefined"){startWaitMask();fetchSoftwareDetails(0)}else{refreshTabValues()}}else{if(r.id=="License"){gridName="License";selectedTabName=r.id;if(q.id.indexOf("disabled")==-1){Ext.getCmp(q.id).reconfigure(Ext.getCmp(q.id).getStore(),[])}if(typeof(licenseJson.Response[0])=="undefined"){startWaitMask();fetchLicenseDetails()}else{refreshTabValues()}}else{if(r.id=="ActionHistory"){gridName="ActionHistory";selectedTabName=r.id;if(q.id.indexOf("disabled")==-1){Ext.getCmp(q.id).reconfigure(Ext.getCmp(q.id).getStore(),[])}if(typeof(actionJson.Response[0])=="undefined"){startWaitMask();fetchActionHistoryDetails()}else{refreshTabValues()}}}}}}}}}});var m;var b=new Ext.Panel({id:"SubPanel",region:"center",layout:"border",items:[{contentEl:"capsule",height:180,region:"north"},tabs]});if(acVersion!=null&&acVersion!=""&&acVersion!="undefined"&&acVersion.toUpperCase()=="TRUE"){var o=String(window.parent);var k=-1;if(typeof(o)!="undefined"&&o!=""){o=String(window.parent.location);k=o.indexOf("apex/AcActions")}if(k!=-1&&typeof(incidentId)!="undefined"&&incidentId!=""){var l="ACAdvanceActions?standardLayout=true&stdForm=true&forAdvAction=true&IncId="+incidentId;AdvActionPanel=new Ext.Panel({id:"AdvActionPanel",region:"east",collapsible:true,collapsed:true,title:AdvActionLabel,floating:false,animCollapse:false,height:"auto",html:'<iframe id="ORPage" src ="/apex/'+l+'"style="width:100%;height:100%;border:none;"/>'});m=Ext.create("Ext.container.Viewport",{layout:"border",items:(!RestrictedTabs&&showAdvanceTab)?[toolbar,b,AdvActionPanel]:[toolbar,b]})}else{m=new Ext.Viewport({layout:"border",items:[toolbar,b]})}}else{m=new Ext.Viewport({layout:"border",items:[toolbar,b]})}var h=gettableStore(gridName);h.model.setFields(storeFields);h.loadRawData(json);Ext.getCmp(gridName).reconfigure(h,ColumnModel);if(!fromStdLayout){if(parent.acpopUpWindow!=null&&parent.acpopUpWindow!=""&&parent.acpopUpWindow!="undefined"){parent.acpopUpWindow.setTitle(pageTitle)}}var g=getACMenu();var c=Ext.getCmp("toolBarId");var d=window.parent.location;d=String(d);if(typeof(c)!="undefined"&&c!=null&&c!="undefined"){var j=d.indexOf("apex/AcActions");if(d!=null&&d!=""&&d!="undefined"&&j!=-1){var n='<a href="#" style="text-decoration: none !important;" onclick="window.parent.OpenHelppage();"><span style="font-size: 16px;cursor:pointer; color:black" title="'+Help+'"  id="helpConsoleList" class="d-icon-question_circle"></a>';var a={iconCls:"refresh",tooltipType:"title",tooltip:Refresh,scale:"medium",id:"ACrefreshBtn",listeners:{click:function(){startWaitMask(10000);window.location.reload()}}};c.add({xtype:"tbspacer",width:5});c.add(a);c.add({xtype:"tbspacer",width:5});c.add({xtype:"tbseparator"});c.add({xtype:"tbspacer",width:5});c.add({id:"CiActionMenuId",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",text:actions,menu:g,tooltipType:"title",tooltip:acActionLabel});c.add({xtype:"tbseparator"});c.add("->");c.add({xtype:"label",id:"CiHelpLink",html:n,tooltipType:"title"});c.add({xtype:"tbspacer",width:10})}else{c.insert(1,{iconCls:"acAction",baseCls:"bmc-btn-dropdown",disabledCls:"bmc-btn-dropdown-disabled",focusCls:"focus",overCls:"over",pressedCls:"pressed",text:actions,menu:g,tooltipType:"title",tooltip:acActionLabel,listeners:{click:function(){setTooltipforMenuItems()}}})}c.doLayout(true,true);setActionsState()}setTimeout(makeGridTextSelectable,2000);if(!fromStdLayout){window.parent.tabs.setHeight(700)}var f=Ext.getCmp("centralTabPanel");if(typeof(f)!="undefined"&&f!=null&&f!="undefined"){if(RestrictedTabs){var e='<div class="disabledTabMsg">'+DisabledText+"</div>";f.insert(3,{id:"disabledLicense",html:e,title:ACDeviceSummaryPage.Labels.LicenseUnitsTab});f.insert(4,{id:"disabledSecurity",html:e,title:ACDeviceSummaryPage.Labels.SecurityTab});f.insert(5,{id:"disabledFinancial",html:e,title:ACDeviceSummaryPage.Labels.FinancialTab});f.insert(6,{id:"disabledActionHistory",html:e,title:ACDeviceSummaryPage.Labels.ActionHistory})}else{f.insert(3,getGrid("License",ACDeviceSummaryPage.Labels.LicenseUnitsTab));f.insert(4,getGrid("Security",ACDeviceSummaryPage.Labels.SecurityTab));f.insert(5,getGrid("Financial",ACDeviceSummaryPage.Labels.FinancialTab));f.insert(6,getGrid("ActionHistory",ACDeviceSummaryPage.Labels.ActionHistory))}}if(typeof(HWJson.Response[0])=="undefined"){startWaitMask();fetchHardwareDetails()}});function setTooltipforMenuItems(){var b=["RemoteControl","FileSystem","Registry","Events","Processes","Services","PerformAudit","FileTransfer","Ping","Reboot","Shutdown","WakeUp"];if(fromStdLayout){var c=Ext.getCmp("actionMenu").items.items;for(i=0;i<c.length;i++){if(typeof(c[i].id)!="undefined"&&b.indexOf(c[i].id)!=-1){if(c[i]!="ConfigSummary"&&DisableTabs&&c[i].disabled){var a=DisabledText;if(isAdminUser){a=a+" "+DiscoveryScannerCapability}new Ext.ToolTip({target:c[i].id,anchor:"left",html:a})}}}}}function OpenHelppage(){alert("Need to add Help page!!!")}function getGrid(a,b){return new Ext.create("Ext.grid.GridPanel",({id:a,stripeRows:true,border:false,columns:[],autoScroll:false,title:b,buttonAlign:"center",viewConfig:{emptyText:'<span class="emptyTextCls">'+emptyText+"</span>"}}))}function getSoftWareGrid(a,b){return Ext.create("Ext.grid.GridPanel",({id:"Software",stripeRows:true,border:false,columns:[],title:b,autoScroll:false,bbar:{id:"pagingbar",displayInfo:true,buttonAlign:"center",height:30,items:getBbarOptions()},viewConfig:{emptyText:'<span class="emptyTextCls">'+emptyText+"</span>"}}))}function refreshGrid(){var c=gettableStore(gridName);c.model.setFields(storeFields);c.loadRawData(json);Ext.getCmp(gridName).reconfigure(c,ColumnModel);Ext.getCmp(gridName).getView().refresh();var a=Ext.getCmp(gridName).getView().getGridColumns();var f=0;var d;for(i=0;i<a.length;i++){if(a[i].hidden!=true){d=i;f+=a[i].width}}var b=Ext.getCmp(gridName).getWidth();if(f&&b&&b-f>0){var e=Ext.getCmp(gridName).getView().getGridColumns()[d].width+(b-f)+1;Ext.getCmp(gridName).getView().getGridColumns()[d].setWidth(e)}makeGridTextSelectable()}function makeGridTextSelectable(){if(Ext.isIE){var a=Ext.DomQuery.select("div[unselectable=on]",Ext.getCmp(gridName).dom);for(i=0;i<a.length;i++){a[i].unselectable="off"}}}function gettableStore(a){if(a=="Software"||a=="Hardware"||a=="License"||a=="Security"||a=="Financial"){return new Ext.data.JsonStore({proxy:{type:"memory",reader:{type:"json",root:"Response"}},fields:[],sorters:[{property:"Attribute",direction:"ASC"}],})}else{if(a=="ActionHistory"){return new Ext.data.JsonStore({proxy:{type:"memory",reader:{type:"json",root:"Response"}},fields:[],sorters:[{property:"Attribute",direction:"ASC"}],})}}}function checkEnable(){tableStore.loadData(json)}function refreshTabValues(){if(selectedTabName=="Security"){storeFields=securityStoreFlds;ColumnModel=securityColunmfields;json=securityJson;refreshGrid()}else{if(selectedTabName=="Financial"){storeFields=financeStoreFlds;ColumnModel=financeColunmfields;json=financeJson;refreshGrid()}else{if(selectedTabName=="Software"){storeFields=softwareStorefields;ColumnModel=softwareColModel;setPaginationText();RemedyForceHTMLProcessor.clearHTML(document.getElementById("pageCountID"));document.getElementById("pageCountID").appendChild(document.createTextNode(paginationInfoText));json=softwareData;refreshGrid()}else{if(selectedTabName=="License"){storeFields=licenseStoreFlds;ColumnModel=licenseColunmfields;json=licenseJson;refreshGrid()}else{if(selectedTabName=="ActionHistory"){storeFields=actionStoreFlds;ColumnModel=actionColunmfields;json=actionJson;refreshGrid()}else{storeFields=HWStoreFlds;ColumnModel=HWColunmfields;json=HWJson;refreshGrid()}}}}}}function getBbarOptions(){var a=new Array(5);a[0]={scale:"medium",iconCls:"d-icon-angles_left",tooltipType:"title",id:"firstBtnId",disabled:"true",handler:firstBtnHandler};a[1]={scale:"medium",iconCls:"d-icon-angle_left",tooltipType:"title",id:"prevBtnId",disabled:"true",handler:prevBtnHandler};a[2]={xtype:"tbspacer",width:5};a[3]={xtype:"tbseparator"};a[4]={xtype:"tbspacer",width:5};a[5]='<span id="pageCountID" style="padding:2px;">'+paginationInfoText+"</span>";a[6]={xtype:"tbspacer",width:5};a[7]={xtype:"tbseparator"};a[8]={xtype:"tbspacer",width:5};a[9]={scale:"medium",iconCls:"d-icon-angle_right",tooltipType:"title",id:"nextBtnId",handler:nextBtnHandler};a[10]={scale:"medium",iconCls:"d-icon-angles_right",tooltipType:"title",id:"lastBtnId",handler:lastBtnHandler};return a}function firstBtnHandler(){startWaitMask();pageNumber=1;Ext.getCmp("prevBtnId").setDisabled(true);Ext.getCmp("firstBtnId").setDisabled(true);Ext.getCmp("nextBtnId").setDisabled(false);Ext.getCmp("lastBtnId").setDisabled(false);fetchSoftwareDetails(0)}function prevBtnHandler(){startWaitMask();pageNumber=pageNumber-1;if(pageNumber==1){Ext.getCmp("prevBtnId").setDisabled(true);Ext.getCmp("firstBtnId").setDisabled(true)}else{Ext.getCmp("prevBtnId").setDisabled(false);Ext.getCmp("firstBtnId").setDisabled(false)}Ext.getCmp("nextBtnId").setDisabled(false);Ext.getCmp("lastBtnId").setDisabled(false);if(pageNumber>1){fetchSoftwareDetails((pageNumber-1)*record_count)}else{fetchSoftwareDetails(pageNumber-1)}}function nextBtnHandler(){startWaitMask();fetchSoftwareDetails(pageNumber*record_count);pageNumber=pageNumber+1;if(pageNumber==totalPages){Ext.getCmp("nextBtnId").setDisabled(true);Ext.getCmp("lastBtnId").setDisabled(true)}else{Ext.getCmp("nextBtnId").setDisabled(false);Ext.getCmp("lastBtnId").setDisabled(false)}Ext.getCmp("prevBtnId").setDisabled(false);Ext.getCmp("firstBtnId").setDisabled(false)}function lastBtnHandler(){startWaitMask();pageNumber=totalPages;Ext.getCmp("nextBtnId").setDisabled(true);Ext.getCmp("lastBtnId").setDisabled(true);Ext.getCmp("prevBtnId").setDisabled(false);Ext.getCmp("firstBtnId").setDisabled(false);fetchSoftwareDetails((totalPages-1)*record_count)}function colRenderer(f,c,a,g,d,b){if(selectedTabName=="ActionHistory"){return colRender(f,c,a,g,d,b)}else{var e=""+f;c.attr='title="'+f+'"';return f}}function ShowMessageBox(){if(typeof(msgStr)!="undefined"&&msgStr!=""){GetMessageBox("bmc-message").show({msg:msgStr,title:strMessage,width:300,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}msgStr=""}function startWaitMask(){waitMask=new Ext.LoadMask(Ext.getBody(),{floating:{shadow:false},msgCls:"d-loader-contGetMessageBoxainer",msg:'<ul class="d-loading"><li class="d-loading__stick d-loading__stick_1"></li><li class="d-loading__stick d-loading__stick_2"></li><li class="d-loading__stick d-loading__stick_3"></li><li class="d-loading__stick d-loading__stick_4"></li><li class="d-loading__stick d-loading__stick_5"></li><li class="d-loading__stick d-loading__stick_6"></li><li class="d-loading__stick d-loading__stick_7"></li><li class="d-loading__stick d-loading__stick_8"></li><li class="d-loading__stick d-loading__stick_9"></li><li class="d-loading__stick d-loading__stick_10"></li><li class="d-loading__stick d-loading__stick_11"></li><li class="d-loading__stick d-loading__stick_12"></li></ul><div>'+pleasewait+"</div>"});if(typeof(waitMask)!="undefined"&&waitMask!=null&&waitMask!=""){waitMask.show()}}function stopWaitMask(){if(typeof(waitMask)!="undefined"&&waitMask!=null&&waitMask!=""){waitMask.hide()}}function GetMessageBox(a){if(typeof(WinMsg)=="undefined"||WinMsg==null){WinMsg=Ext.create("Ext.window.MessageBox")}WinMsg.baseCls=a;return WinMsg}function showWaitMsgBar(a){if(parseInt(a)>0){setTimeout("waitingMask.hide()",a)}waitingMask=new Ext.LoadMask(Ext.getBody(),{floating:{shadow:false},msgCls:"d-loader-container",msg:'<ul class="d-loading"><li class="d-loading__stick d-loading__stick_1"></li><li class="d-loading__stick d-loading__stick_2"></li><li class="d-loading__stick d-loading__stick_3"></li><li class="d-loading__stick d-loading__stick_4"></li><li class="d-loading__stick d-loading__stick_5"></li><li class="d-loading__stick d-loading__stick_6"></li><li class="d-loading__stick d-loading__stick_7"></li><li class="d-loading__stick d-loading__stick_8"></li><li class="d-loading__stick d-loading__stick_9"></li><li class="d-loading__stick d-loading__stick_10"></li><li class="d-loading__stick d-loading__stick_11"></li><li class="d-loading__stick d-loading__stick_12"></li></ul><div>'+pleasewait+"</div>"});if(typeof(waitingMask)!="undefined"&&waitingMask!=null&&waitingMask!=""){waitingMask.show()}};