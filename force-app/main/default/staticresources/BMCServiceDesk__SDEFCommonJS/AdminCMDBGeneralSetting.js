var ImportButton,intervalVar;var ScheduleIntervalData=0;Ext.onReady(function(){var a=new Ext.Panel({id:"mainHeaderPanel",border:false,tbar:[" ",{scale:"medium",iconCls:"bmcSave",cls:"toolSpCls",tooltipType:"title",tooltip:savelabel,id:"saveBtn",handler:saveHandler}],autoWidth:true,renderTo:"toolbar"});hourField=Ext.create("Ext.form.field.Number",{width:55,value:defaultHours,minValue:0,renderTo:"hourFieldTD"});minField=Ext.create("Ext.form.field.Number",{width:55,minValue:0,maxValue:59,maxLength:2,enableKeyEvents:true,value:defaultMins,renderTo:"minuteFieldTD",listeners:{keyup:function(d,c,b){validateSpinnerField(d,c)}}});NormButton=Ext.create("Ext.Button",{id:"NormButton",text:"",renderTo:"NormalizationButtonTD",width:200,handler:function(){if(NormButton.getText()==startbuttontext){NormButton.setText(stopbuttontext);NormButton.setDisabled(true);CalculateInterval();ScheduleJob(ScheduleIntervalData)}else{NormButton.setText(startbuttontext);NormButton.setDisabled(true);StopJob()}}});if(buttontext=="false"){NormButton.setText(startbuttontext)}else{NormButton.setText(stopbuttontext)}createImportButton();if(ImportButton!=null&&Batchjobrunnningflag){ImportButton.setDisabled(true);checkModelGenerationProgress()}else{ImportButton.setDisabled(false)}enableAssetStatusConfiguration();if(Ext.isIE8){prepareStatusColumnStructure(getElementsByClassName(document,"table","statusColumnStructure")[0],4)}else{prepareStatusColumnStructure(document.getElementsByClassName("statusColumnStructure")[0],4)}});function createImportButton(){ImportButton=Ext.create("Ext.Button",{id:"ImportButton",text:ImportModelRecords,renderTo:"ImportButtonTD",width:200,handler:function(){ImportButton.setDisabled(true);ScheduleImportJob()}})}function prepareStatusColumnStructure(a,b){cells=a.rows[0].cells;cellCount=cells.length;rowCount=Math.ceil(cellCount/b);for(i=0;i<rowCount;i++){a.insertRow(0)}for(i=0;i<cellCount;i++){row=Math.floor(i/b);cells[i].height=25;cells[i].width=200;a.rows[row].appendChild(cells[i].cloneNode(true))}a.deleteRow(rowCount)}function enableAssetStatusConfiguration(){var b;if(Ext.isIE8){b=getElementsByClassName(document,"table","statusColumnStructure")}else{b=document.getElementsByClassName("statusColumnStructure")}var c=b[0].getElementsByTagName("input");var a=b[0].getElementsByTagName("label");if(assetEnabledChecked.checked){for(i=0;i<c.length;i++){c[i].disabled=false;a[i].style.opacity="1"}}else{for(i=0;i<c.length;i++){c[i].disabled=true;a[i].style.opacity="0.45"}}}function validateSpinnerField(c,b){var d=c.getValue();if(d!=null){d=d.toString();var a=d.substring(0,d.length-1);if(d>c.maxValue){c.setValue(parseInt(a))}}}function CalculateInterval(){var a;var b;if(hourField.getValue()==null){window.parent.Ext.MessageBox.show({msg:NormalizationTimeMandatory,buttons:Ext.MessageBox.OK});return false}else{a=hourField.getValue()}if(minField.getValue()==null){window.parent.Ext.MessageBox.show({msg:NormalizationTimeMandatory,buttons:Ext.MessageBox.OK});return false}else{b=minField.getValue()}ScheduleIntervalData=(parseInt(a)*60)+parseInt(b)}function saveHandler(){CalculateInterval();showLoadingMask();save(ScheduleIntervalData)}function onCompleteStart(){if(jobstatusflag=="false"){Ext.MessageBox.show({msg:schedulingException,buttons:Ext.MessageBox.OK})}NormButton.setDisabled(false)}function onCompleteStop(){NormButton.setDisabled(false)}var waitMask="";function showLoadingMask(){waitMask=new Ext.LoadMask(Ext.getBody(),{msg:Saving});if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.show()}}function openExceptions(){window.open(SchedulerExceptionsPage,"Exceptions","height=550,left=200,top=100,width=800,toolbar=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes ,modal=yes")}function hideLoadingMask(){if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.hide()}}function toggleCIMgmntITAM(a){if(a=="Asset"&&!assetEnabledChecked.checked&&!enableCIMgmtSetting.checked){enableCIMgmtSetting.checked=true}else{if(a=="CI"&&!enableCIMgmtSetting.checked&&!assetEnabledChecked.checked){assetEnabledChecked.checked=true;enableAssetStatusConfiguration()}}}function AskToActivateClasses(){if(activateRBACls&&assetEnabledChecked!=null&&typeof(assetEnabledChecked)!="undefined"&&assetEnabledChecked.checked==true){Ext.Msg.show({title:activateRBAClassesTitleLbl,msg:activateRBAClassesMsg,buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,width:450,height:300,fn:function(b){if(b=="yes"){showLoadingMask();activateRBAClasses()}}})}var a=window.parent.Ext.getCmp("adminMenuId7013");if(a){if(enableModels==false&&isFreshInstall==false){a.hide()}else{a.show()}}}function ActivationComplete(){hideLoadingMask();if(excWhileActivatingRBACls==""){Ext.Msg.show({msg:activationSuccessfullMsg,buttons:Ext.Msg.OK})}else{Ext.Msg.show({msg:excWhileActivatingRBACls,buttons:Ext.Msg.OK})}}function showMsg(){if(msgStringlbl!=null&&msgStringlbl!=""&&msgStringlbl==SaveLabel1){ShowInlineMessage("SaveMessageDiv","mainPaneldiv",-53);if(msgString!=null&&msgString!=""){Ext.Msg.show({title:CMDBGeneralSettings,msg:msgString,icon:Ext.MessageBox.WARNING,width:300,frame:false,buttons:Ext.Msg.OK})}}else{var a=ExceptionMessage;if(msgString!=null&&msgString!=""){a=a+" "+msgString}Ext.Msg.show({title:CMDBGeneralSettings,msg:a,icon:Ext.MessageBox.ERROR,width:300,frame:false,buttons:Ext.Msg.OK})}}function getElementsByClassName(b,f,a){var e=(f=="*"&&b.all)?b.all:b.getElementsByTagName(f);var h=new Array();a=a.replace(/\-/g,"\\-");var g=new RegExp("(^|\\s)"+a+"(\\s|$)");var d;for(var c=0;c<e.length;c++){d=e[c];if(g.test(d.className)){h.push(d)}}return(h)}function checkModelGenerationProgress(){intervalVar=setInterval(function(){pollingFunction()},10000)}function showImportButton(){if(ImportButton!=null&&enableImportModel==true){ImportButton.setDisabled(false);clearInterval(intervalVar)}}function showButton(){if(enableModels||isFreshInstall){Ext.getCmp("ImportButton").destroy();createImportButton()}};