var activeElement="",recipientOncompleteFunction;Ext.onReady(function(){enableToCcbutton();var a=new Ext.Toolbar({renderTo:"toolbarDiv",height:39,cls:"toolSpCls",items:[{text:selectFromLabel,xtype:"label"},{id:"involvedUsersRadio",xtype:"radio",fieldLabel:"Involved Users",inputtype:"radio",name:"users",checked:true,boxLabel:involvdeUsersRadioLabel,handler:function(){if(this.checked){document.getElementById("allUsersDiv").style.display="none";document.getElementById("involvedUsersGridDiv").style.display="block"}}}," ",{id:"allUsersRadio",xtype:"radio",fieldLabel:"All Users",inputtype:"radio",name:"users",boxLabel:allUsersRadioLabel,handler:function(){if(this.checked){document.getElementById("involvedUsersGridDiv").style.display="none";var f=document.getElementById("allUsersDiv");if(f){f.style.display="block";if(f.firstChild==null||(f.firstChild&&f.firstChild.tagName!="IFRAME")){var e=document.createElement("iframe");e.id="allUsersIframeId";e.name="allUsersIframe";e.frameBorder="0";e.scrolling="no";e.src="/apex/SearchPage?popupId=Client&pgheight=600&wid=1&disableFirstColLink=true&&isActiveFilterReq=true&filterClause="+escape("isActive = true");e.setAttribute("style","width:100%;height:100%;border:none;");RemedyForceHTMLProcessor.clearHTML(f);f.appendChild(e)}}}}}]});var d=new Ext.grid.ColumnModel([{header:userRoleLabel,width:180,dataIndex:"userRole",sortable:false,renderer:"htmlEncode"},{header:lastNameLabel,width:150,dataIndex:"lastName",sortable:false,renderer:"htmlEncode"},{header:firstNameLabel,width:150,dataIndex:"firstName",sortable:false,renderer:"htmlEncode"},{header:emailAddressLabel,width:255,dataIndex:"emailAddress",sortable:false,renderer:"htmlEncode"}]);var b=new Ext.data.JsonStore({id:"involvedUserStoreId",data:involvedUsersStoreData,root:"involvedUsersRoot",sortInfo:{field:"userRole",direction:"ASC"},fields:["userRole","lastName","firstName","emailAddress","userRoleAPIName"]});var c=new Ext.grid.GridPanel({id:"involvedUsersGridPanelId",cm:d,store:b,cls:"CommonGrid",stripeRows:true,enableHdMenu:false,columnLines:true,viewConfig:{forceFit:true,scrollOffset:0},height:362,width:740,listeners:{rowdblclick:populateSelectedRole}});c.render("involvedUsersGridDiv");chkSizeOfTOCC(toTextAreaDomId);chkSizeOfTOCC(ccTextAreaDomId);recipientWindow=window.parent.popUpWindow;recipientOncompleteFunction=window.parent.onCompleteFunction});function populateSelectedUser(a,c,b){if(activeElement!=null&&activeElement!=undefined&&activeElement=="to"){document.getElementById(toTextAreaDomId).value=document.getElementById(toTextAreaDomId).value+frames.allUsersIframe.grid.store.getAt(c).get("Email")+"; "}else{if(activeElement!=null&&activeElement!=undefined&&activeElement=="cc"){document.getElementById(ccTextAreaDomId).value=document.getElementById(ccTextAreaDomId).value+frames.allUsersIframe.grid.store.getAt(c).get("Email")+"; "}}}function populateSelectedRole(a,c,b){if(activeElement!=null&&activeElement!=undefined&&activeElement=="to"){document.getElementById(toTextAreaDomId).value=document.getElementById(toTextAreaDomId).value+a.store.getAt(c).get("userRole")+"; "}else{if(activeElement!=null&&activeElement!=undefined&&activeElement=="cc"){document.getElementById(ccTextAreaDomId).value=document.getElementById(ccTextAreaDomId).value+a.store.getAt(c).get("userRole")+"; "}}}function populateToAddress(){activeElement="to";var a;if(document.getElementById("involvedUsersGridDiv").style.display=="block"){a=Ext.getCmp("involvedUsersGridPanelId").getSelectionModel().getSelections();addInvolvedUserstoAddressFields(a,toTextAreaDomId)}else{if(document.getElementById("allUsersDiv").style.display=="block"){a=frames.allUsersIframe.grid.getSelectionModel().getSelections();addAllUserstoAddressFields(a,toTextAreaDomId)}}}function populateccAddress(){activeElement="cc";var a;if(document.getElementById("involvedUsersGridDiv").style.display=="block"){a=Ext.getCmp("involvedUsersGridPanelId").getSelectionModel().getSelections();addInvolvedUserstoAddressFields(a,ccTextAreaDomId)}else{if(document.getElementById("allUsersDiv").style.display=="block"){a=frames.allUsersIframe.grid.getSelectionModel().getSelections();addAllUserstoAddressFields(a,ccTextAreaDomId)}}}function addAllUserstoAddressFields(c,b){var a=document.getElementById(b).value;for(var d=0;d<c.length;d++){a=a+c[d].get("Email")+";";frames.allUsersIframe.grid.getSelectionModel().clearSelections()}document.getElementById(b).value=a;if(a.length>120){document.getElementById(b).style.height="35px"}else{document.getElementById(b).style.height="16px"}}function addInvolvedUserstoAddressFields(c,b){var a=document.getElementById(b).value;for(var d=0;d<c.length;d++){a=a+c[d].get("userRole")+";";Ext.getCmp("involvedUsersGridPanelId").getSelectionModel().clearSelections()}document.getElementById(b).value=a;if(a.length>120){document.getElementById(b).style.height="35px"}else{document.getElementById(b).style.height="16px"}}function chkSize(a){var b=a.value.length;if(b>120){a.style.height="35px"}else{a.style.height="16px"}}function chkSizeOfTOCC(a){var b=document.getElementById(a).value.length;if(b>120){document.getElementById(a).style.height="35px"}else{document.getElementById(a).style.height="16px"}}function enableToCcbutton(){var b=window.parent.toEmailRecipientAddress.trim();var a=window.parent.ccEmailRecipientAddress.trim();if(b!=undefined&&b!=null&&b!=""&&b.charAt(b.length-1)!=";"){b=b+";"}if(a!=undefined&&a!=null&&a!=""&&a.charAt(a.length-1)!=";"){a=a+";"}document.getElementById(toTextAreaDomId).value=b;document.getElementById(ccTextAreaDomId).value=a;if(enabledButtonParam=="to"){document.getElementById(toTextAreaDomId).focus();activeElement="to"}else{if(enabledButtonParam=="cc"){document.getElementById(ccTextAreaDomId).focus();activeElement="cc"}}}function sendAddressValue(){var a=document.getElementById(toTextAreaDomId).value+DZHE+document.getElementById(ccTextAreaDomId).value;window.parent.setOnCompleteFunction(recipientOncompleteFunction);window.parent.setPopUpVar(a);recipientWindow.close()}function cancelRecipients(){recipientWindow.close()}function changeTitle(b,c,a){}function activateWindow(){}function addTab(){};