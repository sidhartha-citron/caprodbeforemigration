var isRowClicked=false,sortOrder="DESC",storestartdate=null,isRefreshed=false,isSwitched=false,refreshCalendar=true,refreshChart=true,splitList,currentList=0,store1,chartDataStore,totalRows,selectedRowIndex,nameFldDataIndex="fld1",idFldDataIndex="fld0",grid,w=335,h=335,eventArr,calendarViewPanel,monthViewPanel,comboPanel,weekViewPanel,dayViewPanel,chartViewPanel,btnToolBar,advFilterGrid,selectedGridRowIndex,globalPageName,globalURL,colsSize=0,PE="П",NONPRINT="¬",isRowClicked=false,eventArr,idArrayMap,calEventArr,arrayMapObj,filterStrLookupNameFld,tempAdvFilterGrid,noName=false,colDataSrcNameOld,colSrcNameNew,resultSet,rowIndexNum=0,j=rowIndexNum,k=0,rows,totalRows,MIN_INTERVAL=1,DEFAULT_INTERVAL=10,toolTipRefreshBtn="",pickListComboStore,noRecordsDisplayMsg;pickListArray=[];pickListData=[];priorityArray=[];statusArray=[];priorityArray["priority1-16.gif"]=1;priorityArray["priority2-16.gif"]=2;priorityArray["priority3-16.gif"]=3;priorityArray["priority4-16.gif"]=4;priorityArray["priority5-16.gif"]=5;priorityArray["priority6-16.gif"]=6;statusArray["svt-missed.png"]="Missed";statusArray["svt-cancelled.png"]="Cancelled";statusArray["svt-warning.png"]="Warning";statusArray["svt-attached_ok_met.png"]="Met/OK";var IEVersion=/msie (\d+)/i.exec(navigator.userAgent);var callCount=0;var t;document.onclick=activateWindow;function isWholeNo(a){return/^ *[0-9]+ *$/.test(a)}function autoRefresh(){if(parseLimit!=0&&parseLimit!=null&&parseLimit!=""){if(parseLimit==1&&callCount!=0&&window.parent!=null&&window.parent.parent!=null&&window.parent.parent.getSDActiveTabId()=="mydashboard"){if(autoRefreshable){refreshBtnHandler()}}else{parseLimit=1}callCount=callCount+1;t=setTimeout("autoRefresh();",Ext.util.Cookies.get(cookieName)*60000)}}var autoRefreshable=true;window.onload=autoRefresh;function createCookie(){if(Ext.getCmp("refreshInterval").getValue()==""){Ext.getCmp("refreshInterval").setValue(0)}var a=new Date();a.setYear(a.getFullYear()+10);document.cookie=cookieName+"="+Ext.getCmp("refreshInterval").getValue()+";path=/;SameSite=None;Secure;expires="+a.toUTCString();document.cookie=cookieName+"isPressed="+Ext.getCmp("autoRefreshId").pressed+";path=/;SameSite=None;Secure;expires="+a.toUTCString()}function activateWindow(){if(window.parent.activateWindow!=undefined){window.parent.activateWindow(widgetId)}}function prepCalPanelJS(b){eventArr=b;idArrayMap=[];calEventArr=sortEventsByDate(getEventsArr());for(var a=0;a<calEventArr.length;a++){if(idArrayMap[calEventArr[a].srcFunction.split(",")[0]]==null){idArrayMap[calEventArr[a].srcFunction.split(",")[0]]=[]}arrayMapObj=idArrayMap[calEventArr[a].srcFunction.split(",")[0]];arrayMapObj[arrayMapObj.length]=calEventArr[a].srcFunction.split(",")[2].split("id=")[1];idArrayMap[calEventArr[a].srcFunction.split(",")[0]]=arrayMapObj}if(viewState=="calendarView"&&b.length<=0){if(Ext.getCmp("norecords")!=null){Ext.getCmp("norecords").show()}}else{if(Ext.getCmp("norecords")!=null){Ext.getCmp("norecords").hide()}}}function getEventsArr(){return eventArr}function refVarPanelJS(b,c){tempAdvFilterGrid=Ext.getCmp("advFilterGridpanel");if(tempAdvFilterGrid!=null&&tempAdvFilterGrid!="undefined"){var a=tempAdvFilterGrid.store.getAt(c);a.set("value","");a.set("value",Ext.util.Format.htmlEncode(b));tempAdvFilterGrid.stopEditing(true)}}function funcWholePageJS(a,b){if(a!=null&&(a).length==0){colsSize=0}else{colsSize=parseInt(a)}if(b!=null&&(b).length==0){totalRows=0}else{totalRows=parseInt(b)}}function htmlEncode(a){return $("<div/>").text(a).html()}function funcQVDataPanelJS(a,i){rows=a;rows=Ext.decode(a);if(i!=null&&i.length==0){totalRows=0}else{totalRows=parseInt(i)}resultSet=[];subResultSet=[];var l=document.getElementById("thePage:theForm:columndetailspanel");var g=[];if(l!=null){g=GetDirectChildNodesByTagName(l,"span")}for(var f=0;totalRows>f;f++){if(rows[f]==null){break}for(var m=0;colsSize+1>m;m++){if(rows[f][m]!=null){var b=rows[f][m].dp;var e=rows[f][m].vl;var d=GetInputValueInSpan(g[b],"isHTMLFormatted");if(d=="false"){e=Ext.util.Format.htmlEncode(e)}if(resultSet[f]==null){resultSet[f]=new Array(colsSize+1)}if(Ext.isDate(Date.parseDate(e,"Y-m-d H:i:s"))){resultSet[f][b]=Date.parseDate(e,"Y-m-d H:i:s")}else{resultSet[f][b]=e}}}}if(store1!=null){store1=new Ext.data.ArrayStore({data:resultSet,fields:flds});var c=grid.getColumnModel();if(grid!=null){grid.reconfigure(store1,c)}}if(viewState=="tableView"){if(Ext.getCmp("norecords")!=null){Ext.getCmp("norecords").hide()}}}String.prototype.endsWith=function(a){return(this.match(a+"$")==a)};var arrCols=[];var columnToExpand;function addLink(f,d,a,i,e,b){var g=b.getAt(i).get(idFldDataIndex);var c=b.getAt(i).get(nameFldDataIndex);return"<a onclick=\"openTab('"+g+"', '"+escape(c)+"')\">"+f+"</a>"}function columnWrap(e,b,a,f,d,c){b.attr='style="white-space:normal !important;"';return e}function addChartLink(f,d,a,i,e,b){var g=chartDataStore.getAt(i).get(idFldDataIndex);var c=chartDataStore.getAt(i).get(nameFldDataIndex);return"<a onclick=\"openTab('"+g+"', '"+escape(c)+"')\">"+f+"</a>"}Ext.ux.PanelCollapsedTitle=(function(){var a="x-panel-header-rotated";var c=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");var b=function(){var i=((this.region=="east")||(this.region=="west"));var l="overflow: visible; padding: 0; border: none; background: none;";if(i&&c){this.collapsedHeader=this.ownerCt.layout[this.region].getCollapsedEl().createChild({tag:"div",style:"height: 100%; overflow: hidden;"});var g="http://www.w3.org/2000/svg";var f=document.createElementNS(g,"svg");this.collapsedHeader.dom.appendChild(f);f.setAttribute("width","100%");f.setAttribute("height","100%");var m=document.createElementNS(g,"text");m.setAttribute("x",6);m.setAttribute("y",1);m.setAttribute("transform","rotate(90 6 1)");m.setAttribute("class","x-panel-header "+a);f.appendChild(m);this.collapsedHeaderText=document.createTextNode(this.title);m.appendChild(this.collapsedHeaderText);var e=Ext.fly(m).getStyle("color");m.setAttribute("style",l+";fill: "+e+";")}else{var d="position: relative;";if(i){d+="white-space: nowrap; writing-mode: tb-rl; top: 1px; left: 3px;"}else{d+="top: 2px;";l+="padding-left: 4px; margin-right: 18px;"}this.collapsedHeader=this.ownerCt.layout[this.region].getCollapsedEl().createChild({tag:"div",style:l,cls:"x-panel-header "+a,html:'<span style="'+d+'">'+this.title+"</span>"});this.collapsedHeaderText=this.collapsedHeader.first()}if(this.collapsedIconCls){this.setCollapsedIconClass(this.collapsedIconCls)}};this.init=function(e){if(e.collapsible){var d=((e.region=="east")||(e.region=="west"));e.setTitle=Ext.Panel.prototype.setTitle.createSequence(function(f){if(this.rendered&&this.collapsedHeaderText){if(this.collapsedHeaderText.dom){this.collapsedHeaderText.dom.innerHTML=f}else{if(this.collapsedHeaderText.replaceData){this.collapsedHeaderText.nodeValue=f}}}});e.setCollapsedIconClass=function(g){var f=this.collapsedIconCls;this.collapsedIconCls=g;if(this.rendered&&this.collapsedHeader){var l=this.collapsedHeader,i=l.child("img.x-panel-inline-icon");if(i){if(this.collapsedIconCls){Ext.fly(i).replaceClass(f,this.collapsedIconCls)}else{Ext.fly(i).remove()}}else{if(this.collapsedIconCls){Ext.DomHelper.insertBefore(l.dom.firstChild,{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-panel-inline-icon "+this.collapsedIconCls,style:d?"display: block; margin: 1px 2px;":"margin-top: 2px; margin-right: 4px"})}}}};e.on("render",function(){if(this.ownerCt.rendered&&this.ownerCt.layout.hasLayout){b.call(e)}else{this.ownerCt.on("afterlayout",b,e,{single:true})}},e)}};return this})();function waitbox(c,b){var a=new Ext.Window({id:"waitMsgId",height:100,width:200,resizable:false,closable:false,header:false,frame:false,shadow:false,modal:true,items:[{xtype:"panel",height:100,modal:false,width:200,bodyStyle:"background-color:transparent;border:none;",html:'<div align="center"><img src="'+extJsResource+'/resources/images/default/shared/blue-loading.gif"/></div>'}]})}function showWaitbox(){if(Ext.getCmp("waitMsgId")!=null){Ext.getCmp("waitMsgId").show()}}function hideWaitbox(){if(Ext.getCmp("waitMsgId")!=null){Ext.getCmp("waitMsgId").hide()}}function GetInputValueInSpan(c,b){var a;var f=GetDirectChildNodesByTagName(c,"input");for(var d=0;d<f.length;d++){var e=f[d].id;if(e.endsWith(b)){a=f[d].value}}return a}function GetDirectChildNodesByTagName(e,d){var c=[];if(e!=null){var f=e.getElementsByTagName(d);var b=0;for(var a=0;f.length>a;a++){if(f[a].parentNode.id==e.id){c[b++]=f[a]}}}return c}function renderIcon(a){if(priorityArray[a]==null||priorityArray[a]==""){return""}else{return'<span class="clsImageA" ><img src="'+sdefStylesResource+"/SDEFimages/"+a+'"> </span>'}}function renderStatusIcon(a){if(statusArray[a]==null||statusArray[a]==""){return a}else{return'<span class="clsImageA" ><img src="'+sdefStylesResource+"/SDEFicons/"+a+'"> </span>'}}function setSortHeader(c,a){if(isSingleModuleQV=="false"){return}if(c==""||c=="null"){return}var n=document.getElementById("thePage:theForm:columndetailspanel");var l="";if(n!=null){var g=GetDirectChildNodesByTagName(n,"span");for(var f=0;f<g.length;f++){var b=GetInputValueInSpan(g[f],"columnHeader");var p=GetInputValueInSpan(g[f],"columnName").toUpperCase();if(p.match(c.toUpperCase())){var o=grid.getColumnModel();var m=o.getColumnCount();if(b.match("¬")!=-1&&b.split("¬").length>0){b=b.split("¬")[0]}for(var e=0;e<=m;e++){var d=o.getColumnHeader(e);if(d.match(b)){if(a=="DESC"){l=getSDFStylesResPath()+"/SDEFimages/arrow_sort_descending.gif"}else{l=getSDFStylesResPath()+"/SDEFimages/arrow_sort_ascending.gif"}oldColClickedHeader=b;oldColumnIndex=e;d=d+'<img style="width:13px;height:13px" src="'+l+'"/>';grid.getColumnModel().setColumnHeader(e,d);break}}break}}}}function PopulateColumnArray(){var l=true;if(isSingleModuleQV=="true"){l=false}var i=document.getElementById("thePage:theForm:columndetailspanel");var b="";if(i!=null&&i!=null){var g=GetDirectChildNodesByTagName(i,"span");arrCols=new Array(g.length);var d=1;for(var e=0;e<g.length;e++){var o=GetInputValueInSpan(g[e],"columnHeader");var f=GetInputValueInSpan(g[e],"columnWidth");var m=GetInputValueInSpan(g[e],"dataType");var n=GetInputValueInSpan(g[e],"columnName").toUpperCase();b=m=="DATE"?dateOnlyFormat:dateFormat;var a=GetInputValueInSpan(g[e],"isWrappable");if(parseInt(f)==0||f==null){columnToExpand="fld"+e}if(o.match("Id¬Id¬")){idFldDataIndex="fld"+e;arrCols[e]=new Ext.grid.Column({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,hidden:true,hideable:false,sortable:false})}else{if(o.match("¬Name")){var c=true;if(o.match("П")==null){c=false}if(e==1&&c){d=2}o=o.substring(0,o.indexOf("¬"));nameFldDataIndex="fld"+e;if(e==d){arrCols[e]=new Ext.grid.Column({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,sortable:l,hidden:c,renderer:addLink})}else{arrCols[e]=new Ext.grid.Column({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,sortable:l,hidden:c})}}else{if(m.indexOf("DATE")!=-1){if(e==d){arrCols[e]=new Ext.grid.DateColumn({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,sortable:l,format:b,hidden:false,renderer:addLink})}else{arrCols[e]=new Ext.grid.DateColumn({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,format:b,renderer:Ext.util.Format.dateRenderer(b),sortable:l,hidden:false})}}else{if(n.match("PRIORITY_ID__C")||n.match("PRIORITY__C")){arrCols[e]=new Ext.grid.Column({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,sortable:l,hidden:false,renderer:renderIcon})}else{if(n.match("STATUS__C")){arrCols[e]=new Ext.grid.Column({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,sortable:l,hidden:false,renderer:renderStatusIcon})}else{if(e==d){arrCols[e]=new Ext.grid.Column({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,sortable:l,hidden:false,renderer:addLink})}else{if(a.toLowerCase()=="true"){arrCols[e]=new Ext.grid.Column({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,sortable:l,hidden:false,renderer:columnWrap})}else{arrCols[e]=new Ext.grid.Column({id:"fld"+e,header:o,width:parseInt(f),dataIndex:"fld"+e,sortable:l,hidden:false})}}}}}}}}}return arrCols}function noRecordsMsgbox(){Ext.onReady(function(){var a=noRecordsDisplayMsg;var b=new Ext.Window({id:"norecords",height:30,width:200,resizable:false,closable:false,header:false,frame:false,modal:true,shadow:false,items:[{xtype:"panel",header:false,border:false,height:30,width:200,bodyStyle:{"background-color":"#FFFFFF","text-align":"center"},html:'<div class="noRecordDivCls">'+a+"</div>"}]});b._show=b.show;b.show=function(e,d,g){var f=Ext.getCmp("advFilter").getEl().getBottom();b.pageY=60+f;b._show(e,d,g)}})}function PopulateColumnChartArray(){var f=document.getElementById("thePage:theForm:columndetailspanel");if(f!=null&&f!=null){var e=GetDirectChildNodesByTagName(f,"span");arrCols=new Array(e.length);var b=1;for(var c=0;c<e.length;c++){var l=GetInputValueInSpan(e[c],"columnHeader");var d=GetInputValueInSpan(e[c],"columnWidth");var i=GetInputValueInSpan(e[c],"columnName").toUpperCase();var g=GetInputValueInSpan(e[c],"dataType");if(parseInt(d)==0||d==null){columnToExpand="fld"+c}if(l.match("Id¬Id¬")){idFldDataIndex="fld"+c;arrCols[c]=new Ext.grid.Column({id:"fld"+c,header:l,width:parseInt(d),dataIndex:"fld"+c,hidden:true,hideable:false,sortable:false})}else{if(l.match("¬Name")){var a=true;if(l.match("ÐŸ")==null){a=false}if(c==1&&a){b=2}l=l.substring(0,l.indexOf("¬"));nameFldDataIndex="fld"+c;if(c==b){arrCols[c]=new Ext.grid.Column({id:"fld"+c,header:l,width:parseInt(d),dataIndex:"fld"+c,sortable:true,hidden:a,renderer:addChartLink})}else{arrCols[c]=new Ext.grid.Column({id:"fld"+c,header:l,width:parseInt(d),dataIndex:"fld"+c,sortable:true,hidden:a})}}else{if(g.indexOf("DATE")!=-1){if(c==b){arrCols[c]=new Ext.grid.DateColumn({id:"fld"+c,header:l,width:parseInt(d),dataIndex:"fld"+c,sortable:allowSort,format:dateFormat,hidden:false,renderer:addLink})}else{arrCols[c]=new Ext.grid.DateColumn({id:"fld"+c,header:l,width:parseInt(d),dataIndex:"fld"+c,format:dateFormat,renderer:Ext.util.Format.dateRenderer(dateFormat),hidden:false})}}else{if(c==b){arrCols[c]=new Ext.grid.Column({id:"fld"+c,header:l,width:parseInt(d),dataIndex:"fld"+c,sortable:true,hidden:false,renderer:addChartLink})}else{if(i.match("PRIORITY_ID__C")){arrCols[c]=new Ext.grid.Column({id:"fld"+c,header:l,width:parseInt(d),dataIndex:"fld"+c,sortable:true,hidden:false,renderer:renderIcon})}else{if(i.match("STATUS__C")){arrCols[c]=new Ext.grid.Column({id:"fld"+c,header:l,width:parseInt(d),dataIndex:"fld"+c,sortable:true,hidden:false,renderer:renderStatusIcon})}else{arrCols[c]=new Ext.grid.Column({id:"fld"+c,header:l,width:parseInt(d),dataIndex:"fld"+c,sortable:true,hidden:false})}}}}}}}}return arrCols}var chartDataResultSet=[];function sortEventsByDate(e){var d=e;var f=d.length;for(var c=1;c<f;c++){for(var b=0;b<f-c;b++){if(d[b].start>d[b+1].start){var a=d[b];d[b]=d[b+1];d[b+1]=a}}}return d}function renderChartJS(g,f){var e,a;var d,c;if(chartDisplayed){if(w=="undefined"||w==null||w==""){w=335}if(h=="undefined"||h==null||h==""){h=335}a=h-96;e=w-20;d=e.toString();c=a.toString();f=f+"?ChartNoDataText="+noRecordsDisplayMsg;var b=new FusionCharts(f,"myChartId",d,c,"0","1");b.setDataXML(g);b.setTransparent(true);if(document.getElementById("chartView")!=null){b.render("chartView")}}}function initCalendarView(){var b=new Date();var e=b.getDate();var a=b.getMonth();var f=b.getFullYear();var c=new Array(3);$("#monthview").fullCalendar({defaultView:"month",header:{left:"",center:"prev,title,next",right:""},editable:false,events:getEventsArr(),eventClick:function(l,g,d){if(l.dataSource.toLowerCase()=="bmc_businessservice__c"||l.dataSource.toLowerCase()=="bmc_baseelement__c"){window.parent.parent.CMDB_RecordID=l.srcFunction;window.parent.parent.addNewTab("CMDBManager","Configuration Items","NavigatorPage?tabName=Configuration Items&target=CMDBManager?id=1010");return false}var i=l.srcFunction.split(",");if(idArrayMap[l.srcFunction.split(",")[0]]!=null){arrayMapObj=idArrayMap[l.srcFunction.split(",")[0]]}else{arrayMapObj=[]}if(window.parent.parent.setIdArray!=undefined&&typeof(window.parent.parent.setIdArray)=="function"){window.parent.parent.setIdArray(arrayMapObj)}i[2]=i[2]+escape("&isDirect=true&columnField=Name&direction=ASC");window.parent.parent.addNewTab(i[0],i[1],i[2]);return false},viewDisplay:function(){var d=$("#monthview").fullCalendar("getView");setStartDate($.fullCalendar.formatDate(d.visStart,"u")+"");setEndDate($.fullCalendar.formatDate(d.visEnd,"u")+"");if((storestartdate!=d.visStart)||(!isRefreshed)||(isSwitched)){storestartdate=d.visStart;isRefreshed=true;isSwitched=false;showWaitbox();loadResultSet()}},windowResize:function(){$("#monthview").fullCalendar("render");$("#monthview").fullCalendar("refetchEvents")}});$("#weekview").fullCalendar({defaultView:"basicWeek",header:{left:"",center:"prev,title,next",right:""},editable:false,events:getEventsArr(),eventClick:function(p,g,d){if(p.dataSource.toLowerCase()=="bmc_businessservice__c"||p.dataSource.toLowerCase()=="bmc_baseelement__c"){window.parent.parent.CMDB_RecordID=p.srcFunction;window.parent.parent.addNewTab("CMDBManager","Configuration Items","NavigatorPage?tabName=Configuration Items&target=CMDBManager?id=1010");return false}var o=p.srcFunction.split(",");var n=[];var m=sortEventsByDate(getEventsArr());for(var l=0;l<m.length;l++){if(m[l].srcFunction.split(",")[0]==p.srcFunction.split(",")[0]){n[l]=m[l].srcFunction.split(",")[2].split("id=")[1]}}if(window.parent.parent.setIdArray!=undefined&&typeof(window.parent.parent.setIdArray)=="function"){window.parent.parent.setIdArray(n)}o[2]=o[2]+escape("&isDirect=true&columnField=Name&direction=ASC");window.parent.parent.addNewTab(o[0],o[1],o[2]);return false},viewDisplay:function(){var d=$("#weekview").fullCalendar("getView");setStartDate($.fullCalendar.formatDate(d.visStart,"u")+"");setEndDate($.fullCalendar.formatDate(d.visEnd,"u")+"");if((storestartdate!=d.visStart)||(!isRefreshed)||(isSwitched)){storestartdate=d.visStart;isRefreshed=true;isSwitched=false;showWaitbox();loadResultSet()}},windowResize:function(){$("#weekview").fullCalendar("render");$("#weekview").fullCalendar("refetchEvents")}});$("#dayview").fullCalendar({defaultView:"basicDay",header:{left:"",center:"prev,title,next",right:""},editable:false,events:getEventsArr(),eventClick:function(p,g,d){if(p.dataSource.toLowerCase()=="bmc_businessservice__c"||p.dataSource.toLowerCase()=="bmc_baseelement__c"){window.parent.parent.CMDB_RecordID=p.srcFunction;window.parent.parent.addNewTab("CMDBManager","Configuration Items","NavigatorPage?tabName=Configuration Items&target=CMDBManager?id=1010");return false}var o=p.srcFunction.split(",");var n=[];var m=sortEventsByDate(getEventsArr());for(var l=0;l<m.length;l++){if(m[l].srcFunction.split(",")[0]==p.srcFunction.split(",")[0]){n[l]=m[l].srcFunction.split(",")[2].split("id=")[1]}}if(window.parent.parent.setIdArray!=undefined&&typeof(window.parent.parent.setIdArray)=="function"){window.parent.parent.setIdArray(n)}o[2]=o[2]+escape("&isDirect=true&columnField=Name&direction=ASC");window.parent.parent.addNewTab(o[0],o[1],o[2]);return false},viewDisplay:function(){var d=$("#dayview").fullCalendar("getView");setStartDate($.fullCalendar.formatDate(d.visStart,"u")+"");setEndDate($.fullCalendar.formatDate(d.visEnd,"u")+"");if((storestartdate!=d.visStart)||(!isRefreshed)||(isSwitched)){storestartdate=d.visStart;isRefreshed=true;isSwitched=false;showWaitbox();loadResultSet()}},windowResize:function(){$("#dayview").fullCalendar("render");$("#dayview").fullCalendar("refetchEvents")}})}function getNodeValue(d){var e="";var c=0;var a=nodePopupIdsStr.split("П");for(c=0;c<a.length;c++){var b=a[c].split("¬");if(b[0]==d){e=b[1];break}}return e}function createNewTab(a){nodeValue=getNodeValue(a);if(isRowClicked){globalURL=globalURL+escape("&isDirect=true&columnField=Name&direction=ASC");isRowClicked=false}window.parent.parent.addNewTab(globalPageName,nodeValue,globalURL)}function renderGridJS(b,f){var l=PopulateColumnArray();store1=new Ext.data.ArrayStore({data:resultSet,fields:flds});var a=new Ext.grid.ColumnModel({defaults:{sortable:false},columns:l});grid=new Ext.grid.GridPanel({cls:"QVGridPanelcls",id:"QVGridPanel",store:store1,border:false,columnLines:true,colModel:a,sm:new Ext.grid.RowSelectionModel({singleSelect:true}),border:true,viewConfig:{getRowClass:function(i,n){var m=i.get(idFldDataIndex);m=m.split(",");if(m[2]!=""&&m[2]!=null){var p="css"+String(m[2]).replace("#","");if(Ext.get(p)==null){var o="."+p+" { background-color: "+m[2]+"; }";Ext.util.CSS.createStyleSheet(o,p)}return p}},emptyText:noRecordsDisplayMsg,deferEmptyText:false},listeners:{rowdblclick:function(i,n,m){isRowClicked=true;i.getView().refresh(true);openTab(i.store.getAt(selectedRowIndex).get(idFldDataIndex),i.store.getAt(selectedRowIndex).get(nameFldDataIndex))},rowclick:function(p,s,r){selectedRowIndex=s;var q=[];var n=p.store.getAt(selectedRowIndex).get(idFldDataIndex).split(",")[5];for(var o=0;o<p.store.getCount();o++){if(n==p.store.getAt(o).get(idFldDataIndex).split(",")[5]){q[o]=p.store.getAt(o).get(idFldDataIndex).split(",")[0]}}if(typeof(window.parent.parent.setIdArray)=="function"){window.parent.parent.setIdArray(q)}if(!isCreateable(n.toLowerCase())||n.toLowerCase()=="incident_service_target__c"||n.toLowerCase()=="change_request_service_target__c"||n.toLowerCase()=="bmc_businessservice__c"||n.toLowerCase()=="bmc_baseelement__c"||n.toLowerCase()=="change_assessment__c"){Ext.getCmp("qvcopyId").setIconClass("bmcCopyDisable");Ext.getCmp("qvcopyId").setDisabled(true)}else{if(selectedRowIndex!=null){Ext.getCmp("qvcopyId").setIconClass("bmcCopy");Ext.getCmp("qvcopyId").setDisabled(false)}}if(!isDeletable(n.toLowerCase())||n.toLowerCase()=="incident_service_target__c"||n.toLowerCase()=="change_request_service_target__c"||n.toLowerCase()=="bmc_businessservice__c"||n.toLowerCase()=="bmc_baseelement__c"||n.toLowerCase()=="change_assessment__c"){Ext.getCmp("qvdeleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("qvdeleteId").setDisabled(true)}else{if(selectedRowIndex!=null){Ext.getCmp("qvdeleteId").setIconClass("bmcDelete");Ext.getCmp("qvdeleteId").setDisabled(false)}}var m=p.store.getAt(selectedRowIndex);recordDetails=m.get(idFldDataIndex);recordDetails=recordDetails.split(",");if(recordDetails[5]=="Task__c"||recordDetails[5]=="Broadcasts__c"||recordDetails[5]=="Incident__c"){Ext.getCmp("assignedToId").disabled=false}}}});grid.on("headerclick",function(i,p,o){if(isSingleModuleQV=="false"){return}if(oldColClickedHeader!=null&&oldColClickedHeader!=""){i.getColumnModel().setColumnHeader(oldColumnIndex,oldColClickedHeader)}var s=i.getColumnModel().getColumnHeader(p);var u=document.getElementById("thePage:theForm:columndetailspanel");var r="";if(u!=null){var q=GetDirectChildNodesByTagName(u,"span");for(var n=0;n<q.length;n++){var y=GetInputValueInSpan(q[n],"columnHeader");var x=GetInputValueInSpan(q[n],"columnName").toUpperCase();var v=GetInputValueInSpan(q[n],"dataType");var m=GetInputValueInSpan(q[n],"isColSortable");if(y.match(s)){if(m.toLowerCase()=="false"||String(v).toUpperCase().match("BASE64")||String(v).toUpperCase().match("TEXTAREA")||String(v).toUpperCase().match("MULTIPICKLIST")){return}colClickSchemaName=x;if(sortOrder=="DESC"){r=getSDFStylesResPath()+"/SDEFimages/arrow_sort_ascending.gif";sortOrder="ASC"}else{r=getSDFStylesResPath()+"/SDEFimages/arrow_sort_descending.gif";sortOrder="DESC"}oldColClickedHeader=s;oldColumnIndex=p;s=s+'<img style="width:13px;height:13px" src="'+r+'"/>';i.getColumnModel().setColumnHeader(p,s);showWaitbox();handleColumnClick(colClickSchemaName,sortOrder);break}}return}});if(isSingleModuleQV=="false"){grid.enableHdMenu=true;grid.getColumnModel().sortable=true}else{grid.enableHdMenu=false}var e=grid.getColumnModel();if(l!=null&&l!=""){for(var d=0;d<b.length;d++){var g=b[d];var c=e.findColumnIndex(g.colId);e.setColumnWidth(c,g.colWidth,false);e.setHidden(c,g.isColHidden);if(c!=parseInt(g.colPosition)){e.moveColumn(c,parseInt(g.colPosition))}}}if(isSingleModuleQV=="false"&&f.split("dir").length>0){grid.store.sort(e.findColumnIndex(f.split("dir")[0]),f.split("dir")[1])}if(columnToExpand!=null){grid.autoExpandColumn=columnToExpand}}function extInitJS(b,d,a,c){renderGrid();if(!b&&!c&&window.parent.parent.getSDActiveTabId()=="mydashboard"&&isSingleModuleQV=="false"&&viewState=="tableView"){Ext.Msg.alert(d,a)}}function showTableViewJS(b,a){if(Ext.getCmp("slidersMenu")){Ext.getCmp("slidersMenu").hide()}if(Ext.getCmp("norecords")!=null){Ext.getCmp("norecords").hide()}viewState="tableView";setWidgetViewState(viewState);if(Ext.getCmp("imgId")!=null){Ext.getCmp("imgId").hide()}window.parent.parent.setQVWidgetViews(b,"tableView");if(Ext.getCmp("chartViewPanel")!=null){Ext.getCmp("chartViewPanel").hide()}if(isSingleModuleQV=="true"){if(Ext.getCmp("legendPanelId")!=null){Ext.getCmp("legendPanelId").hide()}if(Ext.getCmp("qvPageControlPanel")!=null){Ext.getCmp("qvPageControlPanel").show()}}if(Ext.getCmp("calendarViewPanel")!=null){Ext.getCmp("calendarViewPanel").hide()}if(Ext.getCmp("calendarViewPanel")!=null){Ext.getCmp("calendarViewPanel").hide()}if(Ext.getCmp("QVGridPanel")!=null){Ext.getCmp("QVGridPanel").show();Ext.getCmp("QVGridPanel").doLayout()}if(a!="undefined"){showWaitbox();loadResultSet()}}function showChartViewJS(c,a,b){if(Ext.getCmp("norecords")!=null){Ext.getCmp("norecords").hide()}viewState="chartView";setWidgetViewState(viewState);if(Ext.getCmp("legendPanelId")!=null){Ext.getCmp("legendPanelId").show()}if(Ext.getCmp("imgId")!=null){Ext.getCmp("imgId").hide()}window.parent.parent.setQVWidgetViews(c,"chartView");if(Ext.getCmp("QVGridPanel")!=null){Ext.getCmp("QVGridPanel").hide()}if(Ext.getCmp("calendarViewPanel")!=null){Ext.getCmp("calendarViewPanel").hide()}if(Ext.getCmp("qvPageControlPanel")!=null){Ext.getCmp("qvPageControlPanel").hide()}if(Ext.getCmp("chartViewPanel")!=null){Ext.getCmp("chartViewPanel").show()}if(b!="undefined"){showWaitbox();loadResultSet()}refreshChart=false}function showCalendarViewJS(a){isSwitched=true;if(Ext.getCmp("norecords")!=null){Ext.getCmp("norecords").hide()}viewState="calendarView";setWidgetViewState(viewState);if(Ext.getCmp("legendPanelId")!=null){Ext.getCmp("legendPanelId").show()}if(Ext.getCmp("imgId")!=null){Ext.getCmp("imgId").show()}if(Ext.getCmp("QVGridPanel")!=null){Ext.getCmp("QVGridPanel").hide()}if(Ext.getCmp("chartViewPanel")!=null){Ext.getCmp("chartViewPanel").hide()}if(Ext.getCmp("qvPageControlPanel")!=null){Ext.getCmp("qvPageControlPanel").hide()}showCalendar(true);refreshCalendar=false}function showCalendar(a){if(Ext.getCmp("calendarViewPanel")!=null){Ext.getCmp("calendarViewPanel").show();if(calView=="Month"){showView(0)}else{if(calView=="Week"){showView(1)}else{if(calView=="Day"){showView(2)}else{showView(0)}}}}}var legWinX;var legWinY;function openLegendPopup(){legendPopup=new Ext.Window({constrain:true,minWidth:100,minHeight:100,maximizable:false,minimizable:false,resizable:false,closable:false,border:true,id:"legendPopupId",x:legWinX,y:legWinY,cls:"popupWindowCls",shadow:false,disabled:false,frame:false,closeAction:"hide",contentEl:"popupContents"});legendPopup.show();legendPopup.setPosition(legWinX,legWinY-legendPopup.getHeight()-2)}function closeLegendPopup(){legendPopup.hide()}var setPos=function(){legWinX=self.innerWidth;legWinY=self.innerHeight};function refreshFun(){var f=0;var m="";var p=false;var o=Ext.getCmp("advFilterGridpanel").store;while(o.data.length>f){var a=o.getAt(f).get("queryCondId");var c;var g="";var n=false;var b="";if(o.getAt(f).get("type")=="lookUp"){var d=o.getAt(f).get("extraInfo").split(",")[2];c=d+"";g=o.getAt(f).get("extraInfo").split(",")[1];n=true}else{if(o.getAt(f).get("type")=="date"){if(o.getAt(f).get("value")!=""&&o.getAt(f).get("value")!=null){if(typeof(o.getAt(f).get("value"))=="object"){c=ConvertUTCtoGMT(o.getAt(f).get("value").toUTCString())}else{c=ConvertUTCtoGMT(o.getAt(f).get("value")+"")}}}else{c=o.getAt(f).get("value")+""}}b=o.getAt(f).get("extraInfo").split(",")[3];if((b.toLowerCase()=="ownerid"||b.toLowerCase()=="fkopenby__c"||b.toLowerCase()=="fkstaff__c")&&o.getAt(f).get("type")=="ASSIGNEDTO_FIELD"&&(o.getAt(f).get("value")!="Me"&&o.getAt(f).get("value")!="My Queues")){var d=o.getAt(f).get("extraInfo").split(",")[2];c=d+"";g=o.getAt(f).get("extraInfo").split(",")[1];n=true}m=m+a+"¬"+c+"¬"+g+"¬"+n+"¬"+b+"¬П";if(c==null||c.trim()==""||c=="null"){p=true;break}f++}if(!p){document.getElementById("thePage:theForm:filterStr").value=m}try{persistState();showWaitbox();loadResultSet()}catch(l){}}function refreshBtnHandlerJS(a){isRefreshed=true;if(a){try{refreshFun()}catch(b){}}else{try{persistState();showWaitbox();loadResultSet()}catch(b){}}}function refreshWindowJS(a){if(a){try{refreshFun()}catch(b){}}else{try{persistState();showWaitbox();loadResultSet()}catch(b){}}}function displayNameField(){var a=advFilterGrid.store.getAt(selectedGridRowIndex);a.set("value","");a.set("value",filterStrLookupNameFld)}function filterRecords(o){var l=colsSize+2;var a=Ext.getCmp("activeItems");var p=Ext.getCmp("inactiveItems");var q=Ext.getCmp("openItems");var n=Ext.getCmp("closedItems");var e=[];var c=0;while(o.length>c){e.push(o[c]);c++}var f=0;var m;while(o.length>f){m=false;var d=0;var g="";while(l>d){g=g+","+o[f][d];d++}resultSetRecord=g.split(",");var r=false;var b=false;if(a.checked==false&&p.checked==false&&q.checked==false&&n.checked==false){m=true;f++;continue}if((((a.checked==true&&resultSetRecord[4]=="false")||(p.checked==true&&resultSetRecord[4]=="true"))||(a.checked==false&&p.checked==false))==true){r=true}if((((q.checked==true&&resultSetRecord[5]=="true")||(n.checked==true&&resultSetRecord[5]=="false"))||(q.checked==false&&n.checked==false))==true){b=true}m=r&&b;if(m==false){c=0;while(e.length>c){if(e[c]==o[f]){e.splice(c,1);break}c++}}f++}return e}var filterRecordsHandler=function(){document.getElementById("thePage:theForm:opened").value=Ext.getCmp("openItems").checked;document.getElementById("thePage:theForm:closed").value=Ext.getCmp("closedItems").checked;document.getElementById("thePage:theForm:active").value=Ext.getCmp("activeItems").checked;document.getElementById("thePage:theForm:inactive").value=Ext.getCmp("inactiveItems").checked;showWaitbox();loadResultSet()};function assignTOQueue(a){document.getElementById("thePage:theForm:groupId").value=a;assignTOQueueFun()}var AssignToQueueHandler=function(c,e){var a=grid.store.getAt(selectedRowIndex);var d=a.get(idFldDataIndex);d=d.split(",");var b=d[0]+"¬"+d[5]+"¬";document.getElementById("thePage:theForm:recordToAssign").value=b;window.parent.openPopup("QueueListPage?sObjectType="+d[5],assignTOQueue)};function assignToSuggestedStaff(a){document.getElementById("thePage:theForm:staffId").value=a;assignToSuggestedStaffFun()}var AssignToSuggestedStaffHandler=function(c,e){var a=grid.store.getAt(selectedRowIndex);var d=a.get(idFldDataIndex);d=d.split(",");var b=d[0]+"¬"+d[5]+"¬";document.getElementById("thePage:theForm:recordToAssign").value=b;window.parent.openPopup("SearchPage?popupId=SuggestedStaff&isLookup=true&isActiveUser=true&categoryId="+d[6],assignToSuggestedStaff)};function assignToStaff(a){document.getElementById("thePage:theForm:staffId").value=a;assignToStaffFun()}var AssignedToStaffBtnHandler=function(c,e){var a=grid.store.getAt(selectedRowIndex);var d=a.get(idFldDataIndex);d=d.split(",");var b=d[0]+"¬"+d[5]+"¬";document.getElementById("thePage:theForm:recordToAssign").value=b;window.parent.openPopup("SearchPage?popupId=Client&isLookup=true",assignToStaff)};var AssignedToMyselfBtnHandler=function(c,e){var a=grid.store.getAt(selectedRowIndex);var d=a.get(idFldDataIndex);d=d.split(",");var b=d[0]+"¬"+d[5]+"¬";document.getElementById("thePage:theForm:recordToAssign").value=b;assignToMySelf()};function openTab(g,n){isRowClicked=true;var f=g.split(",");var b=f[0];var l=f[1];var m=l;var a;for(var e=0;e<objectLabelNameList.length;e++){if(objectLabelNameList[e][1]==f[5]){a=objectLabelNameList[e][0];if(f[5]=="Task__c"||f[5]=="task__c"||f[5]=="incident__c"||f[5]=="Incident__c"||f[5]=="broadcasts__c"||f[5]=="Broadcasts__c"){n="%23"+n;url="NavigatorPage?title="+n+"&target="+l+"?id="+b}else{if(f[5]=="BMC_BusinessService__c"||f[5].toLowerCase()=="bmc_baseelement__c"){window.parent.parent.CMDB_RecordID=b;var d=window.parent.parent.CMDBManagerWin;if(d&&d.CheckAndOpenInstance){d.CheckAndOpenInstance()}if(stdLayoutFlag!=null&&stdLayoutFlag!="undefined"&&stdLayoutFlag!=""&&(stdLayoutFlag=="true"||stdLayoutFlag=="true")){window.parent.parent.addNewTab("CMDBManager",configurationPageTitle,"NavigatorPage?tabName=Configuration Items&target=CMDBManager?recId="+b+"&id=1010")}else{window.parent.parent.addNewTab("CMDBManager",configurationPageTitle,"NavigatorPage?tabName=Configuration Items&target=CMDBManager?id=1010")}return}else{var c=escape(n);n=objectLabelNameList[e][0];var o=dynamicLocalizationForQuickViews(n);url="NavigatorPage?title="+o+"&tabTitle="+c+"&target="+l+"?id="+b}}}}globalPageName=l;globalURL=url;document.getElementById("thePage:theForm:popupId").value=a;createNewTab(a)}function getMenuForNewBtn(){newBtnMenu=[];for(var b=0;b<objectLabelNameList.length;b++){if(objectLabelNameList[b][1].toLowerCase()=="incident_service_target__c"||objectLabelNameList[b][1].toLowerCase()=="change_request_service_target__c"||objectLabelNameList[b][1].toLowerCase()=="bmc_businessservice__c"||objectLabelNameList[b][1].toLowerCase()=="bmc_baseelement__c"){continue}var c=objectLabelNameList[b];var d=objectLabelNameList[b][0].toLowerCase();var a={text:objectLabelNameList[b][0],pageName:objectLabelNameList[b][2],objectAPIName:objectLabelNameList[b][1],objectName:objectLabelNameList[b][2],id:"NewBtn-"+d,handler:function(f){if(f.pageName==null||f.pageName==""){showMessage(showMsgQV1Label)}else{var g=f.text;var i=f.objectAPIName;g=dynamicLocalizationForQuickViews(g);var e="NavigatorPage?title="+g+"&ObjectAPIName="+i+"&target="+f.pageName;globalURL=e;globalPageName=f.pageName;document.getElementById("thePage:theForm:popupId").value=f.text;createNewTab(f.text)}}};if(!isCreateable(objectLabelNameList[b][1].toLowerCase())||objectLabelNameList[b][1].toLowerCase()=="change_assessment__c"){a.disabled=true;a.iconClass="bmcNewDisable"}newBtnMenu.push(a)}}var CopyBtnHandler=function(f,b){var g=grid.store.getAt(selectedRowIndex);var l=g.get(idFldDataIndex);l=l.split(",");var d=l[0];var m=l[1];var n=m;var c;for(var e=0;e<objectLabelNameList.length;e++){if(objectLabelNameList[e][1]==l[5]){c=objectLabelNameList[e][0];n=objectLabelNameList[e][0];nameFld=n;n=n+"s"}}var o=nameFld;o=dynamicLocalizationForQuickViews(o);var a="NavigatorPage?title="+o+"&target="+m+"?copyId="+d;document.getElementById("thePage:theForm:popupId").value=c;globalURL=a;globalPageName=m;createNewTab(c)};function deleteBtnHandlerJS(b,e){var a=grid.store.getAt(selectedRowIndex);var d=a.get(idFldDataIndex);d=d.split(",");var c=d[0]+"¬"+d[5]+"¬";document.getElementById("thePage:theForm:recordForDelete").value=c;Ext.MessageBox.confirm(b,e,function(f){if(f=="yes"){deleteRecord()}if(Ext.isIE8&&IEVersion==8){window.resizeTo(document.body.clientWidth-1,document.body.clientHeight)}});if(Ext.isIE8&&IEVersion==8){window.resizeTo(document.body.clientWidth+1,document.body.clientHeight)}}function displayToolBar(){btnToolBar=new Ext.Toolbar({id:"toolBar",renderTo:"btnToolBarDiv",title:"",height:35,cls:"toolSpCls",border:false,bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"});var a;if(isSingleModuleQV=="true"){a=new Ext.Button({scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:newLabel,id:"qvnewId",tabLabel:objectLabelNameList[0][0],objectName:objectLabelNameList[0][1],pageName:objectLabelNameList[0][2],handler:function(u){if(u.pageName==null||u.pageName==""){showMessage(showMsgQV1Label)}else{var v=u.tabLabel;var x=u.objectName;v=dynamicLocalizationForQuickViews(v);var i="NavigatorPage?title="+v+"&ObjectAPIName="+x+"&target="+u.pageName;globalPageName=u.pageName;globalURL=i;document.getElementById("thePage:theForm:popupId").value=u.tabLabel;createNewTab(u.tabLabel)}}});if(!isCreateable(objectLabelNameList[0][1].toLowerCase())||objectLabelNameList[0][1].toLowerCase()=="incident_service_target__c"||objectLabelNameList[0][1].toLowerCase()=="change_request_service_target__c"||objectLabelNameList[0][1].toLowerCase()=="bmc_businessservice__c"||objectLabelNameList[0][1].toLowerCase()=="bmc_baseelement__c"||objectLabelNameList[0][1].toLowerCase()=="change_assessment__c"){a.setIconClass("bmcNewDisable");a.setDisabled(true)}}else{a=new Ext.Button({scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:newLabel,id:"qvnewId",menu:new Ext.menu.Menu({shadow:false,items:[newBtnMenu]})})}btnToolBar.add(a);btnToolBar.add({xtype:"spacer",width:2});var n=new Ext.Button({scale:"medium",iconCls:"bmcCopyDisable",disabled:true,tooltipType:"title",tooltip:copyLabel,id:"qvcopyId",disabledClass:{cursor:"hand"},handler:CopyBtnHandler});btnToolBar.add(n);btnToolBar.add({xtype:"spacer",width:2});var c=new Ext.Button({scale:"medium",iconCls:"bmcDeleteDisable",tooltipType:"title",disabled:true,tooltip:deleteLabel,id:"qvdeleteId",disabledClass:{cursor:"hand"},handler:deleteBtnHandler});btnToolBar.add(c);btnToolBar.add({xtype:"spacer",width:2});var r=new Ext.Button({text:"",id:"refreshButtonId",handler:refreshBtnHandler,scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:refreshLabel});btnToolBar.add(r);btnToolBar.add({xtype:"spacer",width:2});btnToolBar.add("-");btnToolBar.add({xtype:"spacer",width:2});var o=new Ext.Button({scale:"medium",iconCls:"bmcView1",tooltipType:"title",tooltip:viewsLabel,id:"viewId",menu:[{text:tableLabel,id:"tableViewBtn",handler:showTableView,checked:false,group:"sBtnItemGroup"},{text:chartLabel,id:"chartViewBtn",handler:showChartView,checked:false,group:"sBtnItemGroup"},{text:calendarLabel,id:"calendarViewBtn",handler:showCalendarView,checked:false,group:"sBtnItemGroup"},"-",{xtype:"checkbox",id:"openItems",group:"soptg",checked:true,boxLabel:openItemsLabel},{xtype:"checkbox",id:"closedItems",group:"soptg",checked:false,boxLabel:closedItemsLabel},{xtype:"checkbox",id:"activeItems",group:"soptg",checked:true,boxLabel:activeItemsLabel},{xtype:"checkbox",id:"inactiveItems",group:"soptg",checked:false,boxLabel:inactiveItemsLabel},"-",{text:applyLabel,iconCls:"mnuList",handler:filterRecordsHandler}]});btnToolBar.add(o);btnToolBar.add({xtype:"spacer",width:2});var m=true;for(var e=0;e<objectLabelNameList.length;e++){if((objectLabelNameList[e][0]=="Task"||objectLabelNameList[e][0]=="task")||(objectLabelNameList[e][0]=="Incident"||objectLabelNameList[e][0]=="incident")||(objectLabelNameList[e][0]=="Broadcasts"||objectLabelNameList[e][0]=="broadcasts")){m=false}}var s=new Ext.Button({scale:"medium",iconCls:"bmcAssign1",disabled:true,tooltip:assignToLabel,id:"assignedToId",menu:[{text:staffWindowHeaderSearchPageLabel,icon:sdefStylesResource+"/_.GIF",id:"assignToStaffButtonId",listeners:{render:function(i){i.el.on("click",AssignedToStaffBtnHandler)}}},{text:incidentsSuggestedStaffLabel,icon:sdefStylesResource+"/_.GIF",id:"assignToSuggestedStaffButtonId",listeners:{render:function(i){i.el.on("click",AssignToSuggestedStaffHandler)}}},{text:incidentMyselfLabel,icon:sdefStylesResource+"/_.GIF",id:"assignToMyselfButtonId",listeners:{render:function(i){i.el.on("click",AssignedToMyselfBtnHandler)}}},{text:incidentMemberofLabel+profileName,id:"assignToMemberOfAdminButtonId",disabled:true,icon:sdefStylesResource+"/_.GIF"},{text:queueLabel,icon:sdefStylesResource+"/_.GIF",id:"assignToQueueButtonId",listeners:{render:function(i){i.el.on("click",AssignToQueueHandler)}}},{text:selectedProfilesLabel,id:"assignToSelectedProfileButtonId",icon:sdefStylesResource+"/_.GIF",hidden:true},{text:clearAssignTo,id:"ClearAssignToButton",icon:sdefStylesResource+"/_.GIF",listeners:{render:function(i){}},hidden:true}]});var d=new Ext.Button({scale:"medium",iconCls:"bmcAction1",disabled:true,tooltip:actionsLabel,menu:[]});var l=new Ext.Toolbar.Fill();btnToolBar.add(l);var q=new Ext.form.Label({id:"refreshIntervalLabel",style:{marginRight:"5px"},text:refreshMinLabel});btnToolBar.add(q);var b=new Ext.form.TextField({id:"refreshInterval",allowDecimals:false,allowNegative:false,maxValue:999,disabled:isRefreshBtnState,value:DEFAULT_INTERVAL,width:"27",enableKeyEvents:true,maxLength:3,maskRe:/[0-9]/,autoCreate:{tag:"input",type:"text",size:"27",autocomplete:"off",maxlength:"3"},filterKeys:function(u){var i=u.getKey();if(Ext.isGecko&&(u.isNavKeyPress()||i==u.BACKSPACE||(i==u.DELETE&&u.button==-1))){return}var v=u.getCharCode();cc=String.fromCharCode(v);if(!Ext.isGecko&&u.isSpecialKey()&&!cc){return}if(!this.maskRe.test(cc)){u.stopEvent()}},listeners:{blur:function(i){if(!isWholeNo(i.getValue())){i.setValue("0")}}}});btnToolBar.add(b);btnToolBar.add({xtype:"spacer",width:2});var f=new Ext.Button({scale:"medium",iconCls:imageCls,disabled:false,enableToggle:true,pressed:isRefreshBtnState,toggleHandler:function(i,u){if(u){Ext.getCmp("autoRefreshId").setIconClass("auto-refresh-off");Ext.getCmp("refreshInterval").setDisabled(true);Ext.getCmp("autoRefreshId").setTooltip(toolTipAutoRefreshOFF);autoRefreshable=false}else{Ext.getCmp("autoRefreshId").setIconClass("auto-refresh-on");Ext.getCmp("refreshInterval").setDisabled(false);Ext.getCmp("autoRefreshId").setTooltip(toolTipAutoRefreshON);autoRefreshable=true}createCookie()},tooltipType:"title",tooltip:toolTipRefreshBtn,id:"autoRefreshId",disabledClass:{cursor:"hand"}});btnToolBar.add(f);btnToolBar.add({xtype:"spacer",width:1});var p=new Ext.form.Label({id:"refreshed",style:{marginLeft:"5px"},text:lastRefreshedLabel+lastRefreshed});btnToolBar.add(p);btnToolBar.add({xtype:"spacer",width:1});var g=new Ext.Button({scale:"medium",iconCls:"d-icon-gear sliderButtonIcon",tooltipType:"title",tooltip:"",id:"slidersMenu",hidden:true,listeners:{menuhide:function(u,v){var i=Ext.util.Cookies.get(chartSpecsCookie);var x={};if(i){x=JSON.parse(i)}if(QVchart.options){x.alpha=QVchart.options.chart.options3d.alpha;x.beta=QVchart.options.chart.options3d.beta;x.depth=QVchart.options.chart.options3d.depth;i=JSON.stringify(x);document.cookie=chartSpecsCookie+"="+i+";path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString()}}},menu:[{xtype:"slider",fieldLabel:"Alpha",labelWidth:40,width:250,value:0,increment:1,minValue:0,maxValue:45,id:"alphaSlider",group:"3dsliders",listeners:{change:function(v,x,i,u){if(QVchart.options){QVchart.options.chart.options3d.alpha=parseFloat(x);QVchart.redraw(false);Ext.getCmp("alphaValueLabel").setText(x)}}}},{xtype:"tbspacer"},{xtype:"tbspacer"},{xtype:"label",flex:3,id:"alphaValueLabel",html:"0"},{xtype:"slider",fieldLabel:"Beta",labelStyle:"width:50px",width:250,value:0,increment:1,minValue:-45,maxValue:45,id:"betaSlider",group:"3dsliders",listeners:{change:function(v,x,i,u){if(QVchart.options){QVchart.options.chart.options3d.beta=parseFloat(x);QVchart.redraw(false);Ext.getCmp("betaValueLabel").setText(x)}}}},{xtype:"tbspacer"},{xtype:"tbspacer"},{xtype:"label",flex:3,id:"betaValueLabel",html:"0"},{xtype:"slider",fieldLabel:"Depth",labelStyle:"width:50px",width:250,value:20,increment:1,minValue:20,maxValue:100,id:"depthSlider",group:"3dsliders",listeners:{change:function(v,x,i,u){if(QVchart.options){QVchart.options.chart.options3d.depth=parseFloat(x);QVchart.redraw(false);Ext.getCmp("depthValueLabel").setText(x)}}}},{xtype:"tbspacer"},{xtype:"tbspacer"},{xtype:"label",flex:3,id:"depthValueLabel",html:"20"}]});if(!useDeprecatedFusionCharts){btnToolBar.add(g)}btnToolBar.doLayout()}function showdiv(a){document.getElementById(a).style.display="block"}function hidediv(a){document.getElementById(a).style.display="none"}function showView(a){if(a==0){Ext.getCmp("dayViewPanel").hide();Ext.getCmp("weekViewPanel").hide();Ext.getCmp("monthViewPanel").hide();Ext.getCmp("monthViewPanel").show();calView="Month";if(Ext.getCmp("comboPanelId")!=null){Ext.getCmp("comboPanelId").setValue(calView)}document.getElementById(calViewComponentId).value="Month";$("#monthview").fullCalendar("removeEvents");$("#monthview").fullCalendar("addEventSource",getEventsArr());$("#monthview").fullCalendar("refetchEvents")}if(a==1){Ext.getCmp("monthViewPanel").hide();Ext.getCmp("dayViewPanel").hide();Ext.getCmp("weekViewPanel").hide();Ext.getCmp("weekViewPanel").show();calView="Week";if(Ext.getCmp("comboPanelId")!=null){Ext.getCmp("comboPanelId").setValue(calView)}document.getElementById(calViewComponentId).value="Week";$("#weekview").fullCalendar("removeEvents");$("#weekview").fullCalendar("addEventSource",getEventsArr());$("#weekview").fullCalendar("refetchEvents")}if(a==2){Ext.getCmp("monthViewPanel").hide();Ext.getCmp("weekViewPanel").hide();Ext.getCmp("dayViewPanel").hide();Ext.getCmp("dayViewPanel").show();calView="Day";if(Ext.getCmp("comboPanelId")!=null){Ext.getCmp("comboPanelId").setValue(calView)}document.getElementById(calViewComponentId).value="Day";$("#dayview").fullCalendar("removeEvents");$("#dayview").fullCalendar("addEventSource",getEventsArr());$("#dayview").fullCalendar("refetchEvents")}}function setCtlVal(a,b){if(document.getElementById(a)!=null){document.getElementById(a).value=b}}function saveQvState(c,b,f){setRTFilterOptions();setMinState(c);setMaxState(b);setSequenceId(f);setActive(Ext.getCmp("activeItems").checked);setInActive(Ext.getCmp("inactiveItems").checked);setOpened(Ext.getCmp("openItems").checked);document.getElementById("thePage:theForm:closed").value=Ext.getCmp("closedItems").checked;setWidgetViewState(viewState);document.getElementById("thePage:theForm:viewState").calView=calView;setAdvFilterState(Ext.getCmp("advFilter").collapsed);var d="";var e=grid.getColumnModel().getColumnCount(false);for(var a=1;a<e;a++){d=d+grid.getColumnModel().getDataIndex(a)+","+grid.getColumnModel().getColumnWidth(a)+","+grid.getColumnModel().isHidden(a)+","+a+"#"}document.getElementById(columnModelInfoComponentId).value=d;if(grid.store.getSortState()!=null){document.getElementById(columnModelSortInfoComponentId).value=grid.store.getSortState().field+"dir"+grid.store.getSortState().direction}setWidth(parseInt(window.parent.Ext.getCmp(widgetId).getWidth()));setHeight(parseInt(window.parent.Ext.getCmp(widgetId).getHeight()));setXPos(parseInt(window.parent.Ext.getCmp(widgetId).getPosition()[0]-window.parent.Ext.getCmp("parentSkyWindow").getPosition()[0]));setYPos(parseInt(window.parent.Ext.getCmp(widgetId).getPosition()[1]-window.parent.Ext.getCmp("parentSkyWindow").getPosition()[1]));saveState();clearTimeout(t);createCookie();callCount=0;parseLimit=Ext.util.Cookies.get(cookieName);autoRefresh()}function getQVStateJS(c,b,a,d){if(c=="true"){Ext.getCmp("activeItems").checked=true}else{Ext.getCmp("activeItems").checked=false}if(b=="true"){Ext.getCmp("inactiveItems").checked=true}else{Ext.getCmp("inactiveItems").checked=false}if(a=="true"){Ext.getCmp("openItems").checked=true}else{Ext.getCmp("openItems").checked=false}if(d=="true"){Ext.getCmp("closedItems").checked=true}else{Ext.getCmp("closedItems").checked=false}}function toggleDIV(){if(document.getElementById("two").style.display=="none"){document.getElementById("two").style.display="block"}else{document.getElementById("two").style.display="none"}}function setCheckBoxValue(){var c=Ext.getCmp("activeItems").checked;var a=Ext.getCmp("inactiveItems").checked;var b=Ext.getCmp("openItems").checked;var d=Ext.getCmp("closedItems").checked;setfilterOptions(c,a,b,d)}function chartEventHandler(e){var d=e.replace(/\\/g,"\\\\");d=d.replace(/'/g,"\\'");d=d.replace(NONPRINT+"lt;","&lt;","g");d=d.replace(NONPRINT+"gt;","&gt;","g");e=e.replace(NONPRINT+"lt;","&amp;lt;","g");e=e.replace(NONPRINT+"gt;","&amp;gt;","g");document.getElementById("thePage:theForm:queryForChartPopup").value=true;document.getElementById("thePage:theForm:chartDataStr").value=d;if(Ext.getCmp("waitMsgId")!=null){Ext.getCmp("waitMsgId").show()}loadResultSet();var f=e.split(PE);var g;var c;if(f[0].endsWith("__c")){g=f[0].substring(0,(f[0].length-3))}else{g=f[0]}if(f[1].endsWith("__c")){c=f[1].substring(0,(f[1].length-3))}else{c=f[1]}var b;if(f[3]==":"){b=g+"."+c+"="+missingValue}else{b=g+"."+c+"="+f[3]}b=escapeSpecialChars(b);if(Ext.getCmp("chartPopupWin")==null){var a=new Ext.Window({id:"chartPopupWin",height:250,width:300,title:b,modal:true,constrain:true,viewConfig:{forceFit:true},layout:"fit",closeAction:"hide"})}else{Ext.getCmp("chartPopupWin").setTitle(b)}}function escapeSpecialChars(a){a=a.replace("<","&lt;","g");a=a.replace(">","&gt;","g");return a}function PopulateChartGroupRowDataArray(f){var b=new Array(colsSize);var g=[];chartDataResultSet=resultSet;var e=0;var c=[];for(var d=0;resultSet.length>d;d++){var a=f.split(PE);if(a==chartDataResultSet[d][0].split(",")[5]){c[d]=chartDataResultSet[d][0].split(",")[0]}}if(typeof(window.parent.parent.setIdArray)=="function"){window.parent.parent.setIdArray(c)}showChartPopup()}function disableMenu(){var d=Ext.getCmp("activeItems");var c=Ext.getCmp("inactiveItems");var b=Ext.getCmp("openItems");var a=Ext.getCmp("closedItems");if(inactiveFlag){if(d!=null){d.checked=false;d.setDisabled(true)}if(c!=null){c.checked=false;c.setDisabled(true)}}if(stateFlag){if(b!=null){b.checked=false;b.setDisabled(true)}if(a!=null){a.checked=false;a.setDisabled(true)}}}function showNoDataMsgforTableview(){if(viewState=="tableView"&&totalRows==0){if(Ext.getCmp("norecords")!=null){Ext.getCmp("norecords").show()}}else{if(Ext.getCmp("norecords")!=null){Ext.getCmp("norecords").hide()}}}function QVReady(){Ext.QuickTips.init();var A;var c;var m=new Ext.data.SimpleStore({fields:["value","name"],data:[["Month",monthLabel],["Week",weekLabel],["Day",dayLabel]]});var z=new Ext.form.ComboBox({id:"comboPanelId",store:m,width:150,displayField:"name",valueField:"value",typeAhead:true,mode:"local",forceSelection:true,triggerAction:"all",selectOnFocus:true,value:calView,cls:"fontCls",listeners:{select:function(D,B,C){showView(C)}}});var e=[];extInit();isRefreshBtnPressed=Ext.util.Cookies.get(cookieName+"isPressed");if(isRefreshBtnPressed=="true"){imageCls="auto-refresh-off";isRefreshBtnState=true;autoRefreshable=false;toolTipRefreshBtn=toolTipAutoRefreshOFF}else{imageCls="auto-refresh-on";isRefreshBtnState=false;autoRefreshable=true;toolTipRefreshBtn=toolTipAutoRefreshON}getMenuForNewBtn();displayToolBar();var n=Ext.util.Cookies.get(cookieName);if(n!=null&&n!=""){Ext.getCmp("refreshInterval").setValue(n)}else{if(n==""){Ext.getCmp("refreshInterval").setValue(0)}}getQvState();disableMenu();store1.loadData(resultSet);var m=new Ext.data.SimpleStore({data:advFilterData,fields:["label","value","type","queryCondId","extraInfo"]});var i=new Ext.data.SimpleStore({data:[["True",trueLabel],["False",falseLabel]],fields:["booleanValue","booleanName"]});var b=new Ext.form.ComboBox({store:i,mode:"local",triggerAction:"all",valueField:"booleanValue",displayField:"booleanName",selectOnFocus:true,triggerClass:Ext.isIE7?"gridCmbTriggerClsIE":"gridCmbTriggerCls",editable:false});var q=new Ext.data.SimpleStore({data:[["Me",Me],["My Queues",MyQueues],["Select Staff...",selectStaff],["Select Queue...",selectQueue]],fields:["fldValue","fldName"]});var p=new Ext.data.SimpleStore({data:[["Me",Me],["Select Staff...",selectStaff]],fields:["fldValue","fldName"]});var x=new Ext.form.ComboBox({id:"assignedToField",store:q,mode:"local",triggerAction:"all",valueField:"fldValue",displayField:"fldName",selectOnFocus:true,triggerClass:Ext.isIE7?"gridCmbTriggerClsIE":"gridCmbTriggerCls",editable:false,listeners:{select:function(E,G,I){var D=m.getAt(selectedGridRowIndex);var B=D.get("extraInfo");var H=B.split(",");var C;var F=H[3];var L=H[1];var K=G.get(E.valueField);if(F.toLowerCase()=="ownerid"){if(K=="Select Staff..."||K=="Select Queue..."){Ext.getCmp("assignedToField").clearValue();if(K=="Select Staff..."){C="Client"}else{if(K=="Select Queue..."){C="Queue"}}var J="SearchPage?popupId="+C+"&isQueurorUser=true&isLookup=true&queueFor="+L;if(isSystemQVForQue){J=J+"&shQueue=true"}if(C=="Client"){J=J+"&filterClause="+escape("IsStaffUser__c=true")}if(C=="Queue"){J=J+"&filterClause="+escape("sobjectType='"+L+"'")}window.parent.openPopup(J,l)}}}}});var v=new Ext.form.ComboBox({id:"assignedToField1",store:p,mode:"local",triggerAction:"all",valueField:"fldValue",displayField:"fldName",selectOnFocus:true,triggerClass:Ext.isIE7?"gridCmbTriggerClsIE":"gridCmbTriggerCls",editable:false,listeners:{select:function(E,G,I){var D=m.getAt(selectedGridRowIndex);var B=D.get("extraInfo");var H=B.split(",");var C;var F=H[3];var L=H[1];var K=G.get(E.valueField);if(F.toLowerCase()=="fkopenby__c"||F.toLowerCase()=="fkstaff__c"){if(K=="Select Staff..."){E.clearValue();if(K=="Select Staff..."){C="Client"}var J="SearchPage?popupId="+C+"&isQueurorUser=true&isLookup=true&queueFor="+L;if(C=="Client"){J=J+"&filterClause="+escape("IsStaffUser__c=true")}window.parent.openPopup(J,l)}}}}});pickListComboStore=new Ext.data.ArrayStore({id:"pickListComboId",data:pickListArray,fields:["value","label","mapKey","fieldLabel"],sortInfo:{field:"value",direction:"ASC"}});var g=new Ext.form.ComboBox({store:pickListComboStore,mode:"local",triggerAction:"all",valueField:"value",displayField:"label",selectOnFocus:true,triggerClass:Ext.isIE7?"gridCmbTriggerClsIE":"gridCmbTriggerCls",editable:false});function f(F,E,B,H,D,C){E.css="x-advGrid-col2";var G=B.data.type;if(G=="date"){F=getGMTFormat(F)}else{if(G=="picklist"){F=ValueLabelArr[F]}}return F}var o=new Ext.grid.ColumnModel({header:false,id:"advFilterColModel",columns:[{dataIndex:"label",header:"Field Label",sortable:true,resizable:true},{dataIndex:"value",header:"Value",sortable:true,editable:true,resizable:true,renderer:f},{dataIndex:"type",header:"Type",sortable:true,editable:true,hidden:true},{dataIndex:"queryCondId",header:"queryCondId",sortable:true,editable:true,hidden:true},{dataIndex:"extraInfo",header:"extraInfo",sortable:false,editable:true,hidden:true}],editors:{text:new Ext.grid.GridEditor(new Ext.form.TextField({})),number:new Ext.grid.GridEditor(new Ext.form.NumberField({})),date:new Ext.grid.GridEditor(new Ext.form.DateField({triggerClass:"gridCmbTriggerCls",format:dateFormat})),combo:new Ext.grid.GridEditor(b),ASSIGNEDTO_FIELD:new Ext.grid.GridEditor(x),ASSIGNEDTO_FIELD1:new Ext.grid.GridEditor(v),lookUp:new Ext.grid.GridEditor(new Ext.form.TextField({disabled:false})),"Schema.DisplayType.EMAIL":new Ext.grid.GridEditor(new Ext.form.TextField({})),picklist:new Ext.grid.GridEditor(g)},getCellEditor:function(O,K){var L=this.getDataIndex(O);var F;if(L=="value"){var H=m.getAt(selectedGridRowIndex);var P=H.get("type");if(P=="lookUp"){var C=H.get("extraInfo");var J=C.split(",");var B=J[0];var D=J[3];var N=J[1];var M="";if(B.toLowerCase()=="status"){M=getFilterClause(N)}if(B==clientWindowHeaderSearchPageLabel&&D.toLowerCase()==owneridLabel&&isSystemQVForQue){window.parent.openPopup("SearchPage?popupId=Client&isQueurorUser=true&shQueue=true&isLookup=true&queueFor="+N+"&filterClause="+escape("IsStaffUser__c=true"),l)}else{if(B==clientWindowHeaderSearchPageLabel&&D.toLowerCase()==owneridLabel){window.parent.openPopup("SearchPage?popupId=Client&isQueurorUser=true&isLookup=true&queueFor="+N+"&filterClause="+escape("IsStaffUser__c=true"),l)}else{if(M!=""){window.parent.openPopup("SearchPage?popupId="+B+"&isLookup=true&filterClause="+M,l)}else{window.parent.openPopup("SearchPage?popupId="+B+"&isLookup=true",l)}}}}else{if(P.toLowerCase()=="picklist"){var C=H.get("extraInfo");var J=C.split(",");var G=J[1].split("__");var I;if(G.length==3){I=G[1]+"__c"}else{I=G[0]+"__c"}populatePickListCombo(I+"."+J[3])}else{if(P.toLowerCase()=="assignedto_field"){var C=H.get("extraInfo");var J=C.split(",");var I;var Q;if(J.length>=4){var G=J[1].split("__");if(G.length==3){I=G[1]+"__c"}else{I=G[0]+"__c"}Q=J[3]}var E=0;if(Q.toLowerCase()=="fkstaff__c"&&(I.toLowerCase()=="problem__c"||I.toLowerCase()=="release__c"||I.toLowerCase()=="change_request__c"||I.toLowerCase()=="broadcasts__c")){E=1}else{if(Q.toLowerCase()=="fkopenby__c"&&(I.toLowerCase()=="incident__c"||I.toLowerCase()=="task__c")){E=1}}if(E==1){P="ASSIGNEDTO_FIELD1"}}}}return this.editors[P]}return Ext.grid.ColumnModel.prototype.getCellEditor.call(this,O,K)}});function l(D){var C=m.getAt(selectedGridRowIndex).get("extraInfo");C=C.split(",");C[2]=D;m.getAt(selectedGridRowIndex).set("extraInfo",C[0]+","+C[1]+","+D+","+C[3]);var B=C[1]+","+C[3]+","+D+",";document.getElementById("thePage:theForm:fieldInfo").value=B;getNameField(selectedGridRowIndex)}advFilterGrid=new Ext.grid.EditorGridPanel({id:"advFilterGridpanel",ds:m,clicksToEdit:1,cm:o,height:Ext.isChrome?110:100,width:400,border:false,columnLines:true,cls:"advFilterCls",layout:"fit",autoEncode:true,viewConfig:{headersDisabled:true,forceFit:true,scrollOffset:15},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),listeners:{rowclick:function(B,C,D){selectedGridRowIndex=C}},hidden:!hasRTFilters});var d=function(){var F=0;var I="";var K=false;while(m.data.length>F){var B=m.getAt(F).get("queryCondId");var D;var G="";var J=false;var C="";if(m.getAt(F).get("type")=="lookUp"){var E=m.getAt(F).get("extraInfo").split(",")[2];D=E+"";G=m.getAt(F).get("extraInfo").split(",")[1];J=true}else{if(m.getAt(F).get("type")=="date"){if(m.getAt(F).get("value")!=""&&m.getAt(F).get("value")!=null){if(typeof(m.getAt(F).get("value"))=="object"){D=ConvertUTCtoGMT(m.getAt(F).get("value").toUTCString())}else{D=ConvertUTCtoGMT(m.getAt(F).get("value")+"")}}}else{D=m.getAt(F).get("value")+""}}C=m.getAt(F).get("extraInfo").split(",")[3];if((C.toLowerCase()=="ownerid"||C.toLowerCase()=="fkopenby__c"||C.toLowerCase()=="fkstaff__c")&&m.getAt(F).get("type")=="ASSIGNEDTO_FIELD"&&(m.getAt(F).get("value")!="Me"&&m.getAt(F).get("value")!="My Queues")){var E=m.getAt(F).get("extraInfo").split(",")[2];D=E+"";G=m.getAt(F).get("extraInfo").split(",")[1];J=true}I=I+B+"¬"+D+"¬"+G+"¬"+J+"¬"+C+"¬П";if(D==null||D.trim()==""||D=="null"){K=true;break}F++}if(K){Ext.Msg.alert(infoLabel,ShowMessageQV2Label,function(L){if(Ext.isIE8&&IEVersion==8){window.resizeTo(document.body.clientWidth-1,document.body.clientHeight)}});if(Ext.isIE8&&IEVersion==8){window.resizeTo(document.body.clientWidth+1,document.body.clientHeight)}}else{document.getElementById("thePage:theForm:filterStr").value=I;persistState();try{showWaitbox();loadResultSet()}catch(H){}}};var u=new Ext.Button({id:"advFilterSearch",text:searchLabel,height:20,width:50,style:"margin-left:340px;",cls:"bgBtnGrey",handler:d,hidden:!hasRTFilters});chartViewPanel=new Ext.Panel({layout:"fit",id:"chartViewPanel",contentEl:"chartView"});comboPanel=new Ext.Panel({id:"comboPanel",items:[z]});monthViewPanel=new Ext.Panel({id:"monthViewPanel",contentEl:"monthview",listeners:{afterrender:function(B){$("#monthview").fullCalendar("render")},show:function(B){$("#monthview").fullCalendar("render")}}});weekViewPanel=new Ext.Panel({id:"weekViewPanel",contentEl:"weekview",listeners:{afterrender:function(B){$("#weekview").fullCalendar("render")},show:function(B){$("#weekview").fullCalendar("render")}}});dayViewPanel=new Ext.Panel({id:"dayViewPanel",contentEl:"dayview",listeners:{afterrender:function(B){$("#dayview").fullCalendar("render")},show:function(B){$("#dayview").fullCalendar("render")}}});calendarViewPanel=new Ext.Panel({id:"calendarViewPanel",items:[comboPanel,monthViewPanel]});var r=new Ext.Panel({layout:"fit",id:"qvPageControlPanel",contentEl:"qvPageDiv"});calendarViewPanel.add(weekViewPanel);Ext.getCmp("weekViewPanel").hide();calendarViewPanel.add(dayViewPanel);Ext.getCmp("dayViewPanel").hide();var s=new Ext.Toolbar({cls:"legendToolBarCls",id:"legendPanelId",height:30,border:true,items:[{scale:"medium",iconCls:"bmcLegend",id:"imgId",hidden:true,cls:"toolSpCls",listeners:{mouseover:function(){legWinX=50;var B=Ext.getCmp("legendPanelId").getPosition()[1]+Ext.getCmp("legendPanelId").getHeight();legWinY=B;openLegendPopup()},mouseout:function(){closeLegendPopup()}}}]});if(Ext.getCmp("imgId")!=null&&viewState=="calendarView"){Ext.getCmp("imgId").show()}function a(){var C=document;var B=Math.max(Math.max(C.body.scrollHeight,C.documentElement.scrollHeight),Math.max(C.body.offsetHeight,C.documentElement.offsetHeight),Math.max(C.body.clientHeight,C.documentElement.clientHeight));return B}var y=new Ext.Viewport({layout:"border",renderTo:"viewPortDiv",cls:"viewportSearchCls",listeners:{resize:function(){w=document.body.clientWidth;h=a();renderNewCharts()}},items:[{id:"advFilter",region:"north",items:[advFilterGrid,u],plugins:[Ext.ux.PanelCollapsedTitle],margins:hasRTFilters?"35 0 0 0":Ext.isIE?"-6 0":"10 0 0 0",cmargins:hasRTFilters?"35 0 0 0":Ext.isIE?"-6 0 0 0":"10 0 0 0",height:hasRTFilters?165:0,maxSize:400,collapsible:hasRTFilters,collapsed:hasRTFilters?advFilterCollapsed:false,layoutConfig:{animate:true},split:true,title:advancedFilterLabel,collapsedCls:"bmcCollapsedAdvFilter"},{region:"center",autoScroll:true,id:"centerRegion",items:[grid],layout:"fit",margins:isIE8CompatibleInIE()?"16 0 0 0":"0 0 0 0"},{region:"south",id:"southPanel",items:[s,r],layout:"fit",height:35}]});y.doLayout();if(Ext.isIE8){document.body.className=String(document.body.className).replace("x-border-layout-ct","")}initCalendarView();waitbox(statusMsg,0);Ext.getCmp("centerRegion").add("chartViewPanel");Ext.getCmp("chartViewPanel").hide();Ext.getCmp("centerRegion").add("calendarViewPanel");Ext.getCmp("calendarViewPanel").hide();if(viewState=="tableView"||viewState==null||viewState==""){Ext.getCmp("tableViewBtn").checked=true;window.onLoad=showTableView()}else{if(viewState=="chartView"){Ext.getCmp("chartViewBtn").checked=true;window.onLoad=showChartView()}else{if(viewState=="calendarView"){Ext.getCmp("calendarViewBtn").checked=true;window.onLoad=showCalendarView()}}}Ext.getCmp("centerRegion").doLayout()}function persistState(){document.getElementById("thePage:theForm:active").value=Ext.getCmp("activeItems").checked;document.getElementById("thePage:theForm:inactive").value=Ext.getCmp("inactiveItems").checked;document.getElementById("thePage:theForm:opened").value=Ext.getCmp("openItems").checked;document.getElementById("thePage:theForm:closed").value=Ext.getCmp("closedItems").checked;document.getElementById("thePage:theForm:viewState").value=viewState;document.getElementById("thePage:theForm:viewState").calView=calView;document.getElementById("thePage:theForm:advFilterState").value=Ext.getCmp("advFilter").collapsed}function refreshRelatedPortlets(){var a=grid.store.getAt(selectedRowIndex).get(idFldDataIndex).split(",")[5];if(typeof(window.parent.parent.refreshActionItemsPortlet)=="function"){if(a.toLowerCase()=="incident__c"){window.parent.parent.refreshActionItemsPortlet("Action Items","INC")}else{if(a.toLowerCase()=="broadcasts__c"){window.parent.parent.refreshActionItemsPortlet("Action Items","BROAD")}else{if(a.toLowerCase()=="task__c"){window.parent.parent.refreshActionItemsPortlet("Action Items","TASK")}else{if(a.toLowerCase()=="change_request__c"){window.parent.parent.refreshActionItemsPortlet("Action Items","CR")}else{if(a.toLowerCase()=="problem__c"){window.parent.parent.refreshActionItemsPortlet("Action Items","PRB")}}}}}}if(typeof(window.parent.parent.refreshPortletByTitle)=="function"&&a.toLowerCase()=="broadcasts__c"){window.parent.parent.refreshPortletByTitle("Broadcasts")}}function getFilterClause(a){var b="";var c=a;if(a.split("__").length==3){c=a.split("__")[1]+"__"+a.split("__")[2]}if(c.toLowerCase()=="incident__c"){b=escape("inactive__c = false and appliesToIncident__c = true")}else{if(c.toLowerCase()=="task__c"){b=escape("inactive__c = false and appliesToTask__c = true")}else{if(c.toLowerCase()=="change_request__c"){b=escape("inactive__c = false and appliesToChange__c = true")}else{if(c.toLowerCase()=="broadcasts__c"){b=escape("inactive__c = false and appliesToBroadcasts__c = true")}else{if(c.toLowerCase()=="problem__c"){b=escape("inactive__c = false and appliesToProblem__c = true")}}}}}return b}function setRTFilterOptions(){var b=Ext.getCmp("advFilterGridpanel").store;var e=0;var d="";var f,c;while(b.data.length>e){var a=b.getAt(e).get("extraInfo").split(",")[3];if(b.getAt(e).get("type")=="lookUp"||((a.toLowerCase()=="ownerid"||a.toLowerCase()=="fkopenby__c"||a.toLowerCase()=="fkstaff__c")&&b.getAt(e).get("type")=="ASSIGNEDTO_FIELD"&&(b.getAt(e).get("value")!="Me"&&b.getAt(e).get("value")!="My Queues"))){f=b.getAt(e).get("extraInfo").split(",")[2];c=b.getAt(e).get("value")}else{if(b.getAt(e).get("type")=="date"&&b.getAt(e).get("value")!=""){if(typeof(b.getAt(e).get("value"))=="object"){f=ConvertUTCtoGMT(b.getAt(e).get("value").toUTCString())}else{f=ConvertUTCtoGMT(b.getAt(e).get("value")+"")}c=f}else{f=b.getAt(e).get("value");c=f}}if(c==""){c="ф"}if(f==""){f="ф"}d=d+b.getAt(e).get("queryCondId")+"¬"+f+"¬"+c+"П";e++}serRTFString(d)}function getGMTFormat(a){if(a==""){return""}return Ext.util.Format.date(a,dateFormat)}function dynamicLocalizationForQuickViews(b){var a=b;if(b.toLowerCase()=="incident"){a=ObjIncidentLabel}else{if(b.toLowerCase()=="task"){a=ObjTaskLabel}else{if(b.toLowerCase()=="broadcast"){a=ObjBroadastLabel}else{if(b.toLowerCase()=="change"){a=ObjChangeRequestLabel}else{if(b.toLowerCase()=="problem"){a=ObjProblemLabel}else{if(b.toLowerCase()=="category"){a=ObjCategoryLabel}else{if(b.toLowerCase()=="category type"){a=ObjCategoryTypeLabel}else{if(b.toLowerCase()=="organization"){a=ObjAccountLabel}else{if(b.toLowerCase()=="impact"){a=ObjImpactLabel}else{if(b.toLowerCase()=="urgency"){a=ObjUrgencyLabel}else{if(b.toLowerCase()=="status"){a=ObjStatusLabel}else{if(b.toLowerCase()=="priority"){a=ObjPriorityLabel}else{if(b.toLowerCase()=="action"){a=ObjActionLabel}else{if(b.toLowerCase()=="incident history"){a=ObjIncidentHistoryLabel}else{if(b.toLowerCase()=="broadcast history"){a=ObjBroadcastHistoryLabel}else{if(b.toLowerCase()=="task history"){a=ObjTaskHistoryLabel}else{if(b.toLowerCase()=="standard description"){a=ObjStandardDescriptionLabel}else{if(b.toLowerCase()=="template"){a=ObjTemplateLabel}else{if(b.toLowerCase()=="faq"){a=ObjFAQLabel}else{if(b.toLowerCase()=="faq category"){a=ObjFAQCategoryLabel}else{if(b.toLowerCase()=="change assessment"){a=ObjChangeAssessmentLabel}else{if(b.toLowerCase()=="projected service outage"){a=ObjProjectedServiceOutageLabel}}}}}}}}}}}}}}}}}}}}}}return a}function definePageInfo(){var a=new Ext.form.Label({id:"pageInfoText",renderTo:"pageInfoDiv"})}function disableButtons(){if(exceptionErrorMsg==""){Ext.getCmp("qvdeleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("qvdeleteId").setDisabled(true);Ext.getCmp("qvcopyId").setIconClass("bmcCopyDisable");Ext.getCmp("qvcopyId").setDisabled(true)}};