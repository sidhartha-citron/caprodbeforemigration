var g_loadTime=new Date(),startTime=new Date(),test="",durationError=0,serverTime="39",networklatencystart="",windowloaddate="",selectedModuleName,v1,doSave=false,saveFunctionRef,clickedOnce=false,taboutFlag=true,keyName,keyValue,incidentclientId,ownerIdString,priorityString,priorityNameString,isValid="True",CI_value,service_value,userHasAccesToInc,stgName,clientID,categoryId,orgId,incidentId,clientName,reqDtlsId="",incidentCategory,errormsg,chkBoxValue,incidentCategoryId="",separator,disableTrue=true,idset,NoRightsToViewEdit,timeoutreturn,pageloadstartdate=new Date();insideNote=false;isNoteEnableFlag=true,hideBroadcastAccordion=true,hideClientAccordion=true,hideCustomFieldAccordion=true,isCustomPage=true,isDormantSection=false,hideCIAccordion=true,loggedInUserId="",loggedInUserFirstName="",loggedInUserLastName="",primaryCI="",recId="";var compId;var isServiceRequest;var objName;var dueDateElement;var soqlDateClause;var isError=false;var incnState=true;var changeDone=false;document.onclick=activateWindow;var resizeGrid=function resizeGrid(){if(Ext.getCmp("southPanelSI")!=undefined){Ext.getCmp("southPanelSI").setWidth(Ext.getCmp("southPanelSI").getWidth())}};function initFunc_1(){if(window.parent.refreshGridSI!=undefined){window.parent.refreshGridSI(wid,resizeGrid)}if(isLookup){window.parent.changePopUpTitle("{!objLabel}")}}function setSelectedModuleName(a){selectedModuleName=a}function RequestDetailId(a){document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value=a;renderRequestDetails(a)}function ShowCIExplorerJS(d,c){var a=escape("CIExplorerLauncher?Module=Incident__c&RecordSequence="+incidentId+"&id="+incidentId);var b="NavigatorPage?title="+d+"&target="+a;window.parent.parent.addNewTab("CIExplorerLauncher",c,b)}function ChangeCIExpBtnStatusJS(b,a){CI_value=IncidentPageComp.ComponentVars.BaseElementName;if(0==CI_value.length){document.getElementById(a).disabled=true}else{document.getElementById(a).disabled=false}}function DisableCIExpBtnJS(c,a){var b=IncidentPageComp.ComponentVars.BaseElementName;if((CI_value!=b)||(0==b.length)){document.getElementById(a).disabled=true}}function handleResetChange(){if(clickedOnce){clickedOnce=false;changeDone=false;window.parent.registerSave(wid2)}}function handleChange(b){if(b!=null){var a=b.target||b.srcElement;if(a!="undefined"&&a.id.match("incidentNote__c")==null&&a.id.match("addNoteBt")==null){insideNote=true}}if(!clickedOnce){clickedOnce=true;changeDone=true;window.parent.registerChange(wid2)}}function setIncForCategoryEnabledJS(a){var b="";if(document.getElementById(a)!=null&&document.getElementById(a)!=""){b=document.getElementById(a).value}if(b!=null&&b!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}}function checkIDSet(){if(idset==null||idset==""){if(getIsDirect()==""){if(typeof(window.parent.returnListOfId)=="function"){idset=window.parent.returnListOfId()}}else{if(typeof(window.parent.parent.getIdArray)=="function"){idset=window.parent.parent.getIdArray()}window.parent.handleSave(getWID(),getID())}}}function senddata(){return data}function setClientDetailsJS(a){setClientNext(returnvalue);if(returnvalue!=null){document.getElementById(a).value=returnvalue}}function afterSaveCloseAction(){waitMsg.hide();if(errormsg==IncidentPage.Labels.SavedSuccessfully){closeIncident()}else{showError()}}var showit=function(a){document.getElementById(dueDateCalculationOptionJS).value=a;saveRecords()};Ext.onReady(function(){if(stgName=="CLOSED"||stgName=="Closed"){Ext.MessageBox.show({title:IncidentPage.Labels.Information,msg:IncidentPage.Labels.ClosedStage,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}getapplyTemp();if(hideBroadcastAccordion){document.getElementById(IncidentPageComp.ComponentVars.broadcastAccordionPanelId).style.display="none"}if(hideCIAccordion){document.getElementById(IncidentPageComp.ComponentVars.ciAccordionPanelId).style.display="none"}if(hideClientAccordion){}if(hideCustomFieldAccordion){document.getElementById(IncidentPageComp.ComponentVars.CustomFieldAccordionPanelId).style.display="none"}convertUserCalledToInt();createControlMap();renderElementsByType();windowloaddate=new Date();networklatencystart=windowloaddate.getTime();var h=networklatencystart-etime;data+=IncidentPage.Labels.PM_netwokLatency;data+=h;data+="<br>";Ext.QuickTips.init();if(isLookup){disableTrue=true;separator=""}else{disableTrue=false;separator="-"}var p=function(e,P){openPage("IncidentPageCustom",IncidentPage.Labels.IncidentWindowHeaderSearchPage,IncidentPage.Labels.IncidentWindowHeaderSearchPage);activeAllWindowFlag=false};var r=function(e,P){followIncidentToggler()};var s=function(Q,P){var T=ValidateForm();if(T==true){if(!inProgress){doSave=false;var W=document.getElementById(IncidentPageComp.ComponentVars.IsPriorityChanged).value;var U=document.getElementById(IncidentPageComp.ComponentVars.DueDateCalculationOption).value;var V=document.getElementById(IncidentPageComp.ComponentVars.ImpactIDName);var S="";if(V!=null){S=V.value}var e=document.getElementById(IncidentPageComp.ComponentVars.UrgencyIDName);var R="";if(e!=null){R=e.value}if(W=="true"&&incidentId!=""&&incidentId!=null&&S!=""&&R!=""&&isDueDateOverridenByServiceTarget()==false){if(!automaticupdateduedate){openPopup("recalculateDueDate",showit,190,300)}else{document.getElementById(dueDateCalculationOptionJS).value=2;saveRecords()}}else{saveRecords()}}else{doSave=true}}};saveFunctionRef=s;var o=function(e,P){updateDescription();KMdescription=KMdescription.replace(/</g,"&lt;");KMdescription=encodeURIComponent(KMdescription);openPopupforKM("KnowledgeSearch?calledFromForm=true&search="+KMdescription+"&KMincidentID="+incidentId,"",globalSearch,615,670)};var I=function(e,P){openPopupForServiceTarget("SearchPage?popupId=IncidentServiceTarget&isLookup=true&amp;filterClause="+escape("FKIncident__c='"+incidentId+"'"),("#"+incidentName+" "+IncidentPage.Labels.ServiceTargets))};var c=function(e,P){openPopupWithTitle("ComposeEmailPage?recordId="+incidentId+"&isNew=true&objectName=Incident__c",composeMailOnCompleteIn,IncidentPage.Labels.ComposeEmailPageHeader+incidentName,getEmailWinHt(),getEmailWinWidth(),false)};var H=function(e,P){clearIncident();Ext.getCmp("incident_inactive__c").setValue(false)};var f=function(e,P){activeAllWindowFlag=false;callCopyPage()};var E=function(e,P){resetIncident()};var u=function(e,P){Ext.MessageBox.confirm(IncidentPage.Labels.Delete,IncidentPage.Labels.DeleteIncidentPage,function(Q){if(Q==="yes"){deleteIncident()}})};var G=function(e,P){AssignedToStaff()};var M=function(e,P){openPopup("SearchPage?popupId=Client&isLookup=true&additional_columns=name,username,firstname,lastname,phone,extension,email,ProfileId,Profile.Name&filterClause="+escape("profileid='"+getProfileID()+"'And IsStaffUser__c=true ")+"&isAssignTo=true",preSetAssignedToStaffNext)};var b=function(e,P){AssignToSuggestedStaff()};var m=function(e,P){AssignedToMyself()};var x=function(e,P){openPopup("SearchPage?popupId=Queue&isQueurorUser=true&isLookup=true&queueFor=Incident__c&isOnlyQueueList=true&additional_columns=Queue.Name,QueueId&filterClause="+escape("sobjectType='"+objName+"'"),preSetAssignedToSuggestedStaffNext)};var v=function(e,P){AssignedToClear()};var J=function(e,P){saveBeforeCloseRecords()};var i=function(e,P){quickCloseIncident()};var C=function(e,P){reopenIncident();Ext.getCmp("incidentKMSearch").setDisabled(false);Ext.getCmp("incidentKMSearch").setIconClass("bmcKMSearch")};var d=function(e,P){incidentForClient()};var d=function(e,P){incidentForClient()};var t=function(e,P){incidentForCatagory()};var q=function(e,P){window.parent.registerChange(wid2);respondedBtnHandler()};var B=function(e,P){myselfBtnHandler()};var F=function(e,P){callCounterBtnHandler()};var O=function(e,P){if(window.parent.changeArray[wid2]!=null&&typeof(window.parent.changeArray[wid2])!="undefined"&&window.parent.changeArray[wid2]!=-1){checkLoseChanges(previousIncidentBtnHandler1)}else{if(document.getElementById("prevId").disabled!=true){previousIncidentBtnHandler1()}}};var j=function(e,P){if(window.parent.changeArray[wid2]!=null&&typeof(window.parent.changeArray[wid2])!="undefined"&&window.parent.changeArray[wid2]!=-1){checkLoseChanges(nextIncidentBtnHandler1)}else{if(document.getElementById("nextId").disabled!=true){nextIncidentBtnHandler1()}}};var n=function(e,P){getIncProcBtnHandler()};var l=function(e,P){var Q=Ext.getCmp("templatebutton");if(incidentId!=null&&incidentId!=""&&overwrite=="true"){Ext.MessageBox.confirm("",IncidentPage.Labels.OverwriteWarning,function(R){if(R=="yes"){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Incident'  and Hasrecurrence__c = false"),fetchIncidentTemplates,500,625)}})}else{if((incidentId!=null&&incidentId!=""&&overwrite=="false"&&changeDone==true)||(incidentId==null||incidentId==""&&overwrite=="false"&&Q.disabled==false&&changeDone==true)){Ext.MessageBox.confirm("",IncidentPage.Labels.replaceUnsaved,function(R){if(R==="yes"){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Incident'  and Hasrecurrence__c = false"),fetchIncidentTemplates,500,625)}})}else{if(Q.disabled==false){openPopup("SearchPage?popupId=Template&isLookup=true&filterClause="+escape("templateFor__c='Incident'  and Hasrecurrence__c = false"),fetchIncidentTemplates,500,625)}}}};var a=Ext.extend(Ext.Panel,{renderTo:"btnToolbar",defaults:{bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"}});new a({title:"",cls:"toolSpCls",bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;",tbar:[{scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:IncidentPage.Labels.New,id:"newId",hidden:disableTrue,handler:p}," ",{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:IncidentPage.Labels.Save,disabled:getSaveState(),id:"saveId",handler:s}," ",{scale:"medium",iconCls:"bmcCopy",tooltipType:"title",tooltip:IncidentPage.Labels.Copy,id:"copyId",hidden:disableTrue,handler:f}," ","-"," ",{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:IncidentPage.Labels.Delete,id:"deleteId",handler:u}," ",{scale:"medium",iconCls:"bmcRefreshDasboard",tooltipType:"title",tooltip:IncidentPage.Labels.Reset,id:"resetId",hidden:disableTrue,handler:E}," ",separator," ",{scale:"medium",iconCls:"bmcView1",tooltipType:"title",tooltip:IncidentPage.Labels.ViewOpenIncidentsFor,id:"viewId",hidden:disableTrue,menu:[{text:IncidentPage.Labels.IncidentsforClient,id:"IncidentsforClientId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:d},{text:IncidentPage.Labels.IncidentsforCategory,id:"IncidentsforCategoryId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:t}]}," ",{scale:"medium",iconCls:"bmcAssign1",tooltipType:"title",tooltip:IncidentPage.Labels.AssignTo,id:"assignedToId",hidden:disableTrue,menu:[{text:IncidentPage.Labels.IncidentsStaff,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToStaffButtonId",disabled:getAssignStaffState(),handler:G},{text:IncidentPage.Labels.SuggestedExperts,disabled:"true",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToSuggestedStaffButtonId",disabled:getAssignSuggestedStaffState(),handler:b},{text:IncidentPage.Labels.IncidentMyself,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToMyselfButtonId",disabled:getAssignMyselfState(),handler:m},{text:IncidentPage.Labels.IncidentMemberof+" "+getProfileName(),id:"assignToMemberOfAdminButtonId",disabled:getAssignMemberOfAdminState(),icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:M},{text:IncidentPage.Labels.Queue,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"assignToQueueButtonId",disabled:getAssignQueueState(),handler:x}]}," ",{scale:"medium",iconCls:"bmcAction1",tooltipType:"title",id:"actionButton",tooltip:IncidentPage.Labels.Actions,hidden:disableTrue,menu:[{text:IncidentPage.Labels.IncidentClose,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"closeButtonId",disabled:getCloseState(),handler:J},{text:IncidentPage.Labels.IncidentQuickClose,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"quickCloseButtonId",disabled:getCloseState(),handler:i},{text:IncidentPage.Labels.IncidentReopenIncident,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"reopenButtonId",disabled:getReOpenState(),handler:C},{text:IncidentPage.Labels.IncidentIncrementCallCounter,disabled:getCloseState(),id:"incrementCallButtonId",icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",handler:F},{text:IncidentPage.Labels.IncidentResponded,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"respondedButtonId",disabled:getRespondedState(),handler:q},{text:Print,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printButtonId",disabled:IsNewRecord(incidentId),handler:PrintBtnHandler},{text:PrintPDF,icon:getSDFStylesResPath()+"/SDEFimages/_.GIF",id:"printPdfButtonId",disabled:IsNewRecord(incidentId),handler:PrintPDFBtnHandler},"-",customActionJsonString]}," ",{scale:"medium",iconCls:"bmcTemplate",tooltipType:"title",tooltip:IncidentPage.Labels.Template,id:"templatebutton",disabled:getFlagForTemplate(),hidden:disableTrue,handler:l,listeners:{disable:function(){this.setIconClass("bmcTemplateDisable")},enable:function(){this.setIconClass("bmcTemplate")}}},{scale:"medium",iconCls:"bmcAPM",tooltipType:"title",tooltip:IncidentPage.Labels.IncidentMgmtProcess,id:"incProcButton",handler:n}," ",{scale:"medium",iconCls:"bmcEmailMessage",tooltipType:"title",tooltip:IncidentPage.Labels.Email,id:"emailId",hidden:disableTrue,handler:c,listeners:{disable:function(){this.setIconClass("bmcEmailMessageDisable")},enable:function(){this.setIconClass("bmcEmailMessage")}}}," ",{scale:"medium",iconCls:"bmcServiceTargets",tooltipType:"title",tooltip:IncidentPage.Labels.ServiceTargets,id:"servicetargets",disabled:!hasServiceTargets,listeners:{disable:function(){this.setIconClass("bmcServiceTargetsDisable")},enable:function(){this.setIconClass("bmcServiceTargets")}},handler:I}," ",{scale:"medium",iconCls:"bmcKMSearch",tooltipType:"title",tooltip:KMSearchLabel,id:"incidentKMSearch",disabled:getSaveState(),listeners:{disable:function(){this.setIconClass("bmcKMSearchDisable")},enable:function(){this.setIconClass("bmcKMSearch")}},handler:o}," ","-"," ",{scale:"medium",iconCls:"bmcCIExplorer",tooltipType:"title",tooltip:IncidentPage.Labels.LaunchCIExplorer,id:"CIExpBut",listeners:{disable:function(){this.setIconClass("bmcCIExplorerDisable")},enable:function(){this.setIconClass("bmcCIExplorer")}},handler:ShowCIExplorer},new Ext.Toolbar.Fill(),{id:"incident_inactive__c",xtype:"checkbox",width:93,color:"#004376",align:"top",checked:false,boxLabel:'<span class="checkboxLabelCls" style="font-family: Tahoma, MS Sans Serif;font-size: 11px;">'+IncidentPage.Labels.Inactive+"</span>",listeners:{render:function(){Ext.QuickTips.register({target:this,text:IncidentPage.Labels.TooltipIncidentInactive,dismissDelay:20000})}}},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:(getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif"),title:IncidentPage.Labels.PreviousRecord},cls:"cursorCls",listeners:{render:function(e){e.el.on("click",O)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:IncidentPage.Labels.NextRecord},cls:"cursorSpaceCls",listeners:{render:function(e){e.el.on("click",j)}}}]});if(isInactive){Ext.getCmp("incident_inactive__c").setDisabled(true)}if(copymetrue){Ext.getCmp("saveId").setDisabled(true)}Ext.getCmp("incident_inactive__c").setValue(getInactive());incidentId=getIncidentID();incidentState=getStateVar();if(incidentId==null||incidentId==""){Ext.getCmp("emailId").setDisabled(true);Ext.getCmp("emailId").setIconClass("bmcEmailMessageDisable");Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("copyId").setIconClass("bmcCopyDisable");Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("IncidentsforClientId").setDisabled(true);Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}else{if(incidentId!=null){Ext.getCmp("saveId").setDisabled(!incnState);Ext.getCmp("closeButtonId").setDisabled(!incnState);Ext.getCmp("quickCloseButtonId").setDisabled(!incnState);Ext.getCmp("reopenButtonId").setDisabled(incnState);Ext.getCmp("emailId").setDisabled(!incnState)}}if(incidentId==null||incidentId==""){Ext.getCmp("templatebutton").setDisabled(false);Ext.getCmp("templatebutton").setIconClass("bmcTemplate");if(document.getElementById("linkSIAvailTD")!=null){document.getElementById("linkSIAvailTD").style.display="none"}if(document.getElementById("noSIAvailTD")!=null){document.getElementById("noSIAvailTD").style.display="block"}}else{if(incidentId!=null){var N=displaySI(cookieName,iFrameSrc);if(!N){if(document.getElementById("noSIAvailTD")!=null){document.getElementById("noSIAvailTD").style.display="none"}if(document.getElementById("linkSIAvailTD")!=null){document.getElementById("linkSIAvailTD").style.display="block"}}if(setcheckforTemplate=="true"){Ext.getCmp("templatebutton").setDisabled(!incnState)}else{Ext.getCmp("templatebutton").setDisabled(true);Ext.getCmp("templatebutton").setIconClass("bmcTemplateDisable")}}}EnableAdditionalCILink();document.getElementById("capsule").style.display="block";var g=new Ext.Panel({layout:"border",height:Ext.isIE7?670:Ext.isIE?674:Ext.isSafari?695:680,border:false,id:"canvasPanelId",cls:"canvasPanelCls",items:[{xtype:"panel",layout:"fit",overflow:"auto",autoScroll:true,split:false,width:"auto",height:480,cls:"northPanelCls",region:"center",contentEl:Ext.isIE?"capsule":IncidentPageComp.ComponentVars.IncidentForm},{xtype:"panel",layout:"fit",overflow:"auto",border:false,id:"southPanelSI",autoScroll:true,split:true,collapsible:true,collapseMode:"mini",width:"auto",height:Ext.isIE?205:210,minHeight:Ext.isIE?120:150,animCollapse:false,region:"south",listeners:{resize:function(R,T,Q,P,S){if(typeof(Q)=="number"){document.getElementById("detailsDivSI").style.height=Q+"px"}var e=document.getElementById("SIIframeID").style.display;if(e!="none"){if(typeof(window.frames.SIIframeID.setSouthPanelHeight)=="function"){window.frames.SIIframeID.setSouthPanelHeight(Q,T)}}},collapse:function(){this.setWidth("auto")}},contentEl:"detailsDivSI"}],listeners:{afterlayout:function(e){e.layout.south.miniSplitEl.dom.qtip=IncidentPage.Labels.DragResizeClickCollapse;e.layout.south.getCollapsedEl();e.layout.south.miniCollapsedEl.dom.qtip=IncidentPage.Labels.ClickToExpand},single:true}});var D=new Ext.Viewport({layout:"anchor",width:"auto",id:"viewportId",border:false,cls:"viewportCanvasCls",items:[{anchor:"100%",layout:"fit",items:g}]});handleElemEvent();converdisabletoreadonly();if(incidentId==null||incidentId==""){var k=document.getElementById(IncidentPageComp.ComponentVars.UserLastName).value;if(k==null||k==""){try{document.getElementById(IncidentPageComp.ComponentVars.UserLastName).focus()}catch(K){}}}var L=getNoRightsToViewEdit();if(isRecordDeleted()){Ext.Msg.alert(IncidentPage.Labels.Information,IncidentPage.Labels.DeletedRecord,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}else{if(L){Ext.Msg.alert("",labelMsgNoAccessPerm,function(){if((typeof(window.parent)!="undefined")&&(typeof(window.parent.popUpWindow)!="undefined")){window.parent.popUpWindow.close()}closeWindow()})}}pageloadstartdate=0;pageloadstartdate=new Date();var A=pageloadstartdate.getTime();var z=windowloaddate.getTime();var y=(A-renderingstartitme);data+=IncidentPage.Labels.PM_PageLoad;data+=y;var w=getPortelTemplateId();if(w!=null&&typeof(w)!="undefined"&&w!=""){fetchIncidentTemplates(w)}if(copymetrue){copyCommit(chkBoxValue)}ChangeCIExpBtnStatus(cilink_record);ChangeServiceTargetButtonState();UpdateDueDateFieldState();updateKM()});function UpdateDueDateFieldState(){if(dueDateElement!=null&&dueDateElement!="undefined"){UpdateDueDateFieldStateWithArgs(isDueDateOverridenByServiceTarget())}}function UpdateDueDateFieldStateWithArgs(a){if(a){dueDateElement.disabled=true;dueDateElement.readOnly=true;dueDateElement.className="clsAccordionOutputPanelReadOnly";dueDateElement.style.color="#000000"}else{dueDateElement.disabled=false;dueDateElement.readOnly=false;dueDateElement.className="clsFieldSetAccordianTextBox"}}function ChangeServiceTargetButtonState(){if(typeof(Ext.getCmp("servicetargets"))!="undefined"&&Ext.getCmp("servicetargets")!=null){if(!hasServiceTargets){Ext.getCmp("servicetargets").disable()}else{Ext.getCmp("servicetargets").enable()}}}function writeCookie(){if(document.getElementById("configureSIId").checked){createSICookie(cookieName,"true");var a=displaySI(cookieName,iFrameSrc)}}function checkSave(){if(doSave){saveFunctionRef()}}function handleResetChange(){if(clickedOnce){clickedOnce=false;window.parent.registerSave(wid2)}}function openCategoryPage(a){if(a!=null||a!=""){if(a[0]!=null||a[0]!=""){var b=a[3];categoryName=a[0];setIncForCategoryEnabled();checkSave();if(a[4]!=null&&a!="undefined"){document.getElementById(IncidentPageComp.ComponentVars.CategoryFKUrgency).value=a[4]}setCatData(b,categoryName)}if(a[1]!=null||a[1]!=""){setDescriptionNext(a[1])}if(a[2]!=null||a[2]!=""){setResolutionNext(a[2])}}}function openImpactLookup(d,a){var c=a.split("П");for(var e=0;e<c.length;e++){var b=c[e].split(":");var f=b[1]!="null"?b[1]:"";f=decodeSpecialChar(f);if(b[0]=="name"){document.getElementById(IncidentPageComp.ComponentVars.ImpactIDName).value=f}if(b[0]=="id"){document.getElementById(IncidentPageComp.ComponentVars.ImpactID).value=f}}if(d!=null&&d!=""){FetchPriorityHTTP()}}function previousIncidentBtnHandler1(){var b="";var a=0;while(idset.length>a){if(b==""){b=idset[a]}else{b=b+","+idset[a]}a++}previousIncidentBtnHandler(b)}function nextIncidentBtnHandler1(){var b="";var a=0;while(idset.length>a){if(b==""){b=idset[a]}else{b=b+","+idset[a]}a++}nextIncidentBtnHandler(b)}function AssignedToStaff(){openPopup("SearchPage?popupId=Client&isLookup=true&additional_columns=name,username,firstname,lastname,phone,extension,email,ProfileId,Profile.Name&filterClause="+escape("IsStaffUser__c=true")+"&isAssignTo=true",preSetAssignedToStaffNext)}function AssignToSuggestedStaff(){selectedModuleName="staff";openPopup("SearchPage?popupId=SuggestedStaff&isSuggestExpert=true&isLookup=true&queueFor=Incident__c&isQueurorUser=true&isActiveUser=true&additional_columns=FKUser__r.firstname,FKUser__r.lastname,FKUser__r.phone,FKUser__r.extension,FKUser__r.email,FKUser__r.ProfileId,FKUser__r.Profile.Name,QueueName__c,QueueId__c,FKUser__r.Id&categoryId="+incidentCategory+"&filterClause="+escape("FKUser__r.IsStaffUser__c=true"),preSetAssignedToSuggestedStaffNext)}function AssignedToMyself(){Ext.getCmp("assignToMyselfButtonId").setDisabled(true);toggleStaffTooltipState(true);document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=loggedInUserId;document.getElementById(IncidentPageComp.ComponentVars.assignToOwnerId).value=loggedInUserId;document.getElementById(IncidentPageComp.ComponentVars.staff_firstname).value=loggedInUserFirstName;document.getElementById(IncidentPageComp.ComponentVars.staff_laststname).value=loggedInUserLastName;document.getElementById(IncidentPageComp.ComponentVars.staff_phone).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_extension).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_profilename).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value="";handleChange(null)}function deleteIncident(){deleteIncidentNext()}function quickCloseIncident(){quickCloseIncidentNext()}function reopenIncident(){reopenIncidentNext()}function closeWindow(){if(isLookup){window.parent.refreshDocs();window.parent.closePopup()}else{window.parent.refreshList();window.parent.closeTab(wid)}}function isValidDate(){isValid="True"}function DisableCIExpBtn(){var d;var b;var c=document.getElementsByName("FKBMC_BaseElement__c");if(c!=null&&c.length>0){d=c[0].value}var a=document.getElementsByName("FKBusinessService__c");if(a!=null&&a.length>0){b=a[0].value}if((d!=null&&d!="")||(b!=null&&b!="")){Ext.getCmp("CIExpBut").setDisabled(false)}else{Ext.getCmp("CIExpBut").setDisabled(true)}}function setIncForCategoryEnabled(){if(getcategoryName()!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}}function setClientDetails(a){setClientNext(a);if(a!=null){document.getElementById(IncidentPageComp.ComponentVars.UserID).value=a}}function updateDescription(){var a=0;var b=document.getElementById("incident_incidentDescription__c");if(b!=null){KMdescription=b.nextSibling.value;if(KMdescription.length>100){KMdescription=KMdescription.substring(0,99)}}else{KMdescription=""}}function incidentForClient(){var a=document.getElementById(IncidentPageComp.ComponentVars.UserName).value;var c=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;if(c==""){c=document.getElementById(IncidentPageComp.ComponentVars.ContactID).value}if(c==""){var b=document.getElementById(IncidentPageComp.ComponentVars.LeadIDcontroller);if(typeof(b)!="undefined"&&b!=null){c=b.value}}if(a!=null&&a!=""){openPopup("SearchPage?popupId=Incident&filterObj=1&clientId="+c+"&isLookup=true",setIncidentNext)}}function incidentForCatagory(){var a=getcategoryName();if(a!=""){a=encodeURIComponent(a);openPopup("SearchPage?popupId=Incident&filterObj=3&categoryId="+a+"&isLookup=true",setIncidentNext)}}function setIncidentForMenu(){var c=document.getElementById(IncidentPageComp.ComponentVars.UserName).value;var a=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;if(a==""){a=document.getElementById(IncidentPageComp.ComponentVars.ContactID).value}if(a==""){var b=document.getElementById(IncidentPageComp.ComponentVars.LeadIDcontroller);if(typeof(b)!="undefined"&&b!=null){a=b.value}}if(a!=null&&a!=""&&c!=""&&c!=null){Ext.getCmp("IncidentsforClientId").setDisabled(false)}else{Ext.getCmp("IncidentsforClientId").setDisabled(true)}if(getcategoryName()!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}}function FetchUrgency(){var b=document.getElementById(IncidentPageComp.ComponentVars.UserName).value;var a=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;if(a==null||a==""){a=document.getElementById(IncidentPageComp.ComponentVars.ContactID).value}if(a!=null&&a!=""&&b!=""&&b!=null){Ext.getCmp("IncidentsforClientId").setDisabled(false)}else{Ext.getCmp("IncidentsforClientId").setDisabled(true)}if(getcategoryName()!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}FetchUrgencyDetails(a)}function getcategoryName(){var a="";if(document.getElementById(IncidentPageComp.ComponentVars.CategoryIDName)!=null&&document.getElementById(IncidentPageComp.ComponentVars.CategoryIDName)!=""){a=document.getElementById(IncidentPageComp.ComponentVars.CategoryIDName).value}return a}function FetchUrgencyForCategoryTabOut(){var a=document.getElementById(IncidentPageComp.ComponentVars.UserName).value;if(a!=null&&a!=""){Ext.getCmp("IncidentsforClientId").setDisabled(false)}else{Ext.getCmp("IncidentsforClientId").setDisabled(true)}if(getcategoryName()!=""){Ext.getCmp("IncidentsforCategoryId").setDisabled(false)}else{Ext.getCmp("IncidentsforCategoryId").setDisabled(true)}var b=document.getElementById(IncidentPageComp.ComponentVars.UrgencyIDName).value}function ChangeCIExpBtnStatus(a){CI_value=IncidentPageComp.ComponentVars.BaseElementName;service_value=IncidentPageComp.ComponentVars.serviceName;if((0==CI_value.length)&&(0==service_value.length)&&(a=="false")){Ext.getCmp("CIExpBut").setDisabled(true)}else{Ext.getCmp("CIExpBut").setDisabled(false)}}function calculatePriority(){var h=document.getElementById(IncidentPageComp.ComponentVars.ImpactIDName);var g="";if(h!=null){g=h.value}var b=document.getElementById(IncidentPageComp.ComponentVars.UrgencyIDName);var c="";if(b!=null){c=b.value}var f=document.getElementById(IncidentPageComp.ComponentVars.ImpactID);var a="";if(f!=null){a=f.value}var e=document.getElementById(IncidentPageComp.ComponentVars.UrgencyID);var d="";if(e!=null){d=e.value}if(g!=""&&c!=""&&a!=""&&d!=""){calculatePriorityNext()}}function clientLookUp(){FetchUrgencyName()}function copyIncident(){}function selectBroadcast(){var a=document.getElementById(IncidentPageComp.ComponentVars.BroadcastIDName).value;if(a==""){setBroadcastNextFromTabout(a)}}function saveRecords(){chkBoxValue=Ext.getCmp("incident_inactive__c").getValue();isValidDate();if(isValid=="True"){isSaveCalled=true;waitbox(0);Ext.getCmp("saveId").setDisabled(true);if(staffIdString!=null&&staffIdString!=""&&staffIdString!="undefined"){saveIncident(chkBoxValue,ownerIdString,KMids,staffIdString)}else{saveIncident(chkBoxValue,ownerIdString,KMids)}}else{Ext.MessageBox.show({msg:IncidentPage.Labels.ValidDateTime,buttons:Ext.MessageBox.OK})}}function saveBeforeCloseRecords(){chkBoxValue=Ext.getCmp("incident_inactive__c").getValue();isValidDate();waitbox(0);if(isValid=="True"){saveBeforeCloseIncident(chkBoxValue,KMids)}else{Ext.MessageBox.show({msg:IncidentPage.Labels.ValidDateTime,buttons:Ext.MessageBox.OK})}}function getINCid(a,b){if(errormsg==null||errormsg==""||errormsg==IncidentPage.Labels.SavedSuccessfully){setId(a,b)}else{setId(a,b)}}function buttonValidator(){if((incidentClient!=null&&incidentClient!="")&&(((categoryRequired=="false")||(incidentCategory!=null&&incidentCategory!=""))||copymetrue)&&(errormsg==null||errormsg==""||errormsg==IncidentPage.Labels.SavedSuccessfully)){if(setcheckforTemplate=="true"){Ext.getCmp("templatebutton").setDisabled(false);Ext.getCmp("templatebutton").setIconClass("bmcTemplate")}else{Ext.getCmp("templatebutton").setDisabled(true);Ext.getCmp("templatebutton").setIconClass("bmcTemplateDisable")}Ext.getCmp("saveId").setDisabled(!incnState);Ext.getCmp("emailId").setDisabled(!incnState);copymetrue=false;Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconClass("bmcDelete");Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("resetId").setDisabled(false);Ext.getCmp("viewId").setDisabled(false);Ext.getCmp("printButtonId").setDisabled(false);Ext.getCmp("printPdfButtonId").setDisabled(false);Ext.getCmp("copyId").setIconClass("bmcCopy");Ext.getCmp("viewId").setIconClass("bmcView1");var a=document.getElementById("SIIframeID").style.display;if(cookieValue=="true"&&a=="none"){SIComp("/apex/SIContainerPage?oid="+incidentId+"&otype=Incident__c&wid="+wid+"&stateofIncident="+closeState+"&isChangeCreatable="+getIsChangeCreatable()+"&isInactive="+isIncInactive)}else{if(a=="none"){document.getElementById("noSIAvailTD").style.display="none";if(Ext.isChrome){document.getElementById("onDemandSITableId").style.display="inline-table";document.getElementById("linkSIAvailTD").style.display="table-cell"}else{document.getElementById("onDemandSITableId").style.display="block";document.getElementById("linkSIAvailTD").style.display="block"}}}var b=getIncidentFeed();if(b!=null&&b=="true"){}}if((incidentClient!=null||incidentClient!="")&&(incidentCategory==null||incidentCategory=="")){Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("copyId").setIconClass("bmcCopy")}EnableAdditionalCILink()}function closedRelatedBroadcasts(){if(hasRelatedBRD){isclosebroadcast=false;Ext.MessageBox.confirm("",IncidentPage.Labels.IncidentRelatedBroadcastsChanges,function(a){if(a==="yes"){isclosebroadcast=true;closeBroadcasts(isclosebroadcast)}else{closeBroadcasts(isclosebroadcast)}})}}var windownameflag=0;function showData(d,c,b,a){if(isAutocomplete){return}if(taboutFlag!=true){if(typeof(c)!="undefined"&&typeof(b)!="undefined"){if(typeof(a)!="undefined"){showalldata(d,c,b,a)}else{showalldata(d,c,b)}}else{if(typeof(c)!="undefined"&&typeof(b)=="undefined"){showalldata(d,c)}else{showalldata(d)}}}else{if(typeof(c)!="undefined"){c()}}}function ellipse(b,a){if(b.length>a){return b.substr(0,a-3)+"..."}return b}function formCSZString(d,c,b){var a="";if(d!=""){a=ellipse(d,33)+", "}if(c!=""){a=a+ellipse(c,33)+" "}if(b!=""){a=a+ellipse(b,33)}return a}function afterResetSI(){var b=getModName();var a=getParentWid();if(b!=null&&b!=""&&typeof(b)!="undefined"&&a!=null&&a!=""&&typeof(a)!="undefined"&&errormsg==IncidentPage.Labels.SavedSuccessfully){window.parent.registerSave(wid);window.parent.parent.refreshSupportingInformation(a,b)}}function afterAddNote(){var a=document.getElementById("SIIframeID").style.display;if(cookieValue!="true"&&(a=="none")){SIComp(iFrameSrc)}else{if(a!="none"){window.frames.SIIframeID.refreshDocs()}}}function renderPrbId(b,a){document.getElementById(IncidentPageComp.ComponentVars.ProblemIDName).value=a;document.getElementById(IncidentPageComp.ComponentVars.ProblemID).value=b}function afterSaveAction(){var b=getModName();var a=getParentWid();if(b!=null&&b!=""&&typeof(b)!="undefined"&&a!=null&&a!=""&&typeof(a)!="undefined"&&errormsg==IncidentPage.Labels.SavedSuccessfully){return true}else{showError()}}function tooltipforclientJS(d,c,h,g,b,e,f){document.getElementById("clientNameforttdivId").innerHTML=ellipse(d,25)+" "+ellipse(c,25);document.getElementById("clientTitleforttdivId").innerHTML=ellipse(h,40);var a=document.getElementById("clientAddressforttdivId").innerHTML.replace(new RegExp("\\n","g")," ");document.getElementById("clientAddressforttdivId").innerHTML=ellipse(a,33);document.getElementById("clientCSZforttdivId").innerHTML=g;document.getElementById("clientCountryforttdivId").innerHTML=ellipse(b,33);document.getElementById("clientPhoneforttdivId").innerHTML=ellipse(e,33);document.getElementById("clientEmailforttdivId").innerHTML='<a href="'+f+'" class="clsCmdLinkTooltip">'+ellipse(f,33)+"</a>"}function tooltipforstaffJS(f,a,e,c,b,d){strSingleLineText=document.getElementById("userAddressforttdivId").innerHTML.replace(new RegExp("\\n","g")," ");document.getElementById("userAddressforttdivId").innerHTML=ellipse(strSingleLineText,33);document.getElementById("userNameforttdivId").innerHTML=ellipse(f,50);document.getElementById("userTitleforttdivId").innerHTML=ellipse(a,40);document.getElementById("userCSZforttdivId").innerHTML=e;document.getElementById("userCountryforttdivId").innerHTML=ellipse(c,33);document.getElementById("userPhoneforttdivId").innerHTML=ellipse(b,33);document.getElementById("userEmailforttdivId").innerHTML='<a href="'+d+'" class="clsCmdLinkTooltip">'+ellipse(d,33)+"</a>"}function getIncProcBtnHandler(){var a="NavigatorPage?title="+IncidentPage.Labels.IncidentProcess+"&target=IncProcMgmtPage?id=1001";window.parent.parent.addNewTab("Incident Process",IncidentPage.Labels.AlignabilityProcessModel,a,"false")}function setElHeight(b,a){if(b.style.height=="0pt"){b.style.height="25pt";b.value=""}else{if(b.style.height=="25pt"&&b.value==""){b.style.height="0pt";b.value=a}}}function composeMailOnCompleteIn(){var a=document.getElementById("SIIframeID").style.display;if(window.frames.SIIframeID!=null&&typeof(window.frames.SIIframeID)!="undefined"){if(a!="none"){document.getElementById("SIIframeID").contentWindow.composeMailOnComplete()}}}function refreshChatterFeed(){refreshFeed()}function shareTextPost(a){if(a.length>1000){Ext.MessageBox.show({msg:IncidentPage.Labels.TextAreaOverflowForChatter,buttons:Ext.MessageBox.OK});return false}shareStatusPost(a)}function deleteCommentFromFeed(b,a){deleteComment(b,a)}function setDisplay(b,a){document.getElementById(b).style.display=a}function createNewComment(b,c){var a=b.getElementsByTagName("input")[0];if(a.value.length>1000){Ext.MessageBox.show({msg:IncidentPage.Labels.TextAreaOverflowForChatterComment,buttons:Ext.MessageBox.OK});return false}else{if(a.value.trim().length<=0){Ext.MessageBox.show({msg:IncidentPage.Labels.EmptyValueForChatterComment,buttons:Ext.MessageBox.OK});b.getElementsByTagName("input")[0].focus();return false}else{NewCommentValue(a.value,c)}}}function renderAddNoteAfterClose_JS(b,c){if(b!=null){b.disabled=true;b.className="clsInputTextAreaDisabledNote";var a=document.getElementById("addNoteBtn");a.disabled=true;a.className="AddButtonOff"}if(c!=null){c.disabled=true;c.className="clsDurationTextBoxDisable"}}function renderAddNoteButton_JS(c,e,b){if(c!=null){var a=document.getElementById("addNoteBtn");var d=c.value.trim();if(incidentId==null||incidentId==""||d==null||d==""||b=="false"){a.disabled=true;a.className="AddButtonOff"}else{a.disabled=false;a.className="AddButton"}if(incidentId==null||incidentId==""||b=="false"){c.disabled=true;c.className="clsInputTextAreaDisabledNote";e.disabled=true;e.className="clsDurationTextBoxDisable"}else{if(isNoteEnableFlag){c.value="";isNoteEnableFlag=false}c.disabled=false;c.className="clsInputTextAreaNote";e.disabled=false;e.className="clsDurationTextBox"}}}function validateDuration_JS(d){if(d!=""){var b=d.split(":");if(b[0].length==1){d="0"+d;document.getElementById(IncidentPageComp.ComponentVars.IncidentDuration).value=d;durationError=0}var a=/^([0-9]{2}):([0-9]{2})$/;var c=d.match(a);if(c==null){durationError=1;Ext.MessageBox.show({msg:IncidentPage.Labels.DurationError,buttons:Ext.MessageBox.OK});document.getElementById(IncidentPageComp.ComponentVars.IncidentDuration).value="00:00"}}}function enableAddNote_JS(){if((errormsg!=""&&errormsg!=null)||errormsg==IncidentPage.Labels.DurationError){var a=document.getElementById("addNoteBtn");a.disabled=false;a.className="AddButton";var b=document.getElementById(IncidentPageComp.ComponentVars.IncidentNotes);b.disabled=false;b.className="clsInputTextAreaNote";var c=document.getElementById(IncidentPageComp.ComponentVars.IncidentDuration);c.disabled=false;c.className="clsDurationTextBox";c.value="00:00"}}function disableAddNote_JS(c,b){validateDuration_JS(b);if(durationError!=1){if(c.length>32000){Ext.MessageBox.show({msg:IncidentPage.Labels.Note+": "+IncidentPage.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK})}else{var a=document.getElementById("addNoteBtn");a.disabled=true;a.className="AddButtonOff";saveNote(c,b)}}durationError=0}function renderIncidentNote_JS(){if((errormsg!=""&&errormsg!=null)||errormsg==IncidentPage.Labels.DurationError){Ext.MessageBox.show({msg:errormsg,buttons:Ext.MessageBox.OK})}else{var a=document.getElementById(IncidentPageComp.ComponentVars.IncidentNotes);if(a!=null){a.disabled=false;a.className="clsInputTextAreaNote";a.value="";if(insideNote==false){clickedOnce=true;handleResetChange()}}var b=document.getElementById(IncidentPageComp.ComponentVars.IncidentDuration);if(b!=null){b.disabled=false;b.value="00:00"}}}function loadChatterFeeds(){if(!this.FeedsVisible){showChatterFeeds();this.FeedsVisible=true}}function siControlBack(){var b=Ext.util.Cookies.get(cookieName);var a=document.getElementById("SIIframeID").style.display;if((b==null||b=="false")&&a=="none"){afterResetSI()}}function SetIncidentCategory(a){if(a!=null&&a!=""){incidentCategory=document.getElementById(IncidentPageComp.ComponentVars.CategoryIDName).value}}function DisplayChatterLimitMessage(){var a=getChatterLimitErrorMessage();if(a!=""&&a!=null&&a.length>0){Ext.MessageBox.show({msg:a,buttons:Ext.MessageBox.OK})}}function preSetAssignedToStaffNext(f,a){waitbox(0);if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0].toLowerCase()=="firstname"){document.getElementById(IncidentPageComp.ComponentVars.staff_firstname).value=e}if(b[0].toLowerCase()=="lastname"){document.getElementById(IncidentPageComp.ComponentVars.staff_laststname).value=e}if(b[0].toLowerCase()=="phone"){document.getElementById(IncidentPageComp.ComponentVars.staff_phone).value=e}if(b[0].toLowerCase()=="extension"){document.getElementById(IncidentPageComp.ComponentVars.staff_extension).value=e}if(b[0].toLowerCase()=="profile.name"){document.getElementById(IncidentPageComp.ComponentVars.staff_profilename).value=e}if(b[0].toLowerCase()=="queue"){document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value=e}}}if(f!=null&&f!=""){document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=f;document.getElementById(IncidentPageComp.ComponentVars.assignToOwnerId).value=f;document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value="";toggleStaffTooltipState(true);Ext.getCmp("assignToMyselfButtonId").setDisabled(false);handleChange(null)}waitMsg.hide()}function toggleStaffTooltipState(a){document.getElementById("staffInfobtn").disabled=a}function preSetAssignedToSuggestedStaffNext(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0].toLowerCase()=="fkuser__r.firstname"){document.getElementById(IncidentPageComp.ComponentVars.staff_firstname).value=e}if(b[0].toLowerCase()=="fkuser__r.lastname"){document.getElementById(IncidentPageComp.ComponentVars.staff_laststname).value=e}if(b[0].toLowerCase()=="fkuser__r.phone"){document.getElementById(IncidentPageComp.ComponentVars.staff_phone).value=e}if(b[0].toLowerCase()=="fkuser__r.extension"){document.getElementById(IncidentPageComp.ComponentVars.staff_extension).value=e}if(b[0].toLowerCase()=="fkuser__r.profile.name"){document.getElementById(IncidentPageComp.ComponentVars.staff_profilename).value=e}if(b[0].toLowerCase()=="queuename__c"){document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value=e}if(b[0].toLowerCase()=="queueid__c"){document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=e;toggleStaffTooltipState(true)}if(b[0].toLowerCase()=="queue.name"){document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value=e}if(b[0].toLowerCase()=="queueid"){document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=e;document.getElementById(IncidentPageComp.ComponentVars.assignToOwnerId).value=e;document.getElementById(IncidentPageComp.ComponentVars.staff_firstname).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_laststname).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_phone).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_extension).value="";document.getElementById(IncidentPageComp.ComponentVars.staff_profilename).value="";toggleStaffTooltipState(true)}if(b[0].toLowerCase()=="fkuser__r.id"){document.getElementById(IncidentPageComp.ComponentVars.incidentOwnerId).value=e;document.getElementById(IncidentPageComp.ComponentVars.assignToOwnerId).value=e;document.getElementById(IncidentPageComp.ComponentVars.staff_queue).value="";toggleStaffTooltipState(true)}}Ext.getCmp("assignToMyselfButtonId").setDisabled(false);handleChange(null)}}function getClientTypeAndRecordId(){if(document.getElementById(IncidentPageComp.ComponentVars.clientHiddenInput)!=null){recId=document.getElementById(IncidentPageComp.ComponentVars.clientHiddenInput).value}clientType="User";if(recId==""){if(document.getElementById(IncidentPageComp.ComponentVars.contactHiddenInput)!=null){recId=document.getElementById(IncidentPageComp.ComponentVars.contactHiddenInput).value}clientType="Contact"}if(recId==""){if(document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput)!=null){recId=document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput).value}clientType="Lead"}if(recId==""){clientType=""}}function callClientTooltip(eventObject){var target=eventObject.target;if(target==null){target=eventObject.srcElement}getClientTypeAndRecordId();if(recId!=""){if(!remoteCallFlag){remoteCallFlag=true;eval(orgNamespace).ClientInfo.getClientInfo(recId,clientType,incAccountName,function(result,event){if(event.status){tooltipHtmlResult="";var fieldLabels=result.oblectFieldLabels;var fieldDisplayLabels=result.displayFieldLabels;var delimiter=String.fromCharCode(172);tooltipHtmlResult='<table cellpadding=4 cellspacing=3 width="290" border=0 style="table-layout:fixed; font-size:11px;">';if(result!=""&&result!=null){var fieldListArray=fieldLabels.split(";");var fieldDisplayArray=fieldDisplayLabels.split(delimiter);var i=0;for(i=0;i<fieldListArray.length-1;i++){if(result[fieldListArray[i]]!=undefined){if(fieldListArray[i]=="Name"){tooltipHtmlResult+='<tr><td width="40%" style="font-weight:bold; word-wrap:break-word;">'+fieldDisplayArray[i]+'</td><td style="white-space:normal; font-weight:bold; word-wrap:break-word;">'+result[fieldListArray[i]]+"</td></tr>"}else{if(fieldListArray[i]=="Email"){tooltipHtmlResult+='<tr><td style="font-weight:bold; word-wrap:break-word;" >'+fieldDisplayArray[i]+'</td><td style="word-wrap:break-word;" class="clsCmdLinkTooltip">'+result[fieldListArray[i]]+"</td></tr>"}else{if(fieldListArray[i]=="AccountId"&&hideAccount=="true"){tooltipHtmlResult+=""}else{tooltipHtmlResult+='<tr><td style="font-weight:bold; word-wrap:break-word;" >'+fieldDisplayArray[i]+'</td><td style="word-wrap:break-word;">'+result[fieldListArray[i]]+"</td></tr>"}}}}}tooltipHtmlResult+="</table>";tooltipforclientstaff=new Ext.QuickTip({target:target.id,anchor:"left",width:Ext.isIE?Ext.isIE7?305:295:308,trackMouse:false,bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",hideDelay:3000,dismissDelay:5000,html:tooltipHtmlResult});Ext.sequence(Ext.QuickTip.prototype,"afterRender",function(){this.mon(this.el,"mouseover",function(){this.clearTimer("hide");this.clearTimer("dismiss")},this);this.mon(this.el,"mouseout",function(){this.clearTimer("show");if(this.autoHide!==false){this.delayHide()}},this)});tooltipforclientstaff.show()}}else{if(event.type==="exception"){alert(event.message)}}},{escape:true})}else{if(tooltipforclientstaff!=null){tooltipforclientstaff.show()}}}}function callRequestDetailTooltip(eventObject){var requestDetailId=getRequestDetailID();var target=eventObject.target;if(target==null){target=eventObject.srcElement}if(requestDetailId!=""&&tooltipforreqdetail==null){eval(orgNamespace).ClientInfo.getRequestDetailInfo(requestDetailId,function(result,event){if(event.status){tooltipHtmlResultReqDetail="";var fieldLabels=result.objectFieldLabels;var fieldDisplayLabels=result.displayFieldLabels;tooltipHtmlResultReqDetail='<table cellpadding=4 cellspacing=3 width="290" border=0 style="table-layout:fixed; font-size:11px;">';if(result!=""&&result!=null){var fieldListArray=fieldLabels.split(";");var fieldDisplayArray=fieldDisplayLabels.split(";");var i=0;for(i=0;i<fieldListArray.length-1;i++){tooltipHtmlResultReqDetail+='<tr><td width="40%" style="font-weight:bold; word-wrap:break-word;">'+fieldListArray[i]+'</td><td style="white-space:normal; font-weight:bold; word-wrap:break-word;">'+fieldDisplayArray[i].replace(undefined,"").replace(null,"")+"</td></tr>"}tooltipHtmlResultReqDetail+="</table>";tooltipforreqdetail=new Ext.QuickTip({target:target.id,anchor:"left",width:Ext.isIE?Ext.isIE7?305:295:308,trackMouse:false,bodyStyle:"font: 8pt Tahoma, Verdana, Arial; color:black;width:2%;border-color:black;",hideDelay:200,dismissDelay:5000,html:tooltipHtmlResultReqDetail});Ext.sequence(Ext.QuickTip.prototype,"afterRender",function(){this.mon(this.el,"mouseover",function(){this.clearTimer("hide");this.clearTimer("dismiss")},this);this.mon(this.el,"mouseout",function(){this.clearTimer("show");if(this.autoHide!==false){this.delayHide()}},this)});tooltipforreqdetail.show()}}else{if(event.type==="exception"){alert(event.message)}}},{escape:true})}else{if(tooltipforreqdetail!=null){tooltipforreqdetail.show()}}}function refreshDesc(){var a=document.getElementById("incident_incidentDescription__c");if(a!=null&&typeof(a)!="undefined"){a.value=incDesc;a.nextSibling.value=incDesc}}function refreshResolution(){var a=document.getElementById("incident_incidentResolution__c");if(a!=null&&typeof(a)!="undefined"){a.value=incResolution;a.nextSibling.value=incResolution}}function refreshRelatedPortlets(){if(typeof(window.parent.parent.refreshActionItemsPortlet)=="function"){window.parent.parent.refreshActionItemsPortlet("Action Items","INC")}if((getIsChildTempExist()=="true"||getIsChildTempExist()==true)&&typeof(window.parent.parent.refreshActionItemsPortlet)=="function"){window.parent.parent.refreshActionItemsPortlet("Action Items","TASK")}clearTimeout(timeoutreturn)}function refreshBroadcastReleatedPortlets(){if(typeof(window.parent.parent.refreshPortletByTitle)=="function"){window.parent.parent.refreshPortletByTitle("Broadcasts")}if(typeof(window.parent.parent.refreshActionItemsPortlet)=="function"){window.parent.parent.refreshActionItemsPortlet("Action Items","BROAD")}}function hideEmptyAccordian(){if(hideBroadcastAccordion){document.getElementById(IncidentPageComp.ComponentVars.broadcastAccordionPanelId).style.display="none"}if(hideCIAccordion){document.getElementById(IncidentPageComp.ComponentVars.ciAccordionPanelId).style.display="none"}if(hideClientAccordion){}if(hideCustomFieldAccordion){document.getElementById(IncidentPageComp.ComponentVars.CustomFieldAccordionPanelId).style.display="none"}}function callFetchUrgencyHTTPJS(a,b,d,c){if(a==""&&b==""){return false}else{if(a==""&&b!=""&&c!=""){return true}else{if(a!=""&&b==""&&d!=""){return true}else{if(a!=""&&b!=""){if(c!=""||d!=""){return true}else{return false}}}}}return false}function disableSIMenu(){if(document.getElementById(IncidentPageComp.ComponentVars.StatusId).value=="CLOSED"){window.frames.SIIframeID.disableAll()}}function reopenedRelatedBroadcasts(){if(hasRelatedBRD){isclosebroadcast=false;Ext.MessageBox.confirm("",IncidentPage.Labels.IncidentRelatedBroadcastsChanges,function(a){if(a==="yes"){isclosebroadcast=true;reopenBroadcasts(isclosebroadcast)}else{reopenBroadcasts(isclosebroadcast)}})}}function convertUserCalledToInt(){var f=doubleTypeFlds.split(",");var d=doubleTypeRead.split(",");if(typeof(f)!="undefined"&&f.length>0&&typeof(d)!="undefined"&&d.length>0){for(var c=0;c<f.length;c++){idStrVal="incident_"+f[c];if(document.getElementById("incident_"+f[c])!=null&&document.getElementById("incident_"+f[c]).value!=null&&document.getElementById("incident_"+f[c]).value!=""&&d[c]=="true"){var b;if(f[c]=="call__c"){b=parseInt(intVal)}else{var a=document.getElementById(idStrVal).value.split(".");if(a.length>0&&parseInt(a[1])==0){b=parseInt(document.getElementById(idStrVal).value)}else{b=document.getElementById(idStrVal).value}}document.getElementById("incident_"+f[c]+"numeric").value=b;var e=document.getElementById("incident_"+f[c]+"numeric");if((typeof(e)!="undefined")&&(e!=null)){var g=e.nextSibling;if((typeof(g)!="undefined")&&(g!=null)){g.value=b}}}}}}function copyResolutionAndCloseIncident(c){var a=document.getElementById("incident_incidentResolution__c");if((typeof(a)!="undefined")&&(a!=null)){var b=a.nextSibling;if((typeof(b)!="undefined")&&(b!=null)){b.value=c}}quickCloseIncident()}function updateInactive(){Ext.getCmp("incident_inactive__c").setValue(isIncInactive);createControlMap();renderElementsByType()}function renderSIComponent(){if(cookieValue==true||cookieValue=="true"){SIComp("/apex/SIContainerPage?oid="+incidentId+"&otype=Incident__c&wid="+wid+"&stateofIncident="+closeState+"&isChangeCreatable="+getIsChangeCreatable()+"&isInactive="+isIncInactive)}else{removeSI("/apex/SIContainerPage?oid="+incidentId+"&otype=Incident__c&wid="+wid+"&stateofIncident="+closeState+"&isChangeCreatable="+getIsChangeCreatable()+"&isInactive="+isIncInactive)}}function checkEnable(){if((errormsg==null||errormsg==""||errormsg==IncidentPage.Labels.SavedSuccessfully)&&!isError){hasRelatedBRD=getHasRelatedBroadcasts();templateEnable=getFlagForTemplate();Ext.getCmp("assignToMyselfButtonId").setDisabled(getAssignMyselfState());Ext.getCmp("assignToStaffButtonId").setDisabled(!incnState);Ext.getCmp("assignToSuggestedStaffButtonId").setDisabled(!incnState);Ext.getCmp("assignToMemberOfAdminButtonId").setDisabled(!incnState);Ext.getCmp("assignToQueueButtonId").setDisabled(!incnState);Ext.getCmp("closeButtonId").setDisabled(!incnState);Ext.getCmp("quickCloseButtonId").setDisabled(!incnState);Ext.getCmp("reopenButtonId").setDisabled(incnState);Ext.getCmp("incrementCallButtonId").setDisabled(!incnState);Ext.getCmp("respondedButtonId").setDisabled(!incnState);Ext.getCmp("emailId").setDisabled(!incnState)}Ext.getCmp("saveId").setDisabled(!incnState);Ext.getCmp("incidentKMSearch").setDisabled(!incnState);Ext.getCmp("templatebutton").setDisabled(!incnState)}function getCustomActionURL(customId){var incId=getIncidentIDForPrb();eval(orgNamespace).JSRemoteActions.getCustomActionURL("Incident",incId,customId,function(result,event){if(event.status){if(result!=""&&result!=null){urlStringVar=result;openUrl()}}else{if(event.type==="exception"){Ext.Msg.alert("",event.message)}}},{escape:false})}function OpenHelpUrl(a){if(a.toLowerCase().indexOf("incidentservicetarget")!=-1){OpenHelppage("ServiceTransaction","module","form")}else{if(a.toLowerCase().indexOf("servicerequestdetail")!=-1){OpenHelppage("ServiceRequestDetail","module","form")}else{if(a.toLowerCase().indexOf("composeemailpage")!=-1){OpenHelppage("EmailConversation","module","form")}}}}function disableSRDlookup(){if(isServiceRequest!=null&&isServiceRequest!=""&&isServiceRequest==IncidentPage.Labels.ExtjsMessageYes){var a=document.getElementById("reqDefLookupBtn");if(a!=null){a.disabled=true}var b=getSRDtitle();if(b!=null){b.disabled=true;b.style.backgroundColor="#D4D0C8";b.style.color="#000000";if(Ext.isIE){b.style.width="195px";b.className="clsPanelInputTextboxReadOnly"}}}}function updateKM(){if(getSaveState()==false){Ext.getCmp("incidentKMSearch").setDisabled(false);Ext.getCmp("incidentKMSearch").setIconClass("bmcKMSearch")}else{Ext.getCmp("incidentKMSearch").setDisabled(true);Ext.getCmp("incidentKMSearch").setIconClass("bmcKMSearchDisable")}}function populateSRDrelatedValues(){populateBusinessService();populateServiceOffering()}function fieldSetTabOut(d,c){if(!inProgress){compId=d.id;if(d.id=="BMC_BusinessService__c_id_instance_name__c"||d.id=="BMC_BaseElement__c_id_name__c"){var b=getFilterClause("FKBusinessService__c");showalldata(c,referenceCallBackFun,b)}else{if(d.id=="BMC_BusinessService__c_id_instance_name__c__xx_1"||d.id=="BMC_BaseElement__c_id_name__c__xx_1"){var a=getFilterClause("FKServiceOffering__c");showalldata(c,referenceCallBackFun,a)}else{if(d.id=="BMC_BaseElement__c_id_name__x_3"){showalldata(c,referenceCallBackFun,"MarkAsDeleted__c = false")}else{if(d.id=="SRM_RequestDefinition__c_id_servicerequesttitle__c"){if(document.getElementById(compId).value==""){document.getElementById(IncidentPageComp.ComponentVars.reqDefnName).value="";document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value=""}showalldata(c,referenceCallBackFun,escape("inactive__c = false"))}else{if(d.id=="OpenBy__c_id_name"){showalldata(c,referenceCallBackFun,escape(" IsActive=true AND IsStaffUser__c = true"))}else{showalldata(c,referenceCallBackFun,"")}}}}}resetReferenceFields(d)}}function referenceCallBackFun(a){if(a!=""&&a!=null){if(compId.indexOf(broadcastFieldIdForName)!=-1){setBroadcastNextJS(a,true)}else{if(compId=="SRM_RequestDefinition__c_id_servicerequesttitle__c"){poplateSRDvalues(a)}else{if(compId=="BMC_BusinessService__c_id_instance_name__c__xx_1"||compId=="BMC_BaseElement__c_id_name__c__xx_1"){setServiceOfferingTB(a)}}}}}function populateBusinessService(){var a;if(!isFlattenedCmdb){a=document.getElementById("BMC_BusinessService__c_id_instance_name__c")}else{a=document.getElementById("BMC_BaseElement__c_id_name__c")}if(a!=null){var b=document.getElementById(IncidentPageComp.ComponentVars.bsName);if(b!=null){a.value=b.value}}var d;if(!isFlattenedCmdb){d=document.getElementById("BMC_BusinessService__c_id_fkbmc_baseelement__c")}else{d=document.getElementById("BMC_BaseElement__c_id_id")}if(d!=null){var c=document.getElementById(IncidentPageComp.ComponentVars.bsId);if(c!=null){d.value=c.value}}}function populateServiceOffering(){var d;if(!isFlattenedCmdb){d=document.getElementById("BMC_BusinessService__c_id_instance_name__c__xx_1")}else{d=document.getElementById("BMC_BaseElement__c_id_name__c__xx_1")}if(d!=null){var a=document.getElementById(IncidentPageComp.ComponentVars.soName);if(a!=null){d.value=a.value}}var c;if(!isFlattenedCmdb){c=document.getElementById("BMC_BusinessService__c_id_fkbmc_baseelement__c__xx_1")}else{c=document.getElementById("BMC_BaseElement__c_id_id__xx_1")}if(c!=null){var b=document.getElementById(IncidentPageComp.ComponentVars.soId);if(b!=null){c.value=b.value}}}function getFilterClause(a){var b="";if(!isFlattenedCmdb){if(a=="FKServiceOffering__c"){var c=document.getElementById("BMC_BusinessService__c_id_fkbmc_baseelement__c").value;if(c!=null&&c!=""&&c!="undefined"){b=escape("(serviceType__c = 'Offering') And (FKBusinessService__c ='"+c+"')  And (end_date__c = null or end_date__c >="+soqlDateClause+") AND FKBMC_BaseElement__r.MarkAsDeleted__c = false")}else{b=escape("(serviceType__c = 'Offering') And (end_date__c = null or end_date__c >="+soqlDateClause+") AND FKBMC_BaseElement__r.MarkAsDeleted__c = false")}}else{if(a=="FKBusinessService__c"){b=escape("(serviceType__c != 'Offering') And (end_date__c = null or end_date__c >="+soqlDateClause+") AND FKBMC_BaseElement__r.MarkAsDeleted__c = false")}}}else{if(a=="FKServiceOffering__c"){var c=document.getElementById("BMC_BaseElement__c_id_id").value;if(c!=null&&c!=""&&c!="undefined"){b=escape("(serviceType__c = 'Offering') And (FKBusinessService__c ='"+c+"')  And (enddate__c = null or enddate__c >="+soqlDateClause+") AND MarkAsDeleted__c = false")}else{b=escape("(serviceType__c = 'Offering') And (enddate__c = null or enddate__c >="+soqlDateClause+") AND MarkAsDeleted__c = false")}}else{if(a=="FKBusinessService__c"){b=escape("(serviceType__c != 'Offering') And (enddate__c = null or enddate__c >="+soqlDateClause+") AND MarkAsDeleted__c = false")}}}return b}function openPopUpFS(e,a,c,d){if(!inProgress){if(a=="FKRequestDefinition__c"||a=="FKServiceOffering__c"||a=="FKBusinessService__c"){var b=getFilterClause(a);openLookupPopup(e,a,"Incident__c",c,b)}else{if(a=="FKBroadcast__c"){openLookupPopup(e,a,"Incident__c",c)}else{openLookupPopup(e,a,"Incident__c")}}return false}}function openSRDetailpopUp(h){var b=document.getElementById(IncidentPageComp.ComponentVars.reqDefinationID);var e=document.getElementById("SRM_RequestDefinition__c_id_servicerequesttitle__c");var d=document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value;var g;if(e!=null){g=e.value}var c=b.value;var a;var f=getIncidentIDForSRD();getClientTypeAndRecordId();if(typeof(clientType)!="undefined"&&clientType!=null){if(clientType.toUpperCase()=="CONTACT"){a=document.getElementById(IncidentPageComp.ComponentVars.ContactID).value}else{if(clientType.toUpperCase()=="LEAD"){a=document.getElementById(IncidentPageComp.ComponentVars.LeadID).value}else{a=document.getElementById(IncidentPageComp.ComponentVars.UserID).value}}}if((c!=null&&c!=""&&g!=null&&g!="")||((d!=null&&d!="")&&(f!=null&&f!=""))){openPopupWithTitle("ServiceRequestDetail?incidentId="+f+"&isLookup=true&reqDefId="+c+"&reqDtlsId="+d+"&clientId="+a+"&clientType="+clientType,null,IncidentPage.Labels.ServiceRequestLabel,563,650)}}function disableRequestDetailBtn(){var d=document.getElementById(IncidentPageComp.ComponentVars.reqDefinationID);var c=document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value;if(d!=null&&d!="undefined"){var b=d.value;var a=document.getElementById("reqDetailBtn");if(a!=null){if((d==null||d=="")&&(c==null||c=="")){a.disabled=true}else{a.disabled=false}}}}function setClientRelatedFields(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="firstname"){document.getElementById(clFname).value=e}if(b[0]=="lastname"){document.getElementById(clLname).value=e}if(b[0]=="username"){document.getElementById(clUname).value=e}if(b[0]=="id"){document.getElementById(IncidentPageComp.ComponentVars.UserID).value=e;document.getElementById(IncidentPageComp.ComponentVars.TipUserID).value=e}if(b[0]=="contact.accountid"){if(e!=null&&e!=""){document.getElementById(incAccountId).value=e}}if(b[0]=="contact.account.name"){if(e!=null&&e!=""){document.getElementById(accname).value=e}}if(b[0]=="Account_ID__c"){if(e!=null&&e!=""){document.getElementById(incAccountId).value=e}}if(b[0]=="Account_Name__c"){if(e!=null&&e!=""){document.getElementById(accname).value=e}}}}FetchUrgencyHTTP();setElementValues();converdisabletoreadonly()}function setAccountNext(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="name"){document.getElementById(accname).value=e}if(b[0]=="id"){document.getElementById(incAccountId).value=e}}}}function setStatusField(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="name"){document.getElementById(IncidentPageComp.ComponentVars.StatusId).value=e}else{if(b[0]=="id"){document.getElementById(IncidentPageComp.ComponentVars.Status_Id).value=e}else{if(b[0]=="stage__c"){document.getElementById(IncidentPageComp.ComponentVars.StatusStage).value=e}}}}}}function setUrgencyField(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="name"){document.getElementById(IncidentPageComp.ComponentVars.UrgencyIDName).value=e}if(b[0]=="id"){document.getElementById(IncidentPageComp.ComponentVars.UrgencyID).value=e}}}if(f!=null&&f!=""){FetchPriorityHTTP()}}function setFieldsFromClientSearchPage(id,add_info){var arrayAsJSONText=eval("("+add_info+")");if(arrayAsJSONText!=null&&arrayAsJSONText!=undefined){document.getElementById(clFname).value=arrayAsJSONText.firstname!=undefined?arrayAsJSONText.firstname:"";document.getElementById(clLname).value=arrayAsJSONText.lastname;if(arrayAsJSONText.accountid!=null&&arrayAsJSONText.accountid!=""&&arrayAsJSONText.accountid!=undefined){document.getElementById(incAccountId).value=arrayAsJSONText.accountid;document.getElementById(accname).value=arrayAsJSONText.accountname}if(arrayAsJSONText.Account_ID__c!=null&&arrayAsJSONText.Account_ID__c!=""&&arrayAsJSONText.Account_ID__c!=undefined){document.getElementById(incAccountId).value=arrayAsJSONText.Account_ID__c;document.getElementById(accname).value=arrayAsJSONText.Account_Name__c}if(arrayAsJSONText.clienttype=="User"){setClient(id,arrayAsJSONText)}if(arrayAsJSONText.clienttype=="Contact"){setContact(id,arrayAsJSONText)}if(arrayAsJSONText.clienttype=="Lead"){setLead(id,arrayAsJSONText)}}FetchUrgencyHTTP();setElementValues();converdisabletoreadonly()}function setClient(b,a){document.getElementById(clUname).value=a.username;if(b!=null&&b!=""){document.getElementById(IncidentPageComp.ComponentVars.UserID).value=b;document.getElementById(IncidentPageComp.ComponentVars.TipUserID).value=b;document.getElementById(IncidentPageComp.ComponentVars.clientHiddenInput).value=b;document.getElementById(IncidentPageComp.ComponentVars.contactHiddenInput).value="";if(document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput)!=null){document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput).value=""}document.getElementById(IncidentPageComp.ComponentVars.ClientTypeID).value="User"}}function setContact(b,a){if(a.clientid!=null&&a.clientid!=""&&a.clientid!=undefined){document.getElementById(clUname).value=a.username;document.getElementById(IncidentPageComp.ComponentVars.UserID).value=a.clientid;document.getElementById(IncidentPageComp.ComponentVars.TipUserID).value=a.clientid;document.getElementById(IncidentPageComp.ComponentVars.clientHiddenInput).value=a.clientid;document.getElementById(IncidentPageComp.ComponentVars.contactHiddenInput).value="";if(document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput)!=null){document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput).value=""}document.getElementById(IncidentPageComp.ComponentVars.ClientTypeID).value="User"}else{document.getElementById(clUname).value=a.name;document.getElementById(IncidentPageComp.ComponentVars.clientHiddenInput).value="";document.getElementById(IncidentPageComp.ComponentVars.contactHiddenInput).value=b;if(document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput)!=null){document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput).value=""}document.getElementById(IncidentPageComp.ComponentVars.ClientTypeID).value="Contact"}}function setLead(b,a){document.getElementById(clUname).value=a.name;if(b!=null&&b!=""){document.getElementById(IncidentPageComp.ComponentVars.clientHiddenInput).value="";document.getElementById(IncidentPageComp.ComponentVars.contactHiddenInput).value="";if(document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput)!=null){document.getElementById(IncidentPageComp.ComponentVars.leadHiddenInput).value=b}document.getElementById(incAccountId).value="";document.getElementById(accname).value="";document.getElementById(IncidentPageComp.ComponentVars.ClientTypeID).value="Lead"}}function resetSRDtldVal(){var a=document.getElementById(IncidentPageComp.ComponentVars.reqDefinationID);if(a!=null&&typeof(a)!="undefined"&&a!=""){if(reqDtlsId==""){reqDtlsId=a.value}else{if(a.value!=reqDtlsId){reqDtlsId=a.value;document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value=""}}}else{document.getElementById(IncidentPageComp.ComponentVars.reqDetailID).value=""}}function setServiceRelatedFields(f,a){if(a!=null&&a!=undefined){var c=a.split("П");for(var d=0;d<c.length;d++){var b=c[d].split(":");var e=b[1]!="null"?b[1]:"";e=decodeSpecialChar(e);if(b[0]=="instance_name__c"){document.getElementById(IncidentPageComp.ComponentVars.bsName).value=e}else{if(b[0]=="fkbmc_baseelement__c"){document.getElementById(IncidentPageComp.ComponentVars.bsId).value=e}}}}}function setServiceOfferingRelatedValues(e,b){if(b!=null&&b!=undefined){var d=b.split("П");for(var f=0;f<d.length;f++){var c=d[f].split(":");var h=c[1]!="null"?c[1]:"";h=decodeSpecialChar(h);if(c[0]=="instance_name__c"){document.getElementById(IncidentPageComp.ComponentVars.soName).value=h}else{if(c[0]=="fkbmc_baseelement__c"){document.getElementById(IncidentPageComp.ComponentVars.soId).value=h}}}}var a=document.getElementById(IncidentPageComp.ComponentVars.bsName).value;var g=document.getElementById(IncidentPageComp.ComponentVars.bsName).value;if(a==""||g==""){setServiceOffering(e)}}function linkCIIncidentJS(a){if(window.frames.SIIframeID.linkCIIncident!="undefined"&&window.frames.SIIframeID.linkCIIncident!=null){window.frames.SIIframeID.linkCIIncident(a)}else{linkCIIncident(a)}}function EnableAdditionalCILink(){var c=document.getElementsByName("FKBMC_BaseElement__c");var a;if(c!=null&&c.length>0){primaryCI=c[0].value}var b=document.getElementsByName("FKBusinessService__c");if(b!=null&&b.length>0){a=b[0].value}if((primaryCI!=null&&primaryCI!=""||a!=null&&a!="")&&incidentId!=""&&incidentId!=null){document.getElementById("linkAddCiID").style.display="block"}DisableCIExpBtn()}function getCIelemID(){var b=document.getElementsByName("FKBMC_BaseElement__c");if(b!=null&&b.length>0){var a=b[0].value;if(a!=""&&a!=null){return document.getElementsByName("FKBMC_BaseElement__c_id")[0].value}else{return""}}else{return""}}function getServiceElemID(){var a=document.getElementsByName("FKBusinessService__c");if(a!=null&&a.length>0){var b=a[0].value;if(b!=""&&b!=null){return document.getElementsByName("FKBusinessService__c_id")[0].value}else{return""}}else{return""}}function setBroadcastNextJS(c,s){var i=document.getElementById(clLname).value;var g=document.getElementById(clFname).value;var f=document.getElementById(clUname).value;var h=document.getElementById(IncidentPageComp.ComponentVars.UserID).value;var n=document.getElementById(accname).value;var d=document.getElementById(incAccountId).value;var u=document.getElementById("SRM_RequestDefinition__c_id_servicerequesttitle__c");var q="";var t="";if(u!=null){q=u.value;if(u.nextSibling!=null&&u.nextSibling!="undefined"&&u.nextSibling.value!="undefined"){t=u.nextSibling.value}}var a=document.getElementById("incident_incidentDescription__c");var j="";if(a!=null&&typeof(a)!="undefined"){j=a.nextSibling.value}var k=document.getElementById("incident_incidentResolution__c");var p="";if(k!=null&&typeof(k)!="undefined"){p=k.nextSibling.value}var r=document.getElementById(IncidentPageComp.ComponentVars.StatusId).value;var b=document.getElementById(IncidentPageComp.ComponentVars.Status_Id).value;var m=document.getElementById(IncidentPageComp.ComponentVars.ImpactIDName).value;var o=document.getElementById(IncidentPageComp.ComponentVars.ImpactID).value;var l=document.getElementById(IncidentPageComp.ComponentVars.UrgencyIDName).value;var e=document.getElementById(IncidentPageComp.ComponentVars.UrgencyID).value;if(s!=null&&s){waitbox(0);setBroadcastNextFromTabout(c,i,g,f,h,n,d,q,t,j,p,r,b,m,o,l,e)}else{waitbox(0);setBroadcastNext(c,i,g,f,h,n,d,q,t,j,p,r,b,m,o,l,e)}};