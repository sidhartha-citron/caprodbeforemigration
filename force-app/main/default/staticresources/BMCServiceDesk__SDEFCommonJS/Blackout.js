var errormsg;var blackoutId;var blackoutSDate;var blackoutEDate;var taboutFlag=false;var isAutocomplete=false;var isBlackoutCreatable;var isBlackoutDeletable;var duration=0,clickedOnce=false;var addNoteHandler;var newActionHandler;var viewActionHistoryBtnHandler;document.onclick=activateWindow;function callCopyPage(){window.parent.addTab("BlackOutPage?copyid="+getblackoutId(),BlackoutPage.Labels.Blackoutheader,BlackoutPage.Labels.Blackoutheader)}var blackoutIdSet;function changeMenuHandler(){var a=getblackoutId();if(a==null||a==""){Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true);Ext.getCmp("addNoteId").setDisabled(true);Ext.getCmp("newActionId").setDisabled(true);Ext.getCmp("viewActionHistoryId").setDisabled(true);if(isBlackoutCreatable!=null&&isBlackoutCreatable==false){Ext.getCmp("newId").setDisabled(true);Ext.getCmp("saveId").setDisabled(true)}}else{Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconClass("bmcDelete");Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("resetId").setDisabled(false);Ext.getCmp("addNoteId").setDisabled(false);Ext.getCmp("newActionId").setDisabled(false);Ext.getCmp("viewActionHistoryId").setDisabled(false);if(isBlackoutCreatable!=null&&isBlackoutCreatable==false){Ext.getCmp("newId").setDisabled(false);Ext.getCmp("saveId").setDisabled(false)}}}function previousBlackoutBtnHandler1(){var b="";var a=0;while(blackoutIdSet.length>a){if(b==""){b=blackoutIdSet[a]}else{b=b+","+blackoutIdSet[a]}a++}previousBlackoutBtnHandler(b)}function nextBlackoutBtnHandler1(){var b="";var a=0;while(blackoutIdSet.length>a){if(b==""){b=blackoutIdSet[a]}else{b=b+","+blackoutIdSet[a]}a++}nextBlackoutBtnHandler(b)}function closeWindow(){window.parent.refreshList();window.parent.closeTab(getWID())}function updateList(){window.parent.refreshList()}function updateTitle(){var a=getName();if(a!=""&&a!=null){window.parent.changeTitle(getWID(),a,BlackoutPage.Labels.Blackoutheader)}}function handleSave(){var a=getblackoutId();if(!isPopup){window.parent.handleSave(getWID(),getId())}}function getSave(){var a=false;a=Ext.getCmp("idInactive").getValue();Ext.getCmp("saveId").setDisabled(true);waitbox(0);save(a)}function getTextlengthFilter(){var d=document.getElementById(BlackoutPageComp.ComponentVars.ProjectedServiceOutageDescription).value;var a=document.getElementById(BlackoutPageComp.ComponentVars.ProjectedServiceOutageName).value;var c=document.getElementById(BlackoutPageComp.ComponentVars.ProjectedServiceOutageRootCause).value;var b=BlackoutPage.Labels.TextAreaOverflow.replace("255","1000");if(d.length<=255){if(c.length<=1000){getSave()}else{if(c.length>1000){Ext.MessageBox.show({msg:getRootCauseLabel()+": "+b,buttons:Ext.MessageBox.OK})}}}else{if(d.length>255){Ext.MessageBox.show({msg:getDescriptionLabel()+": "+BlackoutPage.Labels.TextAreaOverflow,buttons:Ext.MessageBox.OK})}}}function buttonValidator(){if((getName()!=null&&getName()!="")&&(errormsg==BlackoutPage.Labels.savedMsg)){Ext.getCmp("deleteId").setDisabled(false);Ext.getCmp("deleteId").setIconClass("bmcDelete");Ext.getCmp("copyId").setDisabled(false);Ext.getCmp("resetId").setDisabled(false)}}var NewBtnHandler=function(a,b){openPage("BlackOutPage",BlackoutPage.Labels.Blackoutheader,BlackoutPage.Labels.Blackoutheader);activeAllWindowFlag=false};var SaveBtnHandler=function(a,b){getTextlengthFilter()};var CopyBtnHandler=function(a,b){callCopyPage();activeAllWindowFlag=false};var DeleteBtnHandler=function(a,b){Ext.MessageBox.confirm(BlackoutPage.Labels.Delete,BlackoutPage.Labels.DeleteConfirmMessage,function(c){if(c==="yes"){deleteBlackOut()}})};var ResetBtnHandler=function(a,b){reset()};var NextBtnHandler=function(a,b){if(document.getElementById("nextId").disabled!=true){nextBlackoutBtnHandler1()}};var PreviousBtnHandler=function(a,b){if(document.getElementById("prevId").disabled!=true){previousBlackoutBtnHandler1()}};Ext.onReady(function(){Ext.QuickTips.init();var a=Ext.extend(Ext.Panel,{renderTo:"btnToolbar",defaults:{bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;"}});new a({title:"",cls:"toolSpCls",bodyStyle:"border:0px;padding:0px;margin:0px;zoom:0px;",tbar:[{scale:"medium",iconCls:"bmcNew",tooltipType:"title",tooltip:BlackoutPage.Labels.New,id:"newId",listeners:{mouseover:function(){this.setIconClass("bmcNewOn")},mouseout:function(){this.setIconClass("bmcNew")}},handler:NewBtnHandler}," ",{scale:"medium",iconCls:"bmcSave",tooltipType:"title",tooltip:BlackoutPage.Labels.Save,id:"saveId",listeners:{mouseover:function(){this.setIconClass("bmcSaveOn")},mouseout:function(){this.setIconClass("bmcSave")}},handler:SaveBtnHandler}," ",{scale:"medium",iconCls:"bmcCopy",tooltipType:"title",tooltip:BlackoutPage.Labels.Copy,id:"copyId",listeners:{mouseover:function(){this.setIconClass("bmcCopyOn")},mouseout:function(){this.setIconClass("bmcCopy")}},handler:CopyBtnHandler}," ","-"," ",{scale:"medium",iconCls:"bmcDelete",tooltipType:"title",tooltip:BlackoutPage.Labels.Delete,id:"deleteId",disabled:getPermissions(),listeners:{mouseover:function(){this.setIconClass("bmcDeleteOn")},mouseout:function(){this.setIconClass("bmcDelete")}},handler:DeleteBtnHandler}," ",{scale:"medium",iconCls:"bmcReset",tooltipType:"title",tooltip:BlackoutPage.Labels.Reset,id:"resetId",listeners:{mouseover:function(){this.setIconClass("bmcResetOn")},mouseout:function(){this.setIconClass("bmcReset")}},handler:ResetBtnHandler}," ","-"," ",{id:"actionButton",text:BlackoutPage.Labels.Actions,tooltip:BlackoutPage.Labels.Actions,menu:[{text:BlackoutPage.Labels.AddNote,id:"addNoteId",handler:addNoteHandler},{text:BlackoutPage.Labels.NewAction,id:"newActionId",handler:newActionHandler},{text:BlackoutPage.Labels.ViewActionHistory,id:"viewActionHistoryId",handler:viewActionHistoryBtnHandler}]}," ",new Ext.Toolbar.Fill(),{id:"idInactive",xtype:"checkbox",width:93,align:"top",checked:false,cls:"chkStyle",boxLabel:'<span class="checkboxLabelCls">'+BlackoutPage.Labels.Inactive+"</span>",listeners:{render:function(){Ext.QuickTips.register({target:this,dismissDelay:20000,text:BlackoutPage.Labels.ToolTipInactive})}}},{xtype:"box",id:"prevId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_previous.gif",title:BlackoutPage.Labels.PreviousRecord},cls:"cursorCls",listeners:{render:function(d){d.el.on("click",PreviousBtnHandler)}}},{xtype:"box",id:"nextId",autoEl:{tag:"img",src:getSDFStylesResPath()+"/SDEFbuttons/b_next.gif",title:BlackoutPage.Labels.NextRecord},cls:"cursorSpaceCls",listeners:{render:function(d){d.el.on("click",NextBtnHandler)}}}]});if(blackoutIdSet==null||blackoutIdSet==""){if(getIsDirect()==""){if(typeof(window.parent.returnListOfId)=="function"){blackoutIdSet=window.parent.returnListOfId()}}else{if(typeof(window.parent.parent.getIdArray)=="function"){blackoutIdSet=window.parent.parent.getIdArray()}window.parent.handleSave(getWID(),getId())}}var b=getBlackoutInactive();if(b){Ext.getCmp("idInactive").setDisabled(true)}updateInactive();handleElemEvent();isBlackoutCreatable=getIsBlackoutCreatable();isBlackoutDeletable=getIsBlackoutDeletable();var c=getblackoutId();if(c==null||c==""){Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("prevId").setDisabled(true);Ext.getCmp("nextId").setDisabled(true);Ext.getCmp("addNoteId").setDisabled(true);Ext.getCmp("newActionId").setDisabled(true);Ext.getCmp("viewActionHistoryId").setDisabled(true);if(isBlackoutCreatable!=null&&isBlackoutCreatable==false){Ext.getCmp("newId").setDisabled(true);Ext.getCmp("saveId").setDisabled(true)}}else{if(isBlackoutCreatable!=null&&isBlackoutCreatable==false){Ext.getCmp("saveId").setDisabled(true);Ext.getCmp("saveId").setIconClass("bmcSaveDisable");Ext.getCmp("deleteId").setDisabled(true);Ext.getCmp("deleteId").setIconClass("bmcDeleteDisable");Ext.getCmp("copyId").setDisabled(true);Ext.getCmp("copyId").setIconClass("bmcCopyDisable");Ext.getCmp("resetId").setDisabled(true);Ext.getCmp("newId").setDisabled(true)}}});function handleChange(){if(!clickedOnce){clickedOnce=true;window.parent.registerChange(getWID())}}function handleResetChange(){if(clickedOnce){clickedOnce=false;window.parent.registerSave(getWID())}}var addNoteBtnHandlerWindow;addNoteHandler=function(a,c){var b=getblackoutId();b=b.substring(0,b.length-3);if(!addNoteBtnHandlerWindow||addNoteBtnHandlerWindow.closed){addNoteBtnHandlerWindow=window.open("/apex/ServiceUnavailabilityAddNotePage?id="+b+"&fromconsole=false",null,"width=600,height=400,resizable = 0,scrollbars=no,status=1,top=350,left=350")}if(addNoteBtnHandlerWindow.focus){addNoteBtnHandlerWindow.focus()}};var screenHeight=400;var screenWidth=1087;function screenLeft(a){return parseInt((screen.availWidth/2)-(a/2))}function screenTop(b){if(Ext.isChrome){var a=parseInt((screen.availHeight/2)-(screenHeight/2));return(a-25)}else{return parseInt((screen.availHeight/2)-(screenHeight/2))}}var newActionHandlerWindow;newActionHandler=function(a,c){var b=getblackoutId();b=b.substring(0,b.length-3);newActionHandlerWindow=window.open("/apex/searchPage?popupId=Action&isLookup=true&objectType=Unavailability_Action_History__c&isCalledFromConsole=false&enableSelfClosing=false&standardLayout=true&parentId="+b+"&filterClause=appliesToServiceUnavailability__c%3Dtrue%20and%20system__c%3Dfalse",null,"status = 1,height =400,width =600,left="+screenLeft("600")+",top="+screenTop("400")+", resizable = 0,scrollbars=no");if(newActionHandlerWindow.focus){newActionHandlerWindow.focus()}};var viewActionHistoryHandlerWindow;viewActionHistoryBtnHandler=function(b,d){screenWidth=671;screenHeight=400;var c=getblackoutId();c=c.substring(0,c.length-3);var a=document.getElementById(BlackoutPageComp.ComponentVars.ProjectedServiceOutageName).value;viewActionHistoryHandlerWindow=window.open("/apex/ViewAllActions?ObjectId="+c+"&objectName=Projected_Service_Outage&recordState=&recordName="+a,null,"status = 1,height ="+screenHeight+",width ="+screenWidth+",left="+screenLeft(screenWidth)+",top="+screenTop(screenHeight)+", resizable = 0,scrollbars=yes");if(viewActionHistoryHandlerWindow.focus){viewActionHistoryHandlerWindow.focus()}};