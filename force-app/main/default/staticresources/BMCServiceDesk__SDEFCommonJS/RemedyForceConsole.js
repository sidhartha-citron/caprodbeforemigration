var currentRecordId;var currentObjectName;var isNewTabLoadedForClient=false;var updateWindow;var isUpdateWindowOpen=false;var globalListRefreshTimeStamp;var changeOwnerWindow;var isChangeOwnerWindowOpen=false;var viewMenuHideEvent;var MultiPageLayout={isEnabled:_ServerVariables.isMultiPageLayoutEnabled,details:_ServerVariables.MultiPageLayoutDetails,isEdit:_ServerVariables.isEditLayout,defaultLayoutIN:"",defaultLayoutTS:"",defaultLayoutCR:"",RTFLayouts:"",layoutNameMap:{},ConsoleLayoutAccessValidation:_ServerVariables.ConsoleLayoutAccessValidation};if(window.addEventListener){window.addEventListener("beforeunload",bulkUnlockRecords)}else{if(window.attachEvent){window.attachEvent("onbeforeunload",bulkUnlockRecords)}}function bulkUnlockRecords(){if(recordLock=="Off"){return}var a=TabPanel.items;for(var b=0;b<a.length;b++){currentRecordId=a.items[b].id;var d=a.items[b].title;var c=d.substring(0,2);if(currentRecordId!="firstTab"){if(c==SingleConsolePage.Labels.IncidentRecordPrefix||c==SingleConsolePage.Labels.ServiceRequestPrefix){currentObjectName="Incident__c"}else{if(c==SingleConsolePage.Labels.TaskRecordPrefix){currentObjectName="Task__c"}else{if(c==SingleConsolePage.Labels.ChangeRecordPrefix){currentObjectName="Change_Request__c"}else{if(c==SingleConsolePage.Labels.ProblemRecordPrefix){currentObjectName="Problem__c"}else{if(c==SingleConsolePage.Labels.ReleaseRecordPrefix){currentObjectName="Release__c"}else{if(c==SingleConsolePage.Labels.BroadcastRecordPrefix){currentObjectName="Broadcasts__c"}}}}}}unlockRecordWithName(d)}}}var incidentState="";var broadcast="";var categoryId="";var status="";var clientId="";var isServiceRequest=false;var accountId="";var desc="";var ServiceTargetStatus="";var isDeleted=false;var selectedUserId="";var selectedCategoryId="";var disableActionBtn=false;var disableAgentBtn=false;var bodyHeight=680;var TabPanel;var tabName="";var currentObjectWithList;var MoreOptionsctxMenu;var count;var flag=false;var tabCount=0;var chatClientId="";var newTabstart=1;var recordLock;var ClientIdForUrl;function getUrlParameter(d){d=d.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+d+"=([^&#]*)";var b=new RegExp(c);var a=b.exec(window.location.href);if(a==null){return""}else{return a[1]}}function refreshListView(b){var a=false;var c=Ext.util.Cookies.get("apex__EnableMultipleListViews");if((!c&&!calledFromConsoleListViewPage)||(c&&objectName&&objectName==b)){doRefresh();a=true}setTimeout(function(){for(var d=0;d<frames.length;d++){try{if(frames[d].name=="consolelistviewframe"&&frames[d].objectNameParam==b){frames[d].doRefresh();if(a==true){break}}}catch(f){console.log(f)}}},3000)}function setlistView(b,c,a){for(var d=0;d<frames.length;d++){try{if(frames[d].name=="consolelistviewframe"&&frames[d].objectNameParam==b){if(a==frames[d].isServiceRequest){selectedCard="";frames[d].ChangeListViewFilter(c,true);return}}}catch(f){console.log(f)}}}var tabExistId="";function addTab(i,c,h,k,l,g,e,j){if(MultiPageLayout.isEnabled&&MultiPageLayout.ConsoleLayoutAccessValidation&&!hasLayoutAccess(h,j,i,true)){return}currentRecordId=i;currentObjectName=h;if(typeof(l)=="undefined"&&l==null){l=""}if(typeof(g)=="undefined"&&g==null){g=""}if(typeof(chatTempAttachmentId)=="undefined"&&chatTempAttachmentId==null){chatTempAttachmentId=""}if(typeof(j)=="undefined"&&j==null){j=""}if(tabCount>=MaxRecordTabCount){i=truncateRecordId(i);var m=checkTabExists(i);if(k){m=false}if(m){TabPanel.setActiveTab(i)}else{Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:SingleConsolePage.Labels.RFTabLimitExceedMsg,buttons:Ext.Msg.OK,icon:Ext.Msg.WARNING});return}}else{i=truncateRecordId(i);var m=checkTabExists(i);if(k){m=false}if(m){if(tabExistId!=""){TabPanel.setActiveTab(tabExistId)}tabExistId=""}else{var d="";var f="";if(i==null||i=="new"){if(_ServerVariables&&_ServerVariables.ObjectMetadata&&_ServerVariables.ObjectMetadata.LocalName==h&&!_ServerVariables.ObjectMetadata.isCreateable){return}i="";c=": "+SingleConsolePage.Labels.New;tabName=""}if(k){c=": "+SingleConsolePage.Labels.New;tabName=""}if(h=="Incident__c"){var a="";var b=TabPanel.getActiveTab();if(e!=null&&typeof(e)!="undefined"){a=e}else{if((_RFServerValues.inctype!=null&&typeof(_RFServerValues.inctype)!="undefined")||(e!=null&&typeof(e)!="undefined")){if(_RFServerValues.inctype=="ServiceRequest"||e=="ServiceRequest"){a="ServiceRequest"}else{if(_RFServerValues.inctype=="Incident"||e=="Incident"){a="Incident"}}}else{if(b&&b.title&&(b.title=="Service Requests"||b.title.indexOf("SR")!==-1||b.title.toLowerCase().indexOf("in")==-1)&&isServiceRequest){a="ServiceRequest"}else{a="Incident"}}}if(k){d='<iframe id="iframe-" name="iframe-" src ="'+incidentConsole+"&record_id="+i+"&inctype="+a+"&formLayoutId="+j+'&isRFConsoleDetailForm=true&isCloneRequest=true&tabId=" scrolling="no" style="height:100%;width:100%;border:none;"/>';i=""}else{if(!isNewTabLoadedForClient){clientIdForUrl=getUrlParameter("clientid");d='<iframe id="iframe-'+i+'" name="iframe-'+i+'" src ="'+incidentConsole+"&ObjID="+g+"&formLayoutId="+j+"&inctype="+a+"&ObjName="+l+"&record_id="+i+"&clientid="+clientIdForUrl+"&objectName="+h+"&isRFConsoleDetailForm=true&tabId="+i+"&chatTempAttachmentId="+chatTempAttachmentId+'" scrolling="no" style="height:100%;width:100%;border:none;"/>';isNewTabLoadedForClient=true}else{d='<iframe id="iframe-'+i+'" name="iframe-'+i+'" src ="'+incidentConsole+"&ObjID="+g+"&formLayoutId="+j+"&inctype="+a+"&ObjName="+l+"&record_id="+i+"&objectName="+h+"&isRFConsoleDetailForm=true&tabId="+i+"&chatTempAttachmentId="+chatTempAttachmentId+'" scrolling="no" style="height:100%;width:100%;border:none;"/>'}f="NEWINC-"+Math.random()}if(i!=null&&i!=""&&c=="New"){c=SingleConsolePage.Labels.Loading}else{if(a=="ServiceRequest"){c=SingleConsolePage.Labels.ServiceRequestPrefix+c}else{c=SingleConsolePage.Labels.IncidentRecordPrefix+c}}if(i==""){if((a!=null&&a=="ServiceRequest")){tabName=SingleConsolePage.Labels.newServiceRequest}else{tabName=SingleConsolePage.Labels.New_Incident}}else{tabName=c}}else{if(h=="Task__c"){if(k){d='<iframe id="iframe-" name="iframe-" src ="'+taskConsole+"&record_id="+i+"&formLayoutId="+j+'&isRFConsoleDetailForm=true&isCloneRequest=true&tabId=" scrolling="no" style="height:100%;width:100%;border:none;"/>';i=""}else{d='<iframe id="iframe-'+i+'" name="iframe-'+i+'" src ="'+taskConsole+"&ObjID="+g+"&formLayoutId="+j+"&ObjName="+l+"&record_id="+i+"&isRFConsoleDetailForm=true&tabId="+i+'" scrolling="no" style="height:100%;width:100%;border:none;"/>'}f="NEWTSK-"+Math.random();if(i!=null&&i!=""&&c=="New"){c=SingleConsolePage.Labels.Loading}else{c=SingleConsolePage.Labels.TaskRecordPrefix+c}if(i==""){tabName=SingleConsolePage.Labels.New_Task}else{tabName=c}}else{if(h=="Change_Request__c"){if(k){d='<iframe id="iframe-" name="iframe-" src ="'+changeConsole+"&record_id="+i+"&formLayoutId="+j+'&isRFConsoleDetailForm=true&isCloneRequest=true&tabId=" scrolling="no" style="height:100%;width:100%;border:none;"/>';i=""}else{d='<iframe id="iframe-'+i+'" name="iframe-'+i+'" src ="'+changeConsole+"&record_id="+i+"&formLayoutId="+j+"&isRFConsoleDetailForm=true&tabId="+i+'" scrolling="no" style="height:100%;width:100%;border:none;"/>'}f="NEWCR-"+Math.random();if(i!=null&&i!=""&&c=="New"){c=SingleConsolePage.Labels.Loading}if(i==""){c=SingleConsolePage.Labels.ChangeRecordPrefix+c;tabName=SingleConsolePage.Labels.New_ChangeRequest}else{tabName=c}}else{if(h=="Problem__c"){if(k){d='<iframe id="iframe-" name="iframe-" src ="'+problemConsole+"&record_id="+i+'&isRFConsoleDetailForm=true&isCloneRequest=true&tabId=" scrolling="no" style="height:100%;width:100%;border:none;"/>';i=""}else{d='<iframe id="iframe-'+i+'" name="iframe-'+i+'" src ="'+problemConsole+"&record_id="+i+"&isRFConsoleDetailForm=true&tabId="+i+'" scrolling="no" style="height:100%;width:100%;border:none;"/>'}f="NEWPR-"+Math.random();if(i!=null&&i!=""&&c=="New"){c=SingleConsolePage.Labels.Loading}else{c=SingleConsolePage.Labels.ProblemRecordPrefix+c}if(i==""){tabName=SingleConsolePage.Labels.New_Problem}else{tabName=c}}else{if(h=="Release__c"){if(k){d='<iframe id="iframe-" name="iframe-" src ="'+releaseConsole+"&record_id="+i+'&isRFConsoleDetailForm=true&isCloneRequest=true&tabId=" scrolling="no" style="height:100%;width:100%;border:none;"/>';i=""}else{d='<iframe id="iframe-'+i+'" name="iframe-'+i+'" src ="'+releaseConsole+"&record_id="+i+"&isdtp=mn&isRFConsoleDetailForm=true&tabId="+i+'" scrolling="no" style="height:100%;width:100%;border:none;"/>'}f="NEWRM-"+Math.random();if(i!=null&&i!=""&&c=="New"){c=SingleConsolePage.Labels.Loading}if(i==""){c=SingleConsolePage.Labels.ReleaseRecordPrefix+c;tabName=SingleConsolePage.Labels.New_Release}else{tabName=c}}else{if(h=="Broadcasts__c"){if(k){d='<iframe id="iframe-" name="iframe-" src ="'+broadcastConsole+"&record_id="+i+'&isRFConsoleDetailForm=true&isCloneRequest=true&tabId=" scrolling="no" style="height:100%;width:100%;border:none;"/>';i=""}else{d='<iframe id="iframe-'+i+'" name="iframe-'+i+'" src ="'+broadcastConsole+"&record_id="+i+"&isdtp=mn&isRFConsoleDetailForm=true&tabId="+i+'" scrolling="no" style="height:100%;width:100%;border:none;"/>'}f="NEWBC-"+Math.random();if(i!=null&&i!=""&&c=="New"){c=SingleConsolePage.Labels.Loading}if(c){c=Ext.util.Format.htmlEncode(c)}if(i==""){c=SingleConsolePage.Labels.BroadcastRecordPrefix+c;tabName=SingleConsolePage.Labels.New_Broadcast}else{tabName=c}}else{if(h=="Projected_Service_Outage__c"){if(k){d='<iframe id="iframe-" name="iframe-" src ="/apex/ConsoleServiceOutageDetail?copyId='+i+'&isRFConsoleDetailForm=true&isCloneRequest=true&tabId=" scrolling="yes" style="height:100%;width:100%;border:none;"/>';i=""}else{d='<iframe id="iframe-'+i+'" name="iframe-'+i+'" src ="/apex/ConsoleServiceOutageDetail?id='+i+"&isRFConsoleDetailForm=true&tabId="+i+'" scrolling="yes" style="height:100%;width:100%;border:none;"/>'}if(i!=null&&i!=""&&c=="New"){c=SingleConsolePage.Labels.Loading}if(c){c=Ext.util.Format.htmlEncode(c)}if(i==""){c=SingleConsolePage.Labels.ServiceOutageRecordPrefix+c;tabName=SingleConsolePage.Labels.New_ServiceOutage}else{tabName=c}}else{alert("Object is not  Supported......")}}}}}}}if(i!=null&&i==""){i=Date.now()+tabCount;d=d.replace("&tabId=","&tabId="+i)}TabPanel.add({id:i,closable:true,html:d,title:c,tooltip:tabName,dirty:false,recordValue:""+i,height:50,listeners:{beforeclose:function(){currentRecordId=this.recordValue;currentObjectName=h;clearAllSelection();return unlockRecordBeforeClosing(this)},boxready:function(){Ext.select(".x-box-inner, .x-tab-center").selectable();var p=this.tab.btnEl.id;var o=document.getElementById(p);var n=o.style.height;var q=Ext.DomHelper.insertBefore(o,{tag:"div",id:p,cls:"RF_tabHeader x-tab-center",title:o.title,style:"height: "+n});RemedyForceHTMLProcessor.copyHTML(o,q);o.parentNode.removeChild(o)}},tabConfig:{style:{borderRadius:0},cls:"RF_TextSelection",margin:"0 0 0 -2"}}).show();TabPanel.setActiveTab(i);tabCount++}}}function hasLayoutAccess(f,e,a,g){if(typeof(e)!="undefined"&&e&&e!=NONPRINT){if(((f=="Incident__c"&&MultiPageLayout.isEnabledForIN)||(f=="Task__c"&&MultiPageLayout.isEnabledForTS)||(f=="Change_Request__c"&&MultiPageLayout.isEnabledForCR))&&MultiPageLayout.ConsoleLayoutAccessValidation){var h;if(f=="Incident__c"){h=MultiPageLayout.details["in"]}else{if(f=="Task__c"){h=MultiPageLayout.details.ts}else{if(f=="Change_Request__c"){h=MultiPageLayout.details.cr}}}var b=false;for(var c=0;c<h.length;c++){if(e.indexOf(h[c].layoutDetailId)!=-1){b=true;break}}if(!b){if(g){var d;if(MultiPageLayout.layoutNameMap[a]!=undefined&&MultiPageLayout.layoutNameMap[a]!=""){d=SingleConsolePage.Labels.LayoutInsufficientAccess+" "+MultiPageLayout.layoutNameMap[a]}else{d=SingleConsolePage.Labels.LayoutInsufficientAccessGeneric}Ext.Msg.baseCls="bmc-message";Ext.Msg.show({title:SingleConsolePage.Labels.labelError,msg:d,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}return false}}}return true}function clearAllSelection(){if(window.getSelection().toString()!==""){window.getSelection().removeAllRanges()}}function unlockRecordBeforeClosing(a){if(recordLock!="Off"){if(currentRecordId!=null){unlockRecord()}else{unlockRecordWithName(a.title)}}beforeCloseTabEvent(a);if(a.dirty){return false}else{try{if(navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.indexOf("Trident")!=-1){cleanupMemory(a);Ext.destroy(Ext.getCmp(a.id))}}catch(b){}return true}}function cleanupMemory(d){var a="iframe-"+d.id;var f=window.frames[a].window;for(var b=0;b<f.frames.length;b++){var c=f.frames[b].window;for(var e in c){e=null}c.location.href="about:blank"}for(var e in f){e=null}CollectGarbage();f.location.href="about:blank"}function unlockRecordWithName(b){var a=b.substring(2);if(recordLock!="Off"){callRemoteAction(_RFRemotingActions.unlockRecordWithName,a,currentObjectName,function(c,d){},{escape:false})}}function unlockRecord(){if(recordLock!="Off"){callRemoteAction(_RFRemotingActions.unlockRecord,currentRecordId,currentObjectName,function(a,b){},{escape:false})}}function truncateRecordId(a){if(a!="undefined"&&a!=null&&a!=""&&a.length>15){return a.substring(0,15)}else{return a}}function getViewMenu(){MoreOptionsctxMenu=new Ext.menu.Menu({id:"otheroptionsMenu",cls:"bmc-menu-dark",text:"Actions",items:[],listeners:{mouseleave:{element:"el",fn:function(){var a=Ext.getCmp("myQvSubMenu");var c=Ext.getCmp("sharedQVSubMenu");var b=true;if(a.isVisible()||c.isVisible()){b=false}if(b){viewMenuHideEvent=setTimeout(function(){Ext.getCmp("otheroptionsMenu").hide()},300)}flag=false}},mouseover:{fn:function(){if(viewMenuHideEvent){clearTimeout(viewMenuHideEvent);viewMenuHideEvent=undefined}}},click:function(d,b,c,a){isColumnReordered=false}},maxHeight:400});Ext.get("viewOptions").on("click",function(a,b){if(flag){MoreOptionsctxMenu.hide();flag=!flag}else{a.stopEvent();MoreOptionsctxMenu.show();flag=!flag;if(document.dir==="rtl"){MoreOptionsctxMenu.alignTo(Ext.get("viewOptions"),"tr-br",[0,0])}else{MoreOptionsctxMenu.alignTo(Ext.get("viewOptions"),"tl-bl",[0,0])}}if(Ext.get("SearchFilter").isVisible()){Ext.fly("SearchFilter").hide()}if(typeof HideActiveFilterComponent=="function"){HideActiveFilterComponent()}});return MoreOptionsctxMenu}function getPositionForTabToBeAdded(){var a=TabPanel.items;var b="";var d=false;for(var c=0;c<a.length;c++){b=a.items[c].id;if(b=="firstTab"||String(b).indexOf("view")==0||b=="ConsoleDashboard"){continue}else{d=true;return c}}if(!d){return a.length}}function pinnedObject(){var b=Ext.util.Cookies.get("apex__PinnedListView");var a=Ext.util.Cookies.get("apex__isSRLastRFConsoleView");if(b=="Incident__c"&&a=="true"){b="SRIncident__c"}return b}var isMultipleListViewsEnabled=Ext.util.Cookies.get("apex__EnableMultipleListViews");function viewModuleList(){var f=1;var n=Ext.util.Cookies.get("apex__isSRLastRFConsoleView");if(_RFServerValues.IncidentSegregationEnabled&&n=="true"&&isRfConsole){isServiceRequest=true}if(_RFServerValues.srViewState==true&&_RFServerValues.incViewState==false){isServiceRequest=true}if(_RFServerValues.IncidentSegregationEnabled){if(_RFServerValues.inctype!=null&&_RFServerValues.inctype=="Incident"){isServiceRequest=false}else{if(_RFServerValues.inctype!=null&&_RFServerValues.inctype=="ServiceRequest"){isServiceRequest=true}}}if(Ext.isSafari){f=3}var k=function(i,p){openSelectedListView("viewincidentSR",false)};var a=function(i,p){openSelectedListView("viewincident",false)};var c=function(i,p){openSelectedListView("viewservicerequest",false)};var d=function(i,p){openSelectedListView("viewchangerequest",false)};var b=function(i,p){openSelectedListView("viewtask",false)};var g=function(i,p){openSelectedListView("viewproblem",false)};var m=function(i,p){openSelectedListView("viewrelease",false)};var j=function(i,p){openSelectedListView("viewbroadcast",false)};var e=function(i,p){openSelectedListView("viewServiceOutage",false)};MoreOptionsctxMenu=getViewMenu();var o='<span title="'+SingleConsolePage.Labels.PinUnPinConsoleListToolTip+'" class="d-icon-right-pinned rf-pin-object-list {0}" id="{1}" onclick="pinObjectView(this);"></span>';var h;if(!_RFServerValues.IncidentSegregationEnabled&&_RFServerValues.incViewState){h=String.format(o,(pinnedObject()=="Incident__c")?"rf-pin-object-active":"","Pinned_Incident__c");var l=new Ext.menu.Item({id:"viewIncidentConsole",lbl:SingleConsolePage.Labels.viewIncidentConsole,text:h+SingleConsolePage.Labels.viewIncidentConsole,tooltipType:"title",height:30,handler:k})}MoreOptionsctxMenu.add(l);if(_RFServerValues.IncidentSegregationEnabled&&_RFServerValues.incViewState){h=String.format(o,(pinnedObject()=="Incident__c")?"rf-pin-object-active":"","Pinned_Incident__c");var l=new Ext.menu.Item({id:"viewIncidentsOnly",lbl:SingleConsolePage.Labels.viewIncidentsOnly,text:h+SingleConsolePage.Labels.viewIncidentsOnly,tooltipType:"title",height:30,handler:a})}MoreOptionsctxMenu.add(l);if(_RFServerValues.IncidentSegregationEnabled&&_RFServerValues.srViewState){h=String.format(o,(pinnedObject()=="SRIncident__c")?"rf-pin-object-active":"","Pinned_SRIncident__c");var l=new Ext.menu.Item({id:"viewServiceRequestsOnly",lbl:SingleConsolePage.Labels.viewServiceRequestsOnly,text:h+SingleConsolePage.Labels.viewServiceRequestsOnly,tooltipType:"title",height:30,handler:c})}MoreOptionsctxMenu.add(l);if(_RFServerValues.tsViewState){h=String.format(o,(pinnedObject()=="Task__c")?"rf-pin-object-active":"","Pinned_Task__c");var l=new Ext.menu.Item({id:"viewTaskConsole",lbl:SingleConsolePage.Labels.viewTaskConsole,text:h+SingleConsolePage.Labels.viewTaskConsole,tooltipType:"title",height:30,handler:b})}MoreOptionsctxMenu.add(l);if(_RFServerValues.prViewState){h=String.format(o,(pinnedObject()=="Problem__c")?"rf-pin-object-active":"","Pinned_Problem__c");var l=new Ext.menu.Item({id:"viewProblemConsole",lbl:SingleConsolePage.Labels.viewProblemConsole,text:h+SingleConsolePage.Labels.viewProblemConsole,tooltipType:"title",height:30,handler:g})}MoreOptionsctxMenu.add(l);if(_RFServerValues.crViewState){h=String.format(o,(pinnedObject()=="Change_Request__c")?"rf-pin-object-active":"","Pinned_Change_Request__c");var l=new Ext.menu.Item({id:"viewChangeConsole",lbl:SingleConsolePage.Labels.viewChangeConsole,text:h+SingleConsolePage.Labels.viewChangeConsole,tooltipType:"title",height:30,handler:d})}MoreOptionsctxMenu.add(l);if(_RFServerValues.rmViewState){h=String.format(o,(pinnedObject()=="Release__c")?"rf-pin-object-active":"","Pinned_Release__c");var l=new Ext.menu.Item({id:"viewReleseConsole",lbl:SingleConsolePage.Labels.viewReleseConsole,text:h+SingleConsolePage.Labels.viewReleseConsole,tooltipType:"title",height:30,handler:m})}MoreOptionsctxMenu.add(l);if(_RFServerValues.brViewState){h=String.format(o,(pinnedObject()=="Broadcasts__c")?"rf-pin-object-active":"","Pinned_Broadcasts__c");var l=new Ext.menu.Item({id:"viewBroadcastConsole",lbl:SingleConsolePage.Labels.viewBroadcastConsole,text:h+SingleConsolePage.Labels.viewBroadcastConsole,tooltipType:"title",height:30,handler:j})}MoreOptionsctxMenu.add(l);if(_RFServerValues.soViewState){h=String.format(o,(pinnedObject()=="Projected_Service_Outage__c")?"rf-pin-object-active":"","Pinned_Projected_Service_Outage__c");var l=new Ext.menu.Item({id:"viewServiceOutageConsole",lbl:SingleConsolePage.Labels.RR_FeatureOutages,text:h+SingleConsolePage.Labels.RR_FeatureOutages,tooltipType:"title",height:30,handler:e})}MoreOptionsctxMenu.add(l);if(_RFServerValues.csViewState){var l=new Ext.menu.Item({id:"viewChangeschedule",text:SingleConsolePage.Labels.viewChangeScheduleConsole,tooltipType:"title",height:30,handler:loadChangeschTab})}MoreOptionsctxMenu.add(l);if(isConsoleDashboardEnabled){addDashboardAndQVMenuItems(MoreOptionsctxMenu)}addDisplayMultipleViewsMenuItem();count=MoreOptionsctxMenu.items.length;MoreOptionsctxMenu.items.each(function(i){var p=i.lbl?i.lbl:i.text;if(!isRFHotkeysDisabled&&!isAZERTYKeyBoard&&f<10){i.setTooltip(p+" (Ctrl+Alt+"+f+")")}else{if(!isRFHotkeysDisabled&&isAZERTYKeyBoard&&f<10){addTooltipIfAZERTY(i)}else{i.setTooltip(p)}}f=f+1})}function openSelectedListView(g,j,a){var b=false;if(!a&&isConsoleMetricBarEnabled&&!isHandlerOff){selectedCard="";setActiveCard("undefined")}if(!a){a=""}if(isHandlerOff){isHandlerOff=false;return}var k=Ext.util.Cookies.get("apex__EnableMultipleListViews");var e,d;var f=(userLanguage&&userLanguage=="iw")?true:false;var c='<iframe src ="/apex/ConsoleListViewPage?objectName={0}&calledFrom=multiTab{1}&listVewID='+encodeURIComponent(a)+"&isRTLEnabled="+f+'" style="width:100%;height:100%;border:none" id="consolelistviewframe" name="consolelistviewframe" scrolling="no"/>';switch(g){case"viewincidentSR":e=SingleConsolePage.Labels.viewIncidentConsole;c=String.format(c,"Incident__c","");d="Incident__c";break;case"viewincident":e=SingleConsolePage.Labels.viewIncidentsOnly;c=String.format(c,"Incident__c","&inctype=Incident");d="Incident__c";break;case"viewservicerequest":e=SingleConsolePage.Labels.viewServiceRequestsOnly;c=String.format(c,"Incident__c","&inctype=ServiceRequest");d="Incident__c";break;case"viewchangerequest":e=SingleConsolePage.Labels.viewChangeConsole;c=String.format(c,"Change_Request__c","");d="Change_Request__c";break;case"viewtask":e=SingleConsolePage.Labels.viewTaskConsole;c=String.format(c,"Task__c","");d="Task__c";break;case"viewproblem":e=SingleConsolePage.Labels.viewProblemConsole;c=String.format(c,"Problem__c","");d="Problem__c";break;case"viewrelease":e=SingleConsolePage.Labels.viewReleseConsole;c=String.format(c,"Release__c","");d="Release__c";break;case"viewbroadcast":e=SingleConsolePage.Labels.viewBroadcastConsole;c=String.format(c,"Broadcasts__c","");d="Broadcasts__c";break;case"viewServiceOutage":e=SingleConsolePage.Labels.RR_FeatureOutages;c=String.format(c,"Projected_Service_Outage__c","");d="Projected_Service_Outage__c";break;case"ConsoleDashboard":e=SingleConsolePage.Labels.MyDashboard;c='<iframe src ="'+consoleDashboardPageURL+'" style="width:100%;height:100%;border:none" id="dashboardframe" name="dashboardframe" scrolling="yes"/>'}currentObjectWithList=e;if(k){if((TabPanel.items.map.firstTab&&TabPanel.items.map.firstTab.title!=e)||j){var l=checkTabExists(g);if(l&&!j){TabPanel.setActiveTab(g);if(a){setlistView(d,a,(g=="viewservicerequest"?true:false))}return}if(tabCount>=MaxRecordTabCount){Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:SingleConsolePage.Labels.RFTabLimitExceedMsg,buttons:Ext.Msg.OK,icon:Ext.Msg.WARNING});if(isConsoleMetricBarEnabled){selectedCard="";setActiveCard("undefined")}return}var h=getPositionForTabToBeAdded();TabPanel.insert(h,{id:g,closable:true,html:c,title:e,tooltip:e,recordValue:g,listeners:{beforeclose:beforeCloseTabEvent}}).show();TabPanel.setActiveTab(g);tabCount++}else{TabPanel.setActiveTab("firstTab");if(a){selectedCard="";ChangeListViewFilter(a,true)}}}else{if(g=="viewincidentSR"||g=="viewincident"){_RFServerValues.inctype="Incident";isServiceRequest=false}else{if(g=="viewservicerequest"){_RFServerValues.inctype="ServiceRequest";isServiceRequest=true}else{_RFServerValues.inctype=null;isServiceRequest=false}}if(isConsoleMetricBarEnabled&&a){TabPanel.setActiveTab("firstTab");if(currentObjectWithList==TabPanel.activeTab.title){b=true}viewMainTab();if(b&&!j){selectedCard="";ChangeListViewFilter(a,true)}else{var i=d;if(g=="viewservicerequest"){i+="_SR"}document.cookie="apex__"+i+"_ListFilterID="+a+";path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString();getValueMap__Remote(d,true,a)}return}getValueMap__Remote(d,true);viewMainTab()}}function returnLabel(a,b){if(!isRFHotkeysDisabled){if(b=="N"){return a+" (Ctrl+Alt+N)"}else{if(b=="S"){return a+" (Ctrl+Alt+S)"}else{if(b=="A"){return a+" (Ctrl+Alt+A)"}else{if(b=="T"){return a+" (Ctrl+Alt+T)"}else{if(b=="0"){if(isAZERTYKeyBoard){return a+" (Ctrl+Alt+L)"}else{return a+" (Ctrl+Alt+0)"}}}}}}}else{return a}}function checkTabExists(c){var b=false;var a=TabPanel.items;var e="";for(var d=0;d<a.length&&!b;d++){e=a.items[d].recordValue;if(e!=null&&typeof(e)!="undefined"&&a.items[d].recordValue==c){b=true;tabExistId=a.items[d].id;return b}}return b}function changeTabItemId(f,c){if(TabPanel){var b=false;var e=truncateRecordId(f);var a=TabPanel.items;for(var d=0;d<a.length&&!b;d++){if(a.items[d].id==c){a.items[d].recordValue=e;a.items[d].dirty=false;b=true}}}}function changeTabTitle(c,f){c=truncateRecordId(c);var g=f;if(f!=null&&f!=""&&f!="undefined"){f=Ext.util.Format.ellipsis(f,36)}f=Ext.util.Format.htmlEncode(f);if(TabPanel){var a=TabPanel.items;for(var d=0;d<a.length;d++){if(a.items[d].id==c){a.items[d].setTitle(f);var e=a.items[d].tab.btnInnerEl.id;Ext.get(e).update(f);if(c=="firstTab"){a.items[d].tab.setTooltip(returnLabel(g,"0"))}else{if(f.indexOf("*")==-1){a.items[d].tab.setTooltip(g);var b=a.items[d].tab.btnEl.id;document.getElementById(b).title=g}}return}}}}function refreshList(){doRefresh()}function viewMainTab(){changeTabTitle("firstTab",currentObjectWithList);TabPanel.setActiveTab("firstTab")}function onBounceHandler(a){if(!Ext.isIE){a.behavior="scroll";a.direction="right";a.direction="left"}}function showBroadcast(){var c=broadcastPage+"?fromSS=true&fromconsole=true&fromRFconsole=true";var b;if(Ext.isIE||Ext.isSafari){b=547}else{b=542}var a="background-color:#FFFFFF;";broadcastWindow=new Ext.Window({height:b,title:broadcastLabel,width:650,pageX:450,pageY:125,resizable:false,modal:true,constrain:true,animate:true,cls:"broadcastWindow",bodyStyle:"padding-top: 25px; padding-bottom:5px; background:#FFFFFF;",style:"padding: 0; border-width: 0;background:#FFFFFF;",border:false,closable:false,tools:[{type:"rfclose",width:30,height:30,minWidth:30,handler:function(f,e,d){broadcastWindow.close()}}],viewConfig:{forceFit:true},html:'<iframe src ="'+c+'" style="width:100%;height:100%;border:none"/>'});broadcastWindow.show();broadcastWindow.center();broadcastWindow.on("move",function(){var d=broadcastWindow.getSize()})}function createTicker11(a,c){var d=Ext.JSON.decode(a,true);var b=document.getElementById("broadcast-ticker");if(b&&d){b.setAttribute("scrollamount",d[0].speed);b.appendChild(document.createTextNode(d[0].ticker));if(!Ext.isIE&&!Ext.isChrome&&!Ext.isSafari){b.behavior="alternate"}}}function startTabWaitMsgBar(){if(waitTabMsgBar!=""){waitTabMsgBar.setVisible(true)}}function stopTabWaitMsgBar(){if(waitTabMsgBar!=""&&waitTabMsgBar.isVisible()){waitTabMsgBar.setVisible(false)}}document.onkeydown=function(c){var b,a;b=window.self;a=window.self;if(!isRFHotkeysDisabled){if(_ServerVariables.ObjectName=="My_Dashboard"){handleShortcuts(c,b,a,MoreOptionsctxMenu.items.length,"dashboardPinned")}else{handleShortcuts(c,b,a,MoreOptionsctxMenu.items.length,"true")}}};function deleteTab(){var b=TabPanel.items;var a=TabPanel.getActiveTab();if(a.id!=b.items[0].id){a.close()}}function getListTabLabel(){var a=SingleConsolePage.Labels.viewIncidentConsole;if(objectName=="Incident__c"){if(_RFServerValues.IncidentSegregationEnabled){if(isServiceRequest||(_RFServerValues.IncidentSegregationEnabled&&_RFServerValues.srViewState&&!_RFServerValues.incViewState)){a=SingleConsolePage.Labels.viewServiceRequestsOnly}else{a=SingleConsolePage.Labels.viewIncidentsOnly}}else{a=SingleConsolePage.Labels.viewIncidentConsole}}else{if(objectName=="Task__c"){a=SingleConsolePage.Labels.viewTaskConsole}else{if(objectName=="Change_Request__c"){a=SingleConsolePage.Labels.viewChangeConsole}else{if(objectName=="Problem__c"){a=SingleConsolePage.Labels.viewProblemConsole}else{if(objectName=="Release__c"){a=SingleConsolePage.Labels.viewReleseConsole}else{if(objectName=="Broadcasts__c"){a=SingleConsolePage.Labels.viewBroadcastConsole}else{if(objectName=="My_Dashboard"){a=SingleConsolePage.Labels.MyDashboard}else{if(objectName=="Projected_Service_Outage__c"){a=SingleConsolePage.Labels.RR_FeatureOutages}}}}}}}}return a}function beforeCloseTabEvent(a){if(a.dirty){a.focus();setTimeout(function(){Ext.Msg.defaultButton=2;Ext.Msg.baseCls="bmc-message";Ext.Msg.show({title:SingleConsolePage.Labels.ConfirmAction,msg:SingleConsolePage.Labels.labelcloseWindowLabel,buttons:Ext.Msg.YESNO,buttonText:{yes:SingleConsolePage.Labels.Yes,no:SingleConsolePage.Labels.No},fn:function(b){if(b=="yes"){a.dirty=false;a.close();tabCount--}else{TabPanel.setActiveTab(a.id)}},icon:Ext.MessageBox.WARNING})},50);return false}else{tabCount--}}function updateDirtyFlag(c,e){if(TabPanel){if(c!=""){var b=TabPanel.getActiveTab();if(b.id==c){b.dirty=e}else{var a=TabPanel.items;for(var d=0;d<a.length;d++){if(a.items[d].id==c){a.items[d].dirty=e}}}}}}var isIncidentFromChat=false;var isChatError=false;var chatTempAttachmentId="";function ChatAction_Remote(a,b){listViewGridShowWaitMask();isChatError=false;callRemoteAction(_RFRemotingActions.ChatAction,a,b,function(c,e){if(e.status){if(c!=""){var d=c[nsprifix+"incidentDescription__c"];if(d!=null&&d!=""&&d!=undefined&&d.indexOf("ERROR")!=-1){var f=d.substring(d.indexOf("ERROR")+6,d.length);isChatError=true;Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:f,buttons:Ext.Msg.OK,icon:Ext.MessageBox.ERROR})}else{if(d!=null&&d!=""&&d!=undefined&&d.indexOf("ATTACHMENT")!=-1){chatTempAttachmentId=d.split("CHAT_ATTACHMENT")[1]}isIncidentFromChat=true;addTab(null,"","Incident__c",false,"ChatInstance__c",chatInstanceId);isIncidentFromChat=false;stopPolling();document.getElementById("chatWindow").style.display="none"}listViewGridHideWaitMask();if(isChatError==false){chatInstanceId="";chatInstance=setInterval(function(){checkForChat()},5000);updateBackground("chatStatusTitleGreen");replacetextNode("Available")}}}},{escape:true})}var incidentRecord="";var incidentName="";var isLinkIncident="";function ChatAction_Link(b){if(b!=null&&b!=""){b[3]=chatInstanceId;incidentRecord=b[0];incidentName=b[1];isLinkIncident=b[2]}var a=[incidentRecord,incidentName,isLinkIncident,chatInstanceId];isChatError=false;callRemoteAction(_RFRemotingActions.ChatActionLink,a,function(c,d){if(d.status){if(c!=""){if(c.length>0&&c[0]!=""&&c[0].indexOf("CHAT_ERROR")!=-1){var e=c[1];isChatError=true;Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:e,buttons:Ext.Msg.OK,icon:Ext.MessageBox.ERROR})}else{isIncidentFromChat=true;if(incidentRecord!=""&&incidentName!=""){addTab(incidentRecord,incidentName,"Incident__c",false,"",null,"")}isIncidentFromChat=false;stopPolling();document.getElementById("chatWindow").style.display="none"}listViewGridHideWaitMask();if(isChatError==false){chatInstanceId="";lastMsgSender="";chatInstance=setInterval(function(){checkForChat()},5000);updateBackground("chatStatusTitleGreen");replacetextNode("Available");removeAllChildOfChatWindow()}}}},{escape:true})}function openPopupForIncident(){var b=parseInt((screen.availWidth/2)-(670/2));var a=parseInt((screen.availHeight/2)-(480/2));window.open(searchAndLinkPage+"?txt=customLookup&parentName=Incident__c&childName=Incident__c&linkIncidentFromChat=true&filterId=clientid&param1="+chatClientId,"lookup","status = 1,height =480, width = 671,left= "+b+",top="+a+", resizable = 0,scrollbars=no")}function checkForChat(){if(isRFChatEnabled){callRemoteAction(_RFRemotingActions.CheckForChatInitialisation,function(a,c){if(c.status){if(a!=""){var b=a.split(String.fromCharCode(1087));chatInstanceId=b[0];chatLastMsgId=-1;clientName=b[1];chatClientId=b[2];updateBackground("chatStatusTitleRed");replacetextNode("Busy");chat(remedyforceChatLabel,false);clearInterval(chatInstance);getMessage();if(chatInstanceId!=undefined&&chatInstanceId!=""){interval=setInterval(getMessage,5000)}}}},{escape:true})}}function checkAgentAvailability(){callRemoteAction(_RFRemotingActions.setAgentAvailability,true,function(a,b){},{escape:true})}function stopAgentPooling(){clearInterval(chatInstance);clearInterval(agentAvailability);callRemoteAction(_RFRemotingActions.setAgentAvailability,false,function(a,b){},{escape:true})}var chatInstance;var agentAvailability;if(isRFChatEnabled){chatInstance=setInterval(function(){checkForChat()},5000)}function addDashboardAndQVMenuItems(){var e=Ext.getBody().getViewSize().height;var d=100;var g=window.location.hash=!!window.MSInputMethodContext;if(e>200&&!g){d=e-100}else{if(g&&e>450){d=e-350}}var w='<span title="'+SingleConsolePage.Labels.PinUnPinConsoleListToolTip+'" class="d-icon-right-pinned rf-pin-object-list {0}" id=Pinned_My_Dashboard onclick="pinObjectView(this);"></span>'+SingleConsolePage.Labels.MyDashboard;w=String.format(w,(pinnedObject()=="My_Dashboard")?"rf-pin-object-active":"");var p=new Ext.menu.Item({id:"myDashboard",lbl:SingleConsolePage.Labels.MyDashboard,text:w,tooltipType:"title",height:30,handler:function(){loaddashboard(true)}});MoreOptionsctxMenu.add(p);var l=k();var t=[];var a="rf-qv-left-float";var b="rf-qv-right-float";var m="rf-shared-qv-icon-ltr";if(l==="left"){a="rf-qv-right-float";b="rf-qv-left-float";m="rf-shared-qv-icon-rtl"}for(var q=0;q<tempQVList.length;q++){t.push({qvId:tempQVList[q][0].id,qvname:tempQVList[q][1].name,text:isAdmin?'<div class="subMenu" style="height:16px;"><div class="'+a+'">'+tempQVList[q][1].name+'</div><div class="'+b+'"><span class="d-icon-cross qv-icon '+b+'" qvid="'+tempQVList[q][0].id+'" onclick="deleteQV(this);" title="'+SingleConsolePage.Labels.DeleteQuery+'" ></span><span qvid="'+tempQVList[q][0].id+'" qvname="'+tempQVList[q][1].name+'" class="d-icon-files_copy_o qv-icon '+b+'" onclick="copyQV(this);" title="'+SingleConsolePage.Labels.CopyQuery+'"></span><span class="d-icon-pencil qv-icon '+b+'" title="'+SingleConsolePage.Labels.EditQVQuery+'" qvid="'+tempQVList[q][0].id+'" qvname="'+tempQVList[q][1].name+'" onclick="editQVTab(this)"></span></div></div>':'<div class="subMenu" style="display:list-item"><div class="'+a+'">'+tempQVList[q][1].name+"</div></div>",system:tempQVList[q][2].system,optimized:tempQVList[q][3].optimized,tooltip:tempQVList[q][4].tooltip,tooltipType:tempQVList[q][5].tooltipType,handler:addQVTab})}var f="1";if(isAdmin){var o="rf-myqv-menuitem-ltr";var v="rf-create-new-qv-ltr";if(l==="left"){o="rf-myqv-menuitem-rtl";v="rf-create-new-qv-rtl"}if(tempQVList.length>0){t.push({xtype:"menuseparator"});t.push({qvId:1,text:"<div id="+f+' class="subMenu '+v+'">'+SingleConsolePage.Labels.CreateNewQV+'</div><span class="d-icon-plus qv-icon '+o+'" title="'+SingleConsolePage.Labels.CreateNewQV+'" /></span>',qvname:SingleConsolePage.Labels.CreateNewQV,handler:addQVTab})}else{t.push({qvId:1,text:"<div id="+f+' class="subMenu '+v+'">'+SingleConsolePage.Labels.CreateNewQV+'</div><span class="d-icon-plus qv-icon '+o+'" title="'+SingleConsolePage.Labels.CreateNewQV+'" /></span>',qvname:SingleConsolePage.Labels.CreateNewQV,handler:addQVTab})}}var u=[];for(var q=0;q<tempSharedQVList.length;q++){u.push({qvId:tempSharedQVList[q][0].id,qvname:tempSharedQVList[q][1].name,text:isAdmin?((isShowManagePermissionIcon&&tempSharedQVList[q][2].system.toLowerCase()=="true")?('<div class="subMenu" style="height:16px;"><div class="'+a+'">'+tempSharedQVList[q][1].name+'</div><div class="'+b+'"><span qvid="'+tempSharedQVList[q][0].id+'" qvname="'+tempSharedQVList[q][1].name+'" class="d-icon-files_copy_o qv-icon '+m+'" onclick="copyQV(this);" title="'+SingleConsolePage.Labels.CopyQuery+'" ></span><span qvid="'+tempSharedQVList[q][0].id+'" qvname="'+tempSharedQVList[q][1].name+'" class="qv-icon d-icon-key '+m+'" onclick="manageQVPermissions(this)"title="'+SingleConsolePage.Labels.managePermissions+'"></span></div></div>'):('<div class="subMenu" style="height:16px;"><div class="'+a+'">'+tempSharedQVList[q][1].name+'</div><div class="'+b+'"><span qvid="'+tempSharedQVList[q][0].id+'" qvname="'+tempSharedQVList[q][1].name+'" class="sprite-QV-copy-icon-12 '+m+'" onclick="copyQV(this);" title="'+SingleConsolePage.Labels.CopyQuery+'"></span></div></div>')):('<div class="subMenu"><div class="'+a+'">'+tempSharedQVList[q][1].name+"</div></div>"),system:tempSharedQVList[q][2].system,optimized:tempSharedQVList[q][3].optimized,tooltip:tempSharedQVList[q][4].tooltip,tooltipType:tempSharedQVList[q][5].tooltipType,handler:addQVTab})}var c=Ext.create("Ext.menu.Menu",{id:"myQvSubMenu",cls:"bmc-menu-dark",items:t,maxHeight:d,listeners:{mouseleave:{element:"el",fn:function(){setTimeout(function(){Ext.getCmp("myQvSubMenu").hide()},200);viewMenuHideEvent=setTimeout(function(){Ext.getCmp("otheroptionsMenu").hide()},200)}}}});function k(){var i="right";if(userLanguage=="iw"){i="left"}return i}var h=new Ext.menu.Item({id:"myQV",lbl:SingleConsolePage.Labels.MyQuickViews,text:'<div style="display:inline-block;">'+SingleConsolePage.Labels.MyQuickViews+'</div><span class="d-icon-angle_'+k()+' my-qv-right-arrow" style="float:'+k()+';"></span>',tooltipType:"title",height:30,menu:c,listeners:{render:function(y,x){y.arrowEl.dom.style.display="none";if(k()=="left"){var i=y.textEl.dom.style;i.marginLeft=i.marginRight;i.marginRight=""}}},handler:function(){showMyQVMenu()}});if(t.length>0){MoreOptionsctxMenu.add(h)}var n=Ext.create("Ext.menu.Menu",{id:"sharedQVSubMenu",cls:"bmc-menu-dark",items:u,maxHeight:d,listeners:{mouseleave:{element:"el",fn:function(){setTimeout(function(){Ext.getCmp("sharedQVSubMenu").hide()},200);viewMenuHideEvent=setTimeout(function(){Ext.getCmp("otheroptionsMenu").hide()},200)}}}});var j=new Ext.menu.Item({id:"sharedQV",lbl:SingleConsolePage.Labels.SharedQuickViews,text:'<div style="display:inline-block;">'+SingleConsolePage.Labels.SharedQuickViews+'</div><span class="d-icon-angle_'+k()+' my-qv-right-arrow" style="float:'+k()+';"></span>',tooltipType:"title",menu:n,height:30,listeners:{render:function(y,x){y.arrowEl.dom.style.display="none";if(k()=="left"){var i=y.textEl.dom.style;i.marginLeft=i.marginRight;i.marginRight=""}}},handler:function(){showSharedQVMenu()}});MoreOptionsctxMenu.add(j);function s(){var i=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return i?parseInt(i[2],10):false}if(Ext.isChrome){var r=s();if(r==43){Ext.override(Ext.menu.Menu,{onMouseLeave:function(y){var x=this;var i=false;x.items.each(function(z){if(z.menu&&z.menu.isVisible()){i=true}});if(i){return}}})}}}function addDisplayMultipleViewsMenuItem(){var a=null;if(isMultipleListViewsEnabled){a="checked"}var b=new Ext.menu.Item({id:"viewEnableMultipleListView",lbl:SingleConsolePage.Labels.DisplayMultipleViews,text:SingleConsolePage.Labels.DisplayMultipleViews+'<div class="switch" style="float:right;margin-left: 10px;"><input type="checkbox" id="multiplelistviewssettings" '+a+' /><span class="switch__slider switch_button_position" style="right: 4px !important;" title="'+SingleConsolePage.Labels.DisplayMultipleViewsToolTip+'" onclick="toggleMultipleListViews(this);"></span></div>',tooltipType:"title",cls:"rf_multi_list_switch",height:30,minWidth:185,hideOnClick:false});MoreOptionsctxMenu.add(b)}var loaddashboard=function(d){if(isHandlerOff){isHandlerOff=false;return}var c=Ext.util.Cookies.get("apex__EnableMultipleListViews");if(c&&!isOnlyConsoleDashboardEnabled){openSelectedListView("ConsoleDashboard",false)}else{if(TabPanel.items.map.firstTab&&TabPanel.items.map.firstTab.title==SingleConsolePage.Labels.MyDashboard){TabPanel.setActiveTab("firstTab");return}if(d==null||typeof(d)=="undefined"){d=true}var a=checkTabExists("ConsoleDashboard");if(a){TabPanel.setActiveTab("ConsoleDashboard")}else{var b=getPositionForTabToBeAdded();TabPanel.insert(b,{id:"ConsoleDashboard",closable:d,html:'<iframe src ="'+consoleDashboardPageURL+'" style="width:100%;height:100%;border:none" id="dashboardframe" name="dashboardframe" scrolling="yes"/>',title:SingleConsolePage.Labels.MyDashboard,tooltip:SingleConsolePage.Labels.MyDashboard,recordValue:"ConsoleDashboard",listeners:{beforeclose:beforeCloseTabEvent}}).show();TabPanel.setActiveTab(ConsoleDashboard);tabCount++}}};var showMyQVMenu=function(){MoreOptionsctxMenu.show();MoreOptionsctxMenu.alignTo(Ext.get("viewOptions"),"tl-bl",[0,0]);var b=MoreOptionsctxMenu.getChildByElement("myQV");b.menu.show();MoreOptionsctxMenu.show();b.expandMenu();b.menu.alignTo(Ext.get("myQV"),"tl-tr",[0,0]);var a=Ext.getCmp("myQvSubMenu");a.focus(false,10);if(MoreOptionsctxMenu.canActivateItem(b)){MoreOptionsctxMenu.setActiveItem(b);if(b.menu.canActivateItem(b.menu.items.items[0])){b.menu.setActiveItem(b.menu.items.items[0])}else{b.menu.setActiveItem(b.menu.items.items[1])}}};var showSharedQVMenu=function(){MoreOptionsctxMenu.show();MoreOptionsctxMenu.alignTo(Ext.get("viewOptions"),"tl-bl",[0,0]);var b=MoreOptionsctxMenu.getChildByElement("sharedQV");b.menu.show();MoreOptionsctxMenu.show();b.expandMenu();b.menu.alignTo(Ext.get("sharedQV"),"tl-tr",[0,0]);var a=Ext.getCmp("sharedQVSubMenu");a.focus(false,10);if(MoreOptionsctxMenu.canActivateItem(b)){MoreOptionsctxMenu.setActiveItem(b);if(b.menu.canActivateItem(b.menu.items.items[0])){b.menu.setActiveItem(b.menu.items.items[0])}}};var isHandlerOff=false;function editQVTab(a){addQVTab(a.getAttribute("qvid"),a.getAttribute("qvname"),"edit");isHandlerOff=true}function manageQVPermissions(a){addQVTab(a.getAttribute("qvid"),a.getAttribute("qvname"),"edit");isHandlerOff=true}var qvNameInvalid=false;var labelvalidateQueryNameSkyWalkerPage;var selectedCopyParam;function copyQV(b){selectedCopyParam=b;isHandlerOff=true;if(qvNameInvalid){labelvalidateQueryNameSkyWalkerPage=SingleConsolePage.Labels.labelReenterQVName;qvNameInvalid=false}else{labelvalidateQueryNameSkyWalkerPage=SingleConsolePage.Labels.labelEnterQVname}Ext.Msg.baseCls="bmc-message";var a=Ext.Msg.show({title:SingleConsolePage.Labels.labelAddQuery,msg:labelvalidateQueryNameSkyWalkerPage,width:250,buttons:Ext.Msg.OKCANCEL,buttonText:{ok:oklbl,cancel:SingleConsolePage.Labels.Cancel},prompt:true,fn:function(c,d){if(c=="ok"){if(d.length>80){qvNameInvalid=true;copyQV(selectedCopyParam)}else{if(d!=null&&d!=""){listViewGridShowWaitMask();copyQuery(b.getAttribute("qvid"),d)}}}}});a.msgButtons[0].setDisabled(true);a.textField.on("change",function(c,f){var d=c.value.trim().length==0;a.msgButtons[0].setDisabled(d)})}function updateMenuItems(c){listViewGridHideWaitMask();if(c=="copy"){if(copiedQVId==""){var b=Ext.Msg.alert(SingleConsolePage.Labels.labelWarning,SingleConsolePage.Labels.labelQueryNameExisting,function(e){if(e=="ok"){copyQV(selectedCopyParam)}});b.msgButtons[0].setDisabled(false)}else{isHandlerOff=false;addQVTab(copiedQVId,copiedQVName,"edit");copiedQVId="";copiedQVName=""}}if(MoreOptionsctxMenu.getChildByElement("myDashboard")!=null){MoreOptionsctxMenu.remove(MoreOptionsctxMenu.getChildByElement("myDashboard"))}if(MoreOptionsctxMenu.getChildByElement("myQV")!=null){MoreOptionsctxMenu.remove(MoreOptionsctxMenu.getChildByElement("myQV"))}if(MoreOptionsctxMenu.getChildByElement("sharedQV")!=null){MoreOptionsctxMenu.remove(MoreOptionsctxMenu.getChildByElement("sharedQV"))}var a=1;if(Ext.isSafari){a=3}addDashboardAndQVMenuItems(MoreOptionsctxMenu);if(MoreOptionsctxMenu.getChildByElement("viewEnableMultipleListView")!=null){MoreOptionsctxMenu.remove(MoreOptionsctxMenu.getChildByElement("viewEnableMultipleListView"))}addDisplayMultipleViewsMenuItem();var d=MoreOptionsctxMenu.items.length;MoreOptionsctxMenu.items.each(function(e){if(!isRFHotkeysDisabled){if(!isAZERTYKeyBoard){var f=e.lbl?e.lbl:e.text;if(a<10&&!(e.id=="myQV"||e.id=="sharedQV")){f=f+" (Ctrl+Alt+"+a+")"}e.setTooltip(f)}else{addTooltipIfAZERTY(e)}}else{e.setTooltip(e.lbl?e.lbl:e.text)}a=a+1})}function setPinToggleActive(a){document.getElementById(a).setAttribute("class","d-icon-right-pinned rf-pin-object-list rf-pin-object-active")}function setPinToggleInactive(b){for(var a=0;a<b.length;a++){if(document.getElementById(b[a])){document.getElementById(b[a]).setAttribute("class","d-icon-right-pinned rf-pin-object-list")}}}function pinObjectView(a){var d=a.getAttribute("id").substring(a.getAttribute("id").indexOf("_")+1);var b=(d=="SRIncident__c")?"Incident__c":d;var e=["Pinned_Incident__c","Pinned_SRIncident__c","Pinned_Change_Request__c","Pinned_Release__c","Pinned_Task__c","Pinned_Broadcasts__c","Pinned_Problem__c","Pinned_My_Dashboard","Pinned_Projected_Service_Outage__c"];setPinToggleInactive(e);if(pinnedObject()&&pinnedObject()==d){document.cookie="apex__PinnedListView=;path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString();if(TabPanel.items.map.firstTab.title==SingleConsolePage.Labels.viewServiceRequestsOnly){document.cookie="apex__isSRLastRFConsoleView=true;path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString()}else{document.cookie="apex__isSRLastRFConsoleView=false;path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString()}var c=fetchObjNameFromTabTitle(TabPanel.items.map.firstTab.title);document.cookie="apex__LastRFConsoleView="+c+";path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString();isHandlerOff=true;return}else{document.cookie="apex__PinnedListView="+b+";path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString();if(d=="SRIncident__c"){document.cookie="apex__isSRLastRFConsoleView=true;path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString()}else{document.cookie="apex__isSRLastRFConsoleView=false;path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString()}setPinToggleActive(a.getAttribute("id"))}isHandlerOff=true}function fetchObjNameFromTabTitle(a){var b;switch(a){case SingleConsolePage.Labels.viewIncidentConsole:b="Incident__c";break;case SingleConsolePage.Labels.viewIncidentsOnly:b="Incident__c";break;case SingleConsolePage.Labels.viewServiceRequestsOnly:b="Incident__c";break;case SingleConsolePage.Labels.viewChangeConsole:b="Change_Request__c";break;case SingleConsolePage.Labels.viewTaskConsole:b="Task__c";break;case SingleConsolePage.Labels.viewProblemConsole:b="Problem__c";break;case SingleConsolePage.Labels.viewReleseConsole:b="Release__c";break;case SingleConsolePage.Labels.viewBroadcastConsole:b="Broadcasts__c";break;case SingleConsolePage.Labels.MyDashboard:b="My_Dashboard";break;case SingleConsolePage.Labels.RR_FeatureOutages:b="Projected_Service_Outage__c";break}return b}function toggleMultipleListViews(a){if(document.getElementById("multiplelistviewssettings").checked){document.getElementById("multiplelistviewssettings").checked=false;document.cookie="apex__EnableMultipleListViews=;path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString();isMultipleListViewsEnabled=null}else{callRemoteAction(_RemotingActions.isPageAccessible,"ConsoleListViewPage",function(b,c){if(c.status){if(b.hasAccess==true){document.getElementById("multiplelistviewssettings").checked=true;document.cookie="apex__EnableMultipleListViews=true;path=/;SameSite=None;Secure;expires="+getRFCookieExpiry().toUTCString();isMultipleListViewsEnabled="true"}else{if(b.isAdmin==true){showInfoMessage(_ServerLabels.ClickAndDragToReorder+' <a href="https://docs.bmc.com/docs/remforce201802/en/20-18-02-profile-level-permissions-811771351.html" target="_blank">'+_ServerLabels.here+"</a>")}else{showInfoMessage(_ServerLabels.NonAdminInsufficentAccessOnFeature)}}}},{escape:true})}}function deleteQV(a){isHandlerOff=true;Ext.Msg.baseCls="bmc-message";Ext.Msg.show({title:SingleConsolePage.Labels.labelDelete,msg:SingleConsolePage.Labels.DeleteQV,buttons:Ext.Msg.YESNO,buttonText:{yes:SingleConsolePage.Labels.Yes,no:SingleConsolePage.Labels.No},icon:Ext.MessageBox.WARNING,fn:function(b){if(b=="yes"){listViewGridShowWaitMask();deleteQuery(a.getAttribute("qvid"))}}})}function addQVTab(b,f,c){var g=qvTabTitle=qvTabTooltip="";var h,j;if(isHandlerOff){isHandlerOff=false;return}var g="";var a="";if(c=="edit"){g=b;a=f}else{g=b.qvId;h=b.system;j=b.optimized;if(b.text.indexOf("<div")>-1){a=b.qvname}else{a=b.text}}qvTabTitle=Ext.util.Format.ellipsis(Ext.util.Format.htmlDecode(a),15);qvTabTitle=Ext.util.Format.htmlEncode(qvTabTitle);var k;if(c=="edit"){k=checkTabExists(g+"-edit")}else{if(g!="1"){k=checkTabExists(g)}}var i;if(k&&c=="edit"){TabPanel.setActiveTab(g+"-edit")}else{if(k&&c!="edit"){TabPanel.setActiveTab(g)}else{if(tabCount<MaxRecordTabCount){if(g=="1"){a=SingleConsolePage.Labels.CreateNewQV;i="QVWiz?parent=console&qvfldr="+myQVFolderId;g=++newTabstart;qvTabTooltip=a}else{if(c=="edit"){i="QVWiz?parent=console&qvid="+g;qvTabTooltip=f}else{i="/apex/ConsoleQuickViewPage?queryName="+g+"&isDashboard=false&qvTitle="+encodeURIComponent(b.tooltip)+"&system="+h+"&optimized="+j+"&isSingleRow=true";qvTabTooltip=b.tooltip}}var d=c=="edit"?b+"-"+c:g;TabPanel.add({id:d.toString(),closable:true,html:'<iframe id="iframe-'+g+'"  src="'+i+'" style="width:100%;height:100%;border:none"/>',title:c=="edit"?SingleConsolePage.Labels.labelQVEditor+"-"+qvTabTitle:qvTabTitle,tooltip:qvTabTooltip,recordValue:c=="edit"?b+"-"+c:g,listeners:{beforeclose:beforeCloseTabEvent},tabConfig:{style:{borderRadius:0},cls:"RF_TextSelection",margin:"0 0 0 -2"}}).show();if(c=="edit"){TabPanel.setActiveTab(f)}else{TabPanel.setActiveTab(g)}tabCount++}else{Ext.Msg.baseCls="bmc-notiltle-msg";Ext.Msg.show({msg:SingleConsolePage.Labels.RFTabLimitExceedMsg,buttons:Ext.Msg.OK,icon:Ext.Msg.WARNING});return}}}}var loadChangeschTab=function(){var e=650;var b=1100;var c=(screen.width-b)/2;var a=parseInt((screen.height/2)-(e/2))-50;var d=window.open("/apex/ChangeSchedule?standardLayout=true","viewChangeschedule","status = 1,height ="+e+",width ="+b+",left="+c+",top="+a+", resizable = 1,scrollbars=no");if(d.focus){d.focus()}};function addTooltipIfAZERTY(b){var a=b.lbl?b.lbl:b.text;if(b.getId()=="viewIncidentConsole"){b.setTooltip(a+" (Ctrl+Alt+I)")}else{if(b.getId()=="viewIncidentsOnly"){b.setTooltip(a+" (Ctrl+Alt+I)")}else{if(b.getId()=="viewServiceRequestsOnly"){b.setTooltip(a+" (Ctrl+Alt+U)")}else{if(b.getId()=="viewTaskConsole"){b.setTooltip(a+" (Ctrl+Alt+K)")}else{if(b.getId()=="viewProblemConsole"){b.setTooltip(a+" (Ctrl+Alt+P)")}else{if(b.getId()=="viewChangeConsole"){b.setTooltip(a+" (Ctrl+Alt+H)")}else{if(b.getId()=="viewReleseConsole"){b.setTooltip(a+" (Ctrl+Alt+R)")}else{if(b.getId()=="viewBroadcastConsole"){b.setTooltip(a+" (Ctrl+Alt+B)")}else{if(b.getId()=="viewChangeschedule"){b.setTooltip(a+" (Ctrl+Alt+C)")}else{if(b.getId()=="myDashboard"){b.setTooltip(a+" (Ctrl+Alt+D)")}}}}}}}}}}}function hasFormLayoutAccessCloneMessage(b,a,d){var c=false;var f=MultiPageLayout.details[d];for(var e=0;e<f.length;e++){if(f[e].layoutKey+String.fromCharCode(172)+f[e].layoutDetailId===a){c=true;break}}if(!c){Ext.Msg.defaultButton=1;Ext.Msg.baseCls="bmc-message";Ext.Msg.show({title:_ServerLabels.lblInformation,msg:SingleConsolePage.Labels.MultiPageLayoutAccessCloneConfirm,minWidth:320,maxWidth:505,minHeight:110,buttons:Ext.Msg.OK,buttonText:{ok:oklbl},icon:Ext.MessageBox.INFO})}else{b(a)}}function listViewGridShowWaitMask(){if(typeof(ListViewGrid)!="undefined"){ListViewGrid.showWaitMask()}}function listViewGridHideWaitMask(){if(typeof(ListViewGrid)!="undefined"){ListViewGrid.hideWaitMask()}}Ext.onReady(function(){if(isLightningExperience){callRemoteAction(_RFRemotingActions.insertKeyPrefixData,function(a,b){if(b.status){console.log("insertKeyPrefixData completed")}},{escape:true})}});