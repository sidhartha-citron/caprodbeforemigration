var storeindex,cIndex;var record;var gridData=[];var grid;var templategrid;var valuegrid;var cols=new Array(5);cols[0]="processId";cols[1]="templateId";cols[2]="templateValue";cols[3]="storedValue";cols[4]="displayValue";var valuecols=new Array(2);valuecols[0]="invokeValue";valuecols[1]="storeValue";var templatecols=new Array(2);templatecols[0]="id";templatecols[1]="templateValue";var templateId;var templateName;var valueId;var storeValueId;function setData(){store.removeAll();Ext.getCmp("grid").getView().refresh();store.loadData(listData);Ext.getCmp("grid").getView().refresh()}function showTable(){store=new Ext.data.Store({fields:cols,data:gridData});function a(f,e,b,g,d,c){e.attr='ext:qtip="'+Ext.util.Format.htmlEncode(f)+'"';return f}grid=new Ext.grid.GridPanel({id:"grid",width:"99.4%",border:true,store:store,autoscroll:false,height:"100px",autoHeight:false,columns:[{hidden:true,dataIndex:cols[0]},{hidden:true,dataIndex:cols[1]},{id:"FieldLabel",header:lblProcess,sortable:true,dataIndex:cols[2],menuDisabled:true,flex:1},{hidden:true,dataIndex:cols[3]},{header:lblInvokeWhenValueIs,id:"ValueField",menuDisabled:true,flex:1,sortable:true,dataIndex:cols[4],renderer:a},{dataIndex:cols[1],flex:0.1,dataIndex:cols[1],menuDisabled:true,renderer:function(c,d,b){if(c){c='<div ><img onclick="deleteData()" title="'+lblDelete+'" src="'+deleteIconPath+'" /></div>'}return c}}],height:185,layout:"fit",stateful:true,stateId:"grid",autoScroll:true,enableColumnResize:false,enableColumnMove:false,viewConfig:{forceFit:true,scrollOffset:0},autoFitColumns:true,listeners:{afterrender:function(){setSelectedRows()},delay:1000,itemclick:function(e,d,c){storeindex=c;record=d}}});store.loadData(listData);grid.render("extGridPanel")}function setSelectedRows(){var b="";var c=grid.getStore();for(var a=0;a<listData.length;a++){if(listData[a][2]=="true"){grid.getSelectionModel().selectRow(a,true)}}}function addDataJs(){var c=valuegrid.getSelectionModel().getSelection();var f=new Array(5);var e=templateName;var d=valueId;if(c.length>1){d=null;storeValueId=null;for(var a=0;a<c.length;a++){if(d==null||d==""){d=c[a].get("invokeValue")}else{d=d+" "+andLabel+" "+c[a].get("invokeValue")}if(storeValueId==null||storeValueId==""){storeValueId=c[a].get("storeValue")}else{storeValueId=storeValueId+getSeparatorByCustomSetting(DZHE)+c[a].get("storeValue")}}}for(var b=0;b<listData.length;b++){if(listData[b][1]==templateId&&listData[b][4]==d){showMsg(lblProcessMappingError);return}}if(e==null||e==""){showMsg(lblProcessTemplateSelectionError);return}if(d==null||d==""){showMsg(lblProcessFulfillmentValueSelectionError);return}f[0]=null;f[1]=templateId;f[2]=e;f[3]=storeValueId;f[4]=d;listData.push(f);setData();setSelectedRows();setTimeout("",1000)}function deleteData(){var j;if(grid.getSelectionModel().getSelection().length>0){j=grid.getSelectionModel().getSelection()[grid.getSelectionModel().getSelection().length-1].data.processId}if(typeof j!=="undefined"&&j!==null){var a=document.getElementById(ControllProcessPageComp.ComponentVars.processId).value;if(a==null||a==""){document.getElementById(ControllProcessPageComp.ComponentVars.processId).value="'"+j+"'"}else{document.getElementById(ControllProcessPageComp.ComponentVars.processId).value=a+",'"+j+"'"}}try{var g=grid.getSelectionModel().getSelection()[grid.getSelectionModel().getSelection().length-1].data;var b=g.templateId;var h=g.displayValue;for(var d=0,f=listData.length;d<f;d++){if((listData[d][1]===b)&&(listData[d][4]===h)){var e=listData.splice(d,1);break}}}catch(c){}setData()}function beforeSave(){if(listData.length==0&&(document.getElementById(ControllProcessPageComp.ComponentVars.processId).value==null||document.getElementById(ControllProcessPageComp.ComponentVars.processId).value=="")){parent.rfPopUpClose("rfModalVFPage");return}var c="";for(var a=0;a<listData.length;a++){var b="";if(listData[a][0]==null||listData[a][0]==""){b+=listData[a][1]+NEWSEPARATORMAP[EF];b+=listData[a][3]+NEWSEPARATORMAP[EF];b+=listData[a][4]+NEWSEPARATORMAP[PE];c+=b}}document.getElementById(ControllProcessPageComp.ComponentVars.recordsId).value=Ext.util.Format.htmlDecode(c);saveProcessControll();document.getElementById(ControllProcessPageComp.ComponentVars.processId).value=null}function createRedioStore(a,d){if(a!=null&&a!=""){if(a.indexOf(PE)>-1){var e=RFSplit(a,PE);if(e.length>0){var c=0;while(c<e.length){var b=RFSplit(e[c],EF);if(b.length>0){var f=new Array(2);f[0]=b[0];f[1]=b[1];if(d=="value"){valueData.push(f)}else{if(d=="control"){listData.push(f)}}}c++}}}else{if(a.length>0){if(a.indexOf(EF)>-1){var e=RFSplit(a,EF);if(e.length>0){var f=new Array(2);f[0]=e[0];f[1]=e[1];if(d=="value"){valueData.push(f)}else{if(d=="control"){listData.push(f)}}c++}}}}}}function showMsg(a){showLightningPopup("toast","",a,"OK","","","","")}function showTemplateTable(){templatestore=new Ext.data.Store({fields:templatecols,data:templateData});templategrid=new Ext.grid.GridPanel({id:"templategrid",renderTo:"templateData",border:true,store:templatestore,autoscroll:false,autoHeight:false,selModel:new Ext.selection.RowModel({mode:"SINGLE"}),columns:[{id:"templateValue",header:lblSelectProcess,flex:1,sortable:true,dataIndex:templatecols[1]}],height:170,hideHeaders:true,layout:"fit",stateful:true,stateId:"templategrid",enableColumnResize:false,enableColumnMove:false,viewConfig:{forceFit:true,scrollOffset:0},autoFitColumns:true,listeners:{itemclick:function(f,e,c){var d=e;templateId=d.get("id");templateName=d.get("templateValue")}}})}function loadTemplateData(){templatestore.removeAll();Ext.getCmp("templategrid").getView().refresh();templatestore.loadData(templateData);Ext.getCmp("templategrid").getView().refresh()}function showValueTable(){valuestore=new Ext.data.Store({data:valueData,fields:valuecols});if(isMultiSelect.toLowerCase()=="true"){singleSelection=false}else{singleSelection=true}valuegrid=new Ext.grid.GridPanel({id:"valuegrid",renderTo:"valueData",border:true,store:valuestore,autoscroll:false,autoHeight:false,selModel:new Ext.selection.RowModel({mode:"SINGLE"}),columns:[{id:valuecols[0],header:lblValue,flex:1,sortable:true,dataIndex:valuecols[0]}],height:170,layout:"fit",stateful:true,stateId:"valuegrid",enableColumnResize:false,enableColumnMove:false,hideHeaders:true,viewConfig:{forceFit:true,scrollOffset:0},autoFitColumns:true,listeners:{itemclick:function(f,e,c){var d=e;valueId=d.get("invokeValue");storeValueId=d.get("storeValue")}}})}function loadInvokeValueData(){valuestore.removeAll();Ext.getCmp("valuegrid").getView().refresh();valuestore.loadData(valueData);Ext.getCmp("valuegrid").getView().refresh()};