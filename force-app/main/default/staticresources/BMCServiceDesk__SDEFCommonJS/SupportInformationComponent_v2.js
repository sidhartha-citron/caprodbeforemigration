var parentWindow="";if((window.parent.opener!=null)&&(window.parent.opener.parent!=null)&&(window.location.pathname.toLowerCase().indexOf("console")>-1)){parentWindow=window.parent.opener.parent}var initFlag=false,isHistoryEMailRecord=false,alreadyRun=false,sortColumnIndex=null,runCount=0,elem,grid,gtabpanel,disableAdd=true,sortColumnName="name",sortDirection="ASC",detailsPanel,listPanel2,msgBox,isResizable=true,customHeight,dispalyTitle,colsSize=0,noName=false,j=0,k=0,note,v="",colsHdrs=new Array(colsSize),flds=new Array(colsHdrs.length),arrCols=new Array(colsSize),addEditLink,selectedId,panelHeight,panelHeightIE,panelHeightIE7,childObject,parentObject,childObjectName,editLink,flag=true,noteField,attachId,urlName,type,recId,nameFld,NameVal,instanceType,param,idArray=new Array("fileOpen","editSLA","editTask","editHistory","editIncBroadcast","editIncPriority","editIncCategory","editCategory","editStandardDesc","editStandardRes","editAction","editClient","editOrganization","editIncTemp","editCRAssessment","editProblemToCR","editCRIncident","editCRTask","editProbIncidents","editCRToProblem","editProblemTask","editCRTask","editProblemToCR","editCRToIncident"),objList,idList,recordIdArray=new Array("menuOpen","menuAcknowledged","menuInProgress","menuClosed","menuSystemEntries","menuUserEntries","menuAllEntries","openProbIncidents","acknowledgedProbIncidents","inProgressProbIncidents","closedProbIncidents","openProblems","acknowledgedProblems","inProgressProblems","closedProblems","openProblemTasks","acknowledgedProblemTask","inProgressProblemTask","closedProblemTasks","openCRTasks","acknowledgedCRTask","inProgressCRTask","closedCRTasks","openCRIncidents","acknowledgedCRIncidents","inProgressCRIncidents","closedCRIncidents"),closeIdArray=new Array("addHistories","addFiles","addTask","openBroadcast","acknowledgedBroadcast","inprogressBroadcast","closedbroadcast","addIncPriority","addIncCategory","addIncBroadcast","linkToIncident","addCategory","addStandardDescription","addStandardResolution","addAction","assignSupportExperts","addClient","addOrganization","addTemplate","linkCI","linkService","userClosedIncId","userProgressIncId","userAcknowledgedIncId","userOpenIncId","linkIncidentToProblem","addCRToProblem","linkToCR","addProblemTask","addCRTask","","linkIncidentToCR","linkToProblems","addAssessmentToCR","addCRToIncidnet","linkChangesToInc","linkIncidentToCI","linkSRToCI","linkSLAToCI","linkChangesToCI","linkProblemsToCI","linkClient","addSLA","linkAccountsToCI","LinkKnowledgeArticles"),unlinkIdArray=new Array("fileDelete","unAssignSuppExp","unLinkTemplates","unLinkCI","unLinkCIIncident","unLinkToIncident","unLinkIncidentToCR","unLinkIncidentToProblem","unLinkCRToProblem","unLinkProblemToCR","unLinkCRfromIncident","unLinkProblemToCR","unLinkIncidentToCI","unLinkSRToCI","unLinkSLAToCI","unLinkCRfromCI","unLinkReleasefromCI","unLinkProblemFromCI","unLinkTaskFromCI","unlinkClient","unLinkAccountFromCI","UnlinkKnowledgeArticles","unLinkLocation"),siservertime="",isSILoaded=true,hasNext,hasPrevious,isModifiable,historyId,historyPageName,linkRecord,cObjectName,historyActionId,extRecord;var waitMask="";function GetBRes(a){if(a=="true"||a){return false}else{return true}}function handleTabLoadJS(a){if(!alreadyRun){flag=false;elem.removeAll();elem.getEl().child(".x-panel-body").update("");elem.doLayout();var c=new DataGrid();elem.add(c);elem.doLayout();if(typeof(Ext.getCmp("nextId"))!="undefined"&&recordExist){Ext.getCmp("nextId").setDisabled(true)}if(typeof(Ext.getCmp("prevId"))!="undefined"){Ext.getCmp("prevId").setDisabled(GetBRes(hasPrevious))}if(typeof(Ext.getCmp("nextId"))!="undefined"){Ext.getCmp("nextId").setDisabled(GetBRes(a))}if(parentPageId==null||parentPageId=="null"||parentPageId==""){if(typeof(Ext.getCmp("nextId"))!="undefined"){Ext.getCmp("nextId").setDisabled(true)}}for(var b=0;b<idArray.length;b++){if(typeof(Ext.getCmp(idArray[b]))!="undefined"){Ext.getCmp(idArray[b]).setDisabled(true)}}for(var b=0;b<unlinkIdArray.length;b++){if(typeof(Ext.getCmp(unlinkIdArray[b]))!="undefined"){Ext.getCmp(unlinkIdArray[b]).setDisabled(true)}}alreadyRun=true}}function setSouthPanelHeight(a,b){Ext.getCmp("south-panel").setHeight(a);Ext.getCmp("south-panel").setWidth(b);if(window.parent!=null){window.parent.Ext.getCmp("canvasPanelId").doLayout(true,true)}}function applyToolTipOnSIHeaderBtn(){var a=Ext.getCmp("south-panel");new Ext.ToolTip({target:a.tools.minimize,trackMouse:false,anchor:"top",html:labelMinimize});new Ext.ToolTip({target:a.tools.maximize,trackMouse:false,anchor:"top",html:labelMaximize});new Ext.ToolTip({target:a.tools.restore,trackMouse:false,anchor:"top",html:labelRestore})}function displayTitle(a){if(a=="IncidentTemplate__c"||a=="TaskTemplate__c"){dispalyTitle=labelLinkedTemplates;isResizable=false;customHeight=175;panelHeightIE=182;panelHeightIE7=182;panelHeight=180}else{if(a=="Change_Request__c"){dispalyTitle=labelSupportingInformation;var b=Ext.util.Cookies.get(window.parent.cookieName);if(b=="true"){dispalyTitle+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javaScript:void(0)" id="hideSIID" onclick="clearCookie();">'+labelSupporting_Hide+"</a>"}isResizable=true;customHeight=242;panelHeightIE=250;panelHeightIE7=275;panelHeight=245}else{if(a=="Problem__c"){dispalyTitle=labelSupportingInformation;var b=Ext.util.Cookies.get(window.parent.cookieName);if(b=="true"){dispalyTitle+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javaScript:void(0)" id="hideSIID" onclick="clearCookie();">'+labelSupporting_Hide+"</a>"}isResizable=true;customHeight=242;panelHeightIE=230;panelHeightIE7=230;panelHeight=240}else{if(a=="BMC_BaseElement__c"){dispalyTitle="";isResizable=true;customHeight=186;if(getUrlParameter("wid")==null||getUrlParameter("wid")==""){var c;if(window.parent!=null&&window.parent!="undefined"&&window.parent.location!=null&&window.parent.location!="undefined"){c=window.parent.location.pathname}if(c!=null&&c.indexOf("apex/CIExplorerLauncher")!=-1){panelHeightIE=280;panelHeightIE7=265;panelHeight=285}else{panelHeightIE=695;panelHeightIE7=680;panelHeight=700}}else{panelHeightIE=500;panelHeightIE7=550;panelHeight=500}}else{if(a=="Base_Location"||a=="Model__c"){dispalyTitle="";isResizable=true;customHeight=186;if(getUrlParameter("wid")==null||getUrlParameter("wid")==""){var c;if(window.parent!=null&&window.parent!="undefined"&&window.parent.location!=null&&window.parent.location!="undefined"){c=window.parent.location.pathname}if(c!=null&&c.indexOf("apex/AdminHomePage")!=-1){panelHeightIE=280;panelHeightIE7=265;panelHeight=285}else{panelHeightIE=695;panelHeightIE7=680;panelHeight=700}}else{panelHeightIE=500;panelHeightIE7=550;panelHeight=500}}else{if(a=="ServiceLevelAgreement__c"){dispalyTitle=labelSupportingInformation;var b=Ext.util.Cookies.get(window.parent.cookieName);if(b=="true"){dispalyTitle+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javaScript:void(0)" id="hideSIID" onclick="clearCookie();">'+labelSupporting_Hide+"</a>"}isResizable=true;customHeight=186;panelHeightIE=210;panelHeightIE7=200;panelHeight=215}else{dispalyTitle=labelSupportingInformation;var b=Ext.util.Cookies.get(window.parent.cookieName);if(b=="true"){dispalyTitle+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javaScript:void(0)" id="hideSIID" onclick="clearCookie();">'+labelSupporting_Hide+"</a>"}isResizable=true;customHeight=186;if(a=="Incident__c"){panelHeightIE=205;panelHeightIE7=205;panelHeight=210}else{if(a=="Broadcasts__c"){panelHeightIE=205;panelHeightIE7=205;panelHeight=205}else{panelHeightIE=182;panelHeightIE7=182;panelHeight=180}}}}}}}}}Ext.override(Ext.layout.ToolbarLayout,{fitToSize:function(c){if(this.container.enableOverflow===false){return}var f=c.dom.clientWidth;var w=this.lastWidth||0;this.lastWidth=f;var u=Ext.isIE?document.documentElement.firstChild.offsetWidth:c.dom.firstChild.offsetWidth;var o=f-this.triggerWidth;var p=-1;if(u>f||(this.hiddens&&f>=w)){var t,r=this.container.items.items,s=r.length,q;var x=0;for(t=0;t<s;t++){q=r[t];if(!q.isFill){x+=this.getItemWidth(q);if(x>o){if(!q.xtbHidden){this.hideItem(q)}}else{if(q.xtbHidden){this.unhideItem(q)}}}}}if(this.hiddens){this.initMore();if(!this.lastOverflow){this.container.fireEvent("overflowchange",this.container,true);this.lastOverflow=true}}else{if(this.more){this.clearMenu();this.more.destroy();delete this.more;if(this.lastOverflow){this.container.fireEvent("overflowchange",this.container,false);this.lastOverflow=false}}}}});function changeFlag(){initFlag=false}function splitInTwo(d,c){var b=[];var a=d.indexOf("=");b[0]=d.substring(0,a);b[1]=d.substring(a+1,d.length);return b}function showStateToolTip(a){var d=a.target;if(d==null){d=a.srcElement}var c=d.id;if(c!="noteImg_Auditing"){var b=d.getAttribute("nt");new Ext.ToolTip({target:c,anchor:"right",shadow:"sides",baseCls:"noteToolTipCls",bodyStyle:"font: 11px Tahoma, MS Sans Serif; color:black;border-color:black;",dismissDelay:15000,html:'<div style="background-color:#DDDDDD;"><div  style="background-color:#FFFFFF;padding-top:5px;padding-bottom:5px;padding-left:5px;padding-right:5px;">'+RecordCount+" "+b+"</div></div>"}).show()}}function showTabLabelToolTip(a){var c=a.target;if(c==null){c=a.srcElement}var b=c.id;if(b!="noteImg_Auditing"&&document.getElementById("tabid_"+b)!="undefined"){new Ext.ToolTip({target:b,anchor:"right",bodyStyle:"font: 11px Tahoma, MS Sans Serif; color:black;border-color:black;",dismissDelay:15000,html:RemedyForceHTMLProcessor.getText(document.getElementById("tabid_"+b))}).show()}}function processTabRecCount(d){if(d!=null&&typeof(d)!="undefined"&&d.length>2){d=d.substring(1,d.length-1);var e=d.split(",");for(var a=0;a<e.length;a++){var b=splitInTwo(e[a],"=");b[0]=b[0].replace(" ","");var c=document.getElementById(b[0]);if(c!=null&&typeof(c)!="undefined"){RemedyForceHTMLProcessor.parseHTML(c,b[1]+"")}}}}Ext.onReady(function(){Ext.override(Ext.data.Store,{sortData:function(e,g){g=g||"ASC";var c=this.fields.get(e).sortType;var d=function(h,f){var m=c(h.data[e]),l=c(f.data[e]);if(typeof(m.toLowerCase)=="function"){m=m.toLowerCase();l=l.toLowerCase()}return m>l?1:(m<l?-1:0)};this.data.sort(g,d);if(this.snapshot&&this.snapshot!=this.data){this.snapshot.sort(g,d)}}});Ext.QuickTips.init();if(document.getElementById("urlForStaticResourceId")!=null){document.getElementById("urlForStaticResourceId").value=getSdeStyleResource()}var b={xtype:"grouptabpanel",activeGroup:0,id:"grptabpanel",tabWidth:135,items:getStrGrpTabVal()};detailsPanel=new Ext.Panel({title:dispalyTitle,renderTo:"detailsDiv",id:"south-panel",width:"100%",split:isResizable,layout:"fit",overflow:"auto",autoScroll:false,height:Ext.isIE7?panelHeightIE7:Ext.isIE?panelHeightIE:panelHeight,cls:"detailsSectionCls",collapseMode:"mini",items:[b],tools:[{id:"minimize",handler:function(){window.parent.Ext.getCmp("southPanelSI").collapse()}},{id:"maximize",handler:function(){detailsPanel.tools.maximize.hide();detailsPanel.tools.restore.show();var c=Ext.isIE7?660:Ext.isIE?664:Ext.isSafari?685:670;if(pageName=="BMC_BaseElement__c"){c=Ext.isIE7?595:Ext.isIE?595:Ext.isSafari?608:593}window.parent.Ext.getCmp("southPanelSI").setHeight(c);window.parent.Ext.getCmp("canvasPanelId").doLayout(true,true);detailsPanel.tools.restore.dom.style.display="inline";detailsPanel.tools.maximize.dom.style.display="none"}},{id:"restore",hidden:true,handler:function(){detailsPanel.tools.maximize.show();detailsPanel.tools.restore.hide();var c=Ext.isIE7?670:Ext.isIE?674:Ext.isSafari?695:680;var d=Ext.isIE?182:180;if(pageName=="Change_Request__c"){d=Ext.isIE7?275:Ext.isIE?250:245}else{if(pageName=="Problem__c"){d=Ext.isIE7?230:Ext.isIE?230:240}else{if(pageName=="BMC_BaseElement__c"){c=Ext.isIE7?605:Ext.isIE?605:Ext.isSafari?618:603;d=Ext.isIE7?230:Ext.isIE?230:230}}}window.parent.Ext.getCmp("canvasPanelId").setHeight(c);window.parent.Ext.getCmp("southPanelSI").setHeight(d);window.parent.Ext.getCmp("canvasPanelId").doLayout(true,true);detailsPanel.tools.maximize.dom.style.display="inline";detailsPanel.tools.restore.dom.style.display="none"}}]});applyToolTipOnSIHeaderBtn();if(typeof(window.parent.afterResetSI)=="function"){window.parent.afterResetSI()}if(typeof(window.parent.refreshIncidentTab)=="function"){window.parent.refreshIncidentTab()}if(parentObject!="BMC_BaseElement__c"&&getUrlParameter("wid")!=null&&getUrlParameter("wid")!=""){detailsPanel.tools.maximize.dom.id="MaximizeBtnId";detailsPanel.tools.restore.dom.id="RestoreBtnId";detailsPanel.tools.minimize.dom.id="MinimizeBtnId"}if(pageName=="Base_Location"||pageName=="Model__c"){detailsPanel.removeAll();detailsPanel.doLayout();var a=new DataGrid();detailsPanel.add(a);detailsPanel.doLayout();readOnlyField();if(typeof(Ext.getCmp("prevId"))!="undefined"){Ext.getCmp("prevId").setDisabled(GetBRes(hasPrevious))}if(typeof(Ext.getCmp("nextId"))!="undefined"){Ext.getCmp("nextId").setDisabled(GetBRes(hasNext))}}});function readOnlyField(){if(typeof(parent.isReadOnly)!="undefined"&&parent.isReadOnly!=undefined&&parent.isReadOnly.toUpperCase()=="TRUE"){var b=document.getElementById("BTNtaskCIActions");var a=document.getElementById("taskCIActions");if(b!=undefined){b.style.display="none"}if(a!=undefined){a.style.display="none"}}}function clearCookie(){clearSICookie(window.parent.cookieName);var a=window.parent.Ext.getCmp("southPanelSI");var b=Ext.isIE7?660:Ext.isIE?664:Ext.isSafari?685:670;var c=a.getHeight();if(c>=b){restoreSouthPanelSI()}window.parent.removeSI(window.parent.iFrameSrc)}function restoreSouthPanelSI(){var a=Ext.isIE7?670:Ext.isIE?674:Ext.isSafari?695:680;var b=Ext.isIE?182:180;if(pageName=="Change_Request__c"){b=Ext.isIE7?275:Ext.isIE?250:245}else{if(pageName=="Problem__c"){b=Ext.isIE7?230:Ext.isIE?240:240}}window.parent.Ext.getCmp("canvasPanelId").setHeight(a);window.parent.Ext.getCmp("southPanelSI").setHeight(b);window.parent.Ext.getCmp("canvasPanelId").doLayout(true,true)}function filePopUp(a){if(a!=null&&a!=""){if(a.indexOf("[url]")>0){var b=a.split("[url]")[0];if(b.match("http:")!=null||b.match("https:")!=null){b=b}else{b="http://"+b}window.open(b,"","scrollbars=yes,menubar=no,height=1000,width=1000,resizable=yes,toolbar=no,location=yes,status=no")}else{if(a.substring(0,3)=="069"){window.open("/"+a)}if(a.substring(0,3)=="00P"){window.open("/servlet/servlet.FileDownload?file="+a)}}}else{checkValidity()}}function openURL(a){var b;if(a.match("http:")!=null||a.match("https:")!=null){b=a}else{b="http://"+a}window.open(b,"","scrollbars=yes,menubar=no,height=1000,width=1000,resizable=yes,toolbar=no,location=yes,status=no")}function openFile(e,c,a,f,d,b){if(a.get(type)=="File"){return"<a ondblclick=\"filePopUp('"+a.get(attachId)+"')\">"+e+"</a>"}else{if(a.get(type)=="Url"){return"<a ondblclick=\"openURL('"+a.get(urlName)+"')\">"+e+"</a>"}}}function showNote(e,c,a,f,d,b){e=e.replace(/<br>/gi," ");if(e!="-"&&e!=" "&&e!=null){c.attr='title="'+e+'"'}return e}function shState(e,c,a,f,d,b){return""+e=="true"?"Opened":"Closed"}function addLink(c,h,d,g,f,l){var b=colRenderer(c,h,d,g,f,l);var e="",a="";var m;if(b.indexOf(primaryClientLabel)!=-1){m=b.indexOf(primaryClientLabel);e=b.substr(0,m);a=b.substring(m);b='<a href="#" onclick="showRecord(\''+e+"')\">"+e+"</a> "+a}else{b='<a href="#" onclick="showRecord(\''+c+"')\">"+b+"</a>"}return b}function addInstanceHyperLink(g,e,b,h,f,c){var a=colRenderer(g,e,b,h,f,c);var d=e.value;if(d!=undefined&&d!=null){a='<a href="/apex/CMDBManager?cmdbRecordId='+d+'" target="_blank">'+a+"</a>"}else{a='<a href="#" >'+a+"</a>"}return a}function showRecord(c){var e=grid.getSelectionModel().getSelected();var d=e.get(idFld);var b="";var a="";if(e!=null){if(tabName=="Incidents"||tabName=="Incident"){b="Incident__c";a="Incident"}else{if(tabName=="Tasks"){b="Task__c"}else{if(tabName=="Changes"){b="Change_Request__c"}else{if(tabName=="Problems"){b="Problem__c"}else{if(tabName=="Releases"){b="Release__c"}else{if(tabName=="Service Requests"){b="Incident__c";a="ServiceRequest"}else{if(tabName=="Clients"){a="Clients"}}}}}}}openPopupRecord(d,c,b,null,null,null,a)}}function colRenderer(f,c,a,g,d,b){if(f==null){f=""}if(typeof(cols[d])!="undefined"&&cols[d].toLowerCase()=="state__c"){return shState(f,c,a,g,d,b)}else{f=f.replace(/<br>/gi," ");getCalcFields();var e=arrCols[d].fldName;if(f!="-"&&f!=" "&&f!=null){if(!(isCalc[e]=="true"&&f.indexOf("&lt;img")!=-1)){c.attr='title="'+f+'"'}}if(tabName=="Incidents"||tabName=="Service Requests"||tabName=="Incident"||tabName=="Tasks"||tabName=="Changes"||tabName=="Problems"||tabName=="Releases"){if(isCalc[e]=="true"&&(f.indexOf("&lt;img")!=-1||f.indexOf("&lt;a")!=-1)){f=Ext.util.Format.htmlDecode(f)}else{f=Ext.util.Format.ellipsis(f,60)}}else{f=Ext.util.Format.ellipsis(f,60)}return f}}function columHdrsJS(c){arrCols=[];if(pageName=="Base_Location"){var e=[];e.BMC_BaseElement__c="фBaseElement";e.BMC_BaseRelationship__c="фBaseRelationship";nameFld="Name__cфBaseElement";var d;for(var a in gridCols){colsHdrs[a]=Ext.util.Format.htmlEncode(gridCols[a].header);if(gridCols[a].dataIndex=="Id"){d=a;continue}else{flds[a]=gridCols[a].dataIndex+e[gridCols[a].objectName];gridCols[a].dataIndex=gridCols[a].dataIndex+e[gridCols[a].objectName]}}flds[d]="IdфBaseRelationship";recId=flds[d];for(var a in gridCols){if(gridCols[a].dataIndex=="IdфBaseRelationship"){d=a;continue}if(gridCols[a].dataIndex=="Name__cфBaseElement"){arrCols[a]={header:Ext.util.Format.htmlEncode(gridCols[a].header),width:gridCols[a].width,dataIndex:flds[a],sortable:gridCols[a].sortable,hidden:gridCols[a].hidden,fldName:Ext.util.Format.htmlEncode(gridCols[a].header),renderer:function(h,g,f){return'<a href="/apex/CMDBManager?cmdbRecordId='+f.json.IdфBaseElement+'" target="_blank">'+Ext.util.Format.htmlEncode(h)+"</a>"}}}else{arrCols[a]={header:Ext.util.Format.htmlEncode(gridCols[a].header),width:gridCols[a].width,dataIndex:flds[a],sortable:gridCols[a].sortable,hidden:gridCols[a].hidden,fldName:Ext.util.Format.htmlEncode(gridCols[a].header)}}}arrCols[d]={header:"Id",width:10,id:"IdфBaseRelationship",dataIndex:"IdфBaseRelationship",sortable:false,hideable:false,hidden:true,fldName:"IdфBaseRelationship"}}else{for(i=0;i<colsHdrs.length;i++){flds[i]="fld"+i}recId=flds[0];var b=false;for(j=0;colsHdrs.length>j;j++){if(j==0){arrCols[j]={id:flds[j],header:colsHdrs[j],width:10,dataIndex:flds[j],hideable:false,hidden:true}}else{if(c!="undefined"&&c[j].toLowerCase()=="attachmentid__c"){attachId=flds[j];arrCols[j]={header:colsHdrs[j],width:colwidth[j-1],sortable:b,dataIndex:flds[j],hidden:true}}else{if(c!="undefined"&&c[j].toLowerCase()=="type__c"){type=flds[j];arrCols[j]={header:colsHdrs[j],width:colwidth[j-1],sortable:b,dataIndex:flds[j],hidden:true}}else{if(c!="undefined"&&c[j].toLowerCase()=="filename__c"){urlName=flds[j];arrCols[j]={header:colsHdrs[j],width:colwidth[j-1],sortable:b,dataIndex:flds[j]}}else{if(c!="undefined"&&(c[j].toLowerCase()=="note__c"||c[j].toLowerCase()=="comments")){noteField=flds[j];arrCols[j]={header:colsHdrs[j],width:colwidth[j-1],sortable:b,dataIndex:flds[j],renderer:showNote}}else{if(c!="undefined"&&c[j].toLowerCase()=="type"&&childObjectName=="ProcessInstance"){instanceTypeIndex=flds[j]}else{if(c!="undefined"&&childObjectName=="CustomAttachment__c"){arrCols[j]={header:colsHdrs[j],width:colwidth[j-1],sortable:b,dataIndex:flds[j]}}else{if(c!="undefined"&&(c[j].toLowerCase()=="name"||c[j].toLowerCase()=="name__c")&&pageName=="Model__c"){arrCols[j]={header:colsHdrs[j],width:colwidth[j-1],sortable:b,dataIndex:flds[j],renderer:addInstanceHyperLink}}else{if(c!="undefined"&&c[j].toLowerCase()=="name"){arrCols[j]={header:colsHdrs[j],width:colwidth[j-1],sortable:b,dataIndex:flds[j],renderer:addLink,fldName:c[j]}}else{arrCols[j]={header:colsHdrs[j],width:colwidth[j-1],sortable:b,dataIndex:flds[j],renderer:colRenderer,fldName:c[j]}}}}}}}}}}if(c!="undefined"&&c[j].toLowerCase()=="name"){nameFld=flds[j]}}}}DataGrid=function(){var c;if(pageName=="Base_Location"){c=new Ext.data.JsonStore({fields:flds,data:locationSuppInfoData})}else{c=new Ext.data.ArrayStore({fields:flds,data:resultSet})}grid=new Ext.grid.GridPanel({border:false,tbar:getStrItem(),id:"HistoryTab",store:c,columns:arrCols,stripeRows:true,enableHdMenu:false,sortInfo:{field:sortColumn,direction:sortDirection},cls:"detailSectionGridCls",listeners:{rowclick:function(h,m,l){if(h.getSelectionModel().getSelected()!=null){selectedId=h.getSelectionModel().getSelected().get(recId);NameVal=h.getSelectionModel().getSelected().get(nameFld)}else{selectedId=""}for(var g=0;g<idArray.length;g++){if(typeof(Ext.getCmp(idArray[g]))!="undefined"){Ext.getCmp(idArray[g]).setDisabled(false)}}if(closeCheck==null||closeCheck==""||closeCheck=="null"){for(var g=0;g<unlinkIdArray.length;g++){if(typeof(Ext.getCmp(unlinkIdArray[g]))!="undefined"){Ext.getCmp(unlinkIdArray[g]).setDisabled(false)}}}if(multiSelectOption){objList=h.getSelectionModel().getSelections();idList="";var f=true;var g=0;while(f){if(objList[g]!=null){idList=idList+objList[g].get(flds[0])+","}g++;if(g>objList.length){f=false}}}},headerclick:function(h,l,m){if(pageName!="Base_Location"){var g=true;var f=getunsortableCols();for(j=0;f.length>j;j++){if(cols[l]==f[j]){g=false;break}}if(g){if(sortColumnName==cols[l]+""){if(sortDirection=="ASC"){sortDirection="DESC"}else{sortDirection="ASC"}}else{sortDirection="ASC"}sortColumnName=cols[l]+"";sortColumnIndex=l;handleColumnClick(sortColumnName,sortDirection,childObject)}}},rowdblclick:function(h,n,l){extRecord=h.getSelectionModel().getSelected();var m=extRecord.get(recId);if(childObjectName=="KM_KnowledgeArticle__c"&&m!=null&&m!=""){window.open("/apex/KM_ArticleView?id="+m+"&standardLayout=false&calledFromForm=true&enableSelfClosing=true&fromSS3=true&fromSupportInfo=true","","location=1,status=1,scrollbars=1,resizable=1,width=670,height=650,top=100, left=300");return}if(childObjectName=="ProcessInstance"){var g=h.getSelectionModel().getSelected().get(instanceTypeIndex);if(g.toLowerCase()=="processinstanceworkitem"){param="true"}else{param="false"}}if(childObjectName!="Attachment"&&editLink!="dummy"){if(pageName!="Base_Location"&&pageName!="Model__c"){beforeEdit(editLink,m)}}if(childObjectName=="CustomAttachment__c"){var f=h.getSelectionModel().getSelected().get("fld4");if((f=="File")||(f==labelFile)){filePopUp(h.getSelectionModel().getSelected().get("fld3"))}else{if(f=="Url"){openURL(h.getSelectionModel().getSelected().get("fld2"))}}}},afterrender:function(){this.setHeight(this.ownerCt.getInnerHeight());this.setWidth("100%");if(pageName=="Base_Location"){autoFitLastColumn(grid,"HistoryTab")}},render:function(){this.ownerCt.addListener("resize",function(){Ext.each(this.items.items,function(e){e.fireEvent("afterrender")})})}},autoScroll:pageName=="Base_Location"?true:false,autoFitColumns:pageName=="Base_Location"?false:true,viewConfig:{forceFit:pageName=="Base_Location"?false:true,scrollOffset:0},selModel:new Ext.grid.RowSelectionModel({singleSelect:!multiSelectOption})});var b=b;if(grid!=null&&sortColumnIndex!=null&&sortDirection!=null){var a=colsHdrs[sortColumnIndex];if(sortDirection=="ASC"){imgPath=imgPathAsc}else{if(sortDirection=="DESC"){imgPath=imgPathDsc}}a+='<img style="width:13px;height:13px" src="'+imgPath+'"/>';grid.getColumnModel().setColumnHeader(sortColumnIndex,a)}var d=new Ext.Panel({layout:"fit",id:"gridPanelId",height:Ext.getCmp("south-panel").getHeight()-53,width:(typeof(Ext.getCmp("grptabpanel"))!="undefined"&&Ext.getCmp("grptabpanel")!=null)?Ext.getCmp("grptabpanel").getWidth()-156:Ext.getCmp("south-panel").getWidth()-156,border:true,cls:"gridPanelCls"});d.add(grid);return d};TabAuditDetails=function(){var a=new Ext.Panel({contentEl:"my-tabs",layout:"fit",id:"AuditDetailsTab",height:125,cls:"TabAuditDetailsCls",viewConfig:{forceFit:true}});return a};TabDisplayToProfile=function(){var a=new Ext.Panel({contentEl:"itemSelector",layout:"fit",id:"DisplayToProfileTab",viewConfig:{forceFit:true}});return a};function tabElementJS(){if(typeof(elem)!="undefined"){if(childObjectName==parentObject&&tabName=="Auditing"){var f=Ext.getCmp("AuditDetailsTab");var a=Ext.getCmp("DisplayToProfileTab");var d=Ext.getCmp("HistoryTab");if(f==null||typeof(f)=="undefined"){var c=new TabAuditDetails();elem.remove(d);elem.add(c)}else{if(f!=null){f.show()}if(a!=null){a.hide()}if(d!=null){elem.remove(d)}}}else{if(childObjectName==parentObject&&tabName=="DisplayTo"){var f=Ext.getCmp("AuditDetailsTab");var a=Ext.getCmp("DisplayToProfileTab");var d=Ext.getCmp("HistoryTab");if(a==null||typeof(a)=="undefined"){var e=new TabDisplayToProfile();elem.remove(d);elem.add(e);refreshProfile()}else{if(f!=null){f.hide()}if(a!=null){a.show()}if(d!=null){elem.remove(d)}}}else{flag=false;elem.removeAll();elem.getEl().child(".x-panel-body").update("");elem.doLayout();var b=new DataGrid();elem.add(b)}}elem.doLayout()}}function AlterCIExpBtnStatusJS(a){if(pageName=="Task__c"){if(typeof(this.parent.ChangeBtnStatus)!="undefined"){this.parent.ChangeBtnStatus(a)}}else{if(pageName=="Change_Request__c"){if(typeof(this.parent.ChangeBtnStatus)!="undefined"){this.parent.ChangeBtnStatus(a)}}else{if(pageName=="Problem__c"){if(typeof(this.parent.ChangeBtnStatus)!="undefined"){this.parent.ChangeBtnStatus(a)}}else{if(pageName=="Incident__c"){if(typeof(this.parent.ChangeCIExpBtnStatus)!="undefined"){this.parent.ChangeCIExpBtnStatus(a)}}}}}}function showMessage(a){Ext.MessageBox.show({msg:a,width:200,height:"auto",buttons:Ext.MessageBox.OK})}function showLinkError(){if(err!=null&&err!="null"&&err!=""){showMessage(err)}else{tabReload(childObject)}}function onPopupComplete(a){cObjectName=childObjectName;checkAutoModify(a,getTabId(),childObject)}function afterModifyCheckFunction(){isModifiable=getIsMidifiable();var e=getHistoryPageName();var c=getHistoryId();var d=getHistoryActionId();if(isModifiable&&(err==null||err=="")){if(e=="incidentHistoryPage"){window.parent.openPopupWithTitle(e+"?isLookup=true&Id="+c+"&historyActionId="+d+"&incidentId="+parentPageId,reloadData,"",Ext.isIE7?432:Ext.isIE8?420:418,670);isModifiable=false}else{if(e=="taskHistoryPage"){var a=Ext.isIE7?438:Ext.isIE8?428:426;window.parent.openPopupWithTitle(e+"?isLookup=true&Id="+c,reloadData,"",a,670);isModifiable=false}else{if(e=="ObjectHistoryPage"&&cObjectName=="Change_History__c"){var b=Ext.isIE7?415:Ext.isIE8?397:395;window.parent.openPopupWithTitle(e+"?isLookup=true&Id="+c+"&formname=Change_Request__c",reloadData,"",b,670);isModifiable=false}else{if(e=="ObjectHistoryPage"&&cObjectName=="Problem_History__c"){var b=Ext.isIE7?415:Ext.isIE8?397:395;window.parent.openPopupWithTitle(e+"?isLookup=true&Id="+c+"&formname=Problem__c",reloadData,"",b,670);isModifiable=false}else{if(e=="ObjectHistoryPage"&&cObjectName=="BMC_BaseElement_History__c"){var b=Ext.isIE7?395:Ext.isIE8?377:375;window.parent.openPopupWithTitle(e+"?isLookup=true&Id="+c+"&formname=BMC_BaseElement__c",reloadData,"",b,670);isModifiable=false}else{if(e=="ObjectHistoryPage"&&cObjectName=="SLA_History__c"){var b=Ext.isIE7?398:Ext.isIE8?380:378;window.parent.openPopupWithTitle(e+"?isLookup=true&Id="+c+"&formname=ServiceLevelAgreement__c",reloadData,"",b,670);isModifiable=false}else{window.parent.openPopupWithTitle(e+"?isLookup=true&Id="+c,reloadData,"",Ext.isIE7?416:Ext.isIE8?408:408,670);isModifiable=false}}}}}}}}function refreshDocs(){tabReload(childObject);if(pageName=="Account"){setNumberOfUsers()}}function setId(a,b){document.getElementById(cmpStr_id).value=a;if(b!=null&&typeof b!="undefined"&&b==true){tabReloadOnStart(childObject)}else{tabReload(childObject)}}function reloadData(a){tabReload(childObject)}function openCommonPopup(b,a){openPopup(b,a,400,730)}function openPopupForTemplate(b,a,c){window.parent.openPopupWithTitle(b,a,c,500,660)}function openNewTabItems(c,f){var h;var g;if(childObjectName.toLowerCase()=="broadcasts__c"){h=broadcastLabelPlural;g=broadcastLabel}else{if(childObjectName.toLowerCase()=="servicelevelagreement__c"){h=slaLabelPlural;g=slaLabel}else{if(childObjectName.toLowerCase()=="category__c"){h=categoryLabelPlural;g=categoryLabel}else{if(childObjectName.toLowerCase()=="user"){h=clientCustLabelPlural;g=clientCustLabel}else{if(childObjectName.toLowerCase()=="account"){h=accountLabelPlural;g=accountLabel}else{if(childObjectName.toLowerCase()=="standarddescription__c"){h=standardDescriptionLabel;g=standardDescriptionLabel}else{if(childObjectName.toLowerCase()=="action__c"){h=actionLabelPlural;g=actionLabel}else{if(childObjectName.toLowerCase()=="change_request__c"){h=changeRequestLabelPlural;g=changeRequestLabel}else{if(childObjectName.toLowerCase()=="change_assessment__c"){h=changeAssessmentLabelPlural;g=changeAssessmentLabel}else{if(childObjectName.toLowerCase()=="incident__c"){h=incidentLabelPlural;g=incidentLabel}else{if(childObjectName.toLowerCase()=="task__c"){h=taskLabelPlural;g=taskLabel}else{h=childObjectName.split("__c")[0]+"s";g=childObjectName.split("__c")[0]+"s"}}}}}}}}}}}c=encodeURI(c);if(childObjectName.toLowerCase()=="servicelevelagreement__c"){if(getUrlParameter("wid")==null||getUrlParameter("wid")==""){var d="Configuration Items";var e=c.substring(0,c.indexOf("%253F",0));var b=c.substring(c.indexOf("BaseElementid",0)+18,c.indexOf("%2526",c.indexOf("BaseElementid",0)));var a=(typeof(namespacePrefix)!="undefined")?namespacePrefix:"";if(typeof StdWorkspacesPage!="undefined"){if(isLightningExperience){c="/one/one.app#/alohaRedirect"+StdWorkspacesPage+"&moduleName="+d+"&BMC_BaseElementid="+b+"&node="+e+"&fromstdCI=true"}else{c=StdWorkspacesPage+"&moduleName="+d+"&BMC_BaseElementid="+b+"&node="+e+"&fromstdCI=true"}window.open(c)}}else{window.parent.parent.parent.parent.addNewTab(f,h,"NavigatorPage?title="+g+"&target="+c)}}else{window.parent.parent.parent.addNewTab(f,h,"NavigatorPage?title="+g+"&target="+c)}}function openEditTabItems(a,f){var e;var g;if(childObjectName.toLowerCase()=="broadcasts__c"){e=broadcastLabelPlural;g=broadcastLabel}else{if(childObjectName.toLowerCase()=="servicelevelagreement__c"){e=slaLabelPlural;g=slaLabel}else{if(childObjectName.toLowerCase()=="category__c"){e=categoryLabelPlural;g=categoryLabel}else{if(childObjectName.toLowerCase()=="user"){e=clientCustLabelPlural;g=clientCustLabel}else{if(childObjectName.toLowerCase()=="account"){e=accountLabelPlural;g=accountLabel}else{if(childObjectName.toLowerCase()=="standarddescription__c"){e=standardDescriptionLabel;g=standardDescriptionLabel}else{if(childObjectName.toLowerCase()=="action__c"){e=actionLabelPlural;g=actionLabel}else{if(childObjectName.toLowerCase()=="processinstance"){if(parentObject=="Change_Request__c"){NameVal=getCRName()}if(parentObject=="Incident__c"){NameVal=getIncidentName()}e=approvalLabel;g=approvalLabel}else{if(childObjectName.toLowerCase()=="change_request__c"){e=changeRequestLabelPlural;g=changeRequestLabel}else{if(childObjectName.toLowerCase()=="change_assessment__c"){e=changeAssessmentLabelPlural;g=changeAssessmentLabel}else{if(childObjectName.toLowerCase()=="incident__c"){e=incidentLabelPlural;g=incidentLabel}else{if(childObjectName.toLowerCase()=="task__c"){e=taskLabelPlural;g=taskLabel}else{if(childObjectName.toLowerCase()=="problem__c"){e=problemLabelPlural;g=problemLabel}else{e=childObjectName.split("__c")[0]+"s";g=childObjectName.split("__c")[0]}}}}}}}}}}}}}a=encodeURI(a);if(f.toLowerCase()=="incidentpage"||f.toLowerCase()=="taskpage"){window.parent.parent.parent.addNewTab(f,e,"NavigatorPage?title=%23"+NameVal+"&tabTitle=%23"+NameVal+"&target="+a)}else{var h=f.toLowerCase();if(parentObject=="BMC_BaseElement__c"&&(h=="slapage"||h=="clientpage")){var d;if(isLightningExperience&&h=="slapage"){d=window.parent.parent.location}else{d=window.parent.parent.parent.parent.location}if((d!=null&&d.toString().toLowerCase().indexOf("sdehome")==-1)||parentWid==null||parentWid==""){var c=a.substring(0,a.indexOf("%253F",0));var l=a.substring(a.indexOf("id",0)+7,a.indexOf("%2526",a.indexOf("id",0)));if(typeof StdWorkspacesPage!="undefined"){if(isLightningExperience&&h=="slapage"){var b=(typeof(namespacePrefix)!="undefined")?namespacePrefix:"";a="/one/one.app#/alohaRedirect"+StdWorkspacesPage+"&id="+l+"&node="+c+"&fromstdCI=true"}else{a=StdWorkspacesPage+"&id="+l+"&node="+c+"&fromstdCI=true"}window.open(a)}}else{window.parent.parent.parent.parent.addNewTab(f,e,"NavigatorPage?title="+g+"&tabTitle="+NameVal+"&target="+a)}}else{window.parent.parent.parent.addNewTab(f,e,"NavigatorPage?title="+g+"&tabTitle="+NameVal+"&target="+a)}}}function refreshParentList(){if(window.parent.parent.refreshList!=null){window.parent.parent.refreshList()}}var moduleName;function getModuleNameJS(){if(typeof(window.parent.parent.getModuleName)=="function"){moduleName=window.parent.parent.getModuleName();moduleName=encodeURI(moduleName);var a=moduleName.split("%C2%AC");moduleName=a[0];moduleName=decodeURI(moduleName)}}function addJS(a,d){if(typeof(window.parent.parent.getModuleName)=="function"){moduleName=window.parent.parent.getModuleName();moduleName=encodeURI(moduleName);var c=moduleName.split("%C2%AC");moduleName=c[0];moduleName=decodeURI(moduleName)}var e;var b="";if(a=="DocumentationPage"){if(document.all){window.parent.openPopupWithTitle(a+"?parentId="+parentPageId+"&isLookup=true&objectType="+parentObject,"",lableAddDocumentation,163,450)}else{window.parent.openPopupWithTitle(a+"?parentId="+parentPageId+"&isLookup=true&objectType="+parentObject,"",lableAddDocumentation,160,441)}}else{if(a.match("popupId")!=null){if(a.match("popupId=Action")){if(d.match("Incident__c")){window.parent.openPopupWithTitle(a+"&isLookup=true&filterClause="+escape("appliesToIncident__c=true and system__c=false"),onPopupComplete,b,407,575)}else{if(d.match("Broadcasts__c")){window.parent.openPopupWithTitle(a+"&isLookup=true&filterClause="+escape("appliesToBroadcasts__c=true and system__c=false"),onPopupComplete,b,407,575)}else{if(d.match("Task__c")){window.parent.openPopupWithTitle(a+"&isLookup=true&filterClause="+escape("appliesToTask__c=true and system__c=false"),onPopupComplete,b,407,575)}else{if(d.match("Problem__c")){window.parent.openPopupWithTitle(a+"&isLookup=true&filterClause="+escape("appliesToProblem__c=true and system__c=false"),onPopupComplete,b,407,575)}else{if(d.match("Change_Request__c")){window.parent.openPopupWithTitle(a+"&isLookup=true&filterClause="+escape("appliesToChange__c=true and system__c=false"),onPopupComplete,b,407,575)}else{if(d.match("BMC_BaseElement__c")){window.parent.openPopupWithTitle(a+"&isLookup=true&filterClause="+escape("appliesToConfigurationItems__c=true and system__c=false"),onPopupComplete,b,387,650)}else{if(d.match("ServiceLevelAgreement__c")){window.parent.openPopupWithTitle(a+"&isLookup=true&filterClause="+escape("appliesToSLA__c=true and system__c=false"),onPopupComplete,b,387,575)}else{window.parent.openPopupWithTitle(a+"&isLookup=true&filterClause="+escape("system__c=false"),onPopupComplete,b,407,575)}}}}}}}}else{openNewTabItems(a+"?"+e+"="+parentPageId,a)}}else{e=parentObject.split("__c")[0]+"id";if(e=="IncidentTemplate__Cid"){openNewTabTemplate(a+"?isLookup=true&"+e+"="+parentPageId,reloadData,labelLinkedTemp)}else{if(a=="StandardResolutionPage"){window.parent.openPopupWithTitle(a+"?isLookup=true?&"+e+"="+parentPageId,"",b,223,600)}else{if(a=="taskPage"||a=="SLAPage"||a=="IncidentPage"||a=="categoryPage"||a=="StandardDescriptionPage"||a=="ClientPage"||a=="OrganizationPage"||a=="categorypage"||a=="ChangeRequestPage"){openNewTabItems(a+escape("?"+e+"="+parentPageId+"&parentWid="+parentWid+"&moduleName="+moduleName+"&isInactive=true"),a)}else{openNewTabItems(a+escape("?"+e+"="+parentPageId+"&parentWid="+parentWid+"&moduleName="+moduleName),a)}}}}}}function linkTemplateComplete(a){linkTemplateToParent(a,parentPageId)}function unLinkTemplateComplete(a){unLinkTemplateFromParent(a,parentPageId)}function linkKnowledgeArticletoCI(){openPopupForTemplate("SearchPage?popupId=KM_KnowledgeArticle__c&isLookup=true&filterObjectId="+parentPageId+"&parentName=BMC_BaseElement__c",linkCIComplete,"")}function linkCI(){if(pageName=="Change_Request__c"){openPopupForTemplate("SearchPage?popupId=BMC_BaseElement&isLookup=true&filterObjectId="+parentPageId+"&parentName=Change_Request__c",linkCIComplete,"")}else{if(pageName=="Problem__c"){openPopupForTemplate("SearchPage?popupId=BMC_BaseElement&isLookup=true&filterObjectId="+parentPageId+"&parentName=Problem__c",linkCIComplete,"")}else{if(pageName=="Incident__c"){var d=window.parent.getUserID();var a=window.parent.getIncidentID();var b=window.parent.getCIelemID();var c=window.parent.getServiceElemID();openPopupForTemplate("SearchPage?popupId=BMC_BaseElement&isLookup=true&filterObjectId="+d+"&parentName=Incident__c&isRadioChecked=false&accountId="+window.parent.getAccountID()+"&incCiId="+b+"&incServiceId="+c+"&selectedCIFilter="+window.parent.LinkedToClient+"&incidentId="+a,linkCIComplete,"")}else{openPopupForTemplate("SearchPage?popupId=BMC_BaseElement&isLookup=true&filterObjectId="+parentPageId,linkCIComplete,"")}}}}function linkService(){if(pageName=="Change_Request__c"){openPopupForTemplate("SearchPage?popupId=BMC_BusinessService&isLookup=true&filterObjectId="+parentPageId+"&parentName=Change_Request__c",linkCIComplete,"")}else{if(pageName=="Problem__c"){openPopupForTemplate("SearchPage?popupId=BMC_BusinessService&isLookup=true&filterObjectId="+parentPageId+"&parentName=Problem__c",linkCIComplete,"")}else{openPopupForTemplate("SearchPage?popupId=BMC_BusinessService&isLookup=true&filterObjectId="+parentPageId,linkCIComplete,"")}}}function linkCIComplete(b){var a="";if(pageName=="Task__c"){a=window.parent.AssignNewTaskId();linkCITask(b,a)}else{if(pageName=="Change_Request__c"){linkCIChange(b)}else{if(pageName=="Problem__c"){linkCIProblem(b)}else{if(pageName=="Incident__c"){linkCIIncident(b)}else{if(pageName=="BMC_BaseElement__c"){linkKAToCI(b)}}}}}}function unLinkTemplate(){if(idList!=null&&idList!=""){unLinkTemplateFromParent(idList,parentPageId);idList=""}else{Ext.MessageBox.show({title:" ",msg:"Please select a record",width:"auto",buttons:Ext.MessageBox.OK})}}function composeMailOnComplete(){getIncidentHistoryRenderer()}function beforeEdit(d,a){isHistoryEMailRecord=false;var f="";var c="";var h="";var g="";if(d=="IncidentHistoryPage"){f=incidentHistoryRecords.split(",");c=parent.incidentId;h=composeEmailPageHeaderLabel;g=parent.incidentName}else{if(d.toLowerCase()=="objecthistorypage"&&childObjectName!=null&&childObjectName!=""&&childObjectName.toLowerCase()=="change_history__c"){f=changeHistoryRecords.split(",");c=parent.changeRequestId;h=composeEmailChangePageHeaderLabel;g=parent.changeRequestName}else{if(d.toLowerCase()=="objecthistorypage"&&childObjectName!=null&&childObjectName!=""&&childObjectName.toLowerCase()=="problem_history__c"){f=problemHistoryRecords.split(",");c=parent.problemId;h=composeEmailProblemPageHeaderLabel;g=parent.getProblemName()}else{if(d.toLowerCase()=="taskhistorypage"&&childObjectName!=null&&childObjectName!=""&&childObjectName.toLowerCase()=="taskhistory__c"){f=taskHistoryRecords.split(",");c=parent.taskId;h=composeEmailTaskPageHeaderLabel;g=parent.taskName}}}}if(f.indexOf(a)!=-1){isHistoryEMailRecord=true}if(isHistoryEMailRecord){parent.openPopupWithTitle("ComposeEmailPage?recordId="+c+"&HistoryId="+a+"&isNew=false&objectName="+parentObject,composeMailOnComplete,h+g,getEmailWinHt(),getEmailWinWidth(),false)}else{var e=new Array(resultSet.length);for(var b=0;b<resultSet.length;b++){e[b]=grid.store.getAt(b).get(recId)}if(childObjectName!=null&&childObjectName!=""){if(childObjectName=="Task__c"||childObjectName=="Incident__c"||childObjectName=="Problem__c"||childObjectName=="Change_Request__c"){fetchData(childObjectName,a)}else{edit(d,a)}}}}function edit(a,e){var b="";if(a!="null"&&a!=""){if(isaccess){if(e!=null&&e!=""){var d;d=parentObject.split("__c")[0]+"id";if(d=="IncidentTemplate__Cid"){openNewTabTemplate(a+"?id="+e+"&isLookup=true&"+d+"="+parentPageId+"&module="+moduleName,reloadData,labelEditTemp)}else{if(a.match("History")!=null){if(a=="IncidentHistoryPage"){window.parent.openPopupWithTitle(a+"?id="+e+"&isLookup=true","",b,Ext.isIE7?432:Ext.isIE8?420:418,670)}else{if(a=="taskHistoryPage"){var c=Ext.isIE7?438:Ext.isIE8?428:426;window.parent.openPopupWithTitle(a+"?id="+e+"&isLookup=true","",b,c,670)}else{if(a=="ObjectHistoryPage"&&parentObject=="Change_Request__c"){var c=Ext.isIE7?415:Ext.isIE8?397:395;window.parent.openPopupWithTitle("ObjectHistoryPage?id="+e+"&formname=Change_Request__c&isLookup=true","",b,c,670)}else{if(a=="ObjectHistoryPage"&&parentObject=="Problem__c"){var c=Ext.isIE7?415:Ext.isIE8?397:395;window.parent.openPopupWithTitle("ObjectHistoryPage?id="+e+"&formname=Problem__c&isLookup=true","",b,c,670)}else{if(a=="ObjectHistoryPage"&&parentObject=="BMC_BaseElement__c"){var c=Ext.isIE7?395:Ext.isIE8?377:375;window.parent.openPopupWithTitle("ObjectHistoryPage?id="+e+"&formname=BMC_BaseElement__c&isLookup=true","",b,c,670)}else{if(a=="ObjectHistoryPage"&&parentObject=="ServiceLevelAgreement__c"){var c=Ext.isIE7?398:Ext.isIE8?380:378;window.parent.openPopupWithTitle("ObjectHistoryPage?id="+e+"&formname=ServiceLevelAgreement__c&isLookup=true","",b,c,670)}else{window.parent.openPopupWithTitle(a+"?id="+e+"&isLookup=true","",b,Ext.isIE7?416:Ext.isIE8?408:408,670)}}}}}}}else{if(a=="StandardResolutionPage"){window.parent.openPopupWithTitle(a+"?id="+e+"&isLookup=true","",b,201,550)}else{if(a=="Changeapproval"){if(parentObject=="Change_Request__c"){openEditTabItems(a+escape("?CAid="+e+"&id="+e+"&CAFlag="+param+"&ChangeId="+parentPageId+"&parentWid="+parentWid+"&moduleName="+moduleName+"&isDirect=true"),a)}if(parentObject=="Incident__c"){openEditTabItems(a+escape("?CAid="+e+"&id="+e+"&CAFlag="+param+"&IncidentId="+parentPageId+"&parentWid="+parentWid+"&moduleName="+moduleName+"&isDirect=true"),a)}}else{openEditTabItems(a+escape("?id="+e+"&parentWid="+parentWid+"&moduleName="+moduleName+"&isDirect=true&columnField="+sortColumnName+"&direction="+sortDirection),a)}}}}}else{checkValidity()}}else{msgBox=Ext.MessageBox.show({title:" ",msg:RecPermission,width:"auto",buttons:Ext.MessageBox.OK})}}}function onCompleteLinkToIncident(a){linkToInc(a)}function onCompleteLinkToChange(a){linkIncidentToChange(a)}function onCompleteLinkToProblem(a){linkIncidentToProblem(a)}function onCompleteLinkPChange(a){linkProblemToChange(a)}function onCompleteLinkCRToProblem(a){linkChangeToProblem(a)}function onCompleteLinkStaffToCategory(a){linkStaffToCategory(a)}function onCompleteLinkIncToCI(a){linkIncidentToCI(a)}function onCompletelinkCRtoCI(a){linkCRtoCIJS(a)}function onCompleteLinkPrbToCI(a){linkPrbtoCI(a)}function onCompleteLinkAccToCI(a){linkAcctoCI(a)}function onCompletelinkReleasetoCI(a){linkReleaseToCIJS(a)}function onCompletelinkTasktoCI(a){linkTaskToCIJS(a)}function linkToIncident(){window.parent.openPopupWithTitle("searchPage?popupid=Incident&isLookup=true&filterClause="+escape("FKBroadcast__c=''"),onCompleteLinkToIncident,"",407,613)}function linkIncidentChange(){window.parent.openPopupWithTitle("searchPage?popupid=Incident&isLookup=true&filterObjectId="+parentPageId+"&parentName=Change_Request__c",onCompleteLinkToChange,"",407,613)}function linkIncidentProblem(){window.parent.openPopupWithTitle("searchPage?popupid=Incident&isLookup=true&filterObjectId="+parentPageId+"&parentName=Problem__c",onCompleteLinkToProblem,"",407,613)}function linkProblemChange(){window.parent.openPopupWithTitle("searchPage?popupid=Problem&isLookup=true&filterObjectId="+parentPageId+"&parentName=Change_Request__c",onCompleteLinkPChange,"",407,575)}function linkChangeProblem(){window.parent.openPopupWithTitle("searchPage?popupid=Change&isLookup=true&filterObjectId="+parentPageId+"&parentName=Problem__c",onCompleteLinkCRToProblem,"",407,575)}function assignSupportStaff(){var a=window.location+"";a=a.substring(a.indexOf("/apex/")+6,a.indexOf("?"));window.parent.openPopupWithTitle("searchPage?popupid=Client&isLookup=true&filterObjectId="+parentPageId+"&parentpage="+a+"&filterClause="+escape("IsStaffUser__c=true"),onCompleteLinkStaffToCategory,"",407,575)}function unLinkToCategory(a){if(a!=null&&a!=""){unLinkStaffCategory(a);selectedId=null}else{checkValidity()}}function linkIncidentToCIJS(a){if(a=="true"){window.parent.openPopupWithTitle("searchPage?popupid=Incident&isLookup=true&incType=Incident&filterObjectId="+parentPageId+"&parentName=BMC_BaseElement__c",onCompleteLinkIncToCI,"",407,613)}else{window.parent.openPopupWithTitle("searchPage?popupid=Incident&isLookup=true&filterObjectId="+parentPageId+"&parentName=BMC_BaseElement__c",onCompleteLinkIncToCI,"",407,613)}}function linkSRToCIJS(){window.parent.openPopupWithTitle("searchPage?popupid=Incident&isLookup=true&incType=ServiceRequest&filterObjectId="+parentPageId+"&parentName=BMC_BaseElement__c",onCompleteLinkIncToCI,"",407,613)}function LinkClientHandlerJS(){window.parent.openPopupWithTitle("searchPage?popupid=Client&isLookup=true&filterObjectId="+parentPageId+"&parentName=BMC_BaseElement__c",onCompleteLinkClientToCI,"",407,613)}function onCompleteLinkClientToCI(a){linkClientToCI(a)}function confirmation(a){if(a!=null&&a!=""){Ext.MessageBox.confirm(labelDelete,labelDelConfirm,function(b){if(b==="yes"){deleteThisFile(a)}})}else{checkValidity()}}function checkValidity(){msgBox=Ext.MessageBox.show({title:" ",msg:"select a record",width:"auto",buttons:Ext.MessageBox.OK})}function openProfilePopup(){openPopup("ProfileSelector?id="+parentPageId,null,325,700)}function showErrorMsg(a){if(a!=null&&a!="undefined"){err=a}if(err!=null&&err!=""){Ext.MessageBox.alert(" ",err)}}function handleNextPrevJS(b,a,d){for(var c=0;c<idArray.length;c++){if(typeof(Ext.getCmp(idArray[c]))!="undefined"){Ext.getCmp(idArray[c]).setDisabled(true)}}for(var c=0;c<unlinkIdArray.length;c++){if(typeof(Ext.getCmp(unlinkIdArray[c]))!="undefined"){Ext.getCmp(unlinkIdArray[c]).setDisabled(true)}}if(typeof(Ext.getCmp("prevId"))!="undefined"){Ext.getCmp("prevId").setDisabled(GetBRes(b))}if(typeof(Ext.getCmp("nextId"))!="undefined"){Ext.getCmp("nextId").setDisabled(GetBRes(a))}isModifiable=getIsMidifiable();historyId=getHistoryId();historyPageName=getHistoryPageName();historyActionId=getHistoryActionId();if(d!=null&&d!=""&&d!="null"){for(var c=0;c<idArray.length;c++){if(typeof(Ext.getCmp(idArray[c]))!="undefined"){Ext.getCmp(idArray[c]).setDisabled(true)}}for(var c=0;c<closeIdArray.length;c++){if(typeof(Ext.getCmp(closeIdArray[c]))!="undefined"){Ext.getCmp(closeIdArray[c]).setDisabled(true)}}for(var c=0;c<unlinkIdArray.length;c++){if(typeof(Ext.getCmp(unlinkIdArray[c]))!="undefined"){Ext.getCmp(unlinkIdArray[c]).setDisabled(true)}}}if(!disableAdd){if(typeof(Ext.getCmp("addAssessmentToCR"))!="undefined"){Ext.getCmp("addAssessmentToCR").setDisabled(true)}if(typeof(Ext.getCmp("addCRToProblem"))!="undefined"){Ext.getCmp("addCRToProblem").setDisabled(true)}if(typeof(Ext.getCmp("editCRToProblem"))!="undefined"){Ext.getCmp("editCRToProblem").setDisabled(true)}if(typeof(Ext.getCmp("addCRToIncidnet"))!="undefined"){Ext.getCmp("addCRToIncidnet").setDisabled(true)}if(typeof(Ext.getCmp("addSLA"))!="undefined"){Ext.getCmp("addSLA").setDisabled(true)}}}function setChildTemplateOrderJS(a){window.parent.openHierarchyPopupWithTitle("ChildTemplateHierarchy?parentTemplateId="+parentPageId,reloadData,a,230,320)}function linkTemplateJS(a){openPopupForTemplate("SearchPage?popupId=Template&isLookup=true&filterObjectId="+parentPageId+"&filterClause="+escape("templateFor__c='Task'"),linkTemplateComplete,a)}function linkCRtoIncident(){window.parent.openPopupWithTitle("searchPage?popupid=Change&isLookup=true&filterObjectId="+parentPageId+"&parentName=Incident__c",LinkCRToIncident,"",407,575)}function linkCRtoCI(){window.parent.openPopupWithTitle("searchPage?popupid=Change&isLookup=true&filterObjectId="+parentPageId+"&parentName=BMC_BASEELEMENT__c",onCompletelinkCRtoCI,"",407,575)}function LinkProblemToCIJS(){window.parent.openPopupWithTitle("searchPage?popupid=Problem&isLookup=true&filterObjectId="+parentPageId+"&parentName=BMC_BASEELEMENT__c",onCompleteLinkPrbToCI,"",407,575)}function LinkAccountToCIJS(){window.parent.openPopupWithTitle("searchPage?popupid=Account&isLookup=true&filterObjectId="+parentPageId+"&parentName=BMC_BASEELEMENT__c",onCompleteLinkAccToCI,"",407,575)}function LinkReleaseToCI(){window.parent.openPopupWithTitle("searchPage?popupid=Release&isLookup=true&filterObjectId="+parentPageId+"&parentName=BMC_BASEELEMENT__c",onCompletelinkReleasetoCI,"",407,575)}function LinkTaskToCIJS(){window.parent.openPopupWithTitle("searchPage?popupid=Task&isLookup=true&filterObjectId="+parentPageId+"&parentName=BMC_BASEELEMENT__c",onCompletelinkTasktoCI,"",407,575)}function showWaitMask(){waitMask=new Ext.LoadMask(Ext.getBody(),{msg:PleaseWaitMask});if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.show()}}function hideWaitMask(){if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.hide()}}function locationlinkPage(){openPopupForTemplate("SearchAndLink?isLookUp=fklocation__c&parentName=AdminLocation&childName=BMC_BaseElement__c&filterId=no_filter&param1="+parentPageId,oncompleteLocationlink,ciLookupHeader)}function oncompleteLocationlink(d){var b="";if(d!=undefined&&d!=null){var c=(d.indexOf("==")!=-1)?d.split("=="):d.split("¬");for(var a=0;c.length>a+1;a++){if(c[a].split(":").length>1){b+=c[a].split(":")[0]+","}}}if(b.charAt(b.length-1)==","){b=b.substr(0,b.length-1)}linkLocationToBaseElement(b)}function refreshLocationPageGrid(){if(detailsPanel!=undefined&&detailsPanel!=null){detailsPanel.removeAll();detailsPanel.doLayout();var a=new DataGrid();detailsPanel.add(a);detailsPanel.doLayout();if(typeof(Ext.getCmp("prevId"))!="undefined"){Ext.getCmp("prevId").setDisabled(GetBRes(hasPrevious))}if(typeof(Ext.getCmp("nextId"))!="undefined"){Ext.getCmp("nextId").setDisabled(GetBRes(hasNext))}}}function returnFilterValue(d){var f=Ext.getCmp("allAsset");var e=Ext.getCmp("allCIs");var b=Ext.getCmp("markAsDeleted");var c=(f!=null&&f!=undefined)?f.checked:false;var h=(e!=null&&e!=undefined)?e.checked:false;var a=(b!=null&&b!=undefined)?b.checked:false;var g="";if(c&&d!="allAsset"){g=(g!="")?g+",AllAsset":"AllAsset"}if(h&&d!="allCIs"){g=(g!="")?g+",AllCIs":"AllCIs"}if(a&&d!="markAsDeleted"){g=(g!="")?g+",AllMarkAsDeleted":"AllMarkAsDeleted"}if(!Ext.getCmp(d).checked){if(d=="allAsset"){g=(g!="")?g+",AllAsset":"AllAsset"}else{if(d=="allCIs"){g=(g!="")?g+",AllCIs":"AllCIs"}else{if(d=="markAsDeleted"){g=(g!="")?g+",AllMarkAsDeleted":"AllMarkAsDeleted"}}}}return g};