var selectFieldsCombo;var highlightFieldsCombo;var isCI=false;var isAsset=false;function saveBtnHandler(){showSavingMask();save()}function enableDisableAudtingSection(c){var d;var b;if(Ext.isIE8){d=getElementsByClassName(document,"input","checkboxDivCls");b=getElementsByClassName(document,"td","labelAllignCls")}else{d=document.getElementsByClassName("checkboxDivCls");b=document.getElementsByClassName("labelAllignCls")}var a;if(Ext.getCmp("cmbSelectFields").getValue()=="0"){Ext.getCmp("cmbclassFields").hide()}else{Ext.getCmp("cmbclassFields").disable()}if(!document.getElementById(c).checked){Ext.getCmp("cmbSelectFields").disable();document.getElementById("SelectFieldsLabel").style.opacity="0.45";for(a=0;a<d.length;a++){d[a].disabled=true;b[a].style.opacity="0.45"}}else{Ext.getCmp("cmbSelectFields").enable();document.getElementById("SelectFieldsLabel").style.opacity="1";for(a=0;a<d.length;a++){d[a].disabled=false;b[a].style.opacity="1"}if(Ext.getCmp("cmbclassFields").disable()){Ext.getCmp("cmbclassFields").enable()}}}function reloadStore(SerializedList){var highlightFieldsComboStore=Ext.getCmp("cmbclassFields").getStore();highlightFieldsComboStore.removeAll();highlightFieldsComboStore.loadData(eval(SerializedList))}function highlightSelection(c){if(Lastcollection!=undefined){var b;for(b=0;b<Lastcollection.length;b++){if(Lastcollection[b]!=null){Lastcollection[b].className=Lastcollection[b].className.replace(/(?:^|\s)highlightdiv(?!\S)/g,"")}}}var a;var d;Lastcollection=[];for(a=0;a<c.length;a++){if(isCI==true&&c[a]==(orgNamespace.toLowerCase()+"asset_status__c")){c[a]=c[a+1]}else{if(isAsset==true&&c[a]==(orgNamespace.toLowerCase()+"ci_status__c")){c[a]=c[a+1]}}d=document.getElementById("trdiv_"+c[a]);if(d!=undefined){d.className="highlightdiv";Lastcollection[a]=d}}}Ext.onReady(function(){Ext.create("Ext.toolbar.Toolbar",{height:35,margins:"0 0 0 0",autoWidth:true,renderTo:"divToolbar",cls:"configureTrCls",items:[{scale:"medium",iconCls:"saveIcon",margins:"0 0 0 10",tooltipType:"title",tooltip:lblSave,id:"saveBtn",handler:saveBtnHandler},{xtype:"tbseparator"},{scale:"medium",iconCls:"refreshPage",margins:"0 0 0 0",tooltipType:"title",tooltip:lblRefresh,id:"refreshBtn",handler:resetBtnHandler}]});prepareDropdownOnLoad()});function stickyToolbar(){document.getElementById("stickytoolbar").className="toolbartd";document.getElementById("mainTable").className="margintop"}function prepareDropdownOnLoad(){setTimeout("stickyToolbar()",2000);var a=new Ext.data.ArrayStore({fields:["value","text"],filters:[function(c,d){if(isCIMgmtEnabled&&!isAssetMgmtEnabled){return(c.data.value<2)}else{if(!isCIMgmtEnabled&&isAssetMgmtEnabled){return(c.data.value!=1)}else{if(isCIMgmtEnabled&&isAssetMgmtEnabled){return(c)}else{return(c.data.value<1)}}}}],data:[["0",lblNone],["1",lblCIClass],["2",lblAssetClass]]});selectFieldsCombo=Ext.create("Ext.form.ComboBox",{store:a,displayField:"text",valueField:"value",value:"0",typeAhead:false,mode:"local",selectOnFocus:true,renderTo:"divSelectFieldsCombo",editable:false,loading:true,width:200,id:"cmbSelectFields",listeners:{select:function(e,c,d){if(document.getElementById("errorDiv").style.display=="block"){document.getElementById("errorDiv").style.display="none"}if(e.getValue()=="0"){fetchFieldstoHighlight("","");Ext.getCmp("cmbclassFields").hide()}else{if(e.getValue()=="1"){Ext.getCmp("cmbclassFields").show();Ext.getCmp("cmbclassFields").setValue([]);isCI=true;isAsset=false;reloadStore(serCIclass);highlightSelection("")}else{if(e.getValue()=="2"){Ext.getCmp("cmbclassFields").show();Ext.getCmp("cmbclassFields").setValue([]);isCI=false;isAsset=true;reloadStore(serAssetclass);highlightSelection("")}}}}}});var b=new Ext.data.ArrayStore({fields:["ClassName__c","Class__c","Id"]});highlightFieldsCombo=Ext.create("Ext.form.ComboBox",{store:b,emptyText:lblNone,id:"cmbclassFields",editable:true,typeAhead:true,queryMode:"local",displayField:"Class__c",valueField:"ClassName__c",tpl:new Ext.XTemplate('<tpl for="."><div title="{Class__c:htmlEncode}"  class="x-boundlist-item">{Class__c:this.ellipsify}</div></tpl>',{ellipsify:function(c){return Ext.util.Format.htmlEncode(Ext.util.Format.ellipsis(c,40))}}),width:220,renderTo:"divClassCombo",listeners:{select:function(e,c,d){ClassSelection=e.getValue();fetchFieldstoHighlight(ClassSelection,isAsset);if(document.getElementById("errorDiv").style.display=="block"){document.getElementById("errorDiv").style.display="none"}},render:function(d){new Ext.ToolTip({target:d.getEl(),html:lblHelpText})},blur:function(e){var d=e.getValue();if((d!=null)&&((isCI&&(serCIclass.indexOf(d)==-1))||(isAsset&&(serAssetclass.indexOf(d)==-1)))){document.getElementById("errorDiv").style.display="block";highlightSelection("")}else{document.getElementById("errorDiv").style.display="none"}if(d==null){highlightSelection("")}}}});if(selectFieldsCombo.getValue()=="0"){Ext.getCmp("cmbclassFields").hide()}enableDisableAudtingSection(isAuditingEnableCheckonLoad)}var waitMask="";function showLoadingMask(){waitMask=new Ext.LoadMask(Ext.getBody(),{msg:Loading});if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.show()}}function showSavingMask(){waitMask=new Ext.LoadMask(Ext.getBody(),{msg:Saving});if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.show()}}function hideMask(){if(waitMask!=null&&waitMask!=""&&typeof(waitMask)!="undefined"){waitMask.hide()}}var resetBtnHandler=function(a,b){showLoadingMask();resetAuditConfiguration()};function showMsg(){if(msgStrlbl!=null&&msgStrlbl!=""&&msgStrlbl==msg){ShowInlineMessage("SaveMessageDiv","tableCls",-52);if(msgStr!=null&&msgStr!=""){Ext.Msg.show({title:msgHeader,msg:msgStr,icon:Ext.MessageBox.WARNING,width:300,frame:false,buttons:Ext.Msg.OK})}}else{var a=ExceptionMessage;if(msgStr!=null&&msgStr!=""){a=a+" "+msgStr}Ext.Msg.show({title:msgHeader,msg:a,icon:Ext.MessageBox.ERROR,width:300,frame:false,buttons:Ext.Msg.OK})}}function getElementsByClassName(b,f,a){var e=(f=="*"&&b.all)?b.all:b.getElementsByTagName(f);var h=new Array();a=a.replace(/\-/g,"\\-");var g=new RegExp("(^|\\s)"+a+"(\\s|$)");var d;for(var c=0;c<e.length;c++){d=e[c];if(g.test(d.className)){h.push(d)}}return(h)};