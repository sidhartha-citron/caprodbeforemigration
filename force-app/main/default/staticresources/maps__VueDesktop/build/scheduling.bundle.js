(globalThis.webpackChunkmaps_desktop=globalThis.webpackChunkmaps_desktop||[]).push([[33],{4283:(e,t,s)=>{e.exports=s.p+"images/5fcac084f58726d5f4ede3ff32c548c4.svg"},2263:(e,t,s)=>{e.exports=s.p+"images/b2915a4abd0ee6049461e6e017608197.png"},6126:(e,t,s)=>{e.exports=s.p+"images/f332faa17a366e9c0260cc19a07b8f88.svg"},1132:(e,t,s)=>{e.exports=s.p+"images/2a5dbbc40ffd1057786fd91263cc7e16.svg"},7662:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Pe});var a=s(7387),i=s(5908),o=s(1515),n=s(8607),r=s(7082),l=s(1023),d=s(5493),c=s(1433),u=s(8939),_=s(257),h=s(2134),m=s(7606),f=s(6342);const{$:v,moment:b}=window;function p(e){const t=this.counter++;this.base__columnIdToDayInstance[t].calendarDate=b(e).tz(this.$User.timezoneId,!0),0===t&&this.store__calendarView===a.YV.AGENDA_WEEK&&(this.base__columnIdToDayInstance[-1].calendarDate=b(e).tz(this.$User.timezoneId,!0).add(-1,"d"));let s="dddd";return this.store__isAgendaWeek&&(s=this.$User.dateFormat.toUpperCase().replace(/Y/g,""),"-"!==s.charAt(0)&&"/"!==s.charAt(0)||(s=s.substring(1)),"/"!==s.charAt(s.length-1)&&"-"!==s.charAt(s.length-1)||(s=s.slice(0,-1)),s=s.length>=9?"ddd M/D":`ddd ${s}`),`<div data-column-id="${t}">${e.format(s)}</div>`}function g(){return{allDaySlot:!1,header:!1,handleWindowResize:!1,height:"auto",views:{agendaWeek:{columnHeaderHtml:p.bind(this)},agendaDay:{columnHeaderHtml:p.bind(this)},month:{editable:!1}},schedulerLicenseKey:window.fullcalendarKey,eventLimit:2,now:this.store__staticTime,timezone:this.$User.timezoneId,locale:this.$User.UserLocale,timeFormat:this.$User.timeFormat,slotDuration:"00:15:00",forceEventDuration:!0,defaultView:this.store__calendarView,editable:!0,lazyFetching:!1,nowIndicator:!0,droppable:!0,navLinks:!0,navLinkDayClick:e=>{this.base__navigationAction(this.setCalendarToDayView,e)},eventClick:e=>{if(this.store__isMonth)this.base__navigationAction(this.setCalendarToDayView,e.start);else{const t=this.base__shifts.find((t=>t.id===e.shiftId));e&&t&&t.routing&&this.base__showEventOnMap(e,t.routing)}},dayClick:e=>{this.store__isMonth&&this.base__navigationAction(this.setCalendarToDayView,e)},eventResize:e=>{this.base__hasModifiedEvents=!0,this.base__updatedEventsSet.add(e.id),this.resetRouteDataByShiftId(e.shiftId)},eventDrop:e=>{this.base__hasModifiedEvents=!0,this.base__updatedEventsSet.add(e.id),this.base__adjustToUserTimezone(e.end).add(-1*e.end.utcOffset(),"m"),this.base__adjustToUserTimezone(e.start).add(-1*e.start.utcOffset(),"m");const t=this.base__events.findIndex((t=>t.id===e.id));this.base__events[t].end=e.end,this.base__events[t].start=e.start,this.base__setShiftIdOnEvents([e]),this.resetRouteDataByShiftId(e.shiftId),this.base__$calendar.fullCalendar("updateEvent",e)},eventDragStart:e=>{this.base__events.find((t=>t.id===e.id)).hasError=!1},eventDragStop:e=>{this.base__hasModifiedEvents=!0,this.base__updatedEventsSet.add(e.id),this.resetRouteDataByShiftId(e.shiftId),this.base__$calendar.fullCalendar("rerenderEvents")},eventResizeStop:()=>{this.base__$calendar.fullCalendar("rerenderEvents")},dayNames:this.base__getDayNames(),dayNamesShort:this.base__getDayNamesShort(),monthNames:this.base__getMonthNames(),monthNamesShort:this.base__getMonthNamesShort(),eventMouseout:this.base__eventMouseoutHandler,eventRender:(e,t)=>{const s="inverse-background"===e.rendering;this.store__isMonth||s||this.$nextTick((()=>{const s=t.find(".fc-time").detach(),a=t.find(".fc-bg").detach(),i=t.find(".fc-resizer").detach();t.empty();const o=v(this.$refs[e.id]);o.find(".fc-time").remove(),s.insertAfter(o.find(".fc-title")),o.appendTo(t),a.appendTo(t),i.appendTo(t),e.hasError&&t.addClass("has-error");const n=this.base__events.find((t=>t.id===e.id));if(n&&n.bgColorClass){t.addClass(n.bgColorClass);const e=v(`.${n.bgColorClass}`).css("color");e&&t.css("color",(0,f.Qg)(e))}}))},eventAfterAllRender:e=>{const t=e.name===a.YV.AGENDA_DAY,s=e.name===a.YV.AGENDA_WEEK,i=!t&&!s||this.base__performedScrollToLogic;if(this.duplicationCheck(),!i){if(v(".fc-time-grid-event").length){const e=v("div.fc-event-container a");let t=e&&e.length>0?e[0].offsetTop:0;s&&e.each(((e,s)=>{s.offsetTop<t&&(t=s.offsetTop)})),v("div.fc-scroller").animate({scrollTop:t-20},250),this.base__performedScrollToLogic=!0}t&&(this.base__$calendar.fullCalendar("getView").stopNowIndicator(),window.setTimeout((()=>{try{for(;v("#schedulePanelBody").next().length>0;)v("#schedulePanelBody").next().remove()}catch(e){console.warn(e)}}),100))}},eventReceive:e=>{this.routeDefaults.duration>=15?(this.base__adjustToUserTimezone(e.end).add(-1*e.end.utcOffset(),"m"),this.base__adjustToUserTimezone(e.start).add(-1*e.start.utcOffset(),"m"),this.base__updatedEventsSet.add(e.id),this.base__hasModifiedEvents=!0,this.base__numEventsReceived++,this.store__removeItemFromQueueById(e.id),this.base__events.push(e),this.base__setShiftIdOnEvents([e]),this.resetRouteDataByShiftId(e.shiftId),this.base__$calendar.fullCalendar("updateEvent",e)):this.base__$calendar.fullCalendar("removeEvents",e.id)},viewRender:()=>{this.store__isMonth||(this.appendCustomColumnHeaderMarkup(),this.resizeWeekHeader(),window.addEventListener("resize",this.resizeWeekHeader)),this.$nextTick((()=>{v(".ma-calendar .fc-axis.fc-widget-header").css("text-align","center").html(`<span style="font-size: 10px; font-weight: 100;">GMT${(0,a.m9)(b.tz(this.base__getCorrectTimezone()).format("Z"))}</span>`)}))},viewDestroy:()=>{this.resetComponentState(),this.actionMenu.doRender=!1,window.removeEventListener("resize",this.resizeWeekHeader)},events:this.getEvents.bind(this)}}var S=s(1984),y=s(9211);const{moment:E,MASystem:C,MAToastMessages:T}=window,w=S.Z.getDefaultSettingsGroup(),L={props:{base__showFullScreenToggleControl:{type:Boolean,required:!0},base__storedIsLoading:{type:Boolean,required:!0}},data(){return{locationCache:new Map,base__$calendar:{},base__events:[],base__shifts:[],base__searchTerm:this.$User.FullName,base__calendarId:this.$User.Id,base__isLoading:this.base__storedIsLoading,base__callouts:0,base__performedScrollToLogic:!1,base__configErrors:{},base__saveWarnings:{},base__hasModifiedEvents:!1,base__showPendingChangeModal:!1,base__storedNavigationAction:null,base__numEventsReceived:0,base__updatedEventsSet:new Set,base__columnIdToDayInstance:{},base__eventIdsForDelete:[],base__locationIdsForDelete:[],base__hasModifiedShifts:!1,base__skipTimeAxisCheck:!1,queueUnwatch:null,resourceProfileId:""}},computed:{...(0,i.mapGetters)("scheduling",{store__isAgendaDay:"isAgendaDay",store__isAgendaWeek:"isAgendaWeek",store__isMonth:"isMonth",store__isTimelineDay:"isTimelineDay",store__isDayView:"isDayView",store__calendarView:"calendarView",store__calendarDate:"calendarDate",store__queue:"queue",store__staticTime:"staticTime",store__addToScheduleExecuted:"addToScheduleExecuted"}),base__laborLawNotify:()=>window.getProperty(C||{},"Organization.LaborLawsNotify",!1)||!1,base__doDisableSaveBtn(){return!(this.base__eventIdsForDelete.length||this.base__hasModifiedEvents||this.base__locationIdsForDelete.length||this.base__hasModifiedShifts)},base__showControls(){return!this.store__isMonth},base__showSaveErrorModal(){return Object.keys(this.base__configErrors).length||Object.keys(this.base__saveWarnings).length},base__hasPendingChanges(){return this.base__hasModifiedEvents||this.base__hasModifiedShifts||this.base__locationIdsForDelete.length},queueLength(){return this.store__queue.length}},watch:{base__isLoading(e){!e&&this.base__callouts>0||this.$emit("update:base__storedIsLoading",e)},base__callouts(e){this.base__isLoading=e>0},queueLength(e,t){e!==t&&this.base__calculateEventPriorityIndex()},base__events(e,t){if(e.length!==t.length)this.base__calculateEventPriorityIndex();else for(let s=0;s<e.length;s++)if(!e[s].start.isSame(t[s].start)||0===e[s].priority)return void this.base__calculateEventPriorityIndex()}},created(){this.store__staticTime||this.store__updateStaticTime(E().tz(this.$User.timezoneId))},methods:{...(0,i.mapActions)("scheduling",{store__removeItemFromQueueById:"removeItemFromQueueById",store__addItemToQueue:"addItemToQueue"}),...(0,i.mapMutations)("scheduling",{store__sortQueue:"sortQueue",store__updateStaticTime:"updateStaticTime"}),base__getDayNamesShort(){return[this.$Labels.MA_Sunday_Short,this.$Labels.MA_Monday_Short,this.$Labels.MA_Tuesday_Short,this.$Labels.MA_Wednesday_Short,this.$Labels.MA_Thursday_Short,this.$Labels.MA_Friday_Short,this.$Labels.MA_Saturday_Short]},base__getDayNames(){return[this.$Labels.MA_Sunday,this.$Labels.MA_Monday,this.$Labels.MA_Tuesday,this.$Labels.MA_Wednesday,this.$Labels.MA_Thursday,this.$Labels.MA_Friday,this.$Labels.MA_Saturday]},base__getMonthNames(){return[this.$Labels.MA_January,this.$Labels.MA_February,this.$Labels.MA_March,this.$Labels.MA_April,this.$Labels.MA_May,this.$Labels.MA_June,this.$Labels.MA_July,this.$Labels.MA_August,this.$Labels.MA_September,this.$Labels.MA_October,this.$Labels.MA_November,this.$Labels.MA_December]},base__getMonthNamesShort(){return[this.$Labels.MA_January_Short,this.$Labels.MA_February_Short,this.$Labels.MA_March_Short,this.$Labels.MA_April_Short,this.$Labels.MA_May_Short,this.$Labels.MA_June_Short,this.$Labels.MA_July_Short,this.$Labels.MA_August_Short,this.$Labels.MA_September_Short,this.$Labels.MA_October_Short,this.$Labels.MA_November_Short,this.$Labels.MA_December_Short]},base__calculateEventPriorityIndex(){const e=[],t=this.base__events.concat(this.store__queue).filter((e=>e.spatial));t.forEach((t=>e.push({priority:t.priorityValue||0,id:t.id})));let s=e.length;e.sort(((e,t)=>t.priority-e.priority)).forEach(((e,a)=>{const i=t.find((t=>t.id===e.id));i.priority=a+1,i.priorityIndex=s--})),this.store__sortQueue()},base__changeCalendarView(e){this.base__clearRoutes(),this.$store.commit("scheduling/setView",e)},base__changeCalendarDate(e){this.base__clearRoutes(),this.$store.commit("scheduling/setDate",e)},base__today(){this.base__clearRoutes(),this.$nextTick((()=>{this.base__$calendar.fullCalendar("today"),this.$store.commit("scheduling/setDate",this.base__getCalendarDate())}))},base__previous(){this.base__clearRoutes(),this.$nextTick((()=>{this.base__$calendar.fullCalendar("prev"),this.$store.commit("scheduling/setDate",this.base__getCalendarDate())}))},base__next(){this.base__clearRoutes(),this.$nextTick((()=>{this.base__$calendar.fullCalendar("next"),this.$store.commit("scheduling/setDate",this.base__getCalendarDate())}))},base__clearRoutes(){this.store__calendarView===a.YV.TIMELINE_DAY?this.unrenderRoutesFromMap():this.base__shifts.forEach((e=>{this.resetRouteDataByShiftId(e.id)}))},base__navigationAction(e,...t){const s=()=>{this.$nextTick((()=>{e.apply(this,t)}))};if(this.base__hasPendingChanges)return this.base__showPendingChangeModal=!0,void(this.base__storedNavigationAction=s);s()},base__hideSaveErrorModal(){this.base__configErrors={},this.base__saveWarnings={}},base__setConfigId(e){const t=[];e.eventIds.forEach((s=>{const a=this.base__$calendar.fullCalendar("clientEvents").find((e=>e.id===s));a&&(a.configId=e.configId,t.push(a))})),t.length&&this.base__$calendar.fullCalendar("updateEvents",t)},base__completeNavigationRequest(){this.base__storedNavigationAction()},base__saveAndCompleteNavigationRequest(){this.base__save().then((()=>{this.$parent.base__showSaveErrorModal||this.base__storedNavigationAction()}))},base__save({doClone:e=!1,cloneSourceDate:t=null,cloneTargetDate:s=null,doCloneStartEndLocations:a=!1,ignoreSaveChecks:i=!1}={}){return new Promise((o=>{this.base__checkScheduleQueue().then((()=>{try{let n=0,r=0;this.base__callouts+=1;const l=[];if(e){this.base__adjustToUserTimezone(E(t)).isDST()!==this.base__adjustToUserTimezone(E(s)).isDST()&&(r=this.base__adjustToUserTimezone(E(s)).isDST()?-1:1);const e=window.$.fullCalendar.moment(s).stripZone();e.stripTime(),t.stripTime();const a=E(e).diff(E(t),"days");n=864e5*a}const d=window.getProperty(C||{},"Organization.isMAGuideEnabled",!1)||!1;this.base__$calendar.fullCalendar("clientEvents").forEach((t=>{const s=t.start.add(r,"hours"),a=t.end.add(r,"hours"),i=6e4*this.base__adjustToUserTimezone(E(t.start)).utcOffset(),o=this.base__adjustToUserTimezone(E(s)).valueOf()-(i+n),c=this.base__adjustToUserTimezone(E(a)).valueOf()-(i+n),u={startTime:t.start.utcOffset()?t.start.valueOf()+n:o,endTime:t.end.utcOffset()?t.end.valueOf()+n:c,recordId:t.recordId,doClone:e,relationshipId:t.relationshipId,subject:t.title,layerId:t.MarkerLayer__c,baseObjectId:t.baseObjectId,configId:t.configId,ownerId:t.resourceId||this.base__calendarId,uid:t.id,location:{latLng:{lat:t.lat,lng:t.lng},address:t.Address__c||t.address,city:t.city||"",state:t.state||"",postalCode:t.postalCode||"",street:t.street||"",country:t.country||""},isMALocation:t.isMALocation||!1};if(d){const{guideWaypoint:e={}}=t;e.hasWaypoint&&(u.guideWaypoint=e)}(e||this.base__updatedEventsSet.has(u.uid))&&l.push(u)})),this.store__queue.forEach((e=>{e.recordId&&(this.base__eventIdsForDelete.push(e.recordId),e.recordId=null)}));const c={events:l,eventIdsForDelete:this.base__eventIdsForDelete,shiftsForUpsert:this.store__isTimelineDay?[]:this.prepareShiftRecordsForUpsert(n,a),calendarId:this.base__calendarId,ignoreSaveChecks:i};window.trackUsage("Maps",{action:"Save Schedule",description:"Clicking Save on Schedule"}),(new _.Z).setAction(this.$Remoting.saveCalendarEvents).setErrorHandler(this.base__handleRemoteActionError.bind(this)).invoke([JSON.stringify(c)],(e=>{if(h.Z.debugRemotingData("saveCalendarEvents",[c],e),e.success)e.configMissing&&e.multipleConfigs?0!==Object.keys(e.multipleConfigs).length?this.base__configErrors={...e.multipleConfigs}:this.base__configErrors={...e.configMissing}:e.saveWarnings?this.base__saveWarnings=e.saveWarnings:(this.base__hasModifiedEvents=!1,this.base__updatedEventsSet.clear(),o());else{let t=e.message;t.includes("FIELD_INTEGRITY_EXCEPTION")&&(t=`Oops! Looks like this event is associated with an object that no longer has activities enabled. Please re-enable activities. <br /><br />${t}`),this.$emit("error",t)}this.base__callouts-=1}),{timeout:12e4})}catch(e){this.base__callouts-=1,this.$emit("error",e.stack)}})).catch((()=>{}))}))},base__checkScheduleQueue(){return new Promise(((e,t)=>{let s=!1;this.store__queue.forEach((e=>{e.recordId&&(s=!0)})),!window.getProperty(window,"userSettings.hideQueueWarningModal",!1)&&s?window.MA.Popup.showMAConfirm({popupId:"queueConfirmModal",template:'<div><div style="font-size: 13px;" class="slds-form-element__label">You have items in the "Unscheduled" column related to Salesforce data. Continuing to save will keep these items in the queue, but the underlying Salesforce information will be removed.</div><div style="font-size: 13px;" class="slds-p-top_small slds-form-element__label">Are you sure you wish to continue?</div><div class="slds-form-element slds-p-top_large slds-float_right"><div class="slds-form-element__control"><div class="slds-checkbox"><input type="checkbox" name="options" id="confirmqueue-2" value="confirmqueue-2" /><label class="slds-checkbox__label" for="confirmqueue-2"><span class="slds-checkbox_faux"></span><span class="slds-form-element__label">Hide this message on future updates?</span></label></div></div></div></div>',buttons:[{text:"Cancel",type:"slds-button_neutral",onTap:()=>({hideModal:document.querySelector("#queueConfirmModal #confirmqueue-2").checked,success:!1})},{text:"Confirm",type:"slds-button_brand",onTap:()=>({hideModal:document.querySelector("#queueConfirmModal #confirmqueue-2").checked,success:!0})}]}).then((s=>{if(s.success){if(s.hideModal){const e={userIds:JSON.stringify([this.$User.Id]),field:"maps__MapsSetting__c",type:"setting",value:"true",action:"save_permissions_mass",setting:"hideQueueWarningModal"};(new _.Z).setAction(this.$Remoting.AdminStartUpAction).setErrorHandler((e=>{console.warn("unable to save setting",e)})).invoke([e],(()=>{h.Z.debugRemotingData("save_permissions_mass",[e],{}),window.userSettings.hideQueueWarningModal=!0}),{escape:!1,buffer:!1})}e()}else t()})):e()}))},prepareShiftRecordsForUpsert(e=0,t=!1){const s=e=>/__c|__s$/.test(e)?`maps__${e}`:e;return this.columnIds.reduce(((s,a)=>{const{shifts:i,calendarDate:o}=this.base__columnIdToDayInstance[a];return i.forEach((a=>{t&&(a.record.Id=null),(a.doUpsert||t)&&(a.record.Date__c=E(o.add(e,"ms")).format("YYYY-MM-DD"),s.push(a.record))})),s}),[]).map((e=>Object.assign({},...Object.keys(e).map((t=>({[s(t)]:e[t]}))))))},base__processResponseErrors(e,t){const s=[],a=r.Z.getWaypointErrorMessage(e.maioCode,r.D.SCHEDULE);if(!e.details)return;Array.isArray(e.details)||(e.details=[e.details]);const{startLocation:i,endLocation:o}=t;let n;e.details.forEach((e=>{if(!e.erroramount&&!e.errormessage)return;let t=this.base__events.find((t=>t.id===e.id));const r=null!=t;if(!r)if(i.id===e.id)t=i;else{if(o.id!==e.id)return;t=o}if(this.$set(t,"hasError",!0),this.$set(t,"errorMessage",a),e.erroramount&&(n=function(e){const t=parseInt(e/3600,10);e-=3600*t;const s=parseInt(e/60,10);return`${t}h ${s}m ${e-=60*s}s`}(e.erroramount),this.$set(t,"errorTimeString",n)),r){const t=this.base__$calendar.fullCalendar("clientEvents").find((t=>t.id===e.id));if(!t)return;t.hasError=!0,s.push(t)}})),r.Z.showErrorMessage(e.maioCode,r.D.SCHEDULE,n),s.length&&this.base__$calendar.fullCalendar("updateEvents",s)},base__fetchCalendarShifts({startLocationId:e,endLocationId:t,resource:{id:s=this.base__calendarId}}){return new Promise(((a,i)=>{this.base__callouts+=1;const{start:o,end:n}=this.base__$calendar.fullCalendar("getView"),r=1===n.diff(o,"d"),l=r?o.format("YYYY-MM-DD"):o.add(-1,"d").format("YYYY-MM-DD"),d=r?l:n.format("YYYY-MM-DD"),c={resourceId:s,startDate:l,endDate:d,defaultStartLocationId:e,defaultEndLocationId:t};(new _.Z).setAction(this.$Remoting.getCalendarShifts).setErrorHandler(this.base__handleRemoteActionError.bind(this)).invoke([JSON.stringify(c)],(e=>{h.Z.debugRemotingData("getCalendarShifts",[c],e),this.base__callouts-=1,e.success?a(e.data||[]):i(new Error(e.message))}),{escape:!1,buffer:!1})}))},base__getResourceProfileId(e){return new Promise((t=>{const s={ajaxResource:"UserAJAXResources",action:"get_resource_user_profile_id",resourceId:e};(new _.Z).setAction(this.$Remoting.processAJAXRequest).setErrorHandler(this.base__handleRemoteActionError.bind(this)).invoke([s],(e=>{h.Z.debugRemotingData("get_user_profile_id",[s],e),t(e)}))}))},base__fetchRouteDefaultsByResource(e){return this.base__getResourceProfileId(e.id).then((e=>{e.success&&e.profileId?this.resourceProfileId=e.profileId:e.error&&console.error("Profile Retrieval Error: ",e.error)})),new Promise((t=>{const s={ajaxResource:"UserAJAXResources",action:"get_user_prefs",userId:e.id,profileId:this.resourceProfileId?this.resourceProfileId:C.User.profileId};(new _.Z).setAction(this.$Remoting.processAJAXRequest).setErrorHandler(this.base__handleRemoteActionError.bind(this)).invoke([s],(a=>{h.Z.debugRemotingData("get_user_prefs",[s],a);const i=this;if(a&&a.success){let s={},o={};if(a.record&&!a.settings){try{o=JSON.parse(a.record.maps__MapsSetting__c)}catch(s){o={RouteDefaults:d.Z.actualRouteDefaults},t({...i.formatRouteDefaults(o,a),resource:e})}s={...o.RouteDefaults||d.Z.actualRouteDefaults,workingHours:o.workingHours||{},name:a.record.Name,timezone:a.record.TimeZoneSidKey}}else if(a.settings){let n,r;try{const e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];let t=E.isMoment(this.store__calendarDate)&&this.store__calendarDate.isValid()?this.store__calendarDate.format("E"):2;t--,n=a.settings.maps__DefaultValues__c?JSON.parse(a.settings.maps__DefaultValues__c):JSON.parse(w),r=a.record.maps__MapsSetting__c?JSON.parse(a.record.maps__MapsSetting__c):d.Z.actualRouteDefaults;const{defaultEndLocation:i,defaultStartLocation:l,stopEventDuration:c,defaultTransportationMode:u,enableTraffic:_,currentTimeAndLoc:h,enableDuplicateStops:m,routeType:f,units:v}=n;let{RouteDefaults:b}=r;b||(b=d.Z.actualRouteDefaults);const{workingHours:p}=r;let{startLocationId:g,startLocationLabel:S,endLocationId:y,endLocationLabel:C,duration:T,driveProfile:L,displayTrafficTime:I,enableCurrentLocationTime:D,enableDuplicateStops:A,mode:M,optimizationType:$,type:k,unit:R}=b;!i||i.overridable&&y||(y=i.value.id,C=i.value.label),!l||l.overridable&&g||(g=l.value.id,S=l.value.label),u.overridable||(M=u.value,$=u.value),!c||!c.value||c.overridable&&T||(T=c.value),!u||!u.value||u.overridable&&L||(L=u.value),_&&_.value&&!_.overridable&&(I=_.value),h&&h.value&&!h.overridable&&(D=h.value),m&&m.value&&!m.overridable&&(A=m.value),f&&f.value&&!f.overridable&&(k=f.value),v&&v.value&&!v.overridable&&(R=v.value);const x={...n.schedule},O=this.formatWorkingHours(x,p),{startTime:F,endTime:H}=O[e[t]];s={duration:T,driveProfile:L,displayTrafficTime:I,enableCurrentLocationTime:D,enableDuplicateStops:A,endLocationId:y,endLocationLabel:C,mode:M,optimizationType:$,startLocationId:g,startLocationLabel:S,type:k,unit:R,start:F,end:H},o={RouteDefaults:s,workingHours:O}}catch(s){o={RouteDefaults:d.Z.actualRouteDefaults},t({...i.formatRouteDefaults(o,a),resource:e})}}"string"==typeof s.displayTrafficTime&&(s.displayTrafficTime=!0),t({...this.formatRouteDefaults(o,a),resource:e})}else t({...d.Z.routeDefaults,resource:e})}),{escape:!1,buffer:!1})}))},formatWorkingHours(e={},t={}){e||(e={}),t||(t={});const s={};let a=Object.keys(e);return!a.length>0&&(a=Object.keys(t).length>0?Object.keys(t):["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]),a=a.filter((e=>"errorMsg"!==e)),e&&a.length>0&&a.forEach((a=>{if(e&&e[a].overridable&&t&&t[a])return void(s[a]=t[a]);const i=e[a].value.startTime?e[a].value.startTime.split(" "):[],o=i.length>1?i[0].split(":"):[];let n;i[1]&&o[0]?(n="pm"===i[1].toLowerCase()&&12!==parseInt(o[0],10)?String(parseInt(o[0],10)+12):o[0],"am"===i[1].toLowerCase()&&12===parseInt(o[0],10)&&(n="0")):n="";const r=o[1]?o[1]:"",l=e[a].value.endTime.split(" "),d=l[0]?l[0].split(":"):[];let c;l[1]&&d[0]?(c="pm"===l[1].toLowerCase()&&12!==parseInt(d[0],10)?String(parseInt(d[0],10)+12):d[0],"am"===l[1].toLowerCase()&&12===parseInt(d[0],10)&&(c="0")):c="";const u=d[1]?d[1]:"",_=E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(o[0],"h").add(o[1],"m"),h=E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(d[0],"h").add(d[1],"m");s[a]={workingDay:!0,startHour:n,startMinute:r,endMinute:u,endHour:c,overnight:!!_>h,startTime:_,endTime:h}})),s},formatRouteDefaults(e,t){const s={...e.RouteDefaults||d.Z.actualRouteDefaults,workingHours:e.workingHours||{},name:t.record.Name,timezone:t.record.TimeZoneSidKey};return"string"==typeof s.displayTrafficTime&&(s.displayTrafficTime=!0),s},base__setShiftIdOnEvents(e){e.forEach((e=>{const t=e.start,s=e.end;let a=!1;const i=this.base__events.findIndex((t=>t.id===e.id)),o=this.base__events[i];this.base__shifts.forEach((i=>{const n=i.startTime,r=i.endTime;i.resourceId&&e.resourceId!==i.resourceId||t<=r&&s>=n&&(o.shiftId=e.shiftId=i.id,o.columnId=e.columnId=i.columnId,o.resourceId=i.resourceId,a=!0)})),a||(o.shiftId=e.shiftId=null)}))},base__getWorkingHours({calendarDate:e,workingHours:t}){let s;switch(e.format("dd")){case"Su":s="sunday";break;case"Mo":s="monday";break;case"Tu":s="tuesday";break;case"We":s="wednesday";break;case"Th":s="thursday";break;case"Fr":s="friday";break;case"Sa":s="saturday"}return t?t[s]:d.Z.getWorkingHoursByDayString(s)},base__setShiftsOnInstance(e,t={}){let s=this.base__getWorkingHours(e);e.hasOvernightShift=!1,null==s&&(s={startHour:9,startMinute:0,endHour:17,endMinute:0});const{startLocation:i={},endLocation:o={}}=t;(0,f.a$)(i,"maps__"),(0,f.a$)(o,"maps__");const n={id:(0,a.ZP)(),columnId:e.columnId,resourceId:e.resourceId,startLocation:{...this.base__getDefaultLocationSettings(),isSpatial:null!=i.Latitude__c&&null!=i.Longitude__c},endLocation:{...this.base__getDefaultLocationSettings(),isSpatial:null!=o.Latitude__c&&null!=o.Latitude__c},record:{Date__c:e.calendarDate.format("YYYY-MM-DD"),ResourceId__c:this.base__calendarId,StartAddress__c:i.Address__c,StartLocation__Latitude__s:i.Latitude__c,StartLocation__Longitude__s:i.Longitude__c,StartHour__c:s.startHour,StartMinute__c:s.startMinute,EndAddress__c:o.Address__c,EndLocation__Latitude__s:o.Latitude__c,EndLocation__Longitude__s:o.Longitude__c,EndHour__c:s.endHour,EndMinute__c:s.endMinute},onMap:!1,route:{},routing:null,doUpsert:!1,isOvernight:!1,startTime:E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(s.startHour,"h").add(s.startMinute,"m"),endTime:E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(s.endHour,"h").add(s.endMinute,"m")};e.earliestShiftTime=n.startTime,e.latestShiftTime=n.endTime,n.startTime>n.endTime&&(n.endTime.add(1,"d"),n.isOvernight=e.hasOvernightShift=!0),e.shifts=[n];const r=e.calendarDate.format("YYYY-MM-DD"),l=t.shiftMap[r];if(!l||!l.length)return;let d,c;e.shifts=[],l.forEach((t=>{(0,f.a$)(t,"maps__");const s={id:(0,a.ZP)(),startLocation:Object.assign(n.startLocation,{isSpatial:null!=t.StartLocation__Latitude__s}),endLocation:Object.assign(n.endLocation,{isSpatial:null!=t.EndLocation__Latitude__s}),record:{Id:t.Id,StartAddress__c:t.StartAddress__c,StartLocation__Latitude__s:t.StartLocation__Latitude__s,StartLocation__Longitude__s:t.StartLocation__Longitude__s,EndAddress__c:t.EndAddress__c,EndLocation__Latitude__s:t.EndLocation__Latitude__s,EndLocation__Longitude__s:t.EndLocation__Longitude__s}},{StartHour__c:i,StartMinute__c:o,EndHour__c:r,EndMinute__c:l}=t;i>=0&&o>=0?(s.record.StartHour__c=i,s.record.StartMinute__c=o,s.startTime=E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(i,"h").add(o,"m")):s.startTime=n.startTime,r>=0&&l>=0?(s.record.EndHour__c=r,s.record.EndMinute__c=l,s.endTime=E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(r,"h").add(l,"m")):s.endTime=n.endTime,s.startTime>s.endTime&&(s.endTime.add(1,"d"),s.isOvernight=e.hasOvernightShift=!0),s.earliestShiftTime&&!s.startTime.isBefore(e.earliestShiftTime)||(e.earliestShiftTime=s.startTime),s.latestShiftTime&&!s.endTime.isAfter(e.latestShiftTime)||(e.latestShiftTime=s.endTime),d=null==d||s.startTime.isBefore(d)?s.startTime:d,c=null==c||s.endTime.isBefore(c)?s.endTime:c,e.shifts.push({...n,...s})})),e.hasOvernightShift&&d.isBefore(e.earliestShiftTime)&&(e.earliestShiftTime=d),e.hasOvernightShift&&c.isBefore(e.latestShiftTime)&&(e.latestShiftTime=c)},base__adjustToUserTimezone(e,t){return t?e.tz(t):this.routeDefaults&&this.routeDefaults.timezone?e.tz(this.routeDefaults.timezone):e.tz(this.$User.timezoneId),e},base__getCorrectTimezone(){let e=this.$User.timezoneId;return this.routeDefaults&&this.routeDefaults.timezone&&(e=this.routeDefaults.timezone),e},base__forceMapResize(){window.setTimeout((()=>{window.google.maps.event.trigger(window.MA.map,"resize")}),200)},base__getExcludeIncludeActionLabel(e){return e.excludeFromRoute?this.$Labels.MA_INCLUDE_IN_OPTIMIZATION:this.$Labels.MA_EXCLUDE_FROM_OPTIMIZATION},base__eventHasRecord:e=>void 0!==e.recordId&&null!==e.recordId,base__hasGuideWaypoint(e){const{guideWaypoint:t={}}=e;return!!t.hasWaypoint&&t.hasWaypoint},base__getGuideWaypointLockIcon(e){const{guideWaypoint:t={}}=e;return t.isLocked?"ma-icon-lock-closed":"ma-icon-lock-open"},base__setGuideLockStatus(e){return new Promise((t=>{const s=this.base__$calendar.fullCalendar("clientEvents").filter((t=>t.id===e.id))[0],{guideWaypoint:a={}}=s;a.isLocked=!e.guideWaypoint.isLocked,a&&a.hasWaypoint&&(this.base__hasModifiedEvents=!0,this.base__updatedEventsSet.add(e.id)),this.$nextTick((()=>{this.base__$calendar.fullCalendar("updateEvent",s),t()}))}))},base__setExcludeInclude(e){return new Promise((t=>{const s=this.base__$calendar.fullCalendar("clientEvents").filter((t=>t.id===e.id))[0];s.excludeFromRoute=!e.excludeFromRoute,s.className=s.excludeFromRoute?["non-spatial-cell"]:["eventCell"];const a=this.base__events.findIndex((t=>t.id===e.id));this.base__events[a].excludeFromRoute=!e.excludeFromRoute,this.$nextTick((()=>{this.base__$calendar.fullCalendar("updateEvent",s),t()}))}))},base__setDefaultDuration(e){this.base__$calendar.fullCalendar("getView").calendar.defaultTimedEventDuration=E.duration({minutes:e})},base__setTimeAxisRange(e,t){this.base__$calendar.fullCalendar("option",{minTime:e,maxTime:t})},base__buildTimeAxisString:(e,t)=>`${e.hours()+t}:00:00`,base__convertStringToMinutes(e){let t=0;try{const s=(e||"0 hr, 0 min").split(",");let a=s[0]||"0 hr",i=s[1]||"0 min";a=parseInt(a.replace(/\D/g,""),10),i=parseInt(i.replace(/\D/g,""),10),t=60*a+i}catch(e){t=0}return t||15},base__emitViewModeChangeEvent(e){switch(e){case a.YV.AGENDA_WEEK:case a.YV.TIMELINE_DAY:case a.YV.MONTH:this.$bus.$emit("set-calendar-view-mode",a.Oq.FULLWIDTH_HALFHEIGHT);break;case a.YV.AGENDAY_DAY:default:this.$bus.$emit("set-calendar-view-mode",a.Oq.DEFAULT)}},base__getCalendarDate(){return this.base__$calendar.fullCalendar("getDate")},base__fetchEvents(e,t,s,a){return new Promise(((i,o)=>{a||i([]);const n={startTime:e.valueOf()-6e4*e.tz(s).utcOffset(),endTime:t.valueOf()-6e4*t.tz(s).utcOffset()-1e3,resourceId:a};this.base__callouts+=1,(new _.Z).setAction(this.$Remoting.getCalendarEvents).setErrorHandler(this.base__handleRemoteActionError.bind(this)).invoke([JSON.stringify(n)],(e=>{if(h.Z.debugRemotingData("getCalendarEvents",[n],e),this.base__callouts-=1,e.success){const t=this.buildFloatingBreakEvents(e.floatingBreaks,a),s=this.buildCalendarEvents(e.events||[],a);i(s.concat(t))}else o(new Error(e.message))}),{escape:!1,buffer:!1})}))},buildFloatingBreakEvents(e=[],t){const s=[],i=0===e.length?null:e[0],o=null!==i;if(!o||this.store__isMonth)return[];if(window.userSettings&&window.userSettings.floatingBreak&&window.userSettings.floatingBreak.enabled)if(this.store__calendarView===a.YV.TIMELINE_DAY){const e=o?E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(i.startHour,"h").add(i.startMinute,"m"):null,n=o?E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(i.endHour,"h").add(i.endMinute,"m"):null,r=o?E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(1,"d").add(i.startHour,"h").add(i.startMinute,"m"):null,l=o?E.tz(this.store__calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(1,"d").add(i.endHour,"h").add(i.endMinute,"m"):null,d={id:(0,a.ZP)(),resourceId:t,title:"Break",isBreak:!0,start:e,end:n,className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showActionMenu:!1};s.push(d);const c={id:(0,a.ZP)(),resourceId:t,title:"Break",isBreak:!0,start:r,end:l,className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showActionMenu:!1};s.push(c)}else Object.values(this.base__columnIdToDayInstance).forEach((e=>{if(-1!==e.columnId){const n=o?E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(i.startHour,"h").add(i.startMinute,"m"):null,r=o?E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(i.endHour,"h").add(i.endMinute,"m"):null,l=o?E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(1,"d").add(i.startHour,"h").add(i.startMinute,"m"):null,d=o?E.tz(e.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(1,"d").add(i.endHour,"h").add(i.endMinute,"m"):null,c={id:(0,a.ZP)(),resourceId:t,title:"Break",isBreak:!0,start:n,end:r,className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showActionMenu:!1};if(s.push(c),this.store__isDayView){const e={id:(0,a.ZP)(),resourceId:t,title:"Break",isBreak:!0,start:l,end:d,className:"non-spatial-cell",editable:!1,spatial:!1,excludeFromRoute:!0,showActionMenu:!1};s.push(e)}}}));return s},buildCalendarEvents(e,t){const s=[];function i(e){const{street:t,city:s,state:a,postalCode:i,country:o}=e.location;let n="";return t&&(n+=`${t}, `),s&&(n+=s),a&&(n+=`, ${a}`),i&&(n+=` ${i}`),o&&(n+=` ${o}`),n}let o=!1;return e.forEach((e=>{const{value:n=0,type:r="",label:l="",sfdcFieldType:d="number",sfdcFieldValue:c=0}=e.priority||{},{GuideWaypoint:u={}}=e;let _={id:(0,a.ZP)(),resourceId:t,title:e.Subject,start:this.base__adjustToUserTimezone(E(e.StartDateTime)),end:this.base__adjustToUserTimezone(E(e.EndDateTime)),className:"non-spatial-cell",spatial:!1,excludeFromRoute:!0,showActionMenu:!1,recordId:e.RecordId,relationshipId:e.RelationshipId,LinkId__c:e.LinkId__c,MarkerLayer__c:e.LayerId,baseObjectId:e.BaseObjectId,configId:e.ConfigId,priority:n,priorityType:r,priorityLabel:l,priorityValue:c,priorityFieldType:d,guideWaypoint:{hasWaypoint:u.hasWaypoint||!1,isLocked:u.isLocked||!1,id:u.id||""}};if(e.location){const{geocodeError:t,geocodeErrorMessage:s,street:a="",city:n="",postalCode:r="",state:l="",country:d="",lat:c,lng:u,verifiedLat:h,verifiedLng:m}=e.location;if(c&&u||h&&m){const t={className:"eventCell",spatial:!0,excludeFromRoute:!1,verifiedLat:h,verifiedLng:m,lat:c,lng:u,address:i(e),street:a,city:n,postalCode:r,state:l,country:d};_={..._,...t}}_.start.isSame(_.end)&&_.end.add(1,"seconds"),t&&s&&(o=!0,_.hasError=!0,_.errorMessage=s)}o&&this.base__showMapToastError("There was a problem geocoding some of your events. They have been marked as non-spatial. Please review your schedule.","Geocoding Error"),_.start.isSame(_.end)&&_.end.add(1,"seconds"),s.push(_)})),s},base__instantiateRoute(e,t=[],s=!1){const{routeDepartureTime:a,routeEndTime:i,routeStartTime:o}=this.base__getRouteTimes(e),n=(new y.Z).setRouteStart(o.unix()).setRouteEnd(i.unix()).setWaypoints(t.spatial,!0).setHardBreaks(t.hardBreaks).setSoftBreaks(t.softBreaks).setOptimized(s).setTimeBased(!0).setDirections(!1),{startLocation:r,endLocation:l}=e;return r.isSpatial&&n.setFirst({id:r.id,lat:e.record.StartLocation__Latitude__s,lng:e.record.StartLocation__Longitude__s,flexible:!1,Name:e.record.StartAddress__c,Address__c:e.record.StartAddress__c,duration:0,start:a.unix()}),l.isSpatial&&n.setLast({id:l.id,lat:e.record.EndLocation__Latitude__s,lng:e.record.EndLocation__Longitude__s,flexible:!1,Name:e.record.EndAddress__c,Address__c:e.record.EndAddress__c,duration:0,start:i.unix()}),n},base__getRouteTimes(e){const t=this.base__adjustToUserTimezone(E(e.startTime)),s=this.base__adjustToUserTimezone(E(e.endTime));let a=E(t);if(e.startTime.isSame(E(),"d")&&this.store__addToScheduleExecuted){const e=this.base__adjustToUserTimezone(this.store__staticTime);e.isAfter(a)&&(a=e)}return{routeDepartureTime:t,routeEndTime:s,routeStartTime:a}},base__eventSorter(e,t){const s=60*E.tz(this.$User.timezoneId).utcOffset();return(e.start.utcOffset()?e.start.unix():E(e.start).tz(this.$User.timezoneId).unix()-s)-(t.start.utcOffset()?t.start.unix():E(t.start).tz(this.$User.timezoneId).unix()-s)},base__buildWaypointsFromEvents(e,t){const s={spatial:[],softBreaks:[],hardBreaks:[]},a=[],i=[],o=[];function n(e){const t=[];return e.forEach((e=>{o.forEach((s=>{if(e.start<=s.end&&e.end>=s.start){if(e.start<=s.start&&(e.start=s.start+1),e.end>=s.end){const a={start:e.start,end:s.end-1};a.start<a.end&&t.push(a),e.start=s.end}e.start>s.start&&e.end<s.end&&e.start<e.end&&t.push(e)}}))})),t}return t.forEach((e=>{const t=e.startTime.isUTC()?e.startTime.unix()-60*this.base__adjustToUserTimezone(E(e.startTime)).utcOffset():e.startTime.unix(),s=e.endTime.isUTC()?e.endTime.unix()-60*this.base__adjustToUserTimezone(E(e.endTime)).utcOffset():e.endTime.unix();o.push({start:t,end:s})})),e.forEach((e=>{if(e.flexible)return void s.spatial.push({...e,priority:e.priorityIndex});const t=e.start.isUTC()?e.start.unix()-60*this.base__adjustToUserTimezone(E(e.start)).utcOffset():e.start.unix(),n=e.end.isUTC()?e.end.unix()-60*this.base__adjustToUserTimezone(E(e.end)).utcOffset():e.end.unix();let r=!1;o.forEach((o=>{t<=o.end&&n>=o.start&&!r&&(r=!0,e.excludeFromRoute?e.isBreak?i.push({start:t,end:n}):a.push({start:t,end:n}):(e.verifiedLat||e.lat)&&(e.verifiedLng||e.lng)&&s.spatial.push({id:e.id,Name:e.title,LinkId__c:e.LinkId__c||e.relationshipId,Address__c:e.address,MarkerLayer__c:e.MarkerLayer__c,baseObjectId:e.baseObjectId,lat:e.verifiedLat||e.lat,lng:e.verifiedLng||e.lng,start:t,priority:e.priorityIndex,duration:Math.floor(e.end.unix()-e.start.unix())}))}))})),a.sort(((e,t)=>e.start-t.start)),i.sort(((e,t)=>e.start-t.start)),o.sort(((e,t)=>e.start-t.start)),s.softBreaks=function(e){const t=[],s=[];let a;return e.forEach((e=>{i.forEach((t=>{if(e.start<t.start&&e.end>t.end){const a={start:e.start,end:t.start-1};a.start<a.end&&s.push(a),e.start=t.end+1}else e.start>=t.start&&e.start<=t.end&&(e.start=t.end+1),e.end<=t.end&&e.end>=t.start&&(e.end=t.start-1)})),e.start<e.end&&s.push(e)})),s.sort(((e,t)=>e.start-t.start)),s.forEach((e=>{!a||e.start>a.end?t.push(a=e):e.end>a.end&&(a.end=e.end)})),n(t)}(a),s.hardBreaks=n(i),s.spatial.sort(((e,t)=>e.start-t.start)),s},base__handleRemoteActionError(e,t,s){if(e)return void e(s.message);this.base__callouts&&(this.base__callouts-=1);const a=s?s.message:t.message;this.$emit("error",a)},getTranslatedErrorMessage(e){switch(e.maioCode){case 82004:case 82011:return"There is not enough time to add events to your schedule today. Please add items on a day in the future.";default:return e.message||"Error"}},base__genericPromiseErrorHandler(e){this.base__callouts&&(this.base__callouts-=1),"object"==typeof e?(console.warn(e),this.$emit("error",this.getTranslatedErrorMessage(e))):"string"==typeof e&&this.$emit("error",e)},base__genericPromiseFinallyHandler(){this.base__callouts&&(this.base__callouts-=1)},base__showMapToastError(e,t="Scheduling Error"){T.showError({message:t,subMessage:e,timeOut:1e4,extendedTimeOut:0,closeButton:!0})},base__showEventOnMap(e,t){if(!e.spatial||!t)return;const s=t.getWaypointById(e.id),a=t.getWaypointMarker(s);a&&window.google.maps.event.trigger(a,"click")},base__deleteEvent(e){this.base__$calendar.fullCalendar("removeEvents",e.id),e.recordId?(this.base__eventIdsForDelete.push(e.recordId),this.base__updatedEventsSet.delete(e.id),this.base__hasModifiedEvents=!0):this.base__numEventsReceived--,this.base__events=this.base__events.filter((t=>t.id!==e.id)),this.base__numEventsReceived||this.base__eventIdsForDelete.length||(this.base__hasModifiedEvents=!1,this.base__updatedEventsSet.clear())},base__eventMouseoutHandler(e,t){if(!Object.keys(t).length||this.store__isMonth)return;const s=t.toElement||t.relatedTarget;if(s&&s.classList.contains("slds-dropdown_actions"))return;const a=this.base__events.findIndex((t=>t.id===e.id));-1!==a&&(this.base__events[a].showActionMenu=!1)},base__returnAllEventsToQueue(){const e=window.getProperty(C||{},"Organization.isMAGuideEnabled",!1)||!1;this.base__$calendar.fullCalendar("clientEvents").forEach((t=>{const{guideWaypoint:s={}}=t,{isLocked:a=!1}=s,i=e&&a;t.spatial&&!i&&this.returnEventToQueue(t)}))},base__resetComponentState(e=!1){this.base__storedNavigationAction=null,this.base__performedScrollToLogic=!1,this.base__events=[],e||(this.base__shifts=[]),this.base__eventIdsForDelete=[],this.base__locationIdsForDelete=[],this.base__numEventsReceived=0,this.base__hasModifiedEvents=!1,this.base__hasModifiedShifts=!1,this.base__updatedEventsSet.clear()},base__getBaseDefaultLocationSettings:()=>({distance:0,totaltraveltime:0,skipWatcherLogic:!1,hasError:!1,errorMessage:null,errorTimeString:null}),base__getDefaultLocationSettings(){return{doShow:!1,isSpatial:!1,id:(0,a.ZP)(),dragStartFn:null,...this.base__getBaseDefaultLocationSettings()}},resetComponentState(){console.warn("resetComponentState not implemented in subcomponent")},save(){console.warn("save not implemented in subcomponent")},returnEventToQueue(){console.warn("returnEventToQueue not implemented in subcomponent")},setExcludeInclude(){console.warn("setExcludeInclude not implemented in subcomponent")}}},I=L;var D=s(1900);const A=(0,D.Z)(I,void 0,void 0,!1,null,null,null).exports;var M=s(5262);const $={FAVORITE:Symbol("favorite"),POI:Symbol("poi")},k={components:{Picklist:o.Gp,Popover:o.J2,Spinner:o.$j},props:{locationRef:{type:HTMLElement,required:!0},locationRect:{type:Object,default:null},label:{type:String,required:!0},searchType:{type:String,default:"Start"},selectedHandler:{type:Function,required:!0}},data(){return{isLoading:!1,searchTerm:"",searchResultsRef:null,searches:[{title:"Favorites",options:async e=>{const{results:t}=await M.Z.searchFavorites(e,!0);return t}},{title:this.$Labels.MA_Places,options:async e=>{const{results:t}=await M.Z.searchGoogle(e,!0);return t.map((e=>({Id:e.placeId,Name:e.label,...e}))).filter((e=>"place"===e.type))}}],Search:$}},computed:{isDisabled(){let e=!1;return"Start"===this.type&&(e=!this.$store.state.defaultSettings.defaultStartLocation.overridable),"End"===this.type&&(e=!this.$store.state.defaultSettings.defaultEndLocation.overridable),e}},methods:{closeHandler(){this.isLoading||this.$emit("close")},clearSearch(){this.searchTerm=""},selected(e){if("place"===e.type){this.isLoading=!0;const{places:t}=window.google.maps;new t.PlacesService(window.MA.map).getDetails({placeId:e.Id},((e,s)=>{if(this.isLoading=!1,s!==t.PlacesServiceStatus.OK)throw new Error("failed to load new destination");this.selectedHandler({Name:e.name,Address__c:e.formatted_address,Latitude__c:e.geometry.location.lat(),Longitude__c:e.geometry.location.lng()})}))}else this.selectedHandler({Name:e.Name,Address__c:e.maps__Address__c,Latitude__c:e.maps__Latitude__c,Longitude__c:e.maps__Longitude__c})},detached(e){this.searchResultsRef=e}}},R=(0,D.Z)(k,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Popover",{attrs:{bindTo:e.locationRef,bindToRect:e.locationRect,scrollElementsToIgnore:[e.searchResultsRef]},on:{close:e.closeHandler}},[s("template",{slot:"header"},[e._v(e._s(e.label))]),e._v(" "),s("div",{attrs:{slot:"content"},slot:"content"},[e.isLoading?s("Spinner"):e._e(),e._v(" "),s("Picklist",{attrs:{options:e.searches,filterable:"",titleKey:"Name",idKey:"Id",labels:{search:e.$Labels.MA_Search_for+"...",noSearchResults:e.$Labels.MA_NO_RESULTS_FOUND}},on:{clear:e.clearSearch,"selected-option":e.selected},scopedSlots:e._u([{key:"result",fn:function(t){return s("span",{staticClass:"slds-listbox__option-text_entity slds-listbox__option slds-listbox__option_plain"},[t.type===e.Search.FAVORITE?s("span",[e._v(e._s(e._f("decode")(t.result.Name)))]):t.type===e.Search.POI?s("span",[e._v(e._s(e._f("decode")(t.result.label)))]):e._e()])}}]),model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}})],1)],2)}),[],!1,null,null,null).exports,x={name:"RouteSelector",components:{ActionMenu:o.PC,ActionMenuItem:o.F9,ButtonIcon:o.Ei,Tooltip:o.u},props:{shifts:{type:Array,required:!0}},computed:{...(0,i.mapGetters)("scheduling",["isDayView"]),showSingleButton(){return 1===this.shifts.length&&!this.shifts[0].routing},showActionMenu(){return this.shifts.length&&this.shifts[0].routing}},methods:{getRouteLabel(e){return e.routing?this.$Labels.MA_Remove:this.$Labels.MA_ROUTE},getVisibilityLabel(e){return e.onMap?this.$Labels.MA_Hide:this.$Labels.MA_Show},getShiftTitle(e){let t=`${e.startTime.format("hh:mmA")} - ${e.endTime.format("hh:mmA")}`;return e.isOvernight&&(t+=" (Next Day)"),t},renderVisibilityToggle:e=>e.routing&&Object.keys(e.routing).length}},O=(0,D.Z)(x,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.showSingleButton?s("Tooltip",{key:"1",staticClass:"route-selector-tooltip"},[s("ButtonIcon",{attrs:{slot:"source",iconCategory:"custom",iconName:"custom78",variant:e.isDayView?"brand":"bare",iconSize:"large",assistiveText:e.$Labels.Schedule_Map_My_Schedule_Tooltip_Text,title:e.$Labels.Schedule_Map_My_Schedule_Tooltip_Text},on:{click:function(t){return e.$emit("toggle-route",e.shifts[0])}},slot:"source"}),e._v(" "),s("span",[e._v(e._s(e.$Labels.Schedule_Map_My_Schedule_Tooltip_Text))])],1):e._e(),e._v(" "),e.showActionMenu?s("Tooltip",{key:"2",staticClass:"route-selector-tooltip"},[s("ActionMenu",{attrs:{slot:"source"},slot:"source"},[s("ButtonIcon",{attrs:{slot:"button",iconCategory:"custom",iconName:"custom78",variant:e.isDayView?"brand":"bare",iconSize:"large","aria-haspopup":"true",assistiveText:e.$Labels.Schedule_Map_My_Schedule_Tooltip_Text,title:e.$Labels.Schedule_Map_My_Schedule_Tooltip_Text,more:""},slot:"button"}),e._v(" "),e._l(e.shifts,(function(t,a){return[s("li",{key:t.id,staticClass:"slds-dropdown__header slds-truncate",attrs:{title:"Menu Sub Heading",role:"separator"}},[s("span",[e._v(e._s(e.getShiftTitle(t)))])]),e._v(" "),s("ActionMenuItem",{key:t.id+1,attrs:{label:e.getRouteLabel(t)},on:{click:function(s){return e.$emit("toggle-route",t)}}},[s("span",{staticClass:"slds-truncate"},[s("span",{staticClass:"ma-icon ma-icon-route slds-m-right_x-small"}),e._v("\n                        "+e._s(e.getRouteLabel(t))+"\n                    ")])]),e._v(" "),e.renderVisibilityToggle(t)?s("ActionMenuItem",{key:t.id+2,attrs:{label:e.getVisibilityLabel(t)},on:{click:function(s){return e.$emit("toggle-visibility",t)}}},[s("span",{staticClass:"slds-truncate"},[s("span",{staticClass:"ma-icon ma-icon-preview slds-m-right_x-small"}),e._v("\n                        "+e._s(e.getVisibilityLabel(t))+"\n                    ")])]):e._e(),e._v(" "),a<e.shifts.length-1?s("li",{key:t.id+3,staticClass:"slds-has-divider_top-space",attrs:{role:"separator"}}):e._e()]}))],2),e._v(" "),s("span",[e._v(e._s(e.$Labels.Schedule_Map_My_Schedule_Tooltip_Text))])],1):e._e()],1)}),[],!1,null,"3e111b1b",null).exports,F={name:"ShiftColor",props:{shiftColor:{type:String,required:!0}}},H=(0,D.Z)(F,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container-more",attrs:{disabled:!0}},[s("span",{staticClass:"slds-button__icon slds-button_icon-small ma-icon-rectangle",style:"background-color: "+e.shiftColor+"; color: "+e.shiftColor+";"})])])}),[],!1,null,null,null).exports,N={props:{event:{type:Object,default:()=>{}}}},z=(0,D.Z)(N,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"waypoint-error slds-grid slds-grid_vertical"},[s("p",{staticClass:"slds-p-bottom_xx-small"},[e._v(e._s(e._f("decode")(e.event.errorMessage)))]),e._v(" "),e.event.errorTimeString?s("p",[e._v("Additional time needed: "+e._s(e.event.errorTimeString))]):e._e()])}),[],!1,null,null,null).exports,{MARemoting:P}=window,Y={components:{Picklist:o.Gp},props:{storedSearchTerm:{type:String,default:""}},data(){return{searchTerm:this.storedSearchTerm,searches:[{options:this.getSchedulingResources}]}},computed:{...(0,i.mapGetters)("scheduling",{scheduling__subRoleIdsList:"subRoleIdsList"})},watch:{storedSearchTerm(){this.searchTerm!==this.storedSearchTerm&&(this.searchTerm=this.storedSearchTerm)}},methods:{getSchedulingResources(e){return new Promise(((t,s)=>{(new _.Z).setAction(P.getSchedulingResourcesBySearchTerm).setErrorHandler(this.handleRemoteActionError.bind(this,s)).invoke([e,JSON.stringify(this.scheduling__subRoleIdsList)],(a=>{if(h.Z.debugRemotingData("getSchedulingResourcesBySearchTerm",[e,JSON.stringify(this.scheduling__subRoleIdsList)],a),a.success){const{data:e}=a;t(e)}else console.warn(a),s(new Error(a.error))}))}))},selected(e){this.$emit("selected",e)},errorHandler(e){console.warn("error in MASearch cmp: ",e)},handleRemoteActionError(e,t,s){e(new Error(s.message))}}},U=(0,D.Z)(Y,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"slds-form-element__control slds-input-has-icon slds-input-has-icon_right",attrs:{id:"scheduleUserSelectWrap"}},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("div",{staticClass:"slds-combobox_container"},[s("div",{staticClass:"slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click has-option-selected",attrs:{id:"scheduleUserSelectInputWrap","aria-expanded":"true","aria-haspopup":"listbox",role:"combobox"}},[s("div",{staticClass:"slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"},[s("Picklist",{attrs:{options:e.searches,filterable:"",titleKey:"name",labels:{search:e.$Labels.Schedule_Search_Resources_Text}},on:{clear:function(t){return e.$emit("clear")},"selected-option":e.selected,error:e.errorHandler},scopedSlots:e._u([{key:"result",fn:function(t){return s("span",{staticClass:"slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta",attrs:{id:"listbox-option-unique-id-01",role:"option"}},[s("span",{staticClass:"slds-media__body"},[s("span",{staticClass:"slds-listbox__option-text slds-listbox__option-text_entity"},[e._v(e._s(e._f("decode")(t.result.name)))]),e._v(" "),s("span",{staticClass:"slds-listbox__option-meta slds-listbox__option-meta_entity"},[e._v(e._s(e._f("decode")(t.result.type||"")))])])])}}]),model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}})],1)])])])])])])}),[],!1,null,null,null).exports;var V=s(7102);const W={props:{label:{type:String,required:!0},isSelected:{type:Boolean,required:!0},iconClass:{type:String,required:!0}}},B=(0,D.Z)(W,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("li",{staticClass:"slds-dropdown__item",class:{"slds-is-selected":e.isSelected},on:{click:function(t){return e.$emit("click")}}},[s("a",{attrs:{href:"javascript:void(0);",tabindex:"0"}},[s("span",{staticClass:"slds-truncate"},[s("span",{staticClass:"slds-icon slds-icon_selected slds-icon_x-small slds-icon-text-default slds-m-right_x-small ma-icon ma-icon-check"}),e._v("\n            "+e._s(e.label)+"\n        ")]),e._v(" "),s("span",{staticClass:"slds-icon slds-icon_x-small slds-icon-text-default slds-m-left_small slds-shrink-none ma-icon",class:e.iconClass})])])}),[],!1,null,null,null).exports,{moment:q}=window,j={components:{DatePicker:o.Mt,CalendarViewItem:B},directives:{"click-outside":V.Z},data:()=>({date:q(),currentFormattedFCDate:"",doShowDatetimePicker:!1,showCalendarViewDropdown:!1,CalendarViews:a.YV}),computed:{...(0,i.mapGetters)("scheduling",["isAgendaDay","isAgendaWeek","isMonth","isDayView","isTimelineDay","calendarView","calendarDate"]),advancedFeatureLicenseEnabled:()=>window.advancedFeatureLicenseEnabled,iconClass(){switch(this.calendarView){case a.YV.AGENDA_DAY:return"ma-icon-dayview";case a.YV.AGENDA_WEEK:return"ma-icon-weeklyview";case a.YV.MONTH:return"ma-icon-monthlyview";case a.YV.TIMELINE_DAY:return"ma-icon-kanban";default:return"ma-icon-event"}},clickOutsideOptions(){return{active:this.showCalendarViewDropdown,handler:this.hideCalendarViewDropdown}}},watch:{date(e,t){!e.doEmit&&"boolean"==typeof e.doEmit||e._fullCalendar&&!t._fullCalendar||this.$emit("date-change",e)},calendarDate(e){e&&(this.currentFormattedFCDate=this.getCurrentFormattedFCDate(e),this.date=Object.assign(e,{doEmit:!1}))},calendarView(){this.currentFormattedFCDate=this.getCurrentFormattedFCDate(this.calendarDate)}},created(){this.$bus.$on("render-date-string",(e=>{this.currentFormattedFCDate=this.getCurrentFormattedFCDate(e)}))},destroyed(){this.$bus.$off("render-date-string")},methods:{getCurrentFormattedFCDate(e){const t=this.$User.dateFormat.toUpperCase();let s;if(this.isDayView)s=e.format(t);else if(this.isMonth)s=q(e).format("MMMM YYYY");else if(this.isAgendaWeek){let a=q(e),i=q(e).add(6,"days");const o=e.isoWeekday();7!==o&&(a=q(e).subtract(o,"days"),i=q(e).add(6-o,"days")),s=`${a.format(t)} - ${i.format(t)}`}return s},calendarViewBtnClick(){this.showCalendarViewDropdown=!this.showCalendarViewDropdown},showDatetimePicker(){this.doShowDatetimePicker=!0},hideCalendarViewDropdown(){this.showCalendarViewDropdown=!1},today(){this.$emit("today")},previous(){this.$emit("previous")},next(){this.$emit("next")},changeCalendarView(e){this.hideCalendarViewDropdown(),this.$emit("view-change",e),this.$bus.$emit("resize-map")}}},Z=(0,D.Z)(j,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-col slds-col",attrs:{id:"scheduleHeaderTimeControls"}},[s("div",{staticClass:"slds-p-right_xx-small"},[s("div",{directives:[{name:"click-outside",rawName:"v-click-outside:[clickOutsideOptions]",arg:e.clickOutsideOptions}],staticClass:"slds-dropdown-trigger slds-dropdown-trigger_click",class:{"slds-is-open":e.showCalendarViewDropdown}},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container slds-button_icon-more-flex",on:{click:e.calendarViewBtnClick}},[s("span",{staticClass:"slds-button__icon_large ma-icon",class:e.iconClass}),e._v(" "),s("span",{staticClass:"slds-button__icon_x-small ma-icon ma-icon-down"})]),e._v(" "),s("div",{staticClass:"slds-dropdown slds-dropdown_left slds-dropdown_x-small"},[s("ul",{staticClass:"slds-dropdown__list"},[s("CalendarViewItem",{attrs:{label:e.$Labels.MA_Day,isSelected:e.isAgendaDay,iconClass:"ma-icon-dayview"},on:{click:function(t){return e.changeCalendarView(e.CalendarViews.AGENDA_DAY)}}}),e._v(" "),s("CalendarViewItem",{attrs:{label:e.$Labels.MA_WEEK,isSelected:e.isAgendaWeek,iconClass:"ma-icon-weeklyview"},on:{click:function(t){return e.changeCalendarView(e.CalendarViews.AGENDA_WEEK)}}}),e._v(" "),s("CalendarViewItem",{attrs:{label:e.$Labels.MA_MONTH,isSelected:e.isMonth,iconClass:"ma-icon-monthlyview"},on:{click:function(t){return e.changeCalendarView(e.CalendarViews.MONTH)}}}),e._v(" "),e.advancedFeatureLicenseEnabled?s("CalendarViewItem",{attrs:{label:e.$Labels.MA_RESOURCE,isSelected:e.isTimelineDay,iconClass:"ma-icon-kanban"},on:{click:function(t){return e.changeCalendarView(e.CalendarViews.TIMELINE_DAY)}}}):e._e()],1)])])]),e._v(" "),s("div",{staticClass:"slds-p-right_xx-small"},[s("button",{staticClass:"slds-button slds-button_neutral slds-button_compact",on:{click:e.today}},[e._v("\n            "+e._s(e.$Labels.MA_TODAY)+"\n        ")])]),e._v(" "),s("div",{staticClass:"slds-button-group slds-p-right_xx-small prev-next-button-group"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:e.previous}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-chevronleft"})]),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:e.next}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-chevronright"})])]),e._v(" "),s("div",[s("button",{ref:"currentDateBtn",staticClass:"slds-button",on:{click:e.showDatetimePicker}},[e._v("\n            "+e._s(e.currentFormattedFCDate)+"\n        ")]),e._v(" "),s("DatePicker",{attrs:{locale:e.$User.UserLocale,dateFormat:e.$User.dateFormat.toUpperCase(),showInputField:!1,refToIgnoreClickOutside:e.$refs.currentDateBtn,showCalendarSync:e.doShowDatetimePicker,labels:{previousMonth:e.$Labels.MA_Previous_Month,nextMonth:e.$Labels.MA_Next_Month,selectDate:e.$Labels.MA_Select_A_Date,pickYear:e.$Labels.MA_Pick_A_Year,today:e.$Labels.MA_TODAY}},on:{"update:showCalendarSync":function(t){e.doShowDatetimePicker=t},"update:show-calendar-sync":function(t){e.doShowDatetimePicker=t}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)])}),[],!1,null,"3b77de69",null).exports;var G=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-new-custom95",staticStyle:{marginTop:"4px"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-new-custom95",staticStyle:{marginTop:"4px"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",{staticClass:"ma-icon ma-icon-move"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("figure",{staticClass:"slds-m-bottom_small"},[t("img",{attrs:{src:s(1132)}})])}];const Q={components:{ProgressRing:o.eL,Tooltip:o.u},props:{value:{type:Number|String,required:!0},fieldLabel:{type:String,required:!0},priorityIndex:{type:Number|String,required:!0}},methods:{async source(){return await this.$nextTick(),this.$el.parentNode}}},K=(0,D.Z)(Q,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Tooltip",{staticClass:"slds-popover_tooltip_einstein",attrs:{assistiveText:e.$Labels.MA_HELP,source:e.source}},[a("div",{staticClass:"slds-grid slds-grid_vertical-align-center"},[a("div",{staticClass:"slds-p-right_small"},[a("ProgressRing",{attrs:{percent:e.value,ringContentType:100===e.value?e.icon:e.percentage,theme:100===e.value?"complete":"base"}})],1),e._v(" "),a("div",{staticClass:"slds-col"},[a("div",{staticClass:"einstein-field-name"},[e._v(e._s(e._f("decode")(e.fieldLabel)))]),e._v(" "),a("div",{staticClass:"einstein-tooltip_field"},[e._v("Priority "+e._s(e._f("decode")(e.priorityIndex)))])]),e._v(" "),a("div",{staticClass:"einstein-figure"},[a("img",{attrs:{src:s(4283),alt:"Einstein"}})])])])}),[],!1,null,"5ab7de02",null).exports,{MA:J,MASystem:X}=window,ee={components:{Tooltip:o.u},props:{value:{type:Number|String,required:!0},fieldLabel:{type:String,required:!0},sfdcFieldType:{type:String,default:"number"},priorityIndex:{type:Number|String,required:!0}},computed:{formattedValue(){let e=this.value;try{e=J.Util.formatNumberString(e)}catch(e){}return"currency"===this.sfdcFieldType&&(e=`${window.getProperty(X,"User.CurrencySymbol",!1)||"$"}${e}`),e}},methods:{async source(){return await this.$nextTick(),this.$el.parentNode}}},te=(0,D.Z)(ee,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Tooltip",{staticClass:"slds-popover_tooltip_pardot",attrs:{assistiveText:e.$Labels.MA_HELP,source:e.source}},[a("div",{staticClass:"slds-grid"},[a("div",{staticClass:"slds-col slds-p-right_x-large"},[a("div",{staticClass:"pardot-tooltip_value"},[e._v(e._s(e._f("decode")(e.formattedValue)))]),e._v(" "),a("div",{staticClass:"pardot-tooltip_field"},[e._v(e._s(e._f("decode")(e.fieldLabel)))]),e._v(" "),a("div",{staticClass:"pardot-tooltip_priority-field slds-p-bottom_small"},[e._v("Priority "+e._s(e._f("decode")(e.priorityIndex)))])]),e._v(" "),a("div",{staticClass:"pardot-figure"},[a("img",{attrs:{src:s(2263),alt:"Pardot"}})])])])}),[],!1,null,"3ec45ca2",null).exports,{MA:se,MASystem:ae}=window,ie={components:{Tooltip:o.u},props:{value:{type:Number|String,required:!0},fieldLabel:{type:String,required:!0},sfdcFieldType:{type:String,default:"number"},priorityIndex:{type:Number|String,required:!0}},data:()=>({mounted:!1}),computed:{formattedValue(){let e=this.value;try{e=se.Util.formatNumberString(e)}catch(e){}return"currency"===this.sfdcFieldType&&(e=`${window.getProperty(ae,"User.CurrencySymbol",!1)||"$"}${e}`),e}},mounted(){this.mounted=!0},methods:{async source(){return await this.$nextTick(),this.$el.parentNode}}},oe=(0,D.Z)(ie,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Tooltip",{staticClass:"slds-popover_tooltip_priority",attrs:{assistiveText:e.$Labels.MA_HELP,source:e.source}},[s("div",{staticClass:"slds-popover__body slds-grid slds-grid_vertical-align-center"},[s("div",{staticClass:"slds-p-right_small"},[s("div",{staticClass:"priority-tooltip_icon"},[s("span",{staticClass:"ma-icon ma-icon-arrowup"})])]),e._v(" "),s("div",{staticClass:"slds-col"},[s("div",{staticClass:"priority-tooltip_value"},[e._v(e._s(e._f("decode")(e.formattedValue)))]),e._v(" "),s("div",{staticClass:"priority-tooltip_field"},[e._v(e._s(e._f("decode")(e.fieldLabel)))]),e._v(" "),s("div",{staticClass:"priority-tooltip_priority-field"},[e._v("Priority "+e._s(e._f("decode")(e.priorityIndex)))])])])])}),[],!1,null,"4033812c",null).exports,{$:ne,moment:re}=window,le={components:{ActionMenu:o.PC,ActionMenuItem:o.F9,Einstein:K,Pardot:te,Priority:oe,Tooltip:o.u},props:{allowOptimization:{type:Boolean,required:!0},shifts:{type:Array,required:!1,default:()=>[]}},data:()=>({CalendarViews:a.YV,optimizationDays:[]}),computed:{...(0,i.mapGetters)("tabs",{tabs__isTabActive:"isTabActive"}),...(0,i.mapGetters)("scheduling",{store__queue:"queue",store__isQueueCollapsed:"isQueueCollapsed",store__calendarView:"calendarView",store__isTimelineDay:"isTimelineDay",store__calendarDate:"calendarDate",store__isAgendaWeek:"isAgendaWeek",store__columnIdsForOptimization:"columnIdsForOptimization",store__hasOverlappingShifts:"hasOverlappingShifts"}),queueLength(){return this.store__queue.length},doDisableOptimizationDueToInvalidDuration(){return this.$parent.routeDefaults&&this.$parent.routeDefaults.duration<15},multipleShifts(){return this.shifts.length>1}},watch:{queueLength(e,t){e!==t&&this.$nextTick(this.addDraggableStateToQueueItems)},store__calendarView:{handler(){this.$nextTick((()=>{this.store__isAgendaWeek&&(this.store__clearColumnIdsForOptimization(),this.optimizationDays=this.getOptimizationDays()),this.addDraggableStateToQueueItems()}))},immediate:!0},store__calendarDate(){this.store__isAgendaWeek&&(this.store__clearColumnIdsForOptimization(),this.optimizationDays=this.getOptimizationDays())}},mounted(){this.$nextTick(this.addDraggableStateToQueueItems)},created(){this.$bus.$on("add-to-schedule",this.addItemsToQueue)},destroyed(){this.$bus.$off("add-to-schedule",this.addItemsToQueue)},methods:{daySelected(e,t){t.currentTarget.checked?this.store__columnIdsForOptimization[e]=null:delete this.store__columnIdsForOptimization[e]},...(0,i.mapActions)("scheduling",{store__removeItemFromQueueById:"removeItemFromQueueById",store__clearQueue:"clearQueue",store__addItemToQueue:"addItemToQueue",store__toggleScheduleQueue:"toggleScheduleQueue",store__clearColumnIdsForOptimization:"clearColumnIdsForOptimization"}),...(0,i.mapMutations)("scheduling",{store__setUnsupportedItems:"setUnsupportedItems",store__setAddToScheduleExecuted:"setAddToScheduleExecuted"}),...(0,i.mapMutations)("tabs",{tabs__setTab:"setTab"}),getOptimizationDays(){const e=re.localeData(this.locale),t=e.weekdaysMin();let s,a=Object.entries(this.$parent.base__columnIdToDayInstance).map((e=>{const s=e[0],a=e[1],i=re.tz(this.$User.timezoneId);return{columnId:s,label:t["-1"===s?6:s].charAt(0),checked:!1,disabled:void 0===a.calendarDate.isBefore||a.calendarDate.isBefore(i,"d")}}));return a=a.concat(a.splice(0,e.firstDayOfWeek())),a.forEach(((e,t)=>{"-1"===e.columnId&&(s=t)})),null!=s&&a.splice(s),a},getPriorityComponent(e){switch(e){case"Einstein":case"Pardot":return e;default:return"Priority"}},addDraggableStateToQueueItems(){const e=ne("#schedulePanelBody");this.store__queue.forEach(((t,s)=>{const a=this.$refs[`item${s}`];ne(a).data("event",Object.assign(t,{stick:!1,className:t.excludeFromRoute?"non-spatial-cell":"eventCell"})).draggable({appendTo:e,containment:e,scroll:!0,helper:"clone",revert:!0,revertDuration:0,zIndex:999,start:()=>{this.doDisableOptimizationDueToInvalidDuration&&window.MAToastMessages.showError({message:"Events must have a default duration of at least 15 minutes to use the Add to Schedule feature. You can edit the default event duration in your global settings.",timeOut:7e3,closeButton:!0})}})}))},optimizeRoute(e){this.store__setAddToScheduleExecuted(!0),window.trackUsage("Maps",{action:"Plot Schedule",description:"Plotting a Schedule"}),this.$emit("optimize",e)},addItemsToQueue(e){function t(e,t){let s=!1;return s=e.isMALocation?e.placeId===t.placeId:e.relationshipId===t.relationshipId,s}this.tabs__isTabActive(a.mQ.SCHEDULING)||this.tabs__setTab(a.mQ.SCHEDULING);const s=[];this.store__calendarView===a.YV.MONTH&&this.$store.commit("setView",a.YV.AGENDA_DAY);let i=!1;e.forEach((e=>{if(700===this.store__queue.length)return void(i=!0);if(void 0!==e.isSupported&&!e.isSupported)return void s.push({title:e.marker.title,baseObjectLabel:e.baseObjectLabel});e.LinkId__c&&(e.relationshipId=e.LinkId__c);const o=null!=e.lat&&null!=e.lng;e.spatial=o,e.showActionMenu=!1,e.excludeFromRoute=!o,o||(e.className="non-spatial-cell"),e.id=(0,a.ZP)(),e.Name=e.title,e.baseObjectId=e.baseObjectId;const{marker:n={}}=e;e.Address__c=n.address||n.FormattedAddress_MA||e.Address__c;const{prioritySettings:{type:r="",label:l="",sfdcFieldType:d="number",sfdcFieldValue:c=0}={}}=e.marker;e.priorityValue=c,e.priority=0,e.priorityType=r,e.priorityLabel=l,e.priorityFieldType=d,delete e.marker,delete e.supportsActivities,delete e.baseObjectLabel,this.store__queue.find(t.bind(this,e))||this.store__addItemToQueue(e)})),s.length&&this.store__setUnsupportedItems(s),this.store__isQueueCollapsed&&this.store__toggleScheduleQueue(),i&&r.Z.showErrorMessage(82700,r.D.SCHEDULE)},getShiftTitle(e){let t=`${e.startTime.format("hh:mmA")} - ${e.endTime.format("hh:mmA")}`;return e.isOvernight&&(t+=" (Next Day)"),t}}},de=(0,D.Z)(le,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"schedulePanelQueueWrap"}},[s("div",{staticClass:"ma-schedule-queue"},[s("div",{attrs:{id:"schedulePanelQueueHeader"}},[s("div",{staticClass:"slds-grid slds-p-left_small slds-p-right_x-small slds-p-top_x-small"},[s("div",{staticClass:"slds-col queue-header-label",attrs:{title:e.store__queue.length+" "+e.$Labels.MA_STOPS+" "+e.$Labels.MA_SCHEDULE_TO_BE_SCHEDULED}},[s("h3",[e._v(e._s(e.$Labels.MA_SCHEDULE_TO_BE_SCHEDULED))])]),e._v(" "),s("ActionMenu",{attrs:{showMoreLabel:e.$Labels.MA_SHOW_MORE}},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",attrs:{slot:"button"},slot:"button"},[s("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.MA_REMOVE_ALL},on:{click:e.store__clearQueue}})],1)],1),e._v(" "),e.store__queue.length&&e.allowOptimization&&e.store__isAgendaWeek?s("div",{staticClass:"schedule-week_optimize-day-checkboxes"},e._l(e.optimizationDays,(function(t,a){return s("div",{key:a,staticClass:"optimize-checkbox"},[s("label",{attrs:{for:"checkbox"+a}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"day.checked"}],attrs:{id:"checkbox"+a,disabled:t.disabled,type:"checkbox"},domProps:{checked:Array.isArray(t.checked)?e._i(t.checked,null)>-1:t.checked},on:{click:function(t){return e.daySelected(a,t)},change:function(s){var a=t.checked,i=s.target,o=!!i.checked;if(Array.isArray(a)){var n=e._i(a,null);i.checked?n<0&&e.$set(t,"checked",a.concat([null])):n>-1&&e.$set(t,"checked",a.slice(0,n).concat(a.slice(n+1)))}else e.$set(t,"checked",o)}}}),e._v(" "),s("div",{staticClass:"faux-checkbox"},[e._v(e._s(t.label))])])])})),0):e._e(),e._v(" "),e.store__queue.length&&e.allowOptimization?s("div",{staticClass:"schedule-queue-header-action-wrap slds-p-horizontal_small"},[e.multipleShifts?s("button",{staticClass:"slds-button slds-button_brand slds-grid slds-grid_align-center",attrs:{slot:"button",disabled:e.doDisableOptimizationDueToInvalidDuration||e.store__hasOverlappingShifts||e.store__isAgendaWeek&&!Object.keys(e.store__columnIdsForOptimization).length,forceLeft:!0,"data-pendo":"schedule-queue_add-to-schedule"},on:{click:function(t){return e.optimizeRoute()}},slot:"button"},[s("div",{staticClass:"slds-grid slds-grid_align-center"},[e._m(1),e._v(" "),s("div",[e._v("\n                            "+e._s(e.$Labels.MA_ADD_TO_SCHEDULE)+"\n                        ")])])]):s("button",{staticClass:"slds-button slds-button_brand slds-grid slds-grid_align-center",attrs:{disabled:e.doDisableOptimizationDueToInvalidDuration||e.store__hasOverlappingShifts||e.store__isAgendaWeek&&!Object.keys(e.store__columnIdsForOptimization).length,"data-pendo":"schedule-queue_add-to-schedule"},on:{click:function(t){return e.optimizeRoute(e.shifts[0].id)}}},[s("div",{staticClass:"slds-grid slds-grid_align-center"},[e._m(0),e._v(" "),s("div",[e._v("\n                            "+e._s(e.$Labels.MA_ADD_TO_SCHEDULE)+"\n                        ")])])]),e._v(" "),e.doDisableOptimizationDueToInvalidDuration?s("Tooltip",{attrs:{alignment:"top right",assistiveText:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-text-align_left",staticStyle:{"white-space":"normal"}},[e._v("\n                        Events must have a default duration of at least 15 minutes to use the Add to Schedule feature. You can edit the default event duration in your global settings.\n                    ")])]):e._e()],1):e._e()]),e._v(" "),s("div",{attrs:{id:"schedulePanelQueueBody"}},[s("div",{attrs:{id:"schedulePanelQueueListWrap"}},[e.store__queue.length?s("ul",e._l(e.store__queue,(function(t,a){return s("li",{key:a,ref:"item"+a,refInFor:!0,staticClass:"schedule-queue-list-item"},[e._m(2,!0),e._v(" "),s("div",{staticClass:"schedule-queue-item-text"},[e._v(e._s(e._f("decode")(t.title)))]),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_icon remove-queue-item",on:{click:function(s){return e.store__removeItemFromQueueById(t.id)}}},[s("span",{staticClass:"ma-icon ma-icon-remove"})])]),e._v(" "),t.priorityType?s("div",{directives:[{name:"show",rawName:"v-show",value:!e.store__isTimelineDay,expression:"!store__isTimelineDay"}]},[s("span",{staticClass:"slds-button slds-button_icon priority-queue-item"},[s(e.getPriorityComponent(t.priorityType),{tag:"component",attrs:{value:t.priorityValue,fieldLabel:t.priorityLabel||"",sfdcFieldType:t.priorityFieldType||"number",priorityIndex:t.priority}}),e._v(" "),s("span",{staticClass:"ma-icon"},[e._v(e._s(e._f("decode")(t.priority)))])],1)]):e._e()])})),0):e._e(),e._v(" "),e.store__queue.length?e._e():s("div",{staticClass:"scheduleQueueEmptyState slds-grid slds-grid_vertical-align-center"},[s("div",{staticClass:"slds-notify_container--inline slds-p-around--large slds-text-align--center"},[e._m(3),e._v(" "),s("h4",[e._v(e._s(e.$Labels.MA_SCHEDULE_NOTHING_TO_ADD_TO_YOUR_SCHEDULE))]),e._v(" "),s("p",[e._v(e._s(e.$Labels.MA_SCHEDULE_USE_ADD_TO_SCHEDULE_TO_ADD_MARKERS_TO_THIS_AREA_TEXT))]),e._v(" "),s("br"),e._v(" "),s("p",[e._v(e._s(e.$Labels.MA_SCHEDULE_USE_ADD_TO_SCHEDULE_TO_ADD_MARKERS_TO_THIS_AREA_SECOND_SENTENCE_TEXT))])])])]),e._v(" "),s("button",{staticClass:"slds-button slds-button_icon slds-split-view__toggle-button has-hover-tooltip hover-tooltip-750-delay",on:{click:e.store__toggleScheduleQueue}},[s("span",{staticClass:"slds-button__icon js-transition-fix slds-button__icon_x-small ma-icon ma-icon-left"}),e._v(" "),s("div",{staticStyle:{position:"relative"}},[s("div",{staticClass:"slds-popover slds-popover_tooltip slds-nubbin_left",staticStyle:{position:"absolute",top:"-20px",left:"calc(100% + 16px)"}},[s("div",{staticClass:"slds-popover__body",staticStyle:{"white-space":"nowrap"}},[e._v("\n                            "+e._s(e.$Labels.MA_COLLAPSE_EXPAND_QUEUE)+"\n                        ")])])])])])])])}),G,!1,null,"7bfd7f52",null).exports,ce=(0,D.Z)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"labor-law-notification slds-notify_container slds-notify_container--inline"},[s("div",{staticClass:"slds-notify slds-notify--alert slds-theme--warning slds-theme--alert-texture slds-banner"},[s("h2",[e._v(e._s(e.$Labels.MA_Labor_Laws))])])])}),[],!1,null,"319095c9",null).exports,{moment:ue}=window,_e={components:{Modal:o.u_,Checkbox:o.XZ,DatePicker:o.Mt},data:()=>({doCloneStartEndLocations:!1,cloneTargetDate:ue()}),computed:{disableStartEndLocationToggle(){let e=!0;const t=document.querySelector('#schedulePanelCalendarWrap .ma-calendar-location-start:not([style*="display:none"]):not([style*="display: none"])'),s=document.querySelector('#schedulePanelCalendarWrap .ma-calendar-location-end:not([style*="display:none"]):not([style*="display: none"])');return null===t&&null===s||(e=!1),e}}},he=(0,D.Z)(_e,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{staticClass:"ma-import-events-modal",attrs:{title:e.$Labels.MA_Clone_Schedule,labels:{close:e.$Labels.MA_Close}},on:{close:function(t){return e.$emit("cancel")}}},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_align-center slds-grid_vertical-align-center",attrs:{slot:"content"},slot:"content"},[s("DatePicker",{attrs:{locale:e.$User.UserLocale,dateFormat:e.$User.dateFormat.toUpperCase(),showInputField:!1,displayAsStatic:"",labels:{previousMonth:e.$Labels.MA_Previous_Month,nextMonth:e.$Labels.MA_Next_Month,selectDate:e.$Labels.MA_Select_A_Date,pickYear:e.$Labels.MA_Pick_A_Year,today:e.$Labels.MA_TODAY}},model:{value:e.cloneTargetDate,callback:function(t){e.cloneTargetDate=t},expression:"cloneTargetDate"}}),e._v(" "),s("Checkbox",{staticClass:"slds-grid_align-center slds-p-top_x-small",attrs:{disabled:e.disableStartEndLocationToggle,labels:{name:"Clone Start and End Locations"},slide:""},model:{value:e.doCloneStartEndLocations,callback:function(t){e.doCloneStartEndLocations=t},expression:"doCloneStartEndLocations"}})],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(t){return e.$emit("cancel")}}},[e._v("\n            "+e._s(e.$Labels.MA_Cancel)+"\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:function(t){return e.$emit("clone",e.cloneTargetDate,e.doCloneStartEndLocations)}}},[e._v("\n            "+e._s(e.$Labels.MA_Clone)+"\n        ")])])])}),[],!1,null,"69afacca",null).exports,me={components:{Modal:o.u_},props:{showModal:{type:Boolean,required:!0}},methods:{hidePendingChangeModal(){this.$emit("update:showModal",!1)},completeNavigationRequest(){this.hidePendingChangeModal(),this.$emit("discard")},saveAndCompleteNavigationRequest(){this.hidePendingChangeModal(),this.$emit("save")}}},fe=(0,D.Z)(me,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.showModal?s("Modal",{staticClass:"schedule-discard-changes-modal",attrs:{title:e.$Labels.MA_SCHEDULE_SAVE_SCHEDULE_CHANGES_PROMPT,labels:{close:e.$Labels.MA_Close}},on:{close:e.hidePendingChangeModal}},[s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.hidePendingChangeModal}},[e._v("\n            "+e._s(e._f("decode")(e.$Labels.MA_Cancel))+"\n        ")]),e._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.completeNavigationRequest}},[e._v("\n            "+e._s(e._f("decode")(e.$Labels.MA_Close_Discard))+"\n        ")])])]):e._e()}),[],!1,null,"158e1b4d",null).exports,ve={components:{Modal:o.u_},props:{errors:{type:Object,required:!0}},data:()=>({saveEnabled:!1,selectedConfigId:""}),computed:{showConfigChoices(){return this.errors&&Object.keys(this.errors).length&&"multiple"===this.errors[Object.keys(this.errors)[0]].type},showConfigError(){return this.errors&&"none"===this.errors.type&&Object.keys(this.errors).length},showWarnings(){return this.errors&&"warning"===this.errors.type&&Object.keys(this.errors).length},title(){return this.showConfigChoices?"Save Schedule":"Cannot Save Events to Schedule"},cancelLabel(){return this.showConfigChoices||this.showWarnings?this.$Labels.MA_Cancel:"Got it"},cancelClass(){return this.showConfigChoices?"slds-button_neutral":"slds-button_brand"},firstKey(){return this.showConfigChoices?Object.keys(this.errors)[0]:null},firstError(){return this.firstKey?this.errors[this.firstKey]:null},eventIds(){return this.firstError?this.firstError.eventIds:[]},sObjectLabel(){return this.firstError?this.firstError.sObjectLabel:null},options(){return this.firstError?this.firstError.options:[]}},methods:{hide(){this.$emit("hide")},ignore(){this.$emit("ignore"),this.hide()},save(){this.$emit("save",{eventIds:this.eventIds,configId:this.selectedConfigId}),this.hide()},select(e){this.saveEnabled=!0,this.selectedConfigId=e.id}}},be=(0,D.Z)(ve,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{attrs:{title:e.title,labels:{close:e.$Labels.MA_Close}},on:{close:e.hide}},[s("div",{attrs:{slot:"content"},slot:"content"},[e.showConfigChoices?s("div",{key:"config-choices",staticClass:"page-wrap slds-brand-band slds-grid slds-grid_vertical"},[s("div",{staticClass:"slds-inline_icon_text slds-grid slds-m-bottom_large"},[s("span",{staticClass:"slds-icon slds-icon--small slds-m-right--small slds-col slds-no-flex ma-icon ma-icon-info",attrs:{"aria-hidden":"true"}}),e._v(" "),s("div",{staticClass:"slds-col slds-align-middle"},[s("p",[e._v("\n                        You have multiple event configurations that are related to "),s("span",{staticClass:"slds-text-color_default"},[s("strong",[e._v(e._s(e.firstError.sObjectLabel))])]),e._v(". What would you like to save these Schedule Events as?\n                    ")])])]),e._v(" "),e._l(e.options,(function(t,a){return s("a",{key:a,staticClass:"slds-box slds-box_link slds-box_x-small slds-m-bottom_x-small",class:{"slds-is-active":e.selectedConfigId===t.id},attrs:{href:"javascript:void(0);"},on:{click:function(s){return e.select(t)}}},[s("div",{staticClass:"slds-p-around_x-small"},[s("h2",{staticClass:"slds-truncate slds-text-heading_small slds-m-bottom_x-small"},[e._v(e._s(e._f("decode")(t.name)))]),e._v(" "),s("div",{staticClass:"slds-grid slds-m-top_x-small"},[s("div",{staticClass:"slds-col slds-size_1-of-2 slds-p-right_small"},[s("div",{staticClass:"slds-text-color_weak slds-text-body_small"},[e._v("Object")]),e._v(" "),s("div",[e._v(e._s(t.objectLabel))])]),e._v(" "),s("div",{staticClass:"slds-col slds-size_1-of-2"},[s("div",{staticClass:"slds-text-color_weak slds-text-body_small"},[e._v("Related To")]),e._v(" "),s("div",[e._v(e._s(e.firstError.baseObjectLabel))])])])])])}))],2):e.showConfigError?s("div",{key:"no-config"},[s("div",{staticClass:"slds-p-around_medium"},[s("div",{staticClass:"slds-text-heading_small slds-p-bottom_medium"},[e._v("Your org doesn't have Events related to "),s("strong",[e._v(e._s(e.errors.sObjectLabel))]),e._v(" configured for use in Maps.")]),e._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-p-bottom_medium"},[s("div",{staticClass:"slds-col slds-border_bottom"}),e._v(" "),s("div",{staticClass:"slds-p-horizontal_x-large"},[s("span",[e._v("OR")])]),e._v(" "),s("div",{staticClass:"slds-col slds-border_bottom"})]),e._v(" "),s("div",{staticClass:"slds-text-heading_small slds-p-bottom_large"},[e._v("The Marker Layer records you are trying to save as Events use a different base object than your org's configuration for Events related to "),s("strong",[e._v(e._s(e.errors.sObjectLabel))]),e._v(".")]),e._v(" "),s("div",{staticClass:"slds-box"},[s("div",{staticClass:"slds-inline_icon_text slds-grid"},[s("div",{staticClass:"slds-icon slds-icon--large slds-col slds-p-right_small"},[s("span",{staticClass:"slds-inline__icon ma-icon ma-icon-info",staticStyle:{"font-size":"24px"}})]),e._v(" "),s("div",{staticClass:"slds-col slds-align-middle slds-m-bottom_xx-small"},[s("p",{staticClass:"slds-text-color_default"},[s("b",[e._v("How to Resolve")])]),e._v(" "),s("p",{staticClass:"slds-text-color_weak"},[e._v("Ask your Salesforce Administrator to enable Events for this related object in "),s("strong",[e._v("Maps Configuration")]),e._v(" > "),s("strong",[e._v("Routes & Schedule")])])])])])])]):e.showWarnings?s("div",{key:"save-warnings"},[s("div",{staticClass:"slds-p-around_medium"},[s("div",{staticClass:"slds-text-heading_small slds-p-bottom_medium"},[e._v("The following issues were found during Save.  If you continue with Saving, certain data may not be updated properly.")]),e._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-p-bottom_medium"}),e._v(" "),s("div",{staticClass:"slds-text-heading_small slds-p-bottom_large"},[e._v(e._s(e._f("decode")(e.errors.warnings.join("\n"))))]),e._v(" "),s("div",{staticClass:"slds-box"},[s("div",{staticClass:"slds-inline_icon_text slds-grid"},[s("div",{staticClass:"slds-icon slds-icon--large slds-col slds-p-right_small"},[s("span",{staticClass:"slds-inline__icon ma-icon ma-icon-info",staticStyle:{"font-size":"24px"}})]),e._v(" "),s("div",{staticClass:"slds-col slds-align-middle slds-m-bottom_xx-small"},[s("p",{staticClass:"slds-text-color_default"},[s("b",[e._v("How to Resolve")])]),e._v(" "),s("p",{staticClass:"slds-text-color_weak"},[e._v("Ask your Salesforce Administrator to fix the listed issues")])])])])])]):e._e()]),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button",class:e.cancelClass,on:{click:e.hide}},[e._v("\n            "+e._s(e._f("decode")(e.cancelLabel))+"\n        ")]),e._v(" "),e.showConfigChoices?s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!e.saveEnabled},on:{click:e.save}},[e._v("\n            "+e._s(e.$Labels.MA_Save)+"\n        ")]):e._e(),e._v(" "),e.showWarnings?s("button",{staticClass:"slds-button slds-button_brand",on:{click:e.ignore}},[e._v("\n            "+e._s(e.$Labels.MA_Save)+"\n        ")]):e._e()])])}),[],!1,null,"77b0b98c",null).exports,{$:pe,moment:ge,MA:Se}=window,ye=new Map;ye.set(0,{hex:"00DBBD",class:"background-color--robins-egg-blue"}),ye.set(1,{hex:"3188EF",class:"background-color--dodger-blue"}),ye.set(2,{hex:"FFB34C",class:"background-color--koromiko-orange"}),ye.set(3,{hex:"DE6DE4",class:"background-color--medium-orchid"}),ye.set(4,{hex:"FA8072",class:"background-color--salmon"}),ye.set(5,{hex:"00E67B",class:"background-color--spring-green"}),ye.set(6,{hex:"7BBCF6",class:"background-color--maya-blue"});const Ee=(0,a.ZP)(),Ce=window.FullCalendar.DragListener.prototype;var Te;Te=Ce.startDrag,Ce.startDrag=function(...e){e[0].target.classList.contains("ma-calendar-location")||Te.apply(this,e)};const we={components:{ActionMenu:o.PC,ActionMenuItem:o.F9,LocationSearch:R,MAActionMenu:m.rK,MAActionMenuItem:m.y1,RouteTimeAndDistance:u.Z,RouteSummary:c.Z,RouteSelector:O,ShiftColor:H,EventError:z,ResourceSearch:U,CalendarControls:Z,Queue:de,LaborLawNotify:ce,CloneEventsModal:he,PendingChangeModal:fe,SaveErrorModal:be,Einstein:K,Pardot:te,Priority:oe},extends:A,data(){return{routeDefaults:null,travelMode:"",counter:0,showCloneScheduleModal:!1,Location:{START:Symbol("start"),END:Symbol("end")},actionMenu:{doRender:!1,doShow:!1,bindRef:null,activeEl:null,activeColumnId:null,activeTimeString:null,showStart:!0,showEnd:!0},isGuideUser:window.MASystem.Organization.isMAGuideEnabled,locationSearch:this.getDefaultLocationSearchSettings(),activeDrag:{columnId:null,type:null,rangeValidator:null},unwatchers:[],skipCalendarDateWatcherLogic:!1,dropZoneListeners:new Map,locationType:"Start"}},computed:{...(0,i.mapGetters)("scheduling",{store__columnIdsForOptimization:"columnIdsForOptimization",store__hasOverlappingShifts:"hasOverlappingShifts",store__staticTime:"staticTime"}),columnIds(){switch(this.store__calendarView){case a.YV.AGENDA_DAY:return[0];case a.YV.AGENDA_WEEK:return[-1,0,1,2,3,4,5,6];default:return[]}},locationSearchAsString(){return this.locationSearch.type===this.Location.START?"Start":"End"},isActionMenuDisabled(){return!0===this.locationSearch.doRender},modalErrors(){return Object.keys(this.base__configErrors).length?this.base__configErrors:Object.keys(this.base__saveWarnings).length?this.base__saveWarnings:{}},dayViewRoute(){return this.store__isAgendaDay?(this.base__shifts.find((e=>null!=e.routing))||{}).route:null},doDisableOptimizationDueToInvalidDuration(){return this.routeDefaults&&this.routeDefaults.duration<15}},watch:{travelMode(){},store__calendarDate(e){this.skipCalendarDateWatcherLogic&&(this.skipCalendarDateWatcherLogic=!1),this.store__calendarView!==a.YV.TIMELINE_DAY&&this.base__$calendar.fullCalendar("gotoDate",e),this.store__calendarView===a.YV.AGENDA_WEEK&&this.resizeWeekHeader()},store__calendarView(e){this.$nextTick((()=>{e!==a.YV.TIMELINE_DAY&&this.base__$calendar.fullCalendar("changeView",e,ge(this.store__calendarDate)),e===a.YV.AGENDA_WEEK&&this.resizeWeekHeader(),this.base__emitViewModeChangeEvent(e)}))},columnIds:{handler(e){Object.keys(this.base__columnIdToDayInstance).forEach((e=>{delete this.base__columnIdToDayInstance[e]})),0!==e.length&&e.forEach((e=>{this.$set(this.base__columnIdToDayInstance,e,Object.assign(this.getDefaultDayInstance(),{columnId:e}))}))},immediate:!0}},created(){this.$bus.$on("hide-plotted-schedule",this.toggleMapOff),this.$bus.$on("user-settings-updated",this.updateDefaultDuration),this.$bus.$on("rerenderAgendaCalendar",this.rerenderAgendaCalendar);const e=this;window.FullCalendar.View.prototype.stopNowIndicator=function(){this.nowIndicatorTimeoutID&&(clearTimeout(this.nowIndicatorTimeoutID),this.nowIndicatorTimeoutID=null),this.nowIndicatorIntervalID&&(clearInterval(this.nowIndicatorIntervalID),this.nowIndicatorIntervalID=null)},window.FullCalendar.View.prototype.updateNowIndicator=function(){this.isDatesRendered&&this.initialNowDate&&(this.unrenderNowIndicator(),this.renderNowIndicator(this.initialNowDate.clone().add(e.store__staticTime)),this.isNowIndicatorRendered=!0)}},beforeDestroy(){this.base__$calendar.fullCalendar("destroy")},destroyed(){this.$bus.$off("hide-plotted-schedule",this.toggleMapOff),this.$bus.$off("user-settings-updated",this.updateDefaultDuration),this.$bus.$off("rerenderAgendaCalendar",this.rerenderAgendaCalendar)},mounted(){this.base__$calendar=pe(this.$refs.calendar),this.base__$calendar.fullCalendar(g.call(this)),this.$store.commit("scheduling/setDate",this.base__getCalendarDate()),this.base__calculateEventPriorityIndex(),this.$emit("mounted")},methods:{...(0,i.mapMutations)("scheduling",{store__setOverlappingShifts:"setOverlappingShifts",store__setAddToScheduleExecuted:"setAddToScheduleExecuted"}),async getEvents(e,t,s,a){if(this.base__calendarId){this.base__callouts+=1;try{if(!this.store__isMonth&&(await this.init(),this.setTimeAxisRange(),this.base__skipTimeAxisCheck))return;const i=await this.base__fetchEvents(e,t,s,this.base__calendarId);this.store__isMonth||(this.base__events=i,this.base__setShiftIdOnEvents(this.base__events)),this.$nextTick((()=>{if(a(this.store__isMonth?i:this.base__events),!this.store__isMonth){const e=this.buildNonWorkingHourEvents();this.base__$calendar.fullCalendar("renderEvents",e),this.initLocations()}}))}catch(e){this.base__genericPromiseErrorHandler(e)}finally{this.base__callouts-=1}}},buildNonWorkingHourEvents(){const e=[];return Object.values(this.base__columnIdToDayInstance).forEach((t=>{t.shifts.forEach((t=>e.push({id:Ee,title:"Non-working Hours",className:"non-working-hours",columnId:t.columnId,start:t.startTime,end:t.endTime,rendering:"inverse-background"})))})),e},setTimeAxisRange(){if(this.base__skipTimeAxisCheck)return void(this.base__skipTimeAxisCheck=!1);const{hasOvernightShift:e,earliestShiftTime:t,latestShiftTime:s}=this.base__columnIdToDayInstance[0];if(e&&this.store__calendarView===a.YV.AGENDA_DAY){this.base__skipTimeAxisCheck=!0;const e=4,a=this.base__buildTimeAxisString(t,-e),i=this.base__buildTimeAxisString(s,24+e);this.base__setTimeAxisRange(a,i)}else this.base__skipTimeAxisCheck=!0,this.base__setTimeAxisRange("00:00:00","24:00:00")},initLocations(){this.$nextTick(this.renderLocations()),this.initDropZones(),this.addLocationDragStartListeners(),this.createShiftRecordWatchers()},init(){return new Promise((e=>{const t={id:this.base__calendarId,name:this.$User.Name};this.base__fetchRouteDefaultsByResource(t).then((e=>(e.duration=this.base__convertStringToMinutes(e.duration),this.travelMode=e.driveProfile,this.base__setDefaultDuration(e.duration),this.routeDefaults=e,this.base__fetchCalendarShifts(this.routeDefaults)))).then((t=>{Object.values(this.base__columnIdToDayInstance).forEach((e=>{e.workingHours=this.routeDefaults.workingHours,this.base__setShiftsOnInstance(e,t),e.shifts.forEach((e=>this.base__shifts.push(e)))})),e()}))}))},renderLocations(){Object.values(this.base__columnIdToDayInstance).forEach((e=>{e.shifts.forEach((e=>{const{id:t,columnId:s,startLocation:i,endLocation:o,startTime:n,endTime:r,isOvernight:l}=e;if(i.isSpatial&&s>-1){const e=this.$refs[`start-${t}`][0];this.renderLocation(s,n,e),i.doShow=!0}if(o.isSpatial){let e=s;if(l&&this.store__calendarView===a.YV.AGENDA_WEEK&&e++,e<7&&e>-1){const a=this.$refs[`end-${t}`][0];this.renderLocation(s,r,a,e,!0),o.doShow=!0}}}))})),this.checkOverlappingShifts()},renderLocation(e,t,s,a=e,i){const o=t.format("HH:mm:ss"),n=pe(`.fc-view-container tr[data-time="${o}"]`);if(!n.length||!s)return;const r=i&&n.length>1?n.get(1).offsetTop:n.get(0).offsetTop;s.style.top=`${r}px`,s.style.display="",pe(this.$el).find(".fc-event-container:not(.fc-helper-container)")[a].append(s)},getPriorityComponent(e){switch(e){case"Einstein":case"Pardot":return e;default:return"Priority"}},navigateToRecord(e){window.ma_navigateToSObject(e.recordId)},normalizeEventTimeInterval(e){const t=this.base__$calendar.fullCalendar("option","slotDuration").split(":")[1],s=e.start.minutes()%t,a=e.end.minutes()%t;s>0&&(s>Math.floor(t/2)?(e.start.add(t-s,"minutes"),e.end.add(t-a,"minutes")):(e.start.subtract(s,"minutes"),e.end.subtract(a,"minutes")),this.resetRouteDataByShiftId(e.shiftId),this.base__$calendar.fullCalendar("removeEvents",e.id),this.base__$calendar.fullCalendar("renderEvent",e),this.base__hasModifiedEvents=!0,this.base__updatedEventsSet.add(e.id))},initDropZones(){this.$refs.calendar.querySelectorAll("div.fc-content-skeleton td:not(.fc-axis)").forEach(((e,t)=>{const s=e.querySelector("div.fc-content-col");s.setAttribute("data-column",t),s.style.height=`${pe("div.fc-slats").height()}px`,s.style.background="transparent";const a=e=>{this.activeDrag.rangeValidator=null;const s=this.$refs.calendar.querySelectorAll("div.fc-slats tr");for(let a=0;a<s.length;a++){const i=s[a],o=i.offsetTop,n=o+i.offsetHeight;if(e.layerY+e.srcElement.offsetTop>=o&&e.layerY+e.srcElement.offsetTop<=n){let e=i;if(this.activeDrag.type===this.Location.START){if(a+1===s.length)return;e=s[a+1]}const r=this.activeDrag.type===this.Location.START?"start":"end",l=this.base__columnIdToDayInstance[this.activeDrag.isOvernight?this.activeDrag.columnId:t],{shifts:d}=l,c=ge(e.getAttribute("data-time"),"HH:mm:ss");d.forEach((e=>{const t=`${r}-${e.id}`,s=this.activeDrag.type===this.Location.START?n:o;this.$refs[t][0].style.top=`${s}px`;const a=parseInt(c.format("H"),10),i=parseInt(c.format("m"),10);this.activeDrag.type===this.Location.START?e.record={...e.record,StartHour__c:a,StartMinute__c:i}:this.activeDrag.type===this.Location.END&&(e.record={...e.record,EndHour__c:a,EndMinute__c:i}),this.resetRouteDataByShiftId(e.id)}));break}}};e.addEventListener("drop",a),this.dropZoneListeners.set(e,a),e.addEventListener("dragover",(e=>{const s=this.activeDrag.columnId===t||this.activeDrag.isOvernight&&this.activeDrag.overnightColumnId===t,a=e.target.closest("a"),i=!a||!a.classList.contains("fc-time-grid-event"),o=!e.target.closest("div.ma-calendar-location"),n=null===this.activeDrag.rangeValidator||this.activeDrag.rangeValidator(e.layerY+e.srcElement.offsetTop);s&&i&&o&&n&&e.preventDefault()}))})),this.actionMenu.bindRef=this.$refs.calendar.querySelector("div.fc-content-skeleton"),this.actionMenu.doRender=!0},actionMenuToggleValidationFn(e){const t=parseInt(pe(e.srcElement).closest(".fc-content-col").get(0).getAttribute("data-column"),10);if(null===t)return!1;let s=!1,a=!1;const i=this.base__columnIdToDayInstance[t].shifts[0];if(i.startLocation.isSpatial&&(s=!0),i.endLocation.isSpatial&&(a=!0),s&&a)return!1;if(s){if(this.$refs[`start-${i.id}`][0].offsetTop>=e.layerY+e.srcElement.offsetTop)return!1}else if(a&&this.$refs[`end-${i.id}`][0].offsetTop<=e.layerY+e.srcElement.offsetTop)return!1;return!0},analyzeCreateTarget(e){if(!e||!e.target)return;const t=parseInt(pe(e.srcElement).closest(".fc-content-col").get(0).getAttribute("data-column"),10);if(null===t)return;this.actionMenu.activeColumnId=t;const s=this.base__columnIdToDayInstance[t].shifts[0];if(s.startLocation.isSpatial&&(this.actionMenu.showStart=!1),s.endLocation.isSpatial&&(this.actionMenu.showEnd=!1),s.startLocation.isSpatial&&s.endLocation.isSpatial)return void this.$nextTick((()=>{this.actionMenu.doShow=!1}));if(this.store__calendarView===a.YV.AGENDA_DAY&&s.isOvernight)return this.actionMenu.showStart=!1,this.actionMenu.showEnd=!1,void this.$nextTick((()=>{this.actionMenu.doShow=!1}));const i=this.$refs.calendar.querySelectorAll("div.fc-slats tr");for(let o=0;o<i.length;o++){const n=i[o],r=n.offsetTop,l=r+n.offsetHeight;if(e.layerY>=r&&e.layerY<=l){this.actionMenu.activeTimeString=n.getAttribute("data-time"),this.actionMenu.activeEl=n.querySelector("td.fc-widget-content:not(.fc-axis):not(.fc-time)");const i=e.target.getBoundingClientRect();let o=!1;const r=this.base__columnIdToDayInstance[t].calendarDate.format("YYYY-MM-DD"),l=ge(`${r}T${this.actionMenu.activeTimeString}`),d=ge(`${r}T${s.startTime.format("HH:mm")}`),c=ge(`${r}T${s.endTime.format("HH:mm")}`),u=this.store__calendarView===a.YV.AGENDA_DAY?{isOvernight:!1}:this.base__columnIdToDayInstance[t-1].shifts[0];s.isOvernight&&c.add(1,"d"),(l.isBefore(d)||l.isAfter(c))&&(l.isBefore(d)&&u.isOvernight?(this.actionMenu.showStart=!1,ge(`${r}T${u.endTime.format("HH:mm")}`).isSameOrAfter(l)?u.endLocation.isSpatial?(this.actionMenu.showEnd=!1,o=!0):this.actionMenu.activeColumnId--:(this.actionMenu.showEnd=!1,o=!0)):(this.actionMenu.showStart=!1,this.actionMenu.showEnd=!1,o=!0)),o&&this.$nextTick((()=>{this.actionMenu.doShow=!1})),this.locationSearch.rect={height:i.height,width:i.width,left:i.left,top:i.top,bottom:i.bottom,x:i.x,y:e.clientY};break}}},hideActionMenu(){this.actionMenu.showStart=!0,this.actionMenu.showEnd=!0},locationSelected(e){const t=this.locationSearch.type===this.Location.START;let{activeColumnId:s}=this.locationSearch;null===s&&(s=this.actionMenu.activeColumnId);const i=t?"Start":"End",o=t?"start":"end",n=t?"startLocation":"endLocation",r={};r[`${i}Location__Latitude__s`]=e.Latitude__c,r[`${i}Location__Longitude__s`]=e.Longitude__c,r[`${i}Address__c`]=e.Name;const l=this.base__columnIdToDayInstance[s];if(!1===l.shifts[0][n].isSpatial){const e=l.calendarDate.format("YYYY-MM-DD"),t=ge(`${e}T${this.actionMenu.activeTimeString}`),s=parseInt(t.format("H"),10),a=parseInt(t.format("m"),10);r[`${i}Hour__c`]=s,r[`${i}Minute__c`]=a}l.shifts[0].record={...l.shifts[0].record,...r},l.shifts[0][n]={...l.shifts[0][n],isSpatial:!0,doShow:!1,id:(0,a.ZP)()};const d=this.$refs[`${o}-${l.shifts[0].id}`][0];this.$nextTick((()=>{const e=t?l.shifts[0].startTime:l.shifts[0].endTime;if(t)this.renderLocation(s,e,d);else{let t=s;l.shifts[0].isOvernight&&this.store__calendarView===a.YV.AGENDA_WEEK&&t++,this.renderLocation(s,e,d,t,!0)}l.shifts[0][n].doShow=!0})),this.closeLocationSearch(),this.resetRouteDataByShiftId(l.shifts[0].id)},setLocationHandler(e){this.locationSearch.el=this.actionMenu.activeEl,this.locationSearch.type=e,this.locationSearch.doRender=!0},closeLocationSearch(e){e&&e.stopPropagation(),this.locationSearch={...this.getDefaultLocationSearchSettings(),rect:this.locationSearch.rect}},searchLocation(e,t,s){e===this.Location.START?[this.locationSearch.el]=this.$refs[`start-${t.id}`]:e===this.Location.END&&([this.locationSearch.el]=this.$refs[`end-${t.id}`]),this.locationSearch.el.contains(s.target)||s.stopPropagation(),this.locationSearch.shiftId=t.id,this.locationSearch.activeColumnId=t.columnId,this.locationSearch.rect=null,this.locationSearch.doRender=!0,this.locationSearch.type=e},cloneScheduleClickHandler(){this.base__hasPendingChanges?this.$emit("error","Cannot clone schedule with pending changes. Please save the schedule and then try cloning again."):this.showCloneScheduleModal=!0},cloneSchedule(e,t){this.showCloneScheduleModal=!1,this.$nextTick((()=>{this.base__save({cloneTargetDate:e,cloneSourceDate:this.store__calendarDate,doClone:!0,doCloneStartEndLocations:t})}))},updateDefaultDuration(){if(this.$User.Id===this.base__calendarId){let{duration:e}=d.Z.routeDefaults;e=this.base__convertStringToMinutes(e),this.base__setDefaultDuration(e),this.routeDefaults.duration=e;const{driveProfile:t}=d.Z.routeDefaults;this.travelMode=t,this.routeDefaults.travelMode=this.travelMode}},appendCustomColumnHeaderMarkup(){pe("th.fc-day-header").each(((e,t)=>{const s=pe(t),a=s.find("a > div, div").data("column-id")||0;if(-1===a)return;let i=pe(this.$refs[`route-selector-${a}`][0].$el);s.append(i),i=pe(this.$refs[`shift-color-${a}`][0].$el),s.append(i)}))},getShiftColorHex:e=>(e=-1===e?0:e,`#${ye.get(e).hex}`),rerenderAgendaCalendar(){window.setTimeout((()=>{this.base__next(),window.setTimeout((()=>{this.base__previous()}),350)}),350)},removeLocation(e,t){this.actionMenu.doShow=!1,this.locationSearch.doRender=!1;const{calendarDate:s}=this.base__columnIdToDayInstance[e.columnId],a=ge.utc(s).format("dddd").toLowerCase(),i=this.routeDefaults.workingHours[a];t===this.Location.START?(this.actionMenu.showStart=!0,e.startLocation.isSpatial=e.startLocation.doShow=!1,e.record={...e.record,StartAddress__c:null,StartLocation__Latitude__s:null,StartLocation__Longitude__s:null,StartHour__c:i.startHour,StartMinute__c:i.startMinute}):t===this.Location.END&&(this.actionMenu.showEnd=!0,e.endLocation.isSpatial=e.endLocation.doShow=!1,e.record={...e.record,EndAddress__c:null,EndLocation__Latitude__s:null,EndLocation__Longitude__s:null,EndHour__c:i.endHour,EndMinute__c:i.endMinute}),this.resetRouteDataByShiftId(e.id)},setCalendarToDayView(e){this.resetComponentState(),this.$nextTick((()=>{this.skipCalendarDateWatcherLogic=!0,this.$store.commit("scheduling/setView",a.YV.AGENDA_DAY),this.$store.commit("scheduling/setDate",e)}))},setExcludeInclude(e){this.resetRouteDataByShiftId(e.shiftId),this.base__setExcludeInclude(e)},updateLockStatus(e){this.resetRouteDataByShiftId(e.shiftId),this.base__setGuideLockStatus(e)},returnEventToQueue(e){this.deleteEvent(e),this.base__updatedEventsSet.delete(e.id);const t={...e};delete t.shiftId,delete t.recordId,delete t.resourceId,delete t.start,delete t.end,delete t.hasError,delete t.source,delete t.distance,delete t.totaltraveltime,delete t.errorMessage,delete t.errorTimeString,delete t.bgColorClass,t.hasError=!1,t.excludeFromRoute=!1,this.store__addItemToQueue(t),this.base__hasModifiedEvents=!0},removeAllScheduledEvents(){const e=[];this.base__$calendar.fullCalendar("clientEvents").forEach((t=>{"inverse-background"===t.rendering||t.isBreak||(t.recordId?(this.base__eventIdsForDelete.push(t.recordId),this.base__hasModifiedEvents=!0):this.base__numEventsReceived--,e.push(t.id),this.base__updatedEventsSet.delete(t.id),this.base__$calendar.fullCalendar("removeEvents",t.id))})),this.base__numEventsReceived||this.base__eventIdsForDelete.length||(this.base__hasModifiedEvents=!1,this.base__updatedEventsSet.clear()),this.resetAllRouteData(),this.base__events=this.base__events.filter((t=>-1===e.indexOf(t.id))),Se.Map.InfoBubble.hide()},toggleRouteByShift(e){null==e.routing?(window.trackUsage("Maps",{action:"Plot Schedule",description:"Plotting a Schedule"}),this.generateRouteByShiftId(e.id)):this.resetRouteDataByShiftId(e.id)},toggleVisibilityByShift(e){e.onMap=!(!e.onMap&&"boolean"!=typeof e.onMap||e.onMap),e.onMap?(this.$bus.$emit("hide-plotted-route"),e.routing.restoreRouteOnMap()):(Se.Map.InfoBubble.hide(),e.routing.hideRouteOnMap())},optimizeWeekly(){const e=window.userSettings||{},t=Object.keys(this.store__columnIdsForOptimization),s=[],i=new Set;t.forEach((e=>this.base__columnIdToDayInstance[e].shifts.forEach((e=>{this.resetRouteDataByShiftId(e.id),s.push(e),i.add(e.id)}))));const o=this.base__$calendar.fullCalendar("clientEvents").concat(this.buildWaypointsFromQueue());if(o.length>700)return void window.MAToastMessages.showError({message:window.MASystem.Labels.MA_ROUTING_ERROR,subMessage:"Please limit your route to 700 stops or less. This includes your start and end location.",timeOut:1e4,extendedTimeOut:0,closeButton:!0});if(o.length<2)return void window.MAToastMessages.showError({message:window.MASystem.Labels.MA_ROUTING_ERROR,subMessage:window.MASystem.Labels.MA_Please_Add_Two_Events,timeOut:1e4,extendedTimeOut:0,closeButton:!0});const n=this.base__buildWaypointsFromEvents(o,s),{duration:r}=this.routeDefaults;function d(e,t,s){const i={id:(0,a.ZP)(),duration:r,flexible:!1,start:t.unix()};return s===this.Location.START&&e.startLocation.isSpatial?(i.lat=e.record.StartLocation__Latitude__s,i.lng=e.record.StartLocation__Longitude__s,i.duration=0):s===this.Location.END&&e.endLocation.isSpatial&&(i.lat=e.record.EndLocation__Latitude__s,i.lng=e.record.EndLocation__Longitude__s,i.duration=0),i}const c=s.map((e=>{const{routeStartTime:t,routeEndTime:s}=this.base__getRouteTimes(e);return{first:d.call(this,e,t,this.Location.START),last:d.call(this,e,s,this.Location.END)}}));this.base__callouts++;const u={subType:"core",action:"schedule",version:2},{softBreaks:m=[],hardBreaks:f=[]}=n,v=f,b=window.getProperty(e,"RouteDefaults.optimizationType",!1)||"fastest shift completion",p=[],g=[],S=[];let y=null;for(let e=0;e<c.length;e++)if(ge(1e3*c[e].first.start).isSame(ge(),"d")){y=c[e];for(let e=0;e<n.spatial.length;e++)n.spatial[e].start?ge(1e3*n.spatial[e].start).isSame(ge(),"d")?p.push(n.spatial[e]):S.push(n.spatial[e]):g.push(n.spatial[e])}if(y&&p.length){const e=y.first.start,{shift:t,adjustedWaypoints:s}=l.Z.waypointReorderingForAddToSchedule(y,n.spatial,g,e,p);n.spatial=s,y=t}const E={dayranges:c,waypoints:n.spatial,driveProfile:window.getProperty(e,"RouteDefaults.driveProfile",!1)||"driving",optimization_type:b,blockedtimes:v.map((e=>({starttime:e.start,endtime:e.end}))),softbreaks:m.map((e=>({starttime:e.start+1,endtime:e.end-1})))};window.trackUsage("Maps",{action:"Plot Schedule",description:"Plotting a Schedule"}),l.Z.trackRequest(E),this.store__setAddToScheduleExecuted(!1),(new _.Z).setAction(this.$Remoting.MapAnythingIORequestPOST).setErrorHandler(this.base__handleRemoteActionError.bind(this)).invoke([u,JSON.stringify(E)],(e=>{h.Z.debugRemotingData("optimizeWeekSchedule",[u,JSON.stringify(E)],e);const{status:t,jobid:s}=e.data||{};e.success&&s&&"Accepted"===t?this.pollOptimizationServer(s).then((e=>{this.processWeeklyOptimizationResponse(e),this.base__callouts-=1})).catch((e=>{const t=ge(1e3*c[0].first.start).isSame(ge(),"d"),s="unbuildable"===e.title&&e.details,a=e.details[0].id&&E.waypoints[1].id===e.details[0].id;t&&s&&a?(E.waypoints.shift(),E.dayranges[0].first.start=E.waypoints[0].start,(new _.Z).setAction(this.$Remoting.MapAnythingIORequestPOST).setErrorHandler(this.base__handleRemoteActionError.bind(this)).invoke([u,JSON.stringify(E)],(e=>{h.Z.debugRemotingData("optimizeWeekSchedule",[u,JSON.stringify(E)],e);const t=e.data.status,s=e.data.jobid;e.success&&s&&"Accepted"===t&&this.pollOptimizationServer(s).then(this.processWeeklyOptimizationResponse).catch((e=>this.$emit("error",e))).finally((()=>{this.base__callouts-=1}))}))):(this.base__callouts-=1,this.$emit("error",e))})):(this.base__callouts-=1,this.$emit("error","Failed to start async job."))}))},pollOptimizationServer(e){return new Promise(((t,s)=>{const a=setInterval((()=>{const i={subType:"core",action:"schedule",version:2};(new _.Z).setAction(this.$Remoting.MapAnythingIORequest).setErrorHandler(((e,t)=>{clearInterval(a),s(t.message)})).invoke([i,{jobId:e}],(o=>{h.Z.debugRemotingData("pollOptimizationServer",[i,{jobId:e}],o);const{status:n,routes:r=[]}=o.data||{};o.success?"Completed"===n&&r.length?(clearInterval(a),t(r)):"Failed"===n&&(clearInterval(a),s(new Error(`Job Failed (${e})`))):(clearInterval(a),s(o.message))}))}),6e3)}))},processWeeklyOptimizationResponse(e){const t=(e,t)=>{const s=this.store__queue.find((e=>e.id===t.id));if(!s)return e;this.store__removeItemFromQueueById(s.id);const a=this.base__adjustToUserTimezone(ge(1e3*t.start)),i={...s,start:a,end:this.base__adjustToUserTimezone(ge(1e3*t.start)).add(t.duration,"seconds")};return this.base__events.push(i),e.push(i),e};let s=[];e.forEach((e=>{s=[...s,...e.waypoints.reduce(t,[])]})),s.length&&(this.base__hasModifiedEvents=!0,s.forEach((e=>{this.base__updatedEventsSet.add(e.id)}))),this.base__setShiftIdOnEvents(s),this.base__$calendar.fullCalendar("renderEvents",s)},optimize(e){this.generateRoute(e,!0)},generateRouteByShiftId(e){this.generateRoute(e)},generateRoute(e,t=!1){this.resetRouteDataByShiftId(e);const s=this.base__shifts.find((t=>t.id===e));if(t&&"boolean"==typeof t&&s.startTime.isBefore(ge(),"d"))return this.$emit("error","Cannot optimize a route for a date in the past."),void(s.onMap=!1);let a=this.base__$calendar.fullCalendar("clientEvents");t&&(a=a.concat(this.buildWaypointsFromQueue()));const i=this.base__buildWaypointsFromEvents(a,[s]);if(s.routing=this.base__instantiateRoute(s,i,t),this.store__isAgendaWeek){const e=ye.get(s.columnId);s.routing.setStrokeColor(e.hex),s.routing.setWaypointColor(e.hex)}if(!s.routing.isWaypointLengthInRange(r.D.SCHEDULE))return s.onMap=!1,void(s.routing=null);this.$bus.$emit("hide-plotted-route"),this.base__callouts+=1,s.routing.setDriveProfile(this.travelMode).build("scheduling").then((()=>(s.route=s.routing.getRoute(),s.onMap=!0,this.processWaypoints(s),this.$nextTick((()=>{try{l.Z.moreThanOneRoute(s.route,(e=>{this.setTravelSummaryOnCalendarEvents(e.waypoints)}))}catch(e){this.$emit("error",`An error occurred while applying travel summary to calendar events. (${e.message})`)}})),this.store__isAgendaWeek,this.$bus.$emit("route-created"),Promise.resolve()))).catch((e=>{if(e&&"object"==typeof e&&"string"==typeof e.message&&0===e.message.indexOf("Waypoint ")&&e.message.indexOf(" is in blockedtime")>0){const t=e.message.substring(e.message.indexOf("Waypoint ")+9,e.message.indexOf(" is in blockedtime"));e.maioCode=82019,e.details=[{id:t,errormessage:"overlapping break"}]}e&&e.maioCode&&e.details?this.base__processResponseErrors(e,s):this.base__genericPromiseErrorHandler(e),s.onMap=!1,s.routing=null})).finally(this.base__genericPromiseFinallyHandler)},processWaypoints(e){const t=[],s=this.store__isAgendaWeek?ye.get(e.columnId).class:ye.get(1).class;function a(e){e.bgColorClass=s,e.distance=this.distance,e.totaltraveltime=this.totaltraveltime}function i(a,i){this.store__removeItemFromQueueById(a.id);const o={...a,columnId:e.columnId,shiftId:e.id,bgColorClass:s,start:this.base__adjustToUserTimezone(ge(1e3*i.start)),end:this.base__adjustToUserTimezone(ge(1e3*i.start)).add(i.duration,"seconds"),distance:i.distance,totaltraveltime:i.totaltraveltime};this.isGuideUser&&(o.guideWaypoint={}),this.base__events.push(o),t.push(o)}l.Z.moreThanOneRoute(e.route,(t=>{t.waypoints.forEach((t=>{const s=this.base__events.find((e=>e.id===t.id));if(s)return void a.call(t,s);e.startLocation&&t.id===e.startLocation.id&&a.call(t,e.startLocation);const o=this.store__queue.find((e=>e.id===t.id));o&&i.call(this,o,t)}))})),t.length?(this.base__hasModifiedEvents=!0,t.forEach((e=>{this.base__updatedEventsSet.add(e.id)})),this.base__$calendar.fullCalendar("renderEvents",t)):this.base__$calendar.fullCalendar("rerenderEvents")},duplicationCheck(){const e=new Set;this.base__events.forEach((t=>{let s=`${void 0!==t.LinkId__c?t.LinkId__c:t.relationshipId}-${t.columnId}`;s=void 0!==t.LinkId__c?`${t.LinkId__c}`:void 0!==t.relationshipId?`${t.relationshipId}-${t.columnId}`:`${t.recordId}-${t.columnId}`,t.isMALocation&&(s=t.placeId);const a=`${s}-${t.shiftId}`;e.has(a)&&!t.isBreak?(t.hasError=!0,t.errorMessage="Duplicate Stop"):(t.hasError=!1,e.add(a))}))},setTravelSummaryOnCalendarEvents(e){let t=1;const s=this.base__$calendar.fullCalendar("clientEvents").sort(this.base__eventSorter);e.forEach((e=>{const a=s.filter((t=>t.id===e.id));a.length&&pe(this.$refs[a[0].id]).find(".fc-content").prepend(`<div class="ma-stop-number-wrap"><div class="ma-stop-number">${t++}</div></div>`)}))},resetComponentState(e=!1){this.dropZoneListeners.forEach(((e,t)=>t.removeEventListener("drop",e))),this.dropZoneListeners.clear(),this.removeShiftRecordWatchers(),this.resetAllRouteData(),this.base__resetComponentState(e),this.counter=0},resetAllRouteData(){this.base__shifts.forEach((e=>this.resetRouteDataByShiftId(e.id)))},resetRouteDataByShiftId(e){const t=this.base__shifts.find((t=>t.id===e));t&&(this.removeTravelSummaryAndColorFromCalendarEventsByShiftId(e),t.routing&&t.routing.clearRouteOnMap(),Object.assign(t,{onMap:!1,routing:null,route:{}},{startLocation:Object.assign(t.startLocation,this.base__getBaseDefaultLocationSettings()),endLocation:Object.assign(t.endLocation,this.base__getBaseDefaultLocationSettings())}))},removeTravelSummaryAndColorFromCalendarEventsByShiftId(e){this.base__$calendar.fullCalendar("clientEvents").forEach((t=>{t.shiftId===e&&pe(this.$refs[t.id]).find(".ma-stop-number-wrap").remove()}));const t=[];this.base__events.forEach((s=>{if(s.shiftId!==e)return;delete s.distance,delete s.totaltraveltime,delete s.errorMessage,delete s.errorTimeString,delete s.bgColorClass,s.hasError=!1;const a=this.base__$calendar.fullCalendar("clientEvents").filter((e=>e.id===s.id))[0];a&&(a.hasError=!1,t.push(a))})),this.base__$calendar.fullCalendar("updateEvents",t)},buildWaypointsFromQueue(){const e=[],t={duration:60*this.routeDefaults.duration,flexible:!0};return this.store__queue.forEach((s=>{e.push({...s,...t})})),e},async setCalendarId(e){this.base__calendarId=e.id,this.resetComponentState(),await this.init();const t=this.routeDefaults.timezone?this.routeDefaults.timezone:this.$User.timezoneId;this.base__$calendar.fullCalendar("option","timezone",t),this.base__$calendar.fullCalendar("option","now",this.base__adjustToUserTimezone(ge())),this.$nextTick((()=>{this.base__$calendar.fullCalendar("refetchEvents")}))},save(){return this.base__save().then(this.hardResetComponentState).catch((()=>{}))},saveIgnore(){return this.base__save({ignoreSaveChecks:!0}).then(this.hardResetComponentState).catch((()=>{}))},setConfigId(e){this.base__setConfigId(e),this.base__save().then((()=>{this.base__storedNavigationAction&&"function"==typeof this.base__storedNavigationAction?this.base__storedNavigationAction():this.hardResetComponentState()}))},hardResetComponentState(){this.resetComponentState(this.store__calendarView===a.YV.AGENDA_DAY),this.base__$calendar.fullCalendar("refetchEvents")},deleteEvent(e){this.base__deleteEvent(e),this.$nextTick((()=>{this.resetRouteDataByShiftId(e.shiftId),this.base__$calendar.fullCalendar("rerenderEvents")}))},addLocationDragStartListeners(){this.base__shifts.forEach((e=>{const t=this.$refs[`start-${e.id}`][0];"function"==typeof e.startLocation.dragStartFn&&t.removeEventListener("dragstart",e.startLocation.dragStartFn);const s=s=>{s.dataTransfer.dropEffect="move",s.dataTransfer.setData("application/x-foo","foo");const i=[];if(this.activeDrag.columnId=e.columnId,this.activeDrag.shiftId=e.id,this.activeDrag.type=this.Location.START,this.activeDrag.isOvernight=e.isOvernight,!e.endLocation.isSpatial||e.isOvernight&&this.store__calendarView!==a.YV.AGENDA_WEEK)this.activeDrag.rangeValidator=()=>!1;else{const s=this.$refs[`end-${e.id}`][0].offsetTop;this.base__shifts.forEach((t=>{t.isOvernight&&t.columnId+1===e.columnId&&e.id!==t.id&&t.endLocation.isSpatial&&i.push(this.$refs[`end-${t.id}`][0].offsetTop)})),e.isOvernight&&this.store__calendarView===a.YV.AGENDA_WEEK&&6!==e.columnId&&i.push(s),this.activeDrag.rangeValidator=o=>{const n=!i||0===i.filter((e=>o-t.clientHeight<=e)).length,r=e.isOvernight&&this.store__calendarView===a.YV.AGENDA_WEEK,l=(!e.isOvernight||this.store__calendarView!==a.YV.AGENDA_WEEK)&&o+t.clientHeight<s;return n&&(r||l)}}};e.startLocation.dragStartFn=s,t.addEventListener("dragstart",s);const i=this.$refs[`end-${e.id}`][0];"function"==typeof e.endLocation.dragStartFn&&i.removeEventListener("dragstart",e.endLocation.dragStartFn);const o=t=>{t.dataTransfer.dropEffect="move",t.dataTransfer.setData("application/x-foo","foo");const s=[];if(this.activeDrag.columnId=e.columnId,this.activeDrag.isOvernight=e.isOvernight,this.activeDrag.isOvernight&&(this.activeDrag.overnightColumnId=e.columnId+1),this.activeDrag.shiftId=e.id,this.activeDrag.type=this.Location.END,!e.startLocation.isSpatial||e.isOvernight&&this.store__calendarView!==a.YV.AGENDA_WEEK)this.activeDrag.rangeValidator=()=>!1;else{const t=this.$refs[`start-${e.id}`][0].offsetTop;e.isOvernight&&this.base__shifts.forEach((t=>{this.activeDrag.overnightColumnId===t.columnId&&e.id!==t.id&&t.startLocation.isSpatial&&s.push(this.$refs[`start-${t.id}`][0].offsetTop)})),-1!==e.columnId&&s.push(t),this.activeDrag.rangeValidator=o=>e.isOvernight&&this.store__calendarView===a.YV.AGENDA_WEEK?!s||0===s.filter((e=>o>=e-i.clientHeight)).length:!s||o>t+i.clientHeight}};e.endLocation.dragStartFn=o,i.addEventListener("dragstart",o)}))},removeShiftRecordWatchers(){this.unwatchers.forEach((e=>e()))},createShiftRecordWatchers(){this.columnIds.forEach((e=>{const t=this.base__columnIdToDayInstance[e];t.shifts.forEach((e=>{this.unwatchers.push(this.$watch((()=>e.record),(s=>{e.doUpsert=!0,e.startTime=ge.tz(t.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(s.StartHour__c,"h").add(s.StartMinute__c,"m"),e.endTime=ge.tz(t.calendarDate.format("YYYY-MM-DD"),this.base__getCorrectTimezone()).add(s.EndHour__c,"h").add(s.EndMinute__c,"m"),s.StartHour__c>s.EndHour__c&&(e.endTime.add(1,"day"),e.isOvernight=!0),this.base__hasModifiedShifts=!0,this.base__$calendar.fullCalendar("removeEvents",Ee),this.base__$calendar.fullCalendar("renderEvents",this.buildNonWorkingHourEvents())})))}))}))},checkOverlappingShifts(){let e,t="";this.store__calendarView===a.YV.AGENDA_WEEK&&Object.values(this.base__columnIdToDayInstance).forEach((s=>s.shifts.forEach((s=>{-1!==s.columnId&&(0===s.columnId&&(e=this.base__columnIdToDayInstance[-1].shifts[this.base__columnIdToDayInstance[-1].shifts.length-1].endTime),null!=e&&e.valueOf()>s.startTime.valueOf()&&(""===t&&(t+=window.MASystem.Labels.MA_Please_Correct_Overlapping_Shifts),t+=`  ${s.startTime.format("YYYY-MM-DD hh:mm a")} - ${e.format("YYYY-MM-DD hh:mm a")}`),e=s.endTime)})))),""!==t?(this.store__setOverlappingShifts(!0),window.MAToastMessages.showError({message:t,subMessage:"",timeOut:1e4,extendedTimeOut:0,closeButton:!0})):this.store__setOverlappingShifts(!1)},getDefaultLocationSearchSettings:()=>({doRender:!1,type:null,activeColumnId:null,el:null,rect:{}}),getDefaultDayInstance:()=>({calendarDate:{},shifts:[],hasOvernightShift:!1,earliestShiftTime:null,latestShiftTime:null}),resizeWeekHeader(){this.store__isAgendaWeek&&setTimeout((()=>{const e=this.$refs.calendar.querySelectorAll("div.fc-agendaWeek-view div.fc-widget-header th"),t=this.$refs.calendar.querySelectorAll("div.fc-content-skeleton td"),s=this.$refs.calendar.querySelectorAll("div.fc-agendaWeek-view td.fc-head-container.fc-widget-header"),a=this.$refs.calendar.querySelectorAll("div.fc-agendaWeek-view thead.fc-head");for(let s=0;s<t.length;s++)pe(e[s]).css("width",t[s].clientWidth);pe(e[e.length-1]).css("padding-right",a[0].clientWidth-s[0].clientWidth)}),1e3)}}},Le=we,Ie=(0,D.Z)(Le,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-grid slds-grid_vertical",staticStyle:{height:"100%"}},[s("div",{staticClass:"slds-grid",staticStyle:{height:"100%"}},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-col"},[s("PendingChangeModal",{attrs:{showModal:e.base__showPendingChangeModal},on:{"update:showModal":function(t){e.base__showPendingChangeModal=t},"update:show-modal":function(t){e.base__showPendingChangeModal=t},discard:e.base__completeNavigationRequest,save:e.base__saveAndCompleteNavigationRequest}}),e._v(" "),e.base__showSaveErrorModal?s("SaveErrorModal",{attrs:{errors:e.modalErrors},on:{hide:e.base__hideSaveErrorModal,ignore:e.saveIgnore,save:e.setConfigId}}):e._e(),e._v(" "),e.showCloneScheduleModal?s("CloneEventsModal",{on:{cancel:function(t){e.showCloneScheduleModal=!1},clone:e.cloneSchedule}}):e._e(),e._v(" "),e.base__laborLawNotify?s("LaborLawNotify"):e._e(),e._v(" "),s("div",{staticClass:"slds-p-left_medium slds-p-right_x-small slds-p-vertical_small",class:{"schedule-week-header":e.store__isAgendaWeek},style:e.base__showFullScreenToggleControl?"height: 56px":"height: 99px",attrs:{id:"schedulePanelHeader"}},[s("div",{staticClass:"slds-grid slds-wrap"},[s("div",{staticClass:"slds-col slds-size_6-of-12"},[s("div",{staticClass:"slds-p-right_x-small slds-grid"},[s("ResourceSearch",{staticClass:"slds-col",class:e.base__showFullScreenToggleControl?"slds-size_4-of-12":"slds-size_12-of-12",attrs:{storedSearchTerm:e.base__searchTerm},on:{selected:e.setCalendarId}}),e._v(" "),s("CalendarControls",{directives:[{name:"show",rawName:"v-show",value:e.base__showFullScreenToggleControl,expression:"base__showFullScreenToggleControl"}],staticClass:"slds-size_8-of-12",on:{today:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__today].concat(a))},previous:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__previous].concat(a))},next:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__next].concat(a))},"view-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarView].concat(a))},"date-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarDate].concat(a))}}})],1)]),e._v(" "),s("div",{staticClass:"slds-col slds-size_6-of-12"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.base__showFullScreenToggleControl,expression:"base__showFullScreenToggleControl"}],staticClass:"slds-button slds-button_icon slds-button_icon-container slds-float_right",on:{click:function(t){return e.$emit("toggleFullScreen")}}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-expand"}),e._v(" "),s("span",{staticClass:"slds-button__icon ma-icon ma-icon-contract"})]),e._v(" "),s("ActionMenu",{directives:[{name:"show",rawName:"v-show",value:e.base__showControls,expression:"base__showControls"}],staticClass:"slds-button_last slds-float_right",attrs:{showMoreLabel:e.$Labels.MA_SHOW_MORE}},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",attrs:{slot:"button"},slot:"button"},[s("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.MA_SCHEDULE_REMOVE_ALL_SCHEDULED_EVENTS},on:{click:e.removeAllScheduledEvents}}),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.MA_SCHEDULE_RETURN_ALL_TO_BE_SCHEDULED},on:{click:e.base__returnAllEventsToQueue}}),e._v(" "),s("ActionMenuItem",{directives:[{name:"show",rawName:"v-show",value:"agendaDay"===e.store__calendarView,expression:"store__calendarView === 'agendaDay'"}],attrs:{label:e.$Labels.Schedule_ActionItem_Clone_Schedule_Button},on:{click:e.cloneScheduleClickHandler}})],1),e._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:e.base__showControls,expression:"base__showControls"}],staticClass:"slds-button slds-button_success slds-float_right",attrs:{disabled:e.base__doDisableSaveBtn,"data-pendo":"schedule_save"},on:{click:e.save}},[e._v("\n                            "+e._s(e.$Labels.MA_Save)+"\n                        ")])],1),e._v(" "),s("CalendarControls",{directives:[{name:"show",rawName:"v-show",value:!e.base__showFullScreenToggleControl,expression:"!base__showFullScreenToggleControl"}],staticClass:"slds-col slds-size_12-of-12",staticStyle:{"margin-top":"10px"},on:{today:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__today].concat(a))},previous:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__previous].concat(a))},next:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__next].concat(a))},"view-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarView].concat(a))},"date-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarDate].concat(a))}}})],1)]),e._v(" "),s("div",{staticClass:"slds-col slds-grid",attrs:{id:"schedulePanelBody"}},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-col",attrs:{id:"schedulePanelCalendarWrap"}},[s("div",{ref:"calendar",staticClass:"ma-calendar slds-grid slds-grid_vertical slds-col"})]),e._v(" "),e.store__isAgendaDay?s("Queue",{attrs:{shifts:e.base__shifts,allowOptimization:!0},on:{optimize:e.optimize}}):e._e()],1),e._v(" "),null!=e.dayViewRoute?s("RouteSummary",{attrs:{route:e.dayViewRoute,hidePrintIcons:!0,hideTrafficData:!0}}):e._e(),e._v(" "),e._l(e.base__events,(function(t,a){return s("div",{key:a+"-"+t.id,ref:t.id,refInFor:!0,on:{click:function(e){return e.preventDefault(),e.stopPropagation(),function(){return!0}.apply(null,arguments)}}},[s("div",{staticClass:"fc-content"},[t.excludeFromRoute?s("span",{staticClass:"ma-icon ma-icon-nonspacial event-icon--right"}):e._e(),e._v(" "),s("div",{staticClass:"slds-grid slds-col fc-title-wrap"},[s("div",{staticClass:"fc-title"},[e.isGuideUser&&!t.isBreak?s("span",{staticClass:"ma-icon",class:e.base__getGuideWaypointLockIcon(t),on:{click:function(s){return e.updateLockStatus(t)}}}):e._e(),e._v(" "),s("span",[t.isBreak?s("Icon",{attrs:{category:"utility",name:"food_and_drink",variant:"inverse",size:"xx-small"}}):e._e()],1),e._v("\n\n                            "+e._s(e._f("decode")(t.title))+"\n                        ")])]),e._v(" "),t.isBreak?e._e():s("div",{staticClass:"ma-event-controls"},[t.spatial?s("ActionMenu",{staticClass:"slds-button_last",attrs:{doShowSync:t.showActionMenu,showMoreLabel:e.$Labels.MA_SHOW_MORE},on:{"update:doShowSync":function(s){return e.$set(t,"showActionMenu",s)},"update:do-show-sync":function(s){return e.$set(t,"showActionMenu",s)}}},[s("button",{staticClass:"schedule-event-button",attrs:{slot:"button"},slot:"button"},[s("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),s("ActionMenuItem",{directives:[{name:"show",rawName:"v-show",value:e.base__eventHasRecord(t),expression:"base__eventHasRecord(event)"}],attrs:{label:e.$Labels.MA_VIEW_RECORD},on:{click:function(s){return e.navigateToRecord(t)}}}),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.Schedule_ActionItem_Snap_Nearest_Interval_Button},on:{click:function(s){return e.normalizeEventTimeInterval(t)}}}),e._v(" "),s("ActionMenuItem",{attrs:{label:e.base__getExcludeIncludeActionLabel(t)},on:{click:function(s){return e.setExcludeInclude(t)}}}),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.MA_SCHEDULE_RETURN_TO_BE_SCHEDULED},on:{click:function(s){return e.returnEventToQueue(t)}}})],1):e._e(),e._v(" "),s("button",{staticClass:"schedule-event-button",on:{click:function(s){return e.deleteEvent(t)}}},[s("span",{staticClass:"ma-icon ma-icon-remove"})])],1),e._v(" "),t.priorityType?s("div",{staticClass:"priority-queue-item-wrap"},[s("span",{staticClass:"slds-button slds-button_icon priority-queue-item"},[s(e.getPriorityComponent(t.priorityType),{tag:"component",attrs:{value:t.priorityValue,fieldLabel:t.priorityLabel||"",sfdcFieldType:t.priorityFieldType||"number",priorityIndex:t.priority}}),e._v(" "),s("span",[e._v(e._s(e._f("decode")(t.priority)))])],1)]):e._e()]),e._v(" "),t.distance?s("RouteTimeAndDistance",{attrs:{distance:t.distance,totalTravelTime:t.totaltraveltime,travelMode:e.travelMode}}):e._e(),e._v(" "),t.hasError?s("EventError",{attrs:{event:t}}):e._e()],1)})),e._v(" "),e._l(e.base__shifts,(function(t){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.startLocation.doShow,expression:"shift.startLocation.doShow"}],key:"start-"+t.id,ref:"start-"+t.id,refInFor:!0,staticClass:"ma-calendar-location ma-calendar-location-start",class:{"has-location-error":t.startLocation.hasError},attrs:{draggable:"true"},on:{click:function(s){s.preventDefault(),s.stopPropagation(),e.$store.state.defaultSettings.defaultStartLocation.overridable&&e.searchLocation(e.Location.START,t,s)}}},[s("div",{staticClass:"slds-grid"},[e._m(0,!0),e._v(" "),s("div",{staticClass:"slds-col ma-calendar-start-location-title"},[e._v("\n                        "+e._s(e._f("decode")(t.record.StartAddress__c))+"\n                    ")]),e._v(" "),e.$store.state.defaultSettings.defaultStartLocation.overridable?s("div",{staticClass:"ma-calendar-start-location-actions",on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.removeLocation(t,e.Location.START)}}},[s("span",{staticClass:"ma-icon ma-icon-remove"})]):e._e()]),e._v(" "),t.startLocation.distance?s("RouteTimeAndDistance",{staticClass:"start-route-time-wrapper",attrs:{distance:t.startLocation.distance,totalTravelTime:t.startLocation.totaltraveltime,travelMode:e.travelMode}}):e._e(),e._v(" "),t.startLocation.hasError?s("EventError",{attrs:{event:t.startLocation}}):e._e()],1)})),e._v(" "),e._l(e.base__shifts,(function(t){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.endLocation.doShow,expression:"shift.endLocation.doShow"}],key:"end-"+t.id,ref:"end-"+t.id,refInFor:!0,staticClass:"ma-calendar-location ma-calendar-location-end",class:{"has-location-error":t.endLocation.hasError},attrs:{draggable:"true"},on:{click:function(s){s.preventDefault(),s.stopPropagation(),e.$store.state.defaultSettings.defaultEndLocation.overridable&&e.searchLocation(e.Location.END,t,s)}}},[s("div",{staticClass:"slds-grid"},[e._m(1,!0),e._v(" "),s("div",{staticClass:"slds-col ma-calendar-end-location-title"},[e._v("\n                        "+e._s(e._f("decode")(t.record.EndAddress__c))+"\n                    ")]),e._v(" "),e.$store.state.defaultSettings.defaultEndLocation.overridable?s("div",{staticClass:"ma-calendar-end-location-actions",on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.removeLocation(t,e.Location.END)}}},[s("span",{staticClass:"ma-icon ma-icon-remove"})]):e._e()]),e._v(" "),t.endLocation.hasError?s("EventError",{attrs:{event:t.endLocation}}):e._e()],1)}))],2),e._v(" "),e.locationSearch.doRender?s("LocationSearch",{attrs:{locationRef:e.locationSearch.el,locationRect:e.locationSearch.rect,label:"Set "+e.locationSearchAsString+" Location",selectedHandler:e.locationSelected,searchType:e.locationSearchAsString},on:{close:e.closeLocationSearch}}):e._e(),e._v(" "),e.actionMenu.doRender?s("MAActionMenu",{ref:"actionMenu",attrs:{doShowSync:e.actionMenu.doShow,isDisabled:e.isActionMenuDisabled,isToggleValid:e.actionMenuToggleValidationFn,hideOnMouseout:"",bindTo:e.actionMenu.bindRef,bindToMousePosition:"",showMoreLabel:e.$Labels.MA_SHOW_MORE},on:{"update:doShowSync":function(t){return e.$set(e.actionMenu,"doShow",t)},"update:do-show-sync":function(t){return e.$set(e.actionMenu,"doShow",t)},bindToClick:e.analyzeCreateTarget,hide:e.hideActionMenu}},[e.actionMenu.showStart&&e.$store.state.defaultSettings.defaultStartLocation.overridable?s("MAActionMenuItem",{attrs:{label:"Set Start Location"},on:{click:function(t){return e.setLocationHandler(e.Location.START)}}}):e._e(),e._v(" "),e.actionMenu.showEnd&&e.$store.state.defaultSettings.defaultEndLocation.overridable?s("MAActionMenuItem",{attrs:{label:"Set End Location"},on:{click:function(t){return e.setLocationHandler(e.Location.END)}}}):e._e()],1):e._e(),e._v(" "),e.store__isAgendaWeek?s("Queue",{staticClass:"schedule-week-queue",attrs:{allowOptimization:!0,shifts:e.base__shifts},on:{optimize:e.optimizeWeekly}}):e._e(),e._v(" "),e._l(e.base__columnIdToDayInstance,(function(t){return s("ShiftColor",{key:"shift-color-"+t.columnId,ref:"shift-color-"+t.columnId,refInFor:!0,staticClass:"ma-shift-color",attrs:{hidden:e.store__isAgendaDay||-1===t.columnId,shiftColor:""+e.getShiftColorHex(t.columnId)}})})),e._v(" "),e._l(e.base__columnIdToDayInstance,(function(t){return s("RouteSelector",{key:"route-selector-"+t.columnId,ref:"route-selector-"+t.columnId,refInFor:!0,staticClass:"ma-route-selector",class:{"slds-m-right_x-small":e.store__isAgendaDay},style:e.store__hasOverlappingShifts||-1===t.columnId?"display: none;":"",attrs:{shifts:t.shifts},on:{"toggle-route":e.toggleRouteByShift,"toggle-visibility":e.toggleVisibilityByShift}})}))],2)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ma-calendar-start-location-flag"},[t("span",{staticClass:"ma-icon ma-icon-priority"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ma-calendar-end-location-flag"},[t("span",{staticClass:"ma-icon ma-icon-goal"})])}],!1,null,"522e7c32",null).exports;var De=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("figure",{staticClass:"slds-m-right_large"},[t("img",{attrs:{src:s(6126)}})])])}];const{$:Ae}=window;function Me(){return{defaultDate:this.store__calendarDate.format(),header:!1,height:()=>{let e=Ae(".schedulePanel.is-schedule-resource").height()-Ae("#schedulePanelHeader").height();return e+=18,e},editable:!0,lazyFetching:!1,droppable:!0,now:this.store__staticTime,nowIndicator:!0,schedulerLicenseKey:window.fullcalendarKey,timezone:this.$User.timezoneId,locale:this.$User.UserLocale,navLinks:!0,timeFormat:this.$User.timeFormat,defaultView:a.YV.TIMELINE_DAY,resourceLabelText:window.MASystem.Labels.MA_RESOURCES,resourceAreaWidth:"250",slotWidth:"64",forceEventDuration:!0,resources:[],resourceRender:(e,t)=>{const s=t.find(".fc-cell-content"),a=Ae("<button />",{class:"slds-button slds-button_icon slds-button_icon-small",click:()=>{this.$bus.$emit("remove-resources",[e.id])}}),i=Ae("<span />",{class:"ma-icon ma-icon-remove"});a.append(i).appendTo(s),this.$nextTick((()=>{Ae(this.$refs[e.id][0].$el).detach().prependTo(s)}))},eventRender:(e,t)=>{"inverse-background"!==e.rendering&&(this.$set(this.eventIdToHTMLElementMap,e.id,t),this.$nextTick((()=>{const s=Ae(this.$refs[e.id]);if(!s.length)return;const a=t.find(".fc-bg").detach(),i=t.find(".fc-start-resizer").detach(),o=t.find(".fc-end-resizer").detach(),n=t.find(".fc-title").detach(),r=this.base__events.find((t=>t.id===e.id));s.find(".fc-title").remove(),t.empty(),t.append(s),t.append(a),t.append(i),t.append(o),t.find(".fc-content").prepend(n),r&&r.backgroundColor&&(t.css("background-color",`#${r.backgroundColor}`),t.css("color",(0,f.Qg)(r.backgroundColor))),e.hasError&&t.addClass("has-error")})))},eventReceive:e=>{this.base__adjustToUserTimezone(e.end).add(-1*e.end.utcOffset(),"m"),this.base__adjustToUserTimezone(e.start).add(-1*e.start.utcOffset(),"m"),this.base__hasModifiedEvents=!0,this.base__updatedEventsSet.add(e.id),this.base__numEventsReceived++,this.store__removeItemFromQueueById(e.id),this.base__events.push(e),this.base__setShiftIdOnEvents([e]),this.removeRouteByShiftId(e.shiftId),this.removeErrorsFromLocationWaypoints(e.shiftId),this.base__$calendar.fullCalendar("updateEvent",e)},eventClick:e=>{const t=this.base__shifts.find((t=>t.id===e.shiftId));e&&t&&t.routing&&this.base__showEventOnMap(e,t.routing)},eventDrop:e=>{this.base__hasModifiedEvents=!0,this.base__updatedEventsSet.add(e.id);const t=this.base__events.find((t=>t.id===e.id));this.removeRouteByShiftId(t.shiftId),this.removeErrorsFromLocationWaypoints(t.shiftId),this.removeRouteByShiftId(e.shiftId),this.removeErrorsFromLocationWaypoints(e.shiftId),t.resourceId=e.resourceId,t.hasError=!1,e.hasError=!1,this.base__setShiftIdOnEvents([e]),this.base__$calendar.fullCalendar("updateEvent",e)},eventAfterAllRender:()=>{this.base__$calendar.fullCalendar("getView").stopNowIndicator()},eventResize:e=>{this.base__hasModifiedEvents=!0,this.base__updatedEventsSet.add(e.id),this.removeRouteByShiftId(e.shiftId),this.removeErrorsFromLocationWaypoints(e.shiftId),this.base__events.find((t=>t.id===e.id)).hasError=!1,e.hasError=!1,this.base__$calendar.fullCalendar("updateEvent",e),this.base__$calendar.fullCalendar("rerenderEvents")},eventResizeStop:()=>{this.base__$calendar.fullCalendar("rerenderEvents")},eventDragStart:e=>{this.base__events.find((t=>t.id===e.id)).hasError=!1},eventDragStop:()=>{this.base__$calendar.fullCalendar("rerenderEvents")},eventMouseout:this.base__eventMouseoutHandler,dayNames:this.base__getDayNames(),dayNamesShort:this.base__getDayNamesShort(),monthNames:this.base__getMonthNames(),monthNamesShort:this.base__getMonthNamesShort(),viewRender:()=>{this.init(),this.$bus.$emit("render-date-string",this.store__calendarDate),setTimeout((()=>{Ae(window).trigger("resize")}),1e3)},viewDestroy:this.resetComponentState}}const{$:$e,moment:ke,MA:Re}=window,xe=["2196F3","F44336","4CAF50","9C27B0","FFEB3B","00BCD4","E91E63","FF9800","009688","795548","263238","673AB7","CDDC39","B71C1C","0D47A1","8BC34A","03A9F4","9E9E9E","1B5E20","FFC107","4A148C","607D8B","F57F17","3F51B5","FF5722"],Oe={components:{Checkbox:o.XZ,ActionMenu:o.PC,ActionMenuItem:o.F9,Tooltip:o.u,EventError:z,RouteTimeAndDistance:u.Z,ResourceSearch:U,CalendarControls:Z,Queue:de,LaborLawNotify:ce,PendingChangeModal:fe,SaveErrorModal:be},directives:{"click-outside":V.Z},extends:A,data:()=>({didLoadResources:!1,resources:[],storedResourceSearchTerm:"",isAddResourcePopupOpen:!1,resourceIdToDayInstance:{},eventIdToHTMLElementMap:{},colorSet:new Set}),computed:{showEmptyStateSVG(){return!this.resources.length},clickOutsideOptions(){return{active:!0,handler:this.doHideResourceSearchPopup}},getShiftedBaseEvents(){return this.base__events}},watch:{store__calendarDate(e){this.base__$calendar.fullCalendar("gotoDate",e)},store__calendarView(e){this.base__emitViewModeChangeEvent(e)}},created(){this.$bus.$on("remove-resources",this.removeResourcebyIds),this.$bus.$on("hide-plotted-schedule",this.removeAllRoutes)},destroyed(){this.$bus.$on("remove-resources",this.removeResourcebyIds),this.$bus.$off("hide-plotted-schedule",this.removeAllRoutes)},mounted(){this.base__$calendar=$e(this.$refs.calendar),this.base__$calendar.fullCalendar(Me.call(this)),this.base__forceMapResize(),this.base__setDefaultDuration(this.base__convertStringToMinutes(d.Z.routeDefaults.duration))},beforeDestroy(){this.removeAllRoutes()},methods:{buildNonWorkingHourEvents(){const e=[];return Object.keys(this.resourceIdToDayInstance).forEach((t=>{this.resourceIdToDayInstance[t].shifts.forEach((s=>e.push({id:(0,a.ZP)(),resourceId:t,title:"Non-working Hours",className:"non-working-hours",start:s.startTime,end:s.endTime,rendering:"inverse-background"})))})),e},async init(){this.base__callouts+=1;try{await this.fetchResources(),await this.loadAllResourceEvents(),await this.initializeShifts(),this.base__setShiftIdOnEvents(this.base__events),this.base__$calendar.fullCalendar("renderEvents",this.base__events),this.scrolllToFirstEvent();const e=this.getShiftAnalysis();if(this.setTimeAxisRange(e),this.base__skipTimeAxisCheck)return;this.$nextTick((()=>{const e=this.buildNonWorkingHourEvents();this.base__$calendar.fullCalendar("renderEvents",e),this.renderShifts()}))}catch(e){console.error(e),this.base__genericPromiseErrorHandler(e)}finally{this.base__callouts-=1}},async initializeShifts(){const e=[];this.base__$calendar.fullCalendar("getResources").forEach((t=>{e.push(this.base__fetchRouteDefaultsByResource({id:t.id,name:t.title}))}));const t=await Promise.all(e);this.buildInstancesByRouteDefaultsArr(t),await this.setShiftsOnInstances()},setShiftsOnInstances(){return new Promise((e=>{const t=Object.values(this.resourceIdToDayInstance).map((e=>this.base__fetchCalendarShifts(e.routeDefaults)));Promise.all(t.map((e=>e.catch((e=>this.base__showMapToastError(e.message)))))).then((t=>{t.forEach((e=>{const{request:{resourceId:t}={}}=e,s=this.resourceIdToDayInstance[t];this.base__setShiftsOnInstance(s,e),s.shifts.forEach((e=>this.base__shifts.push(e)))})),e()}))}))},getShiftAnalysis(){const e={earliestShiftTime:null,latestShiftTime:null,hasOvernightShift:!1};return Object.keys(this.resourceIdToDayInstance).forEach((t=>{const s=this.resourceIdToDayInstance[t];e.earliestShiftTime&&!s.earliestShiftTime.isBefore(e.earliestShiftTime)||(e.earliestShiftTime=s.earliestShiftTime),e.latestShiftTime&&!s.latestShiftTime.isAfter(e.latestShiftTime)||(e.latestShiftTime=s.latestShiftTime),!e.hasOvernightShift&&s.hasOvernightShift&&(e.hasOvernightShift=!0)})),e},buildInstancesByRouteDefaultsArr(e){const t=ke.tz(this.base__$calendar.fullCalendar("getDate").format(),ke.ISO_8601,this.$User.timezoneId);e.forEach((e=>{e.duration=this.base__convertStringToMinutes(e.duration);const s=e.resource.id,a={resourceId:s,calendarDate:t,routeDefaults:e,workingHours:e.workingHours};this.$set(this.resourceIdToDayInstance,s,a)}))},setTimeAxisRange({earliestShiftTime:e,latestShiftTime:t,hasOvernightShift:s}){if(this.base__skipTimeAxisCheck)this.base__skipTimeAxisCheck=!1;else if(s){this.base__skipTimeAxisCheck=!0;const s=4,a=this.base__buildTimeAxisString(e,-s),i=this.base__buildTimeAxisString(t,24+s);this.base__setTimeAxisRange(a,i)}else this.base__skipTimeAxisCheck=!0,this.base__setTimeAxisRange("00:00:00","24:00:00")},renderShifts(){Object.values(this.resourceIdToDayInstance).forEach((e=>e.shifts.forEach((e=>{e.startLocation.isSpatial&&setTimeout((()=>{this.renderStartLocation(e),e.startLocation.doShow=!0}),Re.Util.isIE()?500:1),e.endLocation.isSpatial&&setTimeout((()=>{this.renderEndLocation(e),e.endLocation.doShow=!0}),Re.Util.isIE()?500:1)}))))},renderStartLocation(e){const t=this.renderLocation(e.startTime,e.resourceId,`start-${e.id}`),s=this.$refs[`start-tooltip-${e.id}`];s&&s.length&&(s[0].sourceStored=$e(t).find(".ma-drive-summary-line").get(0),s[0].bindToStored=$e(t).find(".ma-drive-summary-line").get(0));const a=this.$refs[`start-error-tooltip-${e.id}`];a&&a.length&&(a[0].sourceStored=t,a[0].bindToStored=t)},renderEndLocation(e){const t=this.renderLocation(e.endTime,e.resourceId,`end-${e.id}`),s=this.$refs[`end-error-tooltip-${e.id}`];s&&s.length&&(s[0].sourceStored=t,s[0].bindToStored=t)},renderLocation(e,t,s){const a=e.format("YYYY-MM-DDTHH:00:00"),i=$e(`.fc-timelineDay-view th[data-date="${a}"]`),o=this.$refs[s];if(!i.length||!o)return;const n=e.minutes()/60,r=i.width(),l=i.get(0).offsetLeft+n*r;o[0].style.left=`${l}px`,o[0].style.display="",o[0].id=s,$e(`.fc-time-area tr[data-resource-id="${t}"] > td.fc-widget-content`).append(o[0])},removeAllResources(){this.removeResourcebyIds(this.resources.map((e=>e.id)))},softResetComponentState(){this.colorSet.clear(),this.resources.forEach((e=>{e.isActive=!1})),this.unrenderRoutesFromMap(),this.eventIdToHTMLElementMap={}},resetComponentState(){this.base__resetComponentState(),this.softResetComponentState()},unrenderRoutesFromMap(){this.base__shifts.forEach((e=>{const t=this.getResourceById(e.resourceId);t&&(t.isActive=!1),e.routing&&this.removeRouteByShiftId(e.id)}))},removeAllRoutes(){this.unrenderRoutesFromMap(),this.$bus.$emit("set-calendar-view-mode",a.Oq.DEFAULT),this.$bus.$emit("rerenderAgendaCalendar")},removeRouteByShiftId(e){const t=this.base__shifts.find((t=>t.id===e));if(!t||!t.routing)return;t.routing.clearRouteOnMap(),this.colorSet.delete(t.routing.strokeColor),this.removeTravelSummaryFromLocationWaypoints(e),this.removeTravelSummaryFromCalendarEventsByShiftId(e);const s=this.resources.find((e=>e.id===t.resourceId));s&&(s.isActive=!1);const a=this.base__$calendar.fullCalendar("clientEvents").filter((e=>e.resourceId===t.resourceId));this.base__$calendar.fullCalendar("updateEvents",a),t.routing=null},toggleResourceHandler(e){if(this.resources.filter((e=>e.isActive)).length>25)return void this.$nextTick((()=>{this.$set(e,"isActive",!1),this.$emit("error","You can only plot 25 resources at a time. Please toggle off a resource before plotting another.")}));const t=this.base__shifts.find((t=>t.resourceId===e.id));e.isActive?this.generateRouteByShift(t).catch((t=>{this.$nextTick((()=>{this.$set(e,"isActive",!1),this.base__showMapToastError(t)}))})).finally(this.base__genericPromiseFinallyHandler):(e.isActive=!1,Re.Map.InfoBubble.hide(),this.removeRouteByShiftId(t.id))},getResourceById(e){const[t]=this.resources.filter((t=>t.id===e));return t},removeErrorsFromLocationWaypoints(e){const t=this.base__shifts.find((t=>t.id===e));if(!t)return;const{startLocation:s,endLocation:a}=t;s.hasError=!1,a.hasError=!1},removeTravelSummaryFromLocationWaypoints(e){const{startLocation:t}=this.base__shifts.find((t=>t.id===e));t.isSpatial&&(t.distance=0,t.totaltraveltime=0,t.timeInPixels=0)},removeTravelSummaryFromCalendarEventsByShiftId(e){this.base__events.forEach((t=>{t.shiftId===e&&(delete t.distance,delete t.totaltraveltime,delete t.stopNumber,delete t.backgroundColor,delete t.timeInPixels,delete t.travelMode,delete t.units)}))},async addResource(e){this.doHideResourceSearchPopup();try{if(25===this.resources.length)return void this.$emit("error","You may only have 25 resources. Please remove a resource before adding another.");if(this.isResourceAlreadyLoaded(e))return void this.$emit("error",`The resource, ${e.name}, is already loaded.`);this.base__callouts+=1;const t={id:e.id,name:window.htmlDecode(e.name),title:window.htmlDecode(e.name),timezone:e.timezone?window.htmlDecode(e.timezone):window.htmlDecode(this.$User.timezoneId),isActive:!1};this.resources.push(t),await this.saveResources(),this.base__$calendar.fullCalendar("clientEvents").forEach((e=>{"inverse-background"===e.rendering&&this.base__$calendar.fullCalendar("removeEvents",e.id)})),this.base__$calendar.fullCalendar("addResource",t),await this.loadResourceEventsByResource(t),this.softResetComponentState(),await this.initializeShifts(),this.base__setShiftIdOnEvents(this.base__events.filter((t=>t.resourceId===e.id))),this.base__$calendar.fullCalendar("renderEvents",this.base__events.filter((t=>t.resourceId===e.id)));const s=this.getShiftAnalysis();if(this.setTimeAxisRange(s),this.base__skipTimeAxisCheck)return;this.$nextTick((()=>{const e=this.buildNonWorkingHourEvents();this.base__$calendar.fullCalendar("renderEvents",e),this.renderShifts()}))}catch(e){this.$emit("error",e)}finally{this.base__callouts-=1}},getNextColor(){const e=xe.find((e=>!this.colorSet.has(e)));if(!e)throw new Error("No more colors available.");return this.colorSet.add(e),e},generateRouteByShift(e){return new Promise(((t,s)=>{try{if(!e)return void t();e.routing=this.instantiateRouteByShift(e),this.base__callouts+=1,e.routing.build("scheduling").then((()=>{const s=e.routing.getRoute();l.Z.moreThanOneRoute(s,(t=>{this.processWaypoints(t.waypoints,e.routing.strokeColor,e)})),this.base__$calendar.fullCalendar("rerenderEvents"),t()})).catch((t=>{t&&t.maioCode&&t.details&&this.base__processResponseErrors(t,e),s(t.message),this.removeRouteByShiftId(e.id)}))}catch(e){s(e)}}))},processWaypoints(e,t,s){if(!e.length)return;const a=$e(".fc-time-area th:first-child").width();function i(e){return parseInt(e/3600*a,10)}const o=this.resourceIdToDayInstance[s.resourceId],{mode:n,units:r}=o;if(s.startLocation&&e[0].id===s.startLocation.id){const t=e.shift();s.startLocation.distance=t.distance,s.startLocation.totaltraveltime=t.totaltraveltime,s.startLocation.timeInPixels=i(t.totaltraveltime),s.startLocation.units=r,s.startLocation.mode=n}for(let s=0;s<e.length;s++){const a=e[s],o=this.base__events.findIndex((e=>e.id===a.id));if(-1===o)return;const l=this.eventIdToHTMLElementMap[this.base__events[o].id],d=i(a.totaltraveltime);this.$set(this.base__events,o,{...this.base__events[o],stopNumber:s+1,backgroundColor:t,fontColor:(0,f.Qg)(`#${t}`),distance:a.distance,totaltraveltime:a.totaltraveltime,timeInPixels:d,offsetLeft:l.offsetLeft,clientWidth:l.width(),travelMode:n,units:r})}},instantiateRouteByShift(e){const t=this.base__$calendar.fullCalendar("clientEvents").filter((t=>t.shiftId===e.id)),s=this.base__buildWaypointsFromEvents(t,[e]),a=this.getNextColor(),i=this.base__instantiateRoute(e,s);return i.setStrokeColor(a),i.setWaypointColor(a),i},isResourceAlreadyLoaded(e){return this.base__$calendar.fullCalendar("getResourceById",e.id)},async removeResourcebyIds(e){this.base__callouts+=1;try{this.resources=this.resources.filter((t=>!e.includes(t.id))),e.forEach((e=>{this.base__$calendar.fullCalendar("removeResource",e),delete this.resourceIdToDayInstance[e]})),await this.saveResources(),this.base__$calendar.fullCalendar("clientEvents").forEach((e=>{"inverse-background"===e.rendering&&this.base__$calendar.fullCalendar("removeEvents",e.id)})),this.base__$calendar.fullCalendar("clientEvents").filter((t=>e.includes(t.resourceId))).map((e=>e.id)).forEach((e=>{this.base__$calendar.fullCalendar("removeEvents",e)})),this.base__events=this.base__events.filter((t=>!e.includes(t.resourceId))),this.softResetComponentState(),await this.initializeShifts();const t=this.getShiftAnalysis();if(this.setTimeAxisRange(t),this.base__skipTimeAxisCheck)return;this.$nextTick((()=>{const e=this.buildNonWorkingHourEvents();this.base__$calendar.fullCalendar("renderEvents",e),this.renderShifts()}))}catch(e){this.$emit("error",e)}finally{this.base__callouts-=1}},loadAllResourceEvents(){return this.loadResourceEvents(this.base__$calendar.fullCalendar("getResources"))},loadResourceEventsByResource(e){return this.loadResourceEvents([e])},loadResourceEvents(e){return new Promise(((t,s)=>{const a=this.base__$calendar.fullCalendar("getDate").startOf("day"),i=this.base__$calendar.fullCalendar("getDate").endOf("day"),o=this.$User.timezoneId,n=[];e.forEach((e=>{const t=this.base__adjustToUserTimezone(a.clone()),s=this.base__adjustToUserTimezone(i.clone()),r=e.timezone?e.timezone:o;n.push(this.base__fetchEvents(t,s,r,e.id))})),Promise.all(n).then((e=>{e.forEach((e=>{this.base__events=this.base__events.concat(e)})),t()})).catch((e=>{s(e)}))}))},scrolllToFirstEvent(){if(!this.base__$calendar.fullCalendar("getResources").length||this.base__performedScrollToLogic)return;const e=this.base__$calendar.find("div.fc-event-container a");let t=e&&e.length>0?e[0].offsetLeft:0;e.each(((e,s)=>{s.offsetLeft<t&&(t=s.offsetLeft)})),$e("div.fc-scroller").animate({scrollLeft:t},250),this.base__performedScrollToLogic=!0},fetchResources(){return new Promise(((e,t)=>{if(this.didLoadResources)return void e();const s=this.base__calendarId.startsWith("005")?this.base__calendarId:this.$User.Id;(new _.Z).setAction(this.$Remoting.getCalendarResourcesByUserId).setErrorHandler(this.base__handleRemoteActionError.bind(this,t)).invoke([s],(a=>{h.Z.debugRemotingData("getCalendarResourcesByUserId",[s],a);try{a.success?(a.data.forEach((e=>{e.isActive=!1,e.title="string"==typeof e.title?window.htmlDecode(e.title):e.title,this.resources.push(e),this.base__$calendar.fullCalendar("addResource",e)})),this.didLoadResources=!0,e()):t(new Error(a.message))}catch(e){t(new Error(e))}}))}))},saveResources(){const e=this;return new Promise(((t,s)=>{const a=this.resources.map((function(t){return{id:t.id,title:t.title,timezone:t.timezone?t.timezone:e.$User.timezone}}));(new _.Z).setAction(this.$Remoting.saveCalendarResources).setErrorHandler(this.base__handleRemoteActionError.bind(this,s)).invoke([a,this.base__calendarId],(e=>{h.Z.debugRemotingData("saveCalendarResources",[a,this.base__calendarId],e),e.success?t():s(new Error(e.message))}))}))},save(){return this.base__save().then((()=>{this.softResetComponentState(),this.init()})).catch((()=>{}))},setConfigId(e){this.base__setConfigId(e),this.base__save().then((()=>{this.base__storedNavigationAction&&"function"==typeof this.base__storedNavigationAction&&this.base__storedNavigationAction(),this.resetComponentState()}))},deleteEvent(e){this.removeRouteByShiftId(e.shiftId),this.base__deleteEvent(e)},returnEventToQueue(e){this.deleteEvent(e);const t={...e};delete t.shiftId,delete t.recordId,delete t.resourceId,delete t.start,delete t.end,delete t.hasError,delete t.source,delete t.distance,delete t.totaltraveltime,delete t.errorMessage,delete t.errorTimeString,delete t.bgColorClass,t.hasError=!1,this.store__addItemToQueue(t),this.base__hasModifiedEvents=!0},setExcludeInclude(e){this.removeRouteByShiftId(e.shiftId),this.base__setExcludeInclude(e)},setFocus(){this.$nextTick((()=>this.$el.querySelector("input").focus()))},doHideResourceSearchPopup(){this.isAddResourcePopupOpen=!1,this.storedResourceSearchTerm=""}}};var Fe=(0,D.Z)(Oe,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slds-grid slds-grid_vertical",staticStyle:{height:"100%"}},[s("div",{staticClass:"slds-grid",staticStyle:{height:"100%"}},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-col",staticStyle:{height:"100%"}},[s("PendingChangeModal",{attrs:{showModal:e.base__showPendingChangeModal},on:{"update:showModal":function(t){e.base__showPendingChangeModal=t},"update:show-modal":function(t){e.base__showPendingChangeModal=t},discard:e.base__completeNavigationRequest,save:e.base__saveAndCompleteNavigationRequest}}),e._v(" "),e.base__showSaveErrorModal?s("SaveErrorModal",{attrs:{errors:e.base__configErrors},on:{hide:e.base__hideSaveErrorModal,save:e.setConfigId}}):e._e(),e._v(" "),e.base__laborLawNotify?s("LaborLawNotify"):e._e(),e._v(" "),s("div",{staticClass:"schedule-week-header slds-p-left_medium slds-p-right_x-small slds-p-vertical_small",attrs:{id:"schedulePanelHeader"}},[s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"slds-grid slds-col"},[s("CalendarControls",{on:{today:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__today].concat(a))},previous:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__previous].concat(a))},next:function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__next].concat(a))},"view-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarView].concat(a))},"date-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.base__navigationAction.apply(void 0,[e.base__changeCalendarDate].concat(a))}}})],1),e._v(" "),s("div",[s("button",{staticClass:"slds-button slds-button_success",attrs:{disabled:e.base__doDisableSaveBtn},on:{click:e.save}},[e._v("\n                            "+e._s(e.$Labels.MA_Save)+"\n                        ")])]),e._v(" "),s("div",{staticClass:"slds-p-left_medium ma-resource-right-menu"},[s("ActionMenu",{attrs:{showMoreLabel:e.$Labels.MA_SHOW_MORE}},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",attrs:{slot:"button"},slot:"button"},[s("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.MA_REMOVE_ALL_RESOURCES},on:{click:e.removeAllResources}}),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.MA_REMOVE_ALL_FROM_MAP},on:{click:e.unrenderRoutesFromMap}}),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.MA_SCHEDULE_RETURN_ALL_TO_BE_SCHEDULED},on:{click:e.base__returnAllEventsToQueue}})],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.base__showFullScreenToggleControl,expression:"base__showFullScreenToggleControl"}],staticClass:"slds-p-left_xx-small"},[s("button",{staticClass:"slds-button slds-button_icon slds-button_icon-container",on:{click:function(t){return e.$emit("toggleFullScreen")}}},[s("span",{staticClass:"slds-button__icon ma-icon ma-icon-expand"}),e._v(" "),s("span",{staticClass:"slds-button__icon ma-icon ma-icon-contract"})])])])]),e._v(" "),s("div",{staticClass:"slds-col slds-grid",attrs:{id:"schedulePanelBody"}},[s("div",{staticClass:"addResourceButtonPositioner"},[s("button",{staticClass:"addResourceButton slds-button",on:{click:function(t){e.isAddResourcePopupOpen=!0,e.setFocus()}}},[s("span",{staticClass:"slds-button__icon slds-button__icon_left ma-icon ma-icon-new"}),e._v("\n                        "+e._s(e.$Labels.MA_Add)+"\n                    ")]),e._v(" "),e.isAddResourcePopupOpen?s("section",{directives:[{name:"click-outside",rawName:"v-click-outside:[clickOutsideOptions]",arg:e.clickOutsideOptions}],staticClass:"slds-popover slds-nubbin_bottom-left"},[s("div",{staticClass:"slds-popover__body"},[s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"slds-col"},[s("ResourceSearch",{attrs:{storedSearchTerm:e.storedResourceSearchTerm},on:{selected:e.addResource}})],1),e._v(" "),s("div",{staticClass:"slds-p-left_x-small"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:e.doHideResourceSearchPopup}},[e._v("\n                                        "+e._s(e.$Labels.MA_Cancel)+"\n                                    ")])])])])]):e._e()]),e._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical slds-col",attrs:{id:"schedulePanelCalendarWrap"}},[s("div",{ref:"calendar",staticClass:"ma-calendar slds-grid slds-grid_vertical slds-col"})]),e._v(" "),e.showEmptyStateSVG?s("div",{staticClass:"resource-empty-state"},[s("div",{staticClass:"slds-grid slds-grid_align-center slds-grid_vertical-align-center"},[e._m(0),e._v(" "),s("div",[s("h4",[e._v(e._s(e.$Labels.MA_RESOURCES_NO_RESOURCES_ADDED))]),e._v(" "),s("p",[e._v(e._s(e.$Labels.MA_RESOURCE_CLICK_THE_ADD_A_RESOURCE_BUTTON_GUIDE_TEXT))])])])]):e._e()]),e._v(" "),s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"slds-col"}),e._v(" "),s("div",e._l(e.resources,(function(t){return s("Checkbox",{key:t.id,ref:t.id,refInFor:!0,attrs:{slide:"",labels:{name:t.title},hideLabel:"",toggleBuffer:2e3},on:{changed:function(s){return e.toggleResourceHandler(t)}},model:{value:t.isActive,callback:function(s){e.$set(t,"isActive",s)},expression:"resource.isActive"}})})),1)]),e._v(" "),e._l(e.getShiftedBaseEvents,(function(t){return s("div",{key:t.id,ref:t.id,refInFor:!0,staticClass:"ma-resource-event"},[s("div",{staticClass:"fc-content slds-grid_vertical-align-center slds-grid_align-spread"},[t.excludeFromRoute?s("span",{staticClass:"ma-icon ma-icon-nonspacial event-icon--right"}):e._e(),e._v(" "),t.isBreak?e._e():s("div",{staticClass:"ma-event-controls slds-col_bump-left"},[t.spatial?s("ActionMenu",{staticClass:"slds-button_last",attrs:{doShowSync:t.showActionMenu,showMoreLabel:e.$Labels.MA_SHOW_MORE},on:{"update:doShowSync":function(s){return e.$set(t,"showActionMenu",s)},"update:do-show-sync":function(s){return e.$set(t,"showActionMenu",s)}}},[s("button",{staticClass:"schedule-event-button",attrs:{slot:"button"},slot:"button"},[s("span",{staticClass:"ma-icon ma-icon-threedots-vertical"})]),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.MA_Delete},on:{click:function(s){return e.deleteEvent(t)}}}),e._v(" "),s("ActionMenuItem",{attrs:{label:e.base__getExcludeIncludeActionLabel(t)},on:{click:function(s){return e.setExcludeInclude(t)}}}),e._v(" "),s("ActionMenuItem",{attrs:{label:e.$Labels.MA_SCHEDULE_RETURN_TO_BE_SCHEDULED},on:{click:function(s){return e.returnEventToQueue(t)}}})],1):e._e()],1)]),e._v(" "),t.timeInPixels?s("div",{staticClass:"ma-drive-summary-line",style:{width:t.timeInPixels+"px"}},[s("Tooltip",{attrs:{source:e.eventIdToHTMLElementMap[t.id][0],assistiveText:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("RouteTimeAndDistance",{staticClass:"ma-time-distance",attrs:{distance:t.distance,totalTravelTime:t.totaltraveltime,travelMode:t.travelMode,units:t.units}})],1)])],1):e._e(),e._v(" "),t.hasError?s("Tooltip",{staticClass:"waypoint-error-tooltip",attrs:{source:e.eventIdToHTMLElementMap[t.id][0],assistiveText:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("EventError",{attrs:{event:t}})],1)]):e._e()],1)})),e._v(" "),e._l(e.base__shifts,(function(t){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.startLocation.doShow,expression:"shift.startLocation.doShow"}],key:"start-"+t.id,ref:"start-"+t.id,refInFor:!0,staticClass:"ma-resource-location ma-resource-location-start",class:{"has-location-error":t.startLocation.hasError}},[s("div",{staticClass:"ma-drive-summary-line"},[t.startLocation.timeInPixels?s("Tooltip",{ref:"start-tooltip-"+t.id,refInFor:!0,style:{width:t.startLocation.timeInPixels+"px"},attrs:{assistiveText:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("RouteTimeAndDistance",{staticClass:"ma-time-distance",attrs:{distance:t.startLocation.distance,totalTravelTime:t.startLocation.totaltraveltime,travelMode:t.startLocation.mode,units:t.startLocation.units}})],1)]):e._e()],1),e._v(" "),s("div",{staticClass:"ma-icon ma-icon-priority"}),e._v(" "),t.startLocation.hasError?s("Tooltip",{ref:"start-error-tooltip-"+t.id,refInFor:!0,staticClass:"waypoint-error-tooltip",attrs:{assistiveText:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("EventError",{attrs:{event:t.startLocation}})],1)]):e._e()],1)})),e._v(" "),e._l(e.base__shifts,(function(t){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.endLocation.doShow,expression:"shift.endLocation.doShow"}],key:"end-"+t.id,ref:"end-"+t.id,refInFor:!0,staticClass:"ma-resource-location ma-resource-location-end",class:{"has-location-error":t.endLocation.hasError}},[s("div",{staticClass:"ma-icon ma-icon-goal"}),e._v(" "),t.endLocation.hasError?s("Tooltip",{ref:"end-error-tooltip-"+t.id,refInFor:!0,staticClass:"waypoint-error-tooltip",attrs:{assistiveText:e.$Labels.MA_HELP}},[s("div",{staticClass:"slds-grid resource-drive-time"},[s("EventError",{attrs:{event:t.endLocation}})],1)]):e._e()],1)}))],2),e._v(" "),s("Queue",{staticClass:"schedule-week-queue",attrs:{allowOptimization:!1}})],1)])}),De,!1,null,"b2801898",null);const He=Fe.exports,{$:Ne}=window,ze={components:{MAToast:n.Z,Spinner:o.$j,Calendar:Ie,ResourceCalendar:He},data:()=>({toast:"",viewMode:a.Oq.DEFAULT,hasRightPanelIn:!1,isLoading:!0,doLoad:!1,mountedCallback:null}),computed:{...(0,i.mapGetters)("tabs",{tabs__isTabActive:"isTabActive"}),isTabActive(){return this.tabs__isTabActive(a.mQ.SCHEDULING)},isHalfHeight(){return this.viewMode===a.Oq.FULLWIDTH_HALFHEIGHT},isFullHeight(){return this.viewMode===a.Oq.FULLWIDTH_FULLHEIGHT},showFullScreenToggleControl(){return this.isHalfHeight||this.isFullHeight},...(0,i.mapGetters)("scheduling",{store__isAgendaDay:"isAgendaDay",store__isTimelineDay:"isTimelineDay",store__isAgendaWeek:"isAgendaWeek",store__isQueueCollapsed:"isQueueCollapsed",store__isQueueToggling:"isQueueToggling",store__unsupportedItems:"unsupportedItems"})},watch:{isTabActive(e){e?(this.doLoad||setTimeout((()=>{this.doLoad=!0}),300),this.$bus.$emit("set-map-view-mode",this.viewMode)):this.$bus.$emit("set-map-view-mode",a.Oq.DEFAULT)},viewMode(e){this.$bus.$emit("set-map-view-mode",e)}},created(){this.$bus.$on("set-scheduling-has-right-panel-in",(e=>{this.hasRightPanelIn=e})),this.$bus.$on("activate-scheduling",this.activateScheduling),this.$bus.$on("set-calendar-view-mode",this.setViewMode),this.$bus.$on("set-schedule-fullscreen",this.setFullscreen),this.$bus.$on("second-request-executing",this.displaySecondRequestToast)},destroyed(){this.$bus.$off("set-scheduling-has-right-panel-in"),this.$bus.$off("activate-scheduling",this.activateScheduling),this.$bus.$off("set-calendar-view-mode"),this.$bus.$off("set-schedule-fullscreen",this.setFullscreen)},methods:{...(0,i.mapMutations)("scheduling",{store__setUnsupportedItems:"setUnsupportedItems"}),...(0,i.mapMutations)("tabs",{tabs__setTab:"setTab"}),calendarMounted(){this.mountedCallback&&(this.mountedCallback(),this.mountedCallback=null)},activateScheduling(e){e&&"function"==typeof e&&(this.doLoad?e():(this.mountedCallback=e,this.tabs__setTab(a.mQ.SCHEDULING)))},displaySecondRequestToast(){this.$root.$emit("toast",{message:this.$Labels.MA_SCHEDULE_DISPLAYING_SCHEDULE_FROM_NEXT_APPOINTMENT})},showError(e,t="error"){const s=e instanceof Error?e.message:e;this.$root.$emit("toast",{message:s,state:t})},toggleFullScreen(){const e=this.viewMode===a.Oq.FULLWIDTH_FULLHEIGHT?a.Oq.FULLWIDTH_HALFHEIGHT:a.Oq.FULLWIDTH_FULLHEIGHT;this.viewMode=e,setTimeout((()=>{Ne(window).trigger("resize")}),500)},setFullscreen(e){this.isTabActive&&!this.store__isAgendaDay&&(e?this.setViewMode(a.Oq.FULLWIDTH_FULLHEIGHT):this.setViewMode(a.Oq.FULLWIDTH_HALFHEIGHT))},setViewMode(e){Object.values(a.Oq).includes(e)&&(this.viewMode=e)}}},Pe=(0,D.Z)(ze,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"schedulePanel left-ui-panel",class:{"is-in":e.isTabActive,"is-agenda-day-view":e.store__isAgendaDay,"is-schedule-week":e.store__isAgendaWeek,"is-schedule-resource":e.store__isTimelineDay,"queue-is-collapsed":e.store__isQueueCollapsed,"queue-is-toggling":e.store__isQueueToggling,"is-fullwidth-halfheight":e.isHalfHeight,"is-fullwidth-fullheight":e.isFullHeight,"has-right-panel-in":e.hasRightPanelIn}},[s("div",{staticClass:"calendar"},[s("Spinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],attrs:{loadingLabel:e.$Labels.MA_Loading}}),e._v(" "),e.store__unsupportedItems.length?s("MAToast",{attrs:{closeLabel:e.$Labels.MA_Close,errorLabel:e.$Labels.MA_Error,state:"warning"},on:{close:function(t){return e.store__setUnsupportedItems([])}}},[s("div",[s("h2",{staticClass:"slds-text-heading_small"},[e._v(e._s(e.$Labels.MA_SCHEDULE_YOU_CANNOT_SCHEDULE_EVENTS_FOR_THESE_RECORDS_MESSAGE))]),e._v(" "),s("div",{staticClass:"slds-scrollable_y slds-m-top_x-small unsupportedContainer"},[s("table",{staticClass:"unsupportedRecordTable"},[s("tr",[s("th",[e._v(e._s(e.$Labels.MA_RECORD_NAME))]),e._v(" "),s("th",[e._v(e._s(e.$Labels.MA_OBJECT))])]),e._v(" "),e._l(e.store__unsupportedItems,(function(t,a){return s("tr",{key:a},[s("td",[e._v(e._s(e._f("decode")(t.title)))]),e._v(" "),s("td",[e._v(e._s(e._f("decode")(t.baseObjectLabel)))])])}))],2)])])]):e._e(),e._v(" "),e.doLoad?s("Calendar",{directives:[{name:"show",rawName:"v-show",value:!e.store__isTimelineDay,expression:"!store__isTimelineDay"}],key:"1",attrs:{base__storedIsLoading:e.isLoading,base__showFullScreenToggleControl:e.showFullScreenToggleControl},on:{"update:base__storedIsLoading":function(t){e.isLoading=t},"update:base__stored-is-loading":function(t){e.isLoading=t},toggleFullScreen:e.toggleFullScreen,error:e.showError,mounted:e.calendarMounted}}):e._e(),e._v(" "),e.store__isTimelineDay?s("ResourceCalendar",{key:"2",attrs:{base__storedIsLoading:e.isLoading,base__showFullScreenToggleControl:e.showFullScreenToggleControl},on:{"update:base__storedIsLoading":function(t){e.isLoading=t},"update:base__stored-is-loading":function(t){e.isLoading=t},toggleFullScreen:e.toggleFullScreen,error:e.showError}}):e._e()],1)])}),[],!1,null,"c576d57c",null).exports}}]);