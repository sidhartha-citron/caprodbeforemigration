<apex:page sidebar="false" title="MapAnything Automation" controller="sma.MABatchAdmin" setup="false" extensions="sma.MARemoteFunctions,sma.MAAdminAJAXResources">
    <apex:slds />
    <script>
        var MARemoting = {
            processAJAXRequest : '{!$RemoteAction.MARemoteFunctions.processAJAXRequest}',
            AdminStartUpAction: '{!$RemoteAction.MAAdminAJAXResources.AdminStartUpAction}'
        }
    </script>
    
	<!-- jQuery -->
	<script type="text/javascript" src="{!URLFOR($Resource.MapAnything, 'jquery/jquery-3.4.1.min.js')}"></script>
	
	<!-- jQuery UI -->
	<script type="text/javascript" src="{!URLFOR($Resource.MapAnything, 'jquery/jquery-ui.min.js')}"></script>
	<link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnything, 'jquery/jquery-ui.css')}"></link>
	
	<!-- jQuery Combo Box (depends on jQuery UI) -->
    <script src="{!URLFOR($Resource.AdminSettings, 'js/combobox/jquery.combobox.js')}" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.AdminSettings, 'js/combobox/jquery.combobox.css')}" />
    
    <!-- Glyphicons -->
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnything, 'css/MapAnything.css')}"/>
    <!-- Lightning Design System 2.3.0 -->
    <!-- <link type="text/css" rel="stylesheet" href="{!URLFOR($Resource.MapAnythingJS, 'styles/css/salesforce-lightning-design-system-2.4.6_scoped.min.css')}" /> -->
    <!-- icon-font -->
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnythingJS, 'styles/styles.css')}"/>
    <!-- MapAnything Configuration Page Styling -->
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnythingJS, 'styles/css/ma-configuration-ui.css')}"/>

    <apex:outputPanel layout="none" rendered="{!(PendoEnabled == 'true')}">
        <script>
            (function(apiKey){
                (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=[];
                v=['initialize','identify','updateOptions','pageLoad'];for(w=0,x=v.length;w<x;++w)(function(m){
                o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
                y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
                z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

                // Call this whenever information about your visitors becomes available
                // Please use Strings, Numbers, or Bools for value types.
                pendo.initialize({
                    visitor: { 
                        id: '{!JSENCODE($User.Id)}',
                        email: '{!JSENCODE($User.Email)}',
                        firstName: '{!JSENCODE($User.FirstName)}',
                        lastName: '{!JSENCODE($User.LastName)}',
                        userName: '{!JSENCODE($User.Username)}',
                        userAgent: window.navigator.userAgent
                    },

                    account: { 
                        id: '{!JSENCODE($Organization.Id)}', // Highly recommended
                        name: '{!JSENCODE($Organization.Name)}'
                        // planLevel:    // Optional
                        // planPrice:    // Optional
                        // creationDate: // Optional

                        // You can add any additional account level key-values here,
                        // as long as it's not one of the above reserved names.
                    }
                });
            })('3678d139-e89d-4a02-78a2-9822552912f0');
        </script>
    </apex:outputPanel>

    <apex:outputPanel layout="none" rendered="{! $User.UIThemeDisplayed == 'Theme4d' || $User.UIThemeDisplayed == 'Theme4u' }">
        <script type='text/javascript'>
            $.ajaxSetup({
                dataFilter: function (rawData,type)
                {
                    try
                    {
                        if (rawData != undefined  && rawData != '')
                        {
                            if (type === 'JSON' || type == 'JSONP' || type=='json' || type =='jsonp')
                            {
                                return rawData.replace(/<script.*?>.*?<\/script>/igm, '');
                            }
                        }
                    }
                    catch (ex)
                    {
                        
                    }
                }
            });
        
            jQuery.ajaxSetup({
                dataFilter: function (rawData,type)
                {
                    try
                    {
                        if (rawData != undefined  && rawData != '')
                        {
                            if (type === 'JSON' || type == 'JSONP' || type=='json' || type =='jsonp')
                            {
                                return rawData.replace(/<script.*?>.*?<\/script>/igm, '');
                            }
                        }
                    }
                    catch (ex)
                    {
                        
                    }
                }
            });
    
        </script>
    </apex:outputPanel>

    <!-- CSS -->
    <c:CSSMapAnything />
    <c:CSSHelperBlue />
    <style>
    
    	/* Basics */                
        #adminsettings {
            overflow: hidden;
        }
        
        /* Tabs */
        #adminsettings .MainTabs
        {
            background: none;
            border: none;
        }
        #adminsettings .MainTabs > ul
        {
            width: auto;
            padding: 0 8px;
            background: none;
            border: none;
            border-bottom: 1px solid #CCC;
            border-top-right-radius: 0;
            border-top-left-radius: 0;
            border-bottom-right-radius: 0;
            border-bottom-left-radius: 0;
        }
        #adminsettings .MainTabs > ul .ui-state-default
        {
            background: #3684c5;
            border: medium none;
            border-radius: 0 0 0 0;
            border: 1px solid #19508C;
            box-shadow: 0 1px 0 rgba(255, 255, 255, 0.3) inset, 0 0 4px rgba(255, 255, 255, 0.2) inset;
            margin: 0 0 0 0;
        }
        #adminsettings .MainTabs > ul li.ui-tabs-active
        {
            border: 1px solid #CCC;
            background: white;
            color: #222;
        }
        #adminsettings .MainTabs > ul li a
        {
            color: #ffffff;
            font-size: 10px;
            outline: none;
        }
        #adminsettings .MainTabs > ul li.ui-tabs-active a
        {
            color: #3684c5;
        }
        #adminsettings .MainTabs > .ui-tabs-panel
        {
            padding: 15px;
        }
        
        /* Loadmasks */
        .loadmask {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 99;
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
            background-color: #ffffff;
            opacity: 0.4;
            -ms-filter: progid:DXImageTransform.Microsoft.Alpha(Opacity = 40);
            filter: alpha(opacity = 40);
        }
        .loadmask-status {
        	position: absolute;
        	width: 100%;
        	text-align: center;
        	z-index: 999999;
        	top: 50px;
        }
        .loadmask-status .status {
        	margin: 0 auto;
			background-color: white;
			display: inline-block;
			padding: 15px;
			font-size: 10px;
			-moz-border-radius: 12px;
			-webkit-border-radius: 12px;
			border-radius: 12px;
			-moz-box-shadow: 0px 0px 8px #000000;
			-webkit-box-shadow: 0px 0px 8px #000000;
			box-shadow: 0px 0px 8px #000000;
        }
        .loadmask-status .status * {
        	vertical-align: middle;
        }
        .loadmask-status .status img {
        	margin-right: 5px;
        }

        
        /* Boxes */
        #adminsettings .box.gray {
            border: 1px solid #C7C7C7;
            padding:5px;
            margin:5px 0 10px 0;
            background:#efefef;
        }
        
        /* Sections */
        #adminsettings .section {
            position: relative;
        }
        #adminsettings .section .section-header {
            color: #2265BB;
        }
        #adminsettings .section .section-buttons {
            position: absolute;
            top: 5px;
            right: 5px;
        }
        #adminsettings .section .section-buttons .section-button {
            padding-left: 18px;
            height: 16px;
            line-height: 18px;
            font-size: 10px;
            cursor: pointer;
        }
        #adminsettings .section .section-buttons .section-button.add {
            background: transparent url("{!URLFOR($Resource.QueryEditor, 'images/icons/badge-circle-plus-16.png')}") left center no-repeat;
        }
        
        /* Buttons */
        #adminsettings .MainTabs .MainTabs-buttons {
        	
        }
        
        /* Comboboxes */
        #adminsettings .ui-combobox
        {
            padding-right: 0;
        }
        #adminsettings .ui-combobox input
        {
            background-color: white;
            background: white;
            padding-right: 30px;
            font-weight: bold;
        }
        #adminsettings .ui-combobox a
        {
            background: transparent;
            border: none;
            position: absolute;
            right: 0;
        }
        #adminsettings .ui-combobox a .ui-button-icon-primary
        {
            background: transparent url("{!URLFOR($Resource.QueryEditor, 'images/icons/combobox-arrow-16.png')}") no-repeat center;
        }
        
        /* Frequency Options */
        #newbatch-frequency-weekly-wrapper, #newbatch-frequency-monthly-wrapper {
			padding: 5px;
        }
        #newbatch-frequency-weekly-wrapper > div {
        	padding: 3px;
        }
        #newbatch-frequency-weekly-wrapper > div > * {
        	vertical-align: middle;
        }
        #newbatch-frequency-weekly-wrapper > div > input[type="checkbox"] {
        	margin-right: 10px;
        }
        #newbatch-frequency-monthly-wrapper > * {
        	vertical-align: middle;
        }
        
        /* Links */
        span.link {
        	cursor: pointer;
        	color: #2265BB;
        }
        
        /* Temporary fix for header links divider */
        span.divider {
        	float: none;
			display: inline;
			background: none;
			margin: 0;
        }
    </style>
    
    <!-- JS -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'JSHelperFunctions.js')}"></script>
    <c:MA />
    <script type='text/javascript'>
        $(function() { 
			
			//init tabs
			$('.tabs').tabs();
			
			//send request for automation data
			refreshAutomationData();
            
            //handle changing frequency interval
            $('input[name="newbatch-frequency-interval"]').click(function () {
            	if ($(this).attr('value') == 'Weekly')
            	{
            		$('#newbatch-frequency-monthly-wrapper').hide();
            		$('#newbatch-frequency-weekly-wrapper').show();
            	}
            	else
            	{
            		$('#newbatch-frequency-weekly-wrapper').hide();
            		$('#newbatch-frequency-monthly-wrapper').show();
            	}
            });
            
            //handle aborting batches
            $('#lastbatches-grid').on('click', '.link.abort', function () {
            
            	var $tab = showLoading($(this).closest('.ui-tabs-panel'), 'Aborting...');
	            var processData = {
                    action : 'abort_batch',
                    batchId : $(this).closest('.lastbatches-row').attr('data-id')
                };
                
                Visualforce.remoting.Manager.invokeAction(MARemoting.AdminStartUpAction,
                    processData,
                    function(response, event){
                        if(event.status) {
    	                	//refresh the batch list to display this change
    	                	hideMessage($tab);
    	            		$('#lastbatches-refresh').click();
    	                }
    	                else
    	                {
    	                	showError($tab, response.error);
    	                }
                    },{buffer:false,escape:false}
	            );
            });
            
            //handle scheduling batches
            $('#newbatch-schedule').click(function () {
            
            	var $tab = showLoading($(this).closest('.ui-tabs-panel'), 'Scheduling...');
            
            	//send request
				var processData = {
            		action					: 'schedule_batch',
            		batchName				: $('#newbatch-batchname').val(),
            		apexClass				: $('#newbatch-apexclass').val(),
            		baseObjectId			: $('#newbatch-baseobject').val(),
            		frequencyInterval		: $('input[name="newbatch-frequency-interval"]:checked').attr('value'),
            		selectedDays			: $('.newbatch-frequency-weekly:checked').map(function () { return $(this).attr('data-value'); }).get().join(','),
            		dayOfMonth				: $('#newbatch-frequency-monthly-day').val(),
            		startTime				: $('#newbatch-starttime').val()
                };
                
                Visualforce.remoting.Manager.invokeAction(MARemoting.AdminStartUpAction,
                    processData,
                    function(response, event){

                        if(event.status && response.success) {
    	               		//clear fields
    	               		$('#newbatch-batchname').val('');
    	            		$('#newbatch-baseobject').val('--Please Choose--').next().find('input').val('--Please Choose--');
    	            		$('input[name="newbatch-frequency-interval"][value="Weekly"]').click();
    	            		$('.newbatch-frequency-weekly').prop('checked', false);
    	            		$('#newbatch-frequency-monthly-day').val('1');
    	            		$('#newbatch-starttime').val('0').next().find('input').val('12:00 AM');
    	            		
    	            		showSuccess($tab, 'Batch Scheduled');
                        }
    	                else
    	                {
    	                	showError($tab, response.error + ' ' + response.details, 4000);
    	                }
                    },{buffer:false,escape:false}
	            );
            
            });
            
            //handle manual batches
            $('#manualbatch-startgeocoder, #manualbatch-startlatlongremoval, #manualbatch-startskipgeocodeflagremovalbatch').click(function () {
            
            	var $tab = showLoading($(this).closest('.ui-tabs-panel'), 'Executing...');
            
            	//send request for automation data
				var processData = {
            		action			: 'start_batch',
            		batch			: $(this).attr('data-batch'),
            		baseObjectId	: $('#manualbatch-baseobject').val()
                };
                
                Visualforce.remoting.Manager.invokeAction(MARemoting.AdminStartUpAction,
                    processData,
                    function(response, event){
                        if(event.status && response.success) {
    	                	//clear fields
    	                	$('#manualbatch-baseobject').val('--Please Choose--').next().find('input').val('--Please Choose--');
    	                
    	                    showSuccess($tab, 'Batch Started');
    	                }
    	                else
    	                {
    	                    showError($tab, response.error + ' ' + response.details, 4000);
    	                }
                    },{buffer:false,escape:false}
    	       );
            
            });
            
            //handle deleting scheduled batches
            $('#scheduledbatches-grid').on('click', '.scheduledbatches-row .delete.link', function () {
            	
            	if (confirm('Are you sure you want to delete ' + $(this).closest('.scheduledbatches-row').find('.jobName').text() + '?'))
            	{
            		//show loader
            		var $loader = showLoading($(this).closest('.loadmask-wrapper'), 'Deleting...');
            		
            		//send request
            		var processData = {
            			action			: 'delete_scheduled_job', 
            			jobId			: $(this).closest('.scheduledbatches-row').attr('data-id')
                    };
                    
                    Visualforce.remoting.Manager.invokeAction(MARemoting.AdminStartUpAction,
                        processData,
                        function(response, event){
                            if(event.status) {
    		                	//refresh
    		                	refreshAutomationData();
    		                }
    		                else
    		                {
    		                    showError($loader, response.error);
    		                }
                        },{buffer:false,escape:false}
                    );
            	}
            	
            });
            
            //handle clicking refresh buttons
            $('#lastbatches-refresh, #scheduledbatches-refresh').click(refreshAutomationData);
            
        });
        
        function refreshAutomationData()
        {
        	//show loaders
        	$('.combobox').combobox().next().prepend("<div class='loadmask'></div>");
        	$('div.loadmask-wrapper').each(function () {
        		showLoading($(this), 'Refreshing...');
        	});
        	
            var processData = {
    			action: 'get_automation_data'
            };
            
            Visualforce.remoting.Manager.invokeAction(MARemoting.AdminStartUpAction,
                processData,
                function(response, event){
                    if(event.status) {
                        //populate base object options
                        $('#newbatch-baseobject, #manualbatch-baseobject').html('<option value="--Please Choose--">--Please Choose--</option>').val('--Please Choose--').next().find('input').text('--Please Choose--');
                        $.each(response.baseObjects, function (index, baseObject) {
                        	
                        	//remove namespace
                        	removeNamespace('{!namespace}', baseObject);
                        	
                            //add options
                            if (baseObject.Type__c !== 'Live') {
                                $('#newbatch-baseobject, #manualbatch-baseobject').append(
                                    $("<option></option>").attr('value', baseObject.Id).text(htmlEncode(baseObject.Name__c))
                                );
                            }
                        	
                        });
                        
                        //populate last batches grid
                        $('#lastbatches-grid tr.lastbatches-row').remove();
                        $.each(response.lastBatches, function (index, batch) {
                        	appendBatch(batch);
                        });
                        
                        //populate scheduled batches grid
                        $('#scheduledbatches-grid tr.scheduledbatches-row').remove();
                        $.each(response.scheduledBatches, function (index, batch) {
                        	appendScheduledBatch(batch);
                        });
                        
                        //remove loaders
                        $('.combobox').next().find('.loadmask').remove();
                        $('div.loadmask-wrapper').each(function () {
    		        		showSuccess($(this), 'Refresh Complete');
    		        	});
                    }
                },{buffer:false,escape:false}
            );
        }
        
        function appendBatch(batch)
        {
        	var $row = $('#templates .lastbatches-row').clone().attr('data-id', batch.Id);
           	$row.find('.action').html(batch.Status == 'Processing' ? "<span class='link abort'>Abort</span>" : "");
           	$row.find('.submittedDate').text(batch.CreatedDate);
           	$row.find('.jobType').text(batch.JobType);
           	$row.find('.status').text(batch.Status);
           	$row.find('.statusDetail').text(batch.ExtendedStatus || '');
           	$row.find('.totalBatches').text(batch.TotalJobItems);
           	$row.find('.batchesProcessed').text(batch.JobItemsProcessed);
           	$row.find('.failures').text(batch.NumberOfErrors);
           	$row.find('.submittedBy').html("<a href='/"+htmlEncode(batch.CreatedById)+"' target='_blank'>"+htmlEncode(batch.CreatedByName)+"</a>");
           	$row.find('.completionDate').text(batch.CompletedDate);
           	$row.find('.apexClass').html("<a href='/"+batch.ApexClassId+"' target='_blank'>"+htmlEncode(batch.ApexClassName)+"</a>");
           	$('#lastbatches-grid').append($row);
        }
        function appendScheduledBatch(batch)
        {
        	var $row = $('#templates .scheduledbatches-row').clone().attr('data-id', batch.Id);
           	$row.find('.jobName').text(batch.JobName);
           	$row.find('.apexClassName').text(batch.ApexClassName);
           	$row.find('.submittedBy').text(batch.SubmittedBy);
           	$row.find('.submitted').text(batch.Submitted);
           	$row.find('.lastRun').text(batch.LastRun);
           	$row.find('.nextScheduledRun').text(batch.NextScheduledRun);
           	$('#scheduledbatches-grid').append($row);
        }
	</script>
    
    <div class="slds-scope" style="height: 100%;">
        <div class="flex-column full-height">
            <div class="flex-row flex-grow-1">
                <div class="flex-shrink-0">
                    <!--navigation-->
                    <c:MAAdminHeader activeTab="batchAdmin" />
                </div>
                <div class="slds-brand-band slds-brand-band_cover slds-brand-band_medium slds-p-around_medium slds-scrollable">
                    <div class="slds-is-relative slds-p-bottom_small">
                        <!-- Header -->
                        <div class="slds-page-header">
                            <div class="slds-grid">
                                <div class="slds-col slds-has-flexi-truncate">
                                    <div class="slds-media slds-no-space slds-grow">
                                        <div class="slds-media__figure ma-slds-media__figure">
                                            <span class="slds-icon ma-icon ma-icon-mapanything"></span>
                                        </div>
                                        <div class="slds-media__body">
                                            <p class="slds-text-title--caps slds-line-height--reset">MapAnything Configuration</p>
                                            <h1 class="slds-page-header__title slds-m-right--small slds-align-middle slds-truncate" title="this should match the Record Title">Automation</h1>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-card slds-box">
                        <!-- Main Content -->
                        <div id='adminsettings'>
                            <div class='MainTabs tabs'>
                                <ul>
                                    <li><a href="#MainTabs-ScheduleNewBatch">{!$Label.MA_Schedule_New_Batch}</a></li>
                                    <li><a href="#MainTabs-RunManualBatch">{!$Label.MA_Run_Manual_Batch}</a></li>
                                    <li><a href="#MainTabs-LastBatches">{!$Label.MA_Last_5_Batches}</a></li>
                                    <li><a href="#MainTabs-ScheduledBatches">{!$Label.MA_Scheduled_Batches}</a></li>
                                </ul>
                                
                                <!-- Schedule New Batch Tab -->
                                <div id="MainTabs-ScheduleNewBatch">
                                
                                    <!-- Schedule Settings -->
                                    <div class='slds-section slds-m-bottom_large slds-is-open newbaseobjectdetails'>
                                        <div class='slds-section__title slds-theme--shade'>
                                            <span class="section-header-title slds-p-horizontal--small slds-truncate">Schedule Settings</span>
                                        </div>
                                        <div class='slds-section__content section__content'>
                                            <div class="slds-grid">
                                                <div class="slds-col slds-size_1-of-1 slds-large-size_4-of-12 slds-has-flexi-truncate slds-p-horizontal_x-small">
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label">
                                                        <abbr title="required" class="slds-required">*</abbr>
                                                            {!$Label.MA_Batch_Name}
                                                        </label>
                                                        <div class="slds-form-element__control">
                                                            <input type='text' id='newbatch-batchname' class='slds-input'></input>
                                                        </div>
                                                    </div> 
                                                </div> 
                                            </div>
                                            <div class="slds-grid">
                                                <div class="slds-col slds-size_1-of-1 slds-large-size_4-of-12 slds-has-flexi-truncate slds-p-horizontal_x-small slds-p-top_small">
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label">{!$Label.MA_Apex_Class}</label>
                                                        <div class="slds-form-element__control">
                                                            <select id="newbatch-apexclass" class="combobox">
                                                                <option value="GeoCoderSchedulable">GeoCoderSchedulable</option>
                                                            </select>
                                                        </div>
                                                    </div> 
                                                </div>   
                                            </div>
                                            <div class="slds-grid">
                                                <div class="slds-col slds-size_1-of-1 slds-large-size_4-of-12 slds-has-flexi-truncate slds-p-horizontal_x-small slds-p-top_small">
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label">{!$Label.MA_Base_Object}</label>
                                                        <div class="slds-form-element__control">
                                                            <select id='newbatch-baseobject' class='combobox'>
                                                                <option value='--Please Choose--'>--{!$Label.MA_Please_Choose}--</option>
                                                            </select>
                                                        </div>
                                                    </div> 
                                                </div>   
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Schedule Apex Execution -->
                                    <div class='slds-section slds-m-bottom_large slds-is-open newbaseobjectdetails'>
                                        <div class='slds-section__title slds-theme--shade'>
                                            <span class="section-header-title slds-p-horizontal--small slds-truncate">{!$Label.MA_Schedule_Apex_Execution}</span>
                                        </div>
                                        <div class='slds-section__content section__content'>
                                            <div class="slds-grid">
                                                <div class="slds-col slds-size_1-of-1">
                                                    <div class="slds-form slds-form_compound">
                                                        <fieldset class="slds-form-element">
                                                            <div class="slds-form-element__group">
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element slds-size_1-of-2 slds-p-right_small">
                                                                        <label class="slds-form-element__label">{!$Label.MA_Preferred_Start_Time}</label>
                                                                        <div class="slds-form-element__control">
                                                                            <select id='newbatch-starttime' class='combobox'>
                                                                                <option value="0">12:00 AM</option>
                                                                                <option value="1">1:00 AM</option>
                                                                                <option value="2">2:00 AM</option>
                                                                                <option value="3">3:00 AM</option>
                                                                                <option value="4">4:00 AM</option>
                                                                                <option value="5">5:00 AM</option>
                                                                                <option value="6">6:00 AM</option>
                                                                                <option value="7">7:00 AM</option>
                                                                                <option value="8">8:00 AM</option>
                                                                                <option value="9">9:00 AM</option>
                                                                                <option value="10">10:00 AM</option>
                                                                                <option value="11">11:00 AM</option>
                                                                                <option value="12">12:00 PM</option>
                                                                                <option value="13">1:00 PM</option>
                                                                                <option value="14">2:00 PM</option>
                                                                                <option value="15">3:00 PM</option>
                                                                                <option value="16">4:00 PM</option>
                                                                                <option value="17">5:00 PM</option>
                                                                                <option value="18">6:00 PM</option>
                                                                                <option value="19">7:00 PM</option>
                                                                                <option value="20">8:00 PM</option>
                                                                                <option value="21">9:00 PM</option>
                                                                                <option value="22">10:00 PM</option>
                                                                                <option value="23">11:00 PM</option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element slds-size_1-of-4 slds-p-right_small slds-align-top">
                                                                        <legend class="slds-form-element__legend slds-form-element__label">{!$Label.MA_Frequency}</legend>
                                                                        <div class="slds-form-element__control" id='newbatch-frequency'>
                                                                            <span class="slds-radio">
                                                                            <input type="radio" name='newbatch-frequency-interval' value='Weekly' checked='checked' id="radio-weekly" />
                                                                            <label class="slds-radio__label" for="radio-weekly">
                                                                                <span class="slds-radio_faux"></span>
                                                                                <span class="slds-form-element__label">{!$Label.MA_Weekly}</span>
                                                                            </label>
                                                                            </span>
                                                                            <span class="slds-radio">
                                                                            <input type='radio' name='newbatch-frequency-interval' value='Monthly' id="radio-monthly" />
                                                                            <label class="slds-radio__label" for="radio-monthly">
                                                                                <span class="slds-radio_faux"></span>
                                                                                <span class="slds-form-element__label">{!$Label.MA_Monthly}</span>
                                                                            </label>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-form-element slds-size_1-of-2 slds-card" id='newbatch-frequency-weekly-wrapper'>
                                                                        <div class="slds-form__control slds-grid slds-grid_vertical">
                                                                            <span class="slds-checkbox">
                                                                                <input type="checkbox" class="newbatch-frequency-weekly" id="SUN" data-value="SUN" />
                                                                                <label class="slds-checkbox__label" for="SUN">
                                                                                    <span class="slds-checkbox_faux"></span>
                                                                                    <span class="slds-form-element__label">{!$Label.MA_Sunday}</span>
                                                                                </label>
                                                                            </span>
                                                                            <span class="slds-checkbox">
                                                                                <input type="checkbox" class="newbatch-frequency-weekly" id="MON" data-value="MON" />
                                                                                <label class="slds-checkbox__label" for="MON">
                                                                                    <span class="slds-checkbox_faux"></span>
                                                                                    <span class="slds-form-element__label">{!$Label.MA_Monday}</span>
                                                                                </label>
                                                                            </span>
                                                                            <span class="slds-checkbox">
                                                                                <input type="checkbox" class="newbatch-frequency-weekly" id="TUE" data-value="TUE" />
                                                                                <label class="slds-checkbox__label" for="TUE">
                                                                                    <span class="slds-checkbox_faux"></span>
                                                                                    <span class="slds-form-element__label">{!$Label.MA_Tuesday}</span>
                                                                                </label>
                                                                            </span>
                                                                            <span class="slds-checkbox">
                                                                                <input type="checkbox" class="newbatch-frequency-weekly" id="WED" data-value="WED" />
                                                                                <label class="slds-checkbox__label" for="WED">
                                                                                    <span class="slds-checkbox_faux"></span>
                                                                                    <span class="slds-form-element__label">{!$Label.MA_Wednesday}</span>
                                                                                </label>
                                                                            </span>
                                                                            <span class="slds-checkbox">
                                                                                <input type="checkbox" class="newbatch-frequency-weekly" id="THU" data-value="THU" />
                                                                                <label class="slds-checkbox__label" for="THU">
                                                                                    <span class="slds-checkbox_faux"></span>
                                                                                    <span class="slds-form-element__label">{!$Label.MA_Thursday}</span>
                                                                                </label>
                                                                            </span>
                                                                            <span class="slds-checkbox">
                                                                                <input type="checkbox" class="newbatch-frequency-weekly" id="FRI" data-value="FRI" />
                                                                                <label class="slds-checkbox__label" for="FRI">
                                                                                    <span class="slds-checkbox_faux"></span>
                                                                                    <span class="slds-form-element__label">{!$Label.MA_Friday}</span>
                                                                                </label>
                                                                            </span>
                                                                            <span class="slds-checkbox">
                                                                                <input type="checkbox" class="newbatch-frequency-weekly" id="SAT" data-value="SAT" />
                                                                                <label class="slds-checkbox__label" for="SAT">
                                                                                    <span class="slds-checkbox_faux"></span>
                                                                                    <span class="slds-form-element__label">{!$Label.MA_Saturday}</span>
                                                                                </label>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-form-element slds-size_1-of-2" id='newbatch-frequency-monthly-wrapper' style='display: none;'>
                                                                        <div class="slds-form-element__control slds-grid slds-grid_vertical-align-center">
                                                                            <span>{!$Label.MA_On_day}</span>
                                                                            <div class="slds-m-horizontal_x-small">
                                                                                <select class="combobox" id='newbatch-frequency-monthly-day'>
                                                                                    <option value='1'>1</option>
                                                                                    <option value='2'>2</option>
                                                                                    <option value='3'>3</option>
                                                                                    <option value='4'>4</option>
                                                                                    <option value='5'>5</option>
                                                                                    <option value='6'>6</option>
                                                                                    <option value='7'>7</option>
                                                                                    <option value='8'>8</option>
                                                                                    <option value='9'>9</option>
                                                                                    <option value='10'>10</option>
                                                                                    <option value='11'>11</option>
                                                                                    <option value='12'>12</option>
                                                                                    <option value='13'>13</option>
                                                                                    <option value='14'>14</option>
                                                                                    <option value='15'>15</option>
                                                                                    <option value='16'>16</option>
                                                                                    <option value='17'>17</option>
                                                                                    <option value='18'>18</option>
                                                                                    <option value='19'>19</option>
                                                                                    <option value='20'>20</option>
                                                                                    <option value='21'>21</option>
                                                                                    <option value='22'>22</option>
                                                                                    <option value='23'>23</option>
                                                                                    <option value='24'>24</option>
                                                                                    <option value='25'>25</option>
                                                                                    <option value='26'>26</option>
                                                                                    <option value='27'>27</option>
                                                                                    <option value='28'>28</option>
                                                                                    <option value='29'>29</option>
                                                                                    <option value='30'>30</option>
                                                                                    <option value='31'>31</option>
                                                                                    <option value='last'>last</option>
                                                                                </select>
                                                                            </div>
                                                                            <span>{!$Label.MA_of_every_month}</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </fieldset>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Buttons -->
                                    <div class='MainTabs-buttons'>
                                        <input type='button' id='newbatch-schedule' class='MAbutton button-blue slds-button slds-button_brand' value='Schedule' />
                                    </div>
                                </div>
                                
                                <!-- Run Manual Batch Tab -->
                                <div id="MainTabs-RunManualBatch">
                                    <!-- Choose an Object -->
                                    <div class='slds-section slds-m-bottom_large slds-is-open newbaseobjectdetails'>
                                        <div class='slds-section__title slds-theme--shade'>
                                            <span class="section-header-title slds-p-horizontal--small slds-truncate">{!$Label.MA_Choose_an_Object}</span>
                                        </div>
                                        <div class='slds-section__content section__content'>
                                            <div class="slds-grid">
                                                <div class="slds-col slds-size_1-of-1 slds-large-size_4-of-12 slds-has-flexi-truncate">
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label">Base Object</label>
                                                        <div class="slds-form-element__control">
                                                            <select id='manualbatch-baseobject' class='combobox'>
                                                                <option value='--Please Choose--'>--{!$Label.MA_Please_Choose}--</option>
                                                            </select>
                                                        </div>
                                                    </div> 
                                                </div>   
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Buttons -->
                                    <div class='MainTabs-buttons'>
                                        <input type='button' id='manualbatch-startgeocoder' class='MAbutton button-blue slds-button slds-button_brand' value='Start GeoCoding Batch' data-batch='GeoCoderBatchable' />
                                        <input type='button' id='manualbatch-startlatlongremoval' class='MAbutton button-blue slds-button slds-button_brand' value='Start Lat/Long Removal Batch' data-batch='RemoveLatLongBatch' /> 
                                        <input type='button' id='manualbatch-startskipgeocodeflagremovalbatch' class='MAbutton button-blue slds-button slds-button_brand' value='Start Skip Geocode Flag Removal Batch' data-batch='SkipGeocodeFlagRemovalBatch' />
                                    </div>
                                
                                </div>
                                
                                <!-- Last Batches Tab -->
                                <div id="MainTabs-LastBatches">
                                    
                                    <!-- Last Batches Grid -->
                                    <div id="lastbatches-grid-wrapper" class='loadmask-wrapper'>
                                        
                                        <table id='lastbatches-grid' class='grid-blue'>
                                            <tr>
                                                <th>{!$Label.MA_Action}</th>
                                                <th>{!$Label.MA_Submitted_Date}</th>
                                                <th>{!$Label.MA_Job_Type}</th>
                                                <th>{!$Label.MA_Status}</th>
                                                <th>{!$Label.MA_Status_Detail}</th>
                                                <th>{!$Label.MA_Total_Batches}</th>
                                                <th>{!$Label.MA_Batches_Processed}</th>
                                                <th>{!$Label.MA_Failures}</th>
                                                <th>{!$Label.MA_Submitted_By}</th>
                                                <th>{!$Label.MA_Completion_Date}</th>
                                                <th>{!$Label.MA_Apex_Class}</th>
                                            </tr>
                                        </table>
                                        
                                        <!-- Buttons -->
                                        <div class='MainTabs-buttons slds-p-top_small'>
                                            <input type='button' id='lastbatches-refresh' class='MAbutton button-blue slds-button slds-button_brand' value='Refresh' /> 
                                        </div>
                                    </div>
                                    
                                </div>
                                
                                <!-- Scheduled Batches Tab -->
                                <div id="MainTabs-ScheduledBatches">
                                
                                    <!-- Scheduled Batches Grid -->
                                    <div id="scheduledbatches-grid-wrapper" class='loadmask-wrapper'>
                                        
                                        <table id='scheduledbatches-grid' class='grid-blue'>
                                            <tr>
                                                <th>{!$Label.MA_Action}</th>
                                                <th>{!$Label.MA_Job_Name}</th>
                                                <th>{!$Label.MA_Apex_Class}</th>
                                                <th>{!$Label.MA_Submitted_By}</th>
                                                <th>{!$Label.MA_Submitted}</th>
                                                <th>{!$Label.MA_Last_Run}</th>
                                                <th>{!$Label.MA_Next_Scheduled_Run}</th>
                                            </tr>
                                        </table>
                                        
                                        <!-- Buttons -->
                                        <div class='MainTabs-buttons slds-p-top_small'>
                                            <input type='button' id='scheduledbatches-refresh' class='MAbutton button-blue slds-button slds-button_brand' value='Refresh' /> 
                                        </div>
                                    </div>
                                
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Templates -->
    <div id='templates' style='display: none;'>
    	
    	<!-- Batch Row -->
    	<table>
    		<tr class='lastbatches-row'>
    			<td class='action'></td>
    			<td class='submittedDate'></td>
    			<td class='jobType'></td>
    			<td class='status'></td>
    			<td class='statusDetail'></td>
    			<td class='totalBatches'></td>
    			<td class='batchesProcessed'></td>
    			<td class='failures'></td>
    			<td class='submittedBy'></td>
    			<td class='completionDate'></td>
    			<td class='apexClass'></td>
    		</tr>
    	</table>
    	
    	<!-- Scheduled Batch Row -->
    	<table>
    		<tr class='scheduledbatches-row'>
    			<td class='action'><span class='delete link'>Del</span></td>
    			<td class='jobName'></td>
    			<td class='apexClassName'></td>
    			<td class='submittedBy'></td>
    			<td class='submitted'></td>
    			<td class='lastRun'></td>
    			<td class='nextScheduledRun'></td>
    		</tr>
    	</table>
    	
    </div>

</apex:page>