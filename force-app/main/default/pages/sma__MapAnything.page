<apex:page sidebar="{!sidebarEnabled}" controller="sma.MapAnything" title="MapAnything" action="{!StartUpAction}" extensions="sma.MARemoteFunctions,sma.MATerritoryRemoteFunctions,sma.MAAdminAJAXResources">
    <!-- SFCM-725 moved to include script to fix SF header breaking google script, please do not change  -->
    <apex:includeLightning />
    <apex:includeScript value="{!GoogleURL}/maps/api/js?v=3.45&client=gme-cloudbiltinc&libraries=places,visualization,drawing,geometry"/>
    <script>
        var MARemoting = {
            Territory: {
                getTerritoryMarkerLayersBySearchTerm: '{!$RemoteAction.MATerritoryRemoteFunctions.getTerritoryMarkerLayersBySearchTerm}',
                visualizeTerritory: '{!$RemoteAction.MATerritoryRemoteFunctions.visualizeTerritory}',
                getAggregatorKeysBySettingId: '{!$RemoteAction.MATerritoryRemoteFunctions.getAggregatorKeysBySettingId}',
                getTerritoryLayerById: '{!$RemoteAction.MATerritoryRemoteFunctions.getTerritoryLayerById}',
                getTerritoryCardById: '{!$RemoteAction.MATerritoryRemoteFunctions.getTerritoryCardById}',
                getLayerCount: '{!$RemoteAction.MATerritoryRemoteFunctions.getLayerCount}',
                fetchNumberFieldsBySObjectName: '{!$RemoteAction.MATerritoryRemoteFunctions.fetchNumberFieldsBySObjectName}',
                startAggregationById: '{!$RemoteAction.MATerritoryRemoteFunctions.startAggregationById}',
                save: '{!$RemoteAction.MATerritoryRemoteFunctions.saveTerritory}',
                delete: '{!$RemoteAction.MATerritoryRemoteFunctions.deleteTerritory}'
            },
            phase_4 : '{!$RemoteAction.MARemoteFunctions.GetRecords}',
            getShapes : '{!$RemoteAction.MARemoteFunctions.GetShapeInfo}',
            placeSearch : '{!$RemoteAction.MARemoteFunctions.googleAPISearch}',
            geocodeRecord : '{!$RemoteAction.MARemoteFunctions.geoCodeRecord}',
            live_phase_4 : '{!$RemoteAction.MARemoteFunctions.GetLatestPosition}',
            live_history: '{!$RemoteAction.MARemoteFunctions.GetLiveDeviceHistory}',
            getEsriToken : '{!$RemoteAction.MARemoteFunctions.getEsriToken}',
            getEsriRoute : '{!$RemoteAction.MARemoteFunctions.getEsriRoute}',
            getDriveProfile : '{!$RemoteAction.MARemoteFunctions.getCustomDriveProfile}',
            get_service_area: '{!$RemoteAction.MARemoteFunctions.getServiceArea}',
            processAJAXRequest : '{!$RemoteAction.MARemoteFunctions.processAJAXRequest}',
            processAJAXRequestReadOnly : '{!$RemoteAction.MARemoteFunctions.processAJAXRequestReadOnly}',
            MapAnythingIORequest : '{!$RemoteAction.MARemoteFunctions.MapAnythingIORequest}',
            getSearchableBaseObjects: '{!$RemoteAction.MARemoteFunctions.getSearchableBaseObjects}',
            searchMAObjectsForRecords : '{!$RemoteAction.MARemoteFunctions.searchMAObjectsForRecords}',
            searchMAObjectsForRecordsSOQL : '{!$RemoteAction.MARemoteFunctions.searchMAObjectsForRecordsSOQL}', 
            validateMABaseObjectTooltips : '{!$RemoteAction.MARemoteFunctions.validateMABaseObjectTooltips}',
            MapAnythingIORequestPOST : '{!$RemoteAction.MARemoteFunctions.MapAnythingIORequestPOST}',
            getRoute: '{!$RemoteAction.MARemoteFunctions.getRoute}',
            getRouteV2: '{!$RemoteAction.MARemoteFunctions.getRouteV2}',
            getCalendarEvents: '{!$RemoteAction.MARemoteFunctions.getCalendarEvents}',
            saveCalendarEvents: '{!$RemoteAction.MARemoteFunctions.saveCalendarEvents}',
            getCalendarShifts: '{!$RemoteAction.MARemoteFunctions.getCalendarShifts}',
            getCalendarResourcesByUserId: '{!$RemoteAction.MARemoteFunctions.getCalendarResourcesByUserId}',
            getSchedulingResourcesBySearchTerm: '{!$RemoteAction.MARemoteFunctions.getSchedulingResourcesBySearchTerm}',
            saveCalendarResources: '{!$RemoteAction.MARemoteFunctions.saveCalendarResources}',
            getShapeGeometry: '{!$RemoteAction.MARemoteFunctions.GetShapeGeometry}',
            AdminStartUpAction: '{!$RemoteAction.MAAdminAJAXResources.AdminStartUpAction}',
            getLiveConfigs: '{!$RemoteAction.MARemoteFunctions.getLiveConfigs}'
        }
    </script>
    <!-- jQuery-->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jquery/jquery-3.4.1.min.js')}"></script>

    <!--[if lte IE 9]>
        <script type='text/javascript'>window.location = '/apex/Oops?type=UnsupportedBrowser';</script>
    <![endif]-->

    <script type="text/javascript">
		if (!!navigator.userAgent.match(/Trident.*rv\:11\./)) {
            console.log('detected IE11 ... loading polyfills');
            var head = document.getElementsByTagName('head')[0] || document.body;
            var script = document.createElement('script');
            script.src = "{!URLFOR($Resource.MapAnything, 'js/polyfill.min.js')}";
            head.appendChild(script);

            console.log('adding IE style override')
            var link = document.createElement("link");
            link.type = "text/css";
            link.rel = "stylesheet";
            link.href = "{!URLFOR($Resource.MapAnything, 'css/ie11.css')}";
            head.appendChild(link);
        } else if (!!navigator.userAgent.match(/MSIE 10.0.*/)) {
            window.location = '/apex/Oops?type=UnsupportedBrowser';
        }
	</script>

    <!-- async -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'async/async.min.js')}"></script>

    <!-- jsTree -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jstree/_lib/jquery.cookie.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jstree/jquery.jstree2.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/proj4.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/proj4.defs.js')}"></script>
    <!-- toastr -->

    <!-- EXPORT -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'exportCSV.js')}"></script>

    <script type="text/javascript" src="{!URLFOR($Resource.MapAnything, 'toastr/toastr.min.js')}"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnything, 'toastr/toastr.min.css')}"></link>

    <!-- <apex:stylesheet value="{!URLFOR($Resource.MapAnything, 'malayersv2/css/malayersv2.css')}" /> -->
    <link rel="stylesheet" type="text/css" href="{!resourcePaths['MapAnything']}/malayersv2/css/malayersv2.css" />

    <!-- minicolors -->
    <script type="text/javascript" src="{!URLFOR($Resource.MapAnything, 'jquery/minicolors/jquery.minicolors.min.js')}"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnything, 'jquery/minicolors/jquery.minicolors.css')}"></link>

    <!-- jsColor -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jscolor/jscolor.js')}"></script>

    <!-- Lightning Design System 2.4.3 -->
    <link type="text/css" rel="stylesheet" href="{!resourcePaths['MapAnythingJS']}/styles/css/salesforce-lightning-design-system-2.4.6_scoped.min.css" />

    <!-- Vue Core CSS Extracted Styles -->
    <link type="text/css" rel="stylesheet" href="{!resourcePaths['MapAnythingJS']}/dist/core/styles.css" />

    <!-- MapAnything Legacy UI -->
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnything, 'css/MapAnything.css')}"/>

    <!-- MapAnything 2.0 UI - uses SASS in static resource -->
    <link type="text/css" rel="stylesheet" href="{!resourcePaths['MapAnythingJS']}/styles/css/ma-ui.css" />
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnythingJS, 'styles/styles.css')}" />

    <apex:outputPanel layout="none" rendered="{!TotangoEnabled == 'true'}">

        <script type='text/javascript'>
             var totango_options = {
                  service_id: "SP-8618-01",
                  username: '{!$User.Email}',
                  account:
                  {
                      id: '{!$Organization.Id}',
                      name: "{!JSENCODE($Organization.Name)}",
                      status: "Unknown"
                  }
            };

            (function() {
                var e = document.createElement('script'); e.type = 'text/javascript'; e.async = true;
                e.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 's3.amazonaws.com/totango-cdn/totango2.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(e, s);
            })();
        </script>

    </apex:outputPanel>

    <apex:outputPanel layout="none" rendered="{!(PendoEnabled == 'true'||TotangoEnabled == 'true')}">
        <script>
            (function(apiKey){
                (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=[];
                v=['initialize','identify','updateOptions','pageLoad'];for(w=0,x=v.length;w<x;++w)(function(m){
                o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
                y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
                z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

                // Call this whenever information about your visitors becomes available
                // Please use Strings, Numbers, or Bools for value types.
                pendo.initialize({
                    visitor: { 
                        id: '{!JSENCODE($User.Id)}',
                        email: '{!JSENCODE($User.Email)}',
                        firstName: '{!JSENCODE($User.FirstName)}',
                        lastName: '{!JSENCODE($User.LastName)}',
                        userName: '{!JSENCODE($User.Username)}',
                        userAgent: window.navigator.userAgent
                    },

                    account: { 
                        id: '{!JSENCODE($Organization.Id)}', // Highly recommended
                        name: '{!JSENCODE($Organization.Name)}'
                        // planLevel:    // Optional
                        // planPrice:    // Optional
                        // creationDate: // Optional

                        // You can add any additional account level key-values here,
                        // as long as it's not one of the above reserved names.
                    }
                });
            })('3678d139-e89d-4a02-78a2-9822552912f0');
        </script>
    </apex:outputPanel>


    <!-- jQuery Notify -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'notify/jquery.notify.js')}"></script>
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnything, 'notify/ui.notify.css')}"/>

    <!-- jQuery UI -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jquery/jquery-ui.min.js')}"></script>
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnything, 'jquery/jquery-ui.css')}"/>

    <!-- Select2 replacing combobox -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/select2/select2.full.min.js')}"></script>
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnything, 'js/select2/select2.min.css')}"></apex:stylesheet>

    <!-- jQuery event.drag -->
    <!-- <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/jquery.event.drag-2.2.js')}"></script> -->

    <!-- CryptoJS (https://code.google.com/p/crypto-js/) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/cryptojs/core-min.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/cryptojs/enc-utf16-min.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/cryptojs/enc-base64-min.js')}"></script>

    <!-- Google Maps -->
    <script>
        //fix google maps touch events, forced
        navigator = navigator || {};
        if(('ontouchstart' in window) || (navigator.msMaxTouchPoints > 0)) {
            navigator.msPointerEnabled = true;
            navigator.msMaxTouchPoints = navigator.msMaxTouchPoints || 2;
        }
 
    </script>

    <!-- Google Maps - InfoBubble (http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobubble/examples/example.html) -->
    <script type='text/javascript' src="{!resourcePaths['MapAnything']}/js/google/infobubble/infobubble.js"></script>
    <script type='text/javascript'>

        //InfoBubble does not support padding when panning to view.  Adding the padding that MA needs
        InfoBubble.prototype.panToView = function(offset) {

            //make sure projection and bubble are available
            var projection = this.getProjection();
            if (!projection || !this.bubble_) { return; }

            //this is the magic var

            var MAPaddingTop = 65;

            var anchorHeight = this.getAnchorHeight_();
            var height = this.bubble_.offsetHeight + anchorHeight + MAPaddingTop;
            var map = this.get('map');

            var mapDiv = map.getDiv();
            var mapHeight = mapDiv.offsetHeight;

            var latLng = this.getPosition();
            var centerPos = projection.fromLatLngToContainerPixel(map.getCenter());
            var pos = projection.fromLatLngToContainerPixel(latLng);

            // Find out how much space at the top is free
            var spaceTop = centerPos.y - height;

            // Fine out how much space at the bottom is free
            var spaceBottom = mapHeight - centerPos.y;

            var needsTop = spaceTop < 0;
            var deltaY = 0;

            if (needsTop) {
                spaceTop *= -1;
                deltaY = (spaceTop + spaceBottom) / 2;
            }

            pos.y -= deltaY;
            if (offset) {
                if (offset.x) pos.x += offset.x;
                if (offset.y) pos.y += offset.y;
            }

            latLng = projection.fromContainerPixelToLatLng(pos);

            if (map.getCenter() != latLng) {
                map.panTo(latLng);
            }
        };

        InfoBubble.prototype['panToView'] = InfoBubble.prototype.panToView;
    </script>

    <!-- Google Maps - RichMarker (https://googlemaps.github.io/js-rich-marker/examples/richmarker.html) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/richmarker/richmarker.js')}"></script>
    <script type='text/javascript'>

        //richmarker doesn't support a rightclick event.  adding it
        RichMarker.prototype.onAdd = function() {
            if (!this.markerWrapper_) {
                this.markerWrapper_ = document.createElement('DIV');
                this.markerWrapper_.style['position'] = 'absolute';
            }

            if (this.getZIndex()) {
                this.markerWrapper_.style['zIndex'] = this.getZIndex();
            }

            this.markerWrapper_.style['display'] = this.getVisible() ? '' : 'none';

            if (!this.markerContent_) {
                this.markerContent_ = document.createElement('DIV');
                this.markerWrapper_.appendChild(this.markerContent_);

                var that = this;
                google.maps.event.addDomListener(this.markerContent_, 'click', function(e) {
                    google.maps.event.trigger(that, 'click');
                    e.stopPropagation();
                    e.preventDefault();
                });
                google.maps.event.addDomListener(this.markerContent_, 'mouseover', function(e) {
                    google.maps.event.trigger(that, 'mouseover');
                });
                google.maps.event.addDomListener(this.markerContent_, 'mouseout', function(e) {
                    google.maps.event.trigger(that, 'mouseout');
                });

                //adding rightclick event - DK 11/26/14
                google.maps.event.addDomListener(this.markerContent_, 'contextmenu', function (e) {
                    google.maps.event.trigger(that, 'rightclick');
                    e.stopPropagation();
                    e.preventDefault();
                });
            }

            this.ready_ = true;
            this.content_changed();
            this.flat_changed();
            this.draggable_changed();

            var panes = this.getPanes();
            if (panes) {
                panes.overlayMouseTarget.appendChild(this.markerWrapper_);
            }

            google.maps.event.trigger(this, 'ready');
        };
        RichMarker.prototype['onAdd'] = RichMarker.prototype.onAdd;

    </script>

    <!-- Google Maps - Marker Cluster Plus (http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/examples/advanced_example.html) custom modification on grabbing images from static resource in js file check before updating -->
    <script>var clusterPrefix = '{!sitePrefix}';</script>
    <!--<script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/markerclustererplus/markerclusterer.js')}"></script>-->
    <script type='text/javascript'>
        function ClusterIcon(t, e) { t.getMarkerClusterer().extend(ClusterIcon, google.maps.OverlayView), this.cluster_ = t, this.className_ = t.getMarkerClusterer().getClusterClass(), this.styles_ = e, this.center_ = null, this.div_ = null, this.sums_ = null, this.visible_ = !1, this.setMap(t.getMap()) } function Cluster(t) { this.markerClusterer_ = t, this.map_ = t.getMap(), this.gridSize_ = t.getGridSize(), this.minClusterSize_ = t.getMinimumClusterSize(), this.averageCenter_ = t.getAverageCenter(), this.markers_ = [], this.center_ = null, this.bounds_ = null, this.clusterIcon_ = new ClusterIcon(this, t.getStyles()) } function MarkerClusterer(t, e, r) { this.extend(MarkerClusterer, google.maps.OverlayView), e = e || [], r = r || {}, this.markers_ = [], this.clusters_ = [], this.listeners_ = [], this.activeMap_ = null, this.ready_ = !1, this.gridSize_ = r.gridSize || 60, this.minClusterSize_ = r.minimumClusterSize || 2, this.maxZoom_ = r.maxZoom || null, this.styles_ = r.styles || [], this.title_ = r.title || "", this.zoomOnClick_ = !0, void 0 !== r.zoomOnClick && (this.zoomOnClick_ = r.zoomOnClick), this.averageCenter_ = !1, void 0 !== r.averageCenter && (this.averageCenter_ = r.averageCenter), this.ignoreHidden_ = !1, void 0 !== r.ignoreHidden && (this.ignoreHidden_ = r.ignoreHidden), this.enableRetinaIcons_ = !1, void 0 !== r.enableRetinaIcons && (this.enableRetinaIcons_ = r.enableRetinaIcons), this.imagePath_ = r.imagePath || MarkerClusterer.IMAGE_PATH, this.imageExtension_ = r.imageExtension || MarkerClusterer.IMAGE_EXTENSION, this.imageSizes_ = r.imageSizes || MarkerClusterer.IMAGE_SIZES, this.calculator_ = r.calculator || MarkerClusterer.CALCULATOR, this.batchSize_ = r.batchSize || MarkerClusterer.BATCH_SIZE, this.batchSizeIE_ = r.batchSizeIE || MarkerClusterer.BATCH_SIZE_IE, this.clusterClass_ = r.clusterClass || "cluster", -1 !== navigator.userAgent.toLowerCase().indexOf("msie") && (this.batchSize_ = this.batchSizeIE_), this.setupStyles_(), this.addMarkers(e, !0), this.setMap(t) } ClusterIcon.prototype.onAdd = function () { var t, e, r = this, s = google.maps.version.split("."); s = parseInt(100 * s[0], 10) + parseInt(s[1], 10), this.div_ = document.createElement("div"), this.div_.className = this.className_, this.visible_ && this.show(), this.getPanes().overlayMouseTarget.appendChild(this.div_), this.boundsChangedListener_ = google.maps.event.addListener(this.getMap(), "bounds_changed", function () { e = t }), google.maps.event.addDomListener(this.div_, "mousedown", function () { t = !0, e = !1 }), s >= 332 && google.maps.event.addDomListener(this.div_, "touchstart", function (t) { t.stopPropagation() }), google.maps.event.addDomListener(this.div_, "click", function (s) { if (t = !1, !e) { var i, o, n = r.cluster_.getMarkerClusterer(); google.maps.event.trigger(n, "click", r.cluster_), google.maps.event.trigger(n, "clusterclick", r.cluster_), n.getZoomOnClick() && (o = n.getMaxZoom(), i = r.cluster_.getBounds(), n.getMap().fitBounds(i), setTimeout(function () { n.getMap().fitBounds(i), null !== o && n.getMap().getZoom() > o && n.getMap().setZoom(o + 1) }, 100)), s.cancelBubble = !0, s.stopPropagation && s.stopPropagation() } }), google.maps.event.addDomListener(this.div_, "mouseover", function () { var t = r.cluster_.getMarkerClusterer(); google.maps.event.trigger(t, "mouseover", r.cluster_) }), google.maps.event.addDomListener(this.div_, "mouseout", function () { var t = r.cluster_.getMarkerClusterer(); google.maps.event.trigger(t, "mouseout", r.cluster_) }) }, ClusterIcon.prototype.onRemove = function () { this.div_ && this.div_.parentNode && (this.hide(), google.maps.event.removeListener(this.boundsChangedListener_), google.maps.event.clearInstanceListeners(this.div_), this.div_.parentNode.removeChild(this.div_), this.div_ = null) }, ClusterIcon.prototype.draw = function () { if (this.visible_) { var t = this.getPosFromLatLng_(this.center_); this.div_.style.top = t.y + "px", this.div_.style.left = t.x + "px", this.div_.style.zIndex = google.maps.Marker.MAX_ZINDEX + 1 } }, ClusterIcon.prototype.hide = function () { this.div_ && (this.div_.style.display = "none"), this.visible_ = !1 }, ClusterIcon.prototype.show = function () { if (this.div_) { var t = "", e = this.backgroundPosition_.split(" "), r = parseInt(e[0].replace(/^\s+|\s+$/g, ""), 10), s = parseInt(e[1].replace(/^\s+|\s+$/g, ""), 10), i = this.getPosFromLatLng_(this.center_); this.div_.style.cssText = this.createCss(i), t = "<img src='" + this.url_ + "' style='position: absolute; top: " + s + "px; left: " + r + "px; ", this.cluster_.getMarkerClusterer().enableRetinaIcons_ ? t += "width: " + this.width_ + "px; height: " + this.height_ + "px;" : t += "clip: rect(" + -1 * s + "px, " + (-1 * r + this.width_) + "px, " + (-1 * s + this.height_) + "px, " + -1 * r + "px);", t += "'>", this.div_.innerHTML = t + "<div style='position: absolute;top: " + this.anchorText_[0] + "px;left: " + this.anchorText_[1] + "px;color: " + this.textColor_ + ";font-size: " + this.textSize_ + "px;font-family: " + this.fontFamily_ + ";font-weight: " + this.fontWeight_ + ";font-style: " + this.fontStyle_ + ";text-decoration: " + this.textDecoration_ + ";text-align: center;width: " + this.width_ + "px;line-height:" + this.height_ + "px;'>" + this.sums_.text + "</div>", void 0 === this.sums_.title || "" === this.sums_.title ? this.div_.title = this.cluster_.getMarkerClusterer().getTitle() : this.div_.title = this.sums_.title, this.div_.style.display = "" } this.visible_ = !0 }, ClusterIcon.prototype.useStyle = function (t) { this.sums_ = t; var e = Math.max(0, t.index - 1); e = Math.min(this.styles_.length - 1, e); var r = this.styles_[e]; this.url_ = r.url, this.height_ = r.height, this.width_ = r.width, this.anchorText_ = r.anchorText || [0, 0], this.anchorIcon_ = r.anchorIcon || [parseInt(this.height_ / 2, 10), parseInt(this.width_ / 2, 10)], this.textColor_ = r.textColor || "black", this.textSize_ = r.textSize || 11, this.textDecoration_ = r.textDecoration || "none", this.fontWeight_ = r.fontWeight || "bold", this.fontStyle_ = r.fontStyle || "normal", this.fontFamily_ = r.fontFamily || "Arial,sans-serif", this.backgroundPosition_ = r.backgroundPosition || "0 0" }, ClusterIcon.prototype.setCenter = function (t) { this.center_ = t }, ClusterIcon.prototype.createCss = function (t) { var e = []; return e.push("cursor: pointer;"), e.push("position: absolute; top: " + t.y + "px; left: " + t.x + "px;"), e.push("width: " + this.width_ + "px; height: " + this.height_ + "px;"), e.push("-webkit-user-select: none;"), e.push("-khtml-user-select: none;"), e.push("-moz-user-select: none;"), e.push("-o-user-select: none;"), e.push("user-select: none;"), e.join("") }, ClusterIcon.prototype.getPosFromLatLng_ = function (t) { var e = this.getProjection().fromLatLngToDivPixel(t); return e.x -= this.anchorIcon_[1], e.y -= this.anchorIcon_[0], e.x = parseInt(e.x, 10), e.y = parseInt(e.y, 10), e }, Cluster.prototype.getSize = function () { return this.markers_.length }, Cluster.prototype.getMarkers = function () { return this.markers_ }, Cluster.prototype.getCenter = function () { return this.center_ }, Cluster.prototype.getMap = function () { return this.map_ }, Cluster.prototype.getMarkerClusterer = function () { return this.markerClusterer_ }, Cluster.prototype.getBounds = function () { var t, e = new google.maps.LatLngBounds(this.center_, this.center_), r = this.getMarkers(); for (t = 0; t < r.length; t++)e.extend(r[t].getPosition()); return e }, Cluster.prototype.remove = function () { this.clusterIcon_.setMap(null), this.markers_ = [], delete this.markers_ }, Cluster.prototype.addMarker = function (t) { var e, r, s; if (this.isMarkerAlreadyAdded_(t)) return !1; if (this.center_) { if (this.averageCenter_) { var i = this.markers_.length + 1, o = (this.center_.lat() * (i - 1) + t.getPosition().lat()) / i, n = (this.center_.lng() * (i - 1) + t.getPosition().lng()) / i; this.center_ = new google.maps.LatLng(o, n), this.calculateBounds_() } } else this.center_ = t.getPosition(), this.calculateBounds_(); if (t.isAdded = !0, this.markers_.push(t), r = this.markers_.length, null !== (s = this.markerClusterer_.getMaxZoom()) && this.map_.getZoom() > s) t.getMap() !== this.map_ && t.setMap(this.map_); else if (r < this.minClusterSize_) t.getMap() !== this.map_ && t.setMap(this.map_); else if (r === this.minClusterSize_) for (e = 0; e < r; e++)this.markers_[e].setMap(null); else t.setMap(null); return this.updateIcon_(), !0 }, Cluster.prototype.isMarkerInClusterBounds = function (t) { return this.bounds_.contains(t.getPosition()) }, Cluster.prototype.calculateBounds_ = function () { var t = new google.maps.LatLngBounds(this.center_, this.center_); this.bounds_ = this.markerClusterer_.getExtendedBounds(t) }, Cluster.prototype.updateIcon_ = function () { var t = this.markers_.length, e = this.markerClusterer_.getMaxZoom(); if (null !== e && this.map_.getZoom() > e) this.clusterIcon_.hide(); else if (t < this.minClusterSize_) this.clusterIcon_.hide(); else { var r = this.markerClusterer_.getStyles().length, s = this.markerClusterer_.getCalculator()(this.markers_, r); this.clusterIcon_.setCenter(this.center_), this.clusterIcon_.useStyle(s), this.clusterIcon_.show() } }, Cluster.prototype.isMarkerAlreadyAdded_ = function (t) { var e; if (this.markers_.indexOf) return -1 !== this.markers_.indexOf(t); for (e = 0; e < this.markers_.length; e++)if (t === this.markers_[e]) return !0; return !1 }, MarkerClusterer.prototype.onAdd = function () { var t = this; this.activeMap_ = this.getMap(), this.ready_ = !0, this.repaint(), this.prevZoom_ = this.getMap().getZoom(), this.listeners_ = [google.maps.event.addListener(this.getMap(), "zoom_changed", function () { var t = this.getMap().getZoom(), e = this.getMap().minZoom || 0, r = Math.min(this.getMap().maxZoom || 100, this.getMap().mapTypes[this.getMap().getMapTypeId()].maxZoom); t = Math.min(Math.max(t, e), r), this.prevZoom_ != t && (this.prevZoom_ = t, this.resetViewport_(!1)) }.bind(this)), google.maps.event.addListener(this.getMap(), "idle", function () { t.redraw_() })] }, MarkerClusterer.prototype.onRemove = function () { var t; for (t = 0; t < this.markers_.length; t++)this.markers_[t].getMap() !== this.activeMap_ && this.markers_[t].setMap(this.activeMap_); for (t = 0; t < this.clusters_.length; t++)this.clusters_[t].remove(); for (this.clusters_ = [], t = 0; t < this.listeners_.length; t++)google.maps.event.removeListener(this.listeners_[t]); this.listeners_ = [], this.activeMap_ = null, this.ready_ = !1 }, MarkerClusterer.prototype.draw = function () { }, MarkerClusterer.prototype.setupStyles_ = function () { var t, e; if (!(this.styles_.length > 0)) for (t = 0; t < this.imageSizes_.length; t++)e = this.imageSizes_[t], this.styles_.push({ url: this.imagePath_ + (t + 1) + "." + this.imageExtension_, height: e, width: e }) }, MarkerClusterer.prototype.fitMapToMarkers = function () { var t, e = this.getMarkers(), r = new google.maps.LatLngBounds; for (t = 0; t < e.length; t++)!e[t].getVisible() && this.getIgnoreHidden() || r.extend(e[t].getPosition()); this.getMap().fitBounds(r) }, MarkerClusterer.prototype.getGridSize = function () { return this.gridSize_ }, MarkerClusterer.prototype.setGridSize = function (t) { this.gridSize_ = t }, MarkerClusterer.prototype.getMinimumClusterSize = function () { return this.minClusterSize_ }, MarkerClusterer.prototype.setMinimumClusterSize = function (t) { this.minClusterSize_ = t }, MarkerClusterer.prototype.getMaxZoom = function () { return this.maxZoom_ }, MarkerClusterer.prototype.setMaxZoom = function (t) { this.maxZoom_ = t }, MarkerClusterer.prototype.getStyles = function () { return this.styles_ }, MarkerClusterer.prototype.setStyles = function (t) { this.styles_ = t }, MarkerClusterer.prototype.getTitle = function () { return this.title_ }, MarkerClusterer.prototype.setTitle = function (t) { this.title_ = t }, MarkerClusterer.prototype.getZoomOnClick = function () { return this.zoomOnClick_ }, MarkerClusterer.prototype.setZoomOnClick = function (t) { this.zoomOnClick_ = t }, MarkerClusterer.prototype.getAverageCenter = function () { return this.averageCenter_ }, MarkerClusterer.prototype.setAverageCenter = function (t) { this.averageCenter_ = t }, MarkerClusterer.prototype.getIgnoreHidden = function () { return this.ignoreHidden_ }, MarkerClusterer.prototype.setIgnoreHidden = function (t) { this.ignoreHidden_ = t }, MarkerClusterer.prototype.getEnableRetinaIcons = function () { return this.enableRetinaIcons_ }, MarkerClusterer.prototype.setEnableRetinaIcons = function (t) { this.enableRetinaIcons_ = t }, MarkerClusterer.prototype.getImageExtension = function () { return this.imageExtension_ }, MarkerClusterer.prototype.setImageExtension = function (t) { this.imageExtension_ = t }, MarkerClusterer.prototype.getImagePath = function () { return this.imagePath_ }, MarkerClusterer.prototype.setImagePath = function (t) { this.imagePath_ = t }, MarkerClusterer.prototype.getImageSizes = function () { return this.imageSizes_ }, MarkerClusterer.prototype.setImageSizes = function (t) { this.imageSizes_ = t }, MarkerClusterer.prototype.getCalculator = function () { return this.calculator_ }, MarkerClusterer.prototype.setCalculator = function (t) { this.calculator_ = t }, MarkerClusterer.prototype.getBatchSizeIE = function () { return this.batchSizeIE_ }, MarkerClusterer.prototype.setBatchSizeIE = function (t) { this.batchSizeIE_ = t }, MarkerClusterer.prototype.getClusterClass = function () { return this.clusterClass_ }, MarkerClusterer.prototype.setClusterClass = function (t) { this.clusterClass_ = t }, MarkerClusterer.prototype.getMarkers = function () { return this.markers_ }, MarkerClusterer.prototype.getTotalMarkers = function () { return this.markers_.length }, MarkerClusterer.prototype.getClusters = function () { return this.clusters_ }, MarkerClusterer.prototype.getTotalClusters = function () { return this.clusters_.length }, MarkerClusterer.prototype.addMarker = function (t, e) { this.pushMarkerTo_(t), e || this.redraw_() }, MarkerClusterer.prototype.addMarkers = function (t, e) { var r; for (r in t) t.hasOwnProperty(r) && this.pushMarkerTo_(t[r]); e || this.redraw_() }, MarkerClusterer.prototype.pushMarkerTo_ = function (t) { if (t.getDraggable()) { var e = this; google.maps.event.addListener(t, "dragend", function () { e.ready_ && (this.isAdded = !1, e.repaint()) }) } t.isAdded = !1, this.markers_.push(t) }, MarkerClusterer.prototype.removeMarker = function (t, e) { var r = this.removeMarker_(t); return !e && r && this.repaint(), r }, MarkerClusterer.prototype.removeMarkers = function (t, e) { var r, s, i = !1; for (r = 0; r < t.length; r++)s = this.removeMarker_(t[r]), i = i || s; return !e && i && this.repaint(), i }, MarkerClusterer.prototype.removeMarker_ = function (t) { var e, r = -1; if (this.markers_.indexOf) r = this.markers_.indexOf(t); else for (e = 0; e < this.markers_.length; e++)if (t === this.markers_[e]) { r = e; break } return -1 !== r && (t.setMap(null), this.markers_.splice(r, 1), !0) }, MarkerClusterer.prototype.clearMarkers = function () { this.resetViewport_(!0), this.markers_ = [] }, MarkerClusterer.prototype.repaint = function () { var t = this.clusters_.slice(); this.clusters_ = [], this.resetViewport_(!1), this.redraw_(), setTimeout(function () { var e; for (e = 0; e < t.length; e++)t[e].remove() }, 0) }, MarkerClusterer.prototype.getExtendedBounds = function (t) { var e = this.getProjection(), r = new google.maps.LatLng(t.getNorthEast().lat(), t.getNorthEast().lng()), s = new google.maps.LatLng(t.getSouthWest().lat(), t.getSouthWest().lng()), i = e.fromLatLngToDivPixel(r); i.x += this.gridSize_, i.y -= this.gridSize_; var o = e.fromLatLngToDivPixel(s); o.x -= this.gridSize_, o.y += this.gridSize_; var n = e.fromDivPixelToLatLng(i), a = e.fromDivPixelToLatLng(o); return t.extend(n), t.extend(a), t }, MarkerClusterer.prototype.redraw_ = function () { this.createClusters_(0) }, MarkerClusterer.prototype.resetViewport_ = function (t) { var e, r; for (e = 0; e < this.clusters_.length; e++)this.clusters_[e].remove(); for (this.clusters_ = [], e = 0; e < this.markers_.length; e++)(r = this.markers_[e]).isAdded = !1, t && r.setMap(null) }, MarkerClusterer.prototype.distanceBetweenPoints_ = function (t, e) { var r = (e.lat() - t.lat()) * Math.PI / 180, s = (e.lng() - t.lng()) * Math.PI / 180, i = Math.sin(r / 2) * Math.sin(r / 2) + Math.cos(t.lat() * Math.PI / 180) * Math.cos(e.lat() * Math.PI / 180) * Math.sin(s / 2) * Math.sin(s / 2); return 6371 * (2 * Math.atan2(Math.sqrt(i), Math.sqrt(1 - i))) }, MarkerClusterer.prototype.isMarkerInBounds_ = function (t, e) { return e.contains(t.getPosition()) }, MarkerClusterer.prototype.addToClosestCluster_ = function (t) { var e, r, s, i, o = 4e4, n = null; for (e = 0; e < this.clusters_.length; e++)(i = (s = this.clusters_[e]).getCenter()) && (r = this.distanceBetweenPoints_(i, t.getPosition())) < o && (o = r, n = s); n && n.isMarkerInClusterBounds(t) ? n.addMarker(t) : ((s = new Cluster(this)).addMarker(t), this.clusters_.push(s)) }, MarkerClusterer.prototype.createClusters_ = function (t) { var e, r, s, i = this; if (this.ready_) { 0 === t && (google.maps.event.trigger(this, "clusteringbegin", this), void 0 !== this.timerRefStatic && (clearTimeout(this.timerRefStatic), delete this.timerRefStatic)), s = this.getMap().getZoom() > 3 ? new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(), this.getMap().getBounds().getNorthEast()) : new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472, -178.48388434375), new google.maps.LatLng(-85.08136444384544, 178.00048865625)); var o = this.getExtendedBounds(s), n = Math.min(t + this.batchSize_, this.markers_.length); for (e = t; e < n; e++)!(r = this.markers_[e]).isAdded && this.isMarkerInBounds_(r, o) && (!this.ignoreHidden_ || this.ignoreHidden_ && r.getVisible()) && this.addToClosestCluster_(r); n < this.markers_.length ? this.timerRefStatic = setTimeout(function () { i.createClusters_(n) }, 0) : (delete this.timerRefStatic, google.maps.event.trigger(this, "clusteringend", this)) } }, MarkerClusterer.prototype.extend = function (t, e) { return function (t) { var e; for (e in t.prototype) this.prototype[e] = t.prototype[e]; return this }.apply(t, [e]) }, MarkerClusterer.CALCULATOR = function (t, e) { for (var r = 0, s = t.length.toString(), i = s; 0 !== i;)i = parseInt(i / 10, 10), r++; return { text: s, index: r = Math.min(r, e), title: "" } }, MarkerClusterer.BATCH_SIZE = 2e3, MarkerClusterer.BATCH_SIZE_IE = 500, MarkerClusterer.IMAGE_PATH ="https://cdn.rawgit.com/googlemaps/js-marker-clusterer/gh-pages/images/m",MarkerClusterer.IMAGE_EXTENSION="png",MarkerClusterer.IMAGE_SIZES=[53,56,66,78,90];

    </script>
    <script type='text/javascript'>
        //markerclusterer doesn't support a rightclick event on clusters.  adding it
        ClusterIcon.prototype.onAdd = function () {
            var cClusterIcon = this;
            var cMouseDownInCluster;
            var cDraggingMapByCluster;
            this.div_ = document.createElement("div");
            this.div_.className = this.className_;
            if (this.visible_) {
                this.show();
            }

            this.getPanes().overlayMouseTarget.appendChild(this.div_);

            // Fix for Issue 157
            this.boundsChangedListener_ = google.maps.event.addListener(this.getMap(), "bounds_changed", function () {
                cDraggingMapByCluster = cMouseDownInCluster;
            });

            google.maps.event.addDomListener(this.div_, "mousedown", function () {
                cMouseDownInCluster = true;
                cDraggingMapByCluster = false;
            });

            google.maps.event.addDomListener(this.div_, "click", function (e) {
                cMouseDownInCluster = false;
                if (!cDraggingMapByCluster) {
                    var theBounds;
                    var mz;
                    var mc = cClusterIcon.cluster_.getMarkerClusterer();
                    /**
                    * This event is fired when a cluster marker is clicked.
                    * @name MarkerClusterer#click
                    * @param {Cluster} c The cluster that was clicked.
                    * @event
                    */
                    google.maps.event.trigger(mc, "click", cClusterIcon.cluster_);
                    google.maps.event.trigger(mc, "clusterclick", cClusterIcon.cluster_); // deprecated name

                    // The default click handler follows. Disable it by setting
                    // the zoomOnClick property to false.
                    if (mc.getZoomOnClick()) {
                        // Zoom into the cluster.
                        mz = mc.getMaxZoom();
                        theBounds = cClusterIcon.cluster_.getBounds();
                        mc.getMap().fitBounds(theBounds);
                        // There is a fix for Issue 170 here:
                        setTimeout(function () {
                            mc.getMap().fitBounds(theBounds);
                            // Don't zoom beyond the max zoom level
                            if (mz !== null && (mc.getMap().getZoom() > mz)) {
                                mc.getMap().setZoom(mz + 1);
                            }
                        }, 100);
                    }

                    // Prevent event propagation to the map:
                    e.cancelBubble = true;
                    if (e.stopPropagation) {
                        e.stopPropagation();
                    }
                }
            });

            //adding rightclick event handling - DK 11/25/14
            google.maps.event.addDomListener(this.div_, "contextmenu", function (e)
            {
                //trigger rightclick event
                google.maps.event.trigger(cClusterIcon.cluster_.getMarkerClusterer(), "rightclick", cClusterIcon.cluster_);

                // Prevent event propagation to the map:
                e.cancelBubble = true;
                if (e.stopPropagation) { e.stopPropagation(); }
                if (e.preventDefault) { e.preventDefault(); }
            });

            google.maps.event.addDomListener(this.div_, "mouseover", function () {
                var mc = cClusterIcon.cluster_.getMarkerClusterer();
                /**
                * This event is fired when the mouse moves over a cluster marker.
                * @name MarkerClusterer#mouseover
                * @param {Cluster} c The cluster that the mouse moved over.
                * @event
                */
                google.maps.event.trigger(mc, "mouseover", cClusterIcon.cluster_);
            });

            google.maps.event.addDomListener(this.div_, "mouseout", function () {
                var mc = cClusterIcon.cluster_.getMarkerClusterer();
                /**
                * This event is fired when the mouse moves out of a cluster marker.
                * @name MarkerClusterer#mouseout
                * @param {Cluster} c The cluster that the mouse moved out of.
                * @event
                */
                google.maps.event.trigger(mc, "mouseout", cClusterIcon.cluster_);
            });
        };

    </script>

    <!-- Google Maps - KeyDragZoom -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/keydragzoom/keydragzoom_packed.js')}"></script>

    <!-- Google Maps - geoxml3 (https://code.google.com/p/geoxml3/) -->
    <script type='text/javascript' src="{!resourcePaths['MapAnything']}/js/google/geoxml3/ZipFile.complete.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnything']}/js/google/geoxml3/ProjectedOverlay.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnything']}/js/google/geoxml3/geoxml3.js"></script>

    <!-- Google Maps - Spiderfy (https://github.com/jawj/OverlappingMarkerSpiderfier) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/overlappingmarkerspiderfier/oms.min.js')}"></script>

    <!-- Context Menu (http://medialize.github.io/jQuery-contextMenu/) -->
    <script type='text/javascript' src="{!resourcePaths['MapAnything']}/contextMenu/jquery.contextmenu.js"></script>
    <link type="text/css" rel="stylesheet" href="{!URLFOR($Resource.MapAnything, 'contextMenu/jquery.contextMenu.min.css')}" />

    <!-- Colorbox (overlay) -->
    <script type="text/javascript" src="{!URLFOR($Resource.MapAnything, 'colorbox/jquery.colorbox-min.js')}"></script>
    <link type="text/css" rel="stylesheet" href="{!URLFOR($Resource.MapAnything, 'colorbox/css4/colorbox.css')}" />

    <!-- Moment (date parsing) -->
    <script src="{!URLFOR($Resource.MapAnything, 'js/moment.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.MapAnything, 'js/moment_tz.js')}" type="text/javascript"></script>

    <!-- Full Calendar -->
    <script src="{!URLFOR($Resource.MapAnything, 'js/fullcalendar.min.js')}" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnything, 'css/fullcalendar.min.css')}"></link>

    <!-- Scheduler -->
    <script src="{!URLFOR($Resource.MapAnything, 'js/scheduler.min.js')}" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnything, 'css/scheduler.min.css')}"></link>

    <!-- jQuery Multiselect (depends on jQuery UI) -->
    <script src="{!URLFOR($Resource.QueryEditor, 'js/multiselect/jquery.multiselect.min.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.QueryEditor, 'js/multiselect/jquery.multiselect.filter.js')}" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.QueryEditor, 'js/multiselect/jquery.multiselect.css')}" />
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.QueryEditor, 'js/multiselect/jquery.multiselect.filter.css')}" />

    <!-- Combobox -->
    <script src="{!URLFOR($Resource.QueryEditor, 'js/combobox/jquery.combobox.js')}" type="text/javascript"></script>

    <!-- bxSlider (http://bxslider.com/) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jquery/jquery.bxslider.min.js')}"></script>

    <!-- Removed due to not supporting new jquery -->
    <!--<script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/jquery.hotkeys.js')}"></script>-->

    <!-- CSS -->
    <c:CSSEditQuery />
    <c:CSSHelperBlue />
    <!-- c:CSSMapAnything -->

    <!-- moving style off page... -->
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnythingJS, 'styles/oldOnPageStyle.css')}" />

	<style>
        #tabs-nav .ftu-tooltip-arrow.forceWhite::before {
            border-right: 8px solid #fff;
        }

        body div#sidebar {
            width: auto !important;
            height: auto !important;
        }

		div#DrawRectangleButton {
		  background-image: url('{!URLFOR($Resource.MapAnything, "/images/drawingtools/gt_rectangle.png")}');
		  background-size: 21px 22px;
		  background-repeat: no-repeat;
		  background-position: 7px 7px;
		}

		div#DrawRectangleButton.activeDrawingTool {
		  background-color: #237bc5;
		  background-image: url('{!URLFOR($Resource.MapAnything, "/images/drawingtools/gt_rectangle_active.png")}');
		  background-size: 21px 22px;
		  background-repeat: no-repeat;
		  background-position: 7px 7px;
		  box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.2);
		}

		div#DrawCircleButton {
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_circle.png")}');
		  background-size: 18px 22px;
		  background-repeat: no-repeat;
		  background-position: 9px 7px;
		}

		div#DrawCircleButton.activeDrawingTool {
		  background-color: #237bc5;
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_circle_active.png")}');
		  background-size: 18px 22px;
		  background-repeat: no-repeat;
		  background-position: 9px 7px;
		  box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.2);
		}

		div#DrawPolygonButton {
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_polygon.png")}');
		  background-size: 21px 20px;
		  background-repeat: no-repeat;
		  background-position: 8px 8px;
		}

		div#DrawPolygonButton.activeDrawingTool {
		  background-color: #237bc5;
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_polygon_active.png")}');
		  background-size: 21px 20px;
		  background-repeat: no-repeat;
		  background-position: 8px 8px;
		  box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.2);
		}

		div#StopDrawingButton {
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_hand.png")}');
		  background-size: 19px 20px;
		  background-repeat: no-repeat;
		  background-position: 8px 8px;
		}

		#StopDrawingButton.activeDrawingTool {
		  background-color: #237bc5;
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_hand_active.png")}');
		  background-size: 19px 20px;
		  background-repeat: no-repeat;
		  background-position: 8px 8px;
		  box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.2);
		}


		/*Map View*/

		td[data-basemaptype="roadmap"] {
		  background-image:url('{!URLFOR($Resource.MapAnything, '/images/MapView/roadmap.png')}');
		  height: 100px;
		  width: 100px;
		  vertical-align: bottom;
		}

		td[data-basemaptype="satellite"] {
		  background-image:url('{!URLFOR($Resource.MapAnything, '/images/MapView/Satellite.png')}');
		  height: 100px;
		  width: 100px;
		  vertical-align: bottom;
		}

		td[data-basemaptype="hybrid"] {
		  background-image:url('{!URLFOR($Resource.MapAnything, '/images/MapView/hybrid.png')}');
		  height: 100px;
		  width: 100px;
		  vertical-align: bottom;
		}

		td[data-basemaptype="terrain"] {
		  background-image:url('{!URLFOR($Resource.MapAnything, '/images/MapView/terrain.png')}');
		  height: 100px;
		  width: 100px;
		  vertical-align: bottom;
		}

		#listview th.listview-col-sortable>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0 0;
		  width: 10px;
		  position: absolute;
		  top: 5px;
		  right: 3px;
		  height: 15px;
		  opacity: 0.7;
		}

		#listview th.listview-col-sortable.listview-col-sort-asc>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0px -26px;
		  width: 10px;
		  position: absolute;
		  top: 9px;
		  right: 3px;
		  height: 10px;
		  opacity: 1;
		}

		#listview th.listview-col-sortable.listview-col-sort-desc>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0px -16px;
		  width: 10px;
		  position: absolute;
		  top: 8px;
		  right: 3px;
		  height: 10px;
		  opacity: 1;
		}

		#listview th.listview-col-sortable>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0 0;
		  width: 10px;
		  position: absolute;
		  top: 5px;
		  right: 3px;
		  height: 15px;
		  opacity: 0.7;
		}

		#listview th.listview-col-sortable.listview-col-sort-asc>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0px -26px;
		  width: 10px;
		  position: absolute;
		  top: 9px;
		  right: 3px;
		  height: 10px;
		  opacity: 1;
		}

		#listview th.listview-col-sortable.listview-col-sort-desc>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0px -16px;
		  width: 10px;
		  position: absolute;
		  top: 8px;
		  right: 3px;
		  height: 10px;
		  opacity: 1;
		}

		#sidebar-content [aria-selected=true]>#tabs-nav-queries {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: -81px -41px;
		}

		#sidebar-content [aria-selected=true]>#tabs-nav-plotted {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: -81px 8px;
		}

		#sidebar-content [aria-selected=true]>#tabs-nav-routes {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: -82px -148px;
		}

		#sidebar-content [aria-selected=true]>#tabs-nav-poi {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: -86px -99px;
		}

		#sidebar-content [aria-selected=false]>#tabs-nav-queries {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: 25px -41px;
		}

		#sidebar-content [aria-selected=false]>#tabs-nav-plotted {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: 25px 8px;
		}

		#sidebar-content [aria-selected=false]>#tabs-nav-routes {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: 32px -149px;
		}

		#sidebar-content [aria-selected=false]>#tabs-nav-poi {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: 31px -99px;
		}

		#SQTree .jstree-star {
		  padding-right: 20px !important;
		  background:url('{!URLFOR($Resource.MapAnything, 'images/star_full.png')}') right top no-repeat !important;
		}

		#tooltip-content .tabs>div.loading, .infobubble .tabs>div.loading {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}') no-repeat center;
		}

		a.btn.white .btn-dropdown-arrow-blue {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/dropdown_arrow_blue2.png')}") no-repeat scroll 1px 3px transparent;
		  border-radius: 3px 3px 3px 3px;
		  display: block;
		  height: 5px;
		  margin: 0 0 0 5px;
		  padding: 3px 1px;
		  position: absolute;
		  top: 5px;
		  right: 5px;
		  width: 9px;
		}

        .arcgis-form-element {
            display: none;
        }

		#createrecord-loadmask, #createrecordDataLayer-loadmask {
		  position: absolute;
		  top: 0;
		  left: 0;
		  width: 100%;
		  height: 100%;
		  z-index: 99999999;
		  background: rgba(0, 0, 0, 0.04) url('{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}') center no-repeat;
		}

		#cboxLoadingOverlay {
		  background: white url('{!URLFOR($Resource.MapAnything, "MapLoadingGif.gif")}') no-repeat center;
		}

		#queryeditor-modal .query-editor-modal-loader {
		  background: white url('{!URLFOR($Resource.MapAnything, "MapLoadingGif.gif")}') no-repeat;
		}

		#Favorites-Tree .jstree li[rel="leaf"]>a>.jstree-icon {
		  background-image: url("{!URLFOR($Resource.MapAnything, '/images/ui-icons/favorites.png')}");
		  background-size: 16px;
		}

		#PlottedQueriesContainer .PlottedRowUnit .plottinginfo-wrapper .info-icon, #PlottedQueriesContainer .PlottedShapeLayer .info-icon {
		  position: absolute;
		  margin-top: 10px;
		  padding: 0;
		  left: 10px;
		  top: 5px;
		  height: 17px;
		  width: 17px;
		  background: transparent url("{!URLFOR($Resource.MapAnything, '/images/ui-icons/ui-info.png')}") center no-repeat;
		  background-size: 16px;
		}

		#PlottedQueriesContainer .PlottedRowUnit .icon .color-box.dynamic {
		  height: 20px;
		  width: 30px;
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/dymanic-legend.png')}") center no-repeat;
		}

		.PlottedRowUnit .plotted-visibile-icon .select-icon.Markers {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/icon_pin17.png')}") center no-repeat;
		}

		.PlottedRowUnit .plotted-visibile-icon .select-icon.Cluster {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/icon_cluster17.png')}") center no-repeat;
		}

		.PlottedRowUnit .plotted-visibile-icon .select-icon.Heatmap {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/icon_heatmap17.png')}") center no-repeat;
		}

		.PlottedRowUnit .plotted-visibile-icon .select-icon.Scatter {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/icon_scatter17.png')}") center no-repeat;
		}


		/* Saved Query Icons */

		.jstree li[rel="SavedQuery"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/static-legend2.png')}") !important;
		}

		.jstree li[rel="SavedQuery"][querytype="Standard-Dynamic"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/static-dynamic.png')}") !important;
		}

		.jstree li[rel="LegendSavedQuery"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/dymanic-legend.png')}") !important;
		}

		.jstree li[rel="LegendSavedQuery"][querytype="Legend-Dynamic"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/dynamic-dynamic.png')}") !important;
		}

		.jstree li[rel="SavedDataLayer"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'malayersv2/img/data_icon.svg')}") !important;
		}

		#demographic-alert-image {
		  background-image: url("{!URLFOR($Resource.MapAnything, 'malayersv2/img/data_icon.svg')}");
		  background-repeat: no-repeat;
		  background-position: center;
		  height: 40px;
		  width: 40px;
		  background-size: 40px 40px;
		}

		#PlottedQueriesContainer .DataLayer .icon .color-box {
		  background-image: url("{!URLFOR($Resource.MapAnything, 'malayersv2/img/data_icon.svg')}") !important;
		  background-repeat: no-repeat;
		  background-position: center;
		  height: 20px;
		}


		/* Root Folder Icons */

		#SQTree li[nodetype="PersonalRoot"]>a>.jstree-icon, #SQTree li[nodetype="RoleRoot"]>a>.jstree-icon, #SQTree li[nodetype="CorporateRoot"]>a>.jstree-icon, #Favorites-Tree li[rel="Root"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/root-folder-closed.png')}") !important;
		}

		#SQTree li[nodetype="PersonalRoot"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="RoleRoot"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="CorporateRoot"].jstree-open>a>.jstree-icon, #Favorites-Tree li[rel="Root"].jstree-open>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/root-folder.png')}") !important;
		}


		/* Folder Icons */

		#SQTree li[nodetype="PersonalFolder"]>a>.jstree-icon, #SQTree li[nodetype="CorporateFolder"]>a>.jstree-icon, #SQTree li[nodetype="RoleNameFolder"]>a>.jstree-icon, #SQTree li[nodetype="RoleUserFolder"]>a>.jstree-icon, #Favorites-Tree li[rel="Folder"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/child-folder-closed.png')}") !important;
		}

		#SQTree li[nodetype="PersonalFolder"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="CorporateFolder"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="RoleNameFolder"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="RoleUserFolder"].jstree-open>a>.jstree-icon, #Favorites-Tree li[rel="Folder"].jstree-open>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/child-folder.png')}") !important;
		}


		/* Loading Icons */

		#SQTree li[nodetype="PersonalRoot"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="RoleRoot"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="CorporateRoot"]>a.jstree-loading>.jstree-icon, #Favorites-Tree li[rel="Root"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="PersonalFolder"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="CorporateFolder"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="RoleNameFolder"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="RoleUserFolder"]>a.jstree-loading>.jstree-icon, #Favorites-Tree li[rel="Folder"]>a.jstree-loading>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/tree-loader.gif')}") no-repeat !important;
		}

		#SQTree li[nodetype="PersonalLocation"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/favorite_tree_icon.png')}") !important;
		}


		/* Copied from style.css */

		.jstree-default li, .jstree-default ins {
		  background-image:url("{!URLFOR($Resource.MapAnything, 'jstree/themes/default/d.png')}");
		  background-repeat: no-repeat;
		  background-color: transparent;
		}

		#jstree-marker.jstree-default {
		  background:url("{!URLFOR($Resource.MapAnything, 'jstree/themes/default/d.png')}") -55px -65px no-repeat !important;
		  text-indent: -100px;
		  z-index: 15;
		  width: 19px;
		  height: 19px;
		}

		#vakata-contextmenu li a span {
		  background: url('{!URLFOR($Resource.MapAnything, '/contextMenu/images/contextmenu-arrow.png')}') no-repeat;
		  position: relative;
		  top: 5px;
		  width: 10px;
		  height: 10px;
		  color: transparent;
		}

		#vakata-dragged.jstree-default .jstree-ok {
		  width: 19px;
		  height: 19px;
		  -moz-border-radius: 0;
		  -webkit-border-radius: 0;
		  border-radius: 0;
		  background:url("{!URLFOR($Resource.MapAnything, 'jstree/themes/default/d.png')}") -2px -62px no-repeat !important;
		}

		#vakata-dragged.jstree-default .jstree-invalid {
		  width: 19px;
		  height: 19px;
		  -moz-border-radius: 0;
		  -webkit-border-radius: 0;
		  border-radius: 0;
		  background:url("{!URLFOR($Resource.MapAnything, 'jstree/themes/default/d.png')}") -26px -62px no-repeat !important;
		}

		.pac-container:after {
		  content: "";
		  padding: 1px 1px 1px 0;
		  height: 16px;
		  text-align: right;
		  display: block;
		  background-image: url("{!URLFOR($Resource.MapAnything, 'js/google/images/powered-by-google-on-white2.png')}");
		  background-position: right;
		  background-repeat: no-repeat;
		  background-size: 104px 16px;
		}

		.pac-icon {
		  width: 15px;
		  height: 20px;
		  margin-right: 7px;
		  margin-top: 6px;
		  display: inline-block;
		  vertical-align: top;
		  background-image: url("{!URLFOR($Resource.MapAnything, 'js/google/images/autocomplete-icons.png')}");
		  background-size: 34px;
		}

		.tooltip-row.Color td.icon {
		  background: transparent url("{!URLFOR($Resource.MapAnything, 'images/SymbolPicker_Mini.png')}") no-repeat;
		  width: 20px;
		}

		.tooltipMapBG {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/mapSample.png')}');
		  height: auto;
		  min-height: 200px;
		  width: 85% !important;
		  background-position: top left;
		  float: left;
		  padding: 50px;
		}

		.baseobject-row .data.checked div {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/checkbox-checked-32.png')}') no-repeat center;
		}

		.baseobject-row .data.unchecked div {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/checkbox-unchecked-32.png')}') no-repeat center;
		}

		.baseobject-row .data.loading div {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/chatter-loader.gif')}') no-repeat center;
		}

		#SQTree li[rel="SavedTerritory"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/boundry_tree_icon.png')}") !important;
		}

		.boundary-cell:hover .checkbox, .boundary-cell.checked .checkbox {
		  background: #A6ADBB url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/ui-ckeck-mark.png')}') no-repeat -11px 1px;
		  background-size: 22px;
		}

		.territory-row[data-state="loading"] .territory-row-toggle {
		  width: 8px;
		  height: 8px;
		  background: transparent url("{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}") no-repeat center;
		}

		#toast-container .ma-toast-loading {
		  background-color: #16325c;
		  background-image: url('{!URLFOR($Resource.MAPhone, "/s1Mobile/images/spinners/slds_spinner_inverse.gif")}');
		  background-size: 30px 30px;
		}

		#toast-container .toast-warning {
		  background-color: #e3924a;
		}

		#toast-container .toast-error {
		  background-color: #d4504c;
		}

		#toast-container .toast-success {
		  background-color: #003c4c;
		}

		.ui-combobox a .ui-button-icon-primary {
		  background: transparent url("{!URLFOR($Resource.QueryEditor, 'images/icons/combobox-arrow-16.png')}") no-repeat center !important;
		}

		#PlottedQueriesContainer .styled-select {
		  width: 100px;
		  height: 20px;
		  overflow: hidden;
		  background: url("{!URLFOR($Resource.QueryEditor, '/images/icons/combobox-arrow-16.png')}") no-repeat right;
		  border: 1px solid #ccc;
		  border-radius: 3px;
		}

		#permissions-grid-wrapper .ui-combobox a .ui-button-icon-primary {
		  background: transparent url("{!URLFOR($Resource.QueryEditor, 'images/icons/combobox-arrow-16.png')}") no-repeat center;
		}

		.tracking-history-content input[id*="cor"]:checked+label:before {
		  content: '';
		  background-image: url(/resource/1472208638000/sma__MapAnything/images/check-22.png);
		  display: block;
		  position: absolute;
		  z-index: 99;
		  background-size: 14px 14px;
		  width: 14px;
		  height: 14px;
		  top: 1px;
		  left: 1px;
		  color: #000;
		}

		.colorIsChecked {
		  content: '';
		  background-image: url(/resource/1472208638000/sma__MapAnything/images/check-22.png);
		  display: block;
		  position: absolute;
		  z-index: 99;
		  background-size: 14px 14px;
		  width: 14px;
		  height: 14px;
		  top: 1px;
		  left: 1px;
		  color: #000;
		}

        /* NEW Event Styles */
        .new-event-dropdown .slds-dropdown {
            position: relative;
        }

        .new-event-dropdown .ma-list li.table-view-cell {
            padding: 0.5rem 0.75rem;
            border-botom: 0;
        }

        #newevent-details-wrapper .ma-form-control-wrap input.ma-input-row {
            width: 100%;
        }

        /* Data Layer Buttons */

        #styleSelectWrap .MAbutton:focus,
        #legendImagePlaceholder .MAbutton:focus {
            outline: none;
        }

        /* Live Device Tracking history */

        input[type="time"]::-webkit-inner-spin-button {
            margin-top: auto;
            margin-bottom: auto;
        }
        </style>

    <c:MA />
    
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/googleExtensions/ShapeManager.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/googleExtensions/ruler.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/utils.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/ArcGIS.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/ArcGIS.tokenHelpers.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/ArcGIS.plotHelpers.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/ArcGIS.featureLayerHelpers.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/ArcGIS.projectionHelpers.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/ArcGIS.styleHelpers.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/ArcGIS.layerLegendHelpers.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/ArcGIS.click2CreateHelpers.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/ArcGIS.Arcade.js"></script>

    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MADemographicsJS.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MATerritoryLayer.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MARecordProcessJS.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MapAnythingPlottingJS.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/JSHelperFunctions.js"></script>

    <div id="ma-vue-root"></div>
    <script src="{!resourcePaths['MapAnythingJS']}/dist/core/bundle.js"></script>

	<!--<script src="{!resourceLocator}/MACheckIn.js"></script>-->
	<script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MALayers.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MAKMLExportJS.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MAContextMenu.js"></script>
	<script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MATerritoryBuilder.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MAFavoriteLocation.js"></script> 

    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/mapanythingSearch.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MADemographicLayer.js"></script>

    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MAShapeProcess.js')}"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MAMarkerBuilder.js"></script>

    <!-- <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'JSActionFramework.js')}"></script> -->
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/JSActionFramework.js"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MAListView.js"></script>

    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MACheckIn.js')}"></script>
    <script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/JSMapAnything.js"></script>
    
  	<script type='text/javascript' src="{!resourcePaths['MapAnythingJS']}/MARoutes.js"></script>
      

    <c:JSMapAnythingPlotting />
    <c:MADemographics />


    <apex:outputPanel layout="none" rendered="{!AllCheckin == 'true'}">
        <script>
            $(function () {
                //update our action framework to show buttons on tooltips
                var frameworkInt = setInterval(function () {
                    if(typeof(MAActionFramework) == 'object') {
                        clearInterval(frameworkInt);

                        try{
                            var actions = MAActionFramework.standardActions;
                            var checkInAction = actions['Check In'];
                            var checkOutAction = actions['Check Out'];

                            //update modes
                            var checkInActionModes = checkInAction.Modes || [];
                            checkInActionModes.push('Desktop');
                            var checkOutActionModes = checkOutAction.Modes || [];
                            checkOutActionModes.push('Desktop');
                        }
                        catch(e) {
                            MA.log('Unable to update check in/out settings',e);
                        }
                    }
                },500);
            });
        </script>

    </apex:outputPanel>

    <apex:outputPanel layout="none" rendered="{! $User.UIThemeDisplayed == 'Theme3' }">
        <style type="text/css">
            #contentWrapper {
                display: flex;
                flex-direction: column;
                height: 100%;
            }

            .bPageFooter.noTableFooter {
                padding-top: 6px;
                margin-bottom: 1px;
            }
        </style> 
    </apex:outputPanel>

    <apex:outputPanel layout="none" rendered="{! $User.UIThemeDisplayed == 'Theme4d' || $User.UIThemeDisplayed == 'Theme4u' }">

    	<style type="text/css">
		    html body.sfdcBody {
		        width: 100%;
		    }
    	</style>

        <script type='text/javascript'>
            $.ajaxSetup({
                dataFilter: function (rawData,type)
                {
                    try
                    {

                        if (rawData != undefined  && rawData != '')
                        {
                            if (type === 'JSON' || type == 'JSONP' || type=='json' || type =='jsonp')
                            {
                                return rawData.replace(/<script.*?>.*?<\/script>/igm, '');
                            }
                        }
                    }
                    catch (ex)
                    {

                    }
                }
            });

            jQuery.ajaxSetup({
                dataFilter: function (rawData,type)
                {
                    try
                    {

                        if (rawData != undefined  && rawData != '')
                        {
                            if (type === 'JSON' || type == 'JSONP' || type=='json' || type =='jsonp')
                            {
                                return rawData.replace(/<script.*?>.*?<\/script>/igm, '');
                            }
                        }
                    }
                    catch (ex)
                    {

                    }
                }
            });

        </script>
    </apex:outputPanel>


    <script type='text/javascript'>


        var AJAXRequestDataType = '{!AJAXRequestDataType}';

        var pageSuffix = '{!pageSuffix}';
        var sitePrefix = '{!$Site.CurrentSiteUrl}'.substring(0, '{!$Site.CurrentSiteUrl}'.length - 1);
        var namespace = '{!namespace}';
        var LicenseType = '{!LicenseType}';
        var versionNumber = '{!versionNumber}';
        var currentState = '';
        var $currentStateGrowl;

        //grab salesforce user locale object
        var SFLocale = UserContext;
        var userLocale = SFLocale.locale;
        var dateFormat = SFLocale.dateFormat;
        var timeFormat = SFLocale.timeFormat;
        var dateTimeFormat = SFLocale.dateTimeFormat;

        //LinkedIn Vars
        var linkedInClusterer;
        var linkedInPeopleClusterer;
        var linkedInCompanyClusterer;
        //POI vars
        var poiMarkersArray = [];
        var isDesktopPage = true;

        //save variable
        var saveId = '';

        //display/delete variable
        var dontDisplay = false;


        // polyfill remove function for IE
        (function() {
            function remove() { this.parentNode && this.parentNode.removeChild(this); }
            if (!Element.prototype.remove) Element.prototype.remove = remove;
            if (Text && !Text.prototype.remove) Text.prototype.remove = remove;
        })();


        $(function () {
            /******************************************
             *
             * SF is attempting to overwrite it's own
             * global var if user url hacks to a page
             *
             * resetting the var to undefined fixes this
             *
            *******************************************/
            // try{
            //     Map = undefined;
            // }
            // catch(e){}

            $.support.cors = true;

            //prototype a 'isInCircle' method
            try{
                google.maps.Circle.prototype.contains = function(latLng) {
                  return this.getBounds().contains(latLng) && google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(), latLng) <= this.getRadius();
                }
            }
            catch(e) {
                MA.log('could not create google circle prototype');
            }


            //beta testing for checking touch device google maps fix
            if(MASystem.User.isTouchDevice) {
                window.navigator.__defineGetter__('userAgent', function () {
                    return 'Mozilla/5.0 (iPad; CPU OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1';
                });
            }

            //set interval for loading screen to check if everything has loaded
            var loadingInterval = setInterval(function () {
                //check spans for success class
                var spans = $('.MALoading span');
                for(var s = 0; s < spans.length; s++) {
                    var $span = $(spans[s]);
                    if(!$span.hasClass('success')) {
                        break;
                    }

                    clearInterval(loadingInterval);
                    $('.MALoading').fadeOut(1000);
                }
            }, 3000);

            // set height of folder contents for overflow on window resize
            var resizeTimer;
            $(window).on('resize', function(e) {
                clearTimeout(resizeTimer);
                //debounce the resize to wait until finished
                resizeTimer = setTimeout(function() {
                    var basemapHeight = $('#mapdiv').height();
                    var breadcrumbHeight = $('#folder-breadcrumb').height();
                }, 250);
            });

            // arcgis derek
            // close currently open slds modal
            $(document).on('click', '.js-close-this-slds-modal', function() {
                //$('#sldsModalBackDrop').removeClass('slds-backdrop--open');
                //$(this).closest('.slds-modal').removeClass('slds-fade-in-open');
                closeThisSLDSModal(this);
            });



            // close currently open slds toast
            $(document).on('click', '.js-close-this-slds-toast', function() {
                closeThisSLDSToast(this);
            });



            $(document).on('focus', '#arcGISWebMapPopupURLField', function() {
                $(this).closest('.slds-form-element--has-hover-tooltip').addClass('hover');
            });

            $(document).on('blur', '#arcGISWebMapPopupURLField', function() {
                $(this).closest('.slds-form-element--has-hover-tooltip').removeClass('hover');
            });

            //send a request to run quick queries on each base object in order to cache the tables
            var processData = {
                ajaxResource : 'MASavedQueryAJAXResources',
                action: 'runCacheQueries',
            };

            Visualforce.remoting.Manager.invokeAction(MARemoting.processAJAXRequest,
                processData,
                function(response, event){
                    //Debug('Cache queries completed');

                    //check on loading screen
                    $('.MALoading .saved-queries-loading').addClass('success');

                },{buffer:false,escape:false}
            );
            
            /************************************
            *   Plotted Query Handlers
            ************************************/

            //handle clearing bubbles when clicking anywhere (this should probably go somewhere else)
            $('body').on('click', function () {
                $('.bubble').remove();
                $('#filterItemValueDropdown').hide();
            });

            //handle clicking to show/hide the legend or empty legend rows
            $('#PlottedQueriesContainer').on('click', '.legend-showhide', function () {
                var $button = $(this);
                var $plottedQuery = $button.closest('.PlottedRowUnit');
                if ($button.find('.options-text').text() == "{!$Label.MA_Hide_Legend}") {
                    $button.find('.options-text').text("{!$Label.MA_Show_Legend}");
                    $button.find('.glyphicon').removeClass('glyphicon-triangle-top').addClass('glyphicon-triangle-bottom');
                    $plottedQuery.find('.legend, .legend-moreless').hide();
                }
                else {
                    $button.find('.options-text').text("{!$Label.MA_Hide_Legend}");
                    $button.find('.glyphicon').removeClass('glyphicon-triangle-bottom').addClass('glyphicon-triangle-top');
                    $plottedQuery.find('.legend').show();
                    if ($plottedQuery.find('.legend-row.empty').length > 0) {
                        $plottedQuery.find('.legend-moreless').show();
                    }
                }
            });
            $('#PlottedQueriesContainer').on('click', '.legend-moreless-text', function () {
                var $button = $(this);
                var $plottedQuery = $button.closest('.PlottedRowUnit');
                var queryData = $plottedQuery.data() || {};
                if(queryData.markerAssignmentType === 'Dynamic-multiField') {
                    handleDynamicMultifieldClick($plottedQuery,$button);
                    return;
                }
                if ($button.find('.moreless-text').text() == "{!$Label.MA_Show_All}") {
                    $button.find('.moreless-text').text("{!$Label.MA_Show_Less}");
                    $button.find('.MAIcon').removeClass('glyphicon-collapse-down').addClass('glyphicon-collapse-up');
                    $plottedQuery.find('.legend-row').show();
                    $plottedQuery.find('.legend-row-header').show();
                    $plottedQuery.find('.legend-row-header').addClass('sectionOpen').removeClass('sectionClosed');
                    $plottedQuery.find('.legend-row-header .rowDropIcon').addClass('ion-android-arrow-dropdown').removeClass('ion-android-arrow-dropup');
                }
                else {
                    $button.find('.moreless-text').text("{!$Label.MA_Show_All}");
                    $button.find('.MAIcon').removeClass('glyphicon-collapse-up').addClass('glyphicon-collapse-down');
                    $plottedQuery.find('.legend-row.empty').hide();
                    $plottedQuery.find('.legend-row-header.empty').hide();
                    $plottedQuery.find('.legend-row-header.empty').removeClass('sectionOpen').addClass('sectionClosed');
                    $plottedQuery.find('.legend-row-header.empty .rowDropIcon').removeClass('ion-android-arrow-dropdown').addClass('ion-android-arrow-dropup');
                }
            });

            $('#PlottedQueriesContainer').on('click', '.legend-moreless-checkbox', function () {
                var $button = $(this);
                var $plottedQuery = $button.closest('.PlottedRowUnit');
                var uncheckAll = $button.find('.iconWrapper').hasClass('checked');

                if($plottedQuery.hasClass('loading')) {
                    return;
                }
                //loop over rows to get all legendids
                var isChecked = !uncheckAll;
                var legendRows = $plottedQuery.find('.legend-row').not('.empty');
                $button.find('.iconWrapper').removeClass('checked').addClass(' intermediate');
                var qid = $plottedQuery.attr('qid');
                //keep track of the rows being toggled
                MAPlotting.legendRowSelections[qid] = MAPlotting.legendRowSelections[qid] || {};

                for(var l = 0, len = legendRows.length; l < len; l++) {
                    var legendId = legendRows[l].getAttribute('data-id');
                    MAPlotting.legendRowSelections[qid][legendId] = isChecked

                }
                if(uncheckAll) {
                    //remove checkbox
                    $plottedQuery.find('.legend-row .legend-checkbox').prop('checked',false);
                    $plottedQuery.find('.legend-header-checkbox').removeClass('ion-minus-round ion-checkmark-round');
                }
                else {
                    //add checkbox
                    $plottedQuery.find('.legend-row .legend-checkbox').prop('checked',true);
                    $plottedQuery.find('.legend-header-checkbox').removeClass('ion-minus-round').addClass('ion-checkmark-round');
                }
                MAPlotting.toggleLegendRow({plottedQuery:$plottedQuery,rows: MAPlotting.legendRowSelections[qid]}, function () {
                    MAPlotting.updateQueryInfo($plottedQuery,function() {
                        //remove loading
                        $plottedQuery.removeClass('loading');
                        $plottedQuery.find('.queryIcon').show();
                        $plottedQuery.find('.queryLoader').hide();
                        delete MAPlotting.legendRowSelections[qid];
                        if(uncheckAll) {
                            $button.find('.iconWrapper').removeClass('checked intermediate');
                        }
                        else {
                            $button.find('.iconWrapper').removeClass('intermediate').addClass('checked');
                        }
                    });

                    MAListView.DrawTab({ layerId: $plottedQuery.attr('qid'), isSelectedTab: false, isExport: false });
                });
            });

            $('#PlottedQueriesContainer').on('click', '.legend-row', function () {
                var $row = $(this);
                var $checkbox = $row.find('.legend-checkbox');
                $checkbox.prop('checked',!$checkbox.prop('checked'));
                $checkbox.change();
            });

            //handle clicking on plotted query legend items
            $('#PlottedQueriesContainer').on('change', '.legend-checkbox', function () {
                var $legendCheckbox = $(this);
                var $legendRow = $legendCheckbox.closest('.legend-row');
                var $plottedQuery = $(this).closest('.PlottedRowUnit');

                //grab some basic info about this legend item
                var markerMetadata = $plottedQuery.data('markerMetadata');
                var invertProximity = userSettings.InvertProximity || false;
                var queryProximityEnabled = ($plottedQuery.data('proximityOptions') && $plottedQuery.data('proximityOptions').enabled);
                var queryProximityHideMarkers = queryProximityEnabled && $plottedQuery.data('proximityOptions').hideMarkers;

                //update the global check box
                var legendRows = $plottedQuery.find('.legend-row');
                var activeRows = $plottedQuery.find('.legend-row .legend-checkbox:checked');
                var isChecked = $legendCheckbox.prop('checked');
                if($plottedQuery.hasClass('loading')) {
                    $legendRow.find('.legend-checkbox').prop('checked',!isChecked);
                    return;
                }
                if(activeRows.length == legendRows.length) {
                    $plottedQuery.find('.iconWrapper').removeClass('intermediate').addClass('checked');
                }
                else if(activeRows.length == 0) {
                    $plottedQuery.find('.iconWrapper').removeClass('intermediate checked');
                }
                else {
                    $plottedQuery.find('.iconWrapper').removeClass('checked').addClass('intermediate');
                }

                //check for a section and update that checkbox
                var sectionId = $legendRow.attr('data-sectionid') || '';
                var $sectionHeaderRow = $plottedQuery.find('.legend-row-header[data-sectionid="'+sectionId+'"]');
                var sectionRows = $plottedQuery.find('.legend-row[data-sectionid="'+sectionId+'"]');
                var activeSectionRows = $plottedQuery.find('.legend-row[data-sectionid="'+sectionId+'"] .legend-checkbox:checked');
                if(activeSectionRows.length === sectionRows.length) {
                    //checked
                    $sectionHeaderRow.find('.legend-header-checkbox').removeClass('ion-minus-round').addClass('ion-checkmark-round');
                }
                else if (activeSectionRows.length === 0) {
                    //unchecked
                    $sectionHeaderRow.find('.legend-header-checkbox').removeClass('ion-minus-round ion-checkmark-round');
                }
                else {
                    //intermediate
                    $sectionHeaderRow.find('.legend-header-checkbox').addClass('ion-minus-round').removeClass('ion-checkmark-round');
                }

                var legendId = $legendRow.attr('data-id');
                var qid = $plottedQuery.attr('qid');
                //keep track of the rows being toggled
                MAPlotting.legendRowSelections[qid] = MAPlotting.legendRowSelections[qid] || {}
                MAPlotting.legendRowSelections[qid][legendId] = isChecked

                //check if we are waiting for a timeout
                clearTimeout(MAPlotting.legendRowTimeout);
                MAPlotting.legendRowTimeout = setTimeout(function() {
                    var options = {
                        plottedQuery : $plottedQuery,
                        rows : MAPlotting.legendRowSelections[qid]
                    }
                    MAPlotting.legendRowTimeout = null;
                    MAPlotting.toggleLegendRow(options, function () {
                        MAPlotting.updateQueryInfo($plottedQuery, function() {
                            //remove loading
                            $plottedQuery.removeClass('loading');
                            $plottedQuery.find('.queryIcon').show();
                            $plottedQuery.find('.queryLoader').hide();
                            delete MAPlotting.legendRowSelections[qid];
                        });

                        MAListView.DrawTab({ layerId: $plottedQuery.attr('qid'), isSelectedTab: false, isExport: false });
                    });
                },500);
            });

            /*****************
             *  Prox Layer Handlers
             ******************/
            //handle saving a prox layer
            $('#PlottedQueriesTable').on('click', '.proximity.layer .js-saveKML', function () {
                //grab the id
                var $proxLayer = $(this).closest('.proximity.layer');
                var kmlId = $proxLayer.find('.options-kml-document').val();
                var $selectedOption = $proxLayer.find('.options-kml-document').find(':selected');
                var resourceType = $selectedOption.data('resource_type');

                if(kmlId == undefined || kmlId == '') {
                    MAToastMessages.showWarning({message:'Save Error',subMessage:'Please select a kml before saving.',timeOut:5000});
                    return;
                }
                //show save shape popup
                MACustomShapes.openPopupSidebar({isKML:true,id:kmlId, kmlResourceType: resourceType});
            });


            //handle toggling prox layer options
            $('#PlottedQueriesTable').on('click', '.proximity.layer .link.showoptions', function () {
                var $button = $(this);
                var $proxLayer = $button.closest('.proximity.layer');
                var proxType = $proxLayer.find('.proximitytype').val();
                if ($button.find('.options-text').text() == "{!$Label.MA_Show_Options}") {
                    $proxLayer.find('.js-hideOptions').removeClass('hidden');
                    $button.addClass('hideStyle').removeClass('showStyle');
                    //$button.find('.glyphicon').removeClass('glyphicon-triangle-bottom').addClass('glyphicon-triangle-top');
                    $button.find('.options-text').text("{!$Label.MA_Hide_Options}");
                }
                else {
                    $proxLayer.find('.js-hideOptions').addClass('hidden');
                    $button.addClass('showStyle').removeClass('hideStyle');
                    //$button.find('.glyphicon').removeClass('glyphicon-triangle-top').addClass('glyphicon-triangle-bottom');*/
                    $button.find('.options-text').text("{!$Label.MA_Show_Options}");
                }

                if(proxType != 'travelTime') {
                    $proxLayer.find('.plotted-boundary-traffic-table').addClass('hidden');
                }
            });

            $('#PlottedQueriesTable').on('change', '.js-address-input', function() {
                $(this).data('lat', null);
                $(this).data('lng', null);
                $(this).data('address', null);
            });

            // handle clicking/selecting of proximity mode - bike/walk/car
            $('#PlottedQueriesTable').on('click', '.proximity-mode > div', function() {
                $(this).siblings().removeClass('selected');
                $(this).addClass('selected');
            });

            //handle selecting a different isoline unit type
            $('#PlottedQueriesTable').on('change', '.proximity.layer .options-isoline-unit-type', function () {
                if ($(this).val() == 'Distance') {
                    $(this).closest('.proximity.layer').find('.options-isoline-unit').html('').append("<option value='MILES'>Miles</option><option value='KM'>Km</option><option value='METERS'>Meters</option><option value='YARDS'>Yards</option><option value='FEET'>Feet</option>");
                }
                else {
                    $(this).closest('.proximity.layer').find('.options-isoline-unit').html('').append("<option value='MINUTES'>Minutes</option><option value='HOURS'>Hours</option>");
                }
            });

            //handle updating the prox options
            $('#PlottedQueriesTable').on('click', '.proximity.layer .js-updateShape', function () {
            	var $thisProxLayer = $(this).closest('.proximity.layer');
            	if(validateRadius($thisProxLayer.find('.js-radiusDistance').val()))
            	{
                	renderProximityLayer($thisProxLayer);
            	}
            });

            /********************************
             *  LinkedIn Event Handlers
             ***********************************/

            //if ('{!socialIntegrationEnabled}' == 'true')
            if (false) //removing linkedin integration due to api restrictions.
            {
                $('#LinkedInButton').show();
                if (MA.SitePrefix != '') {
                    $('.bottomworkspace-pane[data-pane="LinkedIn"]').html("<div>LinkedIn integration is not currently supported in custom domains (includes communities)</div>");
                }
                else {
                    $('.menubutton.social').on('change', '.linkedin-myconnections', function () {
                        if ($(this).is(':checked')) {
                            $('.linkedin-myconnections').hide();
                            $('.linkedin-myconnections-loader').show();
                            LinkedIn_ShowMyConnections();
                        }
                        else {
                            try { linkedInClusterer.clearMarkers(); linkedInClusterer.setMap(null); } catch (err) { }
                        }
                    });

                    $('.menubutton.social').on('change', '.linkedin-search', function () {
                        if ($(this).is(':checked')) {
                            $('.linkedin-filters-wrapper').show();
                        }
                        else {
                            $('.linkedin-filters-wrapper').hide();
                            try { linkedInPeopleClusterer.clearMarkers(); linkedInPeopleClusterer.setMap(null); } catch (err) { }
                        }
                    });

                    $('.menubutton.social').on('change', '.linkedin-companysearch', function () {
                        if ($(this).is(':checked')) {
                            $('.linkedin-companyfilters-wrapper').show();
                        }
                        else {
                            $('.linkedin-companyfilters-wrapper').hide();
                            try { linkedInCompanyClusterer.clearMarkers(); linkedInCompanyClusterer.setMap(null); } catch (err) { }
                        }
                    });

                    $('.menubutton.social').on('click', '.linkedin-filters-wrapper .addfilter', function () {
                        $('#templates .linkedin-filter').clone().appendTo($('.linkedin-filters'));
                    });
                }
            }



	        /*************************
	        * Side Bar Functionality
	        *************************/

	        //Show-Hide tabs on click
	        $('#tabs-nav > ul > li').on('click', 'a', function()
			{
				var tabClass = $(this).attr('tab-toggle').toString();
				if($(this).hasClass('tab-open'))
				{//derek
					$('#tabs-nav').find('div[tab-toggle]').slideUp(200);
					$(this).removeClass('tab-open');
					$('#sidebar').css('padding', 0);
				}
				else
				{
					$('#tabs-nav').find('div[tab-toggle="'+tabClass+'"]').slideDown(200);
					$('#tabs-nav > ul > li a').not($(this)).removeClass('tab-open');
					$(this).addClass('tab-open');
					$('#sidebar').css('padding', '0 0 15px 0');

					if(tabClass === 'plotted-tab') {
						var activeTab = $('#layer-tab-nav li.ui-state-active').attr('aria-controls');
						$('#'+activeTab+'').show();
					}
				}
			});

	        //POI tab results click
	        $('#searchPlacesQueryOutputBody').on('click', '.poi-row', function() {
	        	MA.map.panTo($(this).data('marker').getPosition());
	        	google.maps.event.trigger($(this).data('marker'), 'click');
	        });

	        //handle mousing over MapView overlay images
			$('td[data-label]').mouseover(function() {
				$(this).find('div').addClass('Hover');
			});
			$('td[data-label]').mouseout(function() {
				$(this).find('div').removeClass('Hover');
			});

			//handle mousing over Default View
			$('.DefaultViewOverlayTable .mapview-row').mouseover(function() {
				$(this).find('div').addClass('Hover');
			});
			$('.DefaultViewOverlayTable .mapview-row').mouseout(function() {
				$(this).find('div').removeClass('Hover');
			});

	        //IE9 fix for jscolor
	        jscolor.init();

			MALayers.init();
			//handle favorites icon selection
			$('#FavoriteCreateLocation').on('click', '.location-markertype-selector img', function ()
			{
				var $icon = $(this);
				if ($icon.hasClass('location-markertype-selector-color'))
				{
					$('#FavoriteCreateLocation .location-markertype-color').show();
					$('#FavoriteCreateLocation .location-markertype-image').hide();
				}
				else
				{
					$('#FavoriteCreateLocation .location-markertype-color').hide();
					$('#FavoriteCreateLocation .location-markertype-image').show();
				}
			});

			$(document).on('click', '#baseObjectSelection tr', function ()
			{
				$(this).find('input[name="baseObject"]').prop('checked', true);
			});

			$('#PlottedQueriesTable').on('mouseenter', '.PlottedRowUnit.savedQuery', function (e)
			{
				MALayers.calcPlottedLayerInfo(this);
			});

			$('#PlottedQueriesTable').on('mouseenter', '.PlottedRowUnit.DataLayer', function (e)
			{
				MALayers.calcPlottedLayerInfo(this);
			});

			// $('#PlottedQueriesTable').on('mouseenter', '.FavoriteRowUnit', function (e)
			// {
			// 	MALayers.calcPlottedLayerInfo(this);
			// });

			$('#PlottedQueriesTable').on('mouseenter', '.PlottedShapeLayer', function (e)
			{
				MALayers.calcPlottedLayerInfo(this);
			});

			// Set folder item tooltip hover position
			/*$('#sidebar-content').on('mouseenter', '.ftu-unit-left', function (e)
			{
				//handle tooltip
                var $layer = $(this);
				var folderitemTooltip = $layer.children('.ftu-tooltip');
				var folderitemTooltipOffsetTop = $layer.offset().top;
				var folderitemTooltipOffsetLeft = $layer.offset().left;
				var folderitemTooltipHeight = folderitemTooltip.height();
				var mapHeight = $('#mapdiv').height();
				var mapOffset = $('#mapdiv').offset().top;
				// sum dropdown height and offset
				var ftuTotal = folderitemTooltipOffsetTop + folderitemTooltipHeight - mapOffset;
				// get difference between dropdown/offset sum and mapheight
				var ftuDifference = ftuTotal - mapHeight;

                var layerWrapTop = $('#mapdiv').offset().top

				//if is offscreen
				if (ftuDifference > 0)
				{
					folderitemTooltip.css(
					{
						'top': folderitemTooltipOffsetTop - ftuDifference - 12 + 'px',
						'left': folderitemTooltipOffsetLeft + 365 + 'px'
					});
				}
				// if doesn't go offscreen
				else
				{
					folderitemTooltip.css(
					{
						'top': folderitemTooltipOffsetTop - 55 + 'px',
						'left': folderitemTooltipOffsetLeft + 365 + 'px'
					});
				}

				//handle arrow
				var folderitemTooltipArrowOffset = $(this).offset();

				$(this).children('.ftu-tooltip-arrow').css(
				{
					'top': folderitemTooltipArrowOffset.top + 6 + 'px',
					'left': folderitemTooltipArrowOffset.left + 355 + 'px'
				});
			});*/

            $('#sidebar-content').on('mouseenter', '.ftu-unit-left', function (e){
                //get the scroll position
                var scrollPos = $(window).scrollTop();
                var $button = $(this);
                var $Layer = $button.closest('div.folderItem');
                var layerWidth = $Layer.width();
                var layerOff = $Layer.offset();
                //this is the row position from top of page in pixels
                var layerTop = layerOff.top;

                //layersPanel
                var buttonPosition = $button.offset();
                var layersPanelPosition = $('.layersPanel').offset();
                var computedPositionLeft =  buttonPosition.left - layersPanelPosition.left;
                var computedPositionTop =  buttonPosition.top - layersPanelPosition.top;

                //get some menu info
                var $menu = $button.find('.ftu-tooltip');
                var menuHeight = $menu.height();

                //determine if menu is to large and add scroll before calc
                if (menuHeight >= 400) {
                    $menu.css({
                        'max-height': '400px',
                        'overflow-y': 'auto'
                    });
                    menuHeight = 400;
                }

                //check the menu height and offset
                var totalMenu = computedPositionTop + menuHeight;

                //get the map dimensions
                var containerHeight = $('#horizontalViewsWrap').height();

                //appears offscreen 140
                var folderitemTooltipArrowOffset = $(this).offset();
                var $arrow = $button.find('.ftu-tooltip-arrow');
                if (totalMenu >= containerHeight) {
                    //update the position of the dropdown to stay within the bounds of the app
                    positionDifference = totalMenu - containerHeight;
                    dropdownVerticalPadding = 2;
                    newPosition = computedPositionTop - positionDifference - dropdownVerticalPadding;
                    $menu.css({
                        top: newPosition + "px",
                        left: computedPositionLeft + 436 + "px"
                    });

                } else {
                    $menu.css({
                        top: computedPositionTop - 20 + "px",
                        left: computedPositionLeft + 436 + "px"
                    });
                }

                //handle arrow


				$arrow.css(
				{
					'top': computedPositionTop + 3 + 'px',
					'left': computedPositionLeft + 426 + 'px'
				});
            });

			//can the user export things? if not, get rid of the KML export button
			$('#layer-tab-nav-plotted').on('click', function ()
			{
				//requires page refresh anyway, so no issue here
				if (userSettings.maxExportSize <= 0)
				{
					//$('#kml-export-action').remove();
				}
			});

        }); //end onready

        function RemovePlotFavLocation()
        {
            $('#PlottedQueriesTable .FavoriteRowUnit').each(function (i,row){
                $(row).find('.btn-remove').click();
            });
        }

        //handle clicking a favorite location marker
        function favLocation_Click()
        {
            var marker = this;
            //build the tooltip content for this location
            var $tooltipContent = $(
                '<div class="favlocation-tooltip-content" style="overflow: hidden;">' +
                    '<table>' +
                        '<tr>' +
                            // '<td>Name:</td>' +
                            '<td class="name info">' + htmlEncode(marker.title) + '</td>' +
                        '</tr>' +
                        '<tr>' +
                            // '<td>Address:</td>' +
                            '<td class="address info">' +
                                '<span class="ma-icon ma-icon-checkin slds-icon slds-icon--x-small"></span>' +
                                htmlEncode(marker.location.address) + 
                            '</td>' +
                        '</tr>' +
                        '<tr>' +
                            // '<td>Description:</td>' +
                            '<td class="description info">'+ htmlEncode(marker.record.description) +'</td>' +
                        '</tr>' +
                    '</table>' +
                    '<div class="layout-tooltip">' +
                        '<div class="buttonset-section-columns">' +
                            '<div class="buttoncolumn">' +
                                '<div class="actionbutton" data-action="Add to Trip">'+MASystem.Labels.MAActionFramework_Add_to_Trip+'</div>' +
                                '<div class="actionbutton" data-action="Set Proximity Center">'+MASystem.Labels.MAActionFramework_Set_Proximity_Center+'</div>' +
                            '</div>' +
                            '<div class="buttoncolumn">' +
                                '<div class="actionbutton" data-action="Remove Marker">'+MASystem.Labels.MAContext_Remove_Marker+'</div>' +
                                '<div class="actionbutton" data-action="Set Verified Location">'+MASystem.Labels.MAActionFramework_Set_Verified_Location+'</div>' +
                            '</div>' +
                            '<div class="buttoncolumn">' +
                                '<div class="actionbutton" data-type="Standard Action" data-action="Set Reference Point">Set Reference Point</div>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                '</div>'
            );
            $tooltipContent.find('.description').text(marker.description);

            //create popup
            MA.Map.InfoBubble.show({
                position: marker.getPosition(),
                anchor: marker,
                minWidth: 260,
                content: $tooltipContent.get(0)
            });

            //handle clicking action buttons
            $tooltipContent.find('.actionbutton').click(function (event) {
                try {
                    event.stopPropagation();
                } catch (e) {}
                var data_action = $(this).attr('data-action');
                switch (data_action)
                {
                    case 'Add to Trip':
                        if(!MA.isMobile) {
                            var options = {
                                "favorites": [marker]
                            };
                            var items = MAActionFramework.getNormalizedRoutingData(options);
                            VueEventBus.$emit('add-to-route', items);
                        } else {
                            AddMarkerToTrip(marker);
                            ShowDirectionsTab();
                        }
                        MA.Map.InfoBubble.hide();
                        break;
                    case 'Set Proximity Center':
                        var proximityType = getProperty(userSettings || {}, 'defaultProximitySettings.DefaultProximityType', false) || 'Circle';
                        addProximityLayer({ proximityType: proximityType, latitude: marker.getPosition().lat(), longitude: marker.getPosition().lng() });
                        break;
                    case 'Set Verified Location':
                        var newOptions = {
                            favorites: [marker]
                        };
                        MAActionFramework.standardActions['Set Verified Location'].ActionValue(newOptions);
                        break;
                    case 'Remove Marker':
                        marker.setMap(null);
                        var markerQID = marker.qid;
                        $('#PlottedQueriesTable .FavoriteRowUnit').each(function (i,row) {
                            if($(row).attr('data-qid') == markerQID) {
                                $(row).find('.btn-remove').click();
                            }
                        });
                        break;
                    case 'Set Reference Point':
                        var newOptions = {
                            records: [],
                            favorites: [],
                            customMarkers: []
                        };

                        newOptions.records.push({ formattedMarkerAddress: marker.location.address, latLng: marker.position });

                        MAActionFramework.standardActions['Set Reference Point'].ActionValue(newOptions);
                        break;
                }
                MA.Map.InfoBubble.hide();

                //stop the click from getting to the map
                //e.stopPropagation();
            });
        }

        /********************************
        *   Workspaces
        ********************************/

        function BottomWorkspace_Show(options)
        {
            //default options
            options = $.extend({
                title: '',
                pane: ''
            }, options);

            //set the width to the width of the map div minus some padding on the sides
            $('#bottomworkspace').width($('#mapdiv').outerWidth() - 16);

            //show the workspace
            if(options.title == 'Exports')
            {
                 $('#bottomworkspace .header').text('{!$Label.MA_EXPORTS}');
            }
            else
            {
                $('#bottomworkspace .header').text(options.title);
            }

            $('#bottomworkspace').addClass('loading').animate({bottom: '0px'}, 350, function () {
                try { options.success(); } catch (err) { }
            });

            //load the workspace content
            $('#bottomworkspace .bottomworkspace-pane').hide().filter('[data-pane="'+options.pane+'"]').show();
        }
        function BottomWorkspace_Hide(options)
        {
            $('#bottomworkspace').animate({bottom: '-'+($('#bottomworkspace').outerHeight() + 5)+'px'}, 350, function () {
                try { options.success(); } catch (err) { }
            });
        }

        /***********************************
        *   Search Box Functions
        **********************************/

        /***************
        * POI Search
        ***************/
        //store variable for paging purposes if map is moved
        var searchText;
        var distance;
        var lat;
        var lng;

        function removePOI()
        {
            // remove previous markers and table info
            MASearch.unrenderPointsOfInterest();
        }

        function poi_CreateRow(options)
        {
            options = $.extend({
                place: {}
            }, options);

            var $row = $('#templates .poi-row').removeClass('template').clone();
            $row.find('.poi-name').text(htmlDecode(options.place.name));
            $row.find('.poi-address').text(options.place.formatted_address || '');
            $row.find('.poi-phone').text(options.place.formatted_phone_number || '');
            $row.find('.poi-image').attr('src', options.place.icon);
            $row.data('marker', options.marker);
            return $row;
        }

        /*********************************
        * Legacy (for custom components)
        *********************************/
        function HideBubbles() { MA.Map.InfoBubble.hide(); }

    </script>
    <!--<c:MAListView />-->

    <!--<c:JSMapAnythingPlotting />-->

    <!-- MA Plugins -->
    <!-- c:MATraffic -->
    <!-- JS -->

    <!-- Controller Communication -->
    <apex:form >
        <apex:inputHidden id="serializedDefaultQueries" value="{!serializedDefaultQueries}" />
        <apex:inputHidden id="serializedOptions" value="{!serializedOptions}" />
        <apex:inputHidden id="userName" value="{!userName}" />

        <apex:actionFunction name="PopulateMAExportsAF" reRender="MAExportsRepeat,ExportPageMessages" action="{!PopulateMAExports}"/>
        <apex:actionFunction name="DeleteExportsAF" reRender="MAExportsRepeat,ExportPageMessages" action="{!DeleteExports}"/>
    </apex:form>

    <!-- Notifications - Top Banner -->
    <div id='notifications-topbanner'>
        <div id='notifications-topbanner-description'></div>
        <a id='notifications-topbanner-blogurl' href='#' target='_blank'>Learn More</a>
        <div id='notifications-topbanner-close' onclick="$('#notifications-topbanner').slideUp();">x</div>
    </div>


    <!-- Range Colors -->
    <div id="RangeColorsDiv" style="text-align:center;"></div>

    <!-- Notification Templates -->
    <div id="container" style='display: none;'>
        <div id="basic-template">
            <a class="ui-notify-cross ui-notify-close" href="#">x</a>
            <h1 style="color:red;">#{title}</h1>
            <p>#{text}</p>
        </div>
        <div id="Warning-Template">
            <a class="ui-notify-cross ui-notify-close" href="#">x</a>
            <h1 style="color:yellow;">#{title}</h1>
            <p>#{text}</p>
        </div>
        <div id="Success-Template">
            <a class="ui-notify-cross ui-notify-close" href="#">x</a>
            <h1 style="color:#00FF00;">#{title}</h1>
            <p>#{text}</p>
        </div>
    </div>

    <!-- bootstrap alert templates -->
    <div class="alert-container" style='display: none;'>
        <div class="alert alert-info fade in" id="alert-info">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Note!</strong>
        </div>
        <div class="alert alert-success fade in" id="alert-success">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Success!</strong>
        </div>
        <div class="alert alert-warning fade in" id="alert-warning">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Warning!</strong>
        </div>
        <div class="alert alert-danger fade in" id="alert-danger">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Error!</strong>
        </div>
    </div>

    <!-- Hidden Export Template -->
    <div id="HiddenExport" style="display:none;height:0px;overflow:scroll;">
        <table id="HiddenExportTable" style="display:none;height:0px;overflow:scroll;"></table>
    </div>

    <!-- Hidden Selected Data -->
    <div id="HiddenSelection" qid="selected" style="display:none">
    </div>

    <!-- Create Custom Shape Popup -->
    <div id="CustomShapePopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal slds-modal_large" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div id='customDis-loadmask'></div>
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">Create/Edit Custom Shape Layer</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <!-- Tabs -->
                        <div id='tabs' style='padding: 0; border: none; background: none;'>

                            <!-- Tabs -->
                            <ul class='tabs' style='background: none;'>
                                <li class='info-tab'><a href="#tab-info">Shape Info</a></li>
                                <li class='folders-tab'><a href="#tab-folders">Folder</a></li>
                                <li class='color-tab'><a href="#tab-color-geometry">{!$Label.MATerritoryBuilder_Tab_Options}</a></li>

                            </ul>

                            <!-- Info Pane -->
                            <div class='tab-info' id='tab-info' style='padding: 10px 0 0 0; height: 400px;'>
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="input-unique-id">{!$Label.MA_Name}</label>
                                        <div class="slds-form-element__control">
                                        <input type="text" class="slds-input shape-name" />
                                    </div>
                                </div>
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="input-unique-id">Description</label>
                                        <div class="slds-form-element__control">
                                        <textarea type="text" class="slds-input shape-description"></textarea>
                                    </div>
                                </div>
                            </div>
                            <!-- End Info Pane -->

                            <!-- Geometry Pane -->
                            <div class='tab-folders' id='tab-folders' style='padding: 10px 0 0 0; height: 400px;'>
                                <div class="foldersDisabled"></div>
                                <div id="SaveShapeTree" class="demo" style="padding-top:3px;"></div>
                            </div>
                            <!-- End Geometry Pane -->

                            <!-- Color Pane -->
                            <div class='tab-color-geometry' id='tab-color-geometry' style='padding: 10px 0 0 0; height: 400px;'>
                                <div class='tab-color-geometry-content'>


                                    <table style="width: 100%;">
                                        <tr>
                                            <td style="vertical-align:top;">
                                                <!-- Geometry Header -->
                                                <table class='boundary-color-header'>
                                                    <tr>
                                                        <th colspan="2" style="padding-top:10px;">{!$Label.MATerritoryBuilder_Color_Selection}</th>
                                                    </tr>
                                                    <tr>
                                                        <td>{!$Label.MATerritoryBuilder_Fill_Color}:</td>
                                                        <td>
                                                            <input id="custom-shapelayer-shape-fill-color-input" class="color fillcolor boundary-style" style="background-color: rgb(22, 50, 92); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#16325c" onchange="CustomShapeLayerUpdatePreview();"
                                                            />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>{!$Label.MATerritoryBuilder_Border_Color}:</td>
                                                        <td>
                                                            <input id="custom-shapelayer-border-fill-color-input" class="color bordercolor boundary-style" style="background-color: rgb(48, 131, 211); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#3083d3" onchange="CustomShapeLayerUpdatePreview();"
                                                            />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>{!$Label.MATerritoryBuilder_Opacity}:</td>
                                                        <td>
                                                            <select id="custom-shapelayer-shape-fill-opacity-input" class="fillopacity" onchange="CustomShapeLayerUpdatePreview();">
                                                                <option value="0.1">10%</option>
                                                                <option value="0.2">20%</option>
                                                                <option value="0.3">30%</option>
                                                                <option value="0.4">40%</option>
                                                                <option value="0.5">50%</option>
                                                                <option value="0.6">60%</option>
                                                                <option value="0.7">70%</option>
                                                                <option value="0.8">80%</option>
                                                                <option value="0.9">90%</option>
                                                                <option value="1.0">100%</option>
                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <tr class="labelOptions">
                                                        <th colspan="2">{!$Label.MATerritoryBuilder_Label_Options}:</th>
                                                    </tr>
                                                    <tr class="labelOptions">
                                                        <td>{!$Label.MATerritoryBuilder_Label_Enable}:</td>
                                                        <td>
                                                            <input type='checkbox' id="custom-shapelayer-label-enabled" onchange="CustomShapeLayerUpdatePreview();" />
                                                        </td>
                                                    </tr>
                                                    <tr class="labelOptions">
                                                        <td>{!$Label.MATerritoryBuilder_Label_TextOverride}:</td>
                                                        <td>
                                                            <input class="label-text-override-input" type="text" value="" id="custom-shapelayer-label-override" />
                                                        </td>
                                                    </tr>
                                                    <tr class="labelOptions">
                                                        <td>{!$Label.MATerritoryBuilder_Label_Justification}:</td>
                                                        <td>
                                                            <select id="custom-shapelayer-label-justification" onchange="CustomShapeLayerUpdatePreview();">
                                                                    <option value="left">Left</option>
                                                                    <option value="center" selected="selected">Center</option>
                                                                    <option value="right">Right</option>
                                                                </select>
                                                        </td>
                                                    </tr>
                                                    <tr class="labelOptions">
                                                        <td>{!$Label.MATerritoryBuilder_Label_FontSize}:</td>
                                                        <td>
                                                            <select id="custom-shapelayer-label-font-size" onchange="CustomShapeLayerUpdatePreview();">
                                                                <option>8px</option>
                                                                <option>9px</option>
                                                                <option selected="selected">10px</option>
                                                                <option>11px</option>
                                                                <option>12px</option>
                                                                <option>13px</option>
                                                                <option>14px</option>
                                                                <option>15px</option>
                                                                <option>16px</option>
                                                                <option>17px</option>
                                                                <option>18px</option>
                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <tr class="labelOptions">
                                                        <td>{!$Label.MATerritoryBuilder_Label_FontColor}:</td>
                                                        <td>
                                                            <input id="custom-shapelayer-label-font-color" class="color boundary-style" style="background-color: rgb(255, 255, 255); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#FFFFFF" onchange="CustomShapeLayerUpdatePreview();" />
                                                        </td>
                                                    </tr>
                                                    <tr class="labelOptions">
                                                        <td>{!$Label.MATerritoryBuilder_Label_BGColor}:</td>
                                                        <td>
                                                            <input id="custom-shapelayer-label-bg-color" class="color boundary-style" style="background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#000000" onchange="CustomShapeLayerUpdatePreview();" />
                                                        </td>
                                                    </tr>
                                                    <tr class="labelOptions">
                                                        <td>{!$Label.MATerritoryBuilder_Label_BGOpacity}:</td>
                                                        <td>
                                                            <select id="custom-shapelayer-label-bg-opacity" onchange="CustomShapeLayerUpdatePreview();">
                                                                <option value="0.1">10%</option>
                                                                <option value="0.2">20%</option>
                                                                <option value="0.3" selected="selected">30%</option>
                                                                <option value="0.4">40%</option>
                                                                <option value="0.5">50%</option>
                                                                <option value="0.6">60%</option>
                                                                <option value="0.7">70%</option>
                                                                <option value="0.8">80%</option>
                                                                <option value="0.9">90%</option>
                                                                <option value="1.0">100%</option>
                                                            </select>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td>
                                                <div id="customShape_preview_map" style="width: 470px;height: 390px;float:right;"></div>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <!-- End Options Pane -->
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-right footer-buttons">
                            <button class="slds-button slds-button_brand" onclick="MACustomShapes.saveV2(false);">{!$Label.MA_Save}</button>
                            <button class="slds-button slds-button_brand" onclick="MACustomShapes.saveV2(true);">{!$Label.MA_Save_Plot}</button>
                            <button class="slds-button slds-button_neutral" onclick="MALayers.hideModal();clearCustomShapeInfo();">{!$Label.MA_Close}</button>
                        </div>
                    </footer>
                </div>
            </section>
        </div>
   </div>

    <!--Shape Layer Builder v2 Derek -->
	<div id="shapeBuilderModalPositioner" class="slds-scope">
		<div id="CreateTerritoryPopup" class="slds-modal slds-modal--xxl">
			<!-- slds-fade-in-open -->
			<!-- Start error toast -->
			<div class="slds-notify_container" style="display:none;">
				<div class="slds-notify slds-notify_toast slds-theme_error" role="alert">
					<span class="slds-assistive-text">error</span>
					<span class="slds-icon_container slds-icon-utility-error slds-m-right_small slds-no-flex slds-align-top" title="Description of icon when needed">
	                <span class="slds-icon slds-icon_small ma-icon ma-icon-error" aria-hidden="true"></span>
					</span>
					<div class="slds-notify__content">
						<h2 class="slds-text-heading_small ">Bryan, put your error message here.</h2>
						<p>If needed, add additional details here, being very descriptive and transparent.</p>
					</div>
					<button class="slds-button slds-button_icon slds-notify__close slds-button_icon-inverse js-close-this-slds-toast" title="Close">
	                <span class="slds-button__icon slds-button__icon_large ma-icon ma-icon-close" aria-hidden="true"></span>
	                <span class="slds-assistive-text">Close</span>
	              </button>
				</div>
			</div>
			<!-- End error toast -->
			<div class="slds-modal__container">
				<div class="slds-modal__header">
					<button class="slds-button slds-modal__close slds-button--icon-inverse modal-close-tight-top" title="Close" onclick="cancelTerritoryCreation();">
						<span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
						<span class="slds-assistive-text">Close</span>
					</button>
					<h2 class="slds-text-heading--medium">Shape Layer Builder</h2>
					<!--hook up-->
				</div>
				<!-- Modal Content -->
				<div class="slds-modal__content flex-column full-height slds-modal__content-has-navigation height-100percent overflow-hidden">
					<div class="flex-grow-1 flex-row height-100percent">
						<div style="width:200px;background-color:#FAFAFB;border-right:1px solid #d8dde6;">
							<nav class="slds-nav-vertical slds-nav-vertical_shade" aria-label="Sub page">
								<div class="slds-nav-vertical__section">
									<ul id="ShapeBuilderMenu">
										<li class="slds-nav-vertical__item slds-is-active">
											<a id="shapeBuilderNavDetails" href="javascript:void(0);" class="slds-nav-vertical__action" aria-describedby="entity-header" target-content="shapeLayerBuilderTabDetails">
												<span class="slds-badge navigation-badge">1</span>Details
											</a>
										</li>
										<li class="slds-nav-vertical__item disabled" disabled="true">
											<a id="shapeBuilderNavShapeSelection" href="javascript:void(0);" class="slds-nav-vertical__action" aria-describedby="entity-header" target-content="shapeLayerBuilderTabShapeSelection">
												<span class="slds-badge navigation-badge">2</span>Shape Selection
											</a>
										</li>
										<li class="slds-nav-vertical__item disabled" disabled="true">
											<a id="shapeBuilderNavDisplay" href="javascript:void(0);" class="slds-nav-vertical__action" aria-describedby="entity-header" target-content="shapeLayerBuilderTabDisplay">
												<span class="slds-badge navigation-badge">3</span>Display
											</a>
										</li>
									</ul>
								</div>
							</nav>
						</div>
						<div class="flex-grow-1 slds-is-relative">
							<div id="shapeLayerBuilderTabDetails" class="slds-navigation-content-area slds-show">
								<div class="slds-p-around--large">
									<div class="slds-form slds-form--stacked max-width--320 slds-p-bottom--small">
										<div class="slds-form-element">
											<label class="slds-form-element__label" for="shapeBuilderDetailsName"> <abbr class="slds-required" title="required">*</abbr>Name</label>
											<div class="slds-form-element__control">
												<input type="text" id="shapeBuilderDetailsName" class="slds-input territory-name" placeholder="ex. Southeast Territory" />
											</div>
										</div>
										<div class="slds-form-element">
											<label class="slds-form-element__label" for="input-id-02">Description</label>
											<div class="slds-form-element__control">
												<textarea id="input-id-02" class="slds-textarea territory-description" placeholder="ex. Enterprise Sales Territory"></textarea>
											</div>
										</div>
									</div>
									<div>
										<button id="shapeLayerBuilderTabDetailsNextButton" class="slds-button slds-button--success" disabled="true">Next</button>
									</div>
								</div>
							</div>
							<div id="shapeLayerBuilderTabShapeSelection" class="slds-navigation-content-area slds-hide">
								<div class="flex-column full-height">
									<div class="flex-shrink-0" style="border-bottom: 1px solid #d8dde6;">
										<div class="slds-p-vertical--small slds-p-horizontal_large">
											<div class="flex-row align-items-center">
												<div>
													<h3 class="slds-text-heading_small">Shape Selection</h3>
												</div>
												<div class="flex-grow-1"></div>
												<div style="display:none;" class="slds-p-right--x-small js-lasso-wrapper">
													<button class="slds-button slds-button_neutral js-show-shape-builder-drawing-mode">
														<div class="slds-button__icon slds-button__icon_left ma-icon ma-icon-lasso"></div>
														Draw on Map
													</button>
												</div>
												<div class="slds-is-relative">
													<button class="slds-button slds-button_neutral js-show-shape-builder-paste-clipboard">
														<div class="slds-button__icon slds-button__icon_left ma-icon ma-icon-paste"></div>
														Paste ZIP Codes
														</button>
													<section id="shapeBuilderPasteClipboardPopover" aria-labelledby="panel-heading-id" class="slds-popover slds-popover_panel slds-popover_medium" role="dialog" style="display:none;">
														<button id="shapeBuilderPasteClipboardCloseX" class="slds-button slds-button_icon slds-button_icon slds-button_icon-small slds-float_right slds-popover__close js-hide-shape-builder-paste-clipboard" title="Close dialog">
															<div class="slds-button__icon ma-icon ma-icon-close" aria-hidden="true"></div>
														</button>
														<div id="shapeBuilderPasteClipboardStart" class="slds-popover__body">
															<div class="slds-p-top--large slds-p-horizontal--large">
                                                                <div class="slds-p-bottom_small">
																    <h3 class="slds-text-heading_small">Paste ZIP Codes</h3>
                                                                </div>
																<p class="slds-text-body_small slds-text-color_weak slds-p-bottom_x-small">Paste copied ZIP Codes into the text area below and click the "Process ZIP Codes" button. Be sure to review our <a href="javascript:void(0);" class="js-show-shape-builder-paste-clipboard-guidelines">formatting guidelines</a>.</p>
															</div>
															<div id="shapeBuilderPasteClipboardBase">
																<div class="slds-p-top--medium slds-p-horizontal--large slds-p-bottom_x-small">
																	<div id="shapeBuilderPasteClipboardTextAreaWrap" class="slds-form-element">
																		<div class="slds-form-element__control">
																			<textarea id="shapeBuilderPasteClipboardTextArea" class="slds-textarea" placeholder="Paste import data here..."></textarea>
																		</div>
																	</div>
																	<div id="shapeBuilderPasteClipboardProcessingWrap" style="display:none;">
																		<div role="status" class="slds-spinner slds-spinner_brand slds-spinner_large">
																			<span class="slds-assistive-text">Loading</span>
																			<div class="slds-spinner__dot-a"></div>
																			<div class="slds-spinner__dot-b"></div>
																		</div>
																		<p id="shapeBuilderPasteClipboardProcessingLabel" class="slds-text-align_center">Processing...</p>
																	</div>
																</div>
																<div class="slds-p-horizontal--large slds-p-bottom--large">
																	<div class="flex-row">
																		<div class="flex-grow-1"></div>
																		<div>
																			<button id="shapeBuilderPasteClipboardCancelButton" class="slds-button slds-button_neutral js-hide-shape-builder-paste-clipboard">Cancel</button>
																			<button id="shapeBuilderPasteClipboardProcessingButton" class="slds-button slds-button_brand js-show-shape-builder-paste-clipboard-processing">Process ZIP Codes</button>
																		</div>
																	</div>
																</div>
															</div>
															<div id="shapeBuilderPasteClipboardErrorWrap" class="slds-p-top--medium slds-p-horizontal--large" style="display:none;">
																<div class="slds-box slds-box_x-small slds-theme_shade slds-m-bottom--small">
																	<div class="slds-p-bottom--small slds-text-color_weak">
																		<span class="slds-text-color_default success-count"></span> ZIP Codes successfully added.
																	</div>
																	<div class="slds-p-bottom--xx-small slds-text-color_error">
																		<span class="error-count"></span> errors:
																	</div>
																	<div class="slds-box slds-box_x-small slds-theme_default slds-scrollable_y invalid-zips" style="max-height:100px;">

																	</div>
																</div>
																<div class="slds-text-align_right slds-p-bottom--small">
																	<button class="slds-button slds-button_neutral js-hide-shape-builder-paste-error-wrap">Dismiss</button>
																</div>
															</div>
														</div>
														<div id="shapeBuilderPasteClipboardGuidelines" class="slds-popover__body" style="display:none;">
															<div class="slds-p-around--large">
                                                                <div class="slds-p-bottom_x-small">
																    <h3 class="slds-text-heading_small">Formatting Guidelines</h3>
                                                                </div>
																<p class="slds-text-body_small slds-text-color_weak slds-m-bottom--medium">Set up your boundaries by separating them with a comma or a line break. Examples below.</p>
																<div class="flex-row slds-p-bottom--medium">
																	<div class="width-50percent slds-p-right--xx-small">
																		<div>Comma</div>
																		<div class="slds-box slds-theme_shade">
																			<p class="slds-text-body_small slds-text-color_weak">28205, 28206, 28207<br/><br/></p>
																		</div>
																	</div>
																	<div class="width-50percent slds-p-left--xx-small">
																		<div>Line Break</div>
																		<div class="slds-box slds-theme_shade">
																			<p class="slds-text-body_small slds-text-color_weak">28205<br/> 28206<br/> 28207</p>
																		</div>
																	</div>
																</div>
																<div>
																	<button class="slds-button slds-button_neutral js-show-shape-builder-paste-clipboard-guidelines js-hide-shape-builder-paste-clipboard-guidelines">
																		<div class="slds-button__icon slds-button__icon_left ma-icon ma-icon-check "></div>
																		Got It
																		</button>
																</div>
															</div>
														</div>
													</section>
												</div>
											</div>
										</div>
									</div>
									<div class="flex-grow-1 flex-column flex-grow-1 min-height-0">
										<div class="flex-row flex-grow-1 min-height-0">
											<div class="width-33percent flex-column flex-grow-1 min-height-0">
												<div class="flex-shrink-0 flex-grow-1 slds-p-vertical--medium slds-p-right--small slds-p-left--large min-height-0">
													<div class="slds-form slds-form--stacked slds-m-bottom--x-small">
														<div class="slds-form-element">
															<label class="slds-form-element__label" for="shapeLayerBuilderInputCountry">Country</label>
															<div class="slds-form-element__control select2-fluid">
																<div class="slds-select_container">
																	<select class="slds-select select2-input territory-country" id="shapeLayerBuilderInputCountry">

																		</select>
																</div>
															</div>
														</div>
														<div class="slds-form-element">
															<label class="slds-form-element__label" for="shapeLayerBuilderInputIWantToSee">I Want To See...</label>
															<div class="slds-form-element__control select2-fluid slds-is-relative">
																<div class="slds-select_container">
																	<select id="shapeLayerBuilderInputIWantToSee" class="slds-select select2-input">


																		</select>
																</div>
																<div id="shapeBuilderIWantToSeeTooltip" class="slds-popover slds-popover_tooltip slds-nubbin_left-top" role="tooltip">
																	<div class="slds-popover__body">
																		Select what shape type you want to see on the map.
																		<br/><br/> e.g. I want to see <strong>ZIP Codes</strong>.
																	</div>
																</div>
															</div>
														</div>
													</div>
													<div id="shapeBuilderFiltersDrawOnMapWrap" class="slds-p-bottom--medium" style="display:none;">
														<button class="slds-button slds-button--neutral js-show-shape-builder-drawing-mode">
															<div class="slds-button__icon slds-button__icon--left ma-icon ma-icon-lasso"></div>
															Draw on Map
															</button>
													</div>
													<div id="shapeBuilderFiltersWrap" style="display:none;">
														<div class="slds-filters">
															<h3 class="slds-text-body_small slds-m-vertical_x-small slds-form-element__label">Matching all these filters</h3>
															<ol id="filterItemList" class="slds-list_vertical slds-list_vertical-space">
																<li id="filterItemExample1" class="slds-item slds-hint-parent" style="display:none;">
																	<div id="filterExample1Item" class="slds-filters__item slds-grid slds-grid_vertical-align-center slds-is-relative slds-is-new">
																		<button href="javascript:void(0);" class="slds-button_reset slds-grow slds-has-blur-focus">
    																		<div class="filter-example-content-complete" style="display:none;">
    																			<span class="slds-assistive-text">Edit filter:</span>
    																			<p class="slds-text-body_small">County</p>
    																			<p>equals "Mecklenburg, NC"</p>
    																		</div>
    																		<div class="filter-example-content-new">
    																			New Filter
    																		</div>
																		</button>
																		<button class="slds-button slds-button_icon slds-button_icon slds-button_icon-small">
																		    <div class="slds-button__icon ma-icon ma-icon-remove slds-filters__item-remove-button"></div>
																		</button>
																	</div>
																</li>
															</ol>
														</div>
														<div class="slds-filters__footer slds-p-around--none slds-p-vertical--medium flex-row">
															<div class="slds-is-relative">
																<button id="shapeBuilderFiltersFooterAddFilterButton" class="slds-button_reset slds-text-link" href="javascript:void(0);">Add Filter</button>
																<div id="shapeBuilderAddFilterButtonTooltip" class="slds-popover slds-popover_tooltip slds-nubbin_left-top in" role="tooltip">
																	<div class="slds-popover__body" style="hyphens: none;">
																		Lets filter down what ZIP Codes you want to see.
																		<br/><br/> e.g. I want to see ZIP Codes filtered by <strong>County equals "Mecklenburg, NC"</strong>.
																	</div>
																</div>
															</div>
															<div class="flex-grow-1"></div>
															<div id="shapeBuilderFiltersFooterRemoveButton" style="display:none;">
																<button class="slds-button_reset slds-text-link slds-col_bump-left remove-all-shape-filters" href="javascript:void(0);">Remove All</button>
															</div>
														</div>
													</div>
												</div>
											</div>
											<!--moving the filter outside of the scrollable area fix-->
											<div id="filterExample1" class="slds-filters__item-popover slds-filters__item-popover-positioner-left-bottom slds-is-fixed" style="display:none;">
												<section class="slds-popover slds-popover_panel slds-nubbin_left-bottom slds-popover_large">
													<div class="slds-p-around--large filter-form-container">
														<div class="slds-p-top--medium">
															<div class="flex-row">
																<div class="flex-grow-1"></div>
																<div>
																	<button class="slds-button slds-button_neutral js-slds-filters__item-popover-done-button">Done</button>
																</div>
															</div>
														</div>
													</div>
												</section>
											</div>
											<div id="shapeBuilderAvailableShapesColumn" class="width-33percent flex-column min-height-0">
												<div class="flex-column flex-grow-1 slds-p-vertical--medium slds-p-left--small slds-p-right--large min-height-0">
													<div class="flex-column flex-grow-1 min-height-0">
														<div class="flex-shrink-0">
															<label class="slds-form-element__label" for="shapeLayerBuilderInputCountry">Available Shapes</label>
														</div>
														<div class="flex-grow-1 flex-column min-height-0">
															<div class="slds-dueling-list__header">
																<div class="slds-p-horizontal--small slds-p-vertical--x-small">
																	<div class="flex-row">
																		<div>
																			Select <a href="javascript:void(0);" onclick="selectAllOptions('#shapeBuilderAvailableShapesColumn')">All</a> / <a href="javascript:void(0);" onclick="deselectAllOptions('#shapeBuilderAvailableShapesColumn')">None</a>
																		</div>
																	</div>
																</div>
															</div>
															<div class="slds-dueling-list has-dueling-list-header slds-is-relative flex-column flex-grow-1 min-height-0">
																<div id="shapeSelectionDuelingPicklistButtonPositioner">
																	<div class="flex-column">
																		<div class="slds-p-bottom--medium">
																			<button class="slds-button slds-button_icon slds-button_icon-border slds-button_icon-border-filled" onclick="addSelectedShapes()">
																					<div class="slds-button__icon ma-icon ma-icon-right"></div>
																				</button>
																		</div>
																		<div>
																			<button class="slds-button slds-button_icon slds-button_icon-border slds-button_icon-border-filled" onclick="clearSelectedShapes()">
																					<div class="slds-button__icon ma-icon ma-icon-left"></div>
																				</button>
																		</div>
																	</div>
																</div>
																<div class="flex-column flex-grow-1 slds-form-element multiselect-has-header min-height-0" style="width:100%;">
																	<div class="flex-column flex-grow-1 slds-form-element__control slds-is-relative min-height-0">
																		<select class="slds-select" size="50" multiple="multiple" style="overflow-y:auto;">

	    																	</select>
																		<div id="shapeBuilderAvailableShapesSpinner" class="slds-spinner_container" style="display:none;left: 1px;top: 1px;height: calc(100% - 2px);width: calc(100% - 2px);border-radius: 0 0 4px 4px;z-index: 99;">
																			<div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
																				<span class="slds-assistive-text">Loading</span>
																				<div class="slds-spinner__dot-a"></div>
																				<div class="slds-spinner__dot-b"></div>
																			</div>
																		</div>
																		<div id="shapeBuilderAvailableFilterCue">
																			<div class="slds-text-align_center">
																				<div class="slds-p-bottom_medium">
																					<span class="slds-icon_container ma-icon ma-icon-info"></span>
																				</div>
																				<div class="slds-text-color_weak">
																					The shape type you want to see returns a large number of results. Please add a filter to narrow down the available shapes.
																				</div>
																			</div>
																		</div>
																	</div>
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
											<div id="shapeBuilderSelectedShapesColumn" class="width-33percent flex-column min-height-0">
												<div class="flex-column slds-p-vertical--medium slds-p-horizontal--large min-height-0">
													<div class="flex-column min-height-0">
														<div class="flex-shrink-0">
															<label class="slds-form-element__label" for="shapeLayerBuilderInputCountry">Selected Shapes</label>
														</div>
														<div class="flex-grow-1 flex-column slds-is-relative min-height-0">
															<div class="slds-dueling-list__header">
																<div class="slds-p-horizontal--small slds-p-vertical--x-small">
																	<div class="slds-grid slds-grid_align-spread">
																		<div>
																			Select <a href="javascript:void(0);" onclick="selectAllOptions('#shapeBuilderSelectedShapesColumn')">All</a> / <a href="javascript:void(0);" onclick="deselectAllOptions('#shapeBuilderSelectedShapesColumn')">None</a>
                                                                        </div>
                                                                        <div>
                                                                            <a href="javascript:void(0);" onclick="selectAllOptions('#shapeBuilderSelectedShapesColumn');clearSelectedShapes();">Clear</a>
                                                                        </div>
                                                                    </div>
																</div>
															</div>
															<div class="flex-column slds-form-element multiselect-has-header min-height-0">
																<div class="flex-column slds-form-element__control min-height-0">
																	<select class="slds-select" size="50" multiple="multiple" style="overflow-y:auto;">

																	</select>
																</div>
															</div>
															<div id="shapeBuilderPasteClipboardProcessingSuccessTooltip" class="slds-popover slds-popover_tooltip slds-nubbin_right-top" role="tooltip">
																<button class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse">
																<div class="slds-button__icon ma-icon ma-icon-close"></div>
																</button>
																<div class="slds-popover__body" style="padding-right: 32px;">
																	<div class="flex-row align-items-center">
																		<div class="slds-p-right--small slds-p-left--xxx-small">
																			<span class="slds-icon_container" >
																				<div class="slds-icon slds-icon-text-default slds-icon_small ma-icon ma-icon-check" style="color:#4bca81;font-size:20px;"></div>
																			</span>
																		</div>
																		<div class="flex-grow-1" style="hyphens:none;">
																			<!--<div>Your pasted shapes were successfully processed and added to your selection.</div>-->
																			<div>Correctly formatted ZIP codes have been successfully processed and added to your selection.</div>
																		    <br></br>
																			<div class="js-import-results">

																			</div>

																		</div>
																	</div>
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div id="shapeLayerBuilderTabDisplay" class="slds-navigation-content-area slds-hide">
								<!--Color Pane -->
								<div class='tab-color-geometry' id='tab-color-geometry'>
									<div class='tab-color-geometry-content slds-p-around_large'>
										<table style="width: 100%;">
											<tr>
												<td>
													<table class='boundary-color-header'>
														<tr>
															<th colspan="2" style="padding-top:0;">
																<h3 class="slds-text-heading_small" style="font-weight: normal;padding-top:0;margin-top:0;">
	                                                    {!$Label.MATerritoryBuilder_Color_Selection}
	                                                </h3>
															</th>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Fill_Color}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input id="shapelayer-shape-fill-color-input" class="color fillcolor boundary-style slds-input" style="background-color: rgb(22, 50, 92); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#16325C" onchange="ShapeLayerUpdatePreview();"
																/>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Border_Color}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input id="shapelayer-border-fill-color-input" class="color bordercolor boundary-style slds-input" style="background-color: rgb(48, 131, 211); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#3083d3" onchange="ShapeLayerUpdatePreview();"
																/>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Opacity}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<select id="shapelayer-shape-fill-opacity-input" class="fillopacity slds-select" onchange="ShapeLayerUpdatePreview();">
				                                                    <option value="0.1">10%</option>
				                                                    <option value="0.2">20%</option>
				                                                    <option value="0.3">30%</option>
				                                                    <option value="0.4">40%</option>
				                                                    <option value="0.5">50%</option>
				                                                    <option value="0.6">60%</option>
				                                                    <option value="0.7">70%</option>
				                                                    <option value="0.8">80%</option>
				                                                    <option value="0.9">90%</option>
				                                                    <option value="1.0">100%</option>
				                                                </select>
																<!--<input class="fillopacity boundary-style" type="text" value=""/>-->
															</td>
														</tr>
														<tr>
															<th colspan="2" style="padding: 16px 0 12px;">
																<h3 class="slds-text-heading_small" style="font-weight: normal;">
	                                                    {!$Label.MATerritoryBuilder_Label_Options}
	                                                </h3>
															</th>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_Enable}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<!--<input type='checkbox' id="shapelayer-label-enabled" onchange="ShapeLayerUpdatePreview();" />-->

																<span class="slds-checkbox">
	                                                  <input type="checkbox" id="shapelayer-label-enabled" onchange="ShapeLayerUpdatePreview();" />
	                                                  <label class="slds-checkbox__label" for="shapelayer-label-enabled">
	                                                    <span class="slds-checkbox_faux"></span>
																<span class="slds-form-element__label"> </span>
																</label>
																</span>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_TextOverride}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input class="label-text-override-input slds-input" type="text" value="" id="shapelayer-label-override" />
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_Justification}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<select id="shapelayer-label-justification" class="slds-select" onchange="ShapeLayerUpdatePreview();">
	                                                    <option value="left">Left</option>
	                                                    <option value="center" selected="selected">Center</option>
	                                                    <option value="right">Right</option>
	                                                </select>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_FontSize}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<select id="shapelayer-label-font-size" class="slds-select" onchange="ShapeLayerUpdatePreview();">
				                                                    <option>8px</option>
				                                                    <option>9px</option>
				                                                    <option selected="selected">10px</option>
				                                                    <option>11px</option>
				                                                    <option>12px</option>
				                                                    <option>13px</option>
				                                                    <option>14px</option>
				                                                    <option>15px</option>
				                                                    <option>16px</option>
				                                                    <option>17px</option>
				                                                    <option>18px</option>
				                                                </select>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_FontColor}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input id="shapelayer-label-font-color" class="color boundary-style slds-input" style="background-color: rgb(255, 255, 255); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#FFFFFF" onchange="ShapeLayerUpdatePreview();" />
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_BGColor}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input id="shapelayer-label-bg-color" class="color boundary-style slds-input" style="background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#000000" onchange="ShapeLayerUpdatePreview();" />
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_BGOpacity}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<select id="shapelayer-label-bg-opacity" class="slds-select" onchange="ShapeLayerUpdatePreview();">
				                                                    <option value="0.1">10%</option>
				                                                    <option value="0.2">20%</option>
				                                                    <option value="0.3" selected="selected">30%</option>
				                                                    <option value="0.4">40%</option>
				                                                    <option value="0.5">50%</option>
				                                                    <option value="0.6">60%</option>
				                                                    <option value="0.7">70%</option>
				                                                    <option value="0.8">80%</option>
				                                                    <option value="0.9">90%</option>
				                                                    <option value="1.0">100%</option>
				                                                </select>
															</td>
														</tr>
														<tr>
															<th colspan="2" style="padding: 16px 0 12px;">
																<h3 class="slds-text-heading_small" style="font-weight: normal;">
				                                                    {!$Label.MATerritoryBuilder_AdvancedOptions}
				                                                </h3>
															</th>
														</tr>
														<tr>
															<td colspan="2" class="slds-p-bottom_xx-small">
																<span class="slds-checkbox">
																	<input type="checkbox" id="shapelayer-advanced-dissolve-enabled" class='dissolve-geometry' onchange="ShapeLayerUpdatePreview();" />
																	<label class="slds-checkbox__label" for="shapelayer-advanced-dissolve-enabled">
																		<span class="slds-checkbox_faux"></span>
																		<span class="slds-form-element__label"> &nbsp;{!$Label.MA_Dissolve_Geometry}</span>
																	</label>
																</span>
															</td>
														</tr>
														<tr>
															<td colspan="2" class="slds-p-bottom_xx-small">
																<span class="slds-checkbox">
																	<input type="checkbox" id="shapelayer-advanced-affect-visibility" class='affect-visibility'/>
																	<label class="slds-checkbox__label" for="shapelayer-advanced-affect-visibility">
																		<span class="slds-checkbox_faux"></span>
																		<span class="slds-form-element__label"> &nbsp;{!$Label.LayersTab_Shape_Display_OnlyShowMarkersInside}</span>
																	</label>
																</span>
															</td>
														</tr>
													</table>
												</td>
												<td>
													<div id="shapelayer_preview_map" style="width: 470px;height: 390px;float:right;"></div>
												</td>
											</tr>
										</table>
									</div>
								</div>
								<!-- End Options Pane -->
							</div>
						</div>
					</div>
				</div>
				<div class="slds-modal__footer">
					<button class="slds-button slds-button--neutral" onclick="cancelTerritoryCreation();">Cancel</button>
					<button id="shape-save-close" class="slds-button slds-button_brand save-boundary" onclick="saveBoundary();">Save &amp; Close</button>
					<button id="shape-save-plot" class="slds-button slds-button_brand save-boundary" onclick="saveBoundary(true);">Save &amp; Plot</button>
				</div>
			</div>
		</div>
	</div>

	<div id="shapeBuilderBackdropPositioner" class="slds-scope">
	    <div id="CreateTerritoryPopupBackdrop" class="slds-modal-backdrop"></div><!-- slds-modal-backdrop--open-->
	</div>


    <!-- Templates -->
    <div id='TerritoryBuilder-Templates' style='display: none;'>

        <!-- Search Wrapper -->
        <div class='search-wrapper'>
            <input type='text' class='search-input' />
            <img class='search-loading' src="{!URLFOR($Resource.MapAnything, 'images/chatter-loader.gif')}" style='display:none' />
            <img class='search-button' src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/search-icon.png')}" />
            <div class='search-menu' style='display:none;'></div>
        </div>

        <!-- Results div when selecting area -->
        <div class='autocomplete-selection'>
            <span class='result-text'></span>
            <span class='result-remove'>x</span>
        </div>

        <!-- Return templates for each area -->
        <div class='boundary-cell' data-adminlevel=''>
            <div class='icon'><img class="territory-selector-img" /></div>
            <div class='info'><div class='title'></div><div class='subtitle'></div></div>
            <div class='checkbox'></div>
        </div>

        <!-- SVG Shape Icon -->
        <svg class='svg-shape-icon' width="20" height="20" preserveAspectRatio="xMidYMid meet">
            <g>
                <path id="svg_10" d="m2.75,17.25c0,0 10,0 10,0c0,0 4.75,-8 4.75,-8c0,0 -3.5,-5 -3.5,-5c0,0 -6.75,-2 -6.75,-2c0,0 -4.5,4.25 -4.5,4.25c0,0 0,10.75 0,10.75z" opacity="0.55" stroke-width="2" stroke="__BorderColor__" fill="__FillColor__"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="3" cy="17.25" id="svg_1" rx="2" ry="2"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="2.75" cy="6.75" rx="2" ry="2" id="svg_3"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="7.25" cy="2.25" rx="2" ry="2" id="svg_4"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="14" cy="4" rx="2" ry="2" id="svg_5"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="17.75" cy="9.5" rx="2" ry="2" id="svg_6"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="13" cy="17.25" rx="2" ry="2" id="svg_7"/>
            </g>
        </svg>


        <div id="shapeTooltipTemplates">
            <div id="shapeActionsWrappper">
                <div class="layout-tooltip">
                    <div class="button-sections">
                        <!-- button section 1 -->
                        <!-- button section 2 -->
                        <!-- ... -->
                    </div>
                </div>
            </div>

            <!-- button section template -->
            <div id="buttonSection">
                <div class="buttonset-section">
                    <div class="buttonset-section-header">::sectionLabel::</div>
                    <div class="buttonset-section-columns">

                        <!-- button section column 1 -->
                        <!-- button section column 2 -->
                        <!-- ... -->
                    </div>
                </div>
            </div>


            <div id="buttonSectionColumn">
                <div class="buttoncolumn">
                    <!-- action button 1 -->
                    <!-- action button 2 -->
                    <!-- ... -->
                </div>
            </div>


            <div id="actionButton">
                <div class="actionbutton" data-action-type="::action-type::" data-action="::action::" data-layerId="::layerId::">
                    ::buttonLabel::
                </div>
            </div>

        </div>

    </div>
    <div id="shapeLayerEditorTemplates" style="display:none;">

        <div class="shape-filter-template js-shape-filter-wrapper">
            <div class="slds-form slds-form_stacked">
    			<div class="slds-form-element">
    				<label class="slds-form-element__label">Field</label>
    				<div class="slds-form-element__control select2-fluid">
    					<div class="slds-select_container">
    						<select class="slds-select select2-input field-select">
    							<optgroup label="Political Boundaries">

    							</optgroup>
    							<optgroup label="Data Metrics">

    							</optgroup>
    						</select>
    					</div>
    				</div>
    			</div>
    			<div class="slds-form-element">
    				<label class="slds-form-element__label">Operator</label>
    				<div class="slds-form-element__control select2-fluid">
    					<div class="slds-select_container">
    						<select class="slds-select select2-input operator-select">
    							<option selected="selected">equals</option>
    							<option>less than</option>
    							<option>greater than</option>
    						</select>
    					</div>
    				</div>
    			</div>
    			<div class="slds-form-element">
    				<label class="slds-form-element__label string-label">Value</label>
    				<label class="slds-form-element__label range-label" style="display:none;">Min</label>
    				<input id="filterItemValueInput" class="slds-input min" type="text" />
    				<div id="filterItemValueDropdown" class="slds-dropdown slds-dropdown_left slds-is-absolute" style="display:none;min-height:100px;max-height:500px;overflow-y:scroll">
    					<ul class="slds-dropdown__list" role="menu">

    					</ul>
    					<div class="slds-spinner_container" id="shapeFilterSpinner" style="left: 1px; top: 1px; height: calc(100% - 2px); width: calc(100% - 2px); border-radius: 0px 0px 4px 4px; display: block;">
							<div class="slds-spinner slds-spinner_medium slds-spinner_brand" role="status">
								<span class="slds-assistive-text">Loading</span>
								<div class="slds-spinner__dot-a"></div>
								<div class="slds-spinner__dot-b"></div>
							</div>
						</div>
    				</div>
    				<label class="slds-form-element__label range-label" style="display:none;">Max</label>
    				<input id="MaxValueInput" class="slds-input max" type="text" style="display:none;"/>

    				<div class="slds-p-top--xx-small filter-item-pills" style="display:none;">
    					<!--<span class="slds-pill slds-pill_link">
    						<a href="javascript:void(0);" class="slds-pill__action" title="Full pill label verbiage mirrored here">
    							<span class="slds-pill__label">Mecklenburg, NC</span>
    						</a>
    						<button class="slds-button slds-button_icon slds-button_icon slds-pill__remove" title="Remove">
    						<div class="slds-button__icon ma-icon ma-icon-remove"></div>
    						</button>
    					</span>-->
    				</div>
    			</div>
    		</div>
            <div class="slds-p-top--medium">
    			<div class="flex-row">
    				<div class="flex-grow-1"></div>
    				<div>
    				    <button class="slds-button slds-button_neutral js-slds-filters__item-popover-cancel-button">Cancel</button>
    					<button class="slds-button slds-button_brand js-slds-filters__item-popover-done-button">Done</button>
    				</div>
    			</div>
    		</div>
        </div>

        <ul id="filter-items-list-template">
            <li class="slds-item slds-hint-parent filter-list-item" style="display:none;">
				<div class="slds-filters__item slds-grid slds-grid_vertical-align-center slds-is-relative slds-is-new filter-item">
					<button href="javascript:void(0);" class="slds-button_reset slds-grow slds-has-blur-focus">
						<div class="filter-content-complete" style="display:none;">
							<span class="slds-assistive-text">Edit filter:</span>
							<p class="slds-text-body_small field-label"></p>
							<p class='filters-from-pills'></p>
						</div>
						<div class="filter-content-new">
							New Filter
						</div>
					</button>
					<button class="slds-button slds-button_icon slds-button_icon slds-button_icon-small js-remove-filter-item">
					    <div class="slds-button__icon ma-icon ma-icon-remove slds-filters__item-remove-button remove-filter-item"></div>
					</button>
				</div>
			</li>

        </ul>

        <ul id="lasso-list-item-template">
            <li role="presentation" class="slds-listbox__item slds-is-selected lasso-list-item">
				<span class="slds-listbox__option slds-listbox__option_plain slds-media" aria-selected="false" draggable="true" role="option" tabindex="0">
					<span class="slds-truncate" title="Option 1">
						<span class="slds-icon slds-icon_selected slds-icon_x-small slds-icon-text-default slds-m-right_x-small ma-icon ma-icon-check"></span>
						<span class='list-item-label'></span>
					</span>
				</span>
			</li>

        </ul>

    </div>
    <!-- Tutorial Content -->


    <!-- Tutorial Content -->
    <div id='MATutorial-Content' class='popup_block' style='max-height: 550px !important;'>
        <div class='loadmask-wrapper'>

            <!-- Close Button -->
            <a class='closebtn' onclick="ClosePopupWindow();">X</a>

            <!-- Steps -->
            <div id='MATutorial-Steps'>

                <!-- Step: Base Object Selection -->
                <div id='MATutorial-Steps-BaseObjectSelection'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Welcome}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Popup_Instructions}</p>

                    <!-- Content -->
                    <table id='MATutorial-BaseObjects' class='grid-blue'>
                        <tr>
                            <th>{!$Label.MATutorial_Available_Base_Objects}</th>
                            <th style='text-align: center;'><span style='font-size: 10px; cursor: pointer;' onclick='$("#MATutorial-BaseObjects .data").removeClass("unchecked").addClass("checked");'>All</span> | <span style='font-size: 10px; cursor: pointer;' onclick='$("#MATutorial-BaseObjects .data").removeClass("checked").addClass("unchecked");'>None</span></th>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Account'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Account}</div>
                                <div class='fields'>{!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Contact'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Contact}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Lead'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Lead}</div>
                                <div class='fields'>Street, City, State, Postal Code, Country</div>
                                <div class='fields'>{!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Opportunity'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Opportunity}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Case'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Case}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Task'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Task}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                    </table>

                    <!-- Spacer -->
                    <div style="height: 15px;">&nbsp;</div>

                    <!-- Buttons -->
                    <div class='buttons'>
                        <div class="bigbutton orange" onclick="MATutorial_Steps_BaseObjectSelection_Next();">{!$Label.MATutorial_Next}</div>
                    </div>

                </div>

                <!-- Step: Custom Configuration - Basic Info -->
                <div id='MATutorial-Steps-Custom-BasicInfo' style='display: none;'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Custom_Configuration}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Custom_Popup_Instructions}</p>

                    <!-- Content -->
                    <table class='grid-blue'>
                        <tr><th colspan='2'>{!$Label.MATutorial_Basic_Info}</th></tr>
                        <tr><td>{!$Label.MA_Name}</td><td><input type='text' id='MATutorial-Steps-Custom-Name' /></td></tr>
                        <tr><td>{!$Label.MA_Base_Object}</td><td><select id='MATutorial-Steps-Custom-Object' class='combobox'></select></td></tr>
                    </table>

                    <!-- Character Limit Disclaimer -->
                    <div style='font-size: 10px;color: #757575;font-style: italic;float: right;'>{!$Label.MATutorial_Character_Limit}</div>

                    <!-- Spacer -->
                    <div style='height: 15px;'>&nbsp;</div>

                    <!-- Buttons -->
                    <div class='buttons'>
                        <div class="bigbutton gray" style='float: left;' onclick="MATutorial_Steps_Custom_BasicInfo_Back();">{!$Label.MATutorial_Start_Over}</div>
                        <div class="bigbutton orange" onclick="MATutorial_Steps_Custom_BasicInfo_Next();">{!$Label.MATutorial_Next}</div>
                    </div>

                </div>

                <!-- Step: Custom Configuration - Field Map -->
                <div id='MATutorial-Steps-Custom-FieldMap' style='display: none;'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Custom_Field_Map}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Custom_Field_Map_Instructions}</p>

                    <!-- Content -->
                    <table class='grid-blue'>
                        <tr>
                            <th>{!$Label.MA_Field}</th>
                            <th style='text-align: right;'><span style='font-size: 10px; cursor: pointer;' onclick='MATutorial_Steps_Custom_FieldMap_Suggest();'>Suggest</span></th>
                        </tr>
                        <tr><td>Address Location</td><td><select id='MATutorial-Steps-Custom-AddressLocation' class='combobox'></select></td></tr>
                        <tr><td>Street</td><td><select id='MATutorial-Steps-Custom-Street' class='combobox addressfield'></select></td></tr>
                        <tr><td>City</td><td><select id='MATutorial-Steps-Custom-City' class='combobox addressfield'></select></td></tr>
                        <tr><td>State</td><td><select id='MATutorial-Steps-Custom-State' class='combobox addressfield'></select></td></tr>
                        <tr><td>Postal Code</td><td><select id='MATutorial-Steps-Custom-PostalCode' class='combobox addressfield'></select></td></tr>
                        <tr><td>Country</td><td><select id='MATutorial-Steps-Custom-Country' class='combobox addressfield'></select></td></tr>
                        <tr><td>Latitude</td><td><select id='MATutorial-Steps-Custom-Latitude' class='combobox coordinatefield'></select></td></tr>
                        <tr><td>Longitude</td><td><select id='MATutorial-Steps-Custom-Longitude' class='combobox coordinatefield'></select></td></tr>
                    </table>

                    <!-- Spacer -->
                    <div style='height: 15px;'>&nbsp;</div>

                    <!-- Buttons -->
                    <div class='buttons'>
                        <div class="bigbutton gray" style='float: left;' onclick="MATutorial_Steps_Custom_FieldMap_Back();">{!$Label.MA_Back}</div>
                        <div class="bigbutton orange" onclick="MATutorial_Steps_Custom_FieldMap_Next();">{!$Label.MATutorial_Next}</div>
                    </div>

                </div>

                <!-- Step: Custom Configuration - Add Another -->
                <div id='MATutorial-Steps-Custom-AddAnother' style='display: none;'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Custom_Field_Instructions}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Custom_Configuration_Popup_Finish}</p>

                    <!-- Content -->
                    <div>
                        <div class='bigbutton blue' style='width: 49%;' onclick='MATutorial_Steps_Custom_AddAnother_Yes();'>
                            <div class='title'>{!$Label.MA_Yes}</div>
                            <div class='subtitle'>{!$Label.MATutorial_Add_Custom_Config}</div>
                        </div>
                        <div class='bigbutton orange' style='width: 49%;' onclick='MATutorial_Steps_Custom_AddAnother_No();'>
                            <div class='title'>{!$Label.MA_No}</div>
                            <div class='subtitle'>{!$Label.MATutorial_Review_Custom_Config}</div>
                        </div>
                    </div>

                </div>

                <!-- Step: Review -->
                <div id='MATutorial-Steps-Review' style='display: none;'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Review}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Add_Custom_Config_Install}</p>

                    <!-- Content -->
                    <div style='max-height: 400px; overflow-y: auto;'>

                        <!-- Selected Configurations -->
                        <table id='MATutorial-Steps-Review-SelectedConfigurations' class='grid-blue'>
                            <tr>
                                <th>{!$Label.MATutorial_Selected_Configurations}</th>
                            </tr>
                        </table>

                    </div>

                    <!-- Spacer -->
                    <div style='height: 15px;'>&nbsp;</div>

                    <!-- Buttons -->
                    <div class='buttons'>
                        <div class="bigbutton orange" onclick="MATutorial_Steps_Review_Finish();">{!$Label.MA_Finish}</div>
                    </div>

                </div>

            </div>

        </div>
    </div>
    <!-- Copy To Popup -->
    <div id="CopyToPopup" class="slds-scope popup_block">
        <section role="dialog" tabindex="-1" aria-labelledby="copyToPopupHeader" aria-modal="true" aria-describedby="copyToPopupContent" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <h2 id="copyToPopupHeader" class="slds-text-heading_medium slds-hyphenate"><span role="copyLabel">{!$Label.MA_Copy}</span> <span role="moveLabel" style="display:none;">{!$Label.MA_Move}</span> <span id="copynode" copyid="" copynodetype=""></span> {!$Label.MA_To}...
                    </h2>
                </header>
                <div class="slds-modal__content slds-p-around_medium" id="copyToPopupContent">
                    <div id="CopyToTree" style="padding-top:3px;">
                    <!-- tree gets injected here -->
                    </div>
                </div>
                <footer class="slds-modal__footer">
                    <button class="slds-button slds-button_neutral" onclick="ClosePopupWindow();$('#CopyToTree').html('');">{!$Label.MA_Close}</button>
                    <button class="slds-button slds-button_brand" role="saveButton" onclick="SubmitCopyTo();">{!$Label.MA_Submit}</button>
                </footer>
            </div>
        </section>
    </div>

    <!-- Debug Window -->
    <div id="DebugWindowPopup" class="popup_block">
        <h2>Debug Log</h2>
        <div id="DebugOut"></div>
        <br />
        <br />
        <a class="button1-blue" onclick="ClosePopupWindow();">{!$Label.MA_Close}</a>
        <a class="button1-lightgray" onclick="ClearDebugWindow();">{!$Label.MA_Clear}</a>
        <a class="button1-lightgray" onclick="EmailDebugLog();">{!$Label.MA_Email_Log}</a>
    </div>

    <!-- Address Not Found Window -->
    <div id="AddressNotFoundPopup" class="popup_block">
        <h2>{!$Label.MA_Addresses_Not_Found}</h2>
        <div id="MissingAddressesContent" ></div>
        <br />
        <br />
        <a class="button1-blue" href="javascript:ClosePopupWindow();">{!$Label.MA_Close}</a>
        <a class="button1-lightgray" onclick="ExportMissingAddresses();">{!$Label.MA_Export_Selected}</a>
        <a class="button1-lightgray" onclick="ExportMissingAddresses(true);">{!$Label.MA_Export_All}</a>
    </div>

    <!--Custom Dis Popup -->
    <!--<div id="CustomDispositionPopup" class="ma-modal ma-modal--large">-->
         <!--Loadmask -->
    <!--    <div id='customDis-loadmask'></div>-->

    <!--    <div class="ma-modal-container">-->
    <!--        <div class="ma-modal-header">-->
    <!--            <button onclick="MALayers.hideModal();" class="ma-button ma-modal-close">-->
    <!--                <div class="ma-icon ma-icon-close"></div>-->
    <!--            </button>-->
    <!--            <h4 class="ma-modal-title">Custom Disposition</h4>-->
    <!--        </div>-->
    <!--        <div class="ma-modal-content pad-16">-->
    <!--            <div>-->
    <!--                <div>-->
    <!--                    <div class="disposition-row">-->
    <!--                        <div class="disposition-instruction label">-->
    <!--                            <div class="disposition-instruction-subtext">-->
    <!--                                Please complete the fields below.-->
    <!--                                <span style="font-weight:bold;color:#c23934;">*</span> = Required-->
    <!--                            </div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                    <ul id='customDis-fieldset-errors'></ul>-->
    <!--                    <div class="overflow customDisWrapper" style="position:relative;">-->
    <!--                        <div id='customDis-fieldset'></div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--        <div class="ma-modal-footer clearfix">-->
    <!--            <div class="float-right customDis-buttons">-->
    <!--                <button class="slds-button slds-button_neutral customDis-cancel" onclick="cancelDisposition(); MALayers.hideModal();">{!$Label.MA_Cancel}</button>-->
    <!--                <button class="slds-button slds-button_brand saveDisposition">{!$Label.MA_Finish}</button>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--    </div>    -->
    <!--</div>-->



    <!-- Add to Campaign Window -->
    <!--<div id="AddToCampaignPopup" class="ma-modal ma-modal--large" style='max-height: 600px;'>-->
    <!--    <div class="ma-modal-container" style="width:700px;">-->
    <!--        <div class="ma-modal-header">-->
    <!--            <button class="ma-button ma-modal-close" onclick="MALayers.hideModal();">-->
    <!--                <div class="ma-icon ma-icon-close"></div>-->
    <!--            </button>-->
    <!--            <h4 class="ma-modal-title">{!$Label.MAActionFramework_Add_to_Campaign}</h4>-->
    <!--        </div>-->

    <!--        <div class="ma-modal-content" style="padding:0;height: 400px;position: relative;">-->
    <!--            <div class="pad-16" style="height: calc(100% - 33px);">-->
    <!--                <div id='addtocampaign-select-wrapper' style="height:100%;">-->
    <!--                    <h4>{!$Label.MA_Step_1_Select_Campaigns}</h4>-->

    <!--                    <div id="addtocampaign-select-filters" style="height: calc(100% - 25px);">-->
    <!--                        <div class="ma-form-control-wrap">-->
    <!--                            <label class="ma-input-label">-->
    <!--                                {!$Label.MA_Name}-->
    <!--                                <span class="required">*</span> -->
    <!--                                <span style="font-size: 10px;color:#3083d3;" class='hidden link showadvancedfilters'>{!$Label.MA_Show_Advanced_Filters}</span> -->
    <!--                                | -->
    <!--                                <div class="inline" id='addtocampaign-select-selectiondetails'><span>0</span> {!$Label.MA_selected} <span style="font-size: 10px;color:#3083d3;" class='link clearselections'>{!$Label.MA_Clear_Selections}</span></div>-->
    <!--                                <span style="font-size: 10px;color:#3083d3;" class='link hidden clearfilters'>{!$Label.MA_Clear_Filters}</span>-->
    <!--                            </label>-->
    <!--                            <div class="ma-form-control icon-right">-->
    <!--                                <i class="MAIcon ion-android-search inset-icon--right" style="font-size: 20px;top: 5px;"></i>-->
    <!--                                <input id='addtocampaign-filter-name' class="ma-input searchDynamicInput" type="text"/>-->
    <!--                            </div>-->
    <!--                        </div>-->

    <!--                        <div id="addtocampaign-select-advanced-filters" style='display: none;'>-->
    <!--                            <table>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'>{!$Label.MA_Type}</td>-->
    <!--                                    <td class='data'><input type='text' id='addtocampaign-filter-type' class='filter-text ma-input-row' data-field='Type' /></td>-->
    <!--                                    <td class='label'>{!$Label.MA_Status}</td>-->
    <!--                                    <td class='data'><input type='text' id='addtocampaign-filter-status' class='filter-text ma-input-row' data-field='Status' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'>{!$Label.MA_Start_Date}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-startdate-start' class='filter-calendar start ma-input-row' data-field='StartDate' /> and <input type='text' id='addtocampaign-filter-startdate-end' class='filter-calendar end ma-input-row' data-field='StartDate' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'>{!$Label.MA_End_Date}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-enddate-start' class='filter-calendar start ma-input-row' data-field='EndDate' /> and <input type='text' id='addtocampaign-filter-enddate-end' class='filter-calendar end ma-input-row' data-field='EndDate' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'># {!$Label.MA_Lead}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-leads-start' class='filter-number start ma-input-row' data-field='NumberOfLeads' /> and <input type='text' id='addtocampaign-filter-leads-end' class='filter-number end ma-input-row' data-field='NumberOfLeads' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'># {!$Label.MA_Contact}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-contacts-start' class='filter-number start ma-input-row' data-field='NumberOfContacts' /> and <input type='text' id='addtocampaign-filter-contacts-end' class='filter-number end ma-input-row' data-field='NumberOfContacts' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'># {!$Label.MA_Responses}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-responses-start' class='filter-number start ma-input-row' data-field='NumberOfResponses' /> and <input type='text' id='addtocampaign-filter-responses-end' class='filter-number end ma-input-row' data-field='NumberOfResponses' /></td>-->
    <!--                                </tr>-->
    <!--                            </table>-->
    <!--                        </div>-->

    <!--                        <div class="ma-form-control-wrap" style="overflow: auto; height: calc(100% - 70px);">-->
    <!--                            <table id='addtocampaign-select-grid' class="ma-table">-->
    <!--                                <thead class="ma-table-header">-->
    <!--                                    <tr>-->
    <!--                                        <th style='width: 20px;'></th>-->
    <!--                                        <th>{!$Label.MA_Name}</th>-->
    <!--                                        <th>{!$Label.MA_Type}</th>-->
    <!--                                        <th>{!$Label.MA_Status}</th>-->
    <!--                                        <th>{!$Label.MA_Start_Date}</th>-->
    <!--                                        <th>{!$Label.MA_End_Date}</th>-->
    <!--                                        <th># {!$Label.MA_Lead}</th>-->
    <!--                                        <th># {!$Label.MA_Contact}</th>-->
    <!--                                        <th># {!$Label.MA_Responses}</th>-->
    <!--                                    </tr>-->
    <!--                                </thead>-->
    <!--                                <tbody class="tableResults">-->
    <!--                                    <tr><td colspan="9">Please Search Above...</td></tr>-->
    <!--                                </tbody>-->
    <!--                            </table>-->
    <!--                        </div>-->
    <!--                    </div>-->

    <!--                </div>-->

    <!--                <div id='addtocampaign-options-wrapper'>-->
    <!--                    <h4>{!$Label.MA_Step_2_Options}</h4>-->


    <!--                    <div id='addtocampaign-options-grid-wrapper' class='loadmask-wrapper'>-->
    <!--                        <table id='addtocampaign-options-grid' class='ma-table ma-table--fullwidth'>-->
    <!--                            <thead class="ma-table-header">-->
    <!--                                <tr>-->
    <!--                                    <th>{!$Label.MA_Name}</th>-->
    <!--                                    <th>{!$Label.MA_Member_Status}</th>-->
    <!--                                    <th>{!$Label.MA_Override_Status}</th>-->
    <!--                                </tr>-->
    <!--                            </thead>-->
    <!--                        </table>-->
    <!--                    </div>-->

    <!--                </div>-->
    <!--            </div>-->
    <!--        </div>-->

    <!--        <div class="ma-modal-footer clearfix">-->
    <!--            <div class="float-right">-->
    <!--                <button class="MAbutton button-red" id="maModalClose" onclick="MALayers.hideModal('AddToCampaignPopup',true);">{!$Label.MA_Cancel}</button>-->
    <!--                <button class="slds-button slds-button_brand step2" onclick="AddToCampaign_Step1();">{!$Label.MA_Back}</button>-->
    <!--                <button class="slds-button slds-button_brand step1" onclick="AddToCampaign_Step2();">{!$Label.MA_Next}</button>-->
    <!--                <button class="slds-button slds-button_brand step2" onclick="AddToCampaign_Finish();">{!$Label.MA_Add_Close}</button>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--    </div>-->
    <!--</div>-->

    <div id="SelectBaseObjectPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div id='customDis-loadmask'></div>
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button> 
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">
                            MapAnything&trade; {!$Label.MA_BASE_OBJECTS}
                        </h2>
                        <p class="slds-m-top_x-small js-baseObjectSubType"></p>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-scrollable slds-grow">
                            <div class="js-baseObjectLoad" style="height: 6rem;">
                                <div role="status" class="slds-spinner slds-spinner_medium">
                                    <span class="slds-assistive-text">Loading</span>
                                    <div class="slds-spinner__dot-a"></div>
                                    <div class="slds-spinner__dot-b"></div>
                                </div>
                            </div>
                            <table role="grid" class="baseObjectSelection slds-table slds-table_bordered slds-table_cell-buffer">
 
                            </table>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-right footer-buttons customDis-buttons">
                            <button class="slds-button slds-button_neutral customDis-cancel" onclick="MALayers.hideModal();">{!$Label.MA_Cancel}</button>
                            <button class="slds-button slds-button_brand js-layerSubType" data-layerSubType="::layerSubType::" onclick="MALayers.createMarkerLayer(this);" role="saveButton">{!$Label.MA_Continue}</button>
                        </div>
                    </footer>
                </div>
            </section>
        </div>
   </div>

    <div id="CustomDispositionPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div id='customDis-loadmask'></div>
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">Custom Disposition</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="disposition-row">
                            <div class="disposition-instruction label">
                                <div class="slds-text-title_caps">
                                    Please complete the fields below.
                                </div>
                                <span style="font-weight:bold;color:#c23934;">*</span> = Required
                            </div>
                        </div>
                        <ul id='customDis-fieldset-errors'></ul>
                        <div class="overflow customDisWrapper" style="position:relative;">
                            <div id='customDis-fieldset'></div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-right footer-buttons customDis-buttons">
                            <button class="slds-button slds-button_neutral customDis-cancel" onclick="cancelDisposition(); MALayers.hideModal();">{!$Label.MA_Cancel}</button>
                            <button class="slds-button slds-button_brand saveDisposition">{!$Label.MA_Finish}</button>
                        </div>
                    </footer>
                </div>
            </section>
        </div>
   </div>

    <div id="AddToCampaignPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal slds-modal--xxl" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">{!$Label.MAActionFramework_Add_to_Campaign}</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div id="addtocampaign-select-wrapper">
                            <h4>{!$Label.MA_Step_1_Select_Campaigns}</h4>

                            <div id="addtocampaign-select-filters">
                                <div class="ma-form-control-wrap">
                                    <label class="ma-input-label">
                                        {!$Label.MA_Name}
                                        <span class="required">*</span>
                                        <span style="font-size: 10px;color:#3083d3;" class='hidden link showadvancedfilters'>{!$Label.MA_Show_Advanced_Filters}</span>
                                        |
                                        <div class="inline" id='addtocampaign-select-selectiondetails'><span>0</span> {!$Label.MA_selected} <span style="font-size: 10px;color:#3083d3;" class='link clearselections'>{!$Label.MA_Clear_Selections}</span></div>
                                        <span style="font-size: 10px;color:#3083d3;" class='link hidden clearfilters'>{!$Label.MA_Clear_Filters}</span>
                                    </label>
                                    <div class="ma-form-control icon-right">
                                        <i class="MAIcon ion-android-search inset-icon--right" style="font-size: 20px;top: 5px;"></i>
                                        <input id='addtocampaign-filter-name' class="ma-input searchDynamicInput" type="text"/>
                                    </div>
                                </div>

                                <div id="addtocampaign-select-advanced-filters" style='display: none;'>
                                    <table>
                                        <tr>
                                            <td class='label'>{!$Label.MA_Type}</td>
                                            <td class='data'><input type='text' id='addtocampaign-filter-type' class='filter-text ma-input-row' data-field='Type' /></td>
                                            <td class='label'>{!$Label.MA_Status}</td>
                                            <td class='data'><input type='text' id='addtocampaign-filter-status' class='filter-text ma-input-row' data-field='Status' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'>{!$Label.MA_Start_Date}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-startdate-start' class='filter-calendar start ma-input-row' data-field='StartDate' /> and <input type='text' id='addtocampaign-filter-startdate-end' class='filter-calendar end ma-input-row' data-field='StartDate' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'>{!$Label.MA_End_Date}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-enddate-start' class='filter-calendar start ma-input-row' data-field='EndDate' /> and <input type='text' id='addtocampaign-filter-enddate-end' class='filter-calendar end ma-input-row' data-field='EndDate' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'># {!$Label.MA_Lead}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-leads-start' class='filter-number start ma-input-row' data-field='NumberOfLeads' /> and <input type='text' id='addtocampaign-filter-leads-end' class='filter-number end ma-input-row' data-field='NumberOfLeads' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'># {!$Label.MA_Contact}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-contacts-start' class='filter-number start ma-input-row' data-field='NumberOfContacts' /> and <input type='text' id='addtocampaign-filter-contacts-end' class='filter-number end ma-input-row' data-field='NumberOfContacts' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'># {!$Label.MA_Responses}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-responses-start' class='filter-number start ma-input-row' data-field='NumberOfResponses' /> and <input type='text' id='addtocampaign-filter-responses-end' class='filter-number end ma-input-row' data-field='NumberOfResponses' /></td>
                                        </tr>
                                    </table>
                                </div>

                                <div class="ma-form-control-wrap" style="overflow: auto;">
                                    <table id='addtocampaign-select-grid' class="ma-table">
                                        <thead class="ma-table-header">
                                            <tr>
                                                <th style='width: 20px;'></th>
                                                <th>{!$Label.MA_Name}</th>
                                                <th>{!$Label.MA_Type}</th>
                                                <th>{!$Label.MA_Status}</th>
                                                <th>{!$Label.MA_Start_Date}</th>
                                                <th>{!$Label.MA_End_Date}</th>
                                                <th># {!$Label.MA_Lead}</th>
                                                <th># {!$Label.MA_Contact}</th>
                                                <th># {!$Label.MA_Responses}</th>
                                            </tr>
                                        </thead>
                                        <tbody class="tableResults">
                                            <tr><td colspan="9">Please Search Above...</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                        </div>

                        <div id='addtocampaign-options-wrapper'>
                            <h4>{!$Label.MA_Step_2_Options}</h4>


                            <div id='addtocampaign-options-grid-wrapper' class='loadmask-wrapper'>
                                <table id='addtocampaign-options-grid' class='ma-table ma-table--fullwidth'>
                                    <thead class="ma-table-header">
                                        <tr>
                                            <th>{!$Label.MA_Name}</th>
                                            <th>{!$Label.MA_Member_Status}</th>
                                            <th>{!$Label.MA_Override_Status}</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-right footer-buttons">
                            <button class="slds-button slds-button_neutral" id="maModalClose" onclick="MALayers.hideModal('AddToCampaignPopup',true);">{!$Label.MA_Cancel}</button>
                            <button class="slds-button slds-button_brand step2" onclick="AddToCampaign_Step1();">{!$Label.MA_Back}</button>
                            <button class="slds-button slds-button_brand step1" onclick="AddToCampaign_Step2();">{!$Label.MA_Next}</button>
                            <button class="slds-button slds-button_brand step2" onclick="AddToCampaign_Finish();">{!$Label.MA_Add_Close}</button>
                        </div>
                    </footer>
                </div>
            </section>
        </div>
    </div>
    <!-- Dynamic Filter Window -->
    <script id='DynamicFilterPopupWrapper' type='text/template'>
        <div class="popup_block" style='max-height: 600px;'>
            <div class='loadmask-wrapper'>
                <h2>Dynamic Filters</h2>
                <p style='margin: 2px 0;'> This query contains dynamic filters.  Please enter values for the fields below and click continue.</p>

                <!-- Form -->
                <div>
                    <table class='form-stretch'>

                        <!-- New value -->
                        <tr class='updatefield-value-wrapper'>
                            <td id='DynamicFilterPopup-FieldLabel'></td>
                            <td class='updatefield-value'><input type='text' id='DynamicFilterPopup-FieldValue' /></td>
                        </tr>

                    </table>
                </div>

                <!-- Buttons -->
                <a id='DynamicFilterPopup-Continue' class="button1-lightgray">Continue</a>
                <span id='DynamicFilterPopup-Cancel' class='link' style='font-size: 10px; line-height: 22px;'>{!$Label.MA_Cancel}</span>

            </div>
        </div>
    </script>

    <!-- New Task Window -->
    <div id="NewTaskPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">{!$Label.MA_New_Task}</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div id='newtask-assignto-wrapper'>
                            <h4>{!$Label.MA_Step_1_Assign_To}</h4>

                            <!-- Assignment Type -->
                            <!--<div class='newtask-assignto-type-wrapper'>-->
                            <!--    <input type='radio' name='newtask-assignto-type' id='newtask-assignto-type-static' value='Static' />-->
                            <!--    <label for='newtask-assignto-type-static'>{!$Label.MA_Static}</label>-->

                            <!--    <input type='radio' name='newtask-assignto-type' id='newtask-assignto-type-dynamic' value='Dynamic' />-->
                            <!--    <label for='newtask-assignto-type-dynamic'>{!$Label.MA_Dynamic}</label>-->
                            <!--</div>-->
                            <fieldset class="newtask-assignto-type-wrapper slds-form-element">
                              <div class="slds-form-element__control">
                                <span class="slds-radio">
                                  <input type="radio" id="newtask-assignto-type-static" name="newtask-assignto-type" value='Static' />
                                  <label class="slds-radio__label" for="newtask-assignto-type-static">
                                    <span class="slds-radio_faux"></span>
                                    <span class="slds-form-element__label">{!$Label.MA_Static}</span>
                                  </label>
                                </span>
                                <span class="slds-radio">
                                  <input type="radio" id="newtask-assignto-type-dynamic" name="newtask-assignto-type" value='Dynamic' />
                                  <label class="slds-radio__label" for="newtask-assignto-type-dynamic">
                                    <span class="slds-radio_faux"></span>
                                    <span class="slds-form-element__label">{!$Label.MA_Dynamic}</span>
                                  </label>
                                </span>
                              </div>
                            </fieldset>

                            <div class="ma-form-control-wrap newtask-assignto-type Static">
                                <label class="ma-input-label">{!$Label.MA_Step_1_Assign_To}<span class="required">*</span></label>
                                <div class="ma-form-control icon-right">
                                    <i class="MAIcon ion-android-search inset-icon--right" style="font-size: 20px;top: 5px;"></i>
                                    <input placeholder="Search Users..." class="ma-input searchDynamicInput taskOwner" type="text"/>
                                </div>

                                <div class="ma-form-control-wrap">
                                    <ul style="max-height: 220px;overflow: auto;" class="ma-list table-view search-table-view">
                                        <li class="table-view-cell">Please search above...</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="ma-form-control-wrap newtask-assignto-type Dynamic">
                                <table id='newtask-assignto-type-dynamic-table' class='ma-table ma-table--fullwidth'></table>
                            </div>
                        </div>

                        <div id='newtask-details-wrapper'>
                            <h4>{!$Label.MA_Step_2_Task_Details}</h4>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Subject}<span class="required">*</span></label>
                                <div class="ma-form-control">
                                    <input id='newtask-details-subject' class="ma-input taskSubject" type="text"/>
                                </div>
                            </div>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Due_Date}</label>
                                <div class="ma-form-control icon-right">
                                    <i style="font-size: 20px;top: 5px;" class="MAIcon ion-android-calendar inset-icon--right"></i>
                                    <input id='newtask-details-duedate' class="ma-input taskDate" type="text"/>
                                </div>
                            </div>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Comments}</label>
                                <div class="ma-form-control">
                                    <textarea id='newtask-details-description' style="min-height: 66px;" class="ma-input taskDescription" type="text"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-left footer-buttons">
                            <button class="slds-button slds-button_neutral" id="newTaskClassic" onclick="newTaskClassic();">View in Salesforce</button>
                        </div>
                        <div class="float-right footer-buttons">
                            <button class="slds-button slds-button_neutral" id="maModalClose" onclick="MALayers.hideModal('NewTaskPopup',true);">Cancel</button>
                            <button class="slds-button slds-button_brand step2" onclick="NewTask_Step1();">{!$Label.MA_Back}</button>
                            <button class="slds-button slds-button_brand step1" onclick="NewTask_Step2();">{!$Label.MA_Next}</button>
                            <button class="slds-button slds-button_brand step2" onclick="NewTask_Finish();">{!$Label.MA_Add_Close}</button>
                        </div>
                    </footer>
                </div>
            </section>
        </div>
    </div>

    <!-- New Event Window -->
    <div id="NewEventPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">{!$Label.MA_New_Event}</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div id='newevent-assignto-wrapper'>
                            <h4>{!$Label.MA_Step_1_Assign_To}</h4>

                            <!-- Assignment Type -->
                            <!--<div class='newevent-assignto-type-wrapper'>-->
                            <!--    <input type='radio' name='newevent-assignto-type' id='newevent-assignto-type-static' value='Static' />-->
                            <!--    <label for='newevent-assignto-type-static'>{!$Label.MA_Static}</label>-->

                            <!--    <input type='radio' name='newevent-assignto-type' id='newevent-assignto-type-dynamic' value='Dynamic' />-->
                            <!--    <label for='newevent-assignto-type-dynamic'>{!$Label.MA_Dynamic}</label>-->
                            <!--</div>-->
                            <fieldset class="newevent-assignto-type-wrapper slds-form-element">
                              <div class="slds-form-element__control">
                                <span class="slds-radio">
                                  <input type="radio" id="newevent-assignto-type-static" name="newevent-assignto-type" value='Static' />
                                  <label class="slds-radio__label" for="newevent-assignto-type-static">
                                    <span class="slds-radio_faux"></span>
                                    <span class="slds-form-element__label">{!$Label.MA_Static}</span>
                                  </label>
                                </span>
                                <span class="slds-radio">
                                  <input type="radio" id="newevent-assignto-type-dynamic" name="newevent-assignto-type" value='Dynamic' />
                                  <label class="slds-radio__label" for="newevent-assignto-type-dynamic">
                                    <span class="slds-radio_faux"></span>
                                    <span class="slds-form-element__label">{!$Label.MA_Dynamic}</span>
                                  </label>
                                </span>
                              </div>
                            </fieldset>

                            <div class="ma-form-control-wrap newevent-assignto-type Static">
                                <label class="ma-input-label">{!$Label.MA_Step_1_Assign_To}<span class="required">*</span></label>
                                <div class="ma-form-control icon-right">
                                    <i class="MAIcon ion-android-search inset-icon--right" style="font-size: 20px;top: 5px;"></i>
                                    <input placeholder="Search Users..." class="ma-input searchDynamicInput taskOwner" type="text"/>
                                </div>

                                <div class="new-event-dropdown">
                                    <ul class="ma-list table-view search-table-view slds-listbox slds-listbox_vertical slds-dropdown slds-dropdown--fluid slds-dropdown--length-5">
                                        <li class="table-view-cell slds-media slds-listbox__option slds-listbox__option_plain slds-media_small slds-media_center">Please search above...</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="ma-form-control-wrap newevent-assignto-type Dynamic">
                                <table id='newevent-assignto-type-dynamic-table' class='ma-table ma-table--fullwidth'></table>
                            </div>
                        </div>

                        <div id='newevent-details-wrapper'>
                            <h4>{!$Label.MA_Step_2_Event_Details}</h4>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Subject}<span class="required">*</span></label>
                                <div class="ma-form-control">
                                    <input id='newevent-details-subject' class="ma-input taskSubject" type="text" maxlength="255"/>
                                </div>
                            </div>
                            <div class="slds-grid">
                                <div class="ma-form-control-wrap slds-col slds-p-right_xx-small">
                                    <label class="ma-input-label">{!$Label.MA_Start}<span class="required">*</span></label>
                                    <div class="ma-form-control icon-right">
                                        <input type='text' id='newevent-details-startdate' class='datepicker ma-input-row slds-m-bottom_x-small'/>

                                        <!-- New Event start time input UI -->
                                        <div>
                                            <div class="slds-form-element">
                                                <div class="slds-form-element__control">
                                                    <div class="slds-combobox_container">
                                                        <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click slds-combobox-picklist slds-timepicker"
                                                            aria-expanded="true" aria-haspopup="listbox" role="combobox">
                                                            <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                                <input type="text" class="slds-input slds-combobox__input ma-time-input" id="eventStartTime" aria-controls="listbox-unique-id" autocomplete="off"
                                                                    role="textbox" placeholder="Set start time..." maxlength="8"/>
                                                                <span class="slds-icon_container slds-icon-utility-clock slds-input__icon slds-input__icon_right ma-icon-clock" title="Time Icon"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="ma-form-control-wrap slds-col slds-p-left_xx-small">
                                    <label class="ma-input-label">{!$Label.MA_End}<span class="required">*</span></label>
                                    <div class="ma-form-control icon-right">
                                        <input type='text' id='newevent-details-enddate' class='datepicker ma-input-row slds-m-bottom_x-small'/>

                                        <!-- New Event end time input UI -->
                                        <div>
                                            <div class="slds-form-element">
                                                <div class="slds-form-element__control">
                                                    <div class="slds-combobox_container">
                                                        <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click slds-combobox-picklist slds-timepicker"
                                                            aria-expanded="true" aria-haspopup="listbox" role="combobox">
                                                            <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                                <input type="text" class="slds-input slds-combobox__input ma-time-input" id="eventEndTime" aria-controls="listbox-unique-id" autocomplete="off"
                                                                    role="textbox" placeholder="Set start time..." maxlength="8"/>
                                                                <span class="slds-icon_container slds-icon-utility-clock slds-input__icon slds-input__icon_right ma-icon-clock" title="Time Icon"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>

                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Description}</label>
                                <div class="ma-form-control">
                                    <textarea id='newevent-details-description' style="min-height: 66px;" class="ma-input taskDescription" type="text"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-left footer-buttons">
                            <button class="slds-button slds-button_neutral" id="newEventClassic" onclick="newEventClassic();">View in Salesforce</button>
                        </div>
                        <div class="float-right footer-buttons">
                            <button class="slds-button slds-button_neutral" id="maModalClose" onclick="MALayers.hideModal('NewEventPopup',true);">Cancel</button>
                            <button class="slds-button slds-button_brand step2" onclick="NewEvent_Step1();">{!$Label.MA_Back}</button>
                            <button class="slds-button slds-button_brand step1" onclick="NewEvent_Step2();">{!$Label.MA_Next}</button>
                            <button class="slds-button slds-button_brand step2" onclick="NewEvent_Finish();">{!$Label.MA_Add_Close}</button>
                        </div>
                    </footer>
                </div>
                </section>
        </div>
    </div>

    <!-- Chatter Post Popup -->
    <div id="ChatterPostPopup" class="popup_block mass-action-modal slds-scope" style='max-height: 600px;'>
        <div class="slds-modal__container">
            <header class="slds-modal__header">
                <h2 class="slds-text-heading_medium slds-hyphenate">{!$Label.MA_Chatter_Post}</h2>
            </header>
            <div class="slds-modal__content">
                <!-- Step 1: Content -->
                <div id='chatterpost-content-wrapper' class='loadmask-wrapper'>
                    <div class="slds-p-around_medium">
                        <!-- Header -->
                        <h4 class="slds-text-title_caps">Step 1: Content</h4>
                        <!-- Details -->
                        <table class='grid-blue slds-m-top_small'>
                            <tr>
                                <!-- <td>Content</td> -->
                                <!-- <td><textarea id='chatterpost-content' style='width: 100%; height: 100px; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;'></textarea></td> -->
                                <td>
                                    <div class="slds-form-element">
                                        <label class="slds-form-element__label" for="chatterpost-content"></label>
                                        <div class="slds-form-element__control">
                                            <textarea id="chatterpost-content" class="slds-textarea"></textarea>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <footer class="slds-modal__footer">
                        <!-- Buttons -->
                        <span class='link slds-button slds-button_neutral' style='font-size: 10px; line-height: 22px;' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</span>
                        <a class="button1-lightgray slds-button slds-button_brand" onclick="ChatterPost_Finish();">{!$Label.MA_Add_Close}</a>
                    </footer>
                </div>
            </div>
        </div>
    </div>

    <!-- Clear Coordinates Popup -->
    <div id="ClearCoordinatesPopup" class="popup_block slds-scope mass-action-modal" style='max-height: 600px;'>
        <div class="slds-modal__container">
            <header class="slds-modal__header">
                <!-- Header -->
                <h2 class="slds-text-heading_medium slds-hyphenate">{!$Label.MA_Clear_Coordinates}</h2>
            </header>
            <div class="slds-modal__content slds-p-around_medium">
                <!-- Instructions -->
                <p class='popup-instructions'>{!$Label.MA_Clear_Coord_Info}</p>
            </div>
            <footer class="slds-modal__footer slds-modal__footer_directional">
                <!-- Buttons -->
                <span class='link slds-button slds-button_neutral' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</span>
                <a class="button1-lightgray slds-button slds-button_brand" onclick="ClearCoordinatesForVisible(false); ClosePopupWindow();">{!$Label.MA_Clear_Coord_Unverified}</a>
                <a class="button1-lightgray slds-button slds-button_brand" onclick="ClearCoordinatesForVisible(true); ClosePopupWindow();">{!$Label.MA_Clear_Coord_Verified}</a>
            </footer>
        </div>
    </div>

    <!-- Create Record Data Layer Popup -->
    <div id="CreateRecordDataLayerPopup" class="popup_block">

        <!-- Loadmask -->
        <div id='createrecordDataLayer-loadmask'></div>

        <!-- Step 1 -->
        <div id='createrecordDataLayer-step1' class='createrecord-step'>
            <h1>Step 1</h1>

            <div class="overflow" style="max-height:400px; overflow: auto;">
                <div class='createrecord-formitem'>
                    <label>What would you like to create?</label>
                    <select id="createrecordDataLayer-object" onchange="MAData.createRecordFromDataLayer.object_Change();"></select>
                </div>
                <div class='createrecord-formitem'>
                    <label>Select a record type:</label>
                    <select id='createrecordDataLayer-recordtype'></select>
                </div>
            </div>

            <div class='createrecord-buttons'>
                <button class='slds-button slds-button_neutral createrecordDataLayer-cancel' onclick="MAData.createRecordFromDataLayer.cancel_Record();">Cancel</button>
                <button class="slds-button slds-button_brand" onclick='MAData.createRecordFromDataLayer.create_step_2();'>Continue</button>
            </div>
        </div>

        <!-- Step 2 -->
        <div id='createrecordDataLayer-step2' style="display:none;" class='createrecordDataLayer-step'>
            <h1>Step 2</h1>

            <div>
                <label>Fill in the fields below</label>
                <div class="overflow" style="max-height:400px; overflow: auto;">
                    <div id='createrecordDataLayer-fieldset'></div>
                </div>
                <ul id='createrecordDataLayer-fieldset-errors'></ul>
            </div>

            <div class='createrecordDataLayer-buttons'>
                <button class='slds-button slds-button_neutral createrecord-cancel' onclick="MAData.createRecordFromDataLayer.cancel_Record();">Cancel</button>
                <button class="slds-button slds-button_brand" onclick='MAData.createRecordFromDataLayer.saveDataLayerRecord();'>Finish</button>
            </div>
        </div>

    </div>

    <!-- Create Record Popup -->
    <div id="CreateRecordPopup" class="popup_block">

        <!-- Loadmask -->
        <div id='createrecord-loadmask'></div>

        <!-- Step 1 -->
        <div id='createrecord-step1' class='createrecord-step'>
            <h1>Step 1</h1>

            <div class='createrecord-formitem'>
                <label>What would you like to create?</label>
                <select id="createrecord-object" onchange="CreateRecord_Object_Change();"></select>
            </div>
            <div class='createrecord-formitem'>
                <label>Select a record type:</label>
                <select id='createrecord-recordtype'></select>
            </div>

            <div class='createrecord-buttons'>
                <button onclick='CreateRecord_Step1_Continue();'>Continue</button>
                <button class='createrecord-cancel' onclick="CreateRecord_Cancel();">Cancel</button>
            </div>
        </div>

        <!-- Step 2 -->
        <div id='createrecord-step2' class='createrecord-step'>
            <div class="slds-text-title_caps">Step 2</div>

            <div>
                <div class="slds-text-body_regular slds-m-bottom_medium">Fill in the fields below</div>
                <ul id='createrecord-fieldset-errors'></ul>
                <div id='createrecord-fieldset'></div>
            </div>

            <div class='createrecord-buttons'>
                <button onclick='CreateRecord_Step2_Continue();'>Finish</button>
                <button class='createrecord-cancel' onclick="CreateRecord_Cancel();">Cancel</button>
            </div>
        </div>
    </div>

    <!-- LinkedIn Message Popup -->
    <div id="LinkedInMessagePopup" class="popup_block">
        <div class='loadmask-wrapper'>

            <!-- Header -->
            <h2>{!$Label.MA_Send_Message}</h2>

            <!-- Instructions -->
            <p class='popup-instructions'>{!$Label.MA_Enter_Subject_Message}</p>

            <!-- Content -->
            <table class='grid-blue'>
                <tr>
                    <td>{!$Label.MA_Subject}</td>
                    <td><input type='text' class='linkedin-message-subject' style='width: 100%; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;' /></td>
                </tr>
                <tr>
                    <td>{!$Label.MA_Body}</td>
                    <td><textarea class='linkedin-message-body' style='width: 100%; height: 100px; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;'></textarea></td>
                </tr>
            </table>

            <!-- Spacer -->
            <div style="height: 15px;">&nbsp;</div>

            <!-- Buttons -->
            <a class="button1-lightgray" onclick="linkedIn_SendMessage_Send();">{!$Label.MA_Send_Message}</a>
            <span class='link' style='font-size: 10px; line-height: 22px;' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</span>

        </div>
    </div>

    <!-- Export Window -->
    <div id="ExportPopup" class="popup_block">
        <h2>{!$Label.MA_Export}</h2>
        <br />
        <br />
        <a class="button1-blue" href="javascript:ClosePopupWindow();">{!$Label.MA_Close}</a>
    </div>

    <!-- Loading Popup -->
    <div id="LoadingPopup" class="popup_block">
        <table>
            <tr>
                <td>
                    <img src='{!URLFOR($Resource.MapAnything, "MapLoadingGif.gif")}' />
                </td>
                <td style="vertical-align:middle;">
                    <b>{!$Label.MA_Loading}...</b>
                </td>
            </tr>
        </table>
    </div>

    <!-- Truck Options -->
    <div id="TruckOptions" class="popup_block">
        <h2>Truck Options</h2>

        <table cellpadding="5">
            <tr>
                <td style="vertical-align:top;"><b>Hazardous Goods</b></td>
                <td>
                    <table>
                        <tr>
                            <td><input type="checkbox" name="explosive" value="explosive" />Explosive</td>
                            <td><input type="checkbox" name="gas" value="gas" />Gas</td>
                            <td><input type="checkbox" name="flammable" value="flammable" />Flammable</td>
                            <td><input type="checkbox" name="combustible" value="combustible" />Combustible</td>
                            <td><input type="checkbox" name="organic" value="organic" />Organic</td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" name="poison" value="poison" />Poison</td>
                            <td><input type="checkbox" name="radioActive" value="radioActive" />Radio-Active</td>
                            <td><input type="checkbox" name="corrosive" value="corrosive" />Corrosive</td>
                            <td colspan="2"><input type="checkbox" name="other" value="other" />Other<br /></td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <input type="checkbox" name="poisonousInhalation" value="poisonousInhalation" />Poisonous upon Inhalation<br />
                            </td>
                            <td colspan="3">
                                <input type="checkbox" name="harmfulToWater" value="harmfulToWater" />Harmful to Water<br />
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td style="vertical-align:top;"><b>Truck &amp; Trailer</b></td>
                <td>
                    <table cellpadding="3">
                        <tr>
                            <td><b>Height</b></td>
                            <td><input type="text" name="email" size="10" /></td>
                            <td style="color:#909090;">Maximum truck height in meters.</td>
                        </tr>
                        <tr>
                            <td><b>Width</b></td>
                            <td><input type="text" name="width" size="10"/></td>
                            <td style="color:#909090;">Maximum truck width in meters.</td>
                        </tr>
                        <tr>
                            <td><b>Length</b></td>
                            <td><input type="text" name="length" size="10" /></td>
                            <td style="color:#909090;">Maximum truck length in meters.</td>
                        </tr>
                        <tr>
                            <td><b>Trailer Weight</b></td>
                            <td><input type="text" name="trailerWeight" size="10"/></td>
                            <td style="color:#909090;">Maximum trailer weight in tons.</td>
                        </tr>

                    </table>
                </td>
            </tr>

        </table>

        <a class="button1-blue" href="javascript:ClosePopupWindow();">{!$Label.MA_Save_Close}</a>
    </div>

    <!-- Choose Download Type -->
    <div id="ChooseDownloadTypePopup" class="popup_block">

        <!-- Download Type Options -->
        <select id='downloadType' style="margin-right: 10px;">
            <option value="xls" data-type="application/vnd.ms-excel">xls</option>
            <option value="csv" data-type="text/csv">csv</option>
        </select>

        <a class="button1-blue" style="float: right;" href="javascript:ClosePopupWindow();">{!$Label.MA_Close}</a>
        <a class="button1-blue" style="float: right;" href="javascript:downloadRoute();">{!$Label.MA_Save}</a>
    </div>

    <!-- General Popup -->
    <div class="popup-container" id="AlertPopup" style="background-color: rgba(0, 0, 0, 0.4);">
        <div class="popup">
            <div class="popup-head">
                <h3 class="popup-title">Error Getting Position</h3>
                <h5 class="popup-sub-title">name may not be blank</h5>
            </div>
            <div class="popup-body">
            </div>
            <div class="popup-buttons">
                <a class='slds-button slds-button_brand' style='float: left;' onclick="$(this).closest('.popup-container').removeClass('active')">{!$Label.MA_Close}</a>
            </div>
        </div>
    </div>

    <!-- Create Folder PopUP -->
    <div id="CreateFolderPopup"  class="popup_block">
        <!-- Loading Wrapper -->
        <div class='loadmask-wrapper'>
            <!-- Loading -->
            <div class="saving-wrapper" style="display:none; position: absolute;background-color: rgba(255, 255, 255, 0.85);z-index: 10;width: 100%;height: 100%;">
                <div style="position:relative; width 100%; height: 150px;">
                    <div style="position: absolute;bottom: 0px;right: 0px;color: #298AD0;">Saving...</div>
                </div>
            </div>

            <!-- Header -->
            <h2 role="header">New Folder</h2>

            <!-- Spacer -->
            <div style='height: 15px;'>&nbsp;</div>

            <!-- Instructions -->
            <div style="font-size:12px;">{!$Label.MAFavoriteLocation_Please_complete_all_information}:</div>

            <!-- Spacer -->
            <div style='height: 25px;'>&nbsp;</div>

            <!-- Location Info Table -->
            <table>
                <tr>
                    <td>
                        <div class="slds-form-element">
                          <label class="slds-form-element__label" for="text-input-id-1">{!$Label.MA_Name}</label>
                          <div class="slds-form-element__control">
                            <input maxlength='80' class="folderName slds-input" type='text' tabindex="0" role="folderName" placeholder="Enter folder name..." />
                          </div>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- Spacer -->
            <div style='height: 25px;'>&nbsp;</div>

            <!-- Buttons -->
            <div class='create-location-buttons' style='overflow: hidden;'>
                <a class='slds-button slds-button_neutral' style='float: left;' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</a>
                <a class='slds-button slds-button_brand' style='float: left; margin-right:10px;' onclick="createNewFolder();" role="saveButton">{!$Label.MA_Save_Close}</a>
            </div>

        </div>
    </div>

    <!-- Save Routes Popup Missing Waypoint Name -->
    <div id="SaveRoutesPopupMissingWaypointName" class="popup_block">

        <!-- Save Options -->
        <div id='routeMessage' style="margin-bottom: 10px;">
        </div>

        <a class="button1-blue" href="javascript:CloseMessageWindow();">{!$Label.MA_Close}</a>
    </div>

    <!-- Log A Call Popup -->
    
    <div id="LogACallPopup" class="maModal">
        <div class="logacallform" style="position:relative;">
            <div class='logacallform-step' style="display:none;">
                <div>
                    <div class="slds-text-body_regular slds-m-bottom_medium">Fill in the fields below</div>
                    <div class='logacallform-fieldset'></div>
                    <ul class='logacallform-fieldset-errors'></ul>
                </div>
            </div>
        </div>
        <div class="maModal standardlogacall">
            <div class="slds-scope" >
                <section class="slds-modal" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header">
                            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                                <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                            <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">{!$Label.MAActionFramework_Log_a_Call}</h2>
                        </header>

                        <div class="slds-modal__content slds-p-around_medium">
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">Subject</label>
                                <div class="ma-form-control">
                                    <input class="ma-input callSubject" type="text" value="Call"/>
                                </div>
                            </div>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">Comments</label>
                                <div class="ma-form-control">
                                    <textarea style="min-height: 66px;" class="ma-input callComments" type="text"></textarea>
                                </div>
                            </div>
                            <div class="hidden ma-form-control-wrap">
                                <label class="ma-input-label">Name</label>
                                <div class="ma-form-control icon-left">
                                    <i style="color: #54698d;position: absolute;top: 6px;left: 14px;font-size: 16px;" class="MAIcon ion-android-search"></i>
                                    <input class="ma-input callContact" type="text" placeholder="Search Contacts"/>
                                </div>
                            </div>
                            <div class="hidden ma-form-control-wrap">
                                <label class="ma-input-label">Related To</label>
                                <div class="ma-form-control icon-left">
                                    <i style="color: #54698d;position: absolute;top: 6px;left: 14px;font-size: 16px;" class="MAIcon ion-android-search"></i>
                                    <input class="ma-input callAccount" type="text" placeholder="Search Accounts"/>
                                </div>
                            </div>
                        </div>

                        <footer class="slds-modal__footer">
                            <div class="float-left footer-buttons">
                                <button class="slds-button slds-button_neutral" id="LogACallClassic" onclick="LogACallClassic();">View in Salesforce</button>
                            </div>
                            <div class="float-right footer-buttons">
                                <button class="slds-button slds-button_neutral" id="maModalClose" onclick="MALayers.hideModal('LogACallPopup',true);">{!$Label.MA_Cancel}</button>
                                <button class="slds-button slds-button_brand" onclick="logACall_Finish(false);">{!$Label.MA_Finish}</button>
                            </div>
                        </footer>
                    </div>
                </section>
            
            </div>
        </div> 
    </div>

    <!-- Save Routes Popup -->
    <div id="SaveRoutesPopup">
    </div>

    <!-- Query Editor Window -->
    <div id='queryeditor-modal' style='display: none;'>
        <div class='query-editor-modal-loader'>{!$Label.MA_Loading}...</div>
        <div class='query-editor-modal-content'></div>
    </div>


    <!-- Tooltip Template -->
    <div id='tooltip-content-template' style='display: none;'>

        <!-- Header -->
        <div class='tooltip-header'>
            <!-- -->
            <div class="savedQueryName">::QueryName::</div>

            <!-- Record Name -->
            <div class='name'>
                <a href="/::Id::" target="_blank">::Name::</a>
            </div>

            <!-- Record Address -->
            <div class='address'>
                <span class="ma-icon ma-icon-checkin slds-icon slds-icon--x-small"></span>
                <span class="address-text">::Address::</span>
            </div>
        </div>

        <!-- Tabs -->
        <div class='tabs' ContentKey="::ContentKey::">
            <ul>
                <li id='tab-info' class="tooltip-tab" data-tab="info"><a href="#pane-info-::ContentKey::">{!$Label.MA_Info}</a></li>
                <li id='tab-actions' class="tooltip-tab" data-tab="actions"><a href="#pane-actions-::ContentKey::">{!$Label.MA_Actions}</a></li>
                <li id='tab-chatter' class="tooltip-tab" data-tab="chatter" style='display: none;'><a href="#pane-chatter-::ContentKey::">{!$Label.MA_Chatter}</a></li>
                <li id='tab-relatedlist' class="tooltip-tab" data-tab="relatedlist" style='display: none;'><a href="#pane-relatedlist-::ContentKey::">{!$Label.MA_Related_Lists}</a></li>
                <li id='tab-weather' class="tooltip-tab" data-tab="weather" style='display: none;'><a href="#pane-weather-::ContentKey::">{!$Label.MA_Weather}</a></li>
                <li id='tab-live' class="tooltip-tab" data-tab="live" style='display: none;'><a href="#pane-live-::ContentKey::">Live</a></li>
                <li id='tab-history' class="tooltip-tab" data-tab="live-history" style='display: none;'><a href="#pane-history-::ContentKey::">Tracking History</a></li>
            </ul>

            <!-- Info Tab -->
            <div id="pane-info-::ContentKey::">

                <!-- Tooltips -->
                <div class="tooltips">
                    <table>

                    </table>
                </div>

            </div>

            <!-- Actions Tab -->
            <div id="pane-actions-::ContentKey::">
                <div class='layout-tooltip'></div>
            </div>

            <!--Chatter Tab -->
            <div id="pane-chatter-::ContentKey::" class='loading' style='overflow: hidden; padding: 0;'>
            </div>

            <!-- Related Lists Tab -->
            <div id="pane-relatedlist-::ContentKey::">
                <div id="ajax-::ContentKey::" style='overflow: auto;'></div>
            </div>

            <!-- Weather Tab -->
            <div id="pane-weather-::ContentKey::">
                <div id="weather-ajax-::ContentKey::"></div>
            </div>
            <!-- Live Info Tab -->
            <div id="pane-live-::ContentKey::">
                <div id="live-infobubble-content-::ContentKey::">
                    <div class="live-info live-template" style='display: none;'>
                    </div>
                </div>
            </div>

            <!-- Device History Tab -->
            <div id="pane-history-::ContentKey::">
                <div id="history-infobubble-content-::ContentKey::" class="slds-scope">
                    <div class="device-history-input live-template slds-p-bottom_xx-small" style='display: none;'>
                        <table class="live-tracking-history-tooltip-table slds-table_fixed-layout">
                            <caption></caption>
                            <tbody>
                                <tr>
                                    <td class="time-zone-input slds-p-top_x-small">
                                        <div class="slds-form-element slds-p-right_xx-small">
                                            <label class="slds-form-element__label">{!$Label.SUMMARY_CONFIGURATION}</label>
                                            <div class="slds-select_container">
                                                <select id="live-configs" class="slds-select live-configs-select">
                                                    <option value="null">Loading...</option>
                                                </select>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="time-zone-input slds-p-top_x-small">
                                        <div class="slds-form-element slds-p-left_xx-small">
                                            <label class="slds-form-element__label">{!$Label.TIMEZONE}</label>
                                            <select class="live-input live-time-zone slds-select"></select>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="live-day-input slds-p-top_x-small">
                                        <div class="slds-form-element slds-p-right_xx-small">
                                            <label class="slds-form-element__label">{!$Label.MA_Start_Date}</label>
                                            <div class= "slds-form-element__control"><input type="text" name="liveday" autocomplete="off" class="date-input live-input slds-input" /></div>
                                        </div>
                                    </td>
                                    <td class="live-day-input slds-p-top_x-small">
                                        <div class="slds-form-element slds-p-left_xx-small">
                                            <label class="slds-form-element__label">{!$Label.MA_End_Date}</label>
                                            <div class= "slds-form-element__control"><input type="text" name="liveday" autocomplete="off" class="date-input-enddate live-input slds-input" /></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="live-time-input slds-p-top_x-small">
                                        <div class="slds-form-element slds-p-right_xx-small">
                                            <label class="slds-form-element__label">Start Time</label>
                                            <div class= "slds-form-element__control"><input type="time" name="livestarttime" autocomplete="off" class="live-starttime time-input live-input slds-select" /></div>
                                        </div>
                                    </td>
                                    <td class="live-time-input slds-p-top_x-small">
                                        <div class="slds-form-element slds-p-left_xx-small">
                                            <label class="slds-form-element__label">End Time</label>
                                            <div class= "slds-form-element__control"><input type="time" name="liveendtime" autocomplete="off" class="live-endtime time-input live-input slds-select" /></div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button class="view-full-history slds-button slds-button_neutral slds-m-top_x-small">
                            View Full History
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--teddy-->
    <!-- Live vertice Tooltip Template -->
    <div id='live-vertice-tooltip-content-template' class="infobubble tooltip-content-container" style='display: none;'>
        <div id="tooltip-content">

        <!-- Header -->
        <div class='tooltip-header'>
            <!-- -->
            <div class="savedQueryName">::QueryName::</div>

            <!-- Record Name -->
            <div class='name'>
                <a href="/::Id::" target="_blank">::Name::</a>
            </div>

            <!-- Record Address -->
            <div class='address'>
                <span class="address-text">::Address::</span>
            </div>
        </div>
        <div class="layout-tooltip">

            <div class="device-history-vertice-info"></div>

            <div class="vertice-tooltip-button-div">
                <input type="button" class="actionbutton removeHistoryButton vertice-tooltip-button" value="Remove History" data-action="Remove History" data-type="Standard Action"></input>
            </div>
        <!--<div class="layout-tooltip">
            <div>
                    <div class="buttonset-section">
                        <div class="buttonset-section-columns">
                            <div class="buttoncolumn">
                                <input class="actionbutton disabled" type="button"  onclick="MAPlotting.tooltipActionClick(this)" value="Set Verified Location" data-type="Standard Action" data-action="Set Verified Location"></input>
                            </div>
                        </div>
                    </div>
            </div>
        </div>-->
        </div>
    </div>
    </div>
    <!--teddy-->

    <!--teddy-->
    <!-- Live polyline Tooltip Template -->
    <div id='live-polyline-tooltip-content-template' class="infobubble" style='display: none;'>
        <div id="tooltip-content">
        <!-- Header -->
        <div class='tooltip-header'>
            <!-- -->
            <div class="savedQueryName">::QueryName::</div>

            <!-- Record Name -->
            <div class='name'>
                <a href="/::Id::" target="_blank">::Name::</a>
            </div>

            <!-- Record Address -->
            <div class='address'>
                <span class="address-text">::Address::</span>
            </div>
        </div>
        <div class="layout-tooltip">
            <div class="device-history-polyline-info"></div>

            <div class="polyline-tooltip-button-div">
                <input style="display: block; margin: 0 auto;" type="button" class="actionbutton removeHistoryButton polyline-tooltip-button" value="Remove History" data-action="Remove History" data-type="Standard Action"></input>
            </div>
        </div>
    </div>
    </div>
    <!--teddy-->

    <!-- POI Totals Template -->
    <div id='poi-results-totals-template' style='display: none;'>
        <div class='poi-results-page template'>
            <div class='results-row'>::start:: - ::end:: of ::total:: for ::searchterm::</div>
        </div>
    </div>

    <!-- Territory Tooltip Template -->
    <div id='territory-tooltip-content-template' style='display: none;'>

        <!-- Territory Name -->
        <div class='name'></div>

        <!-- Aggregate Info -->
        <table>
            <tr>
                <td class='aggregate-name'></td>
                <td class='aggregate-value'></td>
            </tr>
        </table>

    </div>

    <!-- Invisible Playground (used for measuring markers) -->
    <div id='invisible' style='opacity: 0; position: absolute; z-index: -9999999999; top: -999999px; left: -99999999px;'>
    </div>

    <div id='direction-list' style='display:none;'>
        <table class='direction-table'>
        </table>
    </div>

    <!-- MA Territory Tree Templates -->
    <div id='MATerritoryTreeTemplates' style='display: none;'>

        <!-- Territory Table -->
        <table class='territory-table grid-blue'>
            <tr data-id='Territories' data-level='0'>
                <th>Territory</th>
                <th>Visible</th>
            </tr>
        </table>

        <!-- New Territory Popup -->
        <div id='NewTeritoryPopup'>

            <!-- Geometry Header -->
            <table style='border-bottom: 2px solid silver; margin-bottom: 10px; width: 100%;'>
                <tr>
                    <td style='color: rgb(34, 101, 187); font-size: 120%; font-weight: bold;'>New Territory</td>
                </tr>
            </table>

            <!-- Label -->
            <table>
                <tr>
                    <td>Please enter a label to continue:</td>
                </tr>
            </table>
            <table>
                <tr>
                    <td><input maxlength='80' class='territory-label' type='text'></input></td>
                </tr>
            </table>
        </div>

        <!-- Territory Rows -->
        <table>

            <!-- Territory Row -->
            <tr class='territory-row'>
                <td><div class='territory-row-toggle'></div><span class='name'></span></td>
                <td class='visible'><input type='checkbox' /></td>
            </tr>

            <!-- Rollup Legend Row -->
            <tr class='territory-legend-row'>
                <td class='label'></td>
                <td class='from'></td>
                <td>-</td>
                <td class='to'></td>
                <td class='color' style='vertical-align: middle; text-align: right;'><div></div></td>
            </tr>

        </table>

    </div>

    <!-- Templates -->
    <div id='templates' style='display: none;'>
        
        <!-- Street View Close Button -->
        <a id="closeStreetView" class="btn btn-sm btn-primary">Close Street View</a>

        <li class="poi-row slds-item clickable-item global-search-result-item global-search-result-item js-show-global-search-query-individual-item">
            <div class="slds-tile slds-media">
                <div class="slds-media__figure">
                    <div aria-hidden="true" class="slds-icon">
                        <img class='poi-image'/>
                    </div>
                </div>
                    <div class="slds-media__body">
                    <h3 class="slds-truncate"><a href='' target="_blank" class='poi-name'></a></h3>
                    <div class="slds-tile__detail slds-text-body--small">
                        <ul class="slds-list--horizontal">
                            <li class="slds-item poi-address"></li>
                        </ul>
                    </div>
                </div>
            </div>
        </li>

        <div class="dynamicFilterPopup template">
            <div style="padding: 0 5%;color: #757575;">
                <div class="MAIcon ion-information-circled" style="display: inline-block;vertical-align: top;font-size: 20px;"></div>
                <div style="color: #757575;font-size: 11px;display: inline-block;width: 90%;">This query contains dynamic filters.  Please enter values for the fields below and click continue.</div>
            </div>
            <div>
                <table class='form-stretch'>

                </table>
            </div>
        </div>

        <div class="queryFilter template">
            <div class="filter-row ma-form-control-wrap" data-parentfield="::parentfield::" data-fieldapiname="::fieldapiname::" data-fieldlabel="::fieldlabel::" data-operator="::operator::">
                <label class="ma-input-label"><strong>Field:</strong> ::FIELD::</label>
                <select class="ma-input fieldInput ::RowUID::" multiple="multiple" id="accountPlotDynamicField" placeholder="{!$Label.MA_Value}..." type="text"></select>
            </div>
        </div>

        <!-- autocomplete -->
        <div class="autocompleteWrapper">
            <ul class="autocompleteList"></ul>
            <div class="ac-button-wrap">
                <button class="ac-button-close button-small MAbutton button-silver">Close</button>
            </div>
        </div>


        <!-- Color Picker Template -->
        <div class="MAColorPicker">
            <div class="icon-selection inline" style="width: 110px;">

            </div>
            <div class="palette inline">
                <table class="palette-table"></table>
            </div>

            <div class="footer">
                <button class="slds-button slds-button_neutral cancelPicker">Cancel</button>
                <button class="slds-button slds-button_brand confirmPicker">Done</button>
            </div>
        </div>



        <!-- Data Layer Popup V2 -->
        <div class="CreateRecordDataLayerPopup2" style="position:relative;">

            <!-- Step 1 -->
            <div class='createrecordDataLayer2-step1 createrecord-step'>
                <div class="slds-text-title_caps">Step 1</div>
                <!--<div class="overflow" style="max-height:400px; overflow: auto;">-->
                <!--    <div class='createrecord-formitem'>-->
                <!--        <label>What would you like to create?</label>-->
                <!--        <select class="createrecordDataLayer2-object" onchange="MAData.createRecordFromDataLayer.object_Change_V2();"></select>-->
                <!--    </div>-->
                <!--    <div class='createrecord-formitem'>-->
                <!--        <label>Select a record type:</label>-->
                <!--        <select class='createrecordDataLayer2-recordtype'></select>-->
                <!--    </div>-->
                <!--</div>-->
                <div class="overflow">
                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-01">What would you like to create?</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecordDataLayer2-object" id="select-01" onchange="MAData.createRecordFromDataLayer.object_Change_V2();"></select>
                        </div>
                      </div>
                    </div>
                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-02">Select a record type</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecordDataLayer2-recordtype" id="select-02"></select>
                        </div>
                      </div>
                    </div>
                </div>
            </div>

            <!-- Step 2 -->
            <div class='createrecordDataLayer2-step2 createrecordDataLayer-step' style="display:none;">
                <div class="slds-text-title_caps">Step 2</div>

                <div>
                    <div class="slds-text-body_regular slds-m-bottom_medium">Fill in the fields below</div>
                    <div class='createrecordDataLayer-fieldset'></div>
                    <ul class='createrecordDataLayer2-fieldset-errors'></ul>
                </div>
            </div>
        </div>

        <!-- Data Layer Popup Rows -->
        <div class="dl-filter-row dl-row">
            <div class="inline filter-content">
                <div>
                    <div style="width:30%;" class="fieldLabel inline topic">{!$Label.MA_TOPIC}:</div>
                    <div style="width:30%;" class="fieldLabel inline operator">{!$Label.MA_OPERATOR}:</div>
                    <div style="width:30%;" class="fieldLabel inline value">{!$Label.MA_Value}:</div>
                </div>
                <div>
                    <div style="width:30%;" class="dl-filter-topic-wrap inline"><select></select></div>
                    <div style="width:30%;" class="dl-filter-operator-wrap inline"><select style="width:100%" class="dl-filter-operator"><option value="" disabled="disabled" selected="selected"></option></select></div>
                    <div style="width:30%;" class="inline"><div class="dl-filter-value-wrapper" style="position:relative;"><input class="dl-filter-value" type="text"/></div></div>
                </div>
                <div style="position: absolute;top: 0px;right: 0px;">
                    <button class="MA2-button-remove ion-close-circled remove-row"></button>
                </div>
            </div>
        </div>

        <div onclick="MAData.wizard.handleTooltipClick(this);" class="dl-tab template">
            <div class="transparent input">
                <input onclick="MAData.wizard.handleTooltipClick(this);" class="tab-name" type="text" value=""/>
            </div>
            <button class="MAbutton button-clear remove-tab ion-android-cancel" onclick="MAData.wizard.removeTooltipTab(this);"></button>
        </div>

        <div class="dl-tab-row">
            <div class="inline MAheader header-main">
                <div class="dl-tooltip-header" style="height:40px;border-bottom: 1px solid #C6C6C6; padding: 0px 10px;">
                    <div class="inline tab-title" style="line-height: 40px;"></div>
                    <div class="inline" style="float: right;margin-top: 7px;"><button onclick="MAData.wizard.collapseInfo(this);" class="MA2button button-xsmall icon-left ion-android-remove-circle dl-tooltip-collapse">Collapse</button></div>
                </div>
                <div class="dl-tooltip-subheader MAheader header-info header-collapse">
                    <div class="MA2-pad-10">
                    <table style="width: inherit;">
                        <tr>
                            <td>Title:</td><td><input class="tab-title-input" value="New Tab" type="text"/></td>
                        </tr>
                    </table>
                    </div>
                </div>
                <div class="MA2-divider-compact"></div>
                <div class="dl-tooltip-rows MAheader header-info header-collapse"></div>
                <div class="dl-tooltip-footer MAheader header-info header-collapse">
                    <div class="MA2-pad-10">
                    <button onclick="MAData.wizard.createToolipRow({element:this,type:'tab'});" class="MA2button button-small icon-left ion-android-add-circle addTooltipRow">Add a row</button>
                    </div>
                </div>
            </div>
            <div style="display:inline-block;vertical-align: top;">
                <button class="MA2-button-remove ion-close-circled remove-row"></button>
            </div>
        </div>

        <div class="dl-tooltip-row dl-row">
            <div class="inline" style="width:100%;">
                <div>
                    <div style="width:18%;" class="inline">{!$Label.MA_DATA_SOURCE}:</div>
                    <div style="width:30%;" class="inline dl-tooltip-file-wrap"><select class="dl-tooltip-file" style="width:100%;"><option value="--">-Select-</option></select></div>
                    <div style="width:10%;text-align: right;" class="inline">{!$Label.MA_TOPIC}:</div>
                    <div style="width:30%;" class="inline dl-tooltip-topic-wrap"><select class="dl-tooltip-topic" style="width:100%;"><option value="--">-Select-</option></select></div>
                    <div class="inline" style="vertical-align: top;"><button class="MA2-button-remove ion-close-circled remove-row"></button></div>
                </div>
            </div>
        </div>

        <div class="dl-legend-row dl-row">
            <div class="inline" style="width:100%;">
                <div>
                    <div style="width:5%;text-align: center;" class="inline dl-legend-color" data-maicon="Marker"></div>
                    <div style="width:43%;" class="inline dl-legend-operator-wrap"></div>
                    <div style="width:43%;position:relative;" class="inline dl-filter-value-wrapper"><input class="dl-filter-value-start dl-filter-autocomplete" type="text"/></div>
                    <div style="width:5%;vertical-align: top;" class="inline"><button class="MA2-button-remove ion-close-circled remove-row"></button></div>
                </div>
            </div>
        </div>
        <!-- Click 2 Create Popup V2-->

        <div class="CreateArcLayerRecordPopup">
            <!-- Step 1 -->
            <div class='createrecord2-step1 createrecord-step'>
                <div class="slds-text-title_caps">Step 1</div>
                <div class="overflow">

                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-01">What would you like to create?</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecord2-object" id="select-01"></select>
                        </div>
                      </div>
                    </div>
                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-02">Select a record type</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecord2-recordtype" id="select-02"></select>
                        </div>
                      </div>
                    </div>
                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-02">Select a field set</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecord2-fieldset" id="select-02"></select>
                        </div>
                      </div>
                    </div>
                </div>
            </div>

            <!-- Step 2 -->
            <div class='createrecord2-step2 createrecord-step' style="display:none;">
                <div class="slds-text-title_caps">Step 2</div>
                <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                    <label class="slds-form-element__label" for="select-02">
                  		<abbr class="slds-required" title="required">*</abbr>
                        Select a template
                    </label>
                    <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                      <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                      <div class="slds-select_container">
                        <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecord2-template" id="select-03"></select>
                      </div>
                    </div>
                </div>
                <div>
                    <div class="slds-text-body_regular slds-m-bottom_medium">Fill in the fields below</div>
                    <div class='createrecord-fieldset'></div>
                    <ul class='createrecord2-fieldset-errors'></ul>
                </div>
            </div>
        </div>



        <div class="CreateRecordPopup">

            <!-- Step 1 -->
            <div class='createrecord2-step1 createrecord-step'>
                <div class="slds-text-title_caps">Step 1</div>
                <div class="overflow">
                    <!--<div class='createrecord-formitem'>-->
                    <!--    <label>What would you like to create?</label>-->
                    <!--    <select class="createrecord2-object" onchange="c2c.CreateRecord_Object_Change();"></select>-->
                    <!--</div>-->
                    <!--<div class='createrecord-formitem'>-->
                    <!--    <label>Select a record type:</label>-->
                    <!--    <select class='createrecord2-recordtype'></select>-->
                    <!--</div>-->

                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-01">What would you like to create?</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecord2-object" id="select-01" onchange="c2c.CreateRecord_Object_Change();"></select>
                        </div>
                      </div>
                    </div>
                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-02">Select a record type</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecord2-recordtype" id="select-02"></select>
                        </div>
                      </div>
                    </div>
                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem arcgis-form-element">
                      <label class="slds-form-element__label" for="select-03">Which ArcGIS Object would you like to use?</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecord2-arcgisbatchpushsetting" id="select-03"></select>
                        </div>
                      </div>
                    </div>
                </div>
            </div>

            <!-- Step 2 -->
            <div class='createrecord2-step2 createrecord-step' style="display:none;">
                <div class="slds-text-title_caps">Step 2</div>

                <div>
                    <div class="slds-text-body_regular slds-m-bottom_medium">Fill in the fields below</div>
                    <div class='createrecord-fieldset'></div>
                    <ul class='createrecord2-fieldset-errors'></ul>
                </div>
            </div>

        </div>

        <!-- Create Folder PopUP v2 -->
        <div class="CreateFolderPopup">
            <!-- Location Info Table -->
            <table>
                <tr>
                    <td>
                        <div class="slds-form-element">
                          <label class="slds-form-element__label">Folder {!$Label.MA_Name}</label>
                          <div class="slds-form-element__control">
                            <input maxlength='80' class="folderName slds-input" type='text' tabindex="0" role="folderName" placeholder="My Marker Layers..." />
                          </div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>

        <!-- FavoriteCreateLocation -->
        <div class="FavoriteCreateLocation slds-scope">
            <div class="slds-form-element updatefield-value-wrapper">
                <label class="slds-form-element__label">{!$Label.MA_Name}</label>
                <div class="slds-form-element__control updatefield-value">
                    <input maxlength='80' class='fav-location-name slds-input' type='text' />
                </div>
            </div>
            <div class="slds-form-element updatefield-value-wrapper">
                <label class="slds-form-element__label">{!$Label.MA_Address}</label>
                <div class="slds-form-element__control updatefield-value">
                    <select class='fav-location-address slds-input'></select>
                </div>
            </div>
            <div class="slds-form-element updatefield-value-wrapper">
                <label class="slds-form-element__label">{!$Label.MA_Description}</label>
                <div class="slds-form-element__control updatefield-value">
                    <textarea class='fav-location-description slds-input'></textarea>
                </div>
            </div>
            <div class="slds-form-element updatefield-value-wrapper">
                <label class="slds-form-element__label">{!$Label.MA_Marker}</label>
                <div class='slds-form-element__control'>
                    <div class="location-markertype-wrapper">
                        <input type='text' class='value color location-markertype-color slds-input' value='#00FF00' />
                        <select class='location-markertype-image slds-input' style='display: none;' disabled='disabled'><option value=''>{!$Label.MA_Loading}...</option></select>

                        <div class='location-markertype-selector' style='display: inline-block;'>
                            <img class='location-markertype-selector-color' src="{!URLFOR($Resource.QueryEditor, 'images/icons/color-16.png')}" />
                            <img class='location-markertype-selector-image' src="{!URLFOR($Resource.QueryEditor, 'images/icons/iconfolder-16.png')}" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="UpdateFieldPopup slds-scope">
            <div class="slds-form slds-form_compound">
                <fieldset class="slds-form-element">
                    <div class="slds-form-element__group mass-row-update-group">
                        <div class="slds-grid slds-grid_vertical-align-end mass-update-row">
                            <div class="slds-form-element slds-m-right_small select2-form-element updatefield-query-wrapper">
                              <label class="slds-form-element__label" for="select-query">{!$Label.MA_Marker_Layer}</label>
                              <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                                <div class="slds-select_container">
                                  <select class="slds-select updatefield-query select2-fluid select2-input select2-input-hide-search" onchange='UpdateField_QueryChanged(this);' id="select-query"></select>
                                </div>
                              </div>
                            </div>
                            <div class="slds-form-element slds-m-right_small select2-form-element updatefield-field-wrapper" style="display:none;">
                              <label class="slds-form-element__label" for="select-field">{!$Label.MA_Field}</label>
                              <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                                <div class="slds-select_container">
                                  <select class="slds-select updatefield-field select2-fluid select2-input select2-input-hide-search" id="select-field" onchange='UpdateField_FieldChanged(this);'></select>
                                </div>
                              </div>
                            </div>
                            <div class="slds-form-element slds-p-right_xx-small updatefield-value-wrapper" style="display:none;">
                                <label class="slds-form-element__label" for="input-601">Value</label>
                                <div id="input-601" class="slds-form-element__control updatefield-value">
              					</div>
                            </div>
                            <div class="slds-p-right_xx-small">
			    		        <button class="slds-button slds-button_icon slds-button_icon-container remove-mass-update-row" title="Remove">
			    		          <span class="slds-button__icon slds-button__icon_hint slds-button__icon_small icon ma-icon-close"></span>
			    		          <span class="slds-assistive-text">Remove</span>
			    		        </button>
			    	       	</div>
                        </div>
                    </div>
                </fieldset>
            </div>
            <button class="slds-button slds-button_neutral" onclick="UpdateField_AddNewRow();">
            	<span class="slds-button__icon slds-button__icon_left ma-icon ma-icon-add add-mass-update"></span>Add Field
            </button>



            <!--<div class="slds-form-element updatefield-value-wrapper" style="display:none;">
              <label class="slds-form-element__label">{!$Label.MA_Value}</label>
              <div class="slds-form-element__control updatefield-value">

              </div>
            </div>-->

            <div class="slds-form-element autoRefreshWrapper" style="display:none;">
                <label class="slds-form-element__label">Automatically refresh this query after completion?</label>
                <input type="checkbox" class="autoRefreshQuery"/>
            </div>
        </div>
		<!--updateFields datetime template>-->
		<div id="updateFields-datetime-template">
			<div class="slds-col date-time-col">
                <div class="slds-grid slds-grid_vertical-align-center">
                    <div class="slds-select_container">
                        <select class="slds-select hr" title="Hour">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                        </select>
                    </div>
                    <!--<div class="time-duration-units">hrs</div>-->
                    <div class="slds-select_container">
                        <select class="slds-select min" title="Minute">
                            <option value="0">0</option>
                            <option value="5">5</option>
                            <option value="10">10</option>
                            <option value="15">15</option>
                            <option value="20">20</option>
                            <option value="25">25</option>
                            <option value="30">30</option>
                            <option value="35">35</option>
                            <option value="40">40</option>
                            <option value="45">45</option>
                            <option value="50">50</option>
                            <option value="55">55</option>
                        </select>
                    </div>
                    <!--<div class="time-duration-units">mins</div>-->
                    <div class="slds-select_container ">
                        <select class="slds-select am-pm" title="AM/PM">
                            <option value="AM">AM</option>
                            <option value="PM">PM</option>
                        </select>
                    </div>
                </div>
            </div>

		</div>

         <!-- Listview Tab Contents -->
        <div id="ListViewTabContents">
            <div class="listview-search slds-grid" >
                <div class="listview-search-wrap slds-grid slds-m-right_x-small">
                <span class="glyphicon glyphicon-search"></span>
                <input type="text" class="listview-search-text form-control input-sm" placeholder="{!$Label.MA_Search_for}..." />
                <a onclick="MAListView.SearchAll(this)" role="search" class="btn btn-sm btn-dark" >{!$Label.MA_Search}</a>
                <a onclick="MAListView.ClearSearchFromDOM(this)" role="clear" class="lv-search-clear" ><span class="MAIcon glyphicon-remove-circle"></span></a>
                </div>
                <a class="lv-search-advanced" onclick="MAListView.ShowFilterPopupFromDOM(this)" >{!$Label.MA_Advanced_Search}...</a>
            </div>
            <div id="listview-table-scrollwrap" class="slds-is-relative">
                <table class="listview-data-table"></table>
            </div>
            <div class="listview-footer-actions slds-p-horizontal_medium slds-p-vertical_x-small slds-grid slds-grid_vertical-align-center">
                <div class="with-selected-wrapper slds-p-right_x-small">
                    {!$Label.MA_with} (0) {!$Label.MA_selected}
                </div>
                <div class="mass-action-wrapper slds-p-right_x-small">
                    <div class="slds-form-element">
                        <div class="slds-form-element__control">
                            <div class="slds-select_container">
                                <select class="slds-select" id="select-01">
                                    <option value="none">{!$Label.MA_Select_an_Option}</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slds-p-right_x-small">
                    <button class="slds-button slds-button_neutral" onclick="MAListView.performMassAction('::layerId::');">
                        Apply
                    </button>
                </div>
                <div class="slds-p-right_x-small">
                    <button class="slds-button" onclick="MAListView.ClearSelected('::layerId::');">
                        {!$Label.MA_Clear_Selected}
                    </button>
                </div>
                <div class="slds-p-right_small slds-col_bump-left">
                    <span class="listview-record-count"></span>
                </div>
                <div class="slds-p-right_xx-small">{!$Label.MA_Records_Page}:</div>
                <div class="slds-p-right_small">
                    <select class="slds-select lv-records-per-page" onchange="MAListView.ChangePageSizeFromUI('::layerId::', this.value);">
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="30">30</option>
                        <option value="40">40</option>
                        <option value="50">50</option>
                    </select>
                    </div>
                <div>
                    <div class="slds-button-group">
                        <div class="slds-button slds-button_icon slds-button_icon-border-filled list-view-footer-doubleicon" onclick="MAListView.MoveToFirstPage('::layerId::');">
                            <span class="slds-button__icon ma-icon ma-icon-left"></span>
                            <span class="slds-button__icon ma-icon ma-icon-left"></span>
                        </div>
                        <div class="slds-button slds-button_icon slds-button_icon-border-filled" onclick="MAListView.PageBackward('::layerId::');">
                            <span class="slds-button__icon ma-icon ma-icon-left"></span>
                        </div>
                        <div class="slds-button slds-button_icon slds-button_icon-border-filled" onclick="MAListView.PageForward('::layerId::');">
                            <span class="slds-button__icon ma-icon ma-icon-right"></span>
                        </div>
                        <div class="slds-button slds-button_icon slds-button_icon-border-filled list-view-footer-doubleicon" onclick="MAListView.MoveToLastPage('::layerId::');">
                            <span class="slds-button__icon ma-icon ma-icon-right"></span>
                            <span class="slds-button__icon ma-icon ma-icon-right"></span>
                        </div>
                    </div>
                </div>
                <div>
                    <apex:outputPanel rendered="{!allowExports}">
                        <button class="slds-button slds-button_neutral" onclick="MAListView.ExportTab.apply(this, ['::layerId::']);">
                            <span class="slds-button__icon slds-button__icon_left ma-icon ma-icon-export"></span>
                            {!$Label.MA_Export}
                        </button>
                    </apex:outputPanel>
                </div>
            </div><!--listview-footer-actions-->
        </div>

        <!-- DataLayer Editor-->
        <div class="popup_block maPopup noPadding" id="MADataLayerEditor">
            <div id="getLayerLoading" style="display:none;">
                <div class="MA2-loading-mask">
                     <div style="" class="loadingText">
                    <div class="MA2-loader loader-inline"></div>
                    Loading...
                    </div>
                </div>
                 </div>
            <div class="maPopupLoading2" style="z-index:10;left:0;top:0;background:transparent !important;opacity:1 !important;">
                <div class="MA2-loading-mask">
                     <div style="" class="loadingText">
                    <div class="MA2-loader loader-inline"></div>
                    Loading...
                    </div>
                </div>
            </div>
            <div class="popup_header">
                <div class="header-item">
                    <div class="item">{!$Label.MA_DATA_LAYER_EDITOR}</div>
                </div>
                <button class="ma-modal-close" onclick="MAData.wizard.closePopup();"><i class="ion-close"></i></button>
            </div>

            <div class="popup_body">
                <!-- wizard -->
                <div id="dl-leftPanel" class="sidebar">
                    <div class="verticalMenu">
                        <a class="item active" onclick="MAData.wizard.changeTab(this)" id="dl-details">{!$Label.MA_NAME_YOUR_LAYER}</a>
                        <a class="item" onclick="MAData.wizard.changeTab(this)" id="dl-dataSource">{!$Label.MA_CHOOSE_DATA_SOURCE}</a>
                        <a class="item" onclick="MAData.wizard.changeTab(this)" id="dl-filtersFix">{!$Label.MA_FILTER_YOUR_LAYER}</a>
                        <a class="item" onclick="MAData.wizard.changeTab(this)" id="dl-tooltip">{!$Label.MA_ADD_DATA_TO_TOOLTIP}</a>
                        <a class="item" onclick="MAData.wizard.changeTab(this)" id="dl-filters">{!$Label.MA_STYLE_YOUR_LAYER}</a>
                    </div>
                </div>
                <div id="dl-rightPanel" class="mainBody">
                    <div data-id="dl-details" class="dl-panel tab-body MA2hidden MA2active">
                        <table class="MA2-pad-15">
                            <tr><td class="fieldLabel">{!$Label.MA_Name}*</td></tr>
                            <tr><td><input class="dl-label" type="text" id="data-layer-name"/></td></tr>
                            <tr><td class="fieldLabel">{!$Label.MA_Description}</td></tr>
                            <tr><td><textarea class="dl-desc" type="text"/></td></tr>
                        </table>
                        <div class="next-DataSource MA2hidden">
                            <div class="MA2-divider-compact"></div>
                            <div class="MA2-pad-15">
                                <button onclick="MAData.wizard.changeTab($('#dl-dataSource'))" class="MAbutton button-bold button-green icon-right iconfix ion-arrow-right-b">{!$Label.MA_NEXT_STEP}</button>
                            </div>
                        </div>
                    </div>
                    <!-- Data Source for Data Layer -->
                    <div data-id="dl-dataSource" class="dl-panel MA2hidden tab-body">
                        <div class="MA2-pad-15">
                            <form>
                                <div id="dl-source" class="dl-items">
                                    <div class="dl-item">
                                        <div class="dl-number">
                                            <span class="grey-circle">1</span>
                                        </div>
                                        <div class="dl-content">
                                            <div class="source-label">{!$Label.MA_WHAT_DATA_SOURCE_WOULD_YOU_LIKE_TO_SEE}</div>
                                            <div id="dl-grid" style="display: flex; align-items: center">
                                                <div id="dl-source-wrapper">
                                                    <select id="dl-source-select" class="dl-combobox">
                                                        <option value="--">{!$Label.MA_Loading}...</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="dl-level" class="dl-items MA2hidden">
                                    <div class="dl-item" style="height: 70px;">
                                        <div class="dl-number">
                                            <span class="grey-circle">2</span>
                                        </div>
                                        <div class="dl-content">
                                            <div class="source-label">{!$Label.MA_AT_WHAT_LEVEL_OF_DETAIL}</div>
                                            <div id="dl-level-wrapper">
                                                <select id="dl-level-select" class="dl-combobox">
                                                    <option value="--">-- Select --</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="dl-style" class="dl-items MA2hidden" style="overflow: hidden;min-height: 280px;">
                                    <div class="dl-item">
                                        <div class="dl-number">
                                            <span class="grey-circle">3</span>
                                        </div>
                                        <div class="dl-content">
                                            <div class="source-label">{!$Label.MA_WHAT_VISUAL_STYLE_WOULD_YOU_LIKE_TO_SEE}</div>
                                        </div>
                                    </div>
                                    <div class="dl-cards">
                                        <div id="cardShape" data-id="polygon" class="dl-card hidden" onclick="MAData.selectDataLayerStyle(this);">
                                            <div class="MAIcon ion-ios-checkmark"></div>
                                            <div class="image">
                                                <img src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/datathumb_shape.jpg')}"/>
                                            </div>
                                            <div class="content">
                                                <div class="header">{!$Label.MA_SHAPE}</div>
                                                <div class="info">{!$Label.MA_A_DEFINED_ENCLOSED_AREA_EG_A_STATE_OR_COUNTRY}</div>
                                            </div>
                                        </div>
                                        <div id="cardMarker" data-id="point" class="dl-card hidden" onclick="MAData.selectDataLayerStyle(this);">
                                            <div class="MAIcon ion-ios-checkmark"></div>
                                            <div class="image">
                                                <img src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/datathumb_marker.jpg')}"/>
                                            </div>
                                            <div class="content">
                                                <div class="header">{!$Label.MA_Marker}</div>
                                            </div>
                                        </div>
                                        <div id="cardShape" data-id="centroid" class="dl-card hidden" onclick="MAData.selectDataLayerStyle(this);">
                                            <div class="MAIcon ion-ios-checkmark"></div>
                                            <div class="image">
                                                <img src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/datathumb_centroid.jpg')}"/>
                                            </div>
                                            <div class="content">
                                                <div class="header">Centroid</div>
                                                <div class="info">A single marker representing the center of an area. &#40;e.g. a marker at the center of a state&#41;</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="next-Tooltip MA2hidden">
                            <div class="MA2-divider-compact"></div>
                            <div class="MA2-pad-15">
                                <div class="greyBox MA2-pad-15" style="width: 400px;background: #f8f8f9;border-radius: .28571429rem;box-shadow: 0 0 0 1px rgba(34,36,38,.22) inset,0 0 0 0 transparent;">
                                    <div class="inline">
                                        <div style="font-size:16px;font-weight: bold;">{!$Label.MA_Great}!</div>
                                        <div style="margin-top: .25em;opacity: 0.75;">{!$Label.MA_Move_Next_Step}.</div>
                                    </div>
                                    <button style="float: right;" onclick="MAData.wizard.changeTab($('#dl-filtersFix'))" class="MAbutton button-bold button-green icon-right iconfix ion-arrow-right-b">Next Step</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- filters for data layer -->
                    <div data-id="dl-filtersFix" class="dl-panel tab-body MA2hidden MA2active">
                        <div class="MA2-pad-15">
                            <div class="source-label">{!$Label.MA_FILTER_YOUR_LAYER}.</div>
                            <div>
                                <div class="dl-content" style="margin-top: 10px;">
                                    <div id="dl-filter-wrapper">
                                        <div id="dlFilters"></div>
                                        <div>
                                            <button onclick="MAData.wizard.createFilterRow();" id="addDLFilter" class="MAbutton icon-left iconfix ion-android-add-circle">{!$Label.MA_ADD_A_FILTER}</button>
                                            <span style="line-height: 30px;font-size: 12px;margin-left: 10px;">({!$Label.MA_OPTIONAL})</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Tooltips for Data Layer -->
                    <div data-id="dl-tooltip" class="dl-panel tab-body MA2hidden">
                        <div class="MA2-pad-15">
                            <div class="source-label">{!$Label.MA_ADD_THE_INFORMATION_YOUD_LIKE_TO_SEE_WHEN_YOU_CLICK}.</div>
                            <div>({!$Label.MA_EXAMPLE_TO_THE_RIGHT})</div>
                            <div style="min-width: 900px;">
                                <div class="inline tooltipMapBG">
                                    <div class="tooltipWrap" id="dl-tooltip-setup">
                                        <div class="MA2-pad-15-10" style="position:relative;">
                                            <div class="hearers-wrap"></div>
                                            <div style="margin-top:10px;">
                                                <button style="color: rgba(0,0,0,.6);" class="dl-headerBtn MAbutton button-small button-bold iconfix icon-left ion-android-add-circle" onclick="MAData.wizard.createToolipRow({element:this,type:'header'});">{!$Label.MA_ADD_A_HEADER}</button>
                                                <div class="dl-tooltip-help-wrapper dl-header-help">{!$Label.MA_ADD_THE_PRIMARY_SET_OF_DATA_YOUD_LIKE_TO_SEE}</div>
                                            </div>
                                        </div>
                                        <div style="padding: 5px 10px;">
                                            <div class="tabs-wrap">
                                                <div class="dl-tab active" uid="sampleTab23423" tab-index="1">
                                                    <div class="transparent input">
                                                        <input class="tab-name" onclick="MAData.wizard.handleTooltipClick(this);" type="text" value="{!$Label.MA_Info}"/>
                                                    </div>
                                                    <button class="MAbutton button-clear remove-tab ion-android-cancel" onclick="MAData.wizard.removeTooltipTab(this);"></button>
                                                </div>
                                            </div>
                                            <button onclick="MAData.wizard.createTooltipTab();" id="add-dl-tab" class="addDLTab button-bold MAbutton button-clear button-small iconfix icon-left ion-android-add-circle">{!$Label.MA_ADD_A_TAB}</button>
                                            <div class="tab-baseline"></div>
                                        </div>
                                        <div class="MA2-pad-15-10" id="dl-details-wrapper" style="position:relative;">
                                            <div class="details-wrap"></div>
                                            <div style="margin-top:10px;">
                                                <button style="color: rgba(0,0,0,.6);" class="dl-headerBtn MAbutton button-bold iconfix button-small icon-left ion-android-add-circle" onclick="MAData.wizard.createToolipRow({element:this,type:'tab'});">Add a detail</button>
                                                <div class="dl-tooltip-help-wrapper dl-details-help">{!$Label.MA_ADD_ADDITIONAL_SETS_OF_DATA_YOU_D_LIKE_TO_SEE_ON_THE_TOOLTIP}</div>
                                            </div>
                                        </div>
                                        <div class="tooltip-arrow"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Style the Data Layer -->
                    <div data-id="dl-filters" class="dl-panel tab-body MA2hidden">
                        <div class="MA2-pad-15" style="min-width: 750px;">
                            <div class="inline" style="width: 37.5%!important;vertical-align: top;">
                                <div>
                                    <div id="dl-useFilters" class="dl-items">
                                        <div class="dl-item">
                                            <div class="dl-number">
                                                <span class="grey-circle">1</span>
                                            </div>
                                            <div class="dl-content">
                                                <div class="source-label">{!$Label.MA_WOULD_YOU_LIKE_TO_COLOR_CODE_YOUR_SHAPES_BASED_ON}</div>
                                                <div style="margin-bottom: 15px;">({!$Label.MA_EXAMPLE_TO_THE_RIGHT})</div>
                                                <div id="styleSelectWrap">
                                                    <button onclick="MAData.wizard.styleSetup(true);" class="colorLegend styleDLbtn MAbutton iconfix icon-left ion-checkmark-circled">{!$Label.MA_Yes}</button>
                                                    <button onclick="MAData.wizard.styleSetup(false);" class="staticLegend styleDLbtn MAbutton iconfix icon-left iconfix ion-close-circled">{!$Label.MA_No}</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="dl-addFilters" class="dl-items MA2hidden" style="overflow: hidden;">
                                        <div class="dl-item">
                                            <div class="dl-number">
                                                <span class="grey-circle">2</span>
                                            </div>
                                            <div class="dl-content">
                                                <div class="source-label">{!$Label.MA_Select_Set_of_Info}.</div>
                                                <div class="dl-content">
                                                    <div id="dl-legendSelect-wrap">
                                                        <select id="dl-legendSelect" class="dl-combobox">
                                                            <option value="--">Loading...</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="dl-setupLegend" class="dl-items MA2hidden" style="overflow: hidden;">
                                        <div class="dl-item">
                                            <div class="dl-number">
                                                <span class="grey-circle">3</span>
                                            </div>
                                            <div class="dl-content">
                                                <div class="source-label">{!$Label.MA_Divide_Information}</div>
                                                <div class="dl-content">
                                                    <div id="legendDistButtons" class="MA2hidden MA2active">
                                                        <div data-type="decimal" data-id="auto" onclick="MAData.wizard.createLegendCheck(false,'auto');" class="dl-legitem auto"><span class="MAIcon ion-checkmark-circled"></span>{!$Label.MA_Automatically}</div>
                                                        <div data-type="decimal" data-id="quantiles" onclick="MAData.wizard.createLegendCheck(true,'quantiles');" class="dl-legitem quantiles"><span class="MAIcon ion-checkmark-circled"></span>{!$Label.MA_Even_Quantiles}</div>
                                                        <div data-type="decimal" data-id="distribution" onclick="MAData.wizard.createLegendCheck(true,'distribution');" class="dl-legitem distribution"><span class="MAIcon ion-checkmark-circled"></span>{!$Label.MA_Even_Distribution}</div>
                                                        <div data-id="manual" onclick="MAData.wizard.createLegendCheck(false,'manual');" class="dl-legitem manual"><span class="MAIcon ion-checkmark-circled"></span>{!$Label.MA_Manually}</div>
                                                    </div>
                                                    <div class="MA2hidden" id="dl-legend-options">
                                                        <div>
                                                            <div class="dl-legend-step2" id="dl-legend-minVal">
                                                                <div style="padding-top:0;" class="fieldLabel">{!$Label.MA_Minimum_value}:</div>
                                                                <div><input class="dl-legend-minVal" type="text"/></div>
                                                            </div>
                                                            <div class="dl-legend-step2" id="dl-legend-maxVal">
                                                                <div class="fieldLabel">{!$Label.MA_Maximum_value}:</div>
                                                                <div><input class="dl-legend-maxVal" type="text"/></div>
                                                            </div>
                                                            <div class="dl-legend-step2" id="dl-legend-buckets">
                                                                <div class="fieldLabel">{!$Label.MA_Number_of_buckets}:</div>
                                                                <div><input class="dl-legend-buckets" type="text"/></div>
                                                            </div>
                                                            <div style="padding: 10px 0px 6px 6px;">
                                                                <button id="cancelLegCreate" class="MAbutton iconfix icon-left ion-close-circled">{!$Label.MA_Cancel}</button>
                                                                <button onclick="MAData.wizard.createLegend('getType');" class="MAbutton button-green iconfix icon-left ion-checkmark-circled">{!$Label.MA_Create_Legend}</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="legendImagePlaceholder" class="inline">
                                <div class="legImgWrapper hidden" data-type="polygon">
                                    <img class="legendImg legendColor" data-type="colorPoly" src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/legend_example.jpg')}"/>
                                    <img class="legendImg hidden legendStatic" data-type="staticPoly" src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/legend_example_ncc.jpg')}"/>
                                </div>
                                <div class="legImgWrapper hidden" data-type="point">
                                    <img class="legendImg legendColor" data-type="colorPoint" src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/legend_marker_multiple.jpg')}"/>
                                    <img class="legendImg hidden legendStatic" data-type="staticPoint" src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/legend_marker_single.jpg')}"/>
                                </div>
                                <div style="padding-top: 15px; text-align: center;">
                                    <button onclick="MAData.wizard.updateSampleImage(this,'legendColor');" onmouseover="MAData.wizard.updateSampleImage(this,'legendColor');" style="border-color: transparent;font-weight: bold!important;min-width: 120px;padding: 4px 8px 3px;" class="MAbutton active legendSampleBtn legendColor button-silver ">{!$Label.MA_COLOR_CODED}</button>
                                    <button onclick="MAData.wizard.updateSampleImage(this,'legendStatic');" onmouseover="MAData.wizard.updateSampleImage(this,'legendStatic');" style="border-color: transparent;font-weight: bold!important;min-width: 120px;padding: 4px 8px 3px;" class="MAbutton legendSampleBtn legendStatic button-silver">{!$Label.MA_NOT_COLOR_CODED}</button>
                                </div>
                            </div>
                            <div id="dl-legend-wrap" class="hidden inline">
                                <div id="dl-legend-grid">
                                    <div class="dl-legend-header">
                                        <table>
                                            <tr>
                                                <td style="padding-top:0px;" class="fieldLabel">Title:</td>
                                                <td style="padding-top:0px;" class="fieldLabel">Subtitle:</td>
                                            </tr>
                                            <tr>
                                                <td><input style="width:80%;" class="dl-legend-title" type="text"/></td>
                                                <td><input style="width:80%;" class="dl-legend-subtitle" type="text"/></td>
                                                <td id="dl-addLegendRow-btn" class="hidden"><button style="min-width: 110px;" class="MA2button button-small icon icon-left ion-android-add-circle"  onclick="MAData.wizard.createLegendRow()">Add a Row</button></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="dl-legend-body">
                                        <div id="dl-legend-info-wrapper"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="dl-Done" class="MA2hidden">
                            <div class="MA2-divider-compact"></div>
                            <div class="MA2-pad-15">
                                <div class="greyBox MA2-pad-15 slds-scope" style="width: 430px;background: #f8f8f9;border-radius: .28571429rem;box-shadow: 0 0 0 1px rgba(34,36,38,.22) inset,0 0 0 0 transparent;">
                                    <div class="inline" style="margin-right: 65px;">
                                        <div style="font-size:16px;font-weight: bold;">{!$Label.MA_YOU_RE_FINSIHED}!</div>
                                    </div>
                                    <button class="slds-button slds-button_brand savePlotDataLayer" onclick="MAData.wizard.saveDataLayer(true)">{!$Label.MA_SAVE_AND_PLOT}</button>
                                    <button class="slds-button slds-button_brand saveDataLayer" onclick="MAData.wizard.saveDataLayer()">{!$Label.MA_Save}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer buttons -->
            <div class="popup_footer slds-scope">
                <div class="MA2-pad-10-15 MA2-clearfix">
                <div class="float-left">
                    <button style="display:none;" class="MA2button icon icon-left ion-help-circled">Help</button>
                </div>
                    <div class="notificationMsg float-left"></div>
                <div class="float-right">
                    <button class="slds-button slds-button_neutral" onclick="MAData.wizard.closePopup();">{!$Label.MA_Cancel}</button>
                    <button class="slds-button slds-button_brand savePlotDataLayer" onclick="MAData.wizard.saveDataLayer(true)">{!$Label.MA_SAVE_AND_PLOT}</button>
                    <button class="slds-button slds-button_brand saveDataLayer" onclick="MAData.wizard.saveDataLayer()">{!$Label.MA_Save}</button>
                </div>
                </div>
            </div>
        </div>

        <!-- ListView Filter Popup -->
        <div class="popup_block slds-scope" id="listview-filter-popup">
                <section class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header">
                            <h2 class="slds-text-heading_medium slds-hyphenate">List View: Advanced Search</h2>
                        </header>
                        <div class="slds-modal__content slds-p-around_medium">
                            <div class="lvas-scrollwrap">
                                <table id="listview-filters-table" cellpadding="1">
            
                                </table>
                            </div>
                        </div>
                        <footer class="slds-modal__footer">
                            <div class="inline button-wrapper slds-scope">
                                <a class="slds-button slds-button_neutral" onclick="MAListView.clearFilterPopup();">Clear</a>
                                <a class="slds-button slds-button_neutral" onclick="ClosePopupWindow();">Cancel</a>
                                <a class="slds-button slds-button_brand" onclick="MAListView.closeFilterPopup();">Save</a>
                            </div>
                        </footer>
                    </div>
                </section>
        </div>

        <!-- Directions Row Template -->
        <div id="DirectionsTemplate">
            <table>
                <tr class='directions-waypoint-row'>
                    <td class='name'></td>
                </tr>
                <tr class='directions-row'>
                    <td class='index'></td>
                    <td><img class='directions-image'/></td>
                    <td class='directions'></td>
                </tr>
            </table>
        </div>


        <!-- Current Location Weather Template -->
        <div id="CurrentLocationWeatherTemplate">

            <b style="font-size:18px;">{!$Label.MA_Current_Forecast}</b>

            <table border="0" style="width:400px; margin-bottom:20px;">
                <tr>
                    <td style="font-weight:bold; font-size: 14px;" colspan="3">::weather::</td>
                </tr>
                <tr>
                    <td style="width:120px; vertical-align:middle;">
                        ::icon::
                    </td>
                    <td style="text-align:center; vertical-align:middle;">
                        <span style="font-weight:bold; font-size: 20px;">::avgTempF::&deg;F</span>
                        <br />{!$Label.MA_Feels_Like} ::feelslikeF::&deg;F
                    </td>
                    <td>
                        <table border="0" cellpadding="3" cellspacing="0">
                            <tr>
                                <td><b>{!$Label.MA_High}</b></td>
                                <td>::maxTempF::&deg;F (::maxTempC::&deg;C)</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MA_Low}</b></td>
                                <td>::minTempF::&deg;F (::minTempC::&deg;C)</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MA_Precipitation}</b></td>
                                <td>::pop::%</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MAWeather_Humidity}</b></td>
                                <td>::humidity::%</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MAWeather_Winds}</b></td>
                                <td>::windDir:: at ::windSpeedMPH:: mph</td>
                            </tr>

                        </table>
                    </td>


                </tr>

            </table>

            <b style="font-size:18px;">{!$Label.MA_Future_Forecast}</b>
        </div>

        <!-- Location Weather Template -->
        <div id="LocationWeatherTemplate">
            <table border="0" style="border-bottom: 1px solid black; width:400px;">
                <tr>
                    <td style="width:120px; vertical-align:middle;">::icon::</td>
                    <td>
                        <table border="0" cellpadding="3" cellspacing="0">
                            <tr>
                                <td colspan="4" style="font-weight:bold; font-size: 14px;">
                                    ::date::
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4">
                                    ::weather::
                                </td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MA_High}</b></td>
                                <td>::maxTempF::&deg;F (::maxTempC::&deg;C)</td>
                                <td style="padding-left:10px;"><b>{!$Label.MA_Precipitation}</b></td>
                                <td>::pop::%</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MA_Low}</b></td>
                                <td>::minTempF::&deg;F (::minTempC::&deg;C)</td>
                                <td style="padding-left:10px;"><b>{!$Label.MAWeather_Humidity}</b></td>
                                <td>::humidity::%</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MAWeather_Winds}</b></td>
                                <td colspan="3">::windDir:: at ::windSpeedMPH:: mph</td>
                            </tr>

                        </table>

                    </td>


                </tr>

            </table>

        </div>

        <!--ArcGIS ServerLogin Template -->

        <div class="slds-form slds-form_stacked arcgis-server-login">
		  <div class="slds-form-element">
		    <label class="slds-form-element__label " for="input-id-01">Username</label>
		    <div class="slds-form-element__control">
		      <input type="text" id="input-id-user" class="slds-input arc-server-username" placeholder="Username" />
		    </div>
		  </div>
		  <div class="slds-form-element">
		    <label class="slds-form-element__label " for="input-id-01">Password</label>
		    <div class="slds-form-element__control">
		      <input type="password" id="input-id-password" class="slds-input arc-server-password" placeholder="Password" />
		    </div>
		  </div>
        </div>

        <!--arcGIS click to create configure input template-->
        <div id="arc-config-input-template">
            <div class='arc-config-input'>
				<div class="slds-form-element select2-form-element select2-form-element slds-form-element--has-hover-tooltip form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Template Name
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          				<input type="text" id="text-input-id-1" class="slds-input web-map-template-name" placeholder="Template Name" />
          			</div>
          			<div class="slds-popover slds-nubbin--left-top slds-popover--tooltip slds-popover--positioned-right-input-width-field" role="dialog">
          				<div class="slds-popover__body has-highlighted-text">
          					<p>Enter the name you would like to call this template.</p>
          				</div>
          			</div>
          		</div>
                <div class="slds-form-element select2-form-element select2-form-element slds-form-element--has-hover-tooltip form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Web Map Layer(s)
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select web-map-layer-select field-mapping-select" filteredBy="" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>

            				</select>
        				</div>
          			</div>
          			<div class="slds-popover slds-nubbin--left-top slds-popover--tooltip slds-popover--positioned-right-input-width-field" role="dialog">
          				<div class="slds-popover__body has-highlighted-text">
          					<p>Select the Web Map Layer you would like applied to this template</p>
          				</div>
          			</div>
          		</div>
          		<div class="slds-form-element select2-form-element form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Salesforce Object
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select select2-input salesforce-object-select" filteredBy="" placeholder="--Select--" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>
            				</select>
        				</div>
          			</div>
          		</div>
          		<div class="slds-form-element select2-form-element form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Record Type
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select select2-input record-type-select" filteredBy="" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>

            				</select>
        				</div>
          			</div>
          		</div>
          		<div class="slds-form-element select2-form-element form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Latitude
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select select2-input latitude-select" filteredBy="" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>

            				</select>
        				</div>
          			</div>
          		</div>
          		<div class="slds-form-element select2-form-element form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Longitude
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select select2-input longitude-select" filteredBy="" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>

            				</select>
        				</div>
          			</div>
          		</div>
          		<div class="slds-form-element select2-form-element form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Field Set
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select select2-input field-set-select field-mapping-select" filteredBy="" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>

            				</select>
        				</div>
          			</div>
          		</div>
          	</div>
  		</div>
  		<!--ArcGIS Click2Create Field Mappings Template-->
  		<div id="arc-field-mapping-template">
  			<div class="slds-form-element">
	    	   <label class="slds-form-element__label" for="">
	      		   <abbr class="slds-required" title="required">*</abbr>
	  			Field Mappings
	  		   </label>
	        </div>
            <div class='arc-field-mapping-input'>
                <article class="slds-card slds-p-around--medium disabled">
            		<div id="fieldMappingsContainer">
            			<table class="slds-table slds-table--cell-buffer slds-no-row-hover slds-table--rounded field-values-logic-table" id="visitFieldValuesLogicTable">
            			    <thead>
            					<tr>
            						<th scope="col" class="th-table-header">
            						    <div class="slds-text-title_caps">Salesforce Fields</div>
            						</th>
            						<th scope="col" class="th-table-header">
                                        <div class="slds-form-element--has-hover-tooltip">
                                            <span class="slds-text-title_caps">Editable</span>
                                            <button class="slds-button slds-button_icon">
                                                <span class="slds-icon slds-icon_x-small slds-icon-text-default ma-icon ma-icon-info" aria-hidden="true">
                                                <div class="slds-popover slds-popover--tooltip slds-popover--positioned-right-input-width-field slds-nubbin--top-left" role="tooltip" aria-live="polite">
                                                    <div class="slds-popover__body slds-text-longform">
                                                        <p>Allow users to edit fields when they use Click2Create.</p>
                                                    </div>
                                                </div>
                                                </span>
                                            </button>
                                        </div>
            						</th>
            						<th scope="col" class="th-table-header">
            						    <div class="slds-text-title_caps">ArcGIS Fields</div>
            						</th>
            					</tr>
            				</thead>
            			    <tbody>

            			    </tbody>
                        </table>
            		</div>
            	</article>
            	<button id="createArcTemplate" class="slds-button slds-button_success slds-m-top_medium slds-m-bottom_medium">Create template</button>
            </div>
  		    <table>
            	<tr class='field-match-row template'>
    	            <td>
    	                <div class="static-field">::sObjectField::</div>
    	            </td>
                    <td>
                        <div class="slds-form-element">
                            <label class="slds-checkbox_toggle slds-grid">
                                <input type="checkbox" class="field-editable" name="checkbox" aria-describedby="toggle-desc" checked=""></input>
                                <span id="toggle-desc" class="slds-checkbox_faux_container" aria-live="assertive">
                                    <span class="slds-checkbox_faux"></span>
                                </span>
                            </label>
                        </div>
    	            </td>
    	            <td>
    	              <div class="slds-form-element select2-form-element">
    	                <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
        	  			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                            <div class="slds-select_container">
        	    		        <select id="" class="select2-fluid slds-select select2-input-template webmap-field-select" filteredBy="" data-api="">
        	    				    <option value="" selected="selected">--Select--</option>

        	    				</select>
        					</div>
        	  			</div>
        	  		  </div>
    	            </td>
    	        </tr>
    	   </table>

  		<!--this is the template for arcGIS click2create template rows.-->
      		<table>
      		    <tr class="click-2-create-template-row">
                  <td role="gridcell" style="width:3.25rem;">
    		        <div class="slds-form-element">
                        <label class="slds-checkbox_toggle slds-grid">
                          <input type="checkbox" class="webmap-active" name="checkbox" aria-describedby="toggle-desc" checked=""></input>
                          <span id="toggle-desc" class="slds-checkbox_faux_container" aria-live="assertive">
                            <span class="slds-checkbox_faux"></span>
                          </span>
                        </label>
                      </div>
    	       	  </td>
    	       	  <td scope="row" data-label="Template Name">
                    <div class="slds-truncate template-name" title="::templateName::">
                      <div style="color:#0070d2">::templateName::</div>
                    </div>
                  </td>
                  <td scope="row" data-label="Web Map Layers">
                    <div class="slds-truncate web-map-layers" title="::webMapLayer::">
                      <div style="color:#0070d2">::webMapLayer::</div>
                    </div>
                  </td>
                  <td data-label="Salesforce Object">
                    <div class="slds-truncate salesforce-object" title="::salesforceObject::">::salesForceObject::</div>
                  </td>
                  <td data-label="Record Type">
                    <div class="slds-truncate record-type" title="::recordType::">::recordType::</div>
                  </td>
                  <td data-label="Field Set">
                    <div class="slds-truncate field-set" title="::fieldSet::">::fieldSet::</div>
                  </td>
                  <td role="gridcell" style="width:3.25rem;">
    		        <button class="slds-button slds-button_icon slds-button_icon-x-small edit-template" title="Edit">
    		          <span class="slds-button__icon slds-button__icon_hint slds-button__icon_small icon ma-icon-edit"></span>
    		          <span class="slds-assistive-text">Edit</span>
    		        </button>
    		      </td>
    	      	  <td role="gridcell" style="width:3.25rem;">
    		        <button class="slds-button slds-button_icon slds-button_icon-x-small delete-template" title="Delete">
    		          <span class="slds-button__icon slds-button__icon_hint slds-button__icon_small icon ma-icon-close"></span>
    		          <span class="slds-assistive-text">Delete</span>
    		        </button>
    	       	  </td>
                </tr>
  		    </table>
  		</div>

        <!-- Ruler Start Waypoint Template -->
        <div class="ruler-start-waypoint-row">
            <div><p><span class="ruler-waypoint-row-address"></span></p></div>
        </div>

        <!-- Ruler Waypoint Template -->
        <div class="ruler-waypoint-row">
            <div><p><span class="ruler-waypoint-row-address"></span></p></div>
            <div class="ruler-waypoint-row-icon ruler-waypoint-row-icon-drive"><img class="ruler-drive-icon" src="{!URLFOR($Resource.MapAnything,'/images/ruler/icon_drive.svg')}" /><p><span class="ruler-waypoint-row-drive-info"></span></p></div>
            <div class="ruler-waypoint-row-icon"><img class="ruler-straightline-icon" src="{!URLFOR($Resource.MapAnything,'/images/ruler/icon_straightline.svg')}" /><p><span class="ruler-waypoint-row-straight-info"></span></p></div>
        </div>

        <!-- Grid Templates -->
        <table>
            <tr class='permissions-row'>
                <td class="permission-type" style="text-align:left;"></td>
                <td class="permission-for" style="text-align:left"></td>
                <td class="permission-read"><input type="checkbox" class="autosave" data-field="Read__c" /></td>
                <td class="permission-create"><input type="checkbox" class="autosave" data-field="Create__c" /></td>
                <td class="permission-modify"><input type="checkbox" class="autosave" data-field="Modify__c" /></td>
                <td class="permission-delete"><input type="checkbox" class="autosave" data-field="Delete__c" /></td>
                <td class="permission-setperm"><input type="checkbox" class="autosave" data-field="SetPermissions__c" /></td>
                <td class="permission-delete"><a href="#">{!$Label.MA_Delete}</a></td>
            </tr>
            <tr class='campaign-row'>
                <td><input type='checkbox' class='campaign-checkbox' /></td>
                <td class='campaign-name'></td>
                <td class='campaign-type'></td>
                <td class='campaign-status'></td>
                <td class='campaign-startdate'></td>
                <td class='campaign-enddate'></td>
                <td class='campaign-leads'></td>
                <td class='campaign-contacts'></td>
                <td class='campaign-responses'></td>
            </tr>
            <tr class='campaign-options-row'>
                <td class='campaign-name'></td>
                <td class='campaign-status'>
                    <div class="ma-form-control icon-right">
                        <i class="MAIcon ion-arrow-down-b inset-icon--right" style="font-size: 20px;top: 5px;"></i>
                        <select class="ma-input"></select>
                    </div>
                </td>
                <td class='campaign-override'><input type='checkbox' /></td>
            </tr>
            <tr class='changeowner-row'>
                <td class='user-name'></td>
            </tr>
        </table>

        <!-- Loader Template -->
        <img class='loader' src="{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}" style="display: none;"/>

        <!-- LinkedIn Cluter Template -->
        <div class='linkedin-cluster-tooltip'>
            <div class='linkedin-cluster-header'></div>

            <div class='linkedin-cluster-table-wrapper'>
                <table class='linkedin-cluster-table'></table>
            </div>
        </div>

        <!-- Address Favorite Row Template -->
        <table>
            <tr style='display: block; border-bottom: 1px solid silver;' class='fav-row-folder template'>
                <td><input type='checkbox' class='fav-check'/></td>
                <td style='padding-right: 20px;' class='fav-title favrow'></td>
                <td class='fav-modified favrow'></td>
            </tr>
        </table>

        <!-- LinkedIn Row Template -->
        <table>
            <tr class='linkedin-row'>
                <td class='linkedin-picture'></td>
                <td class='linkedin-info'>
                    <div class='linkedin-name'></div>
                    <div class='linkedin-headline'></div>
                    <div class='linkedin-industry'></div>
                </td>
                <td class='linkedin-actions'>
                    <button class='linkedin-actions-createlead' onclick='linkedIn_CreateLead($(this).closest(".linkedin-row"));'>{!$Label.MA_Create_Lead}</button>
                    <button class='linkedin-actions-connect' onclick='linkedIn_Connect($(this).closest(".linkedin-row"));'>{!$Label.MA_Connect}</button>
                    <button class='linkedin-actions-getintroduced' onclick='linkedIn_GetIntroduced($(this).closest(".linkedin-row"));'>{!$Label.MA_Get_Introduced}</button>
                    <button class='linkedin-actions-inmail' onclick='linkedIn_SendInMail($(this).closest(".linkedin-row"));'>{!$Label.MA_Send_InMail}</button>
                    <button class='linkedin-actions-message' onclick='linkedIn_SendMessage($(this).closest(".linkedin-row"));'>{!$Label.MA_Send_Message}</button>
                    <button class='linkedin-actions-addtotrip' onclick='linkedIn_AddToTrip($(this).closest(".linkedin-row"));'>{!$Label.MAActionFramework_Add_to_Trip}</button>
                </td>
                <td class='linkedin-companyactions' style='display: none;'>
                    <button class='linkedin-actions-createaccount' onclick='linkedIn_CreateAccount($(this).closest(".linkedin-row"));'>{!$Label.MA_Create_Account}</button>
                    <button class='linkedin-actions-addtotrip' onclick='linkedIn_AddToTrip($(this).closest(".linkedin-row"));'>{!$Label.MAActionFramework_Add_to_Trip}</button>
                </td>
            </tr>
        </table>

        <!-- LinkedIn Filter Template -->
        <div class='linkedin-filter'>
            <select>
                <option value='keywords'>{!$Label.MA_Keywords}</option>
                <option value='first-name'>{!$Label.MA_First_Name}</option>
                <option value='last-name'>{!$Label.MA_Last_Name}</option>
                <option value='company-name'>{!$Label.MA_Company_Name}</option>
                <option value='title'>{!$Label.MA_Title}</option>
                <option value='school-name'>{!$Label.MA_School_Name}</option>
            </select>
            <input type='text' />
        </div>

        <!-- Waypoint Tooltip -->
        <div id='waypoint-content-template'>
            <h2 class='name'></h2>
            <div class='address' style="margin-bottom: 20px"></div>
            <div class='notes'></div>
            <div class='footer'>
                ***{!$Label.MA_MANUALLY_ENTER_WAYPOINT_MESSAGE}.
                <div class="layout-tooltip">
                    <div class="buttonset-section-columns">
                        <div class="buttoncolumn">
                            <div class="actionbutton" data-action="Take Me There" data-type="Standard Action">{!$Label.MAActionFramework_Take_Me_There}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Standard Cluster Template -->
        <div class='standard-cluster-tooltip'>

            <!-- Header -->
            <b><div class='standard-cluster-header' style='border-bottom: 1px solid rgb(141, 141, 141); font-size: 105%;'></div></b>
            <div class='cluster-listview-button'></div>

            <!-- Buttons -->
            <div class='standard-cluster-buttons-wrapper'>
                <table class='standard-cluster-buttons-table'>
                    <tr>
                        <td><button>{!$Label.MA_Zoom_To_Markers}</button></td>
                        <td class="drawpolygon"><button>{!$Label.MA_Draw_Polygon}</button></td>
                    </tr>
                </table>
            </div>

            <!-- Content -->
            <div class='standard-cluster-content-wrapper' style='min-height: 10px; overflow-y: auto; min-width: 400px; max-width: 700px; padding: 10px 0px 10px 5px;'>

            </div>

        </div>





        <!-- Cluster Row Template -->
        <table>
            <tr class='cluster-row'>
                <td class='cluster-info'>
                    <div class='cluster-id'>::Id::</div>
                </td>
            </tr>
        </table>

        <!-- Marker Search Results Row Template -->
        <div class='search-row results template'>
            <div class='image-replace'></div>
            <div class='search-text'>::result::</div>
        </div>

        <!-- Button Set Section Template -->
        <div class='buttonset-section'>
            <div class='buttonset-section-header'></div>
            <div class='buttonset-section-columns'>
                <div class='buttoncolumn'></div>
                <div class='buttoncolumn'></div>
                <div class='buttoncolumn'></div>
            </div>
        </div>

        <!-- Routes Sidebar Template -->
        <div class="routes-row template" style='position: relative; cursor:pointer; padding: 5px; border-bottom: 1px solid silver;'>
        	<div class="routes-day" style="font-size:11px; padding: 8px 0 0 0; float: left; height: 25px; width: 25px; font-weight: bold; margin-left: 8px; position: relative; top: 7px; background:url('{!URLFOR($Resource.MapAnything, '/images/ui-icons/calenderb.png')}') no-repeat; background-size: 25px; text-align: center;"></div>
	    	<div class="routes-name" style="font-size:12px; padding: 0 30px 0 45px; font-weight: bold; color: #2265bb;"></div>
	    	<div class="deleteDiv" onclick="dontDisplay = true; deleteRouteConfirm(this); return false;">X</div>
	    	<div class="routes-start" style="font-size:11px; padding: 0 30px 0 45px;"></div>
	    	<div class="routes-end" style="font-size:11px; padding: 0 30px 0 45px;"></div>
	    	<div class="routes-total" style="font-size:11px; padding: 0 30px 0 45px;"></div>
    	</div>

        <!--ArcGIS TooltipTemplates-->
        <div class="tooltipTemplate">
            <div class="slds-scope slds-info-window-wrapper" id="tooltip-content">
            	<div class="tooltip-wrap">
            		<div class="tooltip-header">
            			<!--<h5 class="infowindow-header-layer-name">::ArcLayer::</h5>-->
            			<!--<h3 class="infowindow-header-record-name slds-truncate slds-text-heading--small"><a href="javascript:void(0);">::LayerName::</a></h3>-->
            			<div class="infowindow-header-record-name slds-truncate savedQueryName">::LayerName::</div>
            			<!--<p class="infowindow-header-record-address">
            				<span class="ma-icon ma-icon-checkin slds-icon slds-icon--x-small"></span> 5000 Westpark Drive #320, Charlotte, NC 28202
            			</p>-->
            		</div>
            		<div class="tooltip-tabs-nav-wrap">
            			<div class="slds-tabs--default">
            				<ul class="slds-tabs--default__nav slds-tabs--default__nav--small infowindow-master-tabs" role="tablist">
            					<li class="slds-tabs--default__item slds-active" onclick="toggleArcGISTab(this);ArcGIS.runInfoWindowAdjust();" title="Details" role="presentation" data-tab="infowindowMasterTabContentDetails">
            						<a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-1" id="maForArcGISInfoWindowDetail_Item">Details</a>
            					</li>
            					<li class="slds-tabs--default__item" onclick="toggleArcGISTab(this);ArcGIS.runInfoWindowAdjust();" title="Actions" role="presentation" data-tab="infowindowMasterTabContentActions">
            						<a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="true" aria-controls="tab-scoped-2" id="maForArcGISInfoWindowAction_Item">Actions</a>
            					</li>
            					<li class="slds-tabs--default__item" title="Aggregate" role="presentation" data-tab="infowindowMasterTabContentAggregate">
            						<a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="true" aria-controls="tab-scoped-3" id="maForArcGISInfoWindowAggregate_Item">Aggregate</a>
            					</li>
            				</ul>
            				<div id="infowindowMasterTabContentDetails" class="slds-tabs--default__content slds-show" role="tabpanel">
            					<div class="tooltip-body padded">
            						<table class="tooltip-table">
            							<tbody class="tooltip-bodyrows">
            								<!--<tr class="tooltip-row template">
            									<td><span class="tooltip-label">/::fieldInfoLabel::/</span></td>
            									<td>::fieldInfoFieldName::</td>
            								</tr>-->
            							</tbody>
            						</table>
            					</div>
            				</div>
            				<div id="infowindowMasterTabContentActions" class="slds-tabs--default__content slds-hide old-infowindow-actions-wrap" role="tabpanel"></div>
                    	</div>
                    </div>
                </div>
            </div>
        </div>
        <!--ArcGIS tooltip row template-->
        <table>
        <tr class="tooltip-rowTemplate">
			<td><span class="tooltip-label"></span></td>
			<td class="tooltip-value"></td>
		</tr>
        </table>

		<!--UpdateFieldPopup rows-->
		<div id="updateFieldPopupRowTemplate">
			<div class="slds-grid slds-grid_vertical-align-end mass-update-row">

	                <div class="slds-form-element slds-m-right_small select2-form-element updatefield-query-wrapper">
	                  <label class="slds-form-element__label" for="select-query">{!$Label.MA_Marker_Layer}</label>
	                  <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
	                    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
	                    <div class="slds-select_container">
	                      <select class="slds-select updatefield-query select2-fluid select2-input select2-input-hide-search" onchange='UpdateField_QueryChanged(this);' id="select-query"></select>
	                    </div>
	                  </div>
	                </div>
	                <div class="slds-form-element slds-m-right_small select2-form-element updatefield-field-wrapper" style="display:none;">
	                  <label class="slds-form-element__label" for="select-field">{!$Label.MA_Field}</label>
	                  <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
	                    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
	                    <div class="slds-select_container">
	                      <select class="slds-select updatefield-field select2-fluid select2-input select2-input-hide-search" id="select-field" onchange='UpdateField_FieldChanged(this);'></select>
	                    </div>
	                  </div>
	                </div>
	                <div class="slds-form-element slds-p-right_xx-small updatefield-value-wrapper" style="display:none;">
	                    <label class="slds-form-element__label" for="input-601">Value</label>

	                    <div id="input-601" class="slds-form-element__control updatefield-value">

	  					</div>
	                </div>
	                <div class="slds-p-right_xx-small">
	    		        <button class="slds-button slds-button_icon slds-button_icon-container remove-mass-update-row" title="Remove">
	    		          <span class="slds-button__icon slds-button__icon_hint slds-button__icon_small icon ma-icon-close"></span>
	    		        </button>
	    	       	</div>
            </div>
		</div>

    	<!-- SVG Mag Glass -->
    	<svg style='display:none;' class='svg-mag-glass queryIcon' width="20" height="20" xmlns="http://www.w3.org/2000/svg">
			<g>
				<circle fill="__FILL_COLOR__" stroke="#f15a24" stroke-width="2.5" cx="11.17271" cy="8.81356" r="7.5" id="svg_mag1"/>
				<line fill="none" stroke="#f15a24" x1="-0.07837" y1="16.56372" x2="7.05023" y2="16.56372" id="svg_mag2" stroke-width="2.5" transform="rotate(135 3.485933780670165,16.563722610473633) "/>
			</g>
		</svg>

		<svg class='svg-circle-num' width="20" height="20" xmlns="http://www.w3.org/2000/svg">
			<g>
				<circle fill="#28a2ff" stroke="#f9f9f9" stroke-width="2" cx="10" cy="10" r="8.83163" id="svg_1"/>
				<text fill="#f9f9f9" stroke="#f9f9f9" stroke-width="0" x="8.3" y="10" id="svg_2" font-size="18" font-family="Monospace" text-anchor="middle" xml:space="preserve" transform="matrix(0.7992677323256553,0,0,0.6748139102469572,3.3995968056728256,7.2131973728906305) ">__TEXT__</text>
			</g>
		</svg>

		<!-- SVG Scatter - Circle -->
		<svg width="15" height="15" viewBox="0 0 15 15" class='svg-scatter-circle' xmlns="http://www.w3.org/2000/svg">
            <g>
                <ellipse stroke="__CIRCLE_FILL__" ry="6.97256" rx="6.972671" id="svg_1" cy="7.497071" cx="7.512866" fill="__GRADIENT_ONE__"/>
            </g>
        </svg>

        <!-- SVG Marker -->
        <svg class='svg-marker' width="28" height="42" viewBox="0 0 28 42" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <metadata>Created by potrace 1.11, written by Peter Selinger 2001-2013</metadata>
            <g>
                <path transform="rotate(180 13.5708 20.8542)" fill="__GRADIENT_ONE__" d="m6.300003,37.5c-4.300003,-3.399994 -5.900002,-8.5 -4.300003,-13.699997c1.700005,-5.800003 11.100006,-23.100006 12,-22.100006c1.400009,1.5 10.800003,20.800003 11.5,23.5c1,3.800003 -1.099991,9.300003 -4.599991,12.300003c-4.100006,3.400009 -10.200012,3.400009 -14.600006,0z" stroke="__CIRCLE_STROKE__"/>
                <circle stroke="__CIRCLE_STROKE__" r="4.5" cy="14" cx="13.5" stroke-width="2" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" fill="__CIRCLE_FILL__"/>
            </g>
        </svg>

        <!-- SVG Marker - Circle -->
        <svg class='svg-marker-circle' width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <g>
                <circle r="13" cy="14" cx="14" fill="__GRADIENT_ONE__" stroke="__CIRCLE_FILL__" stroke-width="1"/>
                <circle r="4.5" cy="14" cx="14" stroke-width="2" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" fill="__CIRCLE_FILL__" stroke="__CIRCLE_STROKE__"/>
            </g>
        </svg>

        <!-- SVG Marker - Triangle -->
        <svg class='svg-marker-triangle' width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <g>
                <path d="M0 28 L14 0 L28 28 Z" fill="__GRADIENT_ONE__" stroke="__CIRCLE_FILL__" stroke-width="1"/>
                <circle r="4.5" cy="18" cx="14" stroke-width="2" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" fill="__CIRCLE_FILL__" stroke="__CIRCLE_STROKE__"/>
            </g>
        </svg>

        <!-- SVG Marker - Square -->
        <svg class='svg-marker-square' width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <g>
                <path d="M0 0 L28 0 L28 28 L0 28 Z" fill="__GRADIENT_ONE__" stroke="__CIRCLE_FILL__" stroke-width="1"/>
                <circle r="4.5" cy="14" cx="14" stroke-width="2" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" fill="__CIRCLE_FILL__" stroke="__CIRCLE_STROKE__"/>
            </g>
        </svg>

        <!-- SVG Marker - Waypoint -->
        <svg class="svg-marker-waypoint" xmlns="http://www.w3.org/2000/svg" width="28" height="34.958" viewBox="0 0 28 34.958">
            <path d="M24,0H4A4,4,0,0,0,0,4V24a4,4,0,0,0,4,4H8.437L14,34.278,19.563,28H24a4,4,0,0,0,4-4V4A4,4,0,0,0,24,0Z" style="fill: __COLOR__"/>
            <path d="M24,0H4A4,4,0,0,0,0,4V24a4,4,0,0,0,4,4H8.437L14,34.278,19.563,28H24a4,4,0,0,0,4-4V4A4,4,0,0,0,24,0Zm3,24a3,3,0,0,1-3,3H19.112L14,32.771,8.887,27H4a3,3,0,0,1-3-3V4A3,3,0,0,1,4,1H24a3,3,0,0,1,3,3Z" style="opacity: 0.3199999928474426;isolation: isolate"/>

            <text text-anchor="middle" fill="#FFF" font-family="Salesforce Sans" font-size="13">
                <tspan x="14" y="18.312">__TEXT__</tspan>
            </text>
        </svg>

        <!-- SVG Marker - Waypoint Start -->
        <svg id="svgMarkerWaypointFirst" xmlns="http://www.w3.org/2000/svg" width="28" height="34.958" viewBox="0 0 28 34.958"><path d="M24,0H4A4,4,0,0,0,0,4V24a4,4,0,0,0,4,4H8.437L14,34.278,19.563,28H24a4,4,0,0,0,4-4V4A4,4,0,0,0,24,0Z" style="fill:#4bca81"/><path d="M24,0H4A4,4,0,0,0,0,4V24a4,4,0,0,0,4,4H8.437L14,34.278,19.563,28H24a4,4,0,0,0,4-4V4A4,4,0,0,0,24,0Zm3,24a3,3,0,0,1-3,3H19.112L14,32.771,8.887,27H4a3,3,0,0,1-3-3V4A3,3,0,0,1,4,1H24a3,3,0,0,1,3,3Z" style="opacity:0.3199999928474426;isolation:isolate"/><path d="M7,6A.945.945,0,0,0,6,7V20.8a1,1,0,0,0,2,0V7A1,1,0,0,0,7,6ZM21.3,7.5C17,9.7,13.7,5.9,9.6,7.4a.446.446,0,0,0-.3.4v7.3c0,.4.4.6.8.5,3.9-1.1,7.2,2.5,11.4.2a.55.55,0,0,0,.3-.5V7.7A.365.365,0,0,0,21.3,7.5Z" style="fill:#fff"/></svg>

        <!-- SVG Marker - Waypoint end/last/destination -->
        <svg id="svgMarkerWaypointLast" xmlns="http://www.w3.org/2000/svg" width="28" height="34.958" viewBox="0 0 28 34.958"><title>waypoint-finish-v2</title><path d="M24,0H4A4,4,0,0,0,0,4V24a4,4,0,0,0,4,4H8.437L14,34.278,19.563,28H24a4,4,0,0,0,4-4V4A4,4,0,0,0,24,0Z" style="fill:#061c3f"/><path d="M24,0H4A4,4,0,0,0,0,4V24a4,4,0,0,0,4,4H8.437L14,34.278,19.563,28H24a4,4,0,0,0,4-4V4A4,4,0,0,0,24,0Zm3,24a3,3,0,0,1-3,3H19.112L14,32.771,8.887,27H4a3,3,0,0,1-3-3V4A3,3,0,0,1,4,1H24a3,3,0,0,1,3,3Z" style="opacity:0.3199999928474426;isolation:isolate"/><path d="M6.983,5.9A.965.965,0,0,0,6,6.883V20.65a.984.984,0,0,0,1.967,0V6.883A.966.966,0,0,0,6.983,5.9ZM21.34,7.375C17.079,9.6,13.7,5.769,9.671,7.244a.563.563,0,0,0-.393.492v7.342a.591.591,0,0,0,.754.524c3.867-1.147,7.211,2.491,11.406.2a.554.554,0,0,0,.3-.459V7.6A.268.268,0,0,0,21.34,7.375Zm-.918,7.441-.164.065a4.319,4.319,0,0,1-1.737.2h-.065V13.439a10.922,10.922,0,0,1-1.967-.23v1.738c-.557-.1-1.082-.2-1.508-.295-.164-.033-.328-.1-.459-.131v-1.8c-.557-.164-1.409-.328-1.966-.459v1.868a4.187,4.187,0,0,0-.918-.1,3.179,3.179,0,0,0-.525.033l-.524.032v-1.9a6.235,6.235,0,0,1,1.147-.065,3.152,3.152,0,0,1,.82.1V10.259a7.918,7.918,0,0,0-1.967.033V8.26l.295-.033a7.345,7.345,0,0,1,1.672.131v1.9c.458.1,1.245.263,1.835.427.033,0,.1.032.131.032v-1.9a15.716,15.716,0,0,0,1.967.459v1.868a13.543,13.543,0,0,0,1.967.164v-1.8h.065a10.394,10.394,0,0,0,1.541-.23l.393-.131v1.967a6.871,6.871,0,0,1-1.836.229h-.131v2.1h.066a4.956,4.956,0,0,0,1.9-.492v1.869Zm-5.9-4.1v1.967a1.917,1.917,0,0,1,.394.131c.491.131,1.016.295,1.573.393V11.177C15.8,11.046,15.112,10.882,14.522,10.718Z" style="fill:#fff"/></svg>

        <!-- SVG Marker - Waypoint combined start/end -->
        <svg id="svgMarkerWaypointCombo" xmlns="http://www.w3.org/2000/svg" width="42" height="34.354" viewBox="0 0 42 34.354"><title>waypoint-finish-and-start-v3</title><path d="M38,0H21V34.278L26.563,28H38a4,4,0,0,0,4-4V4A4,4,0,0,0,38,0Z" style="fill:#061c3f"/><path d="M4,0A4,4,0,0,0,0,4V24a4,4,0,0,0,4,4H15.437L21,34.278V0Z" style="fill:#4bca81"/><g style="opacity:0.32"><path d="M38,1a3,3,0,0,1,3,3V24a3,3,0,0,1-3,3H26.113l-.3.337L21,32.77l-4.815-5.433-.3-.337H4a3,3,0,0,1-3-3V4A3,3,0,0,1,4,1H38m0-1H4A4,4,0,0,0,0,4V24a4,4,0,0,0,4,4H15.437L21,34.278,26.563,28H38a4,4,0,0,0,4-4V4a4,4,0,0,0-4-4Z"/></g><path d="M24.7,6.224a.924.924,0,0,0-1.154.666L21,16.378,18.467,6.919a.943.943,0,1,0-1.821.488L20.061,20.15a.945.945,0,0,0,1.154.667.93.93,0,0,0,.141-.071.919.919,0,0,0,.594-.624L25.364,7.378A.925.925,0,0,0,24.7,6.224Z" style="fill:#fff"/><path d="M30.481,12.554l-.487,1.82a1.789,1.789,0,0,1,.331.219c.423.244.868.526,1.359.755l.5-1.881C31.583,13.174,30.987,12.852,30.481,12.554Z" style="fill:#fff"/><path d="M37.622,11.15c-4.5,1.006-6.671-3.381-10.769-3.016a.54.54,0,0,0-.486.358l-1.822,6.8a.567.567,0,0,0,.568.672c3.865-.1,6.058,4.1,10.511,3.011a.528.528,0,0,0,.386-.351l1.919-7.161A.257.257,0,0,0,37.622,11.15Zm-1.746,3.24a6.618,6.618,0,0,1-1.756-.243L34,14.114l-.52,1.942.061.016a4.745,4.745,0,0,0,1.882.017l-.464,1.729-.03-.008-.168.02a4.127,4.127,0,0,1-1.657-.249l-.061-.016.407-1.517a10.625,10.625,0,0,1-1.764-.7l-.431,1.608c-.491-.229-.952-.45-1.322-.647-.144-.071-.279-.172-.393-.235l.448-1.669c-.476-.29-1.224-.653-1.707-.913l-.464,1.73a3.918,3.918,0,0,0-.825-.319,3.074,3.074,0,0,0-.493-.1L26,14.7l.471-1.76a5.861,5.861,0,0,1,1.079.224,2.981,2.981,0,0,1,.734.294l.488-1.821a7.543,7.543,0,0,0-1.829-.457l.5-1.881.281.042a7.041,7.041,0,0,1,1.515.536l-.471,1.76c.4.205,1.088.552,1.593.85.031.008.083.055.113.063l.472-1.76a15.2,15.2,0,0,0,1.707.913L32.2,13.436a13.15,13.15,0,0,0,1.78.64l.447-1.669.061.016a9.985,9.985,0,0,0,1.483.17l.4-.024Z" style="fill:#fff"/><path d="M15.158,8.163c-4.1-.365-6.272,4.022-10.77,3.016a.257.257,0,0,0-.307.31L6,18.65A.531.531,0,0,0,6.387,19c4.453,1.084,6.645-3.114,10.51-3.011a.568.568,0,0,0,.568-.673l-1.821-6.8A.541.541,0,0,0,15.158,8.163Z" style="fill:#fff"/></svg>

        <!-- SVG Marker - Favorite -->
        <svg class='svg-marker-favorite' width="28" height="42" xmlns="http://www.w3.org/2000/svg">
            <g>
                <path transform="rotate(180 13.5708 20.8542)" fill="__GRADIENT_ONE__" d="m6.300003,37.5c-4.300003,-3.399994 -5.900002,-8.5 -4.300003,-13.699997c1.700005,-5.800003 11.100006,-23.100006 12,-22.100006c1.400009,1.5 10.800003,20.800003 11.5,23.5c1,3.800003 -1.099991,9.300003 -4.599991,12.300003c-4.100006,3.400009 -10.200012,3.400009 -14.600006,0z" stroke="__CIRCLE_STROKE__"/>
                <path stroke="__CIRCLE_FILL__" fill="__CIRCLE_FILL__" stroke-width="5" d="m13.47797,15.01411l-0.28443,0.20129l0.10872,-0.32559l-0.28433,-0.20126l0.35149,0.00003l0.09341,-0.27995l0.01524,-0.04546l0.10853,0.32538l0.35161,0l-0.28449,0.20127l0.10874,0.32569l-0.28449,-0.20136l0,0l0,-0.00003l0,0l0,0.00001z"/>
            </g>
        </svg>

        <svg class="svg-data-layer" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 19 19" style="enable-background:new 0 0 19 19;" xml:space="preserve" width="19" height="19">
            <g>
                <ellipse fill="#72889E" class="st0" cx="9.5" cy="4.6" rx="6.5" ry="2.2"/>
                <path class="st0" d="M9.5,8.2C5.9,8.2,3,7.1,3,6.2v1.6c0,1.2,2.9,2.2,6.5,2.2s6.5-1,6.5-2.2V6.2C16,7.2,13.1,8.2,9.5,8.2z"/>
                <path class="st0" d="M9.5,11.5c-3.6,0-6.5-1.1-6.5-2v1.6c0,1.2,2.9,2.2,6.5,2.2s6.5-1,6.5-2.2V9.5C16,10.4,13.1,11.5,9.5,11.5z"/>
                <path class="st0" d="M9.5,14.8c-3.6,0-6.5-1.1-6.5-2v1.6c0,1.2,2.9,2.2,6.5,2.2s6.5-1,6.5-2.2v-1.6C16,13.7,13.1,14.8,9.5,14.8z"/>
            </g>
        </svg>

    </div>

    <!-- Dynamic Component Overrides -->
    <apex:repeat value="{!overrideComponentStrings}" var="c">
        <apex:outputText escape="false" value="{!c}" />
    </apex:repeat>

    <apex:outputPanel layout="none" rendered="{!TotangoEnabled == 'true'}">

    	<script type='text/javascript'>
            // check if page is being loaded in an iframe
            function inIframe () {
                try {
                    return window.self !== window.top;
                } catch (e) {
                    return true;
                }
            }
            // assign class so that appropriate styles can be applied
            if(inIframe()) {
                $("body").addClass("iframeEmbed");
            }
           
	    	$("#mapcontainer").scroll(function() {
	            if ($(this).scrollTop()) {
	                $('.listview-scrolltotop-button').stop(true, true).fadeIn();
	            } else {
	                $('.listview-scrolltotop-button').stop(true, true).fadeOut();
	            }
	        });
	        $("#mapcontainer").scroll(function() {
	            // subtract 192 because of the max-height set on #mapdiv when the listview is activated
	            if($("#mapcontainer").scrollTop() + 192 == $("#mapcontainer").height()) {
	                $('.listview-fullscreen-button').stop(true, true).fadeOut();
	            }
	            else {
	                $('.listview-fullscreen-button').stop(true, true).fadeIn();
	            }
	        });
        </script>

    </apex:outputPanel>

    <script>

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-41062202-6']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      _gaq.push(['_setCustomVar',1,'OrgId','{!$Organization.Id}',3]);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</apex:page>